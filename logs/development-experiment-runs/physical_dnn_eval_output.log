$ python3 ../score.py -read "SWaT_Dataset_Attack_v0-fixed-eval.csv" -dimensionality 52 -optimizer sgd -model checkpoints/dnn-epoch-

Using TensorFlow backend.
[INFO] using Sequential Dense layers
2020-01-31 20:30:50.902457: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-01-31 20:30:50.944670: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fe489c99860 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-01-31 20:30:50.944709: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
[INFO] adding core layer 0
[INFO] created DNN
[INFO] reading file SWaT_Dataset_Attack_v0-fixed-eval.csv
[INFO] process dataset, shape: (99982, 53)
dropping all time related columns...
[INFO] columns: Index([' Timestamp', 'FIT101', 'LIT101', ' MV101', 'P101', 'P102', ' AIT201',
       'AIT202', 'AIT203', 'FIT201', ' MV201', ' P201', ' P202', 'P203',
       ' P204', 'P205', 'P206', 'DPIT301', 'FIT301', 'LIT301', 'MV301',
       'MV302', ' MV303', 'MV304', 'P301', 'P302', 'AIT401', 'AIT402',
       'FIT401', 'LIT401', 'P401', 'P402', 'P403', 'P404', 'UV401', 'AIT501',
       'AIT502', 'AIT503', 'AIT504', 'FIT501', 'FIT502', 'FIT503', 'FIT504',
       'P501', 'P502', 'PIT501', 'PIT502', 'PIT503', 'FIT601', 'P601', 'P602',
       'P603', 'Normal/Attack'],
      dtype='object')
[INFO] analyze dataset: (99982, 53)

[INFO] analyzing data
[INFO] 99982 rows
[INFO] **  Timestamp:99982 (100.0%)
[INFO] ** FIT101:1516 (1.51627%)
[INFO] ** LIT101:7609 (7.61037%)
[INFO] **  MV101:[2:72.94913%,1:26.48177%,0:0.5691%]
[INFO] ** P101:[2:75.19253%,1:24.80747%]
[INFO] ** P102:[1:99.90098%,2:0.09902%]
[INFO] **  AIT201:465 (0.46508%)
[INFO] ** AIT202:386 (0.38607%)
[INFO] ** AIT203:786 (0.78614%)
[INFO] ** FIT201:1092 (1.0922%)
[INFO] **  MV201:[2:75.97468%,1:23.51223%,0:0.51309%]
[INFO] **  P201:[1:77.1999%,2:22.8001%]
[INFO] **  P202:[1:100.0%]
[INFO] ** P203:[2:75.0205%,1:24.9795%]
[INFO] **  P204:[1:100.0%]
[INFO] ** P205:[2:75.0205%,1:24.9795%]
[INFO] ** P206:[1:100.0%]
[INFO] ** DPIT301:2522 (2.52245%)
[INFO] ** FIT301:2648 (2.64848%)
[INFO] ** LIT301:6705 (6.70621%)
[INFO] ** MV301:[1:98.24468%,2:1.27523%,0:0.48009%]
[INFO] ** MV302:[2:81.76472%,1:17.47214%,0:0.76314%]
[INFO] **  MV303:[1:95.83925%,2:3.52563%,0:0.63511%]
[INFO] ** MV304:[1:95.17913%,2:4.00572%,0:0.81515%]
[INFO] ** P301:[1:100.0%]
[INFO] ** P302:[2:83.8721%,1:16.1279%]
[INFO] ** AIT401:[148.8032:52.64248%,148.808:40.92637%,148.7936:4.68084%,148.8128:1.14021%,148.7888:0.23504%,148.8176:0.15903%,148.784:0.08201%,148.8272:0.06201%,148.7792:0.03801%,148.832:0.011%,148.7695:0.011%,148.7647:0.005%,148.8416:0.003%,148.8513:0.002%,148.8368:0.002%]
[INFO] ** AIT402:522 (0.52209%)
[INFO] ** FIT401:325 (0.32506%)
[INFO] ** LIT401:4731 (4.73185%)
[INFO] ** P401:[1:100.0%]
[INFO] ** P402:[2:100.0%]
[INFO] ** P403:[1:100.0%]
[INFO] ** P404:[1:100.0%]
[INFO] ** UV401:[2:99.70495%,1:0.29505%]
[INFO] ** AIT501:531 (0.5311%)
[INFO] ** AIT502:551 (0.5511%)
[INFO] ** AIT503:898 (0.89816%)
[INFO] ** AIT504:187 (0.18703%)
[INFO] ** FIT501:375 (0.37507%)
[INFO] ** FIT502:837 (0.83715%)
[INFO] ** FIT503:187 (0.18703%)
[INFO] ** FIT504:150 (0.15003%)
[INFO] ** P501:[2:99.70495%,1:0.29505%]
[INFO] ** P502:[1:100.0%]
[INFO] ** PIT501:447 (0.44708%)
[INFO] ** PIT502:[0.9771569:11.86314%,0.8009483000000001:10.34786%,0.8169672:9.31468%,1.009195:8.3535%,1.0252139999999998:8.3065%,0.9611379999999999:8.27649%,0.8490052:6.41215%,0.9291:5.59801%,0.945119:5.06891%,0.8810431000000001:5.0219%,0.8970621:4.92189%,0.8650241:4.75486%,0.7849293:3.43762%,1.041233:2.7905%,1.057252:1.48627%,0.7689104:1.14321%,0.0:0.76414%,1.0892899999999999:0.75014%,0.7368724:0.37707%,1.105309:0.35906%,1.121328:0.18603%,0.7208535:0.14803%,1.1373469999999999:0.12202%,0.7048345:0.06701%,1.169384:0.06101%,1.185403:0.018%,0.6888155:0.015%,1.201422:0.01%,1.217441:0.007%,0.6567776:0.005%,0.6407586:0.004%,1.297536:0.002%,0.3363983:0.001%,0.6087206999999999:0.001%,0.08009483:0.001%,0.6247397:0.001%,0.2883414:0.001%,0.49658800000000003:0.001%,0.1762086:0.001%]
[INFO] ** PIT503:433 (0.43308%)
[INFO] ** FIT601:1283 (1.28323%)
[INFO] ** P601:[1:100.0%]
[INFO] ** P602:[1:98.8618%,2:1.1382%]
[INFO] ** P603:[1:100.0%]
[INFO] ** Normal/Attack:[Normal:95.29515%,Attack:4.70485%]
[INFO] encoding dataset: (99982, 53)
[INFO] AFTER encoding dataset: (99982, 53)
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 99982 rows
[INFO] **  Timestamp:99982 (100.0%)
[INFO] ** FIT101:1516 (1.51627%)
[INFO] ** LIT101:7609 (7.61037%)
[INFO] **  MV101:[2:72.94913%,1:26.48177%,0:0.5691%]
[INFO] ** P101:[2:75.19253%,1:24.80747%]
[INFO] ** P102:[1:99.90098%,2:0.09902%]
[INFO] **  AIT201:465 (0.46508%)
[INFO] ** AIT202:386 (0.38607%)
[INFO] ** AIT203:786 (0.78614%)
[INFO] ** FIT201:1092 (1.0922%)
[INFO] **  MV201:[2:75.97468%,1:23.51223%,0:0.51309%]
[INFO] **  P201:[1:77.1999%,2:22.8001%]
[INFO] **  P202:[1:100.0%]
[INFO] ** P203:[2:75.0205%,1:24.9795%]
[INFO] **  P204:[1:100.0%]
[INFO] ** P205:[2:75.0205%,1:24.9795%]
[INFO] ** P206:[1:100.0%]
[INFO] ** DPIT301:2522 (2.52245%)
[INFO] ** FIT301:2648 (2.64848%)
[INFO] ** LIT301:6705 (6.70621%)
[INFO] ** MV301:[1:98.24468%,2:1.27523%,0:0.48009%]
[INFO] ** MV302:[2:81.76472%,1:17.47214%,0:0.76314%]
[INFO] **  MV303:[1:95.83925%,2:3.52563%,0:0.63511%]
[INFO] ** MV304:[1:95.17913%,2:4.00572%,0:0.81515%]
[INFO] ** P301:[1:100.0%]
[INFO] ** P302:[2:83.8721%,1:16.1279%]
[INFO] ** AIT401:[148.8032:52.64248%,148.808:40.92637%,148.7936:4.68084%,148.8128:1.14021%,148.7888:0.23504%,148.8176:0.15903%,148.784:0.08201%,148.8272:0.06201%,148.7792:0.03801%,148.832:0.011%,148.7695:0.011%,148.7647:0.005%,148.8416:0.003%,148.8513:0.002%,148.8368:0.002%]
[INFO] ** AIT402:522 (0.52209%)
[INFO] ** FIT401:325 (0.32506%)
[INFO] ** LIT401:4731 (4.73185%)
[INFO] ** P401:[1:100.0%]
[INFO] ** P402:[2:100.0%]
[INFO] ** P403:[1:100.0%]
[INFO] ** P404:[1:100.0%]
[INFO] ** UV401:[2:99.70495%,1:0.29505%]
[INFO] ** AIT501:531 (0.5311%)
[INFO] ** AIT502:551 (0.5511%)
[INFO] ** AIT503:898 (0.89816%)
[INFO] ** AIT504:187 (0.18703%)
[INFO] ** FIT501:375 (0.37507%)
[INFO] ** FIT502:837 (0.83715%)
[INFO] ** FIT503:187 (0.18703%)
[INFO] ** FIT504:150 (0.15003%)
[INFO] ** P501:[2:99.70495%,1:0.29505%]
[INFO] ** P502:[1:100.0%]
[INFO] ** PIT501:447 (0.44708%)
[INFO] ** PIT502:[0.9771569:11.86314%,0.8009483000000001:10.34786%,0.8169672:9.31468%,1.009195:8.3535%,1.0252139999999998:8.3065%,0.9611379999999999:8.27649%,0.8490052:6.41215%,0.9291:5.59801%,0.945119:5.06891%,0.8810431000000001:5.0219%,0.8970621:4.92189%,0.8650241:4.75486%,0.7849293:3.43762%,1.041233:2.7905%,1.057252:1.48627%,0.7689104:1.14321%,0.0:0.76414%,1.0892899999999999:0.75014%,0.7368724:0.37707%,1.105309:0.35906%,1.121328:0.18603%,0.7208535:0.14803%,1.1373469999999999:0.12202%,0.7048345:0.06701%,1.169384:0.06101%,1.185403:0.018%,0.6888155:0.015%,1.201422:0.01%,1.217441:0.007%,0.6567776:0.005%,0.6407586:0.004%,1.297536:0.002%,0.3363983:0.001%,0.6087206999999999:0.001%,0.08009483:0.001%,0.6247397:0.001%,0.2883414:0.001%,0.49658800000000003:0.001%,0.1762086:0.001%]
[INFO] ** PIT503:433 (0.43308%)
[INFO] ** FIT601:1283 (1.28323%)
[INFO] ** P601:[1:100.0%]
[INFO] ** P602:[1:98.8618%,2:1.1382%]
[INFO] ** P603:[1:100.0%]
[INFO] ** Normal/Attack:[Normal:95.29515%,Attack:4.70485%]
[INFO] to_xy labeltype: Normal
[INFO] to_xy labeltype: Attack
x_test [[1.4516468e+09 2.6426029e+00 4.9956989e+02 ... 1.0000000e+00
  1.0000000e+00 1.0000000e+00]
 [1.4516468e+09 2.6304331e+00 4.9937360e+02 ... 1.0000000e+00
  1.0000000e+00 1.0000000e+00]
 [1.4516468e+09 2.6259489e+00 4.9937360e+02 ... 1.0000000e+00
  1.0000000e+00 1.0000000e+00]
 ...
 [1.4517468e+09 2.5314670e+00 5.2068781e+02 ... 1.0000000e+00
  1.0000000e+00 1.0000000e+00]
 [1.4517468e+09 2.5212181e+00 5.2072711e+02 ... 1.0000000e+00
  1.0000000e+00 1.0000000e+00]
 [1.4517468e+09 2.5016811e+00 5.2111963e+02 ... 1.0000000e+00
  1.0000000e+00 1.0000000e+00]] shape (99982, 52)
y_test [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]] shape (99982, 2)
[INFO] measuring accuracy...
x_test.shape: (99982, 52)
[INFO] model summary:
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
dense_1 (Dense)              (None, 2)                 106
_________________________________________________________________
dense_2 (Dense)              (None, 4)                 12
_________________________________________________________________
dense_3 (Dense)              (None, 2)                 10
_________________________________________________________________
dense_4 (Dense)              (None, 1)                 3
_________________________________________________________________
dense_5 (Dense)              (None, 2)                 4
=================================================================
Total params: 135
Trainable params: 135
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (99982,)
--------SHAPES--------
x_test.shape (99982, 52)
y_test.shape (99982, 2)
pred 1 [[0.8215034 0.1784966]
 [0.8215034 0.1784966]
 [0.8215034 0.1784966]
 ...
 [0.8215034 0.1784966]
 [0.8215034 0.1784966]
 [0.8215034 0.1784966]] (99982, 2)
pred 3 (argmax) [0 0 0 ... 0 0 0] (99982,)
[INFO] Validation score: 0.9529515312756296
[INFO] metrics:
---- for loop ----
loss :  0.26844247002151983
tp :  95278.0
fp :  4704.0
tn :  95278.0
fn :  4704.0
accuracy :  0.9529515504837036
precision :  0.9529515504837036
recall :  0.9529515504837036
auc :  0.9529515504837036

y_eval {0: 95278, 1: 4704}
pred {0: 99982}
[INFO] confusion matrix for file
[[95278     0]
 [ 4704     0]]
[INFO] confusion matrix after adding it to total:
[[95278     0]
 [ 4704     0]]