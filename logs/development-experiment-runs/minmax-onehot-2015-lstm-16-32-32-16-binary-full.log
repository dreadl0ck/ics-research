dreadbook:ics-research alien$ python3 score.py \
>     -read "data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/*-labeled.csv" \
>     -wrapLayerSize 16 \
>     -dropoutLayer true \
>     -relu true \
>     -coreLayerSize 32 \
>     -numCoreLayers 2 \
>     -optimizer adam \
>     -lstm true \
>     -features 107 \
>     -binaryClasses true \
>     -drop modbus_value
Using TensorFlow backend.
=================================================
        SCORING v0.4.3 (multi-class)
=================================================
Date: 2020-02-09 00:15:32.385171
------------DNN info-------------
wrapLayerSize 16
coreLayerSize 32
numCoreLayers 2
outputLayerActivation sigmoid
output_dim 2
loss binary_crossentropy
optimizer adam
------------DNN info-------------
[INFO] input_shape (128, 107)
[INFO] LSTM first and last layer neurons: 16
2020-02-09 00:15:32.391202: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-02-09 00:15:32.404826: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fee4c5182b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-02-09 00:15:32.404845: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
WARNING:tensorflow:Large dropout rate: 0.8 (>0.5). In TensorFlow 2.x, dropout() uses dropout rate instead of keep_prob. Please ensure that this is intended.
[INFO] adding core layer 0
[INFO] adding core layer 1
[INFO] created DNN
loading weights: checkpoints/*
loading file checkpoints/lstm-epoch-003-files-0-50-batch-9984000-10240000
[INFO] model summary:
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
lstm_1 (LSTM)                (None, 128, 16)           7936
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 16)           0
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 32)           6272
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 32)           0
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 32)           8320
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 32)           0
_________________________________________________________________
lstm_4 (LSTM)                (None, 128, 16)           3136
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 16)           0
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            17
_________________________________________________________________
dropout_5 (Dropout)          (None, 128, 1)            0
_________________________________________________________________
dense_2 (Dense)              (None, 128, 2)            4
=================================================================
Total params: 25,685
Trainable params: 25,685
Non-trainable params: 0
_________________________________________________________________
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2015-12-31_130240_112.log.part10_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2015-12-31_181648_113.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2015-12-31_181648_113.log.part09_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2015-12-31_233049_114.log.part11_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-01_151435_117.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-01_151435_117.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-01_151435_117.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-01_203011_118.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-01_203011_118.log.part07_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-02_014558_119.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-02_121729_121.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-02_121729_121.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-02_121729_121.log.part14_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-02_172943_122.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-02_172943_122.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/eval/2016-01-02_172943_122.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (7939824, 18)
dropping column: modbus_value
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (7939824, 17)

[INFO] analyzing data
[INFO] 7939824 rows
[INFO] ** unixtime:21665 (0.27286%)
[INFO] ** orig:[192.168.1.48:99.99797%,192.168.1.88:0.00188%,192.168.1.87:0.00015%]
[INFO] ** type:[log:99.99952%,control:0.00039%,alert:9e-05%]
[INFO] ** i/f_name:[eth1:99.99694%,0:0.00306%]
[INFO] ** i/f_dir:[outbound:99.99708%,inbound:0.00292%]
[INFO] ** src:[192.168.1.60:38.1781%,192.168.1.10:26.08802%,192.168.1.30:18.17053%,192.168.1.20:17.55846%,192.168.1.88:0.00202%,0:0.00118%,192.168.1.19:0.00044%,192.168.1.40:0.00034%,192.168.1.136:0.00031%,192.168.1.49:0.00025%,192.168.1.201:0.00018%,192.168.1.200:0.0001%,192.168.1.199:5e-05%,192.168.1.134:1e-05%]
[INFO] ** dst:[192.168.1.20:43.37809%,192.168.1.10:20.88767%,192.168.1.40:18.17044%,192.168.1.30:17.55826%,0:0.00306%,192.168.1.50:0.00106%,192.168.1.255:0.00039%,192.168.1.60:0.00023%,224.0.0.252:0.0002%,192.168.1.201:0.00015%,224.0.0.251:0.00014%,239.255.255.250:0.0001%,192.168.1.19:8e-05%,192.168.1.200:5e-05%,192.168.1.49:5e-05%,192.168.1.88:4e-05%]
[INFO] ** proto:[tcp:99.99607%,0:0.00306%,udp:0.00087%]
[INFO] ** appi_name:[CIP_read_tag_service:99.99545%,0:0.00306%,NetBIOS Name Service:0.00024%,LLMNR Protocol:0.0002%,NetBIOS Datagram Service:0.00019%,Multicast DNS Protocol (mDNS):0.00014%,Unknown Traffic:0.0001%,DCE-RPC Protocol:0.0001%,SSDP:0.0001%,CIP_gen:9e-05%,EtherNet/IP:6e-05%,Common Industrial Protocol - RMW (Read/Modify/Write):6e-05%,Common Industrial Protocol:6e-05%,NetBIOS Session Service:4e-05%,Server Message Block (SMB):4e-05%,OSIsoft PI:3e-05%,Common Industrial Protocol - success:1e-05%,Simple Object Access Protocol:1e-05%,Web Browsing:1e-05%]
[INFO] ** proxy_src_ip:[192.168.1.60:38.1781%,192.168.1.10:26.08802%,192.168.1.30:18.17053%,192.168.1.20:17.55846%,0:0.00306%,192.168.1.19:0.00044%,192.168.1.40:0.00034%,192.168.1.136:0.00031%,192.168.1.49:0.00025%,192.168.1.201:0.00018%,192.168.1.88:0.00014%,192.168.1.200:0.0001%,192.168.1.199:5e-05%,192.168.1.134:1e-05%]
[INFO] ** modbus_function_code:[0.9743589744:99.99545%,0.0:0.00446%,1.0:9e-05%]
[INFO] ** modbus_function_description:[Read Tag Service - Response:49.99838%,Read Tag Service:49.99708%,0:0.00446%,Forward Close - Response:9e-05%]
[INFO] ** modbus_transaction_id:65536 (0.82541%)
[INFO] ** scada_tag:[HMI_FIT201:26.08708%,HMI_LIT101:20.88743%,HMI_LIT401:18.17008%,HMI_LIT301:17.55785%,HMI_AIT202:17.29042%,0:0.00715%]
[INFO] ** service:[0.7025755984000001:99.99574%,0.0:0.00306%,0.0021476384:0.00024%,0.08394601119999999:0.0002%,0.0021633145999999997:0.00019%,0.08391465880000001:0.00014%,0.0208806885:0.0001%,0.0297847659:0.0001%,0.002116286:0.0001%,0.0021789908:8e-05%,0.08543524949999999:3e-05%,0.0839773636:1e-05%,0.0012540954:1e-05%]
[INFO] ** s_port:[0.834280824:26.08742%,0.8139250565:20.88754%,0.8029830673999999:18.17019%,0.8149336757:17.55806%,0.8137722355:17.29056%,0.0:0.00306%,0.8343113882:0.00034%,0.8059172320999999:0.00034%,0.814841983:0.00031%,0.0020936488:0.00024%,0.8030136315999999:0.00023%,0.0021089309:0.00019%,0.8345253376999999:0.00015%,0.0818051226:0.00014%,0.8030441959000001:0.00013%,0.8344030809:0.00011%,0.8147502904:9e-05%,0.0290360046:6e-05%,0.7431230515:6e-05%,0.696222263:6e-05%,0.8683752063:5e-05%,0.8896631823000001:5e-05%,0.7435203863:5e-05%,0.7081881533:5e-05%,0.7967938137999999:4e-05%,0.9715599976:4e-05%,0.9535729568000001:4e-05%,0.15240846019999998:3e-05%,0.9385047986:3e-05%,0.9137019378:3e-05%,0.7586191087:3e-05%,0.7593068036:3e-05%,0.15243902439999998:3e-05%,0.8411730545999999:3e-05%,0.315972859:3e-05%,0.9310776942:3e-05%,0.9945442875:3e-05%,0.7943945229:1e-05%,0.9228712024:1e-05%,0.7806864723:1e-05%,0.9925728957:1e-05%,0.9406137294:1e-05%,0.8086374473000001:1e-05%,0.1074484993:1e-05%,0.9705208142:1e-05%,0.7840485359999999:1e-05%,0.9882022128:1e-05%,0.7853933615:1e-05%,0.7616602481999999:1e-05%]
[INFO] ** classification:[normal:87.56318%,Single Stage Single Point:7.92975%,Multi Stage Multi Point:2.55424%,Single Stage Multi Point:1.3816%,Multi Stage Single Point:0.57123%]
[INFO] columns with count within 2-10 {'orig': 3, 'type': 3, 'i/f_name': 2, 'i/f_dir': 2, 'proto': 3, 'modbus_function_code': 3, 'modbus_function_description': 4, 'scada_tag': 6, 'classification': 5}
encode_text_dummy orig
encode_text_dummy type
encode_text_dummy i/f_name
encode_text_dummy i/f_dir
encode_text_dummy src
encode_text_dummy dst
encode_text_dummy proto
encode_text_dummy appi_name
encode_text_dummy proxy_src_ip
encode_text_dummy modbus_function_description
encode_text_dummy scada_tag
adding missing-0
adding missing-1
adding missing-2
adding missing-3
adding missing-4
adding missing-5
adding missing-6
adding missing-7
adding missing-8
adding missing-9
adding missing-10
adding missing-11
adding missing-12
adding missing-13
adding missing-14
adding missing-15
len(df.columns) 108
numFeatures 107
[INFO] processing batch 0-256000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 1 1 ... 0 1 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
2020-02-09 00:16:41.837121: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/binary_crossentropy/weighted_loss/concat'.
2020-02-09 00:16:41.843367: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 00:16:41.846499: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 00:16:41.877385: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-09 00:16:41.879694: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/binary_crossentropy/weighted_loss/concat'.
2020-02-09 00:16:41.882259: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 00:16:41.884898: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 00:16:41.896796: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
loss :  0.834510395526886
tp :  164503.0
fp :  91497.0
tn :  164503.0
fn :  91497.0
accuracy :  0.6425898671150208
precision :  0.6425898671150208
recall :  0.6425898671150208
auc :  0.6420020461082458

y_eval {0: 164503, 1: 91497}
pred {0: 256000}
[INFO] confusion matrix for file
[[164503      0]
 [ 91497      0]]
[INFO] confusion matrix after adding it to total:
[[164503      0]
 [ 91497      0]]
[INFO] processing batch 256000-512000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [1 0 1 ... 1 1 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.2615572128295898
tp :  239293.0
fp :  16707.0
tn :  239293.0
fn :  16707.0
accuracy :  0.934738278388977
precision :  0.934738278388977
recall :  0.934738278388977
auc :  0.9333940148353577

y_eval {0: 239293, 1: 16707}
pred {0: 256000}
[INFO] confusion matrix for file
[[239293      0]
 [ 16707      0]]
[INFO] confusion matrix after adding it to total:
[[403796      0]
 [108204      0]]
[INFO] processing batch 512000-768000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 1 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.2861732633113861
tp :  236050.0
fp :  19950.0
tn :  236050.0
fn :  19950.0
accuracy :  0.922070324420929
precision :  0.922070324420929
recall :  0.922070324420929
auc :  0.9220412373542786

y_eval {0: 236050, 1: 19950}
pred {0: 256000}
[INFO] confusion matrix for file
[[236050      0]
 [ 19950      0]]
[INFO] confusion matrix after adding it to total:
[[639846      0]
 [128154      0]]
[INFO] processing batch 768000-1024000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 1 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.7750692293643952
tp :  172406.0
fp :  83594.0
tn :  172406.0
fn :  83594.0
accuracy :  0.6734609603881836
precision :  0.6734609603881836
recall :  0.6734609603881836
auc :  0.673751950263977

y_eval {0: 172406, 1: 83594}
pred {0: 256000}
[INFO] confusion matrix for file
[[172406      0]
 [ 83594      0]]
[INFO] confusion matrix after adding it to total:
[[812252      0]
 [211748      0]]
[INFO] processing batch 1024000-1280000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [1 0 1 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  1.0487267792224884
tp :  136792.0
fp :  119208.0
tn :  136792.0
fn :  119208.0
accuracy :  0.5343437790870667
precision :  0.5343437790870667
recall :  0.5343437790870667
auc :  0.5343481302261353

y_eval {0: 136792, 1: 119208}
pred {0: 256000}
[INFO] confusion matrix for file
[[136792      0]
 [119208      0]]
[INFO] confusion matrix after adding it to total:
[[949044      0]
 [330956      0]]
[INFO] processing batch 1280000-1536000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.13275059485435486
tp :  256000.0
fp :  0.0
tn :  256000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 256000}
pred {0: 256000}
[INFO] confusion matrix for file
[[256000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[1205044       0]
 [ 330956       0]]
[INFO] processing batch 1536000-1792000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 1 1 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.17789386391639708
tp :  250069.0
fp :  5931.0
tn :  250069.0
fn :  5931.0
accuracy :  0.9768320322036743
precision :  0.9768320322036743
recall :  0.9768320322036743
auc :  0.9768114686012268

y_eval {0: 250069, 1: 5931}
pred {0: 256000}
[INFO] confusion matrix for file
[[250069      0]
 [  5931      0]]
[INFO] confusion matrix after adding it to total:
[[1455113       0]
 [ 336887       0]]
[INFO] processing batch 1792000-2048000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 1] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.3585942447185516
tp :  226683.0
fp :  29317.0
tn :  226683.0
fn :  29317.0
accuracy :  0.8854804635047913
precision :  0.8854804635047913
recall :  0.8854804635047913
auc :  0.8818082213401794

y_eval {0: 226683, 1: 29317}
pred {0: 256000}
[INFO] confusion matrix for file
[[226683      0]
 [ 29317      0]]
[INFO] confusion matrix after adding it to total:
[[1681796       0]
 [ 366204       0]]
[INFO] processing batch 2048000-2304000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [1 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.661204988360405
tp :  187737.0
fp :  68263.0
tn :  187737.0
fn :  68263.0
accuracy :  0.7333476543426514
precision :  0.7333476543426514
recall :  0.7333476543426514
auc :  0.7330794334411621

y_eval {0: 187737, 1: 68263}
pred {0: 256000}
[INFO] confusion matrix for file
[[187737      0]
 [ 68263      0]]
[INFO] confusion matrix after adding it to total:
[[1869533       0]
 [ 434467       0]]
[INFO] processing batch 2304000-2560000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.13052317142486572
tp :  256000.0
fp :  0.0
tn :  256000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 256000}
pred {0: 256000}
[INFO] confusion matrix for file
[[256000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[2125533       0]
 [ 434467       0]]
[INFO] processing batch 2560000-2816000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.13022360563278199
tp :  256000.0
fp :  0.0
tn :  256000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 256000}
pred {0: 256000}
[INFO] confusion matrix for file
[[256000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[2381533       0]
 [ 434467       0]]
[INFO] processing batch 2816000-3072000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 1 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.5038059794902802
tp :  208036.0
fp :  47964.0
tn :  208036.0
fn :  47964.0
accuracy :  0.8126406073570251
precision :  0.8126406073570251
recall :  0.8126406073570251
auc :  0.812576413154602

y_eval {0: 208036, 1: 47964}
pred {0: 256000}
[INFO] confusion matrix for file
[[208036      0]
 [ 47964      0]]
[INFO] confusion matrix after adding it to total:
[[2589569       0]
 [ 482431       0]]
[INFO] processing batch 3072000-3328000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.3520297799110413
tp :  227519.0
fp :  28481.0
tn :  227519.0
fn :  28481.0
accuracy :  0.8887460827827454
precision :  0.8887460827827454
recall :  0.8887460827827454
auc :  0.8887650966644287

y_eval {0: 227519, 1: 28481}
pred {0: 256000}
[INFO] confusion matrix for file
[[227519      0]
 [ 28481      0]]
[INFO] confusion matrix after adding it to total:
[[2817088       0]
 [ 510912       0]]
[INFO] processing batch 3328000-3584000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.1300699532032013
tp :  256000.0
fp :  0.0
tn :  256000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 256000}
pred {0: 256000}
[INFO] confusion matrix for file
[[256000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[3073088       0]
 [ 510912       0]]
[INFO] processing batch 3584000-3840000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.2653196668624878
tp :  238641.0
fp :  17359.0
tn :  238641.0
fn :  17359.0
accuracy :  0.9321914315223694
precision :  0.9321914315223694
recall :  0.9321914315223694
auc :  0.9319897294044495

y_eval {0: 238641, 1: 17359}
pred {0: 256000}
[INFO] confusion matrix for file
[[238641      0]
 [ 17359      0]]
[INFO] confusion matrix after adding it to total:
[[3311729       0]
 [ 528271       0]]
[INFO] processing batch 3840000-4096000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 1 1 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.705638313293457
tp :  182220.0
fp :  73780.0
tn :  182220.0
fn :  73780.0
accuracy :  0.7117968797683716
precision :  0.7117968797683716
recall :  0.7117968797683716
auc :  0.7115676403045654

y_eval {0: 182220, 1: 73780}
pred {0: 256000}
[INFO] confusion matrix for file
[[182220      0]
 [ 73780      0]]
[INFO] confusion matrix after adding it to total:
[[3493949       0]
 [ 602051       0]]
[INFO] processing batch 4096000-4352000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 1 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.1989941419363022
tp :  247137.0
fp :  8863.0
tn :  247137.0
fn :  8863.0
accuracy :  0.9653788805007935
precision :  0.9653788805007935
recall :  0.9653788805007935
auc :  0.9653463959693909

y_eval {0: 247137, 1: 8863}
pred {0: 256000}
[INFO] confusion matrix for file
[[247137      0]
 [  8863      0]]
[INFO] confusion matrix after adding it to total:
[[3741086       0]
 [ 610914       0]]
[INFO] processing batch 4352000-4608000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 1 0 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.4140872173309326
tp :  219645.0
fp :  36355.0
tn :  219645.0
fn :  36355.0
accuracy :  0.8579882979393005
precision :  0.8579882979393005
recall :  0.8579882979393005
auc :  0.8532084822654724

y_eval {0: 219645, 1: 36355}
pred {0: 256000}
[INFO] confusion matrix for file
[[219645      0]
 [ 36355      0]]
[INFO] confusion matrix after adding it to total:
[[3960731       0]
 [ 647269       0]]
[INFO] processing batch 4608000-4864000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 1 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.5722011520862579
tp :  199405.0
fp :  56595.0
tn :  199405.0
fn :  56595.0
accuracy :  0.7789257764816284
precision :  0.7789257764816284
recall :  0.7789257764816284
auc :  0.7793384790420532

y_eval {0: 199405, 1: 56595}
pred {0: 256000}
[INFO] confusion matrix for file
[[199405      0]
 [ 56595      0]]
[INFO] confusion matrix after adding it to total:
[[4160136       0]
 [ 703864       0]]
[INFO] processing batch 4864000-5120000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.12853565073013307
tp :  256000.0
fp :  0.0
tn :  256000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 256000}
pred {0: 256000}
[INFO] confusion matrix for file
[[256000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[4416136       0]
 [ 703864       0]]
[INFO] processing batch 5120000-5376000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.12770425534248353
tp :  256000.0
fp :  0.0
tn :  256000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 256000}
pred {0: 256000}
[INFO] confusion matrix for file
[[256000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[4672136       0]
 [ 703864       0]]
[INFO] processing batch 5376000-5632000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.1277013967037201
tp :  255998.0
fp :  2.0
tn :  255998.0
fn :  2.0
accuracy :  0.9999921917915344
precision :  0.9999921917915344
recall :  0.9999921917915344
auc :  0.9999897480010986

y_eval {0: 255998, 1: 2}
pred {0: 256000}
[INFO] confusion matrix for file
[[255998      0]
 [     2      0]]
[INFO] confusion matrix after adding it to total:
[[4928134       0]
 [ 703866       0]]
[INFO] processing batch 5632000-5888000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.2763349792957306
tp :  237169.0
fp :  18831.0
tn :  237169.0
fn :  18831.0
accuracy :  0.9264414310455322
precision :  0.9264414310455322
recall :  0.9264414310455322
auc :  0.9264851212501526

y_eval {0: 237169, 1: 18831}
pred {0: 256000}
[INFO] confusion matrix for file
[[237169      0]
 [ 18831      0]]
[INFO] confusion matrix after adding it to total:
[[5165303       0]
 [ 722697       0]]
[INFO] processing batch 5888000-6144000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.4292691156864166
tp :  217813.0
fp :  38187.0
tn :  217813.0
fn :  38187.0
accuracy :  0.8508320450782776
precision :  0.8508320450782776
recall :  0.8508320450782776
auc :  0.8504458665847778

y_eval {0: 217813, 1: 38187}
pred {0: 256000}
[INFO] confusion matrix for file
[[217813      0]
 [ 38187      0]]
[INFO] confusion matrix after adding it to total:
[[5383116       0]
 [ 760884       0]]
[INFO] processing batch 6144000-6400000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [1 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.19144929242134096
tp :  247921.0
fp :  8079.0
tn :  247921.0
fn :  8079.0
accuracy :  0.9684414267539978
precision :  0.9684414267539978
recall :  0.9684414267539978
auc :  0.9683979153633118

y_eval {0: 247921, 1: 8079}
pred {0: 256000}
[INFO] confusion matrix for file
[[247921      0]
 [  8079      0]]
[INFO] confusion matrix after adding it to total:
[[5631037       0]
 [ 768963       0]]
[INFO] processing batch 6400000-6656000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.12751163697242737
tp :  256000.0
fp :  0.0
tn :  256000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 256000}
pred {0: 256000}
[INFO] confusion matrix for file
[[256000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[5887037       0]
 [ 768963       0]]
[INFO] processing batch 6656000-6912000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 1 0 1] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.25033421778678894
tp :  240455.0
fp :  15545.0
tn :  240455.0
fn :  15545.0
accuracy :  0.9392773509025574
precision :  0.9392773509025574
recall :  0.9392773509025574
auc :  0.9392015933990479

y_eval {0: 240455, 1: 15545}
pred {0: 256000}
[INFO] confusion matrix for file
[[240455      0]
 [ 15545      0]]
[INFO] confusion matrix after adding it to total:
[[6127492       0]
 [ 784508       0]]
[INFO] processing batch 6912000-7168000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 1] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.8454676837921142
tp :  165187.0
fp :  90813.0
tn :  165187.0
fn :  90813.0
accuracy :  0.6452617049217224
precision :  0.6452617049217224
recall :  0.6452617049217224
auc :  0.6447849273681641

y_eval {0: 165187, 1: 90813}
pred {0: 256000}
[INFO] confusion matrix for file
[[165187      0]
 [ 90813      0]]
[INFO] confusion matrix after adding it to total:
[[6292679       0]
 [ 875321       0]]
[INFO] processing batch 7168000-7424000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 0 1 ... 0 1 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.8512659063339233
tp :  164440.0
fp :  91560.0
tn :  164440.0
fn :  91560.0
accuracy :  0.6423437595367432
precision :  0.6423437595367432
recall :  0.6423437595367432
auc :  0.6420279741287231

y_eval {0: 164440, 1: 91560}
pred {0: 256000}
[INFO] confusion matrix for file
[[164440      0]
 [ 91560      0]]
[INFO] confusion matrix after adding it to total:
[[6457119       0]
 [ 966881       0]]
[INFO] processing batch 7424000-7680000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [1 0 1 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.29010548973083494
tp :  235419.0
fp :  20581.0
tn :  235419.0
fn :  20581.0
accuracy :  0.9196054935455322
precision :  0.9196054935455322
recall :  0.9196054935455322
auc :  0.9196618795394897

y_eval {0: 235419, 1: 20581}
pred {0: 256000}
[INFO] confusion matrix for file
[[235419      0]
 [ 20581      0]]
[INFO] confusion matrix after adding it to total:
[[6692538       0]
 [ 987462       0]]
[INFO] processing batch 7680000-7936000/7939824
[INFO] measuring accuracy...
x_test.shape: (256000, 107)
y_eval [0 0 0 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[INFO] metrics:
loss :  0.12737509822845458
tp :  256000.0
fp :  0.0
tn :  256000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 256000}
pred {0: 256000}
[INFO] confusion matrix for file
[[256000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[6948538       0]
 [ 987462       0]]
[INFO] processing batch 7936000-8192000/7939824
--- 275.92070603370667 seconds ---
dreadbook:ics-research alien$