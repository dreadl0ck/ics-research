$ python3 ../../score.py -read "2015-12-28_113021_98.log.part13_sorted-labeled.csv" -dimensionality 15 -optimizer sgd -model checkpoints/dnn-epoch-1-files-0-1 -drop modbus_value -debug true
Using TensorFlow backend.
[INFO] using Sequential Dense layers
2020-01-31 19:44:26.392069: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-01-31 19:44:26.423649: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7ff16d742450 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-01-31 19:44:26.423687: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
[INFO] adding core layer 0
[INFO] created DNN
[INFO] reading file 2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
dropping column: modbus_value
dropping all time related columns...
dropping column: unixtime
[INFO] columns: Index(['orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst', 'proto',
       'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 16)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9996%,3:0.0004%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** src:[22:38.3832%,9:25.9606%,7:18.1352%,1:17.52%,14:0.0004%,3:0.0004%,15:0.0002%]
[INFO] ** dst:[21:43.3108%,10:21.0326%,8:18.135%,9:17.5198%,22:0.0008%,15:0.0004%,2:0.0004%,24:0.0002%]
[INFO] ** proto:[0:99.9996%,1:0.0004%]
[INFO] ** appi_name:[21:99.9992%,30:0.0004%,8:0.0002%,7:0.0002%]
[INFO] ** proxy_src_ip:[18:38.3832%,20:25.9606%,13:18.1352%,6:17.52%,17:0.0004%,1:0.0004%,16:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9992%,-33.760870000000004:0.0008%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.9992%,0:0.0008%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:25.9596%,1:21.0326%,5:18.1348%,4:17.5194%,2:17.3504%,0:0.0032%]
[INFO] ** service:[0.0048200000000000005:99.9992%,-211.73542999999998:0.0004%,-211.09762999999998:0.0002%,-211.35747999999998:0.0002%]
[INFO] ** s_port:[1.45442:25.96%,-0.32151:21.0326%,-1.27613:18.1348%,-0.23351:17.5196%,-0.33484:17.3506%,1.45709:0.0004%,-71.33197:0.0004%,-1.27347:0.0002%,-0.24950999999999998:0.0002%,-3.3787199999999995:0.0002%,1.47576:0.0002%,12.60597:0.0002%,-0.24151:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:72.7902%,Single Stage Single Point:27.2098%]
[INFO] encoding dataset: (500000, 16)
[INFO] AFTER encoding dataset: (500000, 16)
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9996%,3:0.0004%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** src:[22:38.3832%,9:25.9606%,7:18.1352%,1:17.52%,14:0.0004%,3:0.0004%,15:0.0002%]
[INFO] ** dst:[21:43.3108%,10:21.0326%,8:18.135%,9:17.5198%,22:0.0008%,15:0.0004%,2:0.0004%,24:0.0002%]
[INFO] ** proto:[0:99.9996%,1:0.0004%]
[INFO] ** appi_name:[21:99.9992%,30:0.0004%,8:0.0002%,7:0.0002%]
[INFO] ** proxy_src_ip:[18:38.3832%,20:25.9606%,13:18.1352%,6:17.52%,17:0.0004%,1:0.0004%,16:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9992%,-33.760870000000004:0.0008%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.9992%,0:0.0008%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:25.9596%,1:21.0326%,5:18.1348%,4:17.5194%,2:17.3504%,0:0.0032%]
[INFO] ** service:[0.0048200000000000005:99.9992%,-211.73542999999998:0.0004%,-211.09762999999998:0.0002%,-211.35747999999998:0.0002%]
[INFO] ** s_port:[1.45442:25.96%,-0.32151:21.0326%,-1.27613:18.1348%,-0.23351:17.5196%,-0.33484:17.3506%,1.45709:0.0004%,-71.33197:0.0004%,-1.27347:0.0002%,-0.24950999999999998:0.0002%,-3.3787199999999995:0.0002%,1.47576:0.0002%,12.60597:0.0002%,-0.24151:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:72.7902%,Single Stage Single Point:27.2098%]
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 0.       0.       2.      ...  3.       0.00482  1.45442]
 [ 0.       0.       2.      ...  2.       0.00482 -0.33484]
 [ 0.       0.       2.      ...  1.       0.00482 -0.32151]
 ...
 [ 0.       0.       2.      ...  1.       0.00482 -0.32151]
 [ 0.       0.       2.      ...  3.       0.00482  1.45442]
 [ 0.       0.       2.      ...  1.       0.00482 -0.32151]] shape (500000, 15)
y_test [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (500000, 5)
[INFO] measuring accuracy...
x_test.shape: (500000, 15)
[INFO] model summary:
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
dense_1 (Dense)              (None, 2)                 32
_________________________________________________________________
dense_2 (Dense)              (None, 4)                 12
_________________________________________________________________
dense_3 (Dense)              (None, 2)                 10
_________________________________________________________________
dense_4 (Dense)              (None, 1)                 3
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 10
=================================================================
Total params: 67
Trainable params: 67
Non-trainable params: 0
_________________________________________________________________
y_eval [1 0 1 ... 0 0 0] (500000,)
--------SHAPES--------
x_test.shape (500000, 15)
y_test.shape (500000, 5)
pred 1 [[8.7915587e-01 1.1999000e-01 2.1899983e-04 4.1744608e-04 2.1768488e-04]
 [8.7915587e-01 1.1999000e-01 2.1899983e-04 4.1744608e-04 2.1768488e-04]
 [8.7915587e-01 1.1999000e-01 2.1899983e-04 4.1744608e-04 2.1768488e-04]
 ...
 [8.7915587e-01 1.1999000e-01 2.1899983e-04 4.1744608e-04 2.1768488e-04]
 [8.7915587e-01 1.1999000e-01 2.1899983e-04 4.1744608e-04 2.1768488e-04]
 [8.7915587e-01 1.1999000e-01 2.1899983e-04 4.1744608e-04 2.1768488e-04]] (500000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (500000,)
[INFO] Validation score: 0.727902
[INFO] metrics:
---- for loop ----
loss :  0.6706916743745804
tp :  363951.0
fp :  136049.0
tn :  1863951.0
fn :  136049.0
accuracy :  0.8911614418029785
precision :  0.7279019951820374
recall :  0.7279019951820374
auc :  0.9319754838943481

y_eval {0: 363951, 1: 136049}
pred {0: 500000}
[INFO] confusion matrix for file
[[363951      0      0      0      0]
 [136049      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[363951      0      0      0      0]
 [136049      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]