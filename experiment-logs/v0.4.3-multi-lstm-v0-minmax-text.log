2020-02-09 12:41:30.006271: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-02-09 12:41:30.016407: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fe40d2f2e20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-02-09 12:41:30.016434: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Using TensorFlow backend.
WARNING:tensorflow:Large dropout rate: 0.8 (>0.5). In TensorFlow 2.x, dropout() uses dropout rate instead of keep_prob. Please ensure that this is intended.
=================================================
        TRAINING v0.4.5 (binary)
=================================================
Date: 2020-02-09 12:41:30.002915
------------DNN info-------------
dnnBatchSize 16
wrapLayerSize 2
coreLayerSize 4
numCoreLayers 1
outputLayerActivation sigmoid
output_dim 2
loss binary_crossentropy
optimizer adam
------------DNN info-------------
[INFO] input_shape (16, 107)
[INFO] LSTM first and last layer neurons: 2
[INFO] adding core layer 0
[INFO] created DNN
[33m[INFO] epoch 1/3[0m
[33m[INFO] loading file 1-50/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (24819975, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (24819975, 17)

[INFO] analyzing data
[INFO] 24819975 rows
[INFO] ** unixtime:67474 (0.27185%)
[INFO] ** orig:[192.168.1.48:99.9996%,192.168.1.88:0.00033%,192.168.1.87:7e-05%]
[INFO] ** type:[log:99.99971%,control:0.00025%,alert:4e-05%]
[INFO] ** i/f_name:[eth1:99.99874%,0:0.00125%,geod daemon:0.0%]
[INFO] ** i/f_dir:[outbound:99.99885%,inbound:0.00115%]
[INFO] ** src:[192.168.1.60:38.2948%,192.168.1.10:26.01345%,192.168.1.30:18.17431%,192.168.1.20:17.51427%,0:0.00093%,192.168.1.88:0.0005%,192.168.1.201:0.00034%,192.168.1.40:0.00033%,192.168.1.49:0.00027%,192.168.1.19:0.00022%,192.168.1.200:0.00019%,192.168.1.136:0.00018%,192.168.1.199:0.00011%,192.168.1.134:5e-05%,192.168.1.202:3e-05%,10.15.51.65:0.0%]
[INFO] ** dst:[192.168.1.20:43.33637%,192.168.1.10:20.97152%,192.168.1.40:18.1742%,192.168.1.30:17.51405%,0:0.00126%,192.168.1.50:0.00098%,192.168.1.255:0.0004%,192.168.1.201:0.00027%,192.168.1.60:0.00025%,224.0.0.252:0.00023%,224.0.0.251:0.00013%,192.168.1.88:9e-05%,239.255.255.250:7e-05%,192.168.1.200:7e-05%,192.168.1.19:4e-05%,192.168.1.100:4e-05%,192.168.1.49:2e-05%,239.192.4.191:1e-05%]
[INFO] ** proto:[tcp:99.99788%,0:0.00126%,udp:0.00087%]
[INFO] ** appi_name:[CIP_read_tag_service:99.99716%,0:0.00131%,LLMNR Protocol:0.00021%,NetBIOS Name Service:0.00021%,NetBIOS Datagram Service:0.0002%,Unknown Traffic:0.00017%,DCE-RPC Protocol:0.00016%,Multicast DNS Protocol (mDNS):0.00013%,SSDP:7e-05%,EtherNet/IP:4e-05%,Web Browsing:4e-05%,CIP_gen:4e-05%,OSIsoft PI:4e-05%,Common Industrial Protocol:3e-05%,Common Industrial Protocol - RMW (Read/Modify/Write):3e-05%,VNC:3e-05%,Server Message Block (SMB):3e-05%,Common Industrial Protocol - get attribute single:2e-05%,NetBIOS Session Service:2e-05%,Common Industrial Protocol - multiple service packet:2e-05%,Common Industrial Protocol - get attribute all:1e-05%,CIP_write_tag_service:0.0%,DNP3 Protocol - initialize data to defaults:0.0%,Common Industrial Protocol - success:0.0%,Google Chrome:0.0%,CIP_func75:0.0%]
[INFO] ** proxy_src_ip:[192.168.1.60:38.2948%,192.168.1.10:26.01345%,192.168.1.30:18.17431%,192.168.1.20:17.51427%,0:0.00131%,192.168.1.40:0.00033%,192.168.1.201:0.00032%,192.168.1.49:0.00027%,192.168.1.19:0.00022%,192.168.1.136:0.00018%,192.168.1.200:0.00018%,192.168.1.88:0.00017%,192.168.1.199:0.0001%,192.168.1.134:4e-05%,192.168.1.202:3e-05%,10.15.51.65:0.0%]
[INFO] ** modbus_function_code:[0.9743589744:99.99716%,0.0:0.0028%,1.0:4e-05%,0.9615384615000001:0.0%,0.9871794872:0.0%]
[INFO] ** modbus_function_description:[Read Tag Service - Response:49.99938%,Read Tag Service:49.99778%,0:0.0028%,Forward Close - Response:4e-05%,Unknown Function Code:0.0%,Write Tag Service:0.0%]
[INFO] ** modbus_transaction_id:65536 (0.26405%)
[INFO] ** scada_tag:[HMI_FIT201:26.01249%,HMI_LIT101:20.97131%,HMI_LIT401:18.17379%,HMI_LIT301:17.51357%,HMI_AIT202:17.32325%,0:0.0056%]
[INFO] ** service:[0.7025755984000001:99.99736%,0.0:0.00126%,0.08394601119999999:0.00023%,0.0021633145999999997:0.00021%,0.0021476384:0.00021%,0.0208806885:0.00017%,0.002116286:0.00017%,0.08391465880000001:0.00013%,0.0297847659:7e-05%,0.0021789908:5e-05%,0.0012540954:5e-05%,0.09248953609999999:4e-05%,0.08543524949999999:4e-05%,0.0348324999:1e-05%,1.0:0.0%]
[INFO] ** s_port:[0.834280824:26.01285%,0.8139250565:20.97143%,0.8029830673999999:18.17391%,0.8149336757:17.51381%,0.8137722355:17.32337%,0.0:0.00126%,0.814841983:0.00035%,0.8059172320999999:0.00033%,0.8343113882:0.00029%,0.8030136315999999:0.00025%,0.0020936488:0.00021%,0.0021089309:0.00021%,0.8345253376999999:0.00018%,0.8030441959000001:0.00014%,0.8344030809:0.00014%,0.0818051226:0.00013%,0.8147502904:0.00011%,0.8166299895999999:9e-05%,0.7788831836:4e-05%,0.8411730545999999:4e-05%,0.15240846019999998:4e-05%,0.7586191087:4e-05%,0.9834647595:4e-05%,0.9715599976:4e-05%,0.7593068036:4e-05%,0.15243902439999998:4e-05%,0.315972859:4e-05%,0.0290360046:3e-05%,0.2528119078:3e-05%,0.8876612262000001:3e-05%,0.9344397579000001:3e-05%,0.9535729568000001:3e-05%,0.1074484993:2e-05%,0.792988569:2e-05%,0.9502261752:2e-05%,0.7579772602:2e-05%,0.705452656:2e-05%,0.7414573018:2e-05%,0.7077908184999999:2e-05%,0.6970474968000001:2e-05%,0.8868054282:2e-05%,0.9802707989:2e-05%,0.9054801638:2e-05%,0.6452258696000001:2e-05%,0.8685433095:1e-05%,0.980989058:1e-05%,0.8465523565:1e-05%,0.9621003729000001:1e-05%,0.8831377224:1e-05%,0.9399107525:1e-05%,0.7825203251999999:1e-05%,0.9004676325:1e-05%,0.8212604682:1e-05%,0.9088575095999999:1e-05%,0.8738156367000001:1e-05%,0.8711259856999999:1e-05%,0.8643407299:1e-05%,0.8668928418999999:1e-05%,0.45597224770000006:1e-05%,0.7897640443:1e-05%,0.0339568433:1e-05%,0.905082829:1e-05%,0.8870957883:1e-05%,1.0:1e-05%,0.9156580476:0.0%,0.8683752063:0.0%,0.8935448376999999:0.0%,0.1074637814:0.0%,0.9339660126:0.0%,0.8591448133:0.0%,0.9842747112000001:0.0%,0.9034629256000001:0.0%,0.8262729995999999:0.0%,0.0818356868:0.0%,0.8881655358:0.0%,0.8916498562999999:0.0%,0.8985420868999999:0.0%,0.7673146279999999:0.0%,0.9765266826000001:0.0%,0.8673054588:0.0%,0.7918882572:0.0%,0.7891527599:0.0%,0.8431597286:0.0%,0.9104621309:0.0%]
[INFO] ** classification:[normal:75.94865%,Single Stage Single Point:20.68165%,Multi Stage Single Point:1.90264%,Single Stage Multi Point:0.95195%,Multi Stage Multi Point:0.5151%]
[INFO] columns with count within 2-10 {'orig': 3, 'type': 3, 'i/f_name': 3, 'i/f_dir': 2, 'proto': 3, 'modbus_function_code': 5, 'modbus_function_description': 6, 'scada_tag': 6, 'classification': 5}
--------------AFTER DROPPING COLUMNS ----------------
df.columns Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object') 17
          unixtime          orig type i/f_name   i/f_dir           src  \
0         0.000000  192.168.1.48  log     eth1  outbound  192.168.1.60   
1         0.000000  192.168.1.48  log     eth1  outbound  192.168.1.10   
2         0.000000  192.168.1.48  log     eth1  outbound  192.168.1.30   
3         0.000000  192.168.1.48  log     eth1  outbound  192.168.1.20   
4         0.000000  192.168.1.48  log     eth1  outbound  192.168.1.60   
...            ...           ...  ...      ...       ...           ...   
24819970  0.587998  192.168.1.48  log     eth1  outbound  192.168.1.60   
24819971  0.587998  192.168.1.48  log     eth1  outbound  192.168.1.60   
24819972  0.587998  192.168.1.48  log     eth1  outbound  192.168.1.60   
24819973  0.587998  192.168.1.48  log     eth1  outbound  192.168.1.10   
24819974  0.587998  192.168.1.48  log     eth1  outbound  192.168.1.20   

                   dst proto             appi_name  proxy_src_ip  \
0         192.168.1.20   tcp  CIP_read_tag_service  192.168.1.60   
1         192.168.1.20   tcp  CIP_read_tag_service  192.168.1.10   
2         192.168.1.40   tcp  CIP_read_tag_service  192.168.1.30   
3         192.168.1.30   tcp  CIP_read_tag_service  192.168.1.20   
4         192.168.1.10   tcp  CIP_read_tag_service  192.168.1.60   
...                ...   ...                   ...           ...   
24819970  192.168.1.10   tcp  CIP_read_tag_service  192.168.1.60   
24819971  192.168.1.20   tcp  CIP_read_tag_service  192.168.1.60   
24819972  192.168.1.10   tcp  CIP_read_tag_service  192.168.1.60   
24819973  192.168.1.20   tcp  CIP_read_tag_service  192.168.1.10   
24819974  192.168.1.30   tcp  CIP_read_tag_service  192.168.1.20   

          modbus_function_code  modbus_function_description  \
0                     0.974359  Read Tag Service - Response   
1                     0.974359  Read Tag Service - Response   
2                     0.974359             Read Tag Service   
3                     0.974359             Read Tag Service   
4                     0.974359             Read Tag Service   
...                        ...                          ...   
24819970              0.974359             Read Tag Service   
24819971              0.974359             Read Tag Service   
24819972              0.974359  Read Tag Service - Response   
24819973              0.974359  Read Tag Service - Response   
24819974              0.974359             Read Tag Service   

          modbus_transaction_id   scada_tag   service    s_port  \
0                      0.105043  HMI_AIT202  0.702576  0.813772   
1                      0.049699  HMI_FIT201  0.702576  0.834281   
2                      0.760021  HMI_LIT401  0.702576  0.802983   
3                      0.724208  HMI_LIT301  0.702576  0.814934   
4                      0.099031  HMI_LIT101  0.702576  0.813925   
...                         ...         ...       ...       ...   
24819970               0.724636  HMI_LIT101  0.702576  0.813925   
24819971               0.447852  HMI_AIT202  0.702576  0.813772   
24819972               0.724636  HMI_LIT101  0.702576  0.813925   
24819973               0.652247  HMI_FIT201  0.702576  0.834281   
24819974               0.004623  HMI_LIT301  0.702576  0.814934   

                     classification  
0                            normal  
1                            normal  
2                            normal  
3                            normal  
4                            normal  
...                             ...  
24819970                     normal  
24819971                     normal  
24819972                     normal  
24819973                     normal  
24819974  Single Stage Single Point  

[24819975 rows x 17 columns]
[INFO] Shape when encoding dataset: (24819975, 17)
[33mencode_text_dummy orig[0m
[33mencode_text_dummy type[0m
[33mencode_text_dummy i/f_name[0m
[33mencode_text_dummy i/f_dir[0m
[33mencode_text_dummy src[0m
[33mencode_text_dummy dst[0m
[33mencode_text_dummy proto[0m
[33mencode_text_dummy appi_name[0m
[33mencode_text_dummy proxy_src_ip[0m
[33mencode_text_dummy modbus_function_description[0m
[33mencode_text_dummy scada_tag[0m
missing -1
len(df.columns) 108
numFeatures 107
[INFO] Shape AFTER encoding dataset: (24819975, 108)
[INFO] processing batch 0-256000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99297%,0.0:0.00664%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:57548 (22.47969%)
[INFO] ** service:[0.7025755984000001:99.99453%,0.0021476384:0.00117%,0.0:0.00117%,0.0021789908:0.00078%,0.0021633145999999997:0.00078%,0.08391465880000001:0.00078%,0.0297847659:0.00039%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:25.90586%,0.8139250565:21.04297%,0.8029830673999999:18.20469%,0.8149336757:17.47891%,0.8137722355:17.3582%,0.792988569:0.00156%,0.0:0.00117%,0.0020936488:0.00117%,0.0021089309:0.00078%,0.814841983:0.00078%,0.8059172320999999:0.00078%,0.7897640443:0.00078%,0.0818051226:0.00078%,0.0290360046:0.00039%,0.8030441959000001:0.00039%,0.980989058:0.00039%,0.8345253376999999:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.09375%,1:25.90625%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99727%,1:0.00273%]
[INFO] ** src-192.168.1.19:[0:99.99727%,1:0.00273%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.52031%,1:17.47969%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.79492%,1:18.20508%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.59883%,1:38.40117%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.95547%,1:21.04453%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.73555%,1:43.26445%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.30:[0:82.5207%,1:17.4793%]
[INFO] ** dst-192.168.1.40:[0:81.79531%,1:18.20469%]
[INFO] ** dst-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99531%,0:0.00469%]
[INFO] ** proto-udp:[0:99.99648%,1:0.00352%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99297%,0:0.00703%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.09375%,1:25.90625%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52031%,1:17.47969%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.79492%,1:18.20508%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.59883%,1:38.40117%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99336%,1:0.00664%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00508%,1:49.99492%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.98984%,1:0.01016%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64219%,1:17.35781%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.09453%,1:25.90547%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95703%,1:21.04297%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.52109%,1:17.47891%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.79531%,1:18.20469%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 8, 'type-alert': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-SSDP': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}2020-02-09 12:45:22.207659: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/binary_crossentropy/weighted_loss/concat'.
2020-02-09 12:45:22.230522: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 12:45:22.240001: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 12:45:22.326661: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-09 12:45:22.332887: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/binary_crossentropy/weighted_loss/concat'.
2020-02-09 12:45:22.339951: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 12:45:22.346394: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 12:45:22.373816: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-09 12:45:30.257550: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/binary_crossentropy/weighted_loss/concat'.
2020-02-09 12:45:30.263784: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 12:45:30.266451: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 12:45:30.288074: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-09 12:45:30.289506: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/binary_crossentropy/weighted_loss/concat'.
2020-02-09 12:45:30.291155: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 12:45:30.292806: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 12:45:30.302455: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.

[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [256000.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 10s - loss: 0.6075 - tp: 191488.0000 - fp: 140.0000 - tn: 191860.0000 - fn: 512.0000 - accuracy: 0.9983 - precision: 0.9993 - recall: 0.9973 - auc: 0.9996 - val_loss: 0.5293 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-0-256000
[INFO] processing batch 256000-512000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:694 (0.27109%)
[INFO] ** modbus_function_code:[0.9743589744:99.99297%,0.0:0.00703%]
[INFO] ** modbus_transaction_id:65264 (25.49375%)
[INFO] ** service:[0.7025755984000001:99.99297%,0.0208806885:0.00156%,0.002116286:0.00117%,0.0:0.00117%,0.08394601119999999:0.00078%,0.0021789908:0.00078%,0.0021476384:0.00078%,0.08543524949999999:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:25.89492%,0.8139250565:21.03672%,0.8029830673999999:18.12031%,0.8149336757:17.56719%,0.8137722355:17.37266%,0.0:0.00117%,0.0020936488:0.00078%,0.8685433095:0.00078%,0.8344030809:0.00039%,0.15240846019999998:0.00039%,0.15243902439999998:0.00039%,0.7593068036:0.00039%,0.9399107525:0.00039%,0.315972859:0.00039%,0.8668928418999999:0.00039%,0.8030136315999999:0.00039%,0.8876612262000001:0.00039%,0.0021089309:0.00039%,0.7586191087:0.00039%,0.8643407299:0.00039%,0.814841983:0.00039%,0.8411730545999999:0.00039%]
[INFO] ** classification:[normal:57.36133%,Single Stage Single Point:42.63867%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.10469%,1:25.89531%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.43242%,1:17.56758%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8793%,1:18.1207%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.60:[0:61.59062%,1:38.40938%]
[INFO] ** src-192.168.1.88:[0:99.99883%,1:0.00117%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.96328%,1:21.03672%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.20:[0:56.73242%,1:43.26758%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99766%,1:0.00234%]
[INFO] ** dst-192.168.1.255:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.30:[0:82.43281%,1:17.56719%]
[INFO] ** dst-192.168.1.40:[0:81.8793%,1:18.1207%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99688%,0:0.00312%]
[INFO] ** proto-udp:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99297%,0:0.00703%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.10469%,1:25.89531%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.43242%,1:17.56758%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8793%,1:18.1207%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.59062%,1:38.40938%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-0:[0:99.99297%,1:0.00703%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00391%,1:49.99609%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00312%,1:49.99688%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99062%,1:0.00938%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.62734%,1:17.37266%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.10508%,1:25.89492%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96367%,1:21.03633%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.4332%,1:17.5668%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.88008%,1:18.11992%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 9, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-Server Message Block (SMB)': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255994, 255996, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [0. 1.]
 [0. 1.]
 [1. 0.]]
z vector sum [146845. 109155.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 8s - loss: 0.6776 - tp: 112918.0000 - fp: 79082.0000 - tn: 112918.0000 - fn: 79082.0000 - accuracy: 0.5881 - precision: 0.5881 - recall: 0.5881 - auc: 0.5881 - val_loss: 0.6988 - val_tp: 33927.0000 - val_fp: 30073.0000 - val_tn: 33927.0000 - val_fn: 30073.0000 - val_accuracy: 0.5301 - val_precision: 0.5301 - val_recall: 0.5301 - val_auc: 0.5301
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-256000-512000
[INFO] processing batch 512000-768000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:697 (0.27227%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.002116286:0.00039%]
[INFO] ** s_port:[0.834280824:25.95469%,0.8139250565:20.98125%,0.8029830673999999:18.17227%,0.8149336757:17.52461%,0.8137722355:17.36484%,0.8030136315999999:0.00039%,0.9621003729000001:0.00039%,0.8345253376999999:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:78.25859%,Single Stage Single Point:21.74141%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04453%,1:25.95547%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.47461%,1:17.52539%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.82734%,1:18.17266%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.65391%,1:38.34609%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.01875%,1:20.98125%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.68047%,1:43.31953%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.475%,1:17.525%]
[INFO] ** dst-192.168.1.40:[0:81.82734%,1:18.17266%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04453%,1:25.95547%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.47461%,1:17.52539%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82734%,1:18.17266%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.65391%,1:38.34609%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.63516%,1:17.36484%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04609%,1:25.95391%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.01875%,1:20.98125%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.47578%,1:17.52422%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82773%,1:18.17227%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      3, ..., 255994, 255995, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [0. 1.]
 ...
 [0. 1.]
 [0. 1.]
 [1. 0.]]
z vector sum [200342.  55658.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 7s - loss: 0.6200 - tp: 138284.0000 - fp: 53716.0000 - tn: 138284.0000 - fn: 53716.0000 - accuracy: 0.7202 - precision: 0.7202 - recall: 0.7202 - auc: 0.7215 - val_loss: 0.4804 - val_tp: 62058.0000 - val_fp: 1942.0000 - val_tn: 62058.0000 - val_fn: 1942.0000 - val_accuracy: 0.9697 - val_precision: 0.9697 - val_recall: 0.9697 - val_auc: 0.9697
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-512000-768000
[INFO] processing batch 768000-1024000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:698 (0.27266%)
[INFO] ** modbus_function_code:[0.9743589744:99.99531%,0.0:0.0043%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:63824 (24.93125%)
[INFO] ** service:[0.7025755984000001:99.9957%,0.0208806885:0.00117%,0.0:0.00117%,0.0012540954:0.00078%,0.0348324999:0.00039%,0.0021633145999999997:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.96758%,0.8139250565:21.09844%,0.8029830673999999:18.08594%,0.8149336757:17.48789%,0.8137722355:17.35352%,0.0:0.00117%,0.7788831836:0.00078%,0.0020936488:0.00039%,0.814841983:0.00039%,0.8030441959000001:0.00039%,0.8147502904:0.00039%,0.8343113882:0.00039%,0.8059172320999999:0.00039%,0.792988569:0.00039%,0.8411730545999999:0.00039%,0.15240846019999998:0.00039%,0.0339568433:0.00039%,0.315972859:0.00039%,0.0021089309:0.00039%]
[INFO] ** classification:[normal:67.51602%,Single Stage Single Point:32.48398%]
[INFO] ** orig-192.168.1.48:[1:99.99961%,0:0.00039%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.03203%,1:25.96797%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.51133%,1:17.48867%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.91328%,1:18.08672%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.54805%,1:38.45195%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.90117%,1:21.09883%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.67852%,1:43.32148%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.255:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.30:[0:82.51211%,1:17.48789%]
[INFO] ** dst-192.168.1.40:[0:81.91367%,1:18.08633%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99766%,0:0.00234%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99531%,0:0.00469%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03203%,1:25.96797%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.51133%,1:17.48867%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.91328%,1:18.08672%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.54805%,1:38.45195%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.9957%,1:0.0043%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99258%,1:0.00742%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64687%,1:17.35312%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03242%,1:25.96758%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.90156%,1:21.09844%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5125%,1:17.4875%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.91406%,1:18.08594%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 7, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'type-alert': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.88': 2, 'dst-239.192.4.191': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-Unknown Traffic': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      3,      4, ..., 255995, 255998, 255999]),)
y_vector [[0. 1.]
 [1. 0.]
 [0. 1.]
 ...
 [0. 1.]
 [1. 0.]
 [1. 0.]]
z vector sum [172841.  83159.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 8s - loss: 0.6690 - tp: 117250.0000 - fp: 74750.0000 - tn: 117250.0000 - fn: 74750.0000 - accuracy: 0.6107 - precision: 0.6107 - recall: 0.6107 - auc: 0.6106 - val_loss: 0.5395 - val_tp: 55591.0000 - val_fp: 8409.0000 - val_tn: 55591.0000 - val_fn: 8409.0000 - val_accuracy: 0.8686 - val_precision: 0.8686 - val_recall: 0.8686 - val_auc: 0.8686
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-768000-1024000
[INFO] processing batch 1024000-1280000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:699 (0.27305%)
[INFO] ** modbus_function_code:[0.9743589744:99.9875%,0.0:0.0125%]
[INFO] ** modbus_transaction_id:53455 (20.88086%)
[INFO] ** service:[0.7025755984000001:99.9875%,0.08394601119999999:0.00234%,0.0021633145999999997:0.00195%,0.0:0.00195%,0.002116286:0.00156%,0.0021476384:0.00156%,0.0297847659:0.00078%,0.0208806885:0.00078%,0.08391465880000001:0.00078%,0.08543524949999999:0.00039%,0.09248953609999999:0.00039%]
[INFO] ** s_port:[0.834280824:25.9625%,0.8139250565:21.11836%,0.8029830673999999:18.14102%,0.8149336757:17.43203%,0.8137722355:17.33203%,0.0021089309:0.00195%,0.0:0.00195%,0.0020936488:0.00156%,0.8343113882:0.00078%,0.0818051226:0.00078%,0.8166299895999999:0.00078%,0.9765266826000001:0.00039%,0.9399107525:0.00039%,0.814841983:0.00039%,0.9834647595:0.00039%,0.8643407299:0.00039%,0.7586191087:0.00039%,0.8030441959000001:0.00039%,0.980989058:0.00039%,0.8668928418999999:0.00039%,0.7593068036:0.00039%,0.9344397579000001:0.00039%,0.0290360046:0.00039%,0.8738156367000001:0.00039%,0.15243902439999998:0.00039%,0.9621003729000001:0.00039%,0.9715599976:0.00039%]
[INFO] ** classification:[normal:77.33086%,Single Stage Single Point:22.66914%]
[INFO] ** orig-192.168.1.48:[1:99.99805%,0:0.00195%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99805%,1:0.00195%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_name-eth1:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_dir-outbound:[1:99.99805%,0:0.00195%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.10:[0:74.03672%,1:25.96328%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.56758%,1:17.43242%]
[INFO] ** src-192.168.1.200:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.201:[0:99.99727%,1:0.00273%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.85859%,1:18.14141%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.60:[0:61.54961%,1:38.45039%]
[INFO] ** src-192.168.1.88:[0:99.99688%,1:0.00312%]
[INFO] ** dst-0:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.10:[0:78.88164%,1:21.11836%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.70508%,1:43.29492%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.255:[0:99.99648%,1:0.00352%]
[INFO] ** dst-192.168.1.30:[0:82.56797%,1:17.43203%]
[INFO] ** dst-192.168.1.40:[0:81.85898%,1:18.14102%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99766%,1:0.00234%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99922%,1:0.00078%]
[INFO] ** proto-0:[0:99.99805%,1:0.00195%]
[INFO] ** proto-tcp:[1:99.99062%,0:0.00938%]
[INFO] ** proto-udp:[0:99.99258%,1:0.00742%]
[INFO] ** appi_name-0:[0:99.99648%,1:0.00352%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.9875%,0:0.0125%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99648%,1:0.00352%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03672%,1:25.96328%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.56758%,1:17.43242%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.85859%,1:18.14141%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.54961%,1:38.45039%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-0:[0:99.9875%,1:0.0125%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00703%,1:49.99297%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00547%,1:49.99453%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.98477%,1:0.01523%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66836%,1:17.33164%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.03789%,1:25.96211%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.88203%,1:21.11797%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.56797%,1:17.43203%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.85898%,1:18.14102%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-10.15.51.65': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-SSDP': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-10.15.51.65': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      5, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [0. 1.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [197967.  58033.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 9s - loss: 0.6207 - tp: 133967.0000 - fp: 58033.0000 - tn: 133967.0000 - fn: 58033.0000 - accuracy: 0.6977 - precision: 0.6977 - recall: 0.6977 - auc: 0.6984 - val_loss: 0.4251 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-1024000-1280000
[INFO] processing batch 1280000-1536000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00312%]
[INFO] ** modbus_transaction_id:61506 (24.02578%)
[INFO] ** service:[0.7025755984000001:99.99688%,0.08394601119999999:0.00117%,0.0:0.00078%,0.0021789908:0.00039%,0.0021633145999999997:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.96719%,0.8139250565:21.03398%,0.8029830673999999:18.2%,0.8149336757:17.47969%,0.8137722355:17.31445%,0.8166299895999999:0.00078%,0.0:0.00078%,0.8059172320999999:0.00039%,0.8685433095:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8876612262000001:0.00039%,0.0021089309:0.00039%,0.0020936488:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.03203%,1:25.96797%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.52031%,1:17.47969%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.79961%,1:18.20039%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.65156%,1:38.34844%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:78.96602%,1:21.03398%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.20:[0:56.71836%,1:43.28164%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.30:[0:82.51992%,1:17.48008%]
[INFO] ** dst-192.168.1.40:[0:81.79961%,1:18.20039%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99883%,1:0.00117%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.03203%,1:25.96797%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52031%,1:17.47969%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.79961%,1:18.20039%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.65156%,1:38.34844%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99688%,1:0.00312%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99414%,1:0.00586%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.68555%,1:17.31445%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.0332%,1:25.9668%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.96602%,1:21.03398%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.5207%,1:17.4793%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.80039%,1:18.19961%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 6, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [256000.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 8s - loss: 0.3313 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 192000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.2628 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-1280000-1536000
[INFO] processing batch 1536000-1792000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:697 (0.27227%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65533 (25.59883%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:25.99258%,0.8139250565:21.06133%,0.8029830673999999:18.11328%,0.8149336757:17.46836%,0.8137722355:17.36289%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.814841983:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:99.99961%,Single Stage Single Point:0.00039%]
[INFO] ** orig-192.168.1.48:[1:99.99961%,0:0.00039%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.00742%,1:25.99258%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.53125%,1:17.46875%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.88633%,1:18.11367%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.57578%,1:38.42422%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:78.93867%,1:21.06133%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64453%,1:43.35547%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.53164%,1:17.46836%]
[INFO] ** dst-192.168.1.40:[0:81.88672%,1:18.11328%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.00742%,1:25.99258%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.53125%,1:17.46875%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.88633%,1:18.11367%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.57578%,1:38.42422%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99766%,1:0.00234%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.63711%,1:17.36289%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.00781%,1:25.99219%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.93867%,1:21.06133%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.53203%,1:17.46797%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.88672%,1:18.11328%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 9, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [2.55999e+05 1.00000e+00]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 8s - loss: 0.2225 - tp: 191999.0000 - fp: 1.0000 - tn: 191999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1890 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-1536000-1792000
[INFO] processing batch 1792000-2048000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:707 (0.27617%)
[INFO] ** modbus_function_code:[0.9743589744:99.99531%,0.0:0.00469%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.9957%,0.0:0.00391%,0.09248953609999999:0.00039%]
[INFO] ** s_port:[0.834280824:26.13906%,0.8139250565:20.75586%,0.8029830673999999:18.23828%,0.8149336757:17.6168%,0.8137722355:17.2418%,0.0:0.00391%,0.8343113882:0.00078%,0.814841983:0.00078%,0.8059172320999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.2528119078:0.00039%,0.8147502904:0.00039%,0.8030441959000001:0.00039%,0.9834647595:0.00039%]
[INFO] ** classification:[normal:80.53203%,Single Stage Single Point:19.46797%]
[INFO] ** orig-192.168.1.48:[1:99.99688%,0:0.00312%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99688%,1:0.00312%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99609%,1:0.00391%]
[INFO] ** i/f_name-eth1:[1:99.99609%,0:0.00391%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99688%,1:0.00312%]
[INFO] ** i/f_dir-outbound:[1:99.99688%,0:0.00312%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.85938%,1:26.14062%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.38203%,1:17.61797%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.76133%,1:18.23867%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:62.00234%,1:37.99766%]
[INFO] ** src-192.168.1.88:[0:99.99688%,1:0.00312%]
[INFO] ** dst-0:[0:99.99609%,1:0.00391%]
[INFO] ** dst-192.168.1.10:[0:79.24375%,1:20.75625%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.61875%,1:43.38125%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.38281%,1:17.61719%]
[INFO] ** dst-192.168.1.40:[0:81.76094%,1:18.23906%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99609%,1:0.00391%]
[INFO] ** proto-tcp:[1:99.99609%,0:0.00391%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99609%,1:0.00391%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99531%,0:0.00469%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99609%,1:0.00391%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.85938%,1:26.14062%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.38203%,1:17.61797%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.76133%,1:18.23867%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:62.00234%,1:37.99766%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99531%,1:0.00469%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.0043%,1:49.9957%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99062%,1:0.00938%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75859%,1:17.24141%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.86094%,1:26.13906%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.24453%,1:20.75547%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.3832%,1:17.6168%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.76211%,1:18.23789%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - multiple service packet': 2, 'appi_name-VNC': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255995, 255996, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [0. 1.]
 [0. 1.]
 [1. 0.]]
z vector sum [206162.  49838.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 8s - loss: 0.5449 - tp: 148221.0000 - fp: 43779.0000 - tn: 148221.0000 - fn: 43779.0000 - accuracy: 0.7720 - precision: 0.7720 - recall: 0.7720 - auc: 0.7721 - val_loss: 0.3453 - val_tp: 57941.0000 - val_fp: 6059.0000 - val_tn: 57941.0000 - val_fn: 6059.0000 - val_accuracy: 0.9053 - val_precision: 0.9053 - val_recall: 0.9053 - val_auc: 0.9053
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-1792000-2048000
[INFO] processing batch 2048000-2304000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:704 (0.275%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00312%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99688%,0.0:0.00273%,0.0012540954:0.00039%]
[INFO] ** s_port:[0.834280824:26.12969%,0.8139250565:20.76406%,0.8029830673999999:18.24258%,0.8149336757:17.61289%,0.8137722355:17.24648%,0.0:0.00273%,0.8030136315999999:0.00039%,0.8431597286:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:80.35703%,Single Stage Single Point:19.64297%]
[INFO] ** orig-192.168.1.48:[1:99.99766%,0:0.00234%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99766%,1:0.00234%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_name-eth1:[1:99.99727%,0:0.00273%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_dir-outbound:[1:99.99727%,0:0.00273%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.86992%,1:26.13008%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.38672%,1:17.61328%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.75703%,1:18.24297%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.98945%,1:38.01055%]
[INFO] ** src-192.168.1.88:[0:99.99766%,1:0.00234%]
[INFO] ** dst-0:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.10:[0:79.23594%,1:20.76406%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.62383%,1:43.37617%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.38711%,1:17.61289%]
[INFO] ** dst-192.168.1.40:[0:81.75742%,1:18.24258%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99727%,1:0.00273%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.86992%,1:26.13008%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.38672%,1:17.61328%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.75703%,1:18.24297%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.98945%,1:38.01055%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99688%,1:0.00312%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75352%,1:17.24648%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.87109%,1:26.12891%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.23594%,1:20.76406%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.38711%,1:17.61289%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.75742%,1:18.24258%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Google Chrome': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255997, 255998, 255999]),)
y_vector [[0. 1.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [205714.  50286.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 7s - loss: 0.5874 - tp: 141714.0000 - fp: 50286.0000 - tn: 141714.0000 - fn: 50286.0000 - accuracy: 0.7381 - precision: 0.7381 - recall: 0.7381 - auc: 0.7377 - val_loss: 0.2352 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-2048000-2304000
[INFO] processing batch 2304000-2560000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99805%,0.0:0.00195%]
[INFO] ** modbus_transaction_id:65534 (25.59922%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0348324999:0.00039%,0.0021633145999999997:0.00039%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:26.11992%,0.8139250565:20.79062%,0.8029830673999999:18.25898%,0.8149336757:17.61406%,0.8137722355:17.21367%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.0339568433:0.00039%,0.0818051226:0.00039%,0.0021089309:0.00039%,0.2528119078:0.00039%,0.1074484993:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.88008%,1:26.11992%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.38594%,1:17.61406%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.74023%,1:18.25977%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.9957%,1:38.0043%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.20859%,1:20.79141%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66641%,1:43.33359%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.38594%,1:17.61406%]
[INFO] ** dst-192.168.1.40:[0:81.74102%,1:18.25898%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99805%,0:0.00195%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.88008%,1:26.11992%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.38594%,1:17.61406%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.74023%,1:18.25977%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.9957%,1:38.0043%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99805%,1:0.00195%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.78633%,1:17.21367%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.88008%,1:26.11992%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.20977%,1:20.79023%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.38633%,1:17.61367%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.74102%,1:18.25898%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'dst-239.192.4.191': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - get attribute all': 2, 'appi_name-Common Industrial Protocol - get attribute single': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [256000.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 7s - loss: 0.1946 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 192000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1606 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-2304000-2560000
[INFO] processing batch 2560000-2816000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:701 (0.27383%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65413 (25.55195%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.18945%,0.8139250565:20.77422%,0.8029830673999999:18.24023%,0.8149336757:17.56523%,0.8137722355:17.22891%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.80977%,1:26.19023%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.43438%,1:17.56562%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.75938%,1:18.24062%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.99688%,1:38.00312%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.22578%,1:20.77422%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.58125%,1:43.41875%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.43438%,1:17.56562%]
[INFO] ** dst-192.168.1.40:[0:81.75938%,1:18.24062%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.80977%,1:26.19023%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.43438%,1:17.56562%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.75938%,1:18.24062%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.99688%,1:38.00312%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99727%,1:0.00273%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.77109%,1:17.22891%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.81055%,1:26.18945%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.22617%,1:20.77383%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.43516%,1:17.56484%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.75977%,1:18.24023%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [256000.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 7s - loss: 0.1382 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 192000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1192 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-2560000-2816000
[INFO] processing batch 2816000-3072000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:701 (0.27383%)
[INFO] ** modbus_function_code:[0.9743589744:99.98984%,0.0:0.01016%]
[INFO] ** modbus_transaction_id:64676 (25.26406%)
[INFO] ** service:[0.7025755984000001:99.98984%,0.0:0.00742%,0.0297847659:0.00078%,0.08394601119999999:0.00078%,0.0021476384:0.00078%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:26.15078%,0.8139250565:20.64023%,0.8029830673999999:18.33633%,0.8149336757:17.66367%,0.8137722355:17.19766%,0.0:0.00742%,0.0020936488:0.00078%,0.9715599976:0.00039%,0.8059172320999999:0.00039%,0.980989058:0.00039%,0.0818051226:0.00039%,0.8738156367000001:0.00039%,0.0290360046:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:74.09414%,Single Stage Single Point:25.90586%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99805%,1:0.00195%]
[INFO] ** type-log:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-0:[0:99.99258%,1:0.00742%]
[INFO] ** i/f_name-eth1:[1:99.99258%,0:0.00742%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99297%,1:0.00703%]
[INFO] ** i/f_dir-outbound:[1:99.99297%,0:0.00703%]
[INFO] ** src-0:[0:99.99258%,1:0.00742%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.84883%,1:26.15117%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.33594%,1:17.66406%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.66367%,1:18.33633%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:62.16211%,1:37.83789%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99258%,1:0.00742%]
[INFO] ** dst-192.168.1.10:[0:79.35977%,1:20.64023%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65156%,1:43.34844%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.30:[0:82.33633%,1:17.66367%]
[INFO] ** dst-192.168.1.40:[0:81.66328%,1:18.33672%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99922%,1:0.00078%]
[INFO] ** proto-0:[0:99.99258%,1:0.00742%]
[INFO] ** proto-tcp:[1:99.98984%,0:0.01016%]
[INFO] ** proto-udp:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-0:[0:99.99258%,1:0.00742%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.98984%,0:0.01016%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99258%,1:0.00742%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.84883%,1:26.15117%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.33594%,1:17.66406%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.66367%,1:18.33633%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:62.16211%,1:37.83789%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.98984%,1:0.01016%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00547%,1:49.99453%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00469%,1:49.99531%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9875%,1:0.0125%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.80273%,1:17.19727%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.84961%,1:26.15039%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.35977%,1:20.64023%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.33633%,1:17.66367%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.66406%,1:18.33594%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 6, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255995, 255996, 255997]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [0. 1.]
 [0. 1.]]
z vector sum [189681.  66319.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 7s - loss: 0.5722 - tp: 148720.0000 - fp: 43280.0000 - tn: 148720.0000 - fn: 43280.0000 - accuracy: 0.7746 - precision: 0.7746 - recall: 0.7746 - auc: 0.7749 - val_loss: 0.8043 - val_tp: 40961.0000 - val_fp: 23039.0000 - val_tn: 40961.0000 - val_fn: 23039.0000 - val_accuracy: 0.6400 - val_precision: 0.6400 - val_recall: 0.6400 - val_auc: 0.6400
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-2816000-3072000
[INFO] processing batch 3072000-3328000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99648%,0.0:0.00352%]
[INFO] ** modbus_transaction_id:54629 (21.33945%)
[INFO] ** service:[0.7025755984000001:99.99648%,0.0:0.00156%,0.0021633145999999997:0.00078%,0.0021476384:0.00078%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:26.14023%,0.8139250565:20.83086%,0.8029830673999999:18.17813%,0.8149336757:17.62773%,0.8137722355:17.21641%,0.0:0.00156%,0.8030136315999999:0.00078%,0.0021089309:0.00078%,0.0020936488:0.00078%,0.8343113882:0.00078%,0.8059172320999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8876612262000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:76.36523%,Single Stage Single Point:23.63477%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_name-eth1:[1:99.99844%,0:0.00156%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99844%,1:0.00156%]
[INFO] ** i/f_dir-outbound:[1:99.99844%,0:0.00156%]
[INFO] ** src-0:[0:99.99844%,1:0.00156%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.8582%,1:26.1418%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.37188%,1:17.62812%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.82109%,1:18.17891%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.95273%,1:38.04727%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.10:[0:79.16914%,1:20.83086%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64336%,1:43.35664%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.30:[0:82.37188%,1:17.62812%]
[INFO] ** dst-192.168.1.40:[0:81.82148%,1:18.17852%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99844%,1:0.00156%]
[INFO] ** proto-tcp:[1:99.99648%,0:0.00352%]
[INFO] ** proto-udp:[0:99.99805%,1:0.00195%]
[INFO] ** appi_name-0:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99648%,0:0.00352%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.8582%,1:26.1418%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.37188%,1:17.62812%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.82109%,1:18.17891%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.95273%,1:38.04727%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99648%,1:0.00352%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00312%,1:49.99688%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99258%,1:0.00742%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.78359%,1:17.21641%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.86016%,1:26.13984%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.16914%,1:20.83086%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.37266%,1:17.62734%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82188%,1:18.17813%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     1,      2,      3, ..., 255997, 255998, 255999]),)
y_vector [[0. 1.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [195495.  60505.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 7s - loss: 0.6902 - tp: 131495.0000 - fp: 60505.0000 - tn: 131495.0000 - fn: 60505.0000 - accuracy: 0.6849 - precision: 0.6849 - recall: 0.6849 - auc: 0.6847 - val_loss: 0.2164 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-3072000-3328000
[INFO] processing batch 3328000-3584000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99531%,0.0:0.00469%]
[INFO] ** modbus_transaction_id:48170 (18.81641%)
[INFO] ** service:[0.7025755984000001:99.99531%,0.0208806885:0.00156%,0.08391465880000001:0.00078%,0.0:0.00078%,0.08543524949999999:0.00039%,0.0021633145999999997:0.00039%,0.002116286:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.125%,0.8139250565:20.73086%,0.8029830673999999:18.2793%,0.8149336757:17.60469%,0.8137722355:17.25391%,0.0:0.00078%,0.0818051226:0.00078%,0.0020936488:0.00039%,0.814841983:0.00039%,0.7586191087:0.00039%,0.8030441959000001:0.00039%,0.8343113882:0.00039%,0.8059172320999999:0.00039%,0.0021089309:0.00039%,0.7593068036:0.00039%,0.15240846019999998:0.00039%,0.15243902439999998:0.00039%,0.315972859:0.00039%,0.8411730545999999:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.87461%,1:26.12539%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.39492%,1:17.60508%]
[INFO] ** src-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.72031%,1:18.27969%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:62.01523%,1:37.98477%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:79.26914%,1:20.73086%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.6207%,1:43.3793%]
[INFO] ** dst-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.255:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.30:[0:82.39531%,1:17.60469%]
[INFO] ** dst-192.168.1.40:[0:81.7207%,1:18.2793%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99766%,0:0.00234%]
[INFO] ** proto-udp:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99531%,0:0.00469%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99844%,1:0.00156%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.87461%,1:26.12539%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.39492%,1:17.60508%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.72031%,1:18.27969%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:62.01523%,1:37.98477%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99531%,1:0.00469%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99336%,1:0.00664%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.74609%,1:17.25391%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.87539%,1:26.12461%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.26914%,1:20.73086%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.39531%,1:17.60469%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.7207%,1:18.2793%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 8, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [256000.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 7s - loss: 0.1802 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 192000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1491 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-3328000-3584000
[INFO] processing batch 3584000-3840000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00273%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.0:0.00117%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:26.11992%,0.8139250565:20.84648%,0.8029830673999999:18.15625%,0.8149336757:17.56992%,0.8137722355:17.30234%,0.6452258696000001:0.00156%,0.0:0.00117%,0.8059172320999999:0.00078%,0.8030136315999999:0.00039%,0.0818051226:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.87969%,1:26.12031%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.42969%,1:17.57031%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.84336%,1:18.15664%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.85117%,1:38.14883%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:79.15352%,1:20.84648%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.57773%,1:43.42227%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.43008%,1:17.56992%]
[INFO] ** dst-192.168.1.40:[0:81.84219%,1:18.15781%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.87969%,1:26.12031%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.42969%,1:17.57031%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84336%,1:18.15664%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.85117%,1:38.14883%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99727%,1:0.00273%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99375%,1:0.00625%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.69766%,1:17.30234%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.88086%,1:26.11914%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.15352%,1:20.84648%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.43047%,1:17.56953%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84375%,1:18.15625%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 3, 'type-alert': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [256000.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 7s - loss: 0.1285 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 192000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1110 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-3584000-3840000
[INFO] processing batch 3840000-4096000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:703 (0.27461%)
[INFO] ** modbus_function_code:[0.9743589744:99.99766%,0.0:0.00234%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.99766%,0.0:0.00117%,0.0021789908:0.00078%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.17852%,0.8139250565:20.77656%,0.8029830673999999:18.23789%,0.8149336757:17.56172%,0.8137722355:17.24063%,0.0:0.00117%,0.8711259856999999:0.00078%,0.814841983:0.00078%,0.8059172320999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.0020936488:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:81.93477%,Single Stage Single Point:18.06523%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.8207%,1:26.1793%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.43711%,1:17.56289%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.76211%,1:18.23789%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.98281%,1:38.01719%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:79.22344%,1:20.77656%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.20:[0:56.58086%,1:43.41914%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.43789%,1:17.56211%]
[INFO] ** dst-192.168.1.40:[0:81.76133%,1:18.23867%]
[INFO] ** dst-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99766%,0:0.00234%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.8207%,1:26.1793%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.43711%,1:17.56289%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.76211%,1:18.23789%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.98281%,1:38.01719%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99766%,1:0.00234%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75977%,1:17.24023%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.82148%,1:26.17852%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.22383%,1:20.77617%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.43828%,1:17.56172%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.76211%,1:18.23789%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [209753.  46247.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 7s - loss: 0.4897 - tp: 157534.0000 - fp: 34466.0000 - tn: 157534.0000 - fn: 34466.0000 - accuracy: 0.8205 - precision: 0.8205 - recall: 0.8205 - auc: 0.8202 - val_loss: 0.4928 - val_tp: 52219.0000 - val_fp: 11781.0000 - val_tn: 52219.0000 - val_fn: 11781.0000 - val_accuracy: 0.8159 - val_precision: 0.8159 - val_recall: 0.8159 - val_auc: 0.8159
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-3840000-4096000
[INFO] processing batch 4096000-4352000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:58132 (22.70781%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.08391465880000001:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:26.11641%,0.8139250565:20.75781%,0.8029830673999999:18.28242%,0.8149336757:17.6%,0.8137722355:17.24141%,0.0818051226:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:99.29219%,Single Stage Single Point:0.70781%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.8832%,1:26.1168%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.39961%,1:17.60039%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:62.00078%,1:37.99922%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:79.24219%,1:20.75781%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.6418%,1:43.3582%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.4%,1:17.6%]
[INFO] ** dst-192.168.1.40:[0:81.71758%,1:18.28242%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.8832%,1:26.1168%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.39961%,1:17.60039%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:62.00078%,1:37.99922%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99688%,1:0.00312%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75859%,1:17.24141%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.88438%,1:26.11562%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.24219%,1:20.75781%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.40039%,1:17.59961%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.71758%,1:18.28242%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [254188.   1812.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 9s - loss: 0.1343 - tp: 190188.0000 - fp: 1812.0000 - tn: 190188.0000 - fn: 1812.0000 - accuracy: 0.9906 - precision: 0.9906 - recall: 0.9906 - auc: 0.9903 - val_loss: 0.0988 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-4096000-4352000
[INFO] processing batch 4352000-4608000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:702 (0.27422%)
[INFO] ** modbus_function_code:[0.9743589744:99.99492%,0.0:0.00469%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:64698 (25.27266%)
[INFO] ** service:[0.7025755984000001:99.99648%,0.0:0.00234%,0.08394601119999999:0.00078%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.14844%,0.8139250565:20.81289%,0.8029830673999999:18.23438%,0.8149336757:17.55586%,0.8137722355:17.24141%,0.0:0.00234%,0.6970474968000001:0.00156%,0.8166299895999999:0.00078%,0.8343113882:0.00078%,0.8030136315999999:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-0:[0:99.99766%,1:0.00234%]
[INFO] ** i/f_name-eth1:[1:99.99766%,0:0.00234%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99766%,1:0.00234%]
[INFO] ** i/f_dir-outbound:[1:99.99766%,0:0.00234%]
[INFO] ** src-0:[0:99.99766%,1:0.00234%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.85039%,1:26.14961%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99844%,1:0.00156%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.44375%,1:17.55625%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.76523%,1:18.23477%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.9457%,1:38.0543%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99766%,1:0.00234%]
[INFO] ** dst-192.168.1.10:[0:79.18711%,1:20.81289%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.61016%,1:43.38984%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.44219%,1:17.55781%]
[INFO] ** dst-192.168.1.40:[0:81.76562%,1:18.23438%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99766%,1:0.00234%]
[INFO] ** proto-tcp:[1:99.99648%,0:0.00352%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99766%,1:0.00234%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99492%,0:0.00508%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.85039%,1:26.14961%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99844%,1:0.00156%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.44375%,1:17.55625%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.76523%,1:18.23477%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.9457%,1:38.0543%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99531%,1:0.00469%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00312%,1:49.99688%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99219%,1:0.00781%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75898%,1:17.24102%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.85195%,1:26.14805%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.18711%,1:20.81289%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.44414%,1:17.55586%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.76562%,1:18.23438%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 4, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-alert': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [256000.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 10s - loss: 0.0864 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 192000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0755 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-4352000-4608000
[INFO] processing batch 4608000-4864000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99609%,0.0:0.00391%]
[INFO] ** modbus_transaction_id:54680 (21.35938%)
[INFO] ** service:[0.7025755984000001:99.99609%,0.0:0.00234%,0.0021789908:0.00078%,0.08391465880000001:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.11484%,0.8139250565:20.79258%,0.8029830673999999:18.24414%,0.8149336757:17.55781%,0.8137722355:17.28555%,0.0:0.00234%,0.8831377224:0.00078%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.0818051226:0.00039%,0.0020936488:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:88.0668%,Single Stage Single Point:11.9332%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99805%,1:0.00195%]
[INFO] ** type-log:[1:99.99805%,0:0.00195%]
[INFO] ** i/f_name-0:[0:99.99766%,1:0.00234%]
[INFO] ** i/f_name-eth1:[1:99.99766%,0:0.00234%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99805%,1:0.00195%]
[INFO] ** i/f_dir-outbound:[1:99.99805%,0:0.00195%]
[INFO] ** src-0:[0:99.99766%,1:0.00234%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.88516%,1:26.11484%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.4418%,1:17.5582%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.75547%,1:18.24453%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.92188%,1:38.07812%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99766%,1:0.00234%]
[INFO] ** dst-192.168.1.10:[0:79.20742%,1:20.79258%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.20:[0:56.59961%,1:43.40039%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.44219%,1:17.55781%]
[INFO] ** dst-192.168.1.40:[0:81.75547%,1:18.24453%]
[INFO] ** dst-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99766%,1:0.00234%]
[INFO] ** proto-tcp:[1:99.99688%,0:0.00312%]
[INFO] ** proto-udp:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-0:[0:99.99766%,1:0.00234%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99609%,0:0.00391%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.88516%,1:26.11484%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.4418%,1:17.5582%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.75547%,1:18.24453%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.92188%,1:38.07812%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99609%,1:0.00391%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.71445%,1:17.28555%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.88555%,1:26.11445%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.20742%,1:20.79258%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.44219%,1:17.55781%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.75586%,1:18.24414%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [225451.  30549.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 9s - loss: 0.4700 - tp: 161451.0000 - fp: 30549.0000 - tn: 161451.0000 - fn: 30549.0000 - accuracy: 0.8409 - precision: 0.8409 - recall: 0.8409 - auc: 0.8403 - val_loss: 0.0975 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-4608000-4864000
[INFO] processing batch 4864000-5120000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:57519 (22.46836%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:26.1043%,0.8139250565:20.84141%,0.8029830673999999:18.19336%,0.8149336757:17.55039%,0.8137722355:17.30859%,0.8030136315999999:0.00039%,0.0818051226:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.89492%,1:26.10508%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.44961%,1:17.55039%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.80586%,1:18.19414%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.85%,1:38.15%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.15859%,1:20.84141%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.58672%,1:43.41328%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.44922%,1:17.55078%]
[INFO] ** dst-192.168.1.40:[0:81.80625%,1:18.19375%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:100.0%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.89492%,1:26.10508%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.44961%,1:17.55039%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.80586%,1:18.19414%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.85%,1:38.15%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.69141%,1:17.30859%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.89609%,1:26.10391%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.15898%,1:20.84102%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.45039%,1:17.54961%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.80664%,1:18.19336%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [256000.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 9s - loss: 0.0849 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 192000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0730 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-4864000-5120000
[INFO] processing batch 5120000-5376000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:699 (0.27305%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:62100 (24.25781%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:26.0957%,0.8139250565:20.8875%,0.8029830673999999:18.22148%,0.8149336757:17.5375%,0.8137722355:17.25469%,0.8059172320999999:0.00117%,0.814841983:0.00117%,0.8343113882:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.90391%,1:26.09609%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.46133%,1:17.53867%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.77852%,1:18.22148%]
[INFO] ** src-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.85781%,1:38.14219%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:79.1125%,1:20.8875%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64961%,1:43.35039%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.4625%,1:17.5375%]
[INFO] ** dst-192.168.1.40:[0:81.77852%,1:18.22148%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.90391%,1:26.09609%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.46133%,1:17.53867%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.77852%,1:18.22148%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.85781%,1:38.14219%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00117%,0:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9957%,1:0.0043%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.7457%,1:17.2543%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.90469%,1:26.09531%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.1125%,1:20.8875%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.4625%,1:17.5375%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.77891%,1:18.22109%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 9, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [256000.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 9s - loss: 0.0643 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 192000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0567 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-5120000-5376000
[INFO] processing batch 5376000-5632000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:703 (0.27461%)
[INFO] ** modbus_function_code:[0.9743589744:99.99766%,0.0:0.00234%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99766%,0.0:0.00117%,0.08394601119999999:0.00078%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.16484%,0.8139250565:20.91719%,0.8029830673999999:18.13555%,0.8149336757:17.49727%,0.8137722355:17.28086%,0.0:0.00117%,0.8166299895999999:0.00078%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:99.99922%,0:0.00078%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.83437%,1:26.16562%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.50195%,1:17.49805%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.86406%,1:18.13594%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.80195%,1:38.19805%]
[INFO] ** src-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:79.08281%,1:20.91719%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.5543%,1:43.4457%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.50234%,1:17.49766%]
[INFO] ** dst-192.168.1.40:[0:81.86367%,1:18.13633%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99766%,0:0.00234%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99766%,0:0.00234%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.83437%,1:26.16562%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50195%,1:17.49805%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.86406%,1:18.13594%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.80195%,1:38.19805%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99766%,1:0.00234%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99531%,1:0.00469%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.71914%,1:17.28086%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.83555%,1:26.16445%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.08281%,1:20.91719%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.50273%,1:17.49727%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.86445%,1:18.13555%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [256000.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 10s - loss: 0.0507 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 192000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0452 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-5376000-5632000
[INFO] processing batch 5632000-5888000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:704 (0.275%)
[INFO] ** modbus_function_code:[0.9743589744:99.99688%,0.0:0.00312%]
[INFO] ** modbus_transaction_id:65534 (25.59922%)
[INFO] ** service:[0.7025755984000001:99.99688%,0.0:0.00273%,0.09248953609999999:0.00039%]
[INFO] ** s_port:[0.834280824:26.13164%,0.8139250565:20.83203%,0.8029830673999999:18.21758%,0.8149336757:17.55508%,0.8137722355:17.25898%,0.0:0.00273%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.9834647595:0.00039%]
[INFO] ** classification:[normal:85.86289%,Single Stage Single Point:14.13711%]
[INFO] ** orig-192.168.1.48:[1:99.99727%,0:0.00273%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99727%,1:0.00273%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_name-eth1:[1:99.99727%,0:0.00273%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_dir-outbound:[1:99.99727%,0:0.00273%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.86797%,1:26.13203%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.44492%,1:17.55508%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.78164%,1:18.21836%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.90898%,1:38.09102%]
[INFO] ** src-192.168.1.88:[0:99.99727%,1:0.00273%]
[INFO] ** dst-0:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.10:[0:79.16797%,1:20.83203%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.60898%,1:43.39102%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.44492%,1:17.55508%]
[INFO] ** dst-192.168.1.40:[0:81.78242%,1:18.21758%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99727%,1:0.00273%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99688%,0:0.00312%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.86797%,1:26.13203%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.44492%,1:17.55508%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.78164%,1:18.21836%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.90898%,1:38.09102%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99688%,1:0.00312%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99414%,1:0.00586%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.74102%,1:17.25898%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.86875%,1:26.13125%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.16797%,1:20.83203%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.4457%,1:17.5543%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.78242%,1:18.21758%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-VNC': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [219809.  36191.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 7s - loss: 0.5869 - tp: 155809.0000 - fp: 36191.0000 - tn: 155809.0000 - fn: 36191.0000 - accuracy: 0.8115 - precision: 0.8115 - recall: 0.8115 - auc: 0.8117 - val_loss: 0.0759 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-5632000-5888000
[INFO] processing batch 5888000-6144000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99414%,0.0:0.00547%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:63474 (24.79453%)
[INFO] ** service:[0.7025755984000001:99.9957%,0.08391465880000001:0.00117%,0.0021633145999999997:0.00078%,0.0021476384:0.00078%,0.0:0.00078%,0.0297847659:0.00039%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:26.09609%,0.8139250565:20.79141%,0.8029830673999999:18.28281%,0.8149336757:17.57773%,0.8137722355:17.2457%,0.705452656:0.00156%,0.0818051226:0.00117%,0.0021089309:0.00078%,0.0020936488:0.00078%,0.0:0.00078%,0.8345253376999999:0.00039%,0.0290360046:0.00039%,0.9842747112000001:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.90352%,1:26.09648%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.42227%,1:17.57773%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.96289%,1:38.03711%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:79.20859%,1:20.79141%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.6582%,1:43.3418%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.30:[0:82.42031%,1:17.57969%]
[INFO] ** dst-192.168.1.40:[0:81.71719%,1:18.28281%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:100.0%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99883%,1:0.00117%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.9957%,0:0.0043%]
[INFO] ** proto-udp:[0:99.99648%,1:0.00352%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99414%,0:0.00586%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.90352%,1:26.09648%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.42227%,1:17.57773%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.96289%,1:38.03711%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99453%,1:0.00547%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00312%,1:49.99688%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99336%,1:0.00664%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.7543%,1:17.2457%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.9043%,1:26.0957%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.20859%,1:20.79141%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.42227%,1:17.57773%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.71719%,1:18.28281%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 7, 'type-alert': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [256000.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 9s - loss: 0.0679 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 192000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0598 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-5888000-6144000
[INFO] processing batch 6144000-6400000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:699 (0.27305%)
[INFO] ** modbus_function_code:[0.9743589744:99.99922%,0.0:0.00078%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99922%,0.08394601119999999:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:26.09102%,0.8139250565:20.84219%,0.8029830673999999:18.28203%,0.8149336757:17.53047%,0.8137722355:17.25%,0.8059172320999999:0.00117%,0.814841983:0.00078%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.8876612262000001:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:84.0875%,Single Stage Single Point:15.9125%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.9082%,1:26.0918%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.46875%,1:17.53125%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** src-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.90781%,1:38.09219%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:79.15781%,1:20.84219%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65859%,1:43.34141%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.46953%,1:17.53047%]
[INFO] ** dst-192.168.1.40:[0:81.71758%,1:18.28242%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99766%,1:0.00234%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99922%,0:0.00078%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99922%,0:0.00078%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.9082%,1:26.0918%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.46875%,1:17.53125%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.71719%,1:18.28281%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.90781%,1:38.09219%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00117%,0:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75039%,1:17.24961%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.90938%,1:26.09062%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.15781%,1:20.84219%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.46953%,1:17.53047%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.71797%,1:18.28203%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255996, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [0. 1.]
 [1. 0.]
 [1. 0.]]
z vector sum [215264.  40736.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 10s - loss: 0.3168 - tp: 174156.0000 - fp: 17844.0000 - tn: 174156.0000 - fn: 17844.0000 - accuracy: 0.9071 - precision: 0.9071 - recall: 0.9071 - auc: 0.9066 - val_loss: 1.0171 - val_tp: 41108.0000 - val_fp: 22892.0000 - val_tn: 41108.0000 - val_fn: 22892.0000 - val_accuracy: 0.6423 - val_precision: 0.6423 - val_recall: 0.6423 - val_auc: 0.6423
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-6144000-6400000
[INFO] processing batch 6400000-6656000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99844%,0.0:0.00156%]
[INFO] ** modbus_transaction_id:65534 (25.59922%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.08394601119999999:0.00078%,0.0021633145999999997:0.00039%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:26.14219%,0.8139250565:20.80625%,0.8029830673999999:18.25117%,0.8149336757:17.57578%,0.8137722355:17.22266%,0.8166299895999999:0.00078%,0.0021089309:0.00039%,0.8147502904:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:79.20547%,Single Stage Single Point:20.79453%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.85781%,1:26.14219%]
[INFO] ** src-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.42383%,1:17.57617%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.74883%,1:18.25117%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.97109%,1:38.02891%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:79.19375%,1:20.80625%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.63516%,1:43.36484%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.42422%,1:17.57578%]
[INFO] ** dst-192.168.1.40:[0:81.74844%,1:18.25156%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:100.0%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99922%,1:0.00078%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99844%,0:0.00156%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99844%,0:0.00156%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.85781%,1:26.14219%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.42383%,1:17.57617%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.74883%,1:18.25117%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.97109%,1:38.02891%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99844%,1:0.00156%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.77734%,1:17.22266%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.85781%,1:26.14219%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.19414%,1:20.80586%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.425%,1:17.575%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.74922%,1:18.25078%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 's_port': 9, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.134': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-224.0.0.252': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.134': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      4, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [0. 1.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [202766.  53234.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 9s - loss: 0.7338 - tp: 138766.0000 - fp: 53234.0000 - tn: 138766.0000 - fn: 53234.0000 - accuracy: 0.7227 - precision: 0.7227 - recall: 0.7227 - auc: 0.7244 - val_loss: 0.1274 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-6400000-6656000
[INFO] processing batch 6656000-6912000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65197 (25.46758%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.09248953609999999:0.00039%]
[INFO] ** s_port:[0.834280824:26.11367%,0.8139250565:20.77734%,0.8029830673999999:18.2707%,0.8149336757:17.58906%,0.8137722355:17.24609%,0.8030136315999999:0.00078%,0.8343113882:0.00078%,0.8345253376999999:0.00039%,0.8030441959000001:0.00039%,0.9834647595:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.88516%,1:26.11484%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.41055%,1:17.58945%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.72812%,1:18.27188%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.97656%,1:38.02344%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.22266%,1:20.77734%]
[INFO] ** dst-192.168.1.100:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.63984%,1:43.36016%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.41055%,1:17.58945%]
[INFO] ** dst-192.168.1.40:[0:81.7293%,1:18.2707%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.88516%,1:26.11484%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.41055%,1:17.58945%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.72812%,1:18.27188%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.97656%,1:38.02344%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00156%,1:49.99844%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00117%,0:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99609%,1:0.00391%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75391%,1:17.24609%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.88711%,1:26.11289%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.22266%,1:20.77734%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.41094%,1:17.58906%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.7293%,1:18.2707%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.100': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-VNC': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [256000.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 9s - loss: 0.1109 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 192000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0951 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-6656000-6912000
[INFO] processing batch 6912000-7168000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:59892 (23.39531%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0:0.00078%,0.08391465880000001:0.00039%]
[INFO] ** s_port:[0.834280824:26.1043%,0.8139250565:20.79102%,0.8029830673999999:18.27422%,0.8149336757:17.5875%,0.8137722355:17.23945%,0.8059172320999999:0.00078%,0.8343113882:0.00078%,0.0:0.00078%,0.8030136315999999:0.00039%,0.0818051226:0.00039%,0.8344030809:0.00039%]
[INFO] ** classification:[normal:99.99883%,Single Stage Single Point:0.00117%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99961%,1:0.00039%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.89453%,1:26.10547%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.4125%,1:17.5875%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.30:[0:81.72539%,1:18.27461%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.96953%,1:38.03047%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:79.20898%,1:20.79102%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65625%,1:43.34375%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.4125%,1:17.5875%]
[INFO] ** dst-192.168.1.40:[0:81.72539%,1:18.27461%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99961%,1:0.00039%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.89453%,1:26.10547%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.4125%,1:17.5875%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.72539%,1:18.27461%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.96953%,1:38.03047%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00117%,0:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.76094%,1:17.23906%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.89609%,1:26.10391%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.20898%,1:20.79102%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.41328%,1:17.58672%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.72578%,1:18.27422%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.202': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.202': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [2.55997e+05 3.00000e+00]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 9s - loss: 0.0836 - tp: 191998.0000 - fp: 2.0000 - tn: 191998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0735 - val_tp: 63999.0000 - val_fp: 1.0000 - val_tn: 63999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-6912000-7168000
[INFO] processing batch 7168000-7424000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:706 (0.27578%)
[INFO] ** modbus_function_code:[0.9743589744:99.99453%,0.0:0.00547%]
[INFO] ** modbus_transaction_id:64992 (25.3875%)
[INFO] ** service:[0.7025755984000001:99.99492%,0.0:0.0043%,0.0208806885:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.03359%,0.8139250565:20.78242%,0.8029830673999999:18.34414%,0.8149336757:17.58828%,0.8137722355:17.24375%,0.0:0.0043%,0.814841983:0.00078%,0.8059172320999999:0.00039%,0.9344397579000001:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.0021089309:0.00039%,0.1074484993:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:92.32148%,Single Stage Multi Point:7.67812%,Single Stage Single Point:0.00039%]
[INFO] ** orig-192.168.1.48:[1:99.9957%,0:0.0043%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.9957%,1:0.0043%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.9957%,1:0.0043%]
[INFO] ** i/f_name-eth1:[1:99.9957%,0:0.0043%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.9957%,1:0.0043%]
[INFO] ** i/f_dir-outbound:[1:99.9957%,0:0.0043%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.96562%,1:26.03437%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.20:[0:82.41055%,1:17.58945%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.65586%,1:18.34414%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.97383%,1:38.02617%]
[INFO] ** src-192.168.1.88:[0:99.99492%,1:0.00508%]
[INFO] ** dst-0:[0:99.9957%,1:0.0043%]
[INFO] ** dst-192.168.1.10:[0:79.21719%,1:20.78281%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.72266%,1:43.27734%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.41133%,1:17.58867%]
[INFO] ** dst-192.168.1.40:[0:81.65508%,1:18.34492%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.9957%,1:0.0043%]
[INFO] ** proto-tcp:[1:99.99531%,0:0.00469%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.9957%,1:0.0043%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99453%,0:0.00547%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.9957%,1:0.0043%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.96562%,1:26.03437%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.41055%,1:17.58945%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.65586%,1:18.34414%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.97383%,1:38.02617%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** modbus_function_description-0:[0:99.99453%,1:0.00547%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.9918%,1:0.0082%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.75625%,1:17.24375%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.9668%,1:26.0332%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.21758%,1:20.78242%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.41172%,1:17.58828%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.65586%,1:18.34414%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 3, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-192.168.1.10': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - get attribute single': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255993, 255996, 255998]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [0. 1.]
 [1. 0.]
 [0. 1.]]
z vector sum [236343.  19657.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 9s - loss: 0.0655 - tp: 191999.0000 - fp: 1.0000 - tn: 191999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.9218 - val_tp: 44344.0000 - val_fp: 19656.0000 - val_tn: 44344.0000 - val_fn: 19656.0000 - val_accuracy: 0.6929 - val_precision: 0.6929 - val_recall: 0.6929 - val_auc: 0.6929
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-7168000-7424000
[INFO] processing batch 7424000-7680000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:706 (0.27578%)
[INFO] ** modbus_function_code:[0.9743589744:99.99648%,0.0:0.00352%]
[INFO] ** modbus_transaction_id:59138 (23.10078%)
[INFO] ** service:[0.7025755984000001:99.99648%,0.0:0.00352%]
[INFO] ** s_port:[0.834280824:26.08906%,0.8139250565:20.78789%,0.8029830673999999:18.26367%,0.8149336757:17.61172%,0.8137722355:17.24219%,0.0:0.00352%,0.8059172320999999:0.00078%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:59.34414%,Single Stage Multi Point:40.65586%]
[INFO] ** orig-192.168.1.48:[1:99.99648%,0:0.00352%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99648%,1:0.00352%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99648%,1:0.00352%]
[INFO] ** i/f_name-eth1:[1:99.99648%,0:0.00352%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99648%,1:0.00352%]
[INFO] ** i/f_dir-outbound:[1:99.99648%,0:0.00352%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.91055%,1:26.08945%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.38789%,1:17.61211%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.73594%,1:18.26406%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.96992%,1:38.03008%]
[INFO] ** src-192.168.1.88:[0:99.99648%,1:0.00352%]
[INFO] ** dst-0:[0:99.99648%,1:0.00352%]
[INFO] ** dst-192.168.1.10:[0:79.21211%,1:20.78789%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.66836%,1:43.33164%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.38828%,1:17.61172%]
[INFO] ** dst-192.168.1.40:[0:81.73633%,1:18.26367%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99648%,1:0.00352%]
[INFO] ** proto-tcp:[1:99.99648%,0:0.00352%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99648%,1:0.00352%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99648%,0:0.00352%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99648%,1:0.00352%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.91055%,1:26.08945%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.38789%,1:17.61211%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.73594%,1:18.26406%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.96992%,1:38.03008%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99648%,1:0.00352%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99336%,1:0.00664%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.7582%,1:17.2418%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.91094%,1:26.08906%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.2125%,1:20.7875%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.38828%,1:17.61172%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.73672%,1:18.26328%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      2,      3, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [0. 1.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [151921. 104079.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 8s - loss: 1.1971 - tp: 102062.0000 - fp: 89938.0000 - tn: 102062.0000 - fn: 89938.0000 - accuracy: 0.5316 - precision: 0.5316 - recall: 0.5316 - auc: 0.5321 - val_loss: 0.5686 - val_tp: 49859.0000 - val_fp: 14141.0000 - val_tn: 49859.0000 - val_fn: 14141.0000 - val_accuracy: 0.7790 - val_precision: 0.7790 - val_recall: 0.7790 - val_auc: 0.7790
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-7424000-7680000
[INFO] processing batch 7680000-7936000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:698 (0.27266%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:63218 (24.69453%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:26.09844%,0.8139250565:20.80234%,0.8029830673999999:18.25859%,0.8149336757:17.5832%,0.8137722355:17.25547%,0.8030136315999999:0.00039%,0.8345253376999999:0.00039%,0.2528119078:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.90078%,1:26.09922%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.41641%,1:17.58359%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.74102%,1:18.25898%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.94219%,1:38.05781%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.19727%,1:20.80273%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.64609%,1:43.35391%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.41641%,1:17.58359%]
[INFO] ** dst-192.168.1.40:[0:81.74141%,1:18.25859%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.90078%,1:26.09922%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.41641%,1:17.58359%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.74102%,1:18.25898%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.94219%,1:38.05781%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99648%,1:0.00352%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.74453%,1:17.25547%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.90234%,1:26.09766%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.19766%,1:20.80234%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.41758%,1:17.58242%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.74141%,1:18.25859%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol - multiple service packet': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [256000.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 7s - loss: 0.1180 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 192000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1074 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-7680000-7936000
[INFO] processing batch 7936000-8192000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:701 (0.27383%)
[INFO] ** modbus_function_code:[0.9743589744:99.99414%,0.0:0.00547%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:65535 (25.59961%)
[INFO] ** service:[0.7025755984000001:99.9957%,0.002116286:0.00117%,0.0021633145999999997:0.00078%,0.08391465880000001:0.00078%,0.0297847659:0.00039%,0.0012540954:0.00039%,0.08394601119999999:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.14844%,0.8139250565:20.83828%,0.8029830673999999:18.2082%,0.8149336757:17.56406%,0.8137722355:17.2332%,0.8868054282:0.00156%,0.0818051226:0.00078%,0.0021089309:0.00078%,0.7673146279999999:0.00039%,0.8345253376999999:0.00039%,0.0290360046:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.7788831836:0.00039%,0.8870957883:0.00039%,0.0020936488:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.9156580476:0.00039%,0.8881655358:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.85039%,1:26.14961%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.43594%,1:17.56406%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.79102%,1:18.20898%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.92852%,1:38.07148%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.16172%,1:20.83828%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.61797%,1:43.38203%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.30:[0:82.43555%,1:17.56445%]
[INFO] ** dst-192.168.1.40:[0:81.78984%,1:18.21016%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99414%,0:0.00586%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.85039%,1:26.14961%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.43594%,1:17.56406%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.79102%,1:18.20898%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.92852%,1:38.07148%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99453%,1:0.00547%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00469%,1:49.99531%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00117%,1:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99102%,1:0.00898%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.7668%,1:17.2332%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.85156%,1:26.14844%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.16211%,1:20.83789%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.43672%,1:17.56328%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.7918%,1:18.2082%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 8, 'type-alert': 2, 'type-log': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [256000.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 7s - loss: 0.0982 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 192000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0895 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-7936000-8192000
[INFO] processing batch 8192000-8448000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:701 (0.27383%)
[INFO] ** modbus_function_code:[0.9743589744:99.99961%,0.0:0.00039%]
[INFO] ** modbus_transaction_id:65522 (25.59453%)
[INFO] ** service:[0.7025755984000001:99.99961%,0.0:0.00039%]
[INFO] ** s_port:[0.834280824:26.08555%,0.8139250565:20.85859%,0.8029830673999999:18.1793%,0.8149336757:17.63516%,0.8137722355:17.23984%,0.8059172320999999:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%,0.0:0.00039%]
[INFO] ** classification:[normal:87.94922%,Multi Stage Multi Point:12.05078%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_name-eth1:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-outbound:[1:99.99961%,0:0.00039%]
[INFO] ** src-0:[0:99.99961%,1:0.00039%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.91406%,1:26.08594%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.36445%,1:17.63555%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.8207%,1:18.1793%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.90156%,1:38.09844%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.10:[0:79.14141%,1:20.85859%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.67461%,1:43.32539%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.36484%,1:17.63516%]
[INFO] ** dst-192.168.1.40:[0:81.8207%,1:18.1793%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99961%,1:0.00039%]
[INFO] ** proto-tcp:[1:99.99961%,0:0.00039%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99961%,0:0.00039%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.91406%,1:26.08594%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.36445%,1:17.63555%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8207%,1:18.1793%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.90156%,1:38.09844%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.0%,0:50.0%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99766%,1:0.00234%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.76016%,1:17.23984%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.91484%,1:26.08516%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.14141%,1:20.85859%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.36484%,1:17.63516%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.82109%,1:18.17891%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 2, 's_port': 9, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proto-0': 2, 'proto-tcp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [225150.  30850.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 7s - loss: 0.4575 - tp: 161781.0000 - fp: 30219.0000 - tn: 161781.0000 - fn: 30219.0000 - accuracy: 0.8426 - precision: 0.8426 - recall: 0.8426 - auc: 0.8428 - val_loss: 0.1250 - val_tp: 63369.0000 - val_fp: 631.0000 - val_tn: 63369.0000 - val_fn: 631.0000 - val_accuracy: 0.9901 - val_precision: 0.9901 - val_recall: 0.9901 - val_auc: 0.9901
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-8192000-8448000
[INFO] processing batch 8448000-8704000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99648%,0.0:0.00352%]
[INFO] ** modbus_transaction_id:56456 (22.05313%)
[INFO] ** service:[0.7025755984000001:99.99648%,0.002116286:0.00117%,0.0:0.00078%,0.0297847659:0.00039%,0.0012540954:0.00039%,0.08394601119999999:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.10742%,0.8139250565:20.80391%,0.8029830673999999:18.28828%,0.8149336757:17.5793%,0.8137722355:17.21602%,0.8030136315999999:0.00078%,0.0:0.00078%,0.9104621309:0.00039%,0.8591448133:0.00039%,0.8916498562999999:0.00039%,0.7788831836:0.00039%,0.7891527599:0.00039%,0.8870957883:0.00039%,0.0020936488:0.00039%,0.8343113882:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:63.66172%,Multi Stage Multi Point:36.33828%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.89219%,1:26.10781%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.42031%,1:17.57969%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.71094%,1:18.28906%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.98008%,1:38.01992%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:79.19609%,1:20.80391%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.67656%,1:43.32344%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.4207%,1:17.5793%]
[INFO] ** dst-192.168.1.40:[0:81.71172%,1:18.28828%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99805%,0:0.00195%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99648%,0:0.00352%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.89219%,1:26.10781%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.42031%,1:17.57969%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.71094%,1:18.28906%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.98008%,1:38.01992%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99648%,1:0.00352%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99375%,1:0.00625%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.78398%,1:17.21602%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.89258%,1:26.10742%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.19648%,1:20.80352%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.42109%,1:17.57891%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.71211%,1:18.28789%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 7, 'classification': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [162974.  93026.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 7s - loss: 0.8321 - tp: 123282.0000 - fp: 68718.0000 - tn: 123282.0000 - fn: 68718.0000 - accuracy: 0.6421 - precision: 0.6421 - recall: 0.6421 - auc: 0.6415 - val_loss: 0.8143 - val_tp: 39692.0000 - val_fp: 24308.0000 - val_tn: 39692.0000 - val_fn: 24308.0000 - val_accuracy: 0.6202 - val_precision: 0.6202 - val_recall: 0.6202 - val_auc: 0.6202
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-8448000-8704000
[INFO] processing batch 8704000-8960000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:701 (0.27383%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:63796 (24.92031%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:26.09102%,0.8139250565:20.85859%,0.8029830673999999:18.25273%,0.8149336757:17.52617%,0.8137722355:17.26953%,0.8343113882:0.00078%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8030441959000001:0.00039%]
[INFO] ** classification:[normal:98.44844%,Multi Stage Multi Point:1.55156%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.90742%,1:26.09258%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.47383%,1:17.52617%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.74688%,1:18.25312%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.87188%,1:38.12813%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.14141%,1:20.85859%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.63906%,1:43.36094%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.47344%,1:17.52656%]
[INFO] ** dst-192.168.1.40:[0:81.74688%,1:18.25312%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.90742%,1:26.09258%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.47383%,1:17.52617%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.74688%,1:18.25312%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.87188%,1:38.12813%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00078%,0:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99688%,1:0.00312%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.73086%,1:17.26914%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.90977%,1:26.09023%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.14141%,1:20.85859%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.47383%,1:17.52617%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.74727%,1:18.25273%]
[INFO] columns with count within 2-10 {'s_port': 9, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [252028.   3972.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 7s - loss: 0.1880 - tp: 188028.0000 - fp: 3972.0000 - tn: 188028.0000 - fn: 3972.0000 - accuracy: 0.9793 - precision: 0.9793 - recall: 0.9793 - auc: 0.9788 - val_loss: 0.1331 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-8704000-8960000
[INFO] processing batch 8960000-9216000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.9957%,0.0:0.00391%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:57363 (22.40742%)
[INFO] ** service:[0.7025755984000001:99.99727%,0.0021633145999999997:0.00078%,0.08391465880000001:0.00078%,0.0297847659:0.00039%,0.08394601119999999:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.07148%,0.8139250565:20.81289%,0.8029830673999999:18.23047%,0.8149336757:17.57383%,0.8137722355:17.30469%,0.7579772602:0.00156%,0.8059172320999999:0.00078%,0.0818051226:0.00078%,0.0021089309:0.00078%,0.8262729995999999:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.0290360046:0.00039%,0.0020936488:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.92812%,1:26.07188%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.42578%,1:17.57422%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.76875%,1:18.23125%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.88242%,1:38.11758%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.18711%,1:20.81289%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.62188%,1:43.37812%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.30:[0:82.42617%,1:17.57383%]
[INFO] ** dst-192.168.1.40:[0:81.76914%,1:18.23086%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:99.99727%,0:0.00273%]
[INFO] ** proto-udp:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.9957%,0:0.0043%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.92812%,1:26.07188%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.42578%,1:17.57422%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.76875%,1:18.23125%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.88242%,1:38.11758%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99609%,1:0.00391%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00352%,1:49.99648%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00078%,1:49.99922%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99258%,1:0.00742%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.69531%,1:17.30469%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.92891%,1:26.07109%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.18711%,1:20.81289%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.42656%,1:17.57344%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.76953%,1:18.23047%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 6, 'type-alert': 2, 'type-log': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [256000.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 7s - loss: 0.1174 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 192000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1034 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-8960000-9216000
[INFO] processing batch 9216000-9472000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:100.0%]
[INFO] ** modbus_transaction_id:61876 (24.17031%)
[INFO] ** service:[0.7025755984000001:100.0%]
[INFO] ** s_port:[0.834280824:26.1332%,0.8139250565:20.83086%,0.8029830673999999:18.15234%,0.8149336757:17.59102%,0.8137722355:17.29141%,0.8059172320999999:0.00039%,0.8345253376999999:0.00039%,0.8343113882:0.00039%]
[INFO] ** classification:[normal:72.04688%,Single Stage Multi Point:27.95312%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.86602%,1:26.13398%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.40898%,1:17.59102%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.84766%,1:18.15234%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.87773%,1:38.12227%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:79.16914%,1:20.83086%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.57539%,1:43.42461%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.40859%,1:17.59141%]
[INFO] ** dst-192.168.1.40:[0:81.84766%,1:18.15234%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:100.0%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.86602%,1:26.13398%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.40898%,1:17.59102%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.84766%,1:18.15234%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.87773%,1:38.12227%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:100.0%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00039%,1:49.99961%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99766%,1:0.00234%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.70859%,1:17.29141%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.86719%,1:26.13281%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.16953%,1:20.83047%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.40898%,1:17.59102%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.84805%,1:18.15195%]
[INFO] columns with count within 2-10 {'s_port': 8, 'classification': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [184440.  71560.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 7s - loss: 0.8599 - tp: 120440.0000 - fp: 71560.0000 - tn: 120440.0000 - fn: 71560.0000 - accuracy: 0.6273 - precision: 0.6273 - recall: 0.6273 - auc: 0.6278 - val_loss: 0.1692 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-9216000-9472000
[INFO] processing batch 9472000-9728000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:700 (0.27344%)
[INFO] ** modbus_function_code:[0.9743589744:99.99336%,0.0:0.00664%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99336%,0.0:0.00547%,0.0297847659:0.00039%,0.08394601119999999:0.00039%,0.0021633145999999997:0.00039%]
[INFO] ** s_port:[0.834280824:26.13047%,0.8139250565:20.83359%,0.8029830673999999:18.22422%,0.8149336757:17.54023%,0.8137722355:17.26289%,0.0:0.00547%,0.814841983:0.00078%,0.9715599976:0.00039%,0.8344030809:0.00039%,0.9535729568000001:0.00039%,0.0021089309:0.00039%,0.8343113882:0.00039%,0.8147502904:0.00039%]
[INFO] ** classification:[normal:83.99258%,Single Stage Multi Point:16.00742%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99922%,1:0.00078%]
[INFO] ** type-log:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-0:[0:99.99453%,1:0.00547%]
[INFO] ** i/f_name-eth1:[1:99.99453%,0:0.00547%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99531%,1:0.00469%]
[INFO] ** i/f_dir-outbound:[1:99.99531%,0:0.00469%]
[INFO] ** src-0:[0:99.99453%,1:0.00547%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.86875%,1:26.13125%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.45859%,1:17.54141%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.77578%,1:18.22422%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.60:[0:61.90352%,1:38.09648%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99453%,1:0.00547%]
[INFO] ** dst-192.168.1.10:[0:79.16641%,1:20.83359%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.60664%,1:43.39336%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.45977%,1:17.54023%]
[INFO] ** dst-192.168.1.40:[0:81.775%,1:18.225%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99453%,1:0.00547%]
[INFO] ** proto-tcp:[1:99.99336%,0:0.00664%]
[INFO] ** proto-udp:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-0:[0:99.99453%,1:0.00547%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99336%,0:0.00664%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99453%,1:0.00547%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.86875%,1:26.13125%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.45859%,1:17.54141%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.77578%,1:18.22422%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.90352%,1:38.09648%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99336%,1:0.00664%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.0043%,1:49.9957%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99023%,1:0.00977%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.7375%,1:17.2625%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.86992%,1:26.13008%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.16641%,1:20.83359%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.46016%,1:17.53984%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.77578%,1:18.22422%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 5, 'classification': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [215021.  40979.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 7s - loss: 0.4373 - tp: 161553.0000 - fp: 30447.0000 - tn: 161553.0000 - fn: 30447.0000 - accuracy: 0.8414 - precision: 0.8414 - recall: 0.8414 - auc: 0.8414 - val_loss: 0.4474 - val_tp: 53468.0000 - val_fp: 10532.0000 - val_tn: 53468.0000 - val_fn: 10532.0000 - val_accuracy: 0.8354 - val_precision: 0.8354 - val_recall: 0.8354 - val_auc: 0.8354
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-9472000-9728000
[INFO] processing batch 9728000-9984000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:699 (0.27305%)
[INFO] ** modbus_function_code:[0.9743589744:99.99883%,0.0:0.00117%]
[INFO] ** modbus_transaction_id:63091 (24.64492%)
[INFO] ** service:[0.7025755984000001:99.99883%,0.0:0.00078%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.09727%,0.8139250565:20.87695%,0.8029830673999999:18.14492%,0.8149336757:17.58789%,0.8137722355:17.28906%,0.8030136315999999:0.00078%,0.0:0.00078%,0.8059172320999999:0.00039%,0.8345253376999999:0.00039%,0.0020936488:0.00039%,0.8343113882:0.00039%,0.8030441959000001:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_name-eth1:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99922%,1:0.00078%]
[INFO] ** i/f_dir-outbound:[1:99.99922%,0:0.00078%]
[INFO] ** src-0:[0:99.99922%,1:0.00078%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.90195%,1:26.09805%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.41172%,1:17.58828%]
[INFO] ** src-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.85391%,1:18.14609%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.83398%,1:38.16602%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.10:[0:79.12305%,1:20.87695%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.61328%,1:43.38672%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.30:[0:82.41172%,1:17.58828%]
[INFO] ** dst-192.168.1.40:[0:81.85508%,1:18.14492%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.60:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99922%,1:0.00078%]
[INFO] ** proto-tcp:[1:99.99883%,0:0.00117%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99883%,0:0.00117%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.90195%,1:26.09805%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.41172%,1:17.58828%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.85391%,1:18.14609%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.83398%,1:38.16602%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99883%,1:0.00117%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00117%,0:49.99883%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99492%,1:0.00508%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.71094%,1:17.28906%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.90312%,1:26.09688%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.12344%,1:20.87656%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.4125%,1:17.5875%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.85508%,1:18.14492%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Name Service': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [256000.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 7s - loss: 0.1473 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 192000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1261 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-9728000-9984000
[INFO] processing batch 9984000-10240000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99844%,0.0:0.00156%]
[INFO] ** modbus_transaction_id:58560 (22.875%)
[INFO] ** service:[0.7025755984000001:99.99844%,0.002116286:0.00117%,0.0012540954:0.00039%]
[INFO] ** s_port:[0.834280824:25.95625%,0.8139250565:21.02656%,0.8029830673999999:18.18047%,0.8149336757:17.49258%,0.8137722355:17.33984%,0.8059172320999999:0.00117%,0.8030136315999999:0.00039%,0.7918882572:0.00039%,0.8344030809:0.00039%,0.8345253376999999:0.00039%,0.8985420868999999:0.00039%,0.9339660126:0.00039%,0.7788831836:0.00039%,0.8343113882:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:100.0%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:100.0%]
[INFO] ** i/f_name-0:[0:100.0%]
[INFO] ** i/f_name-eth1:[1:100.0%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:100.0%]
[INFO] ** i/f_dir-outbound:[1:100.0%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.04258%,1:25.95742%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:100.0%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.50742%,1:17.49258%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.81914%,1:18.18086%]
[INFO] ** src-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.63359%,1:38.36641%]
[INFO] ** src-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** dst-0:[0:100.0%]
[INFO] ** dst-192.168.1.10:[0:78.97344%,1:21.02656%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.70391%,1:43.29609%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.50703%,1:17.49297%]
[INFO] ** dst-192.168.1.40:[0:81.81914%,1:18.18086%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:100.0%]
[INFO] ** proto-tcp:[1:100.0%]
[INFO] ** proto-udp:[0:100.0%]
[INFO] ** appi_name-0:[0:100.0%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99844%,0:0.00156%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-0:[0:100.0%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.04258%,1:25.95742%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.50742%,1:17.49258%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.81914%,1:18.18086%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.63359%,1:38.36641%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-0:[0:99.99844%,1:0.00156%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00195%,1:49.99805%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[1:50.00039%,0:49.99961%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99453%,1:0.00547%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66016%,1:17.33984%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.04453%,1:25.95547%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.97344%,1:21.02656%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.50781%,1:17.49219%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.81953%,1:18.18047%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 3, 'src-192.168.1.10': 2, 'src-192.168.1.20': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-192.168.1.88': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-Web Browsing': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [1. 0.]]
z vector sum [256000.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 8s - loss: 0.1107 - tp: 192000.0000 - fp: 0.0000e+00 - tn: 192000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0971 - val_tp: 64000.0000 - val_fp: 0.0000e+00 - val_tn: 64000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-9984000-10240000
[INFO] processing batch 10240000-10496000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:703 (0.27461%)
[INFO] ** modbus_function_code:[0.9743589744:99.99297%,0.0:0.00664%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:65536 (25.6%)
[INFO] ** service:[0.7025755984000001:99.99453%,0.0:0.00273%,0.0021633145999999997:0.00078%,0.08391465880000001:0.00078%,0.0297847659:0.00039%,0.08394601119999999:0.00039%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:26.01641%,0.8139250565:20.95156%,0.8029830673999999:18.13867%,0.8149336757:17.55234%,0.8137722355:17.33281%,0.0:0.00273%,0.7414573018:0.00156%,0.0818051226:0.00078%,0.0021089309:0.00078%,0.814841983:0.00078%,0.8030136315999999:0.00039%,0.8935448376999999:0.00039%,0.0290360046:0.00039%,0.0020936488:0.00039%]
[INFO] ** classification:[normal:87.29883%,Multi Stage Single Point:12.70117%]
[INFO] ** orig-192.168.1.48:[1:99.99727%,0:0.00273%]
[INFO] ** orig-192.168.1.87:[0:100.0%]
[INFO] ** orig-192.168.1.88:[0:99.99727%,1:0.00273%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-control:[0:100.0%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_name-eth1:[1:99.99727%,0:0.00273%]
[INFO] ** i/f_name-geod daemon:[0:100.0%]
[INFO] ** i/f_dir-inbound:[0:99.99727%,1:0.00273%]
[INFO] ** i/f_dir-outbound:[1:99.99727%,0:0.00273%]
[INFO] ** src-0:[0:100.0%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:73.98359%,1:26.01641%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** src-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.44687%,1:17.55313%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.86094%,1:18.13906%]
[INFO] ** src-192.168.1.40:[0:100.0%]
[INFO] ** src-192.168.1.49:[0:100.0%]
[INFO] ** src-192.168.1.60:[0:61.71562%,1:38.28437%]
[INFO] ** src-192.168.1.88:[0:99.99727%,1:0.00273%]
[INFO] ** dst-0:[0:99.99727%,1:0.00273%]
[INFO] ** dst-192.168.1.10:[0:79.04688%,1:20.95312%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.65078%,1:43.34922%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.30:[0:82.44766%,1:17.55234%]
[INFO] ** dst-192.168.1.40:[0:81.86133%,1:18.13867%]
[INFO] ** dst-192.168.1.49:[0:100.0%]
[INFO] ** dst-192.168.1.50:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99727%,1:0.00273%]
[INFO] ** proto-tcp:[1:99.99453%,0:0.00547%]
[INFO] ** proto-udp:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-0:[0:99.99727%,1:0.00273%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99297%,0:0.00703%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:100.0%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:100.0%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:73.98359%,1:26.01641%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99766%,1:0.00234%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.44687%,1:17.55313%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.86094%,1:18.13906%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.71562%,1:38.28437%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99336%,1:0.00664%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.0043%,1:49.9957%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00273%,1:49.99727%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.99102%,1:0.00898%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.66719%,1:17.33281%]
[INFO] ** scada_tag-HMI_FIT201:[0:73.98359%,1:26.01641%]
[INFO] ** scada_tag-HMI_LIT101:[0:79.04883%,1:20.95117%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.44766%,1:17.55234%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.86172%,1:18.13828%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 7, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.88': 2, 'type-alert': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-SSDP': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255996, 255997, 255998]),)
y_vector [[1. 0.]
 [1. 0.]
 [1. 0.]
 ...
 [1. 0.]
 [1. 0.]
 [0. 1.]]
z vector sum [223485.  32515.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape (4000, 16, 107)
y_train.shape (12000, 16, 2)
y_test.shape (4000, 16, 2)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 16, 2)             880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 16, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 16, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 16, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 16, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 16, 2)             4         
=================================================================
Total params: 1,055
Trainable params: 1,055
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model. xtrain.shape: (12000, 16, 107) y_train.shape: (12000, 16, 2)
Train on 12000 samples, validate on 4000 samples
Epoch 1/1
 - 7s - loss: 0.1189 - tp: 189510.0000 - fp: 2490.0000 - tn: 189510.0000 - fn: 2490.0000 - accuracy: 0.9870 - precision: 0.9870 - recall: 0.9870 - auc: 0.9870 - val_loss: 1.2487 - val_tp: 33975.0000 - val_fp: 30025.0000 - val_tn: 33975.0000 - val_fn: 30025.0000 - val_accuracy: 0.5309 - val_precision: 0.5309 - val_recall: 0.5309 - val_auc: 0.5309
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-10240000-10496000
[INFO] processing batch 10496000-10752000/24819975
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:705 (0.27539%)
[INFO] ** modbus_function_code:[0.9743589744:99.99219%,0.0:0.00781%]
[INFO] ** modbus_transaction_id:60618 (23.67891%)
[INFO] ** service:[0.7025755984000001:99.99219%,0.0:0.00664%,0.0021789908:0.00078%,0.0021476384:0.00039%]
[INFO] ** s_port:[0.834280824:25.97539%,0.8139250565:21.02148%,0.8029830673999999:18.08672%,0.8149336757:17.56211%,0.8137722355:17.34375%,0.0:0.00664%,0.9004676325:0.00078%,0.8343113882:0.00078%,0.8059172320999999:0.00039%,0.8030136315999999:0.00039%,0.8344030809:0.00039%,0.0020936488:0.00039%,0.8147502904:0.00039%,0.814841983:0.00039%]
[INFO] ** classification:[normal:53.00195%,Multi Stage Single Point:46.99805%]
[INFO] ** orig-192.168.1.48:[1:99.99492%,0:0.00508%]
[INFO] ** orig-192.168.1.87:[0:99.99922%,1:0.00078%]
[INFO] ** orig-192.168.1.88:[0:99.9957%,1:0.0043%]
[INFO] ** type-alert:[0:100.0%]
[INFO] ** type-control:[0:99.99766%,1:0.00234%]
[INFO] ** type-log:[1:99.99766%,0:0.00234%]
[INFO] ** i/f_name-0:[0:99.99375%,1:0.00625%]
[INFO] ** i/f_name-eth1:[1:99.99336%,0:0.00664%]
[INFO] ** i/f_name-geod daemon:[0:99.99961%,1:0.00039%]
[INFO] ** i/f_dir-inbound:[0:99.99375%,1:0.00625%]
[INFO] ** i/f_dir-outbound:[1:99.99375%,0:0.00625%]
[INFO] ** src-0:[0:99.99766%,1:0.00234%]
[INFO] ** src-10.15.51.65:[0:100.0%]
[INFO] ** src-192.168.1.10:[0:74.02344%,1:25.97656%]
[INFO] ** src-192.168.1.134:[0:100.0%]
[INFO] ** src-192.168.1.136:[0:100.0%]
[INFO] ** src-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.43711%,1:17.56289%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.202:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.91289%,1:18.08711%]
[INFO] ** src-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.60:[0:61.63477%,1:38.36523%]
[INFO] ** src-192.168.1.88:[0:99.9957%,1:0.0043%]
[INFO] ** dst-0:[0:99.99336%,1:0.00664%]
[INFO] ** dst-192.168.1.10:[0:78.97852%,1:21.02148%]
[INFO] ** dst-192.168.1.100:[0:100.0%]
[INFO] ** dst-192.168.1.19:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.20:[0:56.68086%,1:43.31914%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:100.0%]
[INFO] ** dst-192.168.1.30:[0:82.43789%,1:17.56211%]
[INFO] ** dst-192.168.1.40:[0:81.9125%,1:18.0875%]
[INFO] ** dst-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:99.99961%,1:0.00039%]
[INFO] ** dst-192.168.1.88:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:100.0%]
[INFO] ** dst-224.0.0.252:[0:100.0%]
[INFO] ** dst-239.192.4.191:[0:100.0%]
[INFO] ** dst-239.255.255.250:[0:100.0%]
[INFO] ** proto-0:[0:99.99336%,1:0.00664%]
[INFO] ** proto-tcp:[1:99.99297%,0:0.00703%]
[INFO] ** proto-udp:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-0:[0:99.99336%,1:0.00664%]
[INFO] ** appi_name-CIP_func75:[0:100.0%]
[INFO] ** appi_name-CIP_gen:[0:100.0%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99219%,0:0.00781%]
[INFO] ** appi_name-CIP_write_tag_service:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute all:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - get attribute single:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - multiple service packet:[0:100.0%]
[INFO] ** appi_name-Common Industrial Protocol - success:[0:100.0%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-DNP3 Protocol - initialize data to defaults:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:100.0%]
[INFO] ** appi_name-Google Chrome:[0:100.0%]
[INFO] ** appi_name-LLMNR Protocol:[0:100.0%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:100.0%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:100.0%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:100.0%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** appi_name-VNC:[0:100.0%]
[INFO] ** appi_name-Web Browsing:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99336%,1:0.00664%]
[INFO] ** proxy_src_ip-10.15.51.65:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.02344%,1:25.97656%]
[INFO] ** proxy_src_ip-192.168.1.134:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.43711%,1:17.56289%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.202:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.91289%,1:18.08711%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.63477%,1:38.36523%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99219%,1:0.00781%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:100.0%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00547%,1:49.99453%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00234%,1:49.99766%]
[INFO] ** modbus_function_description-Unknown Function Code:[0:100.0%]
[INFO] ** modbus_function_description-Write Tag Service:[0:100.0%]
[INFO] ** scada_tag-0:[0:99.98828%,1:0.01172%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.65625%,1:17.34375%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.02539%,1:25.97461%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.97852%,1:21.02148%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.43828%,1:17.56172%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.91328%,1:18.08672%]
[INFO] columns with count within 2-10 {'modbus_function_code': 2, 'service': 4, 'classification': 2, 'orig-192.168.1.48': 2, 'orig-192.168.1.87': 2, 'orig-192.168.1.88': 2, 'type-control': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_name-geod daemon': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     2,      4,      5, ..., 255995, 255996, 255997]),)
y_vector [[0. 1.]
 [0. 1.]
 [1. 0.]
 ...
 [1. 0.]
 [0. 1.]
 [0. 1.]]
z vector sum [135685. 120315.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 2)
y_test.shape (64000, 2)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (12000, 16, 107)
x_test.shape