2020-02-02 23:28:24.975907: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory
2020-02-02 23:28:24.976066: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory
2020-02-02 23:28:24.976081: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-02-02 23:28:25.780693: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2020-02-02 23:28:25.780725: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-02-02 23:28:25.780754: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (bastia): /proc/driver/nvidia/version does not exist
2020-02-02 23:28:25.780944: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-02-02 23:28:25.790136: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2112050000 Hz
2020-02-02 23:28:25.791298: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55be380 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-02-02 23:28:25.791324: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-02-02 23:28:29.657498: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-02 23:28:29.674148: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 23:28:29.681655: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 23:28:29.742593: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-02 23:28:29.745952: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-02 23:28:29.751338: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 23:28:29.756678: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 23:28:29.770170: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-02 23:28:33.460751: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-02 23:28:33.464693: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 23:28:33.466570: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 23:28:33.480367: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-02 23:28:33.481246: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-02 23:28:33.482603: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 23:28:33.483958: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 23:28:33.488251: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
Date: 2020-02-02 23:28:25.775114
[INFO] input_shape (10, 16)
[INFO] LSTM first and last layer neurons: 5
adding core layer 0
[INFO] created DNN
[33m[INFO] epoch 1/100[0m
[33m[INFO] loading file 1-1/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1356 (0.2712%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9988%,3:0.0012%]
[INFO] ** i/f_dir:[1:99.9988%,0:0.0012%]
[INFO] ** src:[22:38.4088%,9:25.8982%,7:18.1636%,1:17.5218%,11:0.0014%,10:0.0014%,14:0.0012%,3:0.001%,2:0.001%,21:0.0006%,15:0.0004%,4:0.0004%,8:0.0002%]
[INFO] ** dst:[21:43.266%,10:21.0416%,8:18.1634%,9:17.5214%,6:0.0016%,16:0.0012%,15:0.0012%,22:0.001%,18:0.0006%,26:0.0004%,25:0.0004%,19:0.0004%,17:0.0004%,24:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.996%,2:0.0028%,1:0.0012%]
[INFO] ** appi_name:[21:99.9928%,30:0.0012%,22:0.001%,17:0.0008%,31:0.0006%,26:0.0006%,7:0.0006%,23:0.0004%,18:0.0004%,0:0.0004%,28:0.0002%,27:0.0002%,24:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.4088%,20:25.8982%,13:18.1636%,6:17.5218%,11:0.0014%,10:0.0014%,17:0.0012%,14:0.001%,1:0.001%,7:0.0006%,21:0.0004%,16:0.0004%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9928%,-33.760870000000004:0.007%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9974%,11:49.9954%,0:0.007%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:25.8976%,1:21.0406%,5:18.163%,4:17.521%,2:17.3678%,0:0.01%]
[INFO] ** service:[0.0048200000000000005:99.9936%,-211.73542999999998:0.0012%,-211.08818:0.001%,-205.44247:0.0008%,-211.07873999999998:0.0008%,-211.09762999999998:0.0006%,-211.08346:0.0006%,-186.43601999999998:0.0006%,-186.44547:0.0004%,-185.9872:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:25.8978%,-0.32151:21.0408%,-1.27613:18.1632%,-0.23351:17.5212%,-0.33484:17.368%,-71.33197:0.0012%,-71.14931:0.001%,-2.1481:0.0008%,-0.24151:0.0006%,-71.14798:0.0006%,-2.42942:0.0004%,4.44364:0.0004%,-1.02014:0.0004%,-64.19493:0.0004%,-5.1466400000000005:0.0002%,-1.2708:0.0002%,-58.035180000000004:0.0002%,4.076980000000001:0.0002%,-5.08665:0.0002%,1.47576:0.0002%,1.46509:0.0002%,4.29964:0.0002%,14.253910000000001:0.0002%,-68.79874000000001:0.0002%,6.1115699999999995:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,10.67005:0.0002%,-1.27347:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** classification:[normal:79.2972%,Single Stage Single Point:20.7028%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.7392 - tp: 41104.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 38896.0000 - accuracy: 0.9028 - precision: 1.0000 - recall: 0.5138 - auc: 0.9891 - val_loss: 0.1169 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1645 - tp: 75611.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 4389.0000 - accuracy: 0.9890 - precision: 1.0000 - recall: 0.9451 - auc: 0.9999 - val_loss: 0.0283 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1202 - tp: 77200.0000 - fp: 230.0000 - tn: 319770.0000 - fn: 2800.0000 - accuracy: 0.9924 - precision: 0.9970 - recall: 0.9650 - auc: 0.9981 - val_loss: 2.9124 - val_tp: 10606.0000 - val_fp: 9394.0000 - val_tn: 70606.0000 - val_fn: 9394.0000 - val_accuracy: 0.8121 - val_precision: 0.5303 - val_recall: 0.5303 - val_auc: 0.7048
[INFO] saving weights to checkpoints/lstm-epoch-1-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4468 - tp: 35372.0000 - fp: 31207.0000 - tn: 288793.0000 - fn: 44628.0000 - accuracy: 0.8104 - precision: 0.5313 - recall: 0.4421 - auc: 0.8057 - val_loss: 0.8151 - val_tp: 10626.0000 - val_fp: 9374.0000 - val_tn: 70626.0000 - val_fn: 9374.0000 - val_accuracy: 0.8125 - val_precision: 0.5313 - val_recall: 0.5313 - val_auc: 0.8832
[INFO] saving weights to checkpoints/lstm-epoch-1-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8248 - tp: 28613.0000 - fp: 25596.0000 - tn: 294404.0000 - fn: 51387.0000 - accuracy: 0.8075 - precision: 0.5278 - recall: 0.3577 - auc: 0.8811 - val_loss: 0.7242 - val_tp: 10603.0000 - val_fp: 8961.0000 - val_tn: 71039.0000 - val_fn: 9397.0000 - val_accuracy: 0.8164 - val_precision: 0.5420 - val_recall: 0.5301 - val_auc: 0.8828
[INFO] saving weights to checkpoints/lstm-epoch-1-files-0-1-batch-400000-500000
[33m[INFO] loading file 2-2/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1359 (0.2718%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9996%,3:0.0004%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** src:[22:38.3832%,9:25.9606%,7:18.1352%,1:17.52%,14:0.0004%,3:0.0004%,15:0.0002%]
[INFO] ** dst:[21:43.3108%,10:21.0326%,8:18.135%,9:17.5198%,22:0.0008%,15:0.0004%,2:0.0004%,24:0.0002%]
[INFO] ** proto:[0:99.9996%,1:0.0004%]
[INFO] ** appi_name:[21:99.9992%,30:0.0004%,8:0.0002%,7:0.0002%]
[INFO] ** proxy_src_ip:[18:38.3832%,20:25.9606%,13:18.1352%,6:17.52%,17:0.0004%,1:0.0004%,16:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9992%,-33.760870000000004:0.0008%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.9992%,0:0.0008%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:25.9596%,1:21.0326%,5:18.1348%,4:17.5194%,2:17.3504%,0:0.0032%]
[INFO] ** service:[0.0048200000000000005:99.9992%,-211.73542999999998:0.0004%,-211.09762999999998:0.0002%,-211.35747999999998:0.0002%]
[INFO] ** s_port:[1.45442:25.96%,-0.32151:21.0326%,-1.27613:18.1348%,-0.23351:17.5196%,-0.33484:17.3506%,1.45709:0.0004%,-71.33197:0.0004%,-1.27347:0.0002%,-0.24950999999999998:0.0002%,-3.3787199999999995:0.0002%,1.47576:0.0002%,12.60597:0.0002%,-0.24151:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:72.7902%,Single Stage Single Point:27.2098%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7661 - tp: 32591.0000 - fp: 30585.0000 - tn: 289415.0000 - fn: 47409.0000 - accuracy: 0.8050 - precision: 0.5159 - recall: 0.4074 - auc: 0.8799 - val_loss: 0.7043 - val_tp: 9523.0000 - val_fp: 8477.0000 - val_tn: 71523.0000 - val_fn: 10477.0000 - val_accuracy: 0.8105 - val_precision: 0.5291 - val_recall: 0.4762 - val_auc: 0.8827
[INFO] saving weights to checkpoints/lstm-epoch-1-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5303 - tp: 62701.0000 - fp: 12334.0000 - tn: 307666.0000 - fn: 17299.0000 - accuracy: 0.9259 - precision: 0.8356 - recall: 0.7838 - auc: 0.9590 - val_loss: 0.1971 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3845 - tp: 70213.0000 - fp: 7344.0000 - tn: 312656.0000 - fn: 9787.0000 - accuracy: 0.9572 - precision: 0.9053 - recall: 0.8777 - auc: 0.9749 - val_loss: 1.1256 - val_tp: 10593.0000 - val_fp: 9407.0000 - val_tn: 70593.0000 - val_fn: 9407.0000 - val_accuracy: 0.8119 - val_precision: 0.5296 - val_recall: 0.5296 - val_auc: 0.8826
[INFO] saving weights to checkpoints/lstm-epoch-1-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7819 - tp: 36501.0000 - fp: 32779.0000 - tn: 287221.0000 - fn: 43499.0000 - accuracy: 0.8093 - precision: 0.5269 - recall: 0.4563 - auc: 0.8811 - val_loss: 0.6951 - val_tp: 10602.0000 - val_fp: 9398.0000 - val_tn: 70602.0000 - val_fn: 9398.0000 - val_accuracy: 0.8120 - val_precision: 0.5301 - val_recall: 0.5301 - val_auc: 0.8821
[INFO] saving weights to checkpoints/lstm-epoch-1-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5095 - tp: 64373.0000 - fp: 12183.0000 - tn: 307817.0000 - fn: 15627.0000 - accuracy: 0.9305 - precision: 0.8409 - recall: 0.8047 - auc: 0.9595 - val_loss: 0.1960 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-1-2-batch-400000-500000
[33m[INFO] loading file 3-3/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1357 (0.2714%)
[INFO] ** orig:[0:99.9988%,2:0.0012%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9984%,3:0.0016%]
[INFO] ** i/f_dir:[1:99.9984%,0:0.0016%]
[INFO] ** src:[22:38.418%,9:25.9724%,7:18.1538%,1:17.4466%,21:0.0022%,3:0.0018%,2:0.0014%,11:0.0008%,10:0.0008%,4:0.0008%,14:0.0004%,8:0.0004%,17:0.0002%,15:0.0002%,13:0.0002%]
[INFO] ** dst:[21:43.3012%,10:21.0888%,8:18.1536%,9:17.4462%,6:0.0024%,15:0.0016%,18:0.0014%,16:0.0014%,22:0.001%,2:0.0004%,7:0.0004%,25:0.0004%,17:0.0004%,12:0.0002%,24:0.0002%,19:0.0002%,0:0.0002%]
[INFO] ** proto:[0:99.9936%,2:0.0048%,1:0.0016%]
[INFO] ** appi_name:[21:99.9908%,30:0.0024%,22:0.0012%,31:0.001%,26:0.001%,17:0.001%,7:0.0008%,27:0.0004%,0:0.0004%,28:0.0002%,23:0.0002%,15:0.0002%,8:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.418%,20:25.9724%,13:18.1538%,6:17.4466%,17:0.0024%,1:0.0016%,14:0.0014%,7:0.001%,11:0.0008%,10:0.0008%,21:0.0006%,16:0.0002%,15:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9908%,-33.760870000000004:0.009%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9962%,11:49.9946%,0:0.009%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:25.9712%,1:21.0884%,5:18.153%,4:17.4458%,2:17.3292%,0:0.0124%]
[INFO] ** service:[0.0048200000000000005:99.991%,-211.73542999999998:0.0016%,-186.43601999999998:0.0014%,-211.08346:0.0012%,-211.08818:0.0012%,-205.44247:0.001%,-211.09762999999998:0.0008%,-186.44547:0.0004%,-202.75898:0.0004%,-183.8612:0.0002%,-185.9872:0.0002%,-201.23771000000002:0.0002%,-211.35747999999998:0.0002%,-211.07873999999998:0.0002%]
[INFO] ** s_port:[1.45442:25.9716%,-0.32151:21.0886%,-1.27613:18.1532%,-0.23351:17.446%,-0.33484:17.3294%,-71.33197:0.0016%,-71.14798:0.0012%,-71.14931:0.0012%,-64.19493:0.0004%,-0.08551:0.0004%,1.45709:0.0004%,-0.24151:0.0004%,13.431270000000001:0.0002%,14.4699:0.0002%,4.076980000000001:0.0002%,-5.1466400000000005:0.0002%,-1.02014:0.0002%,1.47576:0.0002%,-1.2708:0.0002%,-58.035180000000004:0.0002%,-58.032509999999995:0.0002%,12.60597:0.0002%,-5.08665:0.0002%,1.46509:0.0002%,-2.1481:0.0002%,-1.27347:0.0002%,10.67005:0.0002%,-43.76509:0.0002%,2.05573:0.0002%,6.1115699999999995:0.0002%,4.44364:0.0002%,13.86459:0.0002%,4.29964:0.0002%,-0.24950999999999998:0.0002%,-3.3787199999999995:0.0002%,10.192739999999999:0.0002%,-68.79874000000001:0.0002%,14.253910000000001:0.0002%,4.90362:0.0002%,-68.36943000000001:0.0002%]
[INFO] ** classification:[normal:86.7116%,Single Stage Single Point:13.2884%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7311 - tp: 43652.0000 - fp: 33492.0000 - tn: 286508.0000 - fn: 36348.0000 - accuracy: 0.8254 - precision: 0.5659 - recall: 0.5457 - auc: 0.8909 - val_loss: 0.6960 - val_tp: 10571.0000 - val_fp: 9429.0000 - val_tn: 70571.0000 - val_fn: 9429.0000 - val_accuracy: 0.8114 - val_precision: 0.5286 - val_recall: 0.5286 - val_auc: 0.8857
[INFO] saving weights to checkpoints/lstm-epoch-1-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6213 - tp: 55862.0000 - fp: 21521.0000 - tn: 298479.0000 - fn: 24138.0000 - accuracy: 0.8859 - precision: 0.7219 - recall: 0.6983 - auc: 0.9311 - val_loss: 0.3468 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1389 - tp: 78754.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 1246.0000 - accuracy: 0.9969 - precision: 1.0000 - recall: 0.9844 - auc: 1.0000 - val_loss: 0.0341 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0566 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0149 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0402 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0084 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-2-3-batch-400000-500000
[33m[INFO] loading file 4-4/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1367 (0.2734%)
[INFO] ** orig:[0:99.9988%,2:0.0012%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** i/f_name:[2:99.9986%,3:0.0014%]
[INFO] ** i/f_dir:[1:99.9988%,0:0.0012%]
[INFO] ** src:[22:38.2474%,9:26.0432%,7:18.1738%,1:17.5328%,21:0.0012%,15:0.0004%,4:0.0004%,17:0.0002%,14:0.0002%,8:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3578%,10:20.9324%,8:18.1738%,9:17.5324%,15:0.0014%,22:0.0012%,18:0.0004%,24:0.0002%,6:0.0002%,0:0.0002%]
[INFO] ** proto:[0:99.998%,1:0.0014%,2:0.0006%]
[INFO] ** appi_name:[21:99.9976%,30:0.0014%,31:0.0004%,33:0.0002%,26:0.0002%,9:0.0002%]
[INFO] ** proxy_src_ip:[18:38.2474%,20:26.0432%,13:18.1738%,6:17.5328%,17:0.0014%,21:0.0004%,16:0.0004%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9976%,-33.760870000000004:0.0024%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.9978%,0:0.0024%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.0422%,1:20.932%,5:18.1734%,4:17.5318%,2:17.315%,0:0.0056%]
[INFO] ** service:[0.0048200000000000005:99.9978%,-211.73542999999998:0.0014%,-186.43601999999998:0.0004%,-183.8612:0.0002%,-211.08346:0.0002%]
[INFO] ** s_port:[1.45442:26.0424%,-0.32151:20.9322%,-1.27613:18.1734%,-0.23351:17.5322%,-0.33484:17.3152%,-71.33197:0.0014%,1.45709:0.0004%,-0.24151:0.0004%,-1.02014:0.0004%,-0.08551:0.0004%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,14.4699:0.0002%,-49.275529999999996:0.0002%,-1.2708:0.0002%,-71.14798:0.0002%]
[INFO] ** classification:[normal:91.244%,Single Stage Single Point:8.756%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0314 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0054 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0260 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0037 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0217 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0026 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4732 - tp: 71528.0000 - fp: 8472.0000 - tn: 311528.0000 - fn: 8472.0000 - accuracy: 0.9576 - precision: 0.8941 - recall: 0.8941 - auc: 0.9635 - val_loss: 1.5193 - val_tp: 7806.0000 - val_fp: 12194.0000 - val_tn: 67806.0000 - val_fn: 12194.0000 - val_accuracy: 0.7561 - val_precision: 0.3903 - val_recall: 0.3903 - val_auc: 0.8481
[INFO] saving weights to checkpoints/lstm-epoch-1-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6275 - tp: 56887.0000 - fp: 23113.0000 - tn: 296887.0000 - fn: 23113.0000 - accuracy: 0.8844 - precision: 0.7111 - recall: 0.7111 - auc: 0.9287 - val_loss: 0.3530 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-3-4-batch-400000-500000
[33m[INFO] loading file 5-5/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0:99.9982%,2:0.0018%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** i/f_name:[2:99.9978%,3:0.0022%]
[INFO] ** i/f_dir:[1:99.998%,0:0.002%]
[INFO] ** src:[22:37.992%,9:26.1346%,7:18.252%,1:17.618%,21:0.002%,14:0.0004%,16:0.0002%,15:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.365%,10:20.7618%,8:18.2518%,9:17.6176%,15:0.0022%,22:0.0008%,25:0.0002%,24:0.0002%,6:0.0002%,2:0.0002%]
[INFO] ** proto:[0:99.9974%,1:0.0022%,2:0.0004%]
[INFO] ** appi_name:[21:99.9968%,30:0.0022%,37:0.0002%,26:0.0002%,12:0.0002%,6:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:37.992%,20:26.1346%,13:18.252%,6:17.618%,17:0.0022%,21:0.0002%,16:0.0002%,7:0.0002%,5:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9968%,-33.760870000000004:0.0032%]
[INFO] ** modbus_function_description:[7:49.999%,11:49.9978%,0:0.0032%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.134%,1:20.7612%,5:18.2516%,4:17.6176%,2:17.2306%,0:0.005%]
[INFO] ** service:[0.0048200000000000005:99.9972%,-211.73542999999998:0.0022%,-186.44547:0.0002%,-211.08346:0.0002%,-211.35747999999998:0.0002%]
[INFO] ** s_port:[1.45442:26.1344%,-0.32151:20.7614%,-1.27613:18.2518%,-0.23351:17.6176%,-0.33484:17.2306%,-71.33197:0.0022%,-0.24151:0.0004%,-71.14798:0.0002%,-1.27347:0.0002%,1.45709:0.0002%,2.22906:0.0002%,-49.275529999999996:0.0002%,-61.95768:0.0002%,-1.02014:0.0002%,-64.19493:0.0002%]
[INFO] ** classification:[normal:88.731%,Single Stage Single Point:11.269%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5366 - tp: 62445.0000 - fp: 17555.0000 - tn: 302445.0000 - fn: 17555.0000 - accuracy: 0.9122 - precision: 0.7806 - recall: 0.7806 - auc: 0.9451 - val_loss: 0.7013 - val_tp: 12842.0000 - val_fp: 7158.0000 - val_tn: 72842.0000 - val_fn: 7158.0000 - val_accuracy: 0.8568 - val_precision: 0.6421 - val_recall: 0.6421 - val_auc: 0.9106
[INFO] saving weights to checkpoints/lstm-epoch-1-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6655 - tp: 51316.0000 - fp: 28684.0000 - tn: 291316.0000 - fn: 28684.0000 - accuracy: 0.8566 - precision: 0.6414 - recall: 0.6414 - auc: 0.9103 - val_loss: 0.5254 - val_tp: 17052.0000 - val_fp: 2948.0000 - val_tn: 77052.0000 - val_fn: 2948.0000 - val_accuracy: 0.9410 - val_precision: 0.8526 - val_recall: 0.8526 - val_auc: 0.9630
[INFO] saving weights to checkpoints/lstm-epoch-1-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1099 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0255 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0343 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0113 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0232 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0066 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-4-5-batch-400000-500000
[33m[INFO] loading file 6-6/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1369 (0.2738%)
[INFO] ** orig:[0:99.9996%,1:0.0004%]
[INFO] ** type:[0:99.999%,1:0.001%]
[INFO] ** i/f_name:[2:99.9964%,3:0.0036%]
[INFO] ** i/f_dir:[1:99.9966%,0:0.0034%]
[INFO] ** src:[22:37.9454%,9:26.1658%,7:18.285%,1:17.5992%,14:0.0036%,2:0.0006%,15:0.0002%,10:0.0002%]
[INFO] ** dst:[21:43.3788%,10:20.7322%,8:18.2848%,9:17.599%,15:0.0036%,22:0.0004%,25:0.0002%,24:0.0002%,18:0.0002%,12:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** proto:[0:99.9954%,1:0.0036%,2:0.001%]
[INFO] ** appi_name:[21:99.9954%,30:0.0036%,31:0.0002%,27:0.0002%,26:0.0002%,5:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:37.9454%,20:26.1658%,13:18.285%,6:17.5992%,17:0.0036%,14:0.0006%,16:0.0002%,11:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9954%,-33.760870000000004:0.0046%]
[INFO] ** modbus_function_description:[7:49.9984%,11:49.997%,0:0.0046%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1652%,1:20.732%,5:18.2842%,4:17.5984%,2:17.213%,0:0.0072%]
[INFO] ** service:[0.0048200000000000005:99.9954%,-211.73542999999998:0.0036%,-186.44547:0.0002%,-211.08346:0.0002%,-186.43601999999998:0.0002%,-201.23771000000002:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.1654%,-0.32151:20.7322%,-1.27613:18.2844%,-0.23351:17.5988%,-0.33484:17.2132%,-71.33197:0.0036%,-0.24151:0.0002%,-1.2708:0.0002%,-64.19493:0.0002%,-1.02014:0.0002%,13.431270000000001:0.0002%,4.90362:0.0002%,-71.14798:0.0002%,1.47576:0.0002%,1.46509:0.0002%,-0.24950999999999998:0.0002%,-1.27347:0.0002%,-68.36943000000001:0.0002%]
[INFO] ** classification:[normal:91.919%,Single Stage Single Point:8.081%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0175 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0043 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0144 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0030 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0121 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0022 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0106 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4215 - val_tp: 15632.0000 - val_fp: 4368.0000 - val_tn: 75632.0000 - val_fn: 4368.0000 - val_accuracy: 0.9126 - val_precision: 0.7816 - val_recall: 0.7816 - val_auc: 0.8635
[INFO] saving weights to checkpoints/lstm-epoch-1-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0162 - tp: 51195.0000 - fp: 28805.0000 - tn: 291195.0000 - fn: 28805.0000 - accuracy: 0.8560 - precision: 0.6399 - recall: 0.6399 - auc: 0.8959 - val_loss: 0.6507 - val_tp: 12768.0000 - val_fp: 7232.0000 - val_tn: 72768.0000 - val_fn: 7232.0000 - val_accuracy: 0.8554 - val_precision: 0.6384 - val_recall: 0.6384 - val_auc: 0.9632
[INFO] saving weights to checkpoints/lstm-epoch-1-files-5-6-batch-400000-500000
[33m[INFO] loading file 7-7/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9986%,3:0.0014%]
[INFO] ** i/f_dir:[1:99.9986%,0:0.0014%]
[INFO] ** src:[22:37.9848%,9:26.133%,7:18.2404%,1:17.6366%,14:0.0014%,10:0.0008%,3:0.0008%,4:0.0006%,21:0.0004%,15:0.0004%,2:0.0004%,11:0.0002%,8:0.0002%]
[INFO] ** dst:[21:43.358%,10:20.759%,8:18.24%,9:17.6364%,6:0.0016%,22:0.0014%,15:0.0014%,16:0.0008%,24:0.0004%,18:0.0004%,17:0.0004%,7:0.0002%]
[INFO] ** proto:[0:99.9964%,2:0.0022%,1:0.0014%]
[INFO] ** appi_name:[21:99.9952%,30:0.0014%,22:0.001%,17:0.0008%,26:0.0006%,31:0.0004%,28:0.0002%,27:0.0002%,7:0.0002%]
[INFO] ** proxy_src_ip:[18:37.9848%,20:26.133%,13:18.2404%,6:17.6366%,17:0.0014%,11:0.0008%,1:0.0008%,21:0.0006%,16:0.0004%,14:0.0004%,7:0.0004%,10:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9952%,-33.760870000000004:0.0048%]
[INFO] ** modbus_function_description:[7:49.9984%,11:49.9968%,0:0.0048%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1316%,1:20.759%,5:18.2398%,4:17.636%,2:17.2258%,0:0.0078%]
[INFO] ** service:[0.0048200000000000005:99.9952%,-211.73542999999998:0.0014%,-211.08818:0.001%,-205.44247:0.0008%,-211.08346:0.0006%,-186.43601999999998:0.0004%,-211.09762999999998:0.0002%,-185.9872:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.132%,-0.32151:20.759%,-1.27613:18.2398%,-0.23351:17.6362%,-0.33484:17.2258%,-71.33197:0.0014%,-71.14931:0.001%,-71.14798:0.0006%,1.45709:0.0006%,-1.02014:0.0004%,-1.27347:0.0004%,-0.24151:0.0004%,-58.035180000000004:0.0002%,-1.2708:0.0002%,-5.1466400000000005:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-5.08665:0.0002%,14.253910000000001:0.0002%,-68.79874000000001:0.0002%,6.1115699999999995:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** classification:[normal:82.7162%,Single Stage Single Point:17.2838%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5119 - tp: 58551.0000 - fp: 19719.0000 - tn: 300281.0000 - fn: 21449.0000 - accuracy: 0.8971 - precision: 0.7481 - recall: 0.7319 - auc: 0.9608 - val_loss: 0.3063 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2915 - tp: 71070.0000 - fp: 7400.0000 - tn: 312600.0000 - fn: 8930.0000 - accuracy: 0.9592 - precision: 0.9057 - recall: 0.8884 - auc: 0.9930 - val_loss: 0.1096 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3367 - tp: 66815.0000 - fp: 12554.0000 - tn: 307446.0000 - fn: 13185.0000 - accuracy: 0.9357 - precision: 0.8418 - recall: 0.8352 - auc: 0.9833 - val_loss: 0.1483 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0621 - tp: 79989.0000 - fp: 11.0000 - tn: 319989.0000 - fn: 11.0000 - accuracy: 0.9999 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 0.0109 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0379 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0060 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-6-7-batch-400000-500000
[33m[INFO] loading file 8-8/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1369 (0.2738%)
[INFO] ** orig:[0:99.9996%,2:0.0004%]
[INFO] ** type:[0:99.9994%,1:0.0004%,2:0.0002%]
[INFO] ** i/f_name:[2:99.999%,3:0.001%]
[INFO] ** i/f_dir:[1:99.9994%,0:0.0006%]
[INFO] ** src:[22:38.1046%,9:26.147%,7:18.1632%,1:17.5816%,11:0.0012%,15:0.0006%,14:0.0006%,21:0.0004%,2:0.0004%,16:0.0002%,10:0.0002%]
[INFO] ** dst:[21:43.4334%,10:20.8176%,8:18.164%,9:17.5812%,22:0.0014%,15:0.001%,25:0.0006%,19:0.0004%,26:0.0002%,24:0.0002%]
[INFO] ** proto:[0:99.9982%,1:0.001%,2:0.0008%]
[INFO] ** appi_name:[21:99.997%,30:0.001%,0:0.0006%,24:0.0002%,23:0.0002%,22:0.0002%,18:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.1046%,20:26.147%,13:18.1632%,6:17.5816%,10:0.0012%,17:0.001%,16:0.0006%,14:0.0004%,11:0.0002%,5:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.997%,-33.760870000000004:0.0028%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.9972%,0:0.0028%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.146%,1:20.8174%,5:18.163%,4:17.5808%,2:17.2868%,0:0.006%]
[INFO] ** service:[0.0048200000000000005:99.9978%,-211.73542999999998:0.001%,-186.44547:0.0006%,-211.07873999999998:0.0004%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.1464%,-0.32151:20.8176%,-1.27613:18.163%,-0.23351:17.581%,-0.33484:17.287%,-71.33197:0.001%,-15.039579999999999:0.0008%,-1.02014:0.0006%,-64.19493:0.0006%,1.45709:0.0004%,-0.24151:0.0004%,4.66896:0.0004%,-1.27347:0.0002%,-0.24950999999999998:0.0002%,1.47576:0.0002%,-71.14931:0.0002%]
[INFO] ** classification:[normal:94.2844%,Single Stage Single Point:5.7156%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0266 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0035 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0023 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0156 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0017 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3441 - tp: 73158.0000 - fp: 6834.0000 - tn: 313166.0000 - fn: 6842.0000 - accuracy: 0.9658 - precision: 0.9146 - recall: 0.9145 - auc: 0.9778 - val_loss: 0.3874 - val_tp: 16368.0000 - val_fp: 3632.0000 - val_tn: 76368.0000 - val_fn: 3632.0000 - val_accuracy: 0.9274 - val_precision: 0.8184 - val_recall: 0.8184 - val_auc: 0.9911
[INFO] saving weights to checkpoints/lstm-epoch-1-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2683 - tp: 68979.0000 - fp: 9752.0000 - tn: 310248.0000 - fn: 11021.0000 - accuracy: 0.9481 - precision: 0.8761 - recall: 0.8622 - auc: 0.9911 - val_loss: 0.1450 - val_tp: 16383.0000 - val_fp: 679.0000 - val_tn: 79321.0000 - val_fn: 3617.0000 - val_accuracy: 0.9570 - val_precision: 0.9602 - val_recall: 0.8191 - val_auc: 0.9967
[INFO] saving weights to checkpoints/lstm-epoch-1-files-7-8-batch-400000-500000
[33m[INFO] loading file 9-9/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9992%,3:0.0008%]
[INFO] ** i/f_dir:[1:99.9992%,0:0.0008%]
[INFO] ** src:[22:38.0%,9:26.1346%,7:18.2984%,1:17.5654%,14:0.0008%,17:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3632%,10:20.7708%,8:18.2982%,9:17.5652%,22:0.0008%,15:0.0008%,18:0.0004%,25:0.0002%,24:0.0002%,6:0.0002%]
[INFO] ** proto:[0:99.9984%,2:0.0008%,1:0.0008%]
[INFO] ** appi_name:[21:99.9984%,30:0.0008%,31:0.0004%,26:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:38.0%,20:26.1346%,13:18.2984%,6:17.5654%,17:0.0008%,21:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9984%,-33.760870000000004:0.0016%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.9986%,0:0.0016%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1334%,1:20.7708%,5:18.298%,4:17.5648%,2:17.2292%,0:0.0038%]
[INFO] ** service:[0.0048200000000000005:99.9984%,-211.73542999999998:0.0008%,-186.43601999999998:0.0004%,-186.44547:0.0002%,-211.08346:0.0002%]
[INFO] ** s_port:[1.45442:26.1338%,-0.32151:20.7708%,-1.27613:18.298%,-0.23351:17.565%,-0.33484:17.2292%,-71.33197:0.0008%,1.45709:0.0004%,-0.24151:0.0004%,-0.08551:0.0004%,-71.14798:0.0002%,-1.27347:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:96.1038%,Single Stage Single Point:3.8962%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1742 - tp: 72583.0000 - fp: 7414.0000 - tn: 312586.0000 - fn: 7417.0000 - accuracy: 0.9629 - precision: 0.9073 - recall: 0.9073 - auc: 0.9966 - val_loss: 0.0849 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1203 - tp: 77552.0000 - fp: 2444.0000 - tn: 317556.0000 - fn: 2448.0000 - accuracy: 0.9878 - precision: 0.9694 - recall: 0.9694 - auc: 0.9966 - val_loss: 0.0222 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0221 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0014 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0153 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.8176e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0123 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8077e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-8-9-batch-400000-500000
[33m[INFO] loading file 10-10/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0:99.9992%,1:0.0008%]
[INFO] ** type:[0:99.9984%,1:0.0014%,2:0.0002%]
[INFO] ** i/f_name:[2:99.998%,3:0.002%]
[INFO] ** i/f_dir:[1:99.9982%,0:0.0018%]
[INFO] ** src:[22:38.097%,9:26.13%,7:18.2188%,1:17.5504%,14:0.002%,11:0.001%,2:0.0004%,16:0.0002%,15:0.0002%]
[INFO] ** dst:[21:43.4154%,10:20.8112%,8:18.2186%,9:17.551%,15:0.002%,22:0.0006%,24:0.0004%,19:0.0004%,26:0.0002%,25:0.0002%]
[INFO] ** proto:[0:99.9976%,1:0.002%,2:0.0004%]
[INFO] ** appi_name:[21:99.9964%,30:0.002%,24:0.0002%,23:0.0002%,22:0.0002%,18:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:38.097%,20:26.13%,13:18.2188%,6:17.5504%,17:0.002%,10:0.001%,14:0.0004%,16:0.0002%,5:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9964%,-33.760870000000004:0.0034%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9988%,11:49.9976%,0:0.0034%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.129%,1:20.811%,5:18.2182%,4:17.5498%,2:17.2856%,0:0.0064%]
[INFO] ** service:[0.0048200000000000005:99.9972%,-211.73542999999998:0.002%,-211.07873999999998:0.0004%,-186.44547:0.0002%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.1294%,-0.32151:20.8112%,-1.27613:18.2182%,-0.23351:17.55%,-0.33484:17.2858%,-71.33197:0.002%,-10.51843:0.0008%,5.71692:0.0004%,-1.27347:0.0004%,1.46509:0.0002%,1.47576:0.0002%,-0.24950999999999998:0.0002%,1.45709:0.0002%,-0.24151:0.0002%,-71.14931:0.0002%,-1.02014:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:93.8902%,Single Stage Single Point:6.1098%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0101 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4117e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0162 - tp: 79936.0000 - fp: 64.0000 - tn: 319936.0000 - fn: 64.0000 - accuracy: 0.9997 - precision: 0.9992 - recall: 0.9992 - auc: 0.9995 - val_loss: 3.0151 - val_tp: 12843.0000 - val_fp: 7157.0000 - val_tn: 72843.0000 - val_fn: 7157.0000 - val_accuracy: 0.8569 - val_precision: 0.6421 - val_recall: 0.6421 - val_auc: 0.7763
[INFO] saving weights to checkpoints/lstm-epoch-1-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5265 - tp: 64409.0000 - fp: 15558.0000 - tn: 304442.0000 - fn: 15591.0000 - accuracy: 0.9221 - precision: 0.8054 - recall: 0.8051 - auc: 0.9646 - val_loss: 0.3298 - val_tp: 12813.0000 - val_fp: 7187.0000 - val_tn: 72813.0000 - val_fn: 7187.0000 - val_accuracy: 0.8563 - val_precision: 0.6406 - val_recall: 0.6406 - val_auc: 0.9677
[INFO] saving weights to checkpoints/lstm-epoch-1-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1324 - tp: 75715.0000 - fp: 4230.0000 - tn: 315770.0000 - fn: 4285.0000 - accuracy: 0.9787 - precision: 0.9471 - recall: 0.9464 - auc: 0.9977 - val_loss: 0.0063 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0171 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0023 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-9-10-batch-400000-500000
[33m[INFO] loading file 11-11/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9996%,3:0.0004%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** src:[22:38.147%,9:26.1112%,7:18.2032%,1:17.5368%,15:0.0006%,14:0.0004%,17:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3768%,10:20.881%,8:18.2034%,9:17.5362%,22:0.0014%,18:0.0004%,15:0.0004%,25:0.0002%,6:0.0002%]
[INFO] ** proto:[0:99.9988%,2:0.0008%,1:0.0004%]
[INFO] ** appi_name:[21:99.9988%,31:0.0004%,30:0.0004%,26:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:38.147%,20:26.1112%,13:18.2032%,6:17.5368%,16:0.0006%,17:0.0004%,21:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9988%,-33.760870000000004:0.0012%]
[INFO] ** modbus_function_description:[7:50.0004%,11:49.9984%,0:0.0012%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1104%,1:20.881%,5:18.203%,4:17.536%,2:17.2658%,0:0.0038%]
[INFO] ** service:[0.0048200000000000005:99.9988%,-211.73542999999998:0.0004%,-186.43601999999998:0.0004%,-186.44547:0.0002%,-211.08346:0.0002%]
[INFO] ** s_port:[1.45442:26.1108%,-0.32151:20.881%,-1.27613:18.2032%,-0.23351:17.5362%,-0.33484:17.266%,-0.24151:0.0006%,-1.02014:0.0006%,-0.08551:0.0004%,-71.33197:0.0004%,-71.14798:0.0002%,1.45709:0.0002%,1.46509:0.0002%,-64.19493:0.0002%]
[INFO] ** classification:[normal:100.0%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0132 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0014 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0112 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.7722e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0099 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.2384e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0087 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.5194e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0078 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2150e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-10-11-batch-400000-500000
[33m[INFO] loading file 12-12/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:99.9982%,2:0.0018%]
[INFO] ** type:[0:99.9996%,1:0.0004%]
[INFO] ** i/f_name:[2:99.9978%,3:0.0022%]
[INFO] ** i/f_dir:[1:99.9982%,0:0.0018%]
[INFO] ** src:[22:38.138%,9:26.1258%,7:18.1958%,1:17.5378%,21:0.0018%,14:0.0004%,15:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3898%,10:20.8738%,8:18.1954%,9:17.5376%,15:0.0022%,22:0.0006%,24:0.0004%,0:0.0002%]
[INFO] ** proto:[0:99.9978%,1:0.0022%]
[INFO] ** appi_name:[21:99.9976%,30:0.0022%,9:0.0002%]
[INFO] ** proxy_src_ip:[18:38.138%,20:26.1258%,13:18.1958%,6:17.5378%,17:0.0022%,16:0.0002%,1:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9976%,-33.760870000000004:0.0024%]
[INFO] ** modbus_function_description:[7:49.9994%,11:49.9982%,0:0.0024%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.125%,1:20.8738%,5:18.1952%,4:17.537%,2:17.2642%,0:0.0048%]
[INFO] ** service:[0.0048200000000000005:99.9976%,-211.73542999999998:0.0022%,-183.8612:0.0002%]
[INFO] ** s_port:[1.45442:26.1254%,-0.32151:20.8738%,-1.27613:18.1952%,-0.23351:17.5374%,-0.33484:17.2642%,-71.33197:0.0022%,-1.27347:0.0004%,1.45709:0.0002%,-0.24950999999999998:0.0002%,1.47576:0.0002%,14.4699:0.0002%,-0.24151:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:92.7618%,Single Stage Single Point:7.2382%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0069 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2611e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0060 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4126 - val_tp: 16689.0000 - val_fp: 3311.0000 - val_tn: 76689.0000 - val_fn: 3311.0000 - val_accuracy: 0.9338 - val_precision: 0.8345 - val_recall: 0.8345 - val_auc: 0.8965
[INFO] saving weights to checkpoints/lstm-epoch-1-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6372 - tp: 59968.0000 - fp: 19930.0000 - tn: 300070.0000 - fn: 20032.0000 - accuracy: 0.9001 - precision: 0.7506 - recall: 0.7496 - auc: 0.9559 - val_loss: 0.2474 - val_tp: 17100.0000 - val_fp: 2900.0000 - val_tn: 77100.0000 - val_fn: 2900.0000 - val_accuracy: 0.9420 - val_precision: 0.8550 - val_recall: 0.8550 - val_auc: 0.9871
[INFO] saving weights to checkpoints/lstm-epoch-1-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1919 - tp: 73767.0000 - fp: 6194.0000 - tn: 313806.0000 - fn: 6233.0000 - accuracy: 0.9689 - precision: 0.9225 - recall: 0.9221 - auc: 0.9948 - val_loss: 0.0585 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0330 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0041 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-11-12-batch-400000-500000
[33m[INFO] loading file 13-13/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9996%,3:0.0004%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** src:[22:38.0458%,9:26.115%,7:18.2794%,1:17.5554%,11:0.0012%,10:0.001%,15:0.0006%,21:0.0004%,14:0.0004%,17:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3642%,10:20.7962%,8:18.2792%,9:17.556%,22:0.0012%,6:0.001%,18:0.0008%,25:0.0006%,15:0.0004%,24:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.997%,2:0.0026%,1:0.0004%]
[INFO] ** appi_name:[21:99.9962%,31:0.0008%,26:0.0006%,0:0.0006%,30:0.0004%,22:0.0004%,27:0.0002%,24:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.0458%,20:26.115%,13:18.2794%,6:17.5554%,10:0.0012%,11:0.001%,16:0.0006%,17:0.0004%,7:0.0004%,21:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9962%,-33.760870000000004:0.0036%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9988%,11:49.9974%,0:0.0036%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.114%,1:20.796%,5:18.279%,4:17.555%,2:17.2494%,0:0.0066%]
[INFO] ** service:[0.0048200000000000005:99.997%,-186.43601999999998:0.0008%,-186.44547:0.0006%,-211.08346:0.0006%,-211.73542999999998:0.0004%,-211.08818:0.0004%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.1144%,-0.32151:20.7962%,-1.27613:18.279%,-0.23351:17.555%,-0.33484:17.2496%,-9.78512:0.0008%,-71.14798:0.0006%,-64.19493:0.0006%,-1.02014:0.0006%,-0.08551:0.0004%,-71.14931:0.0004%,-0.24151:0.0004%,-71.33197:0.0004%,-1.27347:0.0002%,1.46509:0.0002%,-68.79874000000001:0.0002%,14.540560000000001:0.0002%,1.45709:0.0002%,-1.2708:0.0002%,6.1115699999999995:0.0002%,1.47576:0.0002%]
[INFO] ** classification:[normal:84.6974%,Single Stage Single Point:15.3026%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0142 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0016 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0113 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.5179e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0097 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8411 - val_tp: 15075.0000 - val_fp: 4925.0000 - val_tn: 75075.0000 - val_fn: 4925.0000 - val_accuracy: 0.9015 - val_precision: 0.7538 - val_recall: 0.7538 - val_auc: 0.8461
[INFO] saving weights to checkpoints/lstm-epoch-1-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6099 - tp: 56960.0000 - fp: 23017.0000 - tn: 296983.0000 - fn: 23040.0000 - accuracy: 0.8849 - precision: 0.7122 - recall: 0.7120 - auc: 0.9552 - val_loss: 0.2242 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2267 - tp: 65639.0000 - fp: 14361.0000 - tn: 305639.0000 - fn: 14361.0000 - accuracy: 0.9282 - precision: 0.8205 - recall: 0.8205 - auc: 0.9910 - val_loss: 0.1175 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-12-13-batch-400000-500000
[33m[INFO] loading file 14-14/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** i/f_name:[2:99.9998%,3:0.0002%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** src:[22:38.0404%,9:26.1076%,7:18.2758%,1:17.5756%,15:0.0002%,14:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3416%,10:20.8058%,8:18.2756%,9:17.5754%,22:0.0008%,24:0.0004%,15:0.0002%,0:0.0002%]
[INFO] ** proto:[0:99.9998%,1:0.0002%]
[INFO] ** appi_name:[21:99.9996%,30:0.0002%,9:0.0002%]
[INFO] ** proxy_src_ip:[18:38.0404%,20:26.1076%,13:18.2758%,6:17.5756%,17:0.0002%,16:0.0002%,1:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9996%,-33.760870000000004:0.0004%]
[INFO] ** modbus_function_description:[7:50.0008%,11:49.9988%,0:0.0004%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1064%,1:20.8058%,5:18.275%,4:17.5748%,2:17.2344%,0:0.0036%]
[INFO] ** service:[0.0048200000000000005:99.9996%,-183.8612:0.0002%,-211.73542999999998:0.0002%]
[INFO] ** s_port:[1.45442:26.1068%,-0.32151:20.8058%,-1.27613:18.2752%,-0.23351:17.5752%,-0.33484:17.2346%,-1.27347:0.0004%,1.45709:0.0004%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,14.4699:0.0002%,-0.24151:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%,-71.33197:0.0002%]
[INFO] ** classification:[normal:96.5086%,Single Stage Single Point:3.4914%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3050 - tp: 65466.0000 - fp: 14523.0000 - tn: 305477.0000 - fn: 14534.0000 - accuracy: 0.9274 - precision: 0.8184 - recall: 0.8183 - auc: 0.9835 - val_loss: 0.2773 - val_tp: 14303.0000 - val_fp: 5691.0000 - val_tn: 74309.0000 - val_fn: 5697.0000 - val_accuracy: 0.8861 - val_precision: 0.7154 - val_recall: 0.7151 - val_auc: 0.9733
[INFO] saving weights to checkpoints/lstm-epoch-1-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0741 - tp: 79548.0000 - fp: 451.0000 - tn: 319549.0000 - fn: 452.0000 - accuracy: 0.9977 - precision: 0.9944 - recall: 0.9944 - auc: 0.9999 - val_loss: 0.0017 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0222 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.5210e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0193 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.2889e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0169 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3947e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-13-14-batch-400000-500000
[33m[INFO] loading file 15-15/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1374 (0.2748%)
[INFO] ** orig:[0:99.997%,2:0.003%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9968%,3:0.0032%]
[INFO] ** i/f_dir:[1:99.9968%,0:0.0032%]
[INFO] ** src:[22:38.005%,9:26.0626%,7:18.3142%,1:17.6136%,21:0.0034%,15:0.0006%,16:0.0002%,14:0.0002%,8:0.0002%]
[INFO] ** dst:[21:43.2978%,10:20.7692%,8:18.3144%,9:17.613%,15:0.0032%,22:0.0016%,25:0.0002%,24:0.0002%,16:0.0002%,6:0.0002%]
[INFO] ** proto:[0:99.9964%,1:0.0032%,2:0.0004%]
[INFO] ** appi_name:[21:99.996%,30:0.0032%,26:0.0002%,17:0.0002%,12:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:38.005%,20:26.0626%,13:18.3142%,6:17.6136%,17:0.0032%,16:0.0006%,7:0.0004%,5:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.996%,-33.760870000000004:0.004%]
[INFO] ** modbus_function_description:[7:49.999%,11:49.997%,0:0.004%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.0614%,1:20.7688%,5:18.314%,4:17.6124%,2:17.2358%,0:0.0076%]
[INFO] ** service:[0.0048200000000000005:99.9962%,-211.73542999999998:0.0032%,-186.44547:0.0002%,-211.08346:0.0002%,-205.44247:0.0002%]
[INFO] ** s_port:[1.45442:26.0618%,-0.32151:20.769%,-1.27613:18.314%,-0.23351:17.6128%,-0.33484:17.236%,-71.33197:0.0032%,-1.02014:0.0006%,-0.24151:0.0006%,1.45709:0.0004%,-64.19493:0.0002%,-61.95768:0.0002%,-71.14798:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,10.192739999999999:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%]
[INFO] ** classification:[normal:88.954%,Single Stage Multi Point:11.0452%,Single Stage Single Point:0.0008%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0151 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2189e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0136 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4114e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0119 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8365e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0107 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.7409 - val_tp: 11586.0000 - val_fp: 8414.0000 - val_tn: 71586.0000 - val_fn: 8414.0000 - val_accuracy: 0.8317 - val_precision: 0.5793 - val_recall: 0.5793 - val_auc: 0.7371
[INFO] saving weights to checkpoints/lstm-epoch-1-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.9210 - tp: 41574.0000 - fp: 37658.0000 - tn: 282342.0000 - fn: 38426.0000 - accuracy: 0.8098 - precision: 0.5247 - recall: 0.5197 - auc: 0.6930 - val_loss: 1.6200 - val_tp: 10627.0000 - val_fp: 8405.0000 - val_tn: 71595.0000 - val_fn: 9373.0000 - val_accuracy: 0.8222 - val_precision: 0.5584 - val_recall: 0.5314 - val_auc: 0.8342
[INFO] saving weights to checkpoints/lstm-epoch-1-files-14-15-batch-400000-500000
[33m[INFO] loading file 16-16/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (439690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (439690, 17)

[INFO] analyzing data
[INFO] 439690 rows
[INFO] ** unixtime:1201 (0.27315%)
[INFO] ** orig:[0:99.99886%,2:0.00114%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.99886%,3:0.00114%]
[INFO] ** i/f_dir:[1:99.99886%,0:0.00114%]
[INFO] ** src:[22:38.05363%,9:26.10544%,7:18.25172%,1:17.58762%,21:0.00114%,15:0.00023%,4:0.00023%]
[INFO] ** dst:[21:43.35941%,10:20.79943%,8:18.25127%,9:17.58762%,15:0.00114%,22:0.00091%,24:0.00023%]
[INFO] ** proto:[0:99.99886%,1:0.00114%]
[INFO] ** appi_name:[21:99.99864%,30:0.00114%,33:0.00023%]
[INFO] ** proxy_src_ip:[18:38.05363%,20:26.10544%,13:18.25172%,6:17.58762%,17:0.00114%,21:0.00023%,16:0.00023%]
[INFO] ** modbus_function_code:[0.02961:99.99864%,-33.760870000000004:0.00136%]
[INFO] ** modbus_function_description:[7:50.00045%,11:49.99818%,0:0.00136%]
[INFO] ** modbus_transaction_id:65536 (14.90505%)
[INFO] ** scada_tag:[3:26.1043%,1:20.7992%,5:18.25104%,4:17.58694%,2:17.25443%,0:0.00409%]
[INFO] ** service:[0.0048200000000000005:99.99886%,-211.73542999999998:0.00114%]
[INFO] ** s_port:[1.45442:26.10476%,-0.32151:20.7992%,-1.27613:18.25127%,-0.23351:17.58739%,-0.33484:17.25443%,-71.33197:0.00114%,1.45709:0.00045%,-1.27347:0.00023%,1.47576:0.00023%,-49.275529999999996:0.00023%,-0.24151:0.00023%,-1.02014:0.00023%,-1.2708:0.00023%]
[INFO] ** classification:[normal:84.4188%,Single Stage Multi Point:15.5812%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/439690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0349 - tp: 54280.0000 - fp: 22677.0000 - tn: 297323.0000 - fn: 25720.0000 - accuracy: 0.8790 - precision: 0.7053 - recall: 0.6785 - auc: 0.9039 - val_loss: 0.1784 - val_tp: 19049.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 951.0000 - val_accuracy: 0.9905 - val_precision: 1.0000 - val_recall: 0.9524 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/439690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5930 - tp: 63700.0000 - fp: 11335.0000 - tn: 308665.0000 - fn: 16300.0000 - accuracy: 0.9309 - precision: 0.8489 - recall: 0.7962 - auc: 0.9584 - val_loss: 0.0596 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/439690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0715 - tp: 79997.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0341 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/439690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0530 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0257 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/439690
[33m[INFO] loading file 17-17/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539690, 17)

[INFO] analyzing data
[INFO] 539690 rows
[INFO] ** appi_name:[21:99.99722%,7:0.00056%,26:0.00037%,0:0.00037%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:94.28376%,Multi Stage Multi Point:5.71624%]
[INFO] ** dst:[21:43.34562%,10:20.85123%,8:18.201%,9:17.59918%,22:0.00074%,6:0.00056%,25:0.00037%,16:0.00037%,2:0.00037%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99722%,-33.760870000000004:0.00259%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99963%,11:49.99759%,0:0.00259%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.14327%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9987%,2:0.0013%]
[INFO] ** proxy_src_ip:[18:38.08316%,20:26.11444%,13:18.20045%,6:17.59899%,10:0.00111%,11:0.00093%,1:0.00037%,16:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.11351%,-0.32151:20.85123%,-1.27613:18.20008%,-0.23351:17.59881%,-0.33484:17.23193%,6.0369:0.00074%,-71.14798:0.00037%,1.47576:0.00037%,-64.19493:0.00037%,1.45709:0.00037%,1.46509:0.00019%,-68.79874000000001:0.00019%,-1.27347:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,6.15557:0.00019%,6.06224:0.00019%,8.55414:0.00019%,-3.3787199999999995:0.00019%,-4.3880099999999995:0.00019%,-71.14931:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:26.11332%,1:20.85104%,5:18.19989%,4:17.59844%,2:17.23193%,0:0.00537%]
[INFO] ** service:[0.0048200000000000005:99.99796%,-211.09762999999998:0.00056%,-211.08346:0.00037%,-186.44547:0.00037%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.08316%,9:26.11444%,7:18.20045%,1:17.59899%,11:0.00111%,10:0.00093%,3:0.00037%,21:0.00019%,15:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1475 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1078 - tp: 78782.0000 - fp: 631.0000 - tn: 319369.0000 - fn: 1218.0000 - accuracy: 0.9954 - precision: 0.9921 - recall: 0.9848 - auc: 0.9994 - val_loss: 0.0391 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0441 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0250 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0348 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0190 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3101 - tp: 68607.0000 - fp: 11393.0000 - tn: 308607.0000 - fn: 11393.0000 - accuracy: 0.9430 - precision: 0.8576 - recall: 0.8576 - auc: 0.8916 - val_loss: 1.2898 - val_tp: 16369.0000 - val_fp: 3631.0000 - val_tn: 76369.0000 - val_fn: 3631.0000 - val_accuracy: 0.9274 - val_precision: 0.8184 - val_recall: 0.8184 - val_auc: 0.8413
[INFO] saving weights to checkpoints/lstm-epoch-1-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0050 - tp: 62289.0000 - fp: 14505.0000 - tn: 305495.0000 - fn: 17711.0000 - accuracy: 0.9195 - precision: 0.8111 - recall: 0.7786 - auc: 0.8820 - val_loss: 0.3300 - val_tp: 18648.0000 - val_fp: 1352.0000 - val_tn: 78648.0000 - val_fn: 1352.0000 - val_accuracy: 0.9730 - val_precision: 0.9324 - val_recall: 0.9324 - val_auc: 0.9693
[INFO] saving weights to checkpoints/lstm-epoch-1-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/539690
[33m[INFO] loading file 18-18/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539690, 17)

[INFO] analyzing data
[INFO] 539690 rows
[INFO] ** appi_name:[21:99.99815%,30:0.00056%,7:0.00056%,31:0.00019%,27:0.00019%,22:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:82.02709%,Multi Stage Multi Point:17.97291%]
[INFO] ** dst:[21:43.33692%,10:20.8327%,8:18.26604%,9:17.56138%,22:0.00074%,15:0.00056%,24:0.00037%,16:0.00037%,2:0.00037%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99944%,0:0.00056%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99815%,-33.760870000000004:0.00185%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99815%,0:0.00185%]
[INFO] ** modbus_transaction_id:65536 (12.14327%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99889%,2:0.00056%,1:0.00056%]
[INFO] ** proxy_src_ip:[18:38.07371%,20:26.09646%,13:18.26641%,6:17.56156%,17:0.00056%,11:0.00056%,1:0.00037%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.09572%,-0.32151:20.8327%,-1.27613:18.26586%,-0.23351:17.56119%,-0.33484:17.24101%,-71.33197:0.00056%,-1.27347:0.00037%,1.45709:0.00037%,-0.24151:0.00037%,1.47576:0.00019%,1.46509:0.00019%,3.6236699999999997:0.00019%,-1.2708:0.00019%,-2.48275:0.00019%,6.06224:0.00019%,-3.3787199999999995:0.00019%,8.10082:0.00019%,6.45955:0.00019%,-71.14931:0.00019%]
[INFO] ** scada_tag:[3:26.09535%,1:20.83251%,5:18.26567%,4:17.56101%,2:17.24082%,0:0.00463%]
[INFO] ** service:[0.0048200000000000005:99.99815%,-211.09762999999998:0.00056%,-211.73542999999998:0.00056%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.07371%,9:26.09646%,7:18.26641%,1:17.56156%,14:0.00056%,10:0.00056%,3:0.00037%,21:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1475 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4946 - tp: 70812.0000 - fp: 8162.0000 - tn: 311838.0000 - fn: 9188.0000 - accuracy: 0.9566 - precision: 0.8966 - recall: 0.8852 - auc: 0.9541 - val_loss: 1.3436 - val_tp: 12369.0000 - val_fp: 7631.0000 - val_tn: 72369.0000 - val_fn: 7631.0000 - val_accuracy: 0.8474 - val_precision: 0.6184 - val_recall: 0.6184 - val_auc: 0.8774
[INFO] saving weights to checkpoints/lstm-epoch-1-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8181 - tp: 61352.0000 - fp: 17474.0000 - tn: 302526.0000 - fn: 18648.0000 - accuracy: 0.9097 - precision: 0.7783 - recall: 0.7669 - auc: 0.9241 - val_loss: 0.0570 - val_tp: 19908.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 92.0000 - val_accuracy: 0.9991 - val_precision: 1.0000 - val_recall: 0.9954 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3096 - tp: 72865.0000 - fp: 5793.0000 - tn: 314207.0000 - fn: 7135.0000 - accuracy: 0.9677 - precision: 0.9264 - recall: 0.9108 - auc: 0.9778 - val_loss: 0.0261 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4432 - tp: 73083.0000 - fp: 6539.0000 - tn: 313461.0000 - fn: 6917.0000 - accuracy: 0.9664 - precision: 0.9179 - recall: 0.9135 - auc: 0.9614 - val_loss: 0.0393 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0341 - tp: 79980.0000 - fp: 11.0000 - tn: 319989.0000 - fn: 20.0000 - accuracy: 0.9999 - precision: 0.9999 - recall: 0.9998 - auc: 1.0000 - val_loss: 0.0196 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/539690
[33m[INFO] loading file 19-19/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539690, 17)

[INFO] analyzing data
[INFO] 539690 rows
[INFO] ** appi_name:[21:99.99796%,26:0.00037%,0:0.00037%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:86.74054%,Single Stage Multi Point:13.25946%]
[INFO] ** dst:[21:43.38213%,10:20.82492%,8:18.21879%,9:17.57138%,22:0.0013%,6:0.00056%,25:0.00037%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99796%,-33.760870000000004:0.00185%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99815%,0:0.00185%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.14327%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9987%,2:0.0013%]
[INFO] ** proxy_src_ip:[18:38.11318%,20:26.09405%,13:18.21879%,6:17.57138%,10:0.00111%,11:0.00093%,16:0.00056%]
[INFO] ** s_port:[1.45442:26.09294%,-0.32151:20.82492%,-1.27613:18.21842%,-0.23351:17.5712%,-0.33484:17.28826%,-5.20264:0.00074%,1.45709:0.00056%,-1.02014:0.00056%,-64.19493:0.00037%,-71.14798:0.00037%,1.46509:0.00037%,-1.27347:0.00019%,-0.24151:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-71.14931:0.00019%,-68.79874000000001:0.00019%,0.75578:0.00019%]
[INFO] ** scada_tag:[3:26.09257%,1:20.82473%,5:18.21824%,4:17.57101%,2:17.28807%,0:0.00537%]
[INFO] ** service:[0.0048200000000000005:99.9987%,-211.08346:0.00037%,-186.44547:0.00037%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.11318%,9:26.09405%,7:18.21879%,1:17.57138%,11:0.00111%,10:0.00093%,15:0.00056%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1476 (0.27349%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0250 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0146 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0118 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0163 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0097 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6557 - tp: 69195.0000 - fp: 10648.0000 - tn: 309352.0000 - fn: 10805.0000 - accuracy: 0.9464 - precision: 0.8666 - recall: 0.8649 - auc: 0.9331 - val_loss: 2.1613 - val_tp: 7882.0000 - val_fp: 12118.0000 - val_tn: 67882.0000 - val_fn: 12118.0000 - val_accuracy: 0.7576 - val_precision: 0.3941 - val_recall: 0.3941 - val_auc: 0.8718
[INFO] saving weights to checkpoints/lstm-epoch-1-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2147 - tp: 42885.0000 - fp: 30792.0000 - tn: 289208.0000 - fn: 37115.0000 - accuracy: 0.8302 - precision: 0.5821 - recall: 0.5361 - auc: 0.8563 - val_loss: 1.5583 - val_tp: 10596.0000 - val_fp: 9294.0000 - val_tn: 70706.0000 - val_fn: 9404.0000 - val_accuracy: 0.8130 - val_precision: 0.5327 - val_recall: 0.5298 - val_auc: 0.8215
[INFO] saving weights to checkpoints/lstm-epoch-1-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/539690
[33m[INFO] loading file 20-20/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539690, 17)

[INFO] analyzing data
[INFO] 539690 rows
[INFO] ** appi_name:[21:99.99648%,30:0.00296%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:92.40694%,Single Stage Multi Point:7.59306%]
[INFO] ** dst:[21:43.42697%,10:20.83529%,8:18.16487%,9:17.56786%,15:0.00296%,22:0.00111%,24:0.00037%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99741%,0:0.00259%]
[INFO] ** i/f_name:[2:99.99704%,3:0.00296%]
[INFO] ** modbus_function_code:[0.02961:99.99648%,-33.760870000000004:0.00352%]
[INFO] ** modbus_function_description:[7:49.99944%,11:49.99704%,0:0.00352%]
[INFO] ** modbus_transaction_id:65536 (12.14327%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99648%,1:0.00296%,2:0.00056%]
[INFO] ** proxy_src_ip:[18:38.11373%,20:26.14909%,13:18.16506%,6:17.56842%,17:0.00296%,14:0.00056%,16:0.00019%]
[INFO] ** s_port:[1.45442:26.14834%,-0.32151:20.83529%,-1.27613:18.1645%,-0.23351:17.56768%,-0.33484:17.27844%,-71.33197:0.00296%,-0.24151:0.00056%,1.45709:0.00037%,-1.27347:0.00037%,13.431270000000001:0.00019%,-1.2708:0.00019%,-1.02014:0.00019%,-71.14798:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,11.862:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:26.14797%,1:20.83511%,5:18.1645%,4:17.56731%,2:17.27825%,0:0.00686%]
[INFO] ** service:[0.0048200000000000005:99.99648%,-211.73542999999998:0.00296%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.11373%,9:26.14909%,7:18.16506%,1:17.56842%,14:0.00296%,2:0.00056%,15:0.00019%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1475 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0835 - tp: 78959.0000 - fp: 966.0000 - tn: 319034.0000 - fn: 1041.0000 - accuracy: 0.9950 - precision: 0.9879 - recall: 0.9870 - auc: 0.9972 - val_loss: 0.1453 - val_tp: 19491.0000 - val_fp: 509.0000 - val_tn: 79491.0000 - val_fn: 509.0000 - val_accuracy: 0.9898 - val_precision: 0.9746 - val_recall: 0.9746 - val_auc: 0.9886
[INFO] saving weights to checkpoints/lstm-epoch-1-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5768 - tp: 64989.0000 - fp: 14387.0000 - tn: 305613.0000 - fn: 15011.0000 - accuracy: 0.9265 - precision: 0.8187 - recall: 0.8124 - auc: 0.9572 - val_loss: 0.3211 - val_tp: 16357.0000 - val_fp: 3643.0000 - val_tn: 76357.0000 - val_fn: 3643.0000 - val_accuracy: 0.9271 - val_precision: 0.8178 - val_recall: 0.8178 - val_auc: 0.9841
[INFO] saving weights to checkpoints/lstm-epoch-1-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2646 - tp: 72202.0000 - fp: 7065.0000 - tn: 312935.0000 - fn: 7798.0000 - accuracy: 0.9628 - precision: 0.9109 - recall: 0.9025 - auc: 0.9897 - val_loss: 0.0547 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1914 - tp: 74822.0000 - fp: 5021.0000 - tn: 314979.0000 - fn: 5178.0000 - accuracy: 0.9745 - precision: 0.9371 - recall: 0.9353 - auc: 0.9945 - val_loss: 0.0497 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0263 - tp: 79947.0000 - fp: 50.0000 - tn: 319950.0000 - fn: 53.0000 - accuracy: 0.9997 - precision: 0.9994 - recall: 0.9993 - auc: 1.0000 - val_loss: 0.0207 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/539690
[33m[INFO] loading file 21-21/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539688, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539688, 17)

[INFO] analyzing data
[INFO] 539688 rows
[INFO] ** appi_name:[21:99.99611%,30:0.00093%,7:0.00056%,26:0.00037%,22:0.00037%,0:0.00037%,31:0.00019%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:98.86916%,Multi Stage Single Point:1.13084%]
[INFO] ** dst:[21:43.30539%,10:20.98583%,8:18.17142%,9:17.53272%,22:0.00093%,15:0.00093%,6:0.00074%,24:0.00056%,25:0.00037%,16:0.00037%,2:0.00037%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99907%,0:0.00093%]
[INFO] ** i/f_name:[2:99.99907%,3:0.00093%]
[INFO] ** modbus_function_code:[0.02961:99.99611%,-33.760870000000004:0.00371%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.9987%,11:49.99741%,0:0.00371%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.14331%)
[INFO] ** orig:[0:99.99926%,2:0.00074%]
[INFO] ** proto:[0:99.99759%,2:0.00148%,1:0.00093%]
[INFO] ** proxy_src_ip:[18:38.31288%,20:25.97816%,13:18.1718%,6:17.53272%,10:0.00111%,17:0.00093%,11:0.00093%,16:0.00056%,1:0.00037%,21:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.9776%,-0.32151:20.98509%,-1.27613:18.17124%,-0.23351:17.53254%,-0.33484:17.32779%,-71.33197:0.00093%,-6.64392:0.00074%,-1.27347:0.00056%,-1.02014:0.00056%,-64.19493:0.00037%,-71.14931:0.00037%,-71.14798:0.00037%,1.47576:0.00019%,1.46509:0.00019%,6.62488:0.00019%,10.15141:0.00019%,-68.79874000000001:0.00019%,7.060860000000001:0.00019%,-3.3787199999999995:0.00019%,-2.2440900000000004:0.00019%,1.45709:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.97723%,1:20.9849%,5:18.17105%,4:17.53217%,2:17.32779%,0:0.00686%]
[INFO] ** service:[0.0048200000000000005:99.99685%,-211.73542999999998:0.00093%,-211.09762999999998:0.00056%,-211.08346:0.00037%,-186.44547:0.00037%,-211.08818:0.00037%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.31288%,9:25.97816%,7:18.1718%,1:17.53272%,11:0.00111%,21:0.00093%,10:0.00093%,15:0.00056%,3:0.00037%,14:0.00019%,4:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1470 (0.27238%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539688
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79942.0000 - fp: 51.0000 - tn: 319949.0000 - fn: 58.0000 - accuracy: 0.9997 - precision: 0.9994 - recall: 0.9993 - auc: 1.0000 - val_loss: 0.0171 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/539688
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0160 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0144 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/539688
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0137 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0125 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/539688
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0119 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0109 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/539688
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0104 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0096 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/539688
[33m[INFO] loading file 22-22/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (308729, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (308729, 17)

[INFO] analyzing data
[INFO] 308729 rows
[INFO] ** appi_name:[21:99.99223%,30:0.0068%,23:0.00032%,22:0.00032%,18:0.00032%]
[INFO] ** classification:[normal:57.06526%,Multi Stage Single Point:42.93474%]
[INFO] ** dst:[21:43.30108%,10:21.00386%,8:18.11394%,9:17.57205%,15:0.0068%,22:0.0013%,19:0.00065%,26:0.00032%]
[INFO] ** i/f_dir:[1:99.99352%,0:0.00648%]
[INFO] ** i/f_name:[2:99.9932%,3:0.00648%,0:0.00032%]
[INFO] ** modbus_function_code:[0.02961:99.99223%,-33.760870000000004:0.00777%]
[INFO] ** modbus_function_description:[7:49.99725%,11:49.99498%,0:0.00777%]
[INFO] ** modbus_transaction_id:65534 (21.22703%)
[INFO] ** orig:[0:99.99482%,2:0.00453%,1:0.00065%]
[INFO] ** proto:[0:99.99287%,1:0.0068%,2:0.00032%]
[INFO] ** proxy_src_ip:[18:38.32682%,20:25.97909%,13:18.1133%,6:17.57302%,17:0.0068%,14:0.00065%,10:0.00032%]
[INFO] ** s_port:[1.45442:25.97812%,-0.32151:21.00386%,-1.27613:18.1133%,-0.23351:17.57205%,-0.33484:17.32296%,-71.33197:0.0068%,1.45709:0.00065%,-0.24151:0.00065%,7.228860000000001:0.00065%,-0.24950999999999998:0.00032%,1.46509:0.00032%,-71.14931:0.00032%]
[INFO] ** scada_tag:[3:25.9778%,1:21.00386%,5:18.1133%,4:17.57172%,2:17.32296%,0:0.01037%]
[INFO] ** service:[0.0048200000000000005:99.99223%,-211.73542999999998:0.0068%,-211.07873999999998:0.00065%,-211.08818:0.00032%]
[INFO] ** src:[22:38.32682%,9:25.97909%,7:18.1133%,1:17.57302%,21:0.00453%,14:0.00227%,2:0.00065%,11:0.00032%]
[INFO] ** type:[0:99.99806%,1:0.00194%]
[INFO] ** unixtime:853 (0.27629%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/308729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.4759 - tp: 53221.0000 - fp: 23860.0000 - tn: 296140.0000 - fn: 26779.0000 - accuracy: 0.8734 - precision: 0.6905 - recall: 0.6653 - auc: 0.7862 - val_loss: 1.2211 - val_tp: 10612.0000 - val_fp: 9388.0000 - val_tn: 70612.0000 - val_fn: 9388.0000 - val_accuracy: 0.8122 - val_precision: 0.5306 - val_recall: 0.5306 - val_auc: 0.9319
[INFO] saving weights to checkpoints/lstm-epoch-1-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/308729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.9980 - tp: 61363.0000 - fp: 16104.0000 - tn: 303896.0000 - fn: 18637.0000 - accuracy: 0.9131 - precision: 0.7921 - recall: 0.7670 - auc: 0.9152 - val_loss: 0.0411 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/308729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5495 - tp: 69288.0000 - fp: 9833.0000 - tn: 310167.0000 - fn: 10712.0000 - accuracy: 0.9486 - precision: 0.8757 - recall: 0.8661 - auc: 0.9633 - val_loss: 0.0132 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/308729
[33m[INFO] loading file 23-23/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (508729, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (508729, 17)

[INFO] analyzing data
[INFO] 508729 rows
[INFO] ** appi_name:[21:99.99902%,31:0.00039%,33:0.0002%,30:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:97.42024%,Multi Stage Single Point:2.57976%]
[INFO] ** dst:[21:43.3384%,10:20.99821%,8:18.13618%,9:17.52505%,22:0.00098%,24:0.00039%,18:0.00039%,25:0.0002%,15:0.0002%]
[INFO] ** i/f_dir:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name:[2:99.9998%,3:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.99902%,-33.760870000000004:0.00098%]
[INFO] ** modbus_function_description:[7:50.00049%,11:49.99853%,0:0.00098%]
[INFO] ** modbus_transaction_id:65536 (12.8823%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99921%,2:0.00059%,1:0.0002%]
[INFO] ** proxy_src_ip:[18:38.34596%,20:25.99085%,13:18.13638%,6:17.52524%,16:0.00059%,21:0.0002%,17:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.99026%,-0.32151:20.99802%,-1.27613:18.13579%,-0.23351:17.52485%,-0.33484:17.34794%,-1.02014:0.00059%,-0.08551:0.00039%,-1.27347:0.00039%,1.47576:0.0002%,-49.275529999999996:0.0002%,1.46509:0.0002%,-0.24151:0.0002%,-0.24950999999999998:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%,1.45709:0.0002%,-71.33197:0.0002%]
[INFO] ** scada_tag:[3:25.98987%,1:20.99802%,5:18.13559%,4:17.52465%,2:17.34774%,0:0.00413%]
[INFO] ** service:[0.0048200000000000005:99.99921%,-186.43601999999998:0.00039%,-186.44547:0.0002%,-211.73542999999998:0.0002%]
[INFO] ** src:[22:38.34596%,9:25.99085%,7:18.13638%,1:17.52524%,15:0.00059%,17:0.0002%,14:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1383 (0.27185%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7965 - tp: 65904.0000 - fp: 13423.0000 - tn: 306577.0000 - fn: 14096.0000 - accuracy: 0.9312 - precision: 0.8308 - recall: 0.8238 - auc: 0.9377 - val_loss: 0.0713 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0176 - tp: 79894.0000 - fp: 99.0000 - tn: 319901.0000 - fn: 106.0000 - accuracy: 0.9995 - precision: 0.9988 - recall: 0.9987 - auc: 0.9999 - val_loss: 0.0125 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0120 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0109 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0106 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0096 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0093 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0083 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/508729
[33m[INFO] loading file 24-24/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (508729, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (508729, 17)

[INFO] analyzing data
[INFO] 508729 rows
[INFO] ** appi_name:[21:99.99273%,30:0.00354%,26:0.00059%,31:0.00039%,27:0.00039%,22:0.00039%,0:0.00039%,24:0.0002%,23:0.0002%,19:0.0002%,18:0.0002%,16:0.0002%,15:0.0002%,11:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:94.99144%,Multi Stage Single Point:5.00856%]
[INFO] ** dst:[21:43.36081%,10:21.0334%,8:18.09451%,9:17.50382%,15:0.00354%,22:0.00118%,6:0.00079%,25:0.00039%,19:0.00039%,18:0.00039%,7:0.00039%,26:0.0002%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.99666%,0:0.00334%]
[INFO] ** i/f_name:[2:99.99646%,3:0.00354%]
[INFO] ** modbus_function_code:[0.02961:99.99273%,-33.760870000000004:0.00668%,0.47422:0.0002%,-0.415:0.0002%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.99735%,11:49.99538%,0:0.00668%,15:0.0002%,10:0.0002%,2:0.0002%]
[INFO] ** modbus_transaction_id:65536 (12.8823%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.9943%,1:0.00354%,2:0.00216%]
[INFO] ** proxy_src_ip:[18:38.41888%,20:25.97611%,13:18.09431%,6:17.50303%,17:0.00354%,10:0.00138%,14:0.00098%,11:0.00098%,21:0.00039%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.97532%,-0.32151:21.0334%,-1.27613:18.09411%,-0.23351:17.50244%,-0.33484:17.38548%,-71.33197:0.00354%,-9.58113:0.00079%,-71.14798:0.00059%,7.6315100000000005:0.00039%,-64.19493:0.00039%,-1.02014:0.00039%,-71.14931:0.00039%,-0.24151:0.00039%,1.45709:0.00039%,-31.55091:0.00039%,7.4901800000000005:0.0002%,-1.27347:0.0002%,1.47576:0.0002%,1.46509:0.0002%,13.431270000000001:0.0002%,-68.79874000000001:0.0002%,-0.24950999999999998:0.0002%,11.862:0.0002%]
[INFO] ** scada_tag:[3:25.97513%,1:21.0334%,5:18.09392%,4:17.50205%,2:17.38529%,0:0.01022%]
[INFO] ** service:[0.0048200000000000005:99.99391%,-211.73542999999998:0.00354%,-211.08346:0.00059%,-186.44547:0.00039%,-186.43601999999998:0.00039%,-211.07873999999998:0.00039%,-211.08818:0.00039%,-202.75898:0.00039%]
[INFO] ** src:[22:38.41888%,9:25.97611%,7:18.09431%,1:17.50303%,14:0.00354%,11:0.00138%,10:0.00098%,2:0.00098%,15:0.00039%,4:0.00039%]
[INFO] ** type:[0:99.99862%,1:0.00098%,2:0.00039%]
[INFO] ** unixtime:1382 (0.27166%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0186 - tp: 79765.0000 - fp: 232.0000 - tn: 319768.0000 - fn: 235.0000 - accuracy: 0.9988 - precision: 0.9971 - recall: 0.9971 - auc: 0.9996 - val_loss: 0.0069 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0070 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0061 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0062 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0054 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0056 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0047 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7153 - tp: 65255.0000 - fp: 14392.0000 - tn: 305608.0000 - fn: 14745.0000 - accuracy: 0.9272 - precision: 0.8193 - recall: 0.8157 - auc: 0.9515 - val_loss: 0.4764 - val_tp: 13005.0000 - val_fp: 6980.0000 - val_tn: 73020.0000 - val_fn: 6995.0000 - val_accuracy: 0.8602 - val_precision: 0.6507 - val_recall: 0.6503 - val_auc: 0.9685
[INFO] saving weights to checkpoints/lstm-epoch-1-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/508729
[33m[INFO] loading file 25-25/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (508729, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (508729, 17)

[INFO] analyzing data
[INFO] 508729 rows
[INFO] ** appi_name:[21:99.99627%,30:0.00098%,17:0.00079%,22:0.00059%,31:0.00039%,28:0.0002%,26:0.0002%,12:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** classification:[normal:64.33661%,Multi Stage Single Point:35.66339%]
[INFO] ** dst:[21:43.31029%,10:21.022%,8:18.1521%,9:17.51109%,22:0.00098%,15:0.00098%,16:0.00079%,6:0.00079%,18:0.00039%,17:0.00039%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.99902%,0:0.00098%]
[INFO] ** i/f_name:[2:99.99902%,3:0.00098%]
[INFO] ** modbus_function_code:[0.02961:99.99627%,-33.760870000000004:0.00373%]
[INFO] ** modbus_function_description:[7:49.99892%,11:49.99735%,0:0.00373%]
[INFO] ** modbus_transaction_id:65536 (12.8823%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99784%,2:0.00118%,1:0.00098%]
[INFO] ** proxy_src_ip:[18:38.38154%,20:25.95036%,13:18.1523%,6:17.51168%,17:0.00098%,1:0.00098%,21:0.00079%,16:0.00039%,14:0.00039%,7:0.00039%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.95016%,-0.32151:21.0216%,-1.27613:18.1519%,-0.23351:17.51109%,-0.33484:17.35993%,-71.33197:0.00098%,-71.14931:0.00059%,-1.02014:0.00039%,-0.24151:0.00039%,-49.275529999999996:0.00039%,-71.14798:0.0002%,-58.035180000000004:0.0002%,-1.2708:0.0002%,-5.1466400000000005:0.0002%,-5.08665:0.0002%,-1.27347:0.0002%,-0.24950999999999998:0.0002%,1.45709:0.0002%,6.1115699999999995:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,2.52505:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:25.94977%,1:21.02141%,5:18.15171%,4:17.51089%,2:17.35973%,0:0.00649%]
[INFO] ** service:[0.0048200000000000005:99.99666%,-211.73542999999998:0.00098%,-205.44247:0.00079%,-211.08818:0.00059%,-186.43601999999998:0.00039%,-211.09762999999998:0.0002%,-211.08346:0.0002%,-185.9872:0.0002%]
[INFO] ** src:[22:38.38154%,9:25.95036%,7:18.1523%,1:17.51168%,14:0.00098%,3:0.00098%,4:0.00079%,21:0.00039%,15:0.00039%,2:0.00039%,8:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1382 (0.27166%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4118 - tp: 71192.0000 - fp: 7927.0000 - tn: 312073.0000 - fn: 8808.0000 - accuracy: 0.9582 - precision: 0.8998 - recall: 0.8899 - auc: 0.9769 - val_loss: 0.0087 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2153 - tp: 74575.0000 - fp: 3602.0000 - tn: 316398.0000 - fn: 5425.0000 - accuracy: 0.9774 - precision: 0.9539 - recall: 0.9322 - auc: 0.9899 - val_loss: 0.0091 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1692 - tp: 76559.0000 - fp: 3001.0000 - tn: 316999.0000 - fn: 3441.0000 - accuracy: 0.9839 - precision: 0.9623 - recall: 0.9570 - auc: 0.9909 - val_loss: 0.0094 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1380 - tp: 76999.0000 - fp: 2885.0000 - tn: 317115.0000 - fn: 3001.0000 - accuracy: 0.9853 - precision: 0.9639 - recall: 0.9625 - auc: 0.9914 - val_loss: 0.0090 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1152 - tp: 77360.0000 - fp: 2433.0000 - tn: 317567.0000 - fn: 2640.0000 - accuracy: 0.9873 - precision: 0.9695 - recall: 0.9670 - auc: 0.9921 - val_loss: 0.0097 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/508729
[33m[INFO] loading file 26-26/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (508729, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (508729, 17)

[INFO] analyzing data
[INFO] 508729 rows
[INFO] ** appi_name:[21:99.99882%,7:0.00059%,30:0.0002%,22:0.0002%,8:0.0002%]
[INFO] ** classification:[normal:64.39696%,Single Stage Single Point:31.39432%,Multi Stage Single Point:4.20872%]
[INFO] ** dst:[21:43.31068%,10:21.08431%,8:18.12026%,9:17.48239%,22:0.00079%,24:0.00039%,16:0.00039%,2:0.00039%,15:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name:[2:99.9998%,3:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.99882%,-33.760870000000004:0.00118%]
[INFO] ** modbus_function_description:[7:50.0001%,11:49.99872%,0:0.00118%]
[INFO] ** modbus_transaction_id:65536 (12.8823%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99961%,2:0.0002%,1:0.0002%]
[INFO] ** proxy_src_ip:[18:38.4692%,20:25.92618%,13:18.12065%,6:17.48239%,16:0.00039%,1:0.00039%,21:0.0002%,17:0.0002%,14:0.0002%,7:0.0002%]
[INFO] ** s_port:[1.45442:25.92559%,-0.32151:21.08431%,-1.27613:18.12006%,-0.23351:17.4822%,-0.33484:17.38489%,-1.27347:0.00039%,-1.02014:0.00039%,7.66617:0.0002%,-1.2708:0.0002%,-71.14931:0.0002%,-0.24151:0.0002%,11.57001:0.0002%,1.47576:0.0002%,1.46509:0.0002%,14.191239999999999:0.0002%,-3.3787199999999995:0.0002%,1.45709:0.0002%,-71.33197:0.0002%]
[INFO] ** scada_tag:[3:25.9252%,1:21.08431%,5:18.12006%,4:17.482%,2:17.38489%,0:0.00354%]
[INFO] ** service:[0.0048200000000000005:99.99882%,-211.09762999999998:0.00059%,-211.73542999999998:0.0002%,-211.35747999999998:0.0002%,-211.08818:0.0002%]
[INFO] ** src:[22:38.4692%,9:25.92618%,7:18.12065%,1:17.48239%,15:0.00039%,3:0.00039%,21:0.0002%,14:0.0002%,4:0.0002%,2:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1381 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.9568 - tp: 69720.0000 - fp: 9466.0000 - tn: 310534.0000 - fn: 10280.0000 - accuracy: 0.9506 - precision: 0.8805 - recall: 0.8715 - auc: 0.9344 - val_loss: 1.3350 - val_tp: 12898.0000 - val_fp: 7096.0000 - val_tn: 72904.0000 - val_fn: 7102.0000 - val_accuracy: 0.8580 - val_precision: 0.6451 - val_recall: 0.6449 - val_auc: 0.9346
[INFO] saving weights to checkpoints/lstm-epoch-1-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5697 - tp: 64178.0000 - fp: 14641.0000 - tn: 305359.0000 - fn: 15822.0000 - accuracy: 0.9238 - precision: 0.8142 - recall: 0.8022 - auc: 0.9580 - val_loss: 0.0559 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2489 - tp: 74576.0000 - fp: 5086.0000 - tn: 314914.0000 - fn: 5424.0000 - accuracy: 0.9737 - precision: 0.9362 - recall: 0.9322 - auc: 0.9835 - val_loss: 0.0433 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1847 - tp: 76405.0000 - fp: 3595.0000 - tn: 316405.0000 - fn: 3595.0000 - accuracy: 0.9820 - precision: 0.9551 - recall: 0.9551 - auc: 0.9909 - val_loss: 0.0433 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1433 - tp: 76598.0000 - fp: 3402.0000 - tn: 316598.0000 - fn: 3402.0000 - accuracy: 0.9830 - precision: 0.9575 - recall: 0.9575 - auc: 0.9961 - val_loss: 0.0428 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/508729
[33m[INFO] loading file 27-27/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (448859, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (448859, 17)

[INFO] analyzing data
[INFO] 448859 rows
[INFO] ** appi_name:[21:99.99933%,30:0.00067%]
[INFO] ** classification:[normal:64.33735%,Single Stage Single Point:35.66265%]
[INFO] ** dst:[21:43.2715%,10:21.06385%,8:18.1948%,9:17.46807%,22:0.00089%,15:0.00067%,24:0.00022%]
[INFO] ** i/f_dir:[1:99.99978%,0:0.00022%]
[INFO] ** i/f_name:[2:99.99933%,3:0.00067%]
[INFO] ** modbus_function_code:[0.02961:99.99933%,-33.760870000000004:0.00067%]
[INFO] ** modbus_function_description:[7:50.00033%,11:49.999%,0:0.00067%]
[INFO] ** modbus_transaction_id:65536 (14.60058%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99933%,1:0.00067%]
[INFO] ** proxy_src_ip:[18:38.40493%,20:25.93108%,13:18.19458%,6:17.46829%,17:0.00067%,16:0.00045%]
[INFO] ** s_port:[1.45442:25.93041%,-0.32151:21.06385%,-1.27613:18.19436%,-0.23351:17.46785%,-0.33484:17.34108%,-71.33197:0.00067%,-1.02014:0.00045%,-1.27347:0.00022%,1.45709:0.00022%,-0.24950999999999998:0.00022%,1.46509:0.00022%,1.47576:0.00022%,-0.24151:0.00022%]
[INFO] ** scada_tag:[3:25.92997%,1:21.06363%,5:18.19413%,4:17.46762%,2:17.34086%,0:0.00379%]
[INFO] ** service:[0.0048200000000000005:99.99933%,-211.73542999999998:0.00067%]
[INFO] ** src:[22:38.40493%,9:25.93108%,7:18.19458%,1:17.46829%,14:0.00067%,15:0.00045%]
[INFO] ** type:[0:99.99955%,1:0.00045%]
[INFO] ** unixtime:1220 (0.2718%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/448859
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1294 - tp: 76970.0000 - fp: 2989.0000 - tn: 317011.0000 - fn: 3030.0000 - accuracy: 0.9850 - precision: 0.9626 - recall: 0.9621 - auc: 0.9961 - val_loss: 0.0417 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/448859
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1040 - tp: 77735.0000 - fp: 2264.0000 - tn: 317736.0000 - fn: 2265.0000 - accuracy: 0.9887 - precision: 0.9717 - recall: 0.9717 - auc: 0.9969 - val_loss: 0.0383 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/448859
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0914 - tp: 78103.0000 - fp: 1895.0000 - tn: 318105.0000 - fn: 1897.0000 - accuracy: 0.9905 - precision: 0.9763 - recall: 0.9763 - auc: 0.9973 - val_loss: 0.0339 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/448859
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0838 - tp: 78700.0000 - fp: 1294.0000 - tn: 318706.0000 - fn: 1300.0000 - accuracy: 0.9935 - precision: 0.9838 - recall: 0.9837 - auc: 0.9975 - val_loss: 0.0307 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/448859
[33m[INFO] loading file 28-28/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (382775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (382775, 17)

[INFO] analyzing data
[INFO] 382775 rows
[INFO] ** appi_name:[21:99.99216%,30:0.00183%,17:0.00131%,22:0.00105%,7:0.00105%,31:0.00078%,26:0.00078%,28:0.00026%,27:0.00026%,8:0.00026%,0:0.00026%]
[INFO] ** classification:[normal:64.3088%,Single Stage Single Point:35.6912%]
[INFO] ** dst:[21:43.28235%,10:21.01835%,8:18.2073%,9:17.48364%,6:0.00209%,16:0.00183%,18:0.00131%,15:0.00078%,22:0.00052%,17:0.00052%,2:0.00052%,25:0.00026%,7:0.00026%,0:0.00026%]
[INFO] ** i/f_dir:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name:[2:99.99922%,3:0.00078%]
[INFO] ** modbus_function_code:[0.02961:99.99216%,-33.760870000000004:0.00784%]
[INFO] ** modbus_function_description:[11:49.99621%,7:49.99595%,0:0.00784%]
[INFO] ** modbus_transaction_id:65536 (17.12129%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9953%,2:0.00392%,1:0.00078%]
[INFO] ** proxy_src_ip:[18:38.3361%,20:25.9646%,13:18.20756%,6:17.4839%,1:0.00209%,17:0.00183%,14:0.00157%,7:0.00131%,21:0.00078%,0:0.00026%]
[INFO] ** s_port:[1.45442:25.96434%,-0.32151:21.01835%,-1.27613:18.2073%,-0.23351:17.48338%,-0.33484:17.31775%,-71.14798:0.00105%,-71.14931:0.00105%,-71.33197:0.00078%,-0.08551:0.00052%,-0.24151:0.00052%,7.66617:0.00026%,-58.035180000000004:0.00026%,-1.2708:0.00026%,-64.19493:0.00026%,-5.1466400000000005:0.00026%,13.431270000000001:0.00026%,11.57001:0.00026%,14.4699:0.00026%,1.47576:0.00026%,14.191239999999999:0.00026%,-5.08665:0.00026%,10.192739999999999:0.00026%,-3.3787199999999995:0.00026%,6.1115699999999995:0.00026%,2.05573:0.00026%,-43.76509:0.00026%,2.52505:0.00026%,11.862:0.00026%,-58.032509999999995:0.00026%]
[INFO] ** scada_tag:[3:25.96408%,1:21.01835%,5:18.2073%,4:17.48312%,2:17.31775%,0:0.00941%]
[INFO] ** service:[0.0048200000000000005:99.99216%,-205.44247:0.00131%,-186.43601999999998:0.00131%,-211.09762999999998:0.00105%,-211.08346:0.00105%,-211.08818:0.00105%,-211.73542999999998:0.00078%,-186.44547:0.00026%,-183.8612:0.00026%,-185.9872:0.00026%,-211.35747999999998:0.00026%,-202.75898:0.00026%]
[INFO] ** src:[22:38.3361%,9:25.9646%,7:18.20756%,1:17.4839%,3:0.00235%,2:0.00157%,21:0.00131%,4:0.00105%,14:0.00078%,8:0.00052%,17:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1040 (0.2717%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/382775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0819 - tp: 78830.0000 - fp: 1170.0000 - tn: 318830.0000 - fn: 1170.0000 - accuracy: 0.9941 - precision: 0.9854 - recall: 0.9854 - auc: 0.9971 - val_loss: 0.0281 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/382775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0769 - tp: 78931.0000 - fp: 1067.0000 - tn: 318933.0000 - fn: 1069.0000 - accuracy: 0.9947 - precision: 0.9867 - recall: 0.9866 - auc: 0.9976 - val_loss: 0.0268 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-1-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/382775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0735 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9977 - val_loss: 0.0234 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/382775
[33m[INFO] loading file 29-29/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582775, 17)

[INFO] analyzing data
[INFO] 582775 rows
[INFO] ** appi_name:[21:99.9988%,30:0.00051%,31:0.00017%,26:0.00017%,9:0.00017%,3:0.00017%]
[INFO] ** classification:[normal:64.38746%,Single Stage Single Point:35.61254%]
[INFO] ** dst:[21:43.32427%,10:21.06182%,8:18.14422%,9:17.46798%,22:0.00051%,15:0.00051%,24:0.00017%,18:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99949%,3:0.00051%]
[INFO] ** modbus_function_code:[0.02961:99.9988%,-33.760870000000004:0.0012%]
[INFO] ** modbus_function_description:[7:49.99974%,11:49.99906%,0:0.0012%]
[INFO] ** modbus_transaction_id:65536 (11.24551%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99914%,1:0.00051%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.43542%,20:25.95084%,13:18.14457%,6:17.4678%,17:0.00051%,21:0.00017%,16:0.00017%,7:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95032%,-0.32151:21.06164%,-1.27613:18.14422%,-0.23351:17.4678%,-0.33484:17.37377%,-71.33197:0.00051%,1.45709:0.00034%,-71.14798:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,6.1115699999999995:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:25.94998%,1:21.06147%,5:18.14422%,4:17.46746%,2:17.37377%,0:0.00309%]
[INFO] ** service:[0.0048200000000000005:99.99897%,-211.73542999999998:0.00051%,-183.8612:0.00017%,-211.08346:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.43542%,9:25.95084%,7:18.14457%,1:17.4678%,14:0.00051%,21:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1583 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0694 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9976 - val_loss: 0.0216 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0660 - tp: 79152.0000 - fp: 848.0000 - tn: 319152.0000 - fn: 848.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9979 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0681 - tp: 79070.0000 - fp: 930.0000 - tn: 319070.0000 - fn: 930.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9976 - val_loss: 0.0190 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0636 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9979 - val_loss: 0.0176 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0648 - tp: 79085.0000 - fp: 915.0000 - tn: 319085.0000 - fn: 915.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9977 - val_loss: 0.0174 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/582775
[33m[INFO] loading file 30-30/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582775, 17)

[INFO] analyzing data
[INFO] 582775 rows
[INFO] ** appi_name:[21:99.9976%,30:0.00172%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.37459%,Single Stage Single Point:35.62541%]
[INFO] ** dst:[21:43.34143%,10:21.03024%,8:18.14525%,9:17.47982%,15:0.00172%,22:0.00069%,24:0.00034%,25:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99846%,0:0.00154%]
[INFO] ** i/f_name:[2:99.99828%,3:0.00172%]
[INFO] ** modbus_function_code:[0.02961:99.9976%,-33.760870000000004:0.0024%]
[INFO] ** modbus_function_description:[7:49.99957%,11:49.99803%,0:0.0024%]
[INFO] ** modbus_transaction_id:65536 (11.24551%)
[INFO] ** orig:[0:99.99914%,2:0.00051%,1:0.00034%]
[INFO] ** proto:[0:99.99794%,1:0.00172%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.37673%,20:25.99477%,13:18.1456%,6:17.48033%,17:0.00172%,7:0.00034%,16:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.99459%,-0.32151:21.03007%,-1.27613:18.14508%,-0.23351:17.47964%,-0.33484:17.34666%,-71.33197:0.00172%,-0.24151:0.00051%,-1.27347:0.00034%,-71.14798:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:25.99425%,1:21.03007%,5:18.14491%,4:17.47947%,2:17.34649%,0:0.0048%]
[INFO] ** service:[0.0048200000000000005:99.99777%,-211.73542999999998:0.00172%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.37673%,9:25.99477%,7:18.1456%,1:17.48033%,14:0.0012%,21:0.00086%,16:0.00017%,15:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99914%,1:0.00086%]
[INFO] ** unixtime:1584 (0.2718%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0620 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9977 - val_loss: 0.0168 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0625 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9979 - val_loss: 0.0154 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0626 - tp: 79080.0000 - fp: 920.0000 - tn: 319080.0000 - fn: 920.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9979 - val_loss: 0.0150 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0611 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9979 - val_loss: 0.0145 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0608 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9979 - val_loss: 0.0142 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/582775
[33m[INFO] loading file 31-31/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582775, 17)

[INFO] analyzing data
[INFO] 582775 rows
[INFO] ** appi_name:[21:99.99966%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.3775%,Single Stage Single Point:35.6225%]
[INFO] ** dst:[21:43.32513%,10:21.05083%,8:18.12072%,9:17.50161%,22:0.00103%,24:0.00034%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99966%,-33.760870000000004:0.00034%]
[INFO] ** modbus_function_description:[7:50.00026%,11:49.9994%,0:0.00034%]
[INFO] ** modbus_transaction_id:65536 (11.24551%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.39835%,20:25.97829%,13:18.12089%,6:17.50161%,16:0.00051%,7:0.00034%]
[INFO] ** s_port:[1.45442:25.97761%,-0.32151:21.05083%,-1.27613:18.12054%,-0.23351:17.50144%,-0.33484:17.34752%,-1.02014:0.00051%,-1.27347:0.00034%,1.45709:0.00034%,-71.14798:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.97726%,1:21.05066%,5:18.12037%,4:17.50109%,2:17.34735%,0:0.00326%]
[INFO] ** service:[0.0048200000000000005:99.99966%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.39835%,9:25.97829%,7:18.12089%,1:17.50161%,15:0.00051%,21:0.00034%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1583 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0606 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9976 - val_loss: 0.0139 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0592 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9978 - val_loss: 0.0134 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0604 - tp: 79079.0000 - fp: 921.0000 - tn: 319079.0000 - fn: 921.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9979 - val_loss: 0.0132 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0581 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9980 - val_loss: 0.0128 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0593 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9980 - val_loss: 0.0127 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/582775
[33m[INFO] loading file 32-32/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582775, 17)

[INFO] analyzing data
[INFO] 582775 rows
[INFO] ** appi_name:[21:99.99657%,30:0.00292%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.38214%,Single Stage Single Point:35.61786%]
[INFO] ** dst:[21:43.32187%,10:21.05581%,8:18.15349%,9:17.46437%,15:0.00292%,22:0.00086%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99743%,0:0.00257%]
[INFO] ** i/f_name:[2:99.99708%,3:0.00292%]
[INFO] ** modbus_function_code:[0.02961:99.99657%,-33.760870000000004:0.00343%]
[INFO] ** modbus_function_description:[7:49.99923%,11:49.99734%,0:0.00343%]
[INFO] ** modbus_transaction_id:65536 (11.24551%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99657%,1:0.00292%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.42306%,20:25.95496%,13:18.15349%,6:17.46489%,17:0.00292%,14:0.00051%,16:0.00017%]
[INFO] ** s_port:[1.45442:25.95444%,-0.32151:21.05581%,-1.27613:18.15315%,-0.23351:17.4642%,-0.33484:17.36725%,-71.33197:0.00292%,-0.24151:0.00051%,-1.2708:0.00017%,-1.02014:0.00017%,13.431270000000001:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.9541%,1:21.05564%,5:18.15315%,4:17.46386%,2:17.36725%,0:0.00601%]
[INFO] ** service:[0.0048200000000000005:99.99657%,-211.73542999999998:0.00292%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.42306%,9:25.95496%,7:18.15349%,1:17.46489%,14:0.00292%,2:0.00051%,15:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1581 (0.27129%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0572 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9981 - val_loss: 0.0123 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0586 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9981 - val_loss: 0.0125 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0555 - tp: 79153.0000 - fp: 847.0000 - tn: 319153.0000 - fn: 847.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9982 - val_loss: 0.0117 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0561 - tp: 79142.0000 - fp: 858.0000 - tn: 319142.0000 - fn: 858.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9982 - val_loss: 0.0148 - val_tp: 19996.0000 - val_fp: 4.0000 - val_tn: 79996.0000 - val_fn: 4.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 0.9998
[INFO] saving weights to checkpoints/lstm-epoch-1-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0555 - tp: 79151.0000 - fp: 849.0000 - tn: 319151.0000 - fn: 849.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9982 - val_loss: 0.0114 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/582775
[33m[INFO] loading file 33-33/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582775, 17)

[INFO] analyzing data
[INFO] 582775 rows
[INFO] ** appi_name:[21:99.99708%,30:0.00103%,17:0.00069%,22:0.00051%,31:0.00017%,28:0.00017%,26:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.39552%,Single Stage Single Point:35.60448%]
[INFO] ** dst:[21:43.32736%,10:21.06353%,8:18.1226%,9:17.48188%,22:0.00137%,15:0.00103%,16:0.00069%,6:0.00069%,24:0.00034%,17:0.00034%,18:0.00017%]
[INFO] ** i/f_dir:[1:99.99897%,0:0.00103%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99708%,-33.760870000000004:0.00292%]
[INFO] ** modbus_function_description:[7:49.99974%,11:49.99734%,0:0.00292%]
[INFO] ** modbus_transaction_id:65536 (11.24551%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99811%,1:0.00103%,2:0.00086%]
[INFO] ** proxy_src_ip:[18:38.42375%,20:25.968%,13:18.1226%,6:17.48205%,17:0.00103%,16:0.00069%,1:0.00069%,21:0.00034%,14:0.00034%,7:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.96714%,-0.32151:21.06353%,-1.27613:18.12226%,-0.23351:17.4817%,-0.33484:17.36022%,-71.33197:0.00103%,-1.02014:0.00069%,1.45709:0.00051%,-71.14931:0.00051%,-1.27347:0.00034%,-5.08665:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,-71.14798:0.00017%,-58.032509999999995:0.00017%,-58.035180000000004:0.00017%,-0.24151:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.9668%,1:21.06353%,5:18.12209%,4:17.48153%,2:17.36022%,0:0.00583%]
[INFO] ** service:[0.0048200000000000005:99.99708%,-211.73542999999998:0.00103%,-205.44247:0.00069%,-211.08818:0.00051%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.42375%,9:25.968%,7:18.1226%,1:17.48205%,14:0.00103%,15:0.00069%,3:0.00069%,21:0.00034%,4:0.00034%,2:0.00034%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1585 (0.27197%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0585 - tp: 79088.0000 - fp: 912.0000 - tn: 319088.0000 - fn: 912.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9981 - val_loss: 0.0117 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0579 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9981 - val_loss: 0.0117 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0586 - tp: 79080.0000 - fp: 920.0000 - tn: 319080.0000 - fn: 920.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9981 - val_loss: 0.0118 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0557 - tp: 79142.0000 - fp: 858.0000 - tn: 319142.0000 - fn: 858.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9982 - val_loss: 0.0131 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-1-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0591 - tp: 79078.0000 - fp: 922.0000 - tn: 319078.0000 - fn: 922.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9980 - val_loss: 0.0116 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/582775
[33m[INFO] loading file 34-34/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (424208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (424208, 17)

[INFO] analyzing data
[INFO] 424208 rows
[INFO] ** appi_name:[21:99.99764%,30:0.00071%,7:0.00071%,31:0.00024%,22:0.00024%,8:0.00024%,6:0.00024%]
[INFO] ** classification:[normal:64.34509%,Single Stage Single Point:35.65491%]
[INFO] ** dst:[21:43.28513%,10:21.05689%,8:18.18825%,9:17.4669%,22:0.00071%,15:0.00071%,16:0.00047%,2:0.00047%,18:0.00024%,6:0.00024%]
[INFO] ** i/f_dir:[1:99.99929%,0:0.00071%]
[INFO] ** i/f_name:[2:99.99929%,3:0.00071%]
[INFO] ** modbus_function_code:[0.02961:99.99764%,-33.760870000000004:0.00236%]
[INFO] ** modbus_function_description:[7:49.99929%,11:49.99835%,0:0.00236%]
[INFO] ** modbus_transaction_id:65536 (15.44903%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99882%,1:0.00071%,2:0.00047%]
[INFO] ** proxy_src_ip:[18:38.39343%,20:25.94883%,13:18.18801%,6:17.46737%,17:0.00071%,1:0.00071%,21:0.00047%,14:0.00024%,7:0.00024%]
[INFO] ** s_port:[1.45442:25.94836%,-0.32151:21.05665%,-1.27613:18.18801%,-0.23351:17.46667%,-0.33484:17.33678%,-0.24151:0.00071%,-71.33197:0.00071%,-3.0613900000000003:0.00024%,-3.3787199999999995:0.00024%,14.191239999999999:0.00024%,1.46509:0.00024%,1.47576:0.00024%,11.57001:0.00024%,-49.275529999999996:0.00024%,-71.14931:0.00024%,7.66617:0.00024%]
[INFO] ** scada_tag:[3:25.94812%,1:21.05642%,5:18.18778%,4:17.4662%,2:17.33678%,0:0.00471%]
[INFO] ** service:[0.0048200000000000005:99.99788%,-211.09762999999998:0.00071%,-211.73542999999998:0.00071%,-186.43601999999998:0.00024%,-211.35747999999998:0.00024%,-211.08818:0.00024%]
[INFO] ** src:[22:38.39343%,9:25.94883%,7:18.18801%,1:17.46737%,14:0.00071%,3:0.00071%,4:0.00047%,21:0.00024%,2:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1152 (0.27156%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/424208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0566 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9982 - val_loss: 0.0113 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/424208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0548 - tp: 79151.0000 - fp: 849.0000 - tn: 319151.0000 - fn: 849.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9982 - val_loss: 0.0111 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/424208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0562 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9982 - val_loss: 0.0120 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/424208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0568 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9982 - val_loss: 0.0113 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-33-34-batch-300000-400000
[INFO] processing batch 400000-500000/424208
[33m[INFO] loading file 35-35/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:99.99886%,30:0.00114%]
[INFO] ** classification:[normal:64.37769%,Single Stage Single Point:35.62231%]
[INFO] ** dst:[21:43.33566%,10:21.03936%,8:18.14413%,9:17.47856%,22:0.00114%,15:0.00114%]
[INFO] ** i/f_dir:[1:99.99905%,0:0.00095%]
[INFO] ** i/f_name:[2:99.99886%,3:0.00114%]
[INFO] ** modbus_function_code:[0.02961:99.99886%,-33.760870000000004:0.00114%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99886%,0:0.00114%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99886%,1:0.00114%]
[INFO] ** proxy_src_ip:[18:38.40346%,20:25.97213%,13:18.14375%,6:17.47875%,17:0.00114%,16:0.00076%]
[INFO] ** s_port:[1.45442:25.97156%,-0.32151:21.03936%,-1.27613:18.14375%,-0.23351:17.47837%,-0.33484:17.3641%,-71.33197:0.00114%,-1.02014:0.00076%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.97118%,1:21.03936%,5:18.14356%,4:17.47799%,2:17.3641%,0:0.00382%]
[INFO] ** service:[0.0048200000000000005:99.99886%,-211.73542999999998:0.00114%]
[INFO] ** src:[22:38.40346%,9:25.97213%,7:18.14375%,1:17.47875%,14:0.00114%,15:0.00076%]
[INFO] ** type:[0:99.99905%,1:0.00095%]
[INFO] ** unixtime:1423 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0549 - tp: 79146.0000 - fp: 854.0000 - tn: 319146.0000 - fn: 854.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9982 - val_loss: 0.0110 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0578 - tp: 79091.0000 - fp: 909.0000 - tn: 319091.0000 - fn: 909.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9981 - val_loss: 0.0129 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-1-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0586 - tp: 79076.0000 - fp: 924.0000 - tn: 319076.0000 - fn: 924.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9981 - val_loss: 0.0117 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0589 - tp: 79066.0000 - fp: 934.0000 - tn: 319066.0000 - fn: 934.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9981 - val_loss: 0.0117 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0567 - tp: 79109.0000 - fp: 891.0000 - tn: 319109.0000 - fn: 891.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9982 - val_loss: 0.0114 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 36-36/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:99.99866%,30:0.00057%,31:0.00038%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.35156%,Single Stage Single Point:35.64844%]
[INFO] ** dst:[21:43.33032%,10:21.01914%,8:18.1613%,9:17.48695%,22:0.00076%,15:0.00057%,24:0.00038%,18:0.00038%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99943%,0:0.00057%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99866%,-33.760870000000004:0.00134%]
[INFO] ** modbus_function_description:[7:50.00038%,11:49.99828%,0:0.00134%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99886%,2:0.00057%,1:0.00057%]
[INFO] ** proxy_src_ip:[18:38.36836%,20:25.98129%,13:18.16149%,6:17.48752%,17:0.00057%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98072%,-0.32151:21.01895%,-1.27613:18.16092%,-0.23351:17.48676%,-0.33484:17.34941%,-0.24151:0.00057%,-71.33197:0.00057%,-1.27347:0.00038%,-0.08551:0.00038%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-49.275529999999996:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.98034%,1:21.01876%,5:18.16073%,4:17.48657%,2:17.34922%,0:0.00439%]
[INFO] ** service:[0.0048200000000000005:99.99886%,-211.73542999999998:0.00057%,-186.43601999999998:0.00038%,-186.44547:0.00019%]
[INFO] ** src:[22:38.36836%,9:25.98129%,7:18.16149%,1:17.48752%,14:0.00057%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1424 (0.27165%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0549 - tp: 79149.0000 - fp: 851.0000 - tn: 319149.0000 - fn: 851.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9982 - val_loss: 0.0109 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0569 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9982 - val_loss: 0.0113 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0546 - tp: 79148.0000 - fp: 852.0000 - tn: 319148.0000 - fn: 852.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9983 - val_loss: 0.0108 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0610 - tp: 79025.0000 - fp: 975.0000 - tn: 319025.0000 - fn: 975.0000 - accuracy: 0.9951 - precision: 0.9878 - recall: 0.9878 - auc: 0.9980 - val_loss: 0.0115 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0575 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9981 - val_loss: 0.0114 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 37-37/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:99.99886%,30:0.00076%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.38627%,Single Stage Single Point:35.61373%]
[INFO] ** dst:[21:43.33814%,10:21.04623%,8:18.13383%,9:17.4797%,22:0.00076%,15:0.00076%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99924%,3:0.00076%]
[INFO] ** modbus_function_code:[0.02961:99.99886%,-33.760870000000004:0.00114%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99866%,0:0.00114%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99905%,1:0.00076%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.39545%,20:25.9893%,13:18.13402%,6:17.4797%,17:0.00076%,16:0.00038%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.98873%,-0.32151:21.04623%,-1.27613:18.13364%,-0.23351:17.47951%,-0.33484:17.34922%,-71.33197:0.00076%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.98854%,1:21.04623%,5:18.13345%,4:17.47932%,2:17.34903%,0:0.00343%]
[INFO] ** service:[0.0048200000000000005:99.99886%,-211.73542999999998:0.00076%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.39545%,9:25.9893%,7:18.13402%,1:17.4797%,14:0.00076%,15:0.00038%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1424 (0.27165%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0575 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9981 - val_loss: 0.0114 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0565 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9982 - val_loss: 0.0120 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0571 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9982 - val_loss: 0.0112 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0548 - tp: 79143.0000 - fp: 857.0000 - tn: 319143.0000 - fn: 857.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9982 - val_loss: 0.0111 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0579 - tp: 79086.0000 - fp: 914.0000 - tn: 319086.0000 - fn: 914.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9981 - val_loss: 0.0111 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 38-38/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:99.99905%,30:0.00019%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.41126%,Single Stage Single Point:35.58874%]
[INFO] ** dst:[21:43.32212%,10:21.08705%,8:18.09625%,9:17.49267%,22:0.00095%,25:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99905%,-33.760870000000004:0.00095%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99943%,0:0.00095%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99943%,2:0.00038%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.45439%,20:25.95535%,13:18.09606%,6:17.49306%,7:0.00038%,17:0.00019%,16:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95458%,-0.32151:21.08686%,-1.27613:18.09587%,-0.23351:17.49248%,-0.33484:17.36753%,1.45709:0.00038%,-0.24151:0.00038%,-71.14798:0.00019%,-64.19493:0.00019%,-1.02014:0.00019%,-61.95768:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,10.192739999999999:0.00019%,-0.24950999999999998:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.9542%,1:21.08686%,5:18.09587%,4:17.49229%,2:17.36753%,0:0.00324%]
[INFO] ** service:[0.0048200000000000005:99.99924%,-186.44547:0.00019%,-211.08346:0.00019%,-211.73542999999998:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.45439%,9:25.95535%,7:18.09606%,1:17.49306%,21:0.00038%,16:0.00019%,15:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1425 (0.27184%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0577 - tp: 79086.0000 - fp: 914.0000 - tn: 319086.0000 - fn: 914.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9981 - val_loss: 0.0113 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0543 - tp: 79152.0000 - fp: 848.0000 - tn: 319152.0000 - fn: 848.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9983 - val_loss: 0.0108 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0556 - tp: 79130.0000 - fp: 870.0000 - tn: 319130.0000 - fn: 870.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9982 - val_loss: 0.0110 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0571 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9981 - val_loss: 0.0112 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0565 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9982 - val_loss: 0.0111 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 39-39/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.41145%,Single Stage Single Point:35.58855%]
[INFO] ** dst:[21:43.32269%,10:21.088%,8:18.13002%,9:17.45815%,22:0.00095%,24:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00057%,11:49.99943%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.46164%,20:25.94924%,13:18.1304%,6:17.45815%,16:0.00057%]
[INFO] ** s_port:[1.45442:25.94886%,-0.32151:21.088%,-1.27613:18.13002%,-0.23351:17.45796%,-0.33484:17.37364%,-1.02014:0.00057%,-1.27347:0.00019%,1.45709:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.94848%,1:21.08781%,5:18.12983%,4:17.45796%,2:17.37345%,0:0.00248%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.46164%,9:25.94924%,7:18.1304%,1:17.45815%,15:0.00057%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1423 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0591 - tp: 79058.0000 - fp: 942.0000 - tn: 319058.0000 - fn: 942.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9981 - val_loss: 0.0115 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0536 - tp: 79166.0000 - fp: 834.0000 - tn: 319166.0000 - fn: 834.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9983 - val_loss: 0.0107 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0539 - tp: 79159.0000 - fp: 841.0000 - tn: 319159.0000 - fn: 841.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9983 - val_loss: 0.0105 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0565 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9982 - val_loss: 0.0110 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0569 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9982 - val_loss: 0.0109 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 40-40/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:99.99618%,30:0.00324%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.33782%,Single Stage Single Point:35.66218%]
[INFO] ** dst:[21:43.29541%,10:21.03726%,8:18.19087%,9:17.4715%,15:0.00324%,22:0.00095%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99695%,0:0.00305%]
[INFO] ** i/f_name:[2:99.99676%,3:0.00324%]
[INFO] ** modbus_function_code:[0.02961:99.99618%,-33.760870000000004:0.00382%]
[INFO] ** modbus_function_description:[7:49.99924%,11:49.99695%,0:0.00382%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99618%,1:0.00324%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.35271%,20:25.98091%,13:18.19068%,6:17.47188%,17:0.00324%,14:0.00057%]
[INFO] ** s_port:[1.45442:25.97995%,-0.32151:21.03726%,-1.27613:18.19049%,-0.23351:17.47131%,-0.33484:17.31545%,-71.33197:0.00324%,1.45709:0.00057%,-0.24151:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,13.431270000000001:0.00019%]
[INFO] ** scada_tag:[3:25.97957%,1:21.03707%,5:18.1903%,4:17.47093%,2:17.31526%,0:0.00687%]
[INFO] ** service:[0.0048200000000000005:99.99618%,-211.73542999999998:0.00324%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.35271%,9:25.98091%,7:18.19068%,1:17.47188%,14:0.00324%,2:0.00057%]
[INFO] ** type:[0:99.99905%,1:0.00095%]
[INFO] ** unixtime:1426 (0.27203%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0548 - tp: 79144.0000 - fp: 856.0000 - tn: 319144.0000 - fn: 856.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9982 - val_loss: 0.0107 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0568 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9982 - val_loss: 0.0111 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0576 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9981 - val_loss: 0.0112 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0583 - tp: 79109.0000 - fp: 891.0000 - tn: 319109.0000 - fn: 891.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9981 - val_loss: 0.0109 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0566 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9982 - val_loss: 0.0108 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 41-41/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (464366, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (464366, 17)

[INFO] analyzing data
[INFO] 464366 rows
[INFO] ** appi_name:[21:99.99634%,30:0.00108%,22:0.00086%,17:0.00086%,32:0.00022%,28:0.00022%,26:0.00022%,7:0.00022%]
[INFO] ** classification:[normal:64.39231%,Single Stage Single Point:35.60769%]
[INFO] ** dst:[21:43.32208%,10:21.06571%,8:18.13699%,9:17.47049%,16:0.00108%,15:0.00108%,6:0.00108%,22:0.00065%,24:0.00043%,17:0.00043%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99634%,-33.760870000000004:0.00366%]
[INFO] ** modbus_function_description:[7:49.99892%,11:49.99742%,0:0.00366%]
[INFO] ** modbus_transaction_id:65536 (14.11301%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99763%,2:0.00129%,1:0.00108%]
[INFO] ** proxy_src_ip:[18:38.43994%,20:25.94807%,13:18.1372%,6:17.4707%,17:0.00108%,1:0.00086%,21:0.00043%,16:0.00043%,14:0.00043%,0:0.00043%,7:0.00022%,2:0.00022%]
[INFO] ** s_port:[1.45442:25.94764%,-0.32151:21.06571%,-1.27613:18.13656%,-0.23351:17.47027%,-0.33484:17.37423%,-71.33197:0.00108%,-71.14931:0.00086%,-1.02014:0.00043%,-1.27347:0.00043%,-71.14798:0.00022%,-0.24151:0.00022%,-58.035180000000004:0.00022%,-1.2708:0.00022%,-5.1466400000000005:0.00022%,1.47576:0.00022%,1.46509:0.00022%,-64.19226:0.00022%,-5.08665:0.00022%,-0.24950999999999998:0.00022%,2.05573:0.00022%,-43.76509:0.00022%,-58.032509999999995:0.00022%]
[INFO] ** scada_tag:[3:25.94742%,1:21.06571%,5:18.13656%,4:17.47006%,2:17.37423%,0:0.00603%]
[INFO] ** service:[0.0048200000000000005:99.99634%,-211.73542999999998:0.00108%,-205.44247:0.00086%,-211.08818:0.00086%,89.64175:0.00022%,-211.09762999999998:0.00022%,-211.08346:0.00022%,-185.9872:0.00022%]
[INFO] ** src:[22:38.43994%,9:25.94807%,7:18.1372%,1:17.4707%,14:0.00108%,3:0.00086%,15:0.00043%,8:0.00043%,4:0.00043%,2:0.00043%,21:0.00022%,17:0.00022%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1260 (0.27134%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/464366
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0565 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9982 - val_loss: 0.0110 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/464366
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0562 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9982 - val_loss: 0.0112 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/464366
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0575 - tp: 79088.0000 - fp: 912.0000 - tn: 319088.0000 - fn: 912.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9981 - val_loss: 0.0113 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/464366
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0570 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9981 - val_loss: 0.0112 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/464366
[33m[INFO] loading file 42-42/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (407880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (407880, 17)

[INFO] analyzing data
[INFO] 407880 rows
[INFO] ** appi_name:[21:99.99166%,30:0.00221%,17:0.00123%,31:0.00098%,26:0.00098%,7:0.00098%,22:0.00074%,28:0.00025%,27:0.00025%,9:0.00025%,8:0.00025%,0:0.00025%]
[INFO] ** classification:[normal:64.37947%,Single Stage Single Point:35.62053%]
[INFO] ** dst:[21:43.31691%,10:21.05374%,8:18.17741%,9:17.44263%,16:0.00221%,6:0.00196%,18:0.00123%,2:0.00098%,22:0.00074%,15:0.00074%,17:0.00049%,25:0.00025%,24:0.00025%,7:0.00025%,0:0.00025%]
[INFO] ** i/f_dir:[1:99.99926%,0:0.00074%]
[INFO] ** i/f_name:[2:99.99926%,3:0.00074%]
[INFO] ** modbus_function_code:[0.02961:99.99166%,-33.760870000000004:0.00834%]
[INFO] ** modbus_function_description:[7:49.99657%,11:49.9951%,0:0.00834%]
[INFO] ** modbus_transaction_id:65536 (16.06747%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99559%,2:0.00368%,1:0.00074%]
[INFO] ** proxy_src_ip:[18:38.4135%,20:25.95739%,13:18.1779%,6:17.44263%,17:0.00221%,1:0.00221%,14:0.00147%,21:0.00098%,7:0.00074%,0:0.00049%,16:0.00025%,2:0.00025%]
[INFO] ** s_port:[1.45442:25.9569%,-0.32151:21.05374%,-1.27613:18.17741%,-0.23351:17.44239%,-0.33484:17.35976%,-71.14931:0.00098%,-71.14798:0.00098%,-71.33197:0.00074%,11.57001:0.00049%,-0.08551:0.00049%,-3.3787199999999995:0.00049%,-0.24151:0.00025%,13.431270000000001:0.00025%,-5.1466400000000005:0.00025%,0.31847:0.00025%,-1.02014:0.00025%,-1.2708:0.00025%,-58.035180000000004:0.00025%,7.66617:0.00025%,-64.19493:0.00025%,1.47576:0.00025%,14.4699:0.00025%,15.912510000000001:0.00025%,14.191239999999999:0.00025%,7.9608300000000005:0.00025%,-5.08665:0.00025%,10.192739999999999:0.00025%,-3.0613900000000003:0.00025%,1.45709:0.00025%,2.05573:0.00025%,-43.76509:0.00025%,11.862:0.00025%,-1.27347:0.00025%,-58.032509999999995:0.00025%]
[INFO] ** scada_tag:[3:25.95641%,1:21.05374%,5:18.17716%,4:17.44239%,2:17.35952%,0:0.01079%]
[INFO] ** service:[0.0048200000000000005:99.99166%,-211.09762999999998:0.00172%,-205.44247:0.00123%,-186.43601999999998:0.00123%,-211.08346:0.00098%,-211.08818:0.00098%,-211.73542999999998:0.00074%,-211.35747999999998:0.00049%,-186.44547:0.00025%,-183.8612:0.00025%,-185.9872:0.00025%,-202.75898:0.00025%]
[INFO] ** src:[22:38.4135%,9:25.95739%,7:18.1779%,1:17.44263%,3:0.00294%,2:0.00172%,4:0.00123%,21:0.00098%,14:0.00074%,8:0.00049%,17:0.00025%,15:0.00025%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1107 (0.2714%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/407880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0579 - tp: 79081.0000 - fp: 919.0000 - tn: 319081.0000 - fn: 919.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9981 - val_loss: 0.0119 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/407880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0592 - tp: 79053.0000 - fp: 947.0000 - tn: 319053.0000 - fn: 947.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9981 - val_loss: 0.0115 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/407880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0573 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9981 - val_loss: 0.0113 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/407880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0569 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9982 - val_loss: 0.0113 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-41-42-batch-300000-400000
[INFO] processing batch 400000-500000/407880
[33m[INFO] loading file 43-43/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99921%,30:0.00059%,26:0.0002%]
[INFO] ** classification:[normal:64.40124%,Single Stage Single Point:35.59876%]
[INFO] ** dst:[21:43.3313%,10:21.06817%,8:18.12653%,9:17.47204%,22:0.00098%,15:0.00059%,24:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name:[2:99.99941%,3:0.00059%]
[INFO] ** modbus_function_code:[0.02961:99.99921%,-33.760870000000004:0.00079%]
[INFO] ** modbus_function_description:[7:50.0002%,11:49.99902%,0:0.00079%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99921%,1:0.00059%,2:0.0002%]
[INFO] ** proxy_src_ip:[18:38.42227%,20:25.97759%,13:18.12672%,6:17.47224%,17:0.00059%,16:0.00039%,1:0.0002%]
[INFO] ** s_port:[1.45442:25.977%,-0.32151:21.06817%,-1.27613:18.12633%,-0.23351:17.47184%,-0.33484:17.3541%,-71.33197:0.00059%,1.45709:0.00039%,-1.02014:0.00039%,-71.14798:0.0002%,-1.27347:0.0002%,-0.24950999999999998:0.0002%,1.47576:0.0002%,-0.24151:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.97661%,1:21.06817%,5:18.12613%,4:17.47145%,2:17.3539%,0:0.00374%]
[INFO] ** service:[0.0048200000000000005:99.99921%,-211.73542999999998:0.00059%,-211.08346:0.0002%]
[INFO] ** src:[22:38.42227%,9:25.97759%,7:18.12672%,1:17.47224%,14:0.00059%,15:0.00039%,3:0.0002%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1381 (0.27191%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0586 - tp: 79068.0000 - fp: 932.0000 - tn: 319068.0000 - fn: 932.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9981 - val_loss: 0.0114 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0594 - tp: 79051.0000 - fp: 949.0000 - tn: 319051.0000 - fn: 949.0000 - accuracy: 0.9953 - precision: 0.9881 - recall: 0.9881 - auc: 0.9981 - val_loss: 0.0117 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0564 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9982 - val_loss: 0.0112 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0583 - tp: 79073.0000 - fp: 927.0000 - tn: 319073.0000 - fn: 927.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9981 - val_loss: 0.0115 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0536 - tp: 79165.0000 - fp: 835.0000 - tn: 319165.0000 - fn: 835.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9983 - val_loss: 0.0108 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 44-44/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99803%,30:0.00079%,31:0.00059%,0:0.00039%,22:0.0002%]
[INFO] ** classification:[normal:64.36501%,Single Stage Single Point:35.63499%]
[INFO] ** dst:[21:43.32185%,10:21.04001%,8:18.16965%,9:17.46515%,22:0.00098%,15:0.00079%,18:0.00059%,25:0.00039%,24:0.00039%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99921%,0:0.00079%]
[INFO] ** i/f_name:[2:99.99921%,3:0.00079%]
[INFO] ** modbus_function_code:[0.02961:99.99803%,-33.760870000000004:0.00197%]
[INFO] ** modbus_function_description:[7:50.0002%,11:49.99783%,0:0.00197%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99803%,2:0.00118%,1:0.00079%]
[INFO] ** proxy_src_ip:[18:38.40947%,20:25.95278%,13:18.16984%,6:17.46574%,17:0.00079%,7:0.00039%,16:0.0002%,5:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.95219%,-0.32151:21.04001%,-1.27613:18.16925%,-0.23351:17.46495%,-0.33484:17.36946%,-71.33197:0.00079%,-0.24151:0.00059%,-64.19493:0.00039%,-0.08551:0.00039%,-1.27347:0.00039%,1.46509:0.0002%,1.47576:0.0002%,-0.24950999999999998:0.0002%,1.45709:0.0002%,4.42897:0.0002%,-71.14931:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.9518%,1:21.04001%,5:18.16925%,4:17.46456%,2:17.36926%,0:0.00512%]
[INFO] ** service:[0.0048200000000000005:99.99803%,-211.73542999999998:0.00079%,-186.43601999999998:0.00059%,-186.44547:0.00039%,-211.08818:0.0002%]
[INFO] ** src:[22:38.40947%,9:25.95278%,7:18.16984%,1:17.46574%,14:0.00079%,21:0.00039%,17:0.0002%,16:0.0002%,15:0.0002%,8:0.0002%,3:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1378 (0.27132%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0546 - tp: 79147.0000 - fp: 853.0000 - tn: 319147.0000 - fn: 853.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9982 - val_loss: 0.0106 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0596 - tp: 79046.0000 - fp: 954.0000 - tn: 319046.0000 - fn: 954.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9980 - val_loss: 0.0113 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0559 - tp: 79119.0000 - fp: 881.0000 - tn: 319119.0000 - fn: 881.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9982 - val_loss: 0.0110 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0568 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9982 - val_loss: 0.0113 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0574 - tp: 79091.0000 - fp: 909.0000 - tn: 319091.0000 - fn: 909.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9981 - val_loss: 0.0114 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 45-45/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99902%,30:0.00059%,26:0.0002%,9:0.0002%]
[INFO] ** classification:[normal:64.41797%,Single Stage Single Point:35.58203%]
[INFO] ** dst:[21:43.32441%,10:21.0914%,8:18.12003%,9:17.462%,22:0.00118%,15:0.00059%,6:0.0002%,0:0.0002%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99941%,3:0.00059%]
[INFO] ** modbus_function_code:[0.02961:99.99902%,-33.760870000000004:0.00098%]
[INFO] ** modbus_function_description:[7:50.00039%,11:49.99862%,0:0.00098%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99921%,1:0.00059%,2:0.0002%]
[INFO] ** proxy_src_ip:[18:38.48527%,20:25.93113%,13:18.12003%,6:17.4622%,17:0.00059%,16:0.00039%,21:0.0002%,1:0.0002%]
[INFO] ** s_port:[1.45442:25.93053%,-0.32151:21.0914%,-1.27613:18.12003%,-0.23351:17.462%,-0.33484:17.39387%,1.45709:0.00059%,-71.33197:0.00059%,-1.02014:0.00039%,-71.14798:0.0002%,14.4699:0.0002%,-0.24151:0.0002%]
[INFO] ** scada_tag:[3:25.93014%,1:21.0912%,5:18.12003%,4:17.462%,2:17.39368%,0:0.00295%]
[INFO] ** service:[0.0048200000000000005:99.99902%,-211.73542999999998:0.00059%,-183.8612:0.0002%,-211.08346:0.0002%]
[INFO] ** src:[22:38.48527%,9:25.93113%,7:18.12003%,1:17.4622%,14:0.00059%,15:0.00039%,4:0.0002%,3:0.0002%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** unixtime:1379 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0561 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9982 - val_loss: 0.0110 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0572 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9981 - val_loss: 0.0111 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0555 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9982 - val_loss: 0.0115 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0543 - tp: 79151.0000 - fp: 849.0000 - tn: 319151.0000 - fn: 849.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9983 - val_loss: 0.0106 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0573 - tp: 79091.0000 - fp: 909.0000 - tn: 319091.0000 - fn: 909.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9981 - val_loss: 0.0119 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 46-46/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99823%,30:0.00098%,26:0.0002%,17:0.0002%,12:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:64.42093%,Single Stage Single Point:35.57907%]
[INFO] ** dst:[21:43.35%,10:21.06836%,8:18.10979%,9:17.46928%,22:0.00098%,15:0.00098%,25:0.0002%,16:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99902%,0:0.00098%]
[INFO] ** i/f_name:[2:99.99902%,3:0.00098%]
[INFO] ** modbus_function_code:[0.02961:99.99823%,-33.760870000000004:0.00177%]
[INFO] ** modbus_function_description:[11:49.99921%,7:49.99902%,0:0.00177%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.99862%,1:0.00098%,2:0.00039%]
[INFO] ** proxy_src_ip:[18:38.44097%,20:25.9772%,13:18.10979%,6:17.46987%,17:0.00098%,16:0.00039%,7:0.00039%,5:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.977%,-0.32151:21.06817%,-1.27613:18.10959%,-0.23351:17.46909%,-0.33484:17.3728%,-71.33197:0.00098%,-0.24151:0.00059%,-1.02014:0.00039%,-71.14798:0.0002%,-0.24950999999999998:0.0002%,10.192739999999999:0.0002%,1.47576:0.0002%,-61.95768:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.97681%,1:21.06797%,5:18.1094%,4:17.46869%,2:17.3728%,0:0.00433%]
[INFO] ** service:[0.0048200000000000005:99.99842%,-211.73542999999998:0.00098%,-186.44547:0.0002%,-211.08346:0.0002%,-205.44247:0.0002%]
[INFO] ** src:[22:38.44097%,9:25.9772%,7:18.10979%,1:17.46987%,14:0.00098%,21:0.00039%,15:0.00039%,16:0.0002%,8:0.0002%]
[INFO] ** type:[0:99.99921%,1:0.00079%]
[INFO] ** unixtime:1381 (0.27191%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0575 - tp: 79091.0000 - fp: 909.0000 - tn: 319091.0000 - fn: 909.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9981 - val_loss: 0.0112 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0556 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9982 - val_loss: 0.0112 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0547 - tp: 79143.0000 - fp: 857.0000 - tn: 319143.0000 - fn: 857.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9982 - val_loss: 0.0108 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0568 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9982 - val_loss: 0.0109 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0579 - tp: 79080.0000 - fp: 920.0000 - tn: 319080.0000 - fn: 920.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9981 - val_loss: 0.0112 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 47-47/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.9998%,33:0.0002%]
[INFO] ** classification:[normal:64.39257%,Single Stage Single Point:35.60743%]
[INFO] ** dst:[21:43.30058%,10:21.09022%,8:18.12849%,9:17.47854%,22:0.00177%,24:0.00039%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.9998%,-33.760870000000004:0.0002%]
[INFO] ** modbus_function_description:[7:50.00138%,11:49.99842%,0:0.0002%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.46086%,20:25.93073%,13:18.12889%,6:17.47893%,16:0.00039%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.92975%,-0.32151:21.09022%,-1.27613:18.1283%,-0.23351:17.47834%,-0.33484:17.37064%,1.45709:0.00059%,-0.24151:0.00059%,-1.27347:0.00039%,-1.02014:0.00039%,-61.95635:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.92916%,1:21.09002%,5:18.1281%,4:17.47814%,2:17.37044%,0:0.00413%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.46086%,9:25.93073%,7:18.12889%,1:17.47893%,15:0.00039%,8:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1379 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0565 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9982 - val_loss: 0.0111 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0567 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9982 - val_loss: 0.0111 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0565 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9982 - val_loss: 0.0112 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0577 - tp: 79083.0000 - fp: 917.0000 - tn: 319083.0000 - fn: 917.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9981 - val_loss: 0.0113 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0569 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9982 - val_loss: 0.0120 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 48-48/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99665%,30:0.00276%,31:0.0002%,27:0.0002%,26:0.0002%]
[INFO] ** classification:[normal:64.41719%,Single Stage Single Point:35.58281%]
[INFO] ** dst:[21:43.33169%,10:21.08155%,8:18.11432%,9:17.4681%,15:0.00276%,22:0.00079%,24:0.0002%,18:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99764%,0:0.00236%]
[INFO] ** i/f_name:[2:99.99724%,3:0.00276%]
[INFO] ** modbus_function_code:[0.02961:99.99665%,-33.760870000000004:0.00335%]
[INFO] ** modbus_function_description:[7:49.99921%,11:49.99744%,0:0.00335%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99665%,1:0.00276%,2:0.00059%]
[INFO] ** proxy_src_ip:[18:38.45515%,20:25.9583%,13:18.11471%,6:17.4681%,17:0.00276%,14:0.00059%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.9579%,-0.32151:21.08155%,-1.27613:18.11432%,-0.23351:17.46791%,-0.33484:17.37359%,-71.33197:0.00276%,-1.02014:0.00039%,-71.14798:0.0002%,-1.27347:0.0002%,11.862:0.0002%,1.45709:0.0002%,1.47576:0.0002%,-0.24151:0.0002%,13.431270000000001:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.95751%,1:21.08155%,5:18.11432%,4:17.46791%,2:17.3734%,0:0.00532%]
[INFO] ** service:[0.0048200000000000005:99.99665%,-211.73542999999998:0.00276%,-211.08346:0.0002%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.45515%,9:25.9583%,7:18.11471%,1:17.4681%,14:0.00276%,2:0.00059%,15:0.00039%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1378 (0.27132%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0561 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9982 - val_loss: 0.0110 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0563 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9982 - val_loss: 0.0110 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0553 - tp: 79131.0000 - fp: 869.0000 - tn: 319131.0000 - fn: 869.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9982 - val_loss: 0.0108 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0564 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9982 - val_loss: 0.0110 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0577 - tp: 79084.0000 - fp: 916.0000 - tn: 319084.0000 - fn: 916.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9981 - val_loss: 0.0114 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 49-49/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99724%,30:0.00098%,17:0.00079%,22:0.00039%,28:0.0002%,26:0.0002%,7:0.0002%]
[INFO] ** classification:[normal:64.37151%,Single Stage Single Point:35.62849%]
[INFO] ** dst:[21:43.29901%,10:21.06797%,8:18.14149%,9:17.4872%,22:0.00138%,15:0.00098%,16:0.00079%,6:0.00059%,17:0.00039%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.99902%,0:0.00098%]
[INFO] ** i/f_name:[2:99.99902%,3:0.00098%]
[INFO] ** modbus_function_code:[0.02961:99.99724%,-33.760870000000004:0.00276%]
[INFO] ** modbus_function_description:[7:49.99941%,11:49.99783%,0:0.00276%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99842%,1:0.00098%,2:0.00059%]
[INFO] ** proxy_src_ip:[18:38.42798%,20:25.93979%,13:18.14129%,6:17.48779%,17:0.00098%,1:0.00079%,21:0.00039%,16:0.00039%,14:0.00039%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.939%,-0.32151:21.06797%,-1.27613:18.1411%,-0.23351:17.487%,-0.33484:17.36001%,-71.33197:0.00098%,-0.24151:0.00059%,1.45709:0.00039%,-1.02014:0.00039%,-71.14931:0.00039%,-71.14798:0.0002%,-58.035180000000004:0.0002%,-5.1466400000000005:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,-5.08665:0.0002%,-0.24950999999999998:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:25.93861%,1:21.06777%,5:18.1409%,4:17.48661%,2:17.36001%,0:0.0061%]
[INFO] ** service:[0.0048200000000000005:99.99724%,-211.73542999999998:0.00098%,-205.44247:0.00079%,-211.08818:0.00039%,-211.09762999999998:0.0002%,-211.08346:0.0002%,-185.9872:0.0002%]
[INFO] ** src:[22:38.42798%,9:25.93979%,7:18.14129%,1:17.48779%,14:0.00098%,3:0.00079%,15:0.00039%,4:0.00039%,2:0.00039%,8:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1379 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0576 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9981 - val_loss: 0.0113 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0558 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9982 - val_loss: 0.0110 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0586 - tp: 79066.0000 - fp: 934.0000 - tn: 319066.0000 - fn: 934.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9981 - val_loss: 0.0111 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0551 - tp: 79142.0000 - fp: 858.0000 - tn: 319142.0000 - fn: 858.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9982 - val_loss: 0.0109 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0593 - tp: 79052.0000 - fp: 948.0000 - tn: 319052.0000 - fn: 948.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9981 - val_loss: 0.0114 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 50-50/50 on epoch 1/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (357862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (357862, 17)

[INFO] analyzing data
[INFO] 357862 rows
[INFO] ** appi_name:[21:99.99749%,30:0.00084%,7:0.00084%,31:0.00028%,22:0.00028%,8:0.00028%]
[INFO] ** classification:[normal:64.2949%,Single Stage Single Point:35.7051%]
[INFO] ** dst:[21:43.25019%,10:21.04163%,8:18.2263%,9:17.47853%,15:0.00084%,22:0.00056%,16:0.00056%,2:0.00056%,24:0.00028%,18:0.00028%,6:0.00028%]
[INFO] ** i/f_dir:[1:99.99916%,0:0.00084%]
[INFO] ** i/f_name:[2:99.99916%,3:0.00084%]
[INFO] ** modbus_function_code:[0.02961:99.99749%,-33.760870000000004:0.00251%]
[INFO] ** modbus_function_description:[7:49.99916%,11:49.99832%,0:0.00251%]
[INFO] ** modbus_transaction_id:65535 (18.31293%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9986%,1:0.00084%,2:0.00056%]
[INFO] ** proxy_src_ip:[18:38.36339%,20:25.92871%,13:18.22658%,6:17.47853%,17:0.00084%,1:0.00084%,21:0.00028%,16:0.00028%,14:0.00028%,7:0.00028%]
[INFO] ** s_port:[1.45442:25.92815%,-0.32151:21.04163%,-1.27613:18.22602%,-0.23351:17.47853%,-0.33484:17.32176%,-71.33197:0.00084%,-3.3787199999999995:0.00028%,4.33564:0.00028%,15.912510000000001:0.00028%,7.9608300000000005:0.00028%,1.46509:0.00028%,1.45709:0.00028%,-1.27347:0.00028%,-71.14931:0.00028%,-1.02014:0.00028%,-1.2708:0.00028%,0.31847:0.00028%]
[INFO] ** scada_tag:[3:25.92787%,1:21.04135%,5:18.22574%,4:17.47853%,2:17.32148%,0:0.00503%]
[INFO] ** service:[0.0048200000000000005:99.99749%,-211.09762999999998:0.00084%,-211.73542999999998:0.00084%,-186.43601999999998:0.00028%,-211.35747999999998:0.00028%,-211.08818:0.00028%]
[INFO] ** src:[22:38.36339%,9:25.92871%,7:18.22658%,1:17.47853%,14:0.00084%,3:0.00084%,21:0.00028%,15:0.00028%,4:0.00028%,2:0.00028%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:973 (0.27189%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/357862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0567 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9982 - val_loss: 0.0112 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/357862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0558 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9982 - val_loss: 0.0112 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/357862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0573 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9981 - val_loss: 0.0119 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/357862
[33m[INFO] epoch 2/100[0m
[33m[INFO] loading file 1-1/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99355%,30:0.00108%,22:0.0009%,17:0.00072%,31:0.00054%,26:0.00054%,7:0.00054%,23:0.00036%,18:0.00036%,0:0.00036%,28:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:77.7375%,Single Stage Single Point:22.2625%]
[INFO] ** dst:[21:43.26823%,10:21.03423%,8:18.17026%,9:17.52028%,6:0.00143%,22:0.00108%,16:0.00108%,15:0.00108%,18:0.00054%,26:0.00036%,25:0.00036%,19:0.00036%,17:0.00036%,24:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99355%,-33.760870000000004:0.00627%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99767%,11:49.99588%,0:0.00627%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99641%,2:0.00251%,1:0.00108%]
[INFO] ** proxy_src_ip:[18:38.39605%,20:25.90605%,13:18.17044%,6:17.52064%,11:0.00125%,10:0.00125%,17:0.00108%,14:0.0009%,1:0.0009%,7:0.00054%,21:0.00036%,16:0.00036%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.90551%,-0.32151:21.03352%,-1.27613:18.17009%,-0.23351:17.5201%,-0.33484:17.36254%,-71.33197:0.00108%,-71.14931:0.0009%,-2.1481:0.00072%,-0.24151:0.00054%,-71.14798:0.00054%,-1.02014:0.00036%,-64.19493:0.00036%,-2.42942:0.00036%,4.44364:0.00036%,-43.76509:0.00018%,10.67005:0.00018%,4.29964:0.00018%,-5.08665:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,1.47576:0.00018%,1.46509:0.00018%,4.076980000000001:0.00018%,-58.032509999999995:0.00018%,-58.035180000000004:0.00018%,-1.2708:0.00018%,-1.27347:0.00018%,-5.1466400000000005:0.00018%,-68.79874000000001:0.00018%,14.253910000000001:0.00018%,1.45709:0.00018%]
[INFO] ** scada_tag:[3:25.90533%,1:21.03334%,5:18.16973%,4:17.51992%,2:17.36236%,0:0.00932%]
[INFO] ** service:[0.0048200000000000005:99.99426%,-211.73542999999998:0.00108%,-211.08818:0.0009%,-205.44247:0.00072%,-211.07873999999998:0.00072%,-211.09762999999998:0.00054%,-211.08346:0.00054%,-186.43601999999998:0.00054%,-186.44547:0.00036%,-185.9872:0.00018%,-202.75898:0.00018%]
[INFO] ** src:[22:38.39605%,9:25.90605%,7:18.17044%,1:17.52064%,11:0.00125%,10:0.00125%,14:0.00108%,3:0.0009%,2:0.0009%,21:0.00054%,15:0.00036%,4:0.00036%,8:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1514 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3927 - tp: 77240.0000 - fp: 2760.0000 - tn: 317240.0000 - fn: 2760.0000 - accuracy: 0.9862 - precision: 0.9655 - recall: 0.9655 - auc: 0.9801 - val_loss: 0.0135 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0101 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0076 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0063 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0052 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0903 - tp: 59961.0000 - fp: 20039.0000 - tn: 299961.0000 - fn: 20039.0000 - accuracy: 0.8998 - precision: 0.7495 - recall: 0.7495 - auc: 0.9374 - val_loss: 1.7317 - val_tp: 10621.0000 - val_fp: 9379.0000 - val_tn: 70621.0000 - val_fn: 9379.0000 - val_accuracy: 0.8124 - val_precision: 0.5311 - val_recall: 0.5311 - val_auc: 0.8828
[INFO] saving weights to checkpoints/lstm-epoch-2-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4496 - tp: 42464.0000 - fp: 37536.0000 - tn: 282464.0000 - fn: 37536.0000 - accuracy: 0.8123 - precision: 0.5308 - recall: 0.5308 - auc: 0.8828 - val_loss: 1.2288 - val_tp: 10609.0000 - val_fp: 9391.0000 - val_tn: 70609.0000 - val_fn: 9391.0000 - val_accuracy: 0.8122 - val_precision: 0.5304 - val_recall: 0.5304 - val_auc: 0.8798
[INFO] saving weights to checkpoints/lstm-epoch-2-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 2-2/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99875%,7:0.00054%,30:0.00036%,31:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:70.74223%,Single Stage Single Point:29.25777%]
[INFO] ** dst:[21:43.30838%,10:21.03047%,8:18.14571%,9:17.51311%,22:0.0009%,16:0.00036%,15:0.00036%,2:0.00036%,24:0.00018%,18:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99964%,3:0.00036%]
[INFO] ** modbus_function_code:[0.02961:99.99875%,-33.760870000000004:0.00125%]
[INFO] ** modbus_function_description:[7:49.99982%,11:49.99892%,0:0.00125%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99946%,1:0.00036%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.38064%,20:25.95875%,13:18.14571%,6:17.51347%,1:0.00054%,17:0.00036%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.95803%,-0.32151:21.03047%,-1.27613:18.14535%,-0.23351:17.51293%,-0.33484:17.35017%,-0.24151:0.00036%,-71.33197:0.00036%,1.45709:0.00036%,1.47576:0.00018%,12.60597:0.00018%,10.67005:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,4.076980000000001:0.00018%,-3.3787199999999995:0.00018%,4.29964:0.00018%,-1.27347:0.00018%]
[INFO] ** scada_tag:[3:25.95767%,1:21.03047%,5:18.14535%,4:17.51257%,2:17.34999%,0:0.00394%]
[INFO] ** service:[0.0048200000000000005:99.99875%,-211.09762999999998:0.00054%,-211.73542999999998:0.00036%,-211.35747999999998:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.38064%,9:25.95875%,7:18.14571%,1:17.51347%,3:0.00054%,14:0.00036%,21:0.00018%,15:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1517 (0.27193%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.1478 - tp: 42072.0000 - fp: 37928.0000 - tn: 282072.0000 - fn: 37928.0000 - accuracy: 0.8104 - precision: 0.5259 - recall: 0.5259 - auc: 0.8789 - val_loss: 0.9656 - val_tp: 10609.0000 - val_fp: 9391.0000 - val_tn: 70609.0000 - val_fn: 9391.0000 - val_accuracy: 0.8122 - val_precision: 0.5304 - val_recall: 0.5304 - val_auc: 0.8826
[INFO] saving weights to checkpoints/lstm-epoch-2-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8849 - tp: 42428.0000 - fp: 37572.0000 - tn: 282428.0000 - fn: 37572.0000 - accuracy: 0.8121 - precision: 0.5304 - recall: 0.5304 - auc: 0.8828 - val_loss: 0.3865 - val_tp: 18025.0000 - val_fp: 1975.0000 - val_tn: 78025.0000 - val_fn: 1975.0000 - val_accuracy: 0.9605 - val_precision: 0.9013 - val_recall: 0.9013 - val_auc: 0.9753
[INFO] saving weights to checkpoints/lstm-epoch-2-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2323 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1939 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7011 - tp: 52633.0000 - fp: 27367.0000 - tn: 292633.0000 - fn: 27367.0000 - accuracy: 0.8632 - precision: 0.6579 - recall: 0.6579 - auc: 0.9141 - val_loss: 0.8423 - val_tp: 10603.0000 - val_fp: 9397.0000 - val_tn: 70603.0000 - val_fn: 9397.0000 - val_accuracy: 0.8121 - val_precision: 0.5301 - val_recall: 0.5301 - val_auc: 0.8825
[INFO] saving weights to checkpoints/lstm-epoch-2-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7922 - tp: 42294.0000 - fp: 37706.0000 - tn: 282294.0000 - fn: 37706.0000 - accuracy: 0.8115 - precision: 0.5287 - recall: 0.5287 - auc: 0.8822 - val_loss: 0.4570 - val_tp: 17778.0000 - val_fp: 2222.0000 - val_tn: 77778.0000 - val_fn: 2222.0000 - val_accuracy: 0.9556 - val_precision: 0.8889 - val_recall: 0.8889 - val_auc: 0.9722
[INFO] saving weights to checkpoints/lstm-epoch-2-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 3-3/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99175%,30:0.00215%,22:0.00108%,31:0.0009%,26:0.0009%,17:0.0009%,7:0.00072%,27:0.00036%,0:0.00036%,28:0.00018%,23:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:88.08989%,Single Stage Single Point:11.91011%]
[INFO] ** dst:[21:43.31053%,10:21.08066%,8:18.1561%,9:17.44356%,6:0.00215%,15:0.00143%,18:0.00125%,16:0.00125%,22:0.0009%,2:0.00036%,7:0.00036%,25:0.00036%,17:0.00036%,12:0.00018%,24:0.00018%,19:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99857%,0:0.00143%]
[INFO] ** i/f_name:[2:99.99857%,3:0.00143%]
[INFO] ** modbus_function_code:[0.02961:99.99175%,-33.760870000000004:0.00807%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99641%,11:49.99534%,0:0.00807%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99892%,2:0.00108%]
[INFO] ** proto:[0:99.99426%,2:0.0043%,1:0.00143%]
[INFO] ** proxy_src_ip:[18:38.40502%,20:25.98653%,13:18.15628%,6:17.44392%,17:0.00215%,1:0.00143%,14:0.00125%,7:0.0009%,11:0.00072%,10:0.00072%,21:0.00054%,16:0.00018%,15:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98582%,-0.32151:21.08048%,-1.27613:18.15574%,-0.23351:17.44338%,-0.33484:17.32454%,-71.33197:0.00143%,-71.14931:0.00108%,-71.14798:0.00108%,-64.19493:0.00036%,-0.08551:0.00036%,1.45709:0.00036%,-0.24151:0.00036%,14.4699:0.00018%,4.29964:0.00018%,4.90362:0.00018%,10.192739999999999:0.00018%,-3.3787199999999995:0.00018%,13.86459:0.00018%,4.44364:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,-43.76509:0.00018%,-5.08665:0.00018%,-58.035180000000004:0.00018%,4.076980000000001:0.00018%,-58.032509999999995:0.00018%,-1.27347:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-5.1466400000000005:0.00018%,13.431270000000001:0.00018%,12.60597:0.00018%,1.47576:0.00018%,1.46509:0.00018%,14.253910000000001:0.00018%,-68.79874000000001:0.00018%,-0.24950999999999998:0.00018%,-2.1481:0.00018%,10.67005:0.00018%,-68.36943000000001:0.00018%]
[INFO] ** scada_tag:[3:25.98546%,1:21.0803%,5:18.15557%,4:17.4432%,2:17.32436%,0:0.01111%]
[INFO] ** service:[0.0048200000000000005:99.99193%,-211.73542999999998:0.00143%,-186.43601999999998:0.00125%,-211.08346:0.00108%,-211.08818:0.00108%,-205.44247:0.0009%,-211.09762999999998:0.00072%,-202.75898:0.00036%,-186.44547:0.00036%,-183.8612:0.00018%,-185.9872:0.00018%,-201.23771000000002:0.00018%,-211.35747999999998:0.00018%,-211.07873999999998:0.00018%]
[INFO] ** src:[22:38.40502%,9:25.98653%,7:18.15628%,1:17.44392%,21:0.00197%,3:0.00161%,2:0.00125%,11:0.00072%,10:0.00072%,4:0.00072%,14:0.00036%,8:0.00036%,17:0.00018%,15:0.00018%,13:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1515 (0.27157%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4088 - tp: 72473.0000 - fp: 7527.0000 - tn: 312473.0000 - fn: 7527.0000 - accuracy: 0.9624 - precision: 0.9059 - recall: 0.9059 - auc: 0.9771 - val_loss: 0.8253 - val_tp: 10585.0000 - val_fp: 9415.0000 - val_tn: 70585.0000 - val_fn: 9415.0000 - val_accuracy: 0.8117 - val_precision: 0.5293 - val_recall: 0.5293 - val_auc: 0.8823
[INFO] saving weights to checkpoints/lstm-epoch-2-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7803 - tp: 42316.0000 - fp: 37684.0000 - tn: 282316.0000 - fn: 37684.0000 - accuracy: 0.8116 - precision: 0.5289 - recall: 0.5289 - auc: 0.8823 - val_loss: 0.7415 - val_tp: 10577.0000 - val_fp: 9423.0000 - val_tn: 70577.0000 - val_fn: 9423.0000 - val_accuracy: 0.8115 - val_precision: 0.5289 - val_recall: 0.5289 - val_auc: 0.8822
[INFO] saving weights to checkpoints/lstm-epoch-2-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3413 - tp: 77607.0000 - fp: 2393.0000 - tn: 317607.0000 - fn: 2393.0000 - accuracy: 0.9880 - precision: 0.9701 - recall: 0.9701 - auc: 0.9922 - val_loss: 0.2470 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2033 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1676 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1436 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1231 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 4-4/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99767%,30:0.00125%,31:0.00036%,33:0.00018%,26:0.00018%,23:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:92.15218%,Single Stage Single Point:7.84782%]
[INFO] ** dst:[21:43.35086%,10:20.9464%,8:18.17636%,9:17.52297%,15:0.00125%,22:0.00108%,18:0.00036%,24:0.00018%,19:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99875%,3:0.00125%]
[INFO] ** modbus_function_code:[0.02961:99.99767%,-33.760870000000004:0.00233%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99803%,0:0.00233%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99892%,2:0.00108%]
[INFO] ** proto:[0:99.99821%,1:0.00125%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.25785%,20:26.03977%,13:18.17636%,6:17.52333%,17:0.00125%,21:0.00036%,16:0.00036%,14:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.03906%,-0.32151:20.94622%,-1.27613:18.176%,-0.23351:17.52279%,-0.33484:17.31163%,-71.33197:0.00125%,1.45709:0.00036%,-0.08551:0.00036%,-0.24151:0.00036%,-1.02014:0.00036%,-1.2708:0.00018%,14.4699:0.00018%,4.44364:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:26.03888%,1:20.94604%,5:18.176%,4:17.52243%,2:17.31145%,0:0.0052%]
[INFO] ** service:[0.0048200000000000005:99.99785%,-211.73542999999998:0.00125%,-186.43601999999998:0.00036%,-183.8612:0.00018%,-211.08346:0.00018%,-211.07873999999998:0.00018%]
[INFO] ** src:[22:38.25785%,9:26.03977%,7:18.17636%,1:17.52333%,21:0.00108%,15:0.00036%,4:0.00036%,17:0.00018%,14:0.00018%,8:0.00018%,3:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1525 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1081 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0949 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0847 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0756 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0681 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0614 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0559 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0508 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.1313 - tp: 45869.0000 - fp: 34131.0000 - tn: 285869.0000 - fn: 34131.0000 - accuracy: 0.8293 - precision: 0.5734 - recall: 0.5734 - auc: 0.8930 - val_loss: 1.0893 - val_tp: 10352.0000 - val_fp: 9648.0000 - val_tn: 70352.0000 - val_fn: 9648.0000 - val_accuracy: 0.8070 - val_precision: 0.5176 - val_recall: 0.5176 - val_auc: 0.8794
[INFO] saving weights to checkpoints/lstm-epoch-2-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 5-5/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99641%,30:0.00251%,37:0.00018%,26:0.00018%,12:0.00018%,9:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:89.89983%,Single Stage Single Point:10.10017%]
[INFO] ** dst:[21:43.36556%,10:20.76929%,8:18.23641%,9:17.62443%,15:0.00251%,22:0.0009%,25:0.00018%,24:0.00018%,6:0.00018%,2:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99785%,0:0.00215%]
[INFO] ** i/f_name:[2:99.99749%,3:0.00251%]
[INFO] ** modbus_function_code:[0.02961:99.99641%,-33.760870000000004:0.00359%]
[INFO] ** modbus_function_description:[7:49.99875%,11:49.99767%,0:0.00359%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99803%,2:0.00197%]
[INFO] ** proto:[0:99.99713%,1:0.00251%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.00689%,20:26.12815%,13:18.23659%,6:17.62461%,17:0.00251%,1:0.00036%,21:0.00018%,16:0.00018%,7:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.12761%,-0.32151:20.76894%,-1.27613:18.23641%,-0.23351:17.62425%,-0.33484:17.23795%,-71.33197:0.00251%,-0.24151:0.00036%,1.45709:0.00036%,1.47576:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,2.22906:0.00018%,14.4699:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.12725%,1:20.76876%,5:18.23623%,4:17.62425%,2:17.23795%,0:0.00556%]
[INFO] ** service:[0.0048200000000000005:99.99677%,-211.73542999999998:0.00251%,-183.8612:0.00018%,-211.08346:0.00018%,-211.35747999999998:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.00689%,9:26.12815%,7:18.23659%,1:17.62461%,21:0.00215%,14:0.00054%,3:0.00036%,16:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1526 (0.27354%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1156 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.5413 - val_tp: 16070.0000 - val_fp: 3930.0000 - val_tn: 76070.0000 - val_fn: 3930.0000 - val_accuracy: 0.9214 - val_precision: 0.8035 - val_recall: 0.8035 - val_auc: 0.9509
[INFO] saving weights to checkpoints/lstm-epoch-2-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8346 - tp: 51296.0000 - fp: 28704.0000 - tn: 291296.0000 - fn: 28704.0000 - accuracy: 0.8565 - precision: 0.6412 - recall: 0.6412 - auc: 0.9102 - val_loss: 0.7681 - val_tp: 12850.0000 - val_fp: 7150.0000 - val_tn: 72850.0000 - val_fn: 7150.0000 - val_accuracy: 0.8570 - val_precision: 0.6425 - val_recall: 0.6425 - val_auc: 0.9106
[INFO] saving weights to checkpoints/lstm-epoch-2-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5150 - tp: 63439.0000 - fp: 16561.0000 - tn: 303439.0000 - fn: 16561.0000 - accuracy: 0.9172 - precision: 0.7930 - recall: 0.7930 - auc: 0.9479 - val_loss: 0.1935 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1608 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1321 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1130 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0968 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 6-6/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99588%,30:0.00323%,31:0.00018%,27:0.00018%,26:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:92.75717%,Single Stage Single Point:7.24283%]
[INFO] ** dst:[21:43.37471%,10:20.73129%,8:18.27871%,9:17.61045%,15:0.00323%,22:0.00054%,25:0.00018%,24:0.00018%,18:0.00018%,12:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99695%,0:0.00305%]
[INFO] ** i/f_name:[2:99.99677%,3:0.00323%]
[INFO] ** modbus_function_code:[0.02961:99.99588%,-33.760870000000004:0.00412%]
[INFO] ** modbus_function_description:[7:49.99857%,11:49.99731%,0:0.00412%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99964%,1:0.00036%]
[INFO] ** proto:[0:99.99588%,1:0.00323%,2:0.0009%]
[INFO] ** proxy_src_ip:[18:37.94057%,20:26.16561%,13:18.27889%,6:17.61063%,17:0.00323%,14:0.00054%,16:0.00036%,11:0.00018%]
[INFO] ** s_port:[1.45442:26.16525%,-0.32151:20.73129%,-1.27613:18.27836%,-0.23351:17.61027%,-0.33484:17.20927%,-71.33197:0.00323%,-1.02014:0.00036%,-71.14798:0.00018%,-64.19493:0.00018%,4.90362:0.00018%,-1.2708:0.00018%,-0.24151:0.00018%,13.431270000000001:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-68.36943000000001:0.00018%]
[INFO] ** scada_tag:[3:26.16507%,1:20.73093%,5:18.27818%,4:17.60991%,2:17.20909%,0:0.00681%]
[INFO] ** service:[0.0048200000000000005:99.99588%,-211.73542999999998:0.00323%,-211.08346:0.00018%,-201.23771000000002:0.00018%,-202.75898:0.00018%,-186.44547:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:37.94057%,9:26.16561%,7:18.27889%,1:17.61063%,14:0.00323%,2:0.00054%,15:0.00036%,10:0.00018%]
[INFO] ** type:[0:99.9991%,1:0.0009%]
[INFO] ** unixtime:1527 (0.27372%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0850 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0746 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0666 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0594 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0536 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0483 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0440 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0400 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5094 - tp: 67635.0000 - fp: 12365.0000 - tn: 307635.0000 - fn: 12365.0000 - accuracy: 0.9382 - precision: 0.8454 - recall: 0.8454 - auc: 0.9614 - val_loss: 1.0476 - val_tp: 12788.0000 - val_fp: 7212.0000 - val_tn: 72788.0000 - val_fn: 7212.0000 - val_accuracy: 0.8558 - val_precision: 0.6394 - val_recall: 0.6394 - val_auc: 0.9098
[INFO] saving weights to checkpoints/lstm-epoch-2-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 7-7/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99534%,30:0.00161%,22:0.0009%,17:0.00072%,26:0.00054%,31:0.00036%,28:0.00018%,27:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:80.77535%,Single Stage Single Point:19.22465%]
[INFO] ** dst:[21:43.36037%,10:20.74438%,8:18.25021%,9:17.63859%,15:0.00161%,22:0.00143%,6:0.00143%,16:0.00072%,24:0.00036%,18:0.00036%,17:0.00036%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99839%,0:0.00161%]
[INFO] ** i/f_name:[2:99.99839%,3:0.00161%]
[INFO] ** modbus_function_code:[0.02961:99.99534%,-33.760870000000004:0.00466%]
[INFO] ** modbus_function_description:[7:49.99839%,11:49.99695%,0:0.00466%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99641%,2:0.00197%,1:0.00161%]
[INFO] ** proxy_src_ip:[18:37.96817%,20:26.13729%,13:18.25057%,6:17.63877%,17:0.00161%,11:0.00072%,1:0.00072%,21:0.00054%,16:0.00054%,14:0.00036%,7:0.00036%,10:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13639%,-0.32151:20.74438%,-1.27613:18.25003%,-0.23351:17.63841%,-0.33484:17.22379%,-71.33197:0.00161%,-71.14931:0.0009%,-1.02014:0.00054%,-71.14798:0.00054%,1.45709:0.00054%,-0.24151:0.00036%,-1.27347:0.00036%,1.47576:0.00018%,1.46509:0.00018%,14.253910000000001:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,-68.79874000000001:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,6.1115699999999995:0.00018%,-5.08665:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:26.13603%,1:20.74438%,5:18.24985%,4:17.63823%,2:17.22379%,0:0.00771%]
[INFO] ** service:[0.0048200000000000005:99.99534%,-211.73542999999998:0.00161%,-211.08818:0.0009%,-205.44247:0.00072%,-211.08346:0.00054%,-186.43601999999998:0.00036%,-211.09762999999998:0.00018%,-185.9872:0.00018%,-202.75898:0.00018%]
[INFO] ** src:[22:37.96817%,9:26.13729%,7:18.25057%,1:17.63877%,14:0.00161%,10:0.00072%,3:0.00072%,15:0.00054%,4:0.00054%,21:0.00036%,2:0.00036%,11:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1524 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.9045 - tp: 51237.0000 - fp: 28763.0000 - tn: 291237.0000 - fn: 28763.0000 - accuracy: 0.8562 - precision: 0.6405 - recall: 0.6405 - auc: 0.9102 - val_loss: 0.7998 - val_tp: 12774.0000 - val_fp: 7226.0000 - val_tn: 72774.0000 - val_fn: 7226.0000 - val_accuracy: 0.8555 - val_precision: 0.6387 - val_recall: 0.6387 - val_auc: 0.9097
[INFO] saving weights to checkpoints/lstm-epoch-2-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2277 - tp: 75039.0000 - fp: 4961.0000 - tn: 315039.0000 - fn: 4961.0000 - accuracy: 0.9752 - precision: 0.9380 - recall: 0.9380 - auc: 0.9898 - val_loss: 0.0916 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1042 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9981 - val_loss: 0.3985 - val_tp: 19583.0000 - val_fp: 417.0000 - val_tn: 79583.0000 - val_fn: 417.0000 - val_accuracy: 0.9917 - val_precision: 0.9791 - val_recall: 0.9791 - val_auc: 0.9836
[INFO] saving weights to checkpoints/lstm-epoch-2-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2324 - tp: 78570.0000 - fp: 1430.0000 - tn: 318570.0000 - fn: 1430.0000 - accuracy: 0.9929 - precision: 0.9821 - recall: 0.9821 - auc: 0.9890 - val_loss: 0.0543 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0486 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0388 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 8-8/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99713%,30:0.00108%,0:0.00054%,24:0.00018%,23:0.00018%,22:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.87723%,Single Stage Single Point:5.12277%]
[INFO] ** dst:[21:43.42095%,10:20.80335%,8:18.19034%,9:17.58177%,22:0.00125%,15:0.00108%,25:0.00054%,19:0.00036%,26:0.00018%,24:0.00018%]
[INFO] ** i/f_dir:[1:99.99928%,0:0.00072%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99713%,-33.760870000000004:0.00269%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99749%,0:0.00269%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99964%,2:0.00036%]
[INFO] ** proto:[0:99.99821%,1:0.00108%,2:0.00072%]
[INFO] ** proxy_src_ip:[18:38.08863%,20:26.13621%,13:18.18962%,6:17.58213%,17:0.00108%,10:0.00108%,16:0.00054%,14:0.00036%,11:0.00018%,5:0.00018%]
[INFO] ** s_port:[1.45442:26.13568%,-0.32151:20.80335%,-1.27613:18.18944%,-0.23351:17.58159%,-0.33484:17.28528%,-71.33197:0.00108%,-15.039579999999999:0.00072%,-1.02014:0.00054%,-64.19493:0.00054%,1.45709:0.00036%,-0.24151:0.00036%,4.66896:0.00036%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.13514%,1:20.80317%,5:18.18944%,4:17.58141%,2:17.2851%,0:0.00574%]
[INFO] ** service:[0.0048200000000000005:99.99785%,-211.73542999999998:0.00108%,-186.44547:0.00054%,-211.07873999999998:0.00036%,-211.08818:0.00018%]
[INFO] ** src:[22:38.08863%,9:26.13621%,7:18.18962%,1:17.58213%,11:0.00108%,14:0.00072%,15:0.00054%,21:0.00036%,2:0.00036%,16:0.00018%,10:0.00018%]
[INFO] ** type:[0:99.99946%,1:0.00036%,2:0.00018%]
[INFO] ** unixtime:1528 (0.2739%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0218 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0030 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0047 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0016 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0036 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.8573e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0028 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8939e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7440 - tp: 65548.0000 - fp: 14452.0000 - tn: 305548.0000 - fn: 14452.0000 - accuracy: 0.9277 - precision: 0.8194 - recall: 0.8194 - auc: 0.9496 - val_loss: 0.4988 - val_tp: 16358.0000 - val_fp: 3642.0000 - val_tn: 76358.0000 - val_fn: 3642.0000 - val_accuracy: 0.9272 - val_precision: 0.8179 - val_recall: 0.8179 - val_auc: 0.9782
[INFO] saving weights to checkpoints/lstm-epoch-2-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 9-9/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99821%,30:0.00108%,31:0.00036%,26:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:94.62824%,Single Stage Single Point:5.37176%]
[INFO] ** dst:[21:43.37327%,10:20.77055%,8:18.27979%,9:17.57352%,15:0.00108%,22:0.0009%,18:0.00036%,25:0.00018%,24:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99821%,-33.760870000000004:0.00179%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99821%,0:0.00179%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99964%,2:0.00036%]
[INFO] ** proto:[0:99.99821%,1:0.00108%,2:0.00072%]
[INFO] ** proxy_src_ip:[18:38.00653%,20:26.13783%,13:18.27979%,6:17.57388%,17:0.00108%,21:0.00018%,16:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13711%,-0.32151:20.77055%,-1.27613:18.27943%,-0.23351:17.57334%,-0.33484:17.23598%,-71.33197:0.00108%,-0.24151:0.00036%,1.45709:0.00036%,-0.08551:0.00036%,1.46509:0.00018%,1.47576:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.13675%,1:20.77037%,5:18.27943%,4:17.57316%,2:17.2358%,0:0.00448%]
[INFO] ** service:[0.0048200000000000005:99.99821%,-211.73542999999998:0.00108%,-186.43601999999998:0.00036%,-211.08346:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.00653%,9:26.13783%,7:18.27979%,1:17.57388%,14:0.00072%,21:0.00036%,17:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1528 (0.2739%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4769 - tp: 65445.0000 - fp: 14555.0000 - tn: 305445.0000 - fn: 14555.0000 - accuracy: 0.9272 - precision: 0.8181 - recall: 0.8181 - auc: 0.9683 - val_loss: 0.4494 - val_tp: 16348.0000 - val_fp: 3652.0000 - val_tn: 76348.0000 - val_fn: 3652.0000 - val_accuracy: 0.9270 - val_precision: 0.8174 - val_recall: 0.8174 - val_auc: 0.9848
[INFO] saving weights to checkpoints/lstm-epoch-2-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3443 - tp: 68238.0000 - fp: 11762.0000 - tn: 308238.0000 - fn: 11762.0000 - accuracy: 0.9412 - precision: 0.8530 - recall: 0.8530 - auc: 0.9864 - val_loss: 0.0781 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0194 - tp: 79994.0000 - fp: 6.0000 - tn: 319994.0000 - fn: 6.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 4.1315e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0074 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1579e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0065 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.9651e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 10-10/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99624%,30:0.00179%,31:0.00036%,26:0.00018%,24:0.00018%,23:0.00018%,22:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:94.52391%,Single Stage Single Point:5.47609%]
[INFO] ** dst:[21:43.41181%,10:20.80586%,8:18.22565%,9:17.55273%,15:0.00179%,22:0.00054%,24:0.00036%,19:0.00036%,18:0.00036%,26:0.00018%,25:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99839%,0:0.00161%]
[INFO] ** i/f_name:[2:99.99821%,3:0.00179%]
[INFO] ** modbus_function_code:[0.02961:99.99624%,-33.760870000000004:0.00359%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99892%,11:49.99731%,0:0.00359%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99928%,1:0.00072%]
[INFO] ** proto:[0:99.99731%,1:0.00179%,2:0.0009%]
[INFO] ** proxy_src_ip:[18:38.08325%,20:26.13496%,13:18.22583%,6:17.55201%,17:0.00179%,10:0.0009%,14:0.00036%,21:0.00018%,16:0.00018%,5:0.00018%,2:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13424%,-0.32151:20.80586%,-1.27613:18.2253%,-0.23351:17.55165%,-0.33484:17.27739%,-71.33197:0.00179%,-10.51843:0.00072%,-0.08551:0.00036%,-1.27347:0.00036%,5.71692:0.00036%,1.47576:0.00036%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-71.14931:0.00018%,-64.19493:0.00018%,1.45709:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.13388%,1:20.80568%,5:18.2253%,4:17.55147%,2:17.27721%,0:0.00645%]
[INFO] ** service:[0.0048200000000000005:99.99695%,-211.73542999999998:0.00179%,-211.07873999999998:0.00036%,-186.43601999999998:0.00036%,-211.08346:0.00018%,-186.44547:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.08325%,9:26.13496%,7:18.22583%,1:17.55201%,14:0.00179%,11:0.0009%,2:0.00036%,17:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%]
[INFO] ** type:[0:99.99857%,1:0.00125%,2:0.00018%]
[INFO] ** unixtime:1524 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0063 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5341e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0056 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4523e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4469 - tp: 64800.0000 - fp: 15200.0000 - tn: 304800.0000 - fn: 15200.0000 - accuracy: 0.9240 - precision: 0.8100 - recall: 0.8100 - auc: 0.9762 - val_loss: 0.4495 - val_tp: 12851.0000 - val_fp: 7149.0000 - val_tn: 72851.0000 - val_fn: 7149.0000 - val_accuracy: 0.8570 - val_precision: 0.6425 - val_recall: 0.6425 - val_auc: 0.9680
[INFO] saving weights to checkpoints/lstm-epoch-2-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2271 - tp: 71800.0000 - fp: 8200.0000 - tn: 311800.0000 - fn: 8200.0000 - accuracy: 0.9590 - precision: 0.8975 - recall: 0.8975 - auc: 0.9901 - val_loss: 0.1149 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0342 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3335e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 11-11/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99892%,31:0.00036%,30:0.00036%,26:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.38833%,10:20.87559%,8:18.19787%,9:17.53588%,22:0.00125%,18:0.00036%,15:0.00036%,25:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99964%,3:0.00036%]
[INFO] ** modbus_function_code:[0.02961:99.99892%,-33.760870000000004:0.00108%]
[INFO] ** modbus_function_description:[7:50.00054%,11:49.99839%,0:0.00108%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99892%,2:0.00072%,1:0.00036%]
[INFO] ** proxy_src_ip:[18:38.14689%,20:26.11739%,13:18.19787%,6:17.53624%,16:0.00054%,17:0.00036%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.11685%,-0.32151:20.87559%,-1.27613:18.19769%,-0.23351:17.5357%,-0.33484:17.2713%,-0.24151:0.00054%,-1.02014:0.00054%,-0.08551:0.00036%,-71.33197:0.00036%,-71.14798:0.00018%,1.45709:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:26.11649%,1:20.87559%,5:18.19751%,4:17.53534%,2:17.27112%,0:0.00394%]
[INFO] ** service:[0.0048200000000000005:99.99892%,-211.73542999999998:0.00036%,-186.43601999999998:0.00036%,-211.08346:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.14689%,9:26.11739%,7:18.19787%,1:17.53624%,15:0.00054%,14:0.00036%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1525 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0090 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7552e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0078 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7481e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0072 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0112e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0067 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3210e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0060 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9782e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 12-12/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99785%,30:0.00197%,9:0.00018%]
[INFO] ** classification:[normal:93.51255%,Single Stage Single Point:6.48745%]
[INFO] ** dst:[21:43.40159%,10:20.88312%,8:18.18066%,9:17.53158%,15:0.00197%,22:0.00054%,24:0.00036%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99839%,0:0.00161%]
[INFO] ** i/f_name:[2:99.99803%,3:0.00197%]
[INFO] ** modbus_function_code:[0.02961:99.99785%,-33.760870000000004:0.00215%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99821%,0:0.00215%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99839%,2:0.00161%]
[INFO] ** proto:[0:99.99803%,1:0.00197%]
[INFO] ** proxy_src_ip:[18:38.15496%,20:26.13012%,13:18.18084%,6:17.53176%,17:0.00197%,16:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:26.12958%,-0.32151:20.88312%,-1.27613:18.1803%,-0.23351:17.5314%,-0.33484:17.27183%,-71.33197:0.00197%,-1.27347:0.00036%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:26.12922%,1:20.88312%,5:18.1803%,4:17.53104%,2:17.27183%,0:0.00448%]
[INFO] ** service:[0.0048200000000000005:99.99785%,-211.73542999999998:0.00197%,-183.8612:0.00018%]
[INFO] ** src:[22:38.15496%,9:26.13012%,7:18.18084%,1:17.53176%,21:0.00161%,14:0.00036%,15:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1525 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0056 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7960e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0049 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9827e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3497 - tp: 68761.0000 - fp: 11239.0000 - tn: 308761.0000 - fn: 11239.0000 - accuracy: 0.9438 - precision: 0.8595 - recall: 0.8595 - auc: 0.9830 - val_loss: 0.4692 - val_tp: 12822.0000 - val_fp: 7178.0000 - val_tn: 72822.0000 - val_fn: 7178.0000 - val_accuracy: 0.8564 - val_precision: 0.6411 - val_recall: 0.6411 - val_auc: 0.9678
[INFO] saving weights to checkpoints/lstm-epoch-2-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2976 - tp: 62224.0000 - fp: 17776.0000 - tn: 302224.0000 - fn: 17776.0000 - accuracy: 0.9111 - precision: 0.7778 - recall: 0.7778 - auc: 0.9789 - val_loss: 0.2198 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0682 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.6734e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 13-13/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99659%,31:0.00072%,26:0.00054%,0:0.00054%,30:0.00036%,22:0.00036%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:86.2846%,Single Stage Single Point:13.7154%]
[INFO] ** dst:[21:43.35535%,10:20.80622%,8:18.28033%,9:17.55416%,22:0.00108%,6:0.0009%,18:0.00072%,25:0.00054%,15:0.00036%,24:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99964%,3:0.00036%]
[INFO] ** modbus_function_code:[0.02961:99.99659%,-33.760870000000004:0.00323%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99892%,11:49.99767%,0:0.00323%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99731%,2:0.00233%,1:0.00036%]
[INFO] ** proxy_src_ip:[18:38.05403%,20:26.10789%,13:18.28051%,6:17.55362%,10:0.00108%,11:0.0009%,16:0.00054%,17:0.00036%,7:0.00036%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.10735%,-0.32151:20.80622%,-1.27613:18.28015%,-0.23351:17.55327%,-0.33484:17.24781%,-9.78512:0.00072%,-64.19493:0.00054%,-1.02014:0.00054%,-71.14798:0.00054%,-0.24151:0.00036%,-71.14931:0.00036%,-0.08551:0.00036%,-71.33197:0.00036%,1.47576:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,-68.79874000000001:0.00018%,6.1115699999999995:0.00018%,14.540560000000001:0.00018%,1.45709:0.00018%]
[INFO] ** scada_tag:[3:26.10699%,1:20.80604%,5:18.28015%,4:17.55327%,2:17.24763%,0:0.00592%]
[INFO] ** service:[0.0048200000000000005:99.99731%,-186.43601999999998:0.00072%,-211.08346:0.00054%,-186.44547:0.00054%,-211.73542999999998:0.00036%,-211.08818:0.00036%,-202.75898:0.00018%]
[INFO] ** src:[22:38.05403%,9:26.10789%,7:18.28051%,1:17.55362%,11:0.00108%,10:0.0009%,15:0.00054%,21:0.00036%,14:0.00036%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1525 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0140 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4752e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0126 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.2904e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0112 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1969e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3543 - tp: 67144.0000 - fp: 12856.0000 - tn: 307144.0000 - fn: 12856.0000 - accuracy: 0.9357 - precision: 0.8393 - recall: 0.8393 - auc: 0.9806 - val_loss: 0.3589 - val_tp: 12833.0000 - val_fp: 7167.0000 - val_tn: 72833.0000 - val_fn: 7167.0000 - val_accuracy: 0.8567 - val_precision: 0.6417 - val_recall: 0.6417 - val_auc: 0.9679
[INFO] saving weights to checkpoints/lstm-epoch-2-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2522 - tp: 68712.0000 - fp: 11288.0000 - tn: 308712.0000 - fn: 11288.0000 - accuracy: 0.9436 - precision: 0.8589 - recall: 0.8589 - auc: 0.9881 - val_loss: 0.1593 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 14-14/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99964%,30:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:93.16856%,Single Stage Single Point:6.83144%]
[INFO] ** dst:[21:43.35086%,10:20.81303%,8:18.26151%,9:17.57316%,22:0.00072%,24:0.00036%,15:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.99982%,3:0.00018%]
[INFO] ** modbus_function_code:[0.02961:99.99964%,-33.760870000000004:0.00036%]
[INFO] ** modbus_function_description:[7:50.00054%,11:49.9991%,0:0.00036%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,1:0.00018%]
[INFO] ** proxy_src_ip:[18:38.05296%,20:26.11148%,13:18.26168%,6:17.57334%,17:0.00018%,16:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:26.11076%,-0.32151:20.81303%,-1.27613:18.26115%,-0.23351:17.57298%,-0.33484:17.23993%,-1.27347:0.00036%,1.45709:0.00036%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%,-71.33197:0.00018%]
[INFO] ** scada_tag:[3:26.1104%,1:20.81303%,5:18.26097%,4:17.57263%,2:17.23975%,0:0.00323%]
[INFO] ** service:[0.0048200000000000005:99.99964%,-183.8612:0.00018%,-211.73542999999998:0.00018%]
[INFO] ** src:[22:38.05296%,9:26.11148%,7:18.26168%,1:17.57334%,15:0.00018%,14:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1524 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1533 - tp: 78353.0000 - fp: 1647.0000 - tn: 318353.0000 - fn: 1647.0000 - accuracy: 0.9918 - precision: 0.9794 - recall: 0.9794 - auc: 0.9981 - val_loss: 0.1014 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2236 - tp: 70470.0000 - fp: 9530.0000 - tn: 310470.0000 - fn: 9530.0000 - accuracy: 0.9523 - precision: 0.8809 - recall: 0.8809 - auc: 0.9922 - val_loss: 0.0347 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0401 - tp: 77474.0000 - fp: 2526.0000 - tn: 317474.0000 - fn: 2526.0000 - accuracy: 0.9874 - precision: 0.9684 - recall: 0.9684 - auc: 0.9997 - val_loss: 2.9546e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0302 - tp: 77592.0000 - fp: 2408.0000 - tn: 317592.0000 - fn: 2408.0000 - accuracy: 0.9880 - precision: 0.9699 - recall: 0.9699 - auc: 0.9998 - val_loss: 7.4416e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0285 - tp: 77495.0000 - fp: 2505.0000 - tn: 317495.0000 - fn: 2505.0000 - accuracy: 0.9875 - precision: 0.9687 - recall: 0.9687 - auc: 0.9998 - val_loss: 2.7181e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 15-15/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99624%,30:0.00305%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:90.0997%,Single Stage Multi Point:9.89958%,Single Stage Single Point:0.00072%]
[INFO] ** dst:[21:43.30229%,10:20.77682%,8:18.31528%,9:17.60023%,15:0.00305%,22:0.00161%,25:0.00018%,24:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99713%,0:0.00287%]
[INFO] ** i/f_name:[2:99.99695%,3:0.00305%]
[INFO] ** modbus_function_code:[0.02961:99.99624%,-33.760870000000004:0.00376%]
[INFO] ** modbus_function_description:[7:49.9991%,11:49.99713%,0:0.00376%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99731%,2:0.00269%]
[INFO] ** proto:[0:99.99659%,1:0.00305%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.01012%,20:26.06971%,13:18.31492%,6:17.60077%,17:0.00305%,16:0.00072%,7:0.00036%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.06881%,-0.32151:20.77664%,-1.27613:18.31474%,-0.23351:17.60005%,-0.33484:17.23347%,-71.33197:0.00305%,-1.02014:0.00072%,-0.24151:0.00054%,1.46509:0.00036%,1.45709:0.00036%,1.47576:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-61.95768:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.06845%,1:20.77646%,5:18.31474%,4:17.59969%,2:17.23329%,0:0.00735%]
[INFO] ** service:[0.0048200000000000005:99.99641%,-211.73542999999998:0.00305%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.01012%,9:26.06971%,7:18.31492%,1:17.60077%,21:0.00305%,15:0.00072%,14:0.00036%,16:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1533 (0.2748%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0253 - tp: 77561.0000 - fp: 2439.0000 - tn: 317561.0000 - fn: 2439.0000 - accuracy: 0.9878 - precision: 0.9695 - recall: 0.9695 - auc: 0.9998 - val_loss: 1.5461e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0234 - tp: 77502.0000 - fp: 2498.0000 - tn: 317502.0000 - fn: 2498.0000 - accuracy: 0.9875 - precision: 0.9688 - recall: 0.9688 - auc: 0.9997 - val_loss: 8.4492e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0217 - tp: 79793.0000 - fp: 207.0000 - tn: 319793.0000 - fn: 207.0000 - accuracy: 0.9990 - precision: 0.9974 - recall: 0.9974 - auc: 1.0000 - val_loss: 5.3924e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0183 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7683e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.7974 - tp: 61216.0000 - fp: 18784.0000 - tn: 301216.0000 - fn: 18784.0000 - accuracy: 0.9061 - precision: 0.7652 - recall: 0.7652 - auc: 0.8521 - val_loss: 7.5199 - val_tp: 10669.0000 - val_fp: 9331.0000 - val_tn: 70669.0000 - val_fn: 9331.0000 - val_accuracy: 0.8134 - val_precision: 0.5335 - val_recall: 0.5335 - val_auc: 0.7084
[INFO] saving weights to checkpoints/lstm-epoch-2-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 16-16/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (497552, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (497552, 17)

[INFO] analyzing data
[INFO] 497552 rows
[INFO] ** appi_name:[21:99.99819%,30:0.00161%,33:0.0002%]
[INFO] ** classification:[normal:80.78191%,Single Stage Multi Point:19.21809%]
[INFO] ** dst:[21:43.35004%,10:20.79541%,8:18.25819%,9:17.59334%,15:0.00161%,22:0.00121%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.99839%,0:0.00161%]
[INFO] ** i/f_name:[2:99.99839%,3:0.00161%]
[INFO] ** modbus_function_code:[0.02961:99.99819%,-33.760870000000004:0.00181%]
[INFO] ** modbus_function_description:[7:50.0004%,11:49.99779%,0:0.00181%]
[INFO] ** modbus_transaction_id:65536 (13.17169%)
[INFO] ** orig:[0:99.99839%,2:0.00161%]
[INFO] ** proto:[0:99.99839%,1:0.00161%]
[INFO] ** proxy_src_ip:[18:38.04205%,20:26.1036%,13:18.25859%,6:17.59354%,17:0.00161%,16:0.0004%,21:0.0002%]
[INFO] ** s_port:[1.45442:26.103%,-0.32151:20.79521%,-1.27613:18.25819%,-0.23351:17.59314%,-0.33484:17.24684%,-71.33197:0.00161%,1.45709:0.0004%,-0.24151:0.0004%,-1.02014:0.0004%,-1.27347:0.0002%,1.47576:0.0002%,-49.275529999999996:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:26.1026%,1:20.79501%,5:18.25799%,4:17.59273%,2:17.24664%,0:0.00502%]
[INFO] ** service:[0.0048200000000000005:99.99839%,-211.73542999999998:0.00161%]
[INFO] ** src:[22:38.04205%,9:26.1036%,7:18.25859%,1:17.59354%,21:0.00161%,15:0.0004%,4:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1362 (0.27374%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/497552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5718 - tp: 42459.0000 - fp: 37541.0000 - tn: 282459.0000 - fn: 37541.0000 - accuracy: 0.8123 - precision: 0.5307 - recall: 0.5307 - auc: 0.7045 - val_loss: 7.5368 - val_tp: 10648.0000 - val_fp: 9352.0000 - val_tn: 70648.0000 - val_fn: 9352.0000 - val_accuracy: 0.8130 - val_precision: 0.5324 - val_recall: 0.5324 - val_auc: 0.7078
[INFO] saving weights to checkpoints/lstm-epoch-2-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/497552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5550 - tp: 42540.0000 - fp: 37460.0000 - tn: 282540.0000 - fn: 37460.0000 - accuracy: 0.8127 - precision: 0.5318 - recall: 0.5318 - auc: 0.7051 - val_loss: 7.5803 - val_tp: 10594.0000 - val_fp: 9406.0000 - val_tn: 70594.0000 - val_fn: 9406.0000 - val_accuracy: 0.8119 - val_precision: 0.5297 - val_recall: 0.5297 - val_auc: 0.7061
[INFO] saving weights to checkpoints/lstm-epoch-2-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/497552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3869 - tp: 78139.0000 - fp: 1861.0000 - tn: 318139.0000 - fn: 1861.0000 - accuracy: 0.9907 - precision: 0.9767 - recall: 0.9767 - auc: 0.9854 - val_loss: 1.7577e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/497552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0107 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5390e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/497552
[33m[INFO] loading file 17-17/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597552, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597552, 17)

[INFO] analyzing data
[INFO] 597552 rows
[INFO] ** appi_name:[21:99.99732%,7:0.0005%,26:0.00033%,0:0.00033%,33:0.00017%,31:0.00017%,27:0.00017%,24:0.00017%,22:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:94.83727%,Multi Stage Multi Point:5.16273%]
[INFO] ** dst:[21:43.35255%,10:20.83651%,8:18.2098%,9:17.5983%,22:0.00084%,6:0.0005%,25:0.00033%,16:0.00033%,2:0.00033%,24:0.00017%,18:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99732%,-33.760870000000004:0.00251%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99967%,11:49.99766%,0:0.00251%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (10.96741%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,2:0.00117%]
[INFO] ** proxy_src_ip:[18:38.07736%,20:26.11237%,13:18.20929%,6:17.59813%,10:0.001%,11:0.00084%,1:0.00033%,21:0.00017%,16:0.00017%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:26.11137%,-0.32151:20.83635%,-1.27613:18.20896%,-0.23351:17.59797%,-0.33484:17.24101%,6.0369:0.00067%,1.45709:0.0005%,1.47576:0.00033%,-71.14798:0.00033%,-64.19493:0.00033%,1.46509:0.00017%,-49.275529999999996:0.00017%,-1.27347:0.00017%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,-68.79874000000001:0.00017%,6.15557:0.00017%,6.06224:0.00017%,8.55414:0.00017%,-3.3787199999999995:0.00017%,-4.3880099999999995:0.00017%,-71.14931:0.00017%]
[INFO] ** scada_tag:[3:26.1112%,1:20.83618%,5:18.20879%,4:17.59746%,2:17.24101%,0:0.00536%]
[INFO] ** service:[0.0048200000000000005:99.99816%,-211.09762999999998:0.0005%,-211.08346:0.00033%,-186.44547:0.00033%,-211.35747999999998:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.07736%,9:26.11237%,7:18.20929%,1:17.59813%,11:0.001%,10:0.00084%,3:0.00033%,21:0.00017%,15:0.00017%,4:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1632 (0.27311%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0089 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4243e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0078 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.0457e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0068 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3053e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1697 - tp: 79186.0000 - fp: 814.0000 - tn: 319186.0000 - fn: 814.0000 - accuracy: 0.9959 - precision: 0.9898 - recall: 0.9898 - auc: 0.9936 - val_loss: 2.9778 - val_tp: 16305.0000 - val_fp: 3695.0000 - val_tn: 76305.0000 - val_fn: 3695.0000 - val_accuracy: 0.9261 - val_precision: 0.8152 - val_recall: 0.8152 - val_auc: 0.8845
[INFO] saving weights to checkpoints/lstm-epoch-2-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9278 - tp: 65489.0000 - fp: 14511.0000 - tn: 305489.0000 - fn: 14511.0000 - accuracy: 0.9274 - precision: 0.8186 - recall: 0.8186 - auc: 0.8859 - val_loss: 2.8988 - val_tp: 16403.0000 - val_fp: 3597.0000 - val_tn: 76403.0000 - val_fn: 3597.0000 - val_accuracy: 0.9281 - val_precision: 0.8202 - val_recall: 0.8202 - val_auc: 0.8876
[INFO] saving weights to checkpoints/lstm-epoch-2-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/597552
[33m[INFO] loading file 18-18/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597552, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597552, 17)

[INFO] analyzing data
[INFO] 597552 rows
[INFO] ** appi_name:[21:99.99833%,30:0.0005%,7:0.0005%,31:0.00017%,27:0.00017%,22:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:82.38965%,Multi Stage Multi Point:17.61035%]
[INFO] ** dst:[21:43.34234%,10:20.83233%,8:18.25314%,9:17.56952%,22:0.00067%,15:0.0005%,24:0.00033%,16:0.00033%,2:0.00033%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.9995%,0:0.0005%]
[INFO] ** i/f_name:[2:99.9995%,3:0.0005%]
[INFO] ** modbus_function_code:[0.02961:99.99833%,-33.760870000000004:0.00167%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99833%,0:0.00167%]
[INFO] ** modbus_transaction_id:65536 (10.96741%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.999%,2:0.0005%,1:0.0005%]
[INFO] ** proxy_src_ip:[18:38.0797%,20:26.09547%,13:18.25347%,6:17.56968%,17:0.0005%,11:0.0005%,1:0.00033%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:26.0948%,-0.32151:20.83233%,-1.27613:18.25297%,-0.23351:17.56935%,-0.33484:17.24737%,-71.33197:0.0005%,-1.27347:0.00033%,1.45709:0.00033%,-0.24151:0.00033%,1.47576:0.00017%,1.46509:0.00017%,3.6236699999999997:0.00017%,-1.2708:0.00017%,-2.48275:0.00017%,6.06224:0.00017%,-3.3787199999999995:0.00017%,8.10082:0.00017%,6.45955:0.00017%,-71.14931:0.00017%]
[INFO] ** scada_tag:[3:26.09447%,1:20.83216%,5:18.2528%,4:17.56918%,2:17.2472%,0:0.00418%]
[INFO] ** service:[0.0048200000000000005:99.99833%,-211.09762999999998:0.0005%,-211.73542999999998:0.0005%,-211.35747999999998:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.0797%,9:26.09547%,7:18.25347%,1:17.56968%,14:0.0005%,10:0.0005%,3:0.00033%,21:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1632 (0.27311%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.6626 - tp: 71767.0000 - fp: 8233.0000 - tn: 311767.0000 - fn: 8233.0000 - accuracy: 0.9588 - precision: 0.8971 - recall: 0.8971 - auc: 0.9353 - val_loss: 1.2198e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.8138 - tp: 56121.0000 - fp: 23879.0000 - tn: 296121.0000 - fn: 23879.0000 - accuracy: 0.8806 - precision: 0.7015 - recall: 0.7015 - auc: 0.8123 - val_loss: 6.1080 - val_tp: 12421.0000 - val_fp: 7579.0000 - val_tn: 72421.0000 - val_fn: 7579.0000 - val_accuracy: 0.8484 - val_precision: 0.6211 - val_recall: 0.6211 - val_auc: 0.7632
[INFO] saving weights to checkpoints/lstm-epoch-2-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1405 - tp: 49533.0000 - fp: 30467.0000 - tn: 289533.0000 - fn: 30467.0000 - accuracy: 0.8477 - precision: 0.6192 - recall: 0.6192 - auc: 0.7605 - val_loss: 6.1329 - val_tp: 12390.0000 - val_fp: 7610.0000 - val_tn: 72390.0000 - val_fn: 7610.0000 - val_accuracy: 0.8478 - val_precision: 0.6195 - val_recall: 0.6195 - val_auc: 0.7622
[INFO] saving weights to checkpoints/lstm-epoch-2-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.5352 - tp: 52537.0000 - fp: 27463.0000 - tn: 292537.0000 - fn: 27463.0000 - accuracy: 0.8627 - precision: 0.6567 - recall: 0.6567 - auc: 0.7842 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0028 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/597552
[33m[INFO] loading file 19-19/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597552, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597552, 17)

[INFO] analyzing data
[INFO] 597552 rows
[INFO] ** appi_name:[21:99.99816%,26:0.00033%,0:0.00033%,31:0.00017%,27:0.00017%,24:0.00017%,22:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:88.02447%,Single Stage Multi Point:11.97553%]
[INFO] ** dst:[21:43.39037%,10:20.83233%,8:18.20411%,9:17.57069%,22:0.00117%,6:0.0005%,25:0.00033%,24:0.00017%,18:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99816%,-33.760870000000004:0.00167%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99816%,0:0.00167%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (10.96741%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,2:0.00117%]
[INFO] ** proxy_src_ip:[18:38.1217%,20:26.10116%,13:18.20411%,6:17.57069%,10:0.001%,11:0.00084%,16:0.0005%]
[INFO] ** s_port:[1.45442:26.10016%,-0.32151:20.83233%,-1.27613:18.20377%,-0.23351:17.57052%,-0.33484:17.28937%,-5.20264:0.00067%,1.45709:0.0005%,-1.02014:0.0005%,-64.19493:0.00033%,-71.14798:0.00033%,1.46509:0.00033%,-1.27347:0.00017%,-0.24151:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-71.14931:0.00017%,-68.79874000000001:0.00017%,0.75578:0.00017%]
[INFO] ** scada_tag:[3:26.09982%,1:20.83216%,5:18.2036%,4:17.57035%,2:17.28921%,0:0.00485%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.08346:0.00033%,-186.44547:0.00033%,-202.75898:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.1217%,9:26.10116%,7:18.20411%,1:17.57069%,11:0.001%,10:0.00084%,15:0.0005%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1634 (0.27345%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0023 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0021 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0018 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0016 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.3228 - tp: 43658.0000 - fp: 36342.0000 - tn: 283658.0000 - fn: 36342.0000 - accuracy: 0.8183 - precision: 0.5457 - recall: 0.5457 - auc: 0.7144 - val_loss: 9.8232 - val_tp: 7811.0000 - val_fp: 12189.0000 - val_tn: 67811.0000 - val_fn: 12189.0000 - val_accuracy: 0.7562 - val_precision: 0.3905 - val_recall: 0.3905 - val_auc: 0.6191
[INFO] saving weights to checkpoints/lstm-epoch-2-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/597552
[33m[INFO] loading file 20-20/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597552, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597552, 17)

[INFO] analyzing data
[INFO] 597552 rows
[INFO] ** appi_name:[21:99.99682%,30:0.00268%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:89.2883%,Single Stage Multi Point:10.7117%]
[INFO] ** dst:[21:43.42735%,10:20.8345%,8:18.15407%,9:17.57939%,15:0.00268%,22:0.00117%,24:0.00033%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99766%,0:0.00234%]
[INFO] ** i/f_name:[2:99.99732%,3:0.00268%]
[INFO] ** modbus_function_code:[0.02961:99.99682%,-33.760870000000004:0.00318%]
[INFO] ** modbus_function_description:[7:49.99967%,11:49.99716%,0:0.00318%]
[INFO] ** modbus_transaction_id:65536 (10.96741%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99682%,1:0.00268%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.11233%,20:26.15019%,13:18.15424%,6:17.57989%,17:0.00268%,14:0.0005%,16:0.00017%]
[INFO] ** s_port:[1.45442:26.14936%,-0.32151:20.8345%,-1.27613:18.15373%,-0.23351:17.57922%,-0.33484:17.27783%,-71.33197:0.00268%,1.45709:0.0005%,-0.24151:0.0005%,-1.27347:0.00033%,13.431270000000001:0.00017%,-1.2708:0.00017%,-1.02014:0.00017%,-71.14798:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:26.14885%,1:20.83434%,5:18.15373%,4:17.57889%,2:17.27766%,0:0.00653%]
[INFO] ** service:[0.0048200000000000005:99.99682%,-211.73542999999998:0.00268%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.11233%,9:26.15019%,7:18.15424%,1:17.57989%,14:0.00268%,2:0.0005%,15:0.00017%]
[INFO] ** type:[0:99.99967%,1:0.00033%]
[INFO] ** unixtime:1634 (0.27345%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.6407 - tp: 56971.0000 - fp: 23029.0000 - tn: 296971.0000 - fn: 23029.0000 - accuracy: 0.8849 - precision: 0.7121 - recall: 0.7121 - auc: 0.8190 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.9089 - tp: 75494.0000 - fp: 4506.0000 - tn: 315494.0000 - fn: 4506.0000 - accuracy: 0.9775 - precision: 0.9437 - recall: 0.9437 - auc: 0.9646 - val_loss: 2.9681 - val_tp: 16317.0000 - val_fp: 3683.0000 - val_tn: 76317.0000 - val_fn: 3683.0000 - val_accuracy: 0.9263 - val_precision: 0.8159 - val_recall: 0.8159 - val_auc: 0.8849
[INFO] saving weights to checkpoints/lstm-epoch-2-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9415 - tp: 65404.0000 - fp: 14596.0000 - tn: 305404.0000 - fn: 14596.0000 - accuracy: 0.9270 - precision: 0.8176 - recall: 0.8176 - auc: 0.8853 - val_loss: 2.9690 - val_tp: 16316.0000 - val_fp: 3684.0000 - val_tn: 76316.0000 - val_fn: 3684.0000 - val_accuracy: 0.9263 - val_precision: 0.8158 - val_recall: 0.8158 - val_auc: 0.8849
[INFO] saving weights to checkpoints/lstm-epoch-2-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9242 - tp: 65490.0000 - fp: 14510.0000 - tn: 305490.0000 - fn: 14510.0000 - accuracy: 0.9275 - precision: 0.8186 - recall: 0.8186 - auc: 0.8859 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.2421e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/597552
[33m[INFO] loading file 21-21/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597550, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597550, 17)

[INFO] analyzing data
[INFO] 597550 rows
[INFO] ** appi_name:[21:99.99632%,30:0.001%,7:0.0005%,26:0.00033%,22:0.00033%,0:0.00033%,31:0.00017%,27:0.00017%,24:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:98.97866%,Multi Stage Single Point:1.02134%]
[INFO] ** dst:[21:43.32809%,10:20.9723%,8:18.16199%,9:17.53309%,15:0.001%,22:0.00084%,24:0.00067%,6:0.00067%,25:0.00033%,16:0.00033%,2:0.00033%,18:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.999%,0:0.001%]
[INFO] ** i/f_name:[2:99.999%,3:0.001%]
[INFO] ** modbus_function_code:[0.02961:99.99632%,-33.760870000000004:0.00351%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99916%,11:49.99716%,0:0.00351%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (10.96745%)
[INFO] ** orig:[0:99.99933%,2:0.00067%]
[INFO] ** proto:[0:99.99766%,2:0.00134%,1:0.001%]
[INFO] ** proxy_src_ip:[18:38.30223%,20:25.99799%,13:18.16266%,6:17.53293%,17:0.001%,10:0.001%,11:0.00084%,16:0.0005%,1:0.00033%,21:0.00017%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.99732%,-0.32151:20.97163%,-1.27613:18.16183%,-0.23351:17.53276%,-0.33484:17.3306%,-71.33197:0.001%,-1.27347:0.00067%,-6.64392:0.00067%,-1.02014:0.0005%,-64.19493:0.00033%,-71.14931:0.00033%,-71.14798:0.00033%,1.47576:0.00033%,1.46509:0.00017%,-1.2708:0.00017%,6.62488:0.00017%,10.15141:0.00017%,-68.79874000000001:0.00017%,7.060860000000001:0.00017%,-3.3787199999999995:0.00017%,-2.2440900000000004:0.00017%,1.45709:0.00017%,-0.24151:0.00017%]
[INFO] ** scada_tag:[3:25.99682%,1:20.9713%,5:18.16166%,4:17.53242%,2:17.3306%,0:0.0072%]
[INFO] ** service:[0.0048200000000000005:99.99699%,-211.73542999999998:0.001%,-211.09762999999998:0.0005%,-211.08346:0.00033%,-186.44547:0.00033%,-211.08818:0.00033%,-211.35747999999998:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.30223%,9:25.99799%,7:18.16266%,1:17.53293%,11:0.001%,21:0.00084%,10:0.00084%,15:0.0005%,14:0.00033%,3:0.00033%,4:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1628 (0.27245%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597550
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.4583e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/597550
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.6981e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/597550
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.0339e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3421e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/597550
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.1498e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/597550
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.7442e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/597550
[33m[INFO] loading file 22-22/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (366591, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (366591, 17)

[INFO] analyzing data
[INFO] 366591 rows
[INFO] ** appi_name:[21:99.99291%,30:0.00627%,23:0.00027%,22:0.00027%,18:0.00027%]
[INFO] ** classification:[normal:63.84199%,Multi Stage Single Point:36.15801%]
[INFO] ** dst:[21:43.31912%,10:21.00679%,8:18.1011%,9:17.56481%,15:0.00627%,22:0.00109%,19:0.00055%,26:0.00027%]
[INFO] ** i/f_dir:[1:99.994%,0:0.006%]
[INFO] ** i/f_name:[2:99.99373%,3:0.006%,0:0.00027%]
[INFO] ** modbus_function_code:[0.02961:99.99291%,-33.760870000000004:0.00709%]
[INFO] ** modbus_function_description:[7:49.99714%,11:49.99577%,0:0.00709%]
[INFO] ** modbus_transaction_id:65534 (17.8766%)
[INFO] ** orig:[0:99.99509%,2:0.00436%,1:0.00055%]
[INFO] ** proto:[0:99.99345%,1:0.00627%,2:0.00027%]
[INFO] ** proxy_src_ip:[18:38.33018%,20:25.99655%,13:18.10055%,6:17.56562%,17:0.00627%,14:0.00055%,10:0.00027%]
[INFO] ** s_port:[1.45442:25.99573%,-0.32151:21.00679%,-1.27613:18.10055%,-0.23351:17.56481%,-0.33484:17.32339%,-71.33197:0.00627%,1.45709:0.00055%,-0.24151:0.00055%,7.228860000000001:0.00055%,-0.24950999999999998:0.00027%,1.46509:0.00027%,-71.14931:0.00027%]
[INFO] ** scada_tag:[3:25.99546%,1:21.00679%,5:18.10055%,4:17.56453%,2:17.32339%,0:0.00927%]
[INFO] ** service:[0.0048200000000000005:99.99291%,-211.73542999999998:0.00627%,-211.07873999999998:0.00055%,-211.08818:0.00027%]
[INFO] ** src:[22:38.33018%,9:25.99655%,7:18.10055%,1:17.56562%,21:0.00436%,14:0.00191%,2:0.00055%,11:0.00027%]
[INFO] ** type:[0:99.99836%,1:0.00164%]
[INFO] ** unixtime:1012 (0.27606%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/366591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.4358e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.8380 - val_tp: 12756.0000 - val_fp: 7244.0000 - val_tn: 72756.0000 - val_fn: 7244.0000 - val_accuracy: 0.8551 - val_precision: 0.6378 - val_recall: 0.6378 - val_auc: 0.7736
[INFO] saving weights to checkpoints/lstm-epoch-2-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/366591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5676 - tp: 42440.0000 - fp: 37560.0000 - tn: 282440.0000 - fn: 37560.0000 - accuracy: 0.8122 - precision: 0.5305 - recall: 0.5305 - auc: 0.7047 - val_loss: 7.5763 - val_tp: 10599.0000 - val_fp: 9401.0000 - val_tn: 70599.0000 - val_fn: 9401.0000 - val_accuracy: 0.8120 - val_precision: 0.5300 - val_recall: 0.5300 - val_auc: 0.7062
[INFO] saving weights to checkpoints/lstm-epoch-2-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/366591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5918 - tp: 42320.0000 - fp: 37680.0000 - tn: 282320.0000 - fn: 37680.0000 - accuracy: 0.8116 - precision: 0.5290 - recall: 0.5290 - auc: 0.7038 - val_loss: 7.5763 - val_tp: 10599.0000 - val_fp: 9401.0000 - val_tn: 70599.0000 - val_fn: 9401.0000 - val_accuracy: 0.8120 - val_precision: 0.5300 - val_recall: 0.5300 - val_auc: 0.7062
[INFO] saving weights to checkpoints/lstm-epoch-2-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/366591
[33m[INFO] loading file 23-23/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (566591, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (566591, 17)

[INFO] analyzing data
[INFO] 566591 rows
[INFO] ** appi_name:[21:99.99859%,30:0.00071%,31:0.00035%,33:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:92.88711%,Multi Stage Single Point:7.11289%]
[INFO] ** dst:[21:43.31978%,10:21.00104%,8:18.14342%,9:17.53311%,22:0.00106%,15:0.00071%,24:0.00035%,18:0.00035%,25:0.00018%]
[INFO] ** i/f_dir:[1:99.99929%,0:0.00071%]
[INFO] ** i/f_name:[2:99.99929%,3:0.00071%]
[INFO] ** modbus_function_code:[0.02961:99.99859%,-33.760870000000004:0.00141%]
[INFO] ** modbus_function_description:[7:50.00026%,11:49.99832%,0:0.00141%]
[INFO] ** modbus_transaction_id:65536 (11.56672%)
[INFO] ** orig:[0:99.99947%,2:0.00053%]
[INFO] ** proto:[0:99.99876%,1:0.00071%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.33541%,20:25.98594%,13:18.14342%,6:17.53328%,17:0.00071%,16:0.00053%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98506%,-0.32151:21.00086%,-1.27613:18.14289%,-0.23351:17.53293%,-0.33484:17.33455%,-71.33197:0.00071%,-1.02014:0.00053%,-0.08551:0.00035%,-1.27347:0.00035%,1.45709:0.00035%,1.46509:0.00035%,-0.24151:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:25.98471%,1:21.00086%,5:18.14272%,4:17.53275%,2:17.33437%,0:0.00459%]
[INFO] ** service:[0.0048200000000000005:99.99876%,-211.73542999999998:0.00071%,-186.43601999999998:0.00035%,-186.44547:0.00018%]
[INFO] ** src:[22:38.33541%,9:25.98594%,7:18.14342%,1:17.53328%,21:0.00053%,15:0.00053%,17:0.00018%,14:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1543 (0.27233%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5686 - tp: 42435.0000 - fp: 37565.0000 - tn: 282435.0000 - fn: 37565.0000 - accuracy: 0.8122 - precision: 0.5304 - recall: 0.5304 - auc: 0.7047 - val_loss: 2.2050 - val_tp: 17264.0000 - val_fp: 2736.0000 - val_tn: 77264.0000 - val_fn: 2736.0000 - val_accuracy: 0.9453 - val_precision: 0.8632 - val_recall: 0.8632 - val_auc: 0.9145
[INFO] saving weights to checkpoints/lstm-epoch-2-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.3172e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.9833e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.7544e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.5386e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/566591
[33m[INFO] loading file 24-24/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (566591, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (566591, 17)

[INFO] analyzing data
[INFO] 566591 rows
[INFO] ** appi_name:[21:99.99347%,30:0.00318%,26:0.00053%,31:0.00035%,27:0.00035%,22:0.00035%,0:0.00035%,24:0.00018%,23:0.00018%,19:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,11:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:95.50293%,Multi Stage Single Point:4.49707%]
[INFO] ** dst:[21:43.37079%,10:21.01781%,8:18.09648%,9:17.50804%,15:0.00318%,22:0.00106%,6:0.00071%,25:0.00035%,24:0.00035%,19:0.00035%,18:0.00035%,7:0.00035%,26:0.00018%]
[INFO] ** i/f_dir:[1:99.997%,0:0.003%]
[INFO] ** i/f_name:[2:99.99682%,3:0.00318%]
[INFO] ** modbus_function_code:[0.02961:99.99347%,-33.760870000000004:0.006%,-0.415:0.00018%,0.9188299999999999:0.00018%,0.47422:0.00018%]
[INFO] ** modbus_function_description:[7:49.99779%,11:49.99568%,0:0.006%,15:0.00018%,10:0.00018%,2:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.56672%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.99488%,1:0.00318%,2:0.00194%]
[INFO] ** proxy_src_ip:[18:38.40319%,20:25.98629%,13:18.0963%,6:17.50734%,17:0.00318%,10:0.00124%,14:0.00088%,11:0.00088%,21:0.00035%,16:0.00035%]
[INFO] ** s_port:[1.45442:25.98541%,-0.32151:21.01781%,-1.27613:18.09595%,-0.23351:17.50663%,-0.33484:17.38538%,-71.33197:0.00318%,-9.58113:0.00071%,-71.14798:0.00053%,-0.24950999999999998:0.00035%,-1.27347:0.00035%,1.45709:0.00035%,-0.24151:0.00035%,-1.02014:0.00035%,-31.55091:0.00035%,7.6315100000000005:0.00035%,-71.14931:0.00035%,-64.19493:0.00035%,1.47576:0.00035%,-68.79874000000001:0.00018%,1.46509:0.00018%,7.4901800000000005:0.00018%,13.431270000000001:0.00018%,11.862:0.00018%]
[INFO] ** scada_tag:[3:25.98523%,1:21.01781%,5:18.09577%,4:17.50628%,2:17.3852%,0:0.00971%]
[INFO] ** service:[0.0048200000000000005:99.99453%,-211.73542999999998:0.00318%,-211.08346:0.00053%,-211.07873999999998:0.00035%,-202.75898:0.00035%,-186.44547:0.00035%,-186.43601999999998:0.00035%,-211.08818:0.00035%]
[INFO] ** src:[22:38.40319%,9:25.98629%,7:18.0963%,1:17.50734%,14:0.00318%,11:0.00124%,10:0.00088%,2:0.00088%,15:0.00035%,4:0.00035%]
[INFO] ** type:[0:99.99876%,1:0.00088%,2:0.00035%]
[INFO] ** unixtime:1539 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3545e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.1912e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0591e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9195e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.9037e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4716 - val_tp: 18174.0000 - val_fp: 1826.0000 - val_tn: 78174.0000 - val_fn: 1826.0000 - val_accuracy: 0.9635 - val_precision: 0.9087 - val_recall: 0.9087 - val_auc: 0.9429
[INFO] saving weights to checkpoints/lstm-epoch-2-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/566591
[33m[INFO] loading file 25-25/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (566591, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (566591, 17)

[INFO] analyzing data
[INFO] 566591 rows
[INFO] ** appi_name:[21:99.99647%,30:0.00106%,17:0.00071%,22:0.00053%,31:0.00035%,28:0.00018%,26:0.00018%,12:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** classification:[normal:64.35118%,Multi Stage Single Point:35.64882%]
[INFO] ** dst:[21:43.32102%,10:21.02593%,8:18.13389%,9:17.51493%,15:0.00106%,22:0.00088%,16:0.00071%,6:0.00071%,18:0.00035%,17:0.00035%,24:0.00018%]
[INFO] ** i/f_dir:[1:99.99894%,0:0.00106%]
[INFO] ** i/f_name:[2:99.99894%,3:0.00106%]
[INFO] ** modbus_function_code:[0.02961:99.99647%,-33.760870000000004:0.00353%]
[INFO] ** modbus_function_description:[7:49.99903%,11:49.99744%,0:0.00353%]
[INFO] ** modbus_transaction_id:65536 (11.56672%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99788%,2:0.00106%,1:0.00106%]
[INFO] ** proxy_src_ip:[18:38.38924%,20:25.95752%,13:18.13389%,6:17.51546%,17:0.00106%,1:0.00088%,21:0.00071%,16:0.00035%,14:0.00035%,7:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95717%,-0.32151:21.02557%,-1.27613:18.13354%,-0.23351:17.51493%,-0.33484:17.36367%,-71.33197:0.00106%,-71.14931:0.00053%,-0.24151:0.00035%,-1.02014:0.00035%,-49.275529999999996:0.00035%,1.46509:0.00018%,-5.1466400000000005:0.00018%,-1.27347:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,-0.24950999999999998:0.00018%,2.52505:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,6.1115699999999995:0.00018%,-5.08665:0.00018%,1.45709:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:25.95682%,1:21.0254%,5:18.13336%,4:17.51475%,2:17.3635%,0:0.00618%]
[INFO] ** service:[0.0048200000000000005:99.99682%,-211.73542999999998:0.00106%,-205.44247:0.00071%,-211.08818:0.00053%,-186.43601999999998:0.00035%,-211.09762999999998:0.00018%,-211.08346:0.00018%,-185.9872:0.00018%]
[INFO] ** src:[22:38.38924%,9:25.95752%,7:18.13389%,1:17.51546%,14:0.00106%,3:0.00088%,4:0.00071%,21:0.00035%,15:0.00035%,2:0.00035%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1539 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7331 - tp: 51545.0000 - fp: 28455.0000 - tn: 291545.0000 - fn: 28455.0000 - accuracy: 0.8577 - precision: 0.6443 - recall: 0.6443 - auc: 0.7777 - val_loss: 5.7429 - val_tp: 12874.0000 - val_fp: 7126.0000 - val_tn: 72874.0000 - val_fn: 7126.0000 - val_accuracy: 0.8575 - val_precision: 0.6437 - val_recall: 0.6437 - val_auc: 0.7773
[INFO] saving weights to checkpoints/lstm-epoch-2-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7552 - tp: 51435.0000 - fp: 28565.0000 - tn: 291435.0000 - fn: 28565.0000 - accuracy: 0.8572 - precision: 0.6429 - recall: 0.6429 - auc: 0.7768 - val_loss: 5.7566 - val_tp: 12857.0000 - val_fp: 7143.0000 - val_tn: 72857.0000 - val_fn: 7143.0000 - val_accuracy: 0.8571 - val_precision: 0.6428 - val_recall: 0.6428 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-2-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7463 - tp: 51479.0000 - fp: 28521.0000 - tn: 291479.0000 - fn: 28521.0000 - accuracy: 0.8574 - precision: 0.6435 - recall: 0.6435 - auc: 0.7772 - val_loss: 5.7276 - val_tp: 12893.0000 - val_fp: 7107.0000 - val_tn: 72893.0000 - val_fn: 7107.0000 - val_accuracy: 0.8579 - val_precision: 0.6446 - val_recall: 0.6446 - val_auc: 0.7779
[INFO] saving weights to checkpoints/lstm-epoch-2-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7498 - tp: 51462.0000 - fp: 28538.0000 - tn: 291462.0000 - fn: 28538.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.7770 - val_loss: 5.7324 - val_tp: 12887.0000 - val_fp: 7113.0000 - val_tn: 72887.0000 - val_fn: 7113.0000 - val_accuracy: 0.8577 - val_precision: 0.6443 - val_recall: 0.6443 - val_auc: 0.7777
[INFO] saving weights to checkpoints/lstm-epoch-2-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7594 - tp: 51414.0000 - fp: 28586.0000 - tn: 291414.0000 - fn: 28586.0000 - accuracy: 0.8571 - precision: 0.6427 - recall: 0.6427 - auc: 0.7767 - val_loss: 5.7195 - val_tp: 12903.0000 - val_fp: 7097.0000 - val_tn: 72903.0000 - val_fn: 7097.0000 - val_accuracy: 0.8581 - val_precision: 0.6452 - val_recall: 0.6452 - val_auc: 0.7782
[INFO] saving weights to checkpoints/lstm-epoch-2-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/566591
[33m[INFO] loading file 26-26/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (566591, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (566591, 17)

[INFO] analyzing data
[INFO] 566591 rows
[INFO] ** appi_name:[21:99.99824%,30:0.00053%,7:0.00053%,31:0.00018%,22:0.00018%,12:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:64.39707%,Single Stage Single Point:28.18823%,Multi Stage Single Point:7.4147%]
[INFO] ** dst:[21:43.30884%,10:21.08593%,8:18.12189%,9:17.48069%,22:0.00071%,15:0.00053%,24:0.00035%,16:0.00035%,2:0.00035%,18:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99947%,0:0.00053%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99824%,-33.760870000000004:0.00176%]
[INFO] ** modbus_function_description:[7:49.99974%,11:49.9985%,0:0.00176%]
[INFO] ** modbus_transaction_id:65536 (11.56672%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99912%,1:0.00053%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.46337%,20:25.93158%,13:18.12224%,6:17.48069%,17:0.00053%,1:0.00053%,21:0.00035%,16:0.00035%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.93105%,-0.32151:21.08576%,-1.27613:18.12171%,-0.23351:17.48051%,-0.33484:17.37761%,-71.33197:0.00053%,-1.02014:0.00035%,-1.27347:0.00035%,-49.275529999999996:0.00018%,1.47576:0.00018%,1.45709:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,14.191239999999999:0.00018%,2.52505:0.00018%,-3.3787199999999995:0.00018%,11.57001:0.00018%,-71.14931:0.00018%,7.66617:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.9307%,1:21.08576%,5:18.12154%,4:17.48033%,2:17.37761%,0:0.00406%]
[INFO] ** service:[0.0048200000000000005:99.99841%,-211.09762999999998:0.00053%,-211.73542999999998:0.00053%,-211.35747999999998:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.46337%,9:25.93158%,7:18.12224%,1:17.48069%,14:0.00053%,3:0.00053%,15:0.00035%,4:0.00035%,21:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1538 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7425 - tp: 51498.0000 - fp: 28502.0000 - tn: 291498.0000 - fn: 28502.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.7773 - val_loss: 5.7550 - val_tp: 12859.0000 - val_fp: 7141.0000 - val_tn: 72859.0000 - val_fn: 7141.0000 - val_accuracy: 0.8572 - val_precision: 0.6429 - val_recall: 0.6429 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-2-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.7449 - tp: 69269.0000 - fp: 10731.0000 - tn: 309269.0000 - fn: 10731.0000 - accuracy: 0.9463 - precision: 0.8659 - recall: 0.8659 - auc: 0.9173 - val_loss: 0.0047 - val_tp: 19965.0000 - val_fp: 35.0000 - val_tn: 79965.0000 - val_fn: 35.0000 - val_accuracy: 0.9993 - val_precision: 0.9983 - val_recall: 0.9983 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0695 - tp: 79024.0000 - fp: 976.0000 - tn: 319024.0000 - fn: 976.0000 - accuracy: 0.9951 - precision: 0.9878 - recall: 0.9878 - auc: 0.9929 - val_loss: 0.0026 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0648 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9930 - val_loss: 0.0027 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0616 - tp: 79144.0000 - fp: 856.0000 - tn: 319144.0000 - fn: 856.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9931 - val_loss: 0.0030 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/566591
[33m[INFO] loading file 27-27/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (506721, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (506721, 17)

[INFO] analyzing data
[INFO] 506721 rows
[INFO] ** appi_name:[21:99.99941%,30:0.00059%]
[INFO] ** classification:[normal:64.35849%,Single Stage Single Point:35.64151%]
[INFO] ** dst:[21:43.28773%,10:21.06899%,8:18.17154%,9:17.47017%,22:0.00079%,15:0.00059%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name:[2:99.99941%,3:0.00059%]
[INFO] ** modbus_function_code:[0.02961:99.99941%,-33.760870000000004:0.00059%]
[INFO] ** modbus_function_description:[7:50.0003%,11:49.99911%,0:0.00059%]
[INFO] ** modbus_transaction_id:65536 (12.93335%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99941%,1:0.00059%]
[INFO] ** proxy_src_ip:[18:38.42627%,20:25.93104%,13:18.17134%,6:17.47036%,17:0.00059%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.93044%,-0.32151:21.06899%,-1.27613:18.17114%,-0.23351:17.46997%,-0.33484:17.35728%,-71.33197:0.00059%,-1.02014:0.00039%,-1.27347:0.0002%,1.45709:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-0.24151:0.0002%]
[INFO] ** scada_tag:[3:25.93005%,1:21.06879%,5:18.17095%,4:17.46977%,2:17.35709%,0:0.00335%]
[INFO] ** service:[0.0048200000000000005:99.99941%,-211.73542999999998:0.00059%]
[INFO] ** src:[22:38.42627%,9:25.93104%,7:18.17134%,1:17.47036%,14:0.00059%,15:0.00039%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1376 (0.27155%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/506721
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0628 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9940 - val_loss: 0.0044 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/506721
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0639 - tp: 79072.0000 - fp: 928.0000 - tn: 319072.0000 - fn: 928.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9981 - val_loss: 0.0049 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/506721
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0589 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9982 - val_loss: 0.0048 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/506721
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0563 - tp: 79153.0000 - fp: 847.0000 - tn: 319153.0000 - fn: 847.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9983 - val_loss: 0.0055 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/506721
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0607 - tp: 79062.0000 - fp: 938.0000 - tn: 319062.0000 - fn: 938.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9979 - val_loss: 0.0065 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-26-27-batch-400000-500000
[INFO] processing batch 500000-600000/506721
[33m[INFO] loading file 28-28/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (340637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (340637, 17)

[INFO] analyzing data
[INFO] 340637 rows
[INFO] ** appi_name:[21:99.99149%,30:0.00176%,17:0.00147%,22:0.00117%,7:0.00117%,31:0.00088%,26:0.00088%,28:0.00029%,27:0.00029%,8:0.00029%,0:0.00029%]
[INFO] ** classification:[normal:64.31421%,Single Stage Single Point:35.68579%]
[INFO] ** dst:[21:43.28714%,10:21.01856%,8:18.19796%,9:17.48753%,6:0.00235%,16:0.00205%,18:0.00147%,17:0.00059%,15:0.00059%,2:0.00059%,25:0.00029%,22:0.00029%,7:0.00029%,0:0.00029%]
[INFO] ** i/f_dir:[1:99.99941%,0:0.00059%]
[INFO] ** i/f_name:[2:99.99941%,3:0.00059%]
[INFO] ** modbus_function_code:[0.02961:99.99149%,-33.760870000000004:0.00851%]
[INFO] ** modbus_function_description:[11:49.99604%,7:49.99545%,0:0.00851%]
[INFO] ** modbus_transaction_id:65535 (19.23896%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99501%,2:0.0044%,1:0.00059%]
[INFO] ** proxy_src_ip:[18:38.33935%,20:25.96635%,13:18.19826%,6:17.48753%,1:0.00235%,17:0.00176%,14:0.00176%,7:0.00147%,21:0.00088%,0:0.00029%]
[INFO] ** s_port:[1.45442:25.96606%,-0.32151:21.01856%,-1.27613:18.19796%,-0.23351:17.48724%,-0.33484:17.32078%,-71.14798:0.00117%,-71.14931:0.00117%,-71.33197:0.00059%,-0.08551:0.00059%,7.66617:0.00029%,-58.035180000000004:0.00029%,-1.2708:0.00029%,-64.19493:0.00029%,-5.1466400000000005:0.00029%,13.431270000000001:0.00029%,-0.24151:0.00029%,11.57001:0.00029%,14.4699:0.00029%,1.47576:0.00029%,14.191239999999999:0.00029%,-5.08665:0.00029%,10.192739999999999:0.00029%,-3.3787199999999995:0.00029%,6.1115699999999995:0.00029%,2.05573:0.00029%,-43.76509:0.00029%,2.52505:0.00029%,11.862:0.00029%,-58.032509999999995:0.00029%]
[INFO] ** scada_tag:[3:25.96606%,1:21.01856%,5:18.19796%,4:17.48694%,2:17.32078%,0:0.00969%]
[INFO] ** service:[0.0048200000000000005:99.99149%,-205.44247:0.00147%,-186.43601999999998:0.00147%,-211.09762999999998:0.00117%,-211.08346:0.00117%,-211.08818:0.00117%,-211.73542999999998:0.00059%,-186.44547:0.00029%,-183.8612:0.00029%,-185.9872:0.00029%,-211.35747999999998:0.00029%,-202.75898:0.00029%]
[INFO] ** src:[22:38.33935%,9:25.96635%,7:18.19826%,1:17.48753%,3:0.00264%,2:0.00176%,21:0.00147%,4:0.00117%,14:0.00059%,8:0.00059%,17:0.00029%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:926 (0.27184%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/340637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0628 - tp: 79009.0000 - fp: 991.0000 - tn: 319009.0000 - fn: 991.0000 - accuracy: 0.9950 - precision: 0.9876 - recall: 0.9876 - auc: 0.9980 - val_loss: 0.0078 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/340637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0568 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9982 - val_loss: 0.0093 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/340637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0568 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9981 - val_loss: 0.0094 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/340637
[33m[INFO] loading file 29-29/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540637, 17)

[INFO] analyzing data
[INFO] 540637 rows
[INFO] ** appi_name:[21:99.99889%,30:0.00055%,26:0.00018%,9:0.00018%,3:0.00018%]
[INFO] ** classification:[normal:64.39219%,Single Stage Single Point:35.60781%]
[INFO] ** dst:[21:43.32704%,10:21.06386%,8:18.14341%,9:17.46403%,22:0.00055%,15:0.00055%,24:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99945%,3:0.00055%]
[INFO] ** modbus_function_code:[0.02961:99.99889%,-33.760870000000004:0.00111%]
[INFO] ** modbus_function_description:[7:49.99972%,11:49.99917%,0:0.00111%]
[INFO] ** modbus_transaction_id:65536 (12.122%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99926%,1:0.00055%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.44058%,20:25.9505%,13:18.14378%,6:17.46384%,17:0.00055%,21:0.00018%,16:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.94994%,-0.32151:21.06367%,-1.27613:18.14341%,-0.23351:17.46384%,-0.33484:17.37691%,-71.33197:0.00055%,1.45709:0.00037%,-71.14798:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.94957%,1:21.06349%,5:18.14341%,4:17.46347%,2:17.37691%,0:0.00314%]
[INFO] ** service:[0.0048200000000000005:99.99908%,-211.73542999999998:0.00055%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.44058%,9:25.9505%,7:18.14378%,1:17.46384%,14:0.00055%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1468 (0.27153%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0562 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9982 - val_loss: 0.0099 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0560 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9983 - val_loss: 0.0102 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0566 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9983 - val_loss: 0.0101 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0554 - tp: 79081.0000 - fp: 919.0000 - tn: 319081.0000 - fn: 919.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9986 - val_loss: 0.0054 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0505 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9990 - val_loss: 0.0061 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/540637
[33m[INFO] loading file 30-30/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540637, 17)

[INFO] analyzing data
[INFO] 540637 rows
[INFO] ** appi_name:[21:99.9976%,30:0.00166%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.36925%,Single Stage Single Point:35.63075%]
[INFO] ** dst:[21:43.33684%,10:21.02945%,8:18.14489%,9:17.48548%,15:0.00166%,22:0.00074%,24:0.00037%,25:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99834%,0:0.00166%]
[INFO] ** i/f_name:[2:99.99834%,3:0.00166%]
[INFO] ** modbus_function_code:[0.02961:99.9976%,-33.760870000000004:0.0024%]
[INFO] ** modbus_function_description:[7:49.99972%,11:49.99787%,0:0.0024%]
[INFO] ** modbus_transaction_id:65536 (12.122%)
[INFO] ** orig:[0:99.99908%,2:0.00055%,1:0.00037%]
[INFO] ** proto:[0:99.99797%,1:0.00166%,2:0.00037%]
[INFO] ** proxy_src_ip:[18:38.36955%,20:25.99656%,13:18.14526%,6:17.48604%,17:0.00166%,7:0.00037%,16:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.99637%,-0.32151:21.02927%,-1.27613:18.14471%,-0.23351:17.4853%,-0.33484:17.34029%,-71.33197:0.00166%,-0.24151:0.00055%,-1.27347:0.00037%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.996%,1:21.02927%,5:18.14452%,4:17.48511%,2:17.3401%,0:0.00499%]
[INFO] ** service:[0.0048200000000000005:99.99778%,-211.73542999999998:0.00166%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.36955%,9:25.99656%,7:18.14526%,1:17.48604%,14:0.00111%,21:0.00092%,16:0.00018%,15:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99926%,1:0.00074%]
[INFO] ** unixtime:1470 (0.2719%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0478 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9992 - val_loss: 0.0038 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0475 - tp: 79039.0000 - fp: 961.0000 - tn: 319039.0000 - fn: 961.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9994 - val_loss: 1.6801e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0411 - tp: 79143.0000 - fp: 857.0000 - tn: 319143.0000 - fn: 857.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9995 - val_loss: 1.0906e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0422 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9994 - val_loss: 8.4199e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0403 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9995 - val_loss: 8.2491e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/540637
[33m[INFO] loading file 31-31/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540637, 17)

[INFO] analyzing data
[INFO] 540637 rows
[INFO] ** appi_name:[21:99.99982%,26:0.00018%]
[INFO] ** classification:[normal:64.37869%,Single Stage Single Point:35.62131%]
[INFO] ** dst:[21:43.32093%,10:21.05646%,8:18.12492%,9:17.49621%,22:0.00092%,24:0.00037%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99982%,-33.760870000000004:0.00018%]
[INFO] ** modbus_function_description:[11:49.99991%,7:49.99991%,0:0.00018%]
[INFO] ** modbus_transaction_id:65536 (12.122%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.40081%,20:25.97732%,13:18.1251%,6:17.49621%,16:0.00037%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.97658%,-0.32151:21.05646%,-1.27613:18.12473%,-0.23351:17.49603%,-0.33484:17.34435%,-1.27347:0.00037%,1.45709:0.00037%,-1.02014:0.00037%,-71.14798:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.97621%,1:21.05627%,5:18.12455%,4:17.49584%,2:17.34417%,0:0.00296%]
[INFO] ** service:[0.0048200000000000005:99.99982%,-211.08346:0.00018%]
[INFO] ** src:[22:38.40081%,9:25.97732%,7:18.1251%,1:17.49621%,15:0.00037%,21:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1469 (0.27172%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0413 - tp: 79109.0000 - fp: 891.0000 - tn: 319109.0000 - fn: 891.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9995 - val_loss: 3.5836e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0389 - tp: 79168.0000 - fp: 832.0000 - tn: 319168.0000 - fn: 832.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9996 - val_loss: 3.5206e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0414 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9995 - val_loss: 2.8356e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0389 - tp: 79167.0000 - fp: 833.0000 - tn: 319167.0000 - fn: 833.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9995 - val_loss: 2.5745e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0397 - tp: 79142.0000 - fp: 858.0000 - tn: 319142.0000 - fn: 858.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9995 - val_loss: 2.1418e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/540637
[33m[INFO] loading file 32-32/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540637, 17)

[INFO] analyzing data
[INFO] 540637 rows
[INFO] ** appi_name:[21:99.9963%,30:0.00314%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.37554%,Single Stage Single Point:35.62446%]
[INFO] ** dst:[21:43.31964%,10:21.05109%,8:18.16024%,9:17.46421%,15:0.00314%,22:0.00092%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99723%,0:0.00277%]
[INFO] ** i/f_name:[2:99.99686%,3:0.00314%]
[INFO] ** modbus_function_code:[0.02961:99.9963%,-33.760870000000004:0.0037%]
[INFO] ** modbus_function_description:[7:49.99917%,11:49.99713%,0:0.0037%]
[INFO] ** modbus_transaction_id:65536 (12.122%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9963%,1:0.00314%,2:0.00055%]
[INFO] ** proxy_src_ip:[18:38.41376%,20:25.95734%,13:18.16024%,6:17.46477%,17:0.00314%,14:0.00055%,16:0.00018%]
[INFO] ** s_port:[1.45442:25.95679%,-0.32151:21.05109%,-1.27613:18.15987%,-0.23351:17.46403%,-0.33484:17.36267%,-71.33197:0.00314%,-0.24151:0.00055%,-1.2708:0.00018%,-1.02014:0.00018%,13.431270000000001:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,1.45709:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:25.95642%,1:21.05091%,5:18.15987%,4:17.46366%,2:17.36267%,0:0.00647%]
[INFO] ** service:[0.0048200000000000005:99.9963%,-211.73542999999998:0.00314%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.41376%,9:25.95734%,7:18.16024%,1:17.46477%,14:0.00314%,2:0.00055%,15:0.00018%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1467 (0.27135%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0407 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9995 - val_loss: 1.5011e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0393 - tp: 79146.0000 - fp: 854.0000 - tn: 319146.0000 - fn: 854.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9996 - val_loss: 3.2359e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0403 - tp: 79037.0000 - fp: 963.0000 - tn: 319037.0000 - fn: 963.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9997 - val_loss: 9.1957e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0316 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9998 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-2-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0234 - tp: 79183.0000 - fp: 817.0000 - tn: 319183.0000 - fn: 817.0000 - accuracy: 0.9959 - precision: 0.9898 - recall: 0.9898 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/540637
[33m[INFO] loading file 33-33/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540637, 17)

[INFO] analyzing data
[INFO] 540637 rows
[INFO] ** appi_name:[21:99.99686%,30:0.00111%,17:0.00074%,22:0.00055%,31:0.00018%,28:0.00018%,26:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.39811%,Single Stage Single Point:35.60189%]
[INFO] ** dst:[21:43.33185%,10:21.06127%,8:18.11474%,9:17.48715%,22:0.00148%,15:0.00111%,16:0.00074%,6:0.00074%,24:0.00037%,17:0.00037%,18:0.00018%]
[INFO] ** i/f_dir:[1:99.99889%,0:0.00111%]
[INFO] ** i/f_name:[2:99.99889%,3:0.00111%]
[INFO] ** modbus_function_code:[0.02961:99.99686%,-33.760870000000004:0.00314%]
[INFO] ** modbus_function_description:[7:49.99954%,11:49.99732%,0:0.00314%]
[INFO] ** modbus_transaction_id:65536 (12.122%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99797%,1:0.00111%,2:0.00092%]
[INFO] ** proxy_src_ip:[18:38.42449%,20:25.96955%,13:18.11474%,6:17.48733%,17:0.00111%,16:0.00074%,1:0.00074%,21:0.00037%,14:0.00037%,7:0.00037%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.96863%,-0.32151:21.06127%,-1.27613:18.11437%,-0.23351:17.48696%,-0.33484:17.36322%,-71.33197:0.00111%,-1.02014:0.00074%,1.45709:0.00055%,-71.14931:0.00055%,-1.27347:0.00037%,-5.08665:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,-43.76509:0.00018%,-71.14798:0.00018%,-58.032509999999995:0.00018%,-58.035180000000004:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:25.96826%,1:21.06127%,5:18.11419%,4:17.48678%,2:17.36322%,0:0.00629%]
[INFO] ** service:[0.0048200000000000005:99.99686%,-211.73542999999998:0.00111%,-205.44247:0.00074%,-211.08818:0.00055%,-211.09762999999998:0.00018%,-211.08346:0.00018%,-185.9872:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.42449%,9:25.96955%,7:18.11474%,1:17.48733%,14:0.00111%,15:0.00074%,3:0.00074%,21:0.00037%,4:0.00037%,2:0.00037%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1470 (0.2719%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0230 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0216 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1923e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0214 - tp: 79088.0000 - fp: 912.0000 - tn: 319088.0000 - fn: 912.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0221 - tp: 79054.0000 - fp: 946.0000 - tn: 319054.0000 - fn: 946.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/540637
[33m[INFO] loading file 34-34/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (382070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (382070, 17)

[INFO] analyzing data
[INFO] 382070 rows
[INFO] ** appi_name:[21:99.99738%,30:0.00079%,7:0.00079%,31:0.00026%,22:0.00026%,8:0.00026%,6:0.00026%]
[INFO] ** classification:[normal:64.34109%,Single Stage Single Point:35.65891%]
[INFO] ** dst:[21:43.28107%,10:21.05687%,8:18.19954%,9:17.45937%,22:0.00079%,15:0.00079%,16:0.00052%,2:0.00052%,18:0.00026%,6:0.00026%]
[INFO] ** i/f_dir:[1:99.99921%,0:0.00079%]
[INFO] ** i/f_name:[2:99.99921%,3:0.00079%]
[INFO] ** modbus_function_code:[0.02961:99.99738%,-33.760870000000004:0.00262%]
[INFO] ** modbus_function_description:[7:49.99921%,11:49.99817%,0:0.00262%]
[INFO] ** modbus_transaction_id:65536 (17.15288%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99869%,1:0.00079%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.38852%,20:25.94943%,13:18.19954%,6:17.45989%,17:0.00079%,1:0.00079%,21:0.00052%,14:0.00026%,7:0.00026%]
[INFO] ** s_port:[1.45442:25.94917%,-0.32151:21.05661%,-1.27613:18.19954%,-0.23351:17.4591%,-0.33484:17.3319%,-0.24151:0.00079%,-71.33197:0.00079%,-3.0613900000000003:0.00026%,-3.3787199999999995:0.00026%,14.191239999999999:0.00026%,1.47576:0.00026%,11.57001:0.00026%,-49.275529999999996:0.00026%,-71.14931:0.00026%,7.66617:0.00026%]
[INFO] ** scada_tag:[3:25.94891%,1:21.05635%,5:18.19928%,4:17.45858%,2:17.3319%,0:0.00497%]
[INFO] ** service:[0.0048200000000000005:99.99764%,-211.09762999999998:0.00079%,-211.73542999999998:0.00079%,-186.43601999999998:0.00026%,-211.35747999999998:0.00026%,-211.08818:0.00026%]
[INFO] ** src:[22:38.38852%,9:25.94943%,7:18.19954%,1:17.45989%,14:0.00079%,3:0.00079%,4:0.00052%,21:0.00026%,2:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1038 (0.27168%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/382070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79086.0000 - fp: 914.0000 - tn: 319086.0000 - fn: 914.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 3.7527e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/382070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/382070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/382070
[33m[INFO] loading file 35-35/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.99897%,30:0.00103%]
[INFO] ** classification:[normal:64.36356%,Single Stage Single Point:35.63644%]
[INFO] ** dst:[21:43.32297%,10:21.03802%,8:18.16208%,9:17.4747%,22:0.0012%,15:0.00103%]
[INFO] ** i/f_dir:[1:99.99914%,0:0.00086%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99897%,-33.760870000000004:0.00103%]
[INFO] ** modbus_function_description:[7:50.00034%,11:49.99863%,0:0.00103%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99897%,1:0.00103%]
[INFO] ** proxy_src_ip:[18:38.39384%,20:25.96767%,13:18.16173%,6:17.47505%,17:0.00103%,16:0.00069%]
[INFO] ** s_port:[1.45442:25.96715%,-0.32151:21.03802%,-1.27613:18.16173%,-0.23351:17.47453%,-0.33484:17.35582%,-71.33197:0.00103%,-1.02014:0.00069%,-0.24151:0.00034%,1.45709:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.96681%,1:21.03802%,5:18.16156%,4:17.47419%,2:17.35582%,0:0.00361%]
[INFO] ** service:[0.0048200000000000005:99.99897%,-211.73542999999998:0.00103%]
[INFO] ** src:[22:38.39384%,9:25.96767%,7:18.16173%,1:17.47505%,14:0.00103%,15:0.00069%]
[INFO] ** type:[0:99.99914%,1:0.00086%]
[INFO] ** unixtime:1580 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0190 - tp: 79196.0000 - fp: 804.0000 - tn: 319196.0000 - fn: 804.0000 - accuracy: 0.9960 - precision: 0.9900 - recall: 0.9900 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0196 - tp: 79176.0000 - fp: 824.0000 - tn: 319176.0000 - fn: 824.0000 - accuracy: 0.9959 - precision: 0.9897 - recall: 0.9897 - auc: 0.9999 - val_loss: 1.4828e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79054.0000 - fp: 946.0000 - tn: 319054.0000 - fn: 946.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 36-36/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.99863%,30:0.00069%,31:0.00034%,33:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.36391%,Single Stage Single Point:35.63609%]
[INFO] ** dst:[21:43.33121%,10:21.03046%,8:18.15039%,9:17.48553%,22:0.00086%,15:0.00069%,24:0.00034%,18:0.00034%,25:0.00017%]
[INFO] ** i/f_dir:[1:99.99931%,0:0.00069%]
[INFO] ** i/f_name:[2:99.99931%,3:0.00069%]
[INFO] ** modbus_function_code:[0.02961:99.99863%,-33.760870000000004:0.00137%]
[INFO] ** modbus_function_description:[7:50.00034%,11:49.99828%,0:0.00137%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9988%,1:0.00069%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.38284%,20:25.97901%,13:18.15057%,6:17.48604%,17:0.00069%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.97849%,-0.32151:21.03029%,-1.27613:18.15005%,-0.23351:17.48535%,-0.33484:17.35255%,-71.33197:0.00069%,-0.24151:0.00052%,-0.08551:0.00034%,-1.27347:0.00034%,1.45709:0.00017%,1.47576:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,-64.19493:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.97815%,1:21.03012%,5:18.14988%,4:17.48518%,2:17.35238%,0:0.0043%]
[INFO] ** service:[0.0048200000000000005:99.9988%,-211.73542999999998:0.00069%,-186.43601999999998:0.00034%,-186.44547:0.00017%]
[INFO] ** src:[22:38.38284%,9:25.97901%,7:18.15057%,1:17.48604%,14:0.00069%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1581 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79075.0000 - fp: 925.0000 - tn: 319075.0000 - fn: 925.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79059.0000 - fp: 941.0000 - tn: 319059.0000 - fn: 941.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 37-37/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.9988%,30:0.00069%,33:0.00017%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:64.37937%,Single Stage Single Point:35.62063%]
[INFO] ** dst:[21:43.33963%,10:21.03785%,8:18.13596%,9:17.48467%,22:0.00069%,15:0.00069%,24:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99931%,3:0.00069%]
[INFO] ** modbus_function_code:[0.02961:99.9988%,-33.760870000000004:0.0012%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99863%,0:0.0012%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99914%,1:0.00069%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.38559%,20:25.99206%,13:18.13596%,6:17.48484%,17:0.00069%,21:0.00034%,16:0.00034%,1:0.00017%]
[INFO] ** s_port:[1.45442:25.99155%,-0.32151:21.03768%,-1.27613:18.13562%,-0.23351:17.48449%,-0.33484:17.34791%,-71.33197:0.00069%,-1.02014:0.00034%,1.46509:0.00017%,1.47576:0.00017%,-1.27347:0.00017%,-49.275529999999996:0.00017%,-0.24950999999999998:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,1.45709:0.00017%,14.4699:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:25.99138%,1:21.03768%,5:18.13545%,4:17.48432%,2:17.34774%,0:0.00344%]
[INFO] ** service:[0.0048200000000000005:99.99897%,-211.73542999999998:0.00069%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.38559%,9:25.99206%,7:18.13596%,1:17.48484%,14:0.00069%,15:0.00034%,4:0.00034%,3:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1581 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79167.0000 - fp: 833.0000 - tn: 319167.0000 - fn: 833.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0214 - tp: 79049.0000 - fp: 951.0000 - tn: 319049.0000 - fn: 951.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79132.0000 - fp: 868.0000 - tn: 319132.0000 - fn: 868.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.5036e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 38-38/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.99897%,30:0.00034%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.4072%,Single Stage Single Point:35.5928%]
[INFO] ** dst:[21:43.32211%,10:21.08303%,8:18.09851%,9:17.49446%,22:0.00086%,15:0.00034%,25:0.00017%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.99966%,3:0.00034%]
[INFO] ** modbus_function_code:[0.02961:99.99897%,-33.760870000000004:0.00103%]
[INFO] ** modbus_function_description:[11:49.99948%,7:49.99948%,0:0.00103%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99931%,2:0.00034%,1:0.00034%]
[INFO] ** proxy_src_ip:[18:38.44469%,20:25.96097%,13:18.09834%,6:17.4948%,17:0.00034%,7:0.00034%,16:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.96028%,-0.32151:21.08286%,-1.27613:18.09817%,-0.23351:17.49429%,-0.33484:17.36183%,-0.24151:0.00034%,-71.33197:0.00034%,1.45709:0.00034%,1.47576:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-61.95768:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:25.95994%,1:21.08286%,5:18.09817%,4:17.49412%,2:17.36183%,0:0.00309%]
[INFO] ** service:[0.0048200000000000005:99.99914%,-211.73542999999998:0.00034%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.44469%,9:25.96097%,7:18.09834%,1:17.4948%,21:0.00034%,14:0.00034%,16:0.00017%,15:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1582 (0.27179%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79166.0000 - fp: 834.0000 - tn: 319166.0000 - fn: 834.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79163.0000 - fp: 837.0000 - tn: 319163.0000 - fn: 837.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 39-39/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.99966%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.39672%,Single Stage Single Point:35.60328%]
[INFO] ** dst:[21:43.31558%,10:21.07994%,8:18.13871%,9:17.46439%,22:0.00086%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99966%,-33.760870000000004:0.00034%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99966%,0:0.00034%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.44125%,20:25.95461%,13:18.13888%,6:17.46439%,16:0.00052%,7:0.00034%]
[INFO] ** s_port:[1.45442:25.95409%,-0.32151:21.07994%,-1.27613:18.13854%,-0.23351:17.46422%,-0.33484:17.36131%,-1.02014:0.00052%,-71.14798:0.00017%,-1.27347:0.00017%,1.45709:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.95375%,1:21.07977%,5:18.13837%,4:17.46422%,2:17.36114%,0:0.00275%]
[INFO] ** service:[0.0048200000000000005:99.99966%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.44125%,9:25.95461%,7:18.13888%,1:17.46439%,15:0.00052%,21:0.00034%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1580 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79079.0000 - fp: 921.0000 - tn: 319079.0000 - fn: 921.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 40-40/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.99656%,30:0.00292%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.33539%,Single Stage Single Point:35.66461%]
[INFO] ** dst:[21:43.29101%,10:21.03974%,8:18.19661%,9:17.46817%,15:0.00292%,22:0.00086%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99725%,0:0.00275%]
[INFO] ** i/f_name:[2:99.99708%,3:0.00292%]
[INFO] ** modbus_function_code:[0.02961:99.99656%,-33.760870000000004:0.00344%]
[INFO] ** modbus_function_description:[7:49.99931%,11:49.99725%,0:0.00344%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99656%,1:0.00292%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.35707%,20:25.97454%,13:18.19644%,6:17.46852%,17:0.00292%,14:0.00052%]
[INFO] ** s_port:[1.45442:25.97368%,-0.32151:21.03974%,-1.27613:18.19627%,-0.23351:17.468%,-0.33484:17.31733%,-71.33197:0.00292%,1.45709:0.00052%,-0.24151:0.00034%,-71.14798:0.00017%,-1.27347:0.00017%,11.862:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%,13.431270000000001:0.00017%]
[INFO] ** scada_tag:[3:25.97334%,1:21.03957%,5:18.19609%,4:17.46766%,2:17.31716%,0:0.00618%]
[INFO] ** service:[0.0048200000000000005:99.99656%,-211.73542999999998:0.00292%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.35707%,9:25.97454%,7:18.19644%,1:17.46852%,14:0.00292%,2:0.00052%]
[INFO] ** type:[0:99.99914%,1:0.00086%]
[INFO] ** unixtime:1583 (0.27196%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79145.0000 - fp: 855.0000 - tn: 319145.0000 - fn: 855.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79109.0000 - fp: 891.0000 - tn: 319109.0000 - fn: 891.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0192 - tp: 79191.0000 - fp: 809.0000 - tn: 319191.0000 - fn: 809.0000 - accuracy: 0.9960 - precision: 0.9899 - recall: 0.9899 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79158.0000 - fp: 842.0000 - tn: 319158.0000 - fn: 842.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-2-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 41-41/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (522228, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (522228, 17)

[INFO] analyzing data
[INFO] 522228 rows
[INFO] ** appi_name:[21:99.99674%,30:0.00096%,22:0.00077%,17:0.00077%,32:0.00019%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.38778%,Single Stage Single Point:35.61222%]
[INFO] ** dst:[21:43.32724%,10:21.05651%,8:18.14284%,9:17.46919%,16:0.00096%,15:0.00096%,6:0.00096%,22:0.00057%,24:0.00038%,17:0.00038%]
[INFO] ** i/f_dir:[1:99.99904%,0:0.00096%]
[INFO] ** i/f_name:[2:99.99904%,3:0.00096%]
[INFO] ** modbus_function_code:[0.02961:99.99674%,-33.760870000000004:0.00326%]
[INFO] ** modbus_function_description:[7:49.99923%,11:49.99751%,0:0.00326%]
[INFO] ** modbus_transaction_id:65536 (12.54931%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99789%,2:0.00115%,1:0.00096%]
[INFO] ** proxy_src_ip:[18:38.42843%,20:25.95552%,13:18.14303%,6:17.46938%,17:0.00096%,1:0.00077%,21:0.00038%,16:0.00038%,14:0.00038%,0:0.00038%,7:0.00019%,2:0.00019%]
[INFO] ** s_port:[1.45442:25.95514%,-0.32151:21.05651%,-1.27613:18.14246%,-0.23351:17.469%,-0.33484:17.37191%,-71.33197:0.00096%,-71.14931:0.00077%,-1.02014:0.00038%,-1.27347:0.00038%,-71.14798:0.00019%,-0.24151:0.00019%,-58.035180000000004:0.00019%,-1.2708:0.00019%,-5.1466400000000005:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-64.19226:0.00019%,-5.08665:0.00019%,-0.24950999999999998:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.95495%,1:21.05651%,5:18.14246%,4:17.46881%,2:17.37172%,0:0.00555%]
[INFO] ** service:[0.0048200000000000005:99.99674%,-211.73542999999998:0.00096%,-205.44247:0.00077%,-211.08818:0.00077%,89.64175:0.00019%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.42843%,9:25.95552%,7:18.14303%,1:17.46938%,14:0.00096%,3:0.00077%,15:0.00038%,8:0.00038%,4:0.00038%,2:0.00038%,21:0.00019%,17:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1417 (0.27134%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/522228
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 6.9425e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/522228
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/522228
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79059.0000 - fp: 941.0000 - tn: 319059.0000 - fn: 941.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/522228
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79089.0000 - fp: 911.0000 - tn: 319089.0000 - fn: 911.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/522228
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-40-41-batch-400000-500000
[INFO] processing batch 500000-600000/522228
[33m[INFO] loading file 42-42/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (365742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (365742, 17)

[INFO] analyzing data
[INFO] 365742 rows
[INFO] ** appi_name:[21:99.9907%,30:0.00246%,17:0.00137%,31:0.00109%,26:0.00109%,7:0.00109%,22:0.00082%,28:0.00027%,27:0.00027%,9:0.00027%,8:0.00027%,0:0.00027%]
[INFO] ** classification:[normal:64.34809%,Single Stage Single Point:35.65191%]
[INFO] ** dst:[21:43.30102%,10:21.03723%,8:18.19643%,9:17.4552%,16:0.00246%,6:0.00219%,18:0.00137%,2:0.00109%,22:0.00082%,15:0.00082%,17:0.00055%,25:0.00027%,7:0.00027%,0:0.00027%]
[INFO] ** i/f_dir:[1:99.99918%,0:0.00082%]
[INFO] ** i/f_name:[2:99.99918%,3:0.00082%]
[INFO] ** modbus_function_code:[0.02961:99.9907%,-33.760870000000004:0.0093%]
[INFO] ** modbus_function_description:[7:49.9959%,11:49.99481%,0:0.0093%]
[INFO] ** modbus_transaction_id:65536 (17.91864%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99508%,2:0.0041%,1:0.00082%]
[INFO] ** proxy_src_ip:[18:38.38881%,20:25.94971%,13:18.19671%,6:17.4552%,17:0.00246%,1:0.00246%,14:0.00164%,21:0.00109%,7:0.00082%,0:0.00055%,16:0.00027%,2:0.00027%]
[INFO] ** s_port:[1.45442:25.94917%,-0.32151:21.03723%,-1.27613:18.19643%,-0.23351:17.45493%,-0.33484:17.35158%,-71.14931:0.00109%,-71.14798:0.00109%,-71.33197:0.00082%,-3.3787199999999995:0.00055%,-0.08551:0.00055%,11.57001:0.00055%,13.431270000000001:0.00027%,-5.1466400000000005:0.00027%,0.31847:0.00027%,-1.02014:0.00027%,-64.19493:0.00027%,-1.2708:0.00027%,-58.035180000000004:0.00027%,7.66617:0.00027%,-0.24151:0.00027%,1.47576:0.00027%,14.4699:0.00027%,15.912510000000001:0.00027%,14.191239999999999:0.00027%,7.9608300000000005:0.00027%,-5.08665:0.00027%,10.192739999999999:0.00027%,-3.0613900000000003:0.00027%,1.45709:0.00027%,2.05573:0.00027%,-43.76509:0.00027%,11.862:0.00027%,-58.032509999999995:0.00027%]
[INFO] ** scada_tag:[3:25.94889%,1:21.03723%,5:18.19616%,4:17.45493%,2:17.3513%,0:0.01148%]
[INFO] ** service:[0.0048200000000000005:99.9907%,-211.09762999999998:0.00191%,-205.44247:0.00137%,-186.43601999999998:0.00137%,-211.08346:0.00109%,-211.08818:0.00109%,-211.73542999999998:0.00082%,-211.35747999999998:0.00055%,-186.44547:0.00027%,-183.8612:0.00027%,-185.9872:0.00027%,-202.75898:0.00027%]
[INFO] ** src:[22:38.38881%,9:25.94971%,7:18.19671%,1:17.4552%,3:0.00328%,2:0.00191%,4:0.00137%,21:0.00109%,14:0.00082%,8:0.00055%,17:0.00027%,15:0.00027%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:993 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/365742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79150.0000 - fp: 850.0000 - tn: 319150.0000 - fn: 850.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 0.0032 - val_tp: 19996.0000 - val_fp: 4.0000 - val_tn: 79996.0000 - val_fn: 4.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-2-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/365742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/365742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79132.0000 - fp: 868.0000 - tn: 319132.0000 - fn: 868.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/365742
[33m[INFO] loading file 43-43/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99894%,30:0.00053%,26:0.00018%,8:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.39844%,Single Stage Single Point:35.60156%]
[INFO] ** dst:[21:43.32646%,10:21.06985%,8:18.13123%,9:17.47015%,22:0.00106%,15:0.00053%,2:0.00035%,24:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99982%,0:0.00018%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99894%,-33.760870000000004:0.00106%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99894%,0:0.00106%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99929%,1:0.00053%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.41804%,20:25.9788%,13:18.13141%,6:17.47033%,17:0.00053%,1:0.00053%,16:0.00035%]
[INFO] ** s_port:[1.45442:25.9781%,-0.32151:21.06985%,-1.27613:18.13106%,-0.23351:17.4698%,-0.33484:17.34819%,-71.33197:0.00053%,1.45709:0.00035%,1.47576:0.00035%,-0.24151:0.00035%,-1.02014:0.00035%,0.31847:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-1.2708:0.00018%,-3.3787199999999995:0.00018%]
[INFO] ** scada_tag:[3:25.97774%,1:21.06985%,5:18.13088%,4:17.46945%,2:17.34801%,0:0.00407%]
[INFO] ** service:[0.0048200000000000005:99.99894%,-211.73542999999998:0.00053%,-211.09762999999998:0.00018%,-211.08346:0.00018%,-211.35747999999998:0.00018%]
[INFO] ** src:[22:38.41804%,9:25.9788%,7:18.13141%,1:17.47033%,14:0.00053%,3:0.00053%,15:0.00035%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1538 (0.27186%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79132.0000 - fp: 868.0000 - tn: 319132.0000 - fn: 868.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 44-44/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99823%,30:0.00071%,31:0.00053%,0:0.00035%,22:0.00018%]
[INFO] ** classification:[normal:64.3926%,Single Stage Single Point:35.6074%]
[INFO] ** dst:[21:43.33619%,10:21.05341%,8:18.15121%,9:17.45601%,22:0.00106%,15:0.00071%,18:0.00053%,25:0.00035%,24:0.00035%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99929%,0:0.00071%]
[INFO] ** i/f_name:[2:99.99929%,3:0.00071%]
[INFO] ** modbus_function_code:[0.02961:99.99823%,-33.760870000000004:0.00177%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99806%,0:0.00177%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99823%,2:0.00106%,1:0.00071%]
[INFO] ** proxy_src_ip:[18:38.43554%,20:25.95459%,13:18.15138%,6:17.45654%,17:0.00071%,7:0.00035%,16:0.00018%,5:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95388%,-0.32151:21.05341%,-1.27613:18.15085%,-0.23351:17.45584%,-0.33484:17.38213%,-71.33197:0.00071%,-0.24151:0.00053%,-0.08551:0.00035%,-64.19493:0.00035%,-1.27347:0.00035%,1.45709:0.00035%,-1.02014:0.00018%,-1.2708:0.00018%,1.47576:0.00018%,-71.14931:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,4.42897:0.00018%]
[INFO] ** scada_tag:[3:25.95335%,1:21.05341%,5:18.15085%,4:17.45548%,2:17.38195%,0:0.00495%]
[INFO] ** service:[0.0048200000000000005:99.99823%,-211.73542999999998:0.00071%,-186.43601999999998:0.00053%,-186.44547:0.00035%,-211.08818:0.00018%]
[INFO] ** src:[22:38.43554%,9:25.95459%,7:18.15138%,1:17.45654%,14:0.00071%,21:0.00035%,17:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1535 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79142.0000 - fp: 858.0000 - tn: 319142.0000 - fn: 858.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-2-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79132.0000 - fp: 868.0000 - tn: 319132.0000 - fn: 868.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0215 - tp: 79082.0000 - fp: 918.0000 - tn: 319082.0000 - fn: 918.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 45-45/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99876%,30:0.00053%,31:0.00035%,26:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:64.41912%,Single Stage Single Point:35.58088%]
[INFO] ** dst:[21:43.32646%,10:21.08983%,8:18.12505%,9:17.45601%,22:0.00141%,15:0.00053%,18:0.00035%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99965%,0:0.00035%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99876%,-33.760870000000004:0.00124%]
[INFO] ** modbus_function_description:[7:50.00035%,11:49.99841%,0:0.00124%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99894%,2:0.00053%,1:0.00053%]
[INFO] ** proxy_src_ip:[18:38.48645%,20:25.93055%,13:18.12487%,6:17.45654%,17:0.00053%,16:0.00035%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.92984%,-0.32151:21.08983%,-1.27613:18.12487%,-0.23351:17.45584%,-0.33484:17.39662%,1.45709:0.00053%,-0.24151:0.00053%,-71.33197:0.00053%,-1.02014:0.00035%,-0.08551:0.00035%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.92931%,1:21.08965%,5:18.12487%,4:17.45584%,2:17.39645%,0:0.00389%]
[INFO] ** service:[0.0048200000000000005:99.99876%,-211.73542999999998:0.00053%,-186.43601999999998:0.00035%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.48645%,9:25.93055%,7:18.12487%,1:17.45654%,14:0.00053%,15:0.00035%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1535 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79128.0000 - fp: 872.0000 - tn: 319128.0000 - fn: 872.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79085.0000 - fp: 915.0000 - tn: 319085.0000 - fn: 915.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79141.0000 - fp: 859.0000 - tn: 319141.0000 - fn: 859.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 46-46/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99823%,30:0.00106%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.42336%,Single Stage Single Point:35.57664%]
[INFO] ** dst:[21:43.34538%,10:21.07533%,8:18.10348%,9:17.47316%,22:0.00106%,15:0.00106%,25:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99912%,0:0.00088%]
[INFO] ** i/f_name:[2:99.99894%,3:0.00106%]
[INFO] ** modbus_function_code:[0.02961:99.99823%,-33.760870000000004:0.00177%]
[INFO] ** modbus_function_description:[11:49.99929%,7:49.99894%,0:0.00177%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.99859%,1:0.00106%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.44668%,20:25.97403%,13:18.10348%,6:17.47369%,17:0.00106%,16:0.00035%,7:0.00035%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.97368%,-0.32151:21.07515%,-1.27613:18.10331%,-0.23351:17.47298%,-0.33484:17.37152%,-71.33197:0.00106%,-0.24151:0.00053%,-1.02014:0.00035%,-71.14798:0.00018%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.97332%,1:21.07498%,5:18.10313%,4:17.47263%,2:17.37152%,0:0.00442%]
[INFO] ** service:[0.0048200000000000005:99.99841%,-211.73542999999998:0.00106%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.44668%,9:25.97403%,7:18.10348%,1:17.47369%,14:0.00106%,21:0.00035%,15:0.00035%,16:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99912%,1:0.00088%]
[INFO] ** unixtime:1538 (0.27186%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-2-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-2-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 47-47/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99947%,33:0.00018%,26:0.00018%,17:0.00018%]
[INFO] ** classification:[normal:64.39649%,Single Stage Single Point:35.60351%]
[INFO] ** dst:[21:43.31179%,10:21.08276%,8:18.12876%,9:17.4744%,22:0.00159%,24:0.00035%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99947%,-33.760870000000004:0.00053%]
[INFO] ** modbus_function_description:[7:50.00106%,11:49.99841%,0:0.00053%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.45392%,20:25.94133%,13:18.12911%,6:17.47475%,16:0.00035%,7:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.94045%,-0.32151:21.08276%,-1.27613:18.12858%,-0.23351:17.47422%,-0.33484:17.37117%,1.45709:0.00053%,-0.24151:0.00053%,-1.27347:0.00035%,-1.02014:0.00035%,-71.14798:0.00018%,-61.95635:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%]
[INFO] ** scada_tag:[3:25.93992%,1:21.08258%,5:18.1284%,4:17.47404%,2:17.37099%,0:0.00407%]
[INFO] ** service:[0.0048200000000000005:99.99965%,-211.08346:0.00018%,-205.44247:0.00018%]
[INFO] ** src:[22:38.45392%,9:25.94133%,7:18.12911%,1:17.47475%,21:0.00035%,15:0.00035%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1536 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79085.0000 - fp: 915.0000 - tn: 319085.0000 - fn: 915.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79063.0000 - fp: 937.0000 - tn: 319063.0000 - fn: 937.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 48-48/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99682%,30:0.00247%,33:0.00018%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.43114%,Single Stage Single Point:35.56886%]
[INFO] ** dst:[21:43.3353%,10:21.09195%,8:18.09995%,9:17.46874%,15:0.00247%,22:0.00088%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99788%,0:0.00212%]
[INFO] ** i/f_name:[2:99.99753%,3:0.00247%]
[INFO] ** modbus_function_code:[0.02961:99.99682%,-33.760870000000004:0.00318%]
[INFO] ** modbus_function_description:[7:49.99912%,11:49.9977%,0:0.00318%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.997%,1:0.00247%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.46736%,20:25.96024%,13:18.10012%,6:17.46874%,17:0.00247%,14:0.00053%,16:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95971%,-0.32151:21.09195%,-1.27613:18.09977%,-0.23351:17.46856%,-0.33484:17.37541%,-71.33197:0.00247%,-1.02014:0.00035%,-1.2708:0.00018%,13.431270000000001:0.00018%,-0.24151:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-61.95635:0.00018%,1.45709:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:25.95936%,1:21.09177%,5:18.09977%,4:17.46856%,2:17.37523%,0:0.0053%]
[INFO] ** service:[0.0048200000000000005:99.997%,-211.73542999999998:0.00247%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.46736%,9:25.96024%,7:18.10012%,1:17.46874%,14:0.00247%,2:0.00053%,15:0.00035%,8:0.00018%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1535 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79128.0000 - fp: 872.0000 - tn: 319128.0000 - fn: 872.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 0.0048 - val_tp: 19994.0000 - val_fp: 6.0000 - val_tn: 79994.0000 - val_fn: 6.0000 - val_accuracy: 0.9999 - val_precision: 0.9997 - val_recall: 0.9997 - val_auc: 0.9998
[INFO] saving weights to checkpoints/lstm-epoch-2-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79078.0000 - fp: 922.0000 - tn: 319078.0000 - fn: 922.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 49-49/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99735%,30:0.00088%,17:0.00071%,26:0.00035%,22:0.00035%,28:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.37493%,Single Stage Single Point:35.62507%]
[INFO] ** dst:[21:43.31338%,10:21.0573%,8:18.13441%,9:17.49048%,22:0.00141%,15:0.00088%,16:0.00071%,6:0.00071%,24:0.00035%,17:0.00035%]
[INFO] ** i/f_dir:[1:99.99912%,0:0.00088%]
[INFO] ** i/f_name:[2:99.99912%,3:0.00088%]
[INFO] ** modbus_function_code:[0.02961:99.99735%,-33.760870000000004:0.00265%]
[INFO] ** modbus_function_description:[7:49.99965%,11:49.9977%,0:0.00265%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99841%,1:0.00088%,2:0.00071%]
[INFO] ** proxy_src_ip:[18:38.42246%,20:25.94893%,13:18.13459%,6:17.49101%,17:0.00088%,1:0.00071%,14:0.00053%,21:0.00035%,16:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.94805%,-0.32151:21.0573%,-1.27613:18.13406%,-0.23351:17.4903%,-0.33484:17.36516%,-71.33197:0.00088%,1.45709:0.00053%,-0.24151:0.00053%,-1.27347:0.00035%,-71.14931:0.00035%,-1.02014:0.00035%,-71.14798:0.00035%,1.47576:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,1.46509:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,-5.08665:0.00018%,-0.24950999999999998:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:25.94769%,1:21.05712%,5:18.13388%,4:17.48995%,2:17.36516%,0:0.00619%]
[INFO] ** service:[0.0048200000000000005:99.99735%,-211.73542999999998:0.00088%,-205.44247:0.00071%,-211.08346:0.00035%,-211.08818:0.00035%,-211.09762999999998:0.00018%,-185.9872:0.00018%]
[INFO] ** src:[22:38.42246%,9:25.94893%,7:18.13459%,1:17.49101%,14:0.00088%,3:0.00071%,2:0.00053%,15:0.00035%,4:0.00035%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1536 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0194 - tp: 79171.0000 - fp: 829.0000 - tn: 319171.0000 - fn: 829.0000 - accuracy: 0.9959 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79172.0000 - fp: 828.0000 - tn: 319172.0000 - fn: 828.0000 - accuracy: 0.9959 - precision: 0.9897 - recall: 0.9897 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-2-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0220 - tp: 79064.0000 - fp: 936.0000 - tn: 319064.0000 - fn: 936.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 50-50/50 on epoch 2/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (415724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (415724, 17)

[INFO] analyzing data
[INFO] 415724 rows
[INFO] ** appi_name:[21:99.99759%,30:0.00096%,7:0.00072%,31:0.00024%,22:0.00024%,8:0.00024%]
[INFO] ** classification:[normal:64.30733%,Single Stage Single Point:35.69267%]
[INFO] ** dst:[21:43.26139%,10:21.04281%,8:18.21834%,9:17.47409%,15:0.00096%,22:0.00072%,16:0.00048%,2:0.00048%,24:0.00024%,18:0.00024%,6:0.00024%]
[INFO] ** i/f_dir:[1:99.99904%,0:0.00096%]
[INFO] ** i/f_name:[2:99.99904%,3:0.00096%]
[INFO] ** modbus_function_code:[0.02961:99.99759%,-33.760870000000004:0.00241%]
[INFO] ** modbus_function_description:[11:49.9988%,7:49.9988%,0:0.00241%]
[INFO] ** modbus_transaction_id:65536 (15.76431%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99856%,1:0.00096%,2:0.00048%]
[INFO] ** proxy_src_ip:[18:38.3656%,20:25.93884%,13:18.21858%,6:17.47409%,17:0.00096%,1:0.00072%,16:0.00048%,21:0.00024%,14:0.00024%,7:0.00024%]
[INFO] ** s_port:[1.45442:25.93836%,-0.32151:21.04281%,-1.27613:18.2181%,-0.23351:17.47409%,-0.33484:17.32279%,-71.33197:0.00096%,-1.02014:0.00048%,-3.3787199999999995:0.00024%,4.33564:0.00024%,15.912510000000001:0.00024%,7.9608300000000005:0.00024%,1.46509:0.00024%,1.45709:0.00024%,-1.27347:0.00024%,-71.14931:0.00024%,-1.2708:0.00024%,0.31847:0.00024%]
[INFO] ** scada_tag:[3:25.93812%,1:21.04257%,5:18.21786%,4:17.47409%,2:17.32255%,0:0.00481%]
[INFO] ** service:[0.0048200000000000005:99.99759%,-211.73542999999998:0.00096%,-211.09762999999998:0.00072%,-186.43601999999998:0.00024%,-211.35747999999998:0.00024%,-211.08818:0.00024%]
[INFO] ** src:[22:38.3656%,9:25.93884%,7:18.21858%,1:17.47409%,14:0.00096%,3:0.00072%,15:0.00048%,21:0.00024%,4:0.00024%,2:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1130 (0.27181%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/415724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/415724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/415724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79076.0000 - fp: 924.0000 - tn: 319076.0000 - fn: 924.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/415724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79119.0000 - fp: 881.0000 - tn: 319119.0000 - fn: 881.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-49-50-batch-300000-400000
[INFO] processing batch 400000-500000/415724
[33m[INFO] epoch 3/100[0m
[33m[INFO] loading file 1-1/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99302%,30:0.00116%,22:0.00097%,17:0.00078%,31:0.00058%,26:0.00058%,7:0.00058%,23:0.00039%,18:0.00039%,0:0.00039%,28:0.00019%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:78.84217%,Single Stage Single Point:21.15783%]
[INFO] ** dst:[21:43.26578%,10:21.04381%,8:18.16766%,9:17.51538%,6:0.00155%,16:0.00116%,15:0.00116%,22:0.00097%,18:0.00058%,26:0.00039%,25:0.00039%,19:0.00039%,17:0.00039%,24:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99884%,0:0.00116%]
[INFO] ** i/f_name:[2:99.99884%,3:0.00116%]
[INFO] ** modbus_function_code:[0.02961:99.99302%,-33.760870000000004:0.00679%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99748%,11:49.99554%,0:0.00679%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99612%,2:0.00271%,1:0.00116%]
[INFO] ** proxy_src_ip:[18:38.40523%,20:25.90378%,13:18.16786%,6:17.51576%,11:0.00136%,10:0.00136%,17:0.00116%,14:0.00097%,1:0.00097%,7:0.00058%,21:0.00039%,16:0.00039%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.90339%,-0.32151:21.04304%,-1.27613:18.16747%,-0.23351:17.51518%,-0.33484:17.36219%,-71.33197:0.00116%,-71.14931:0.00097%,-2.1481:0.00078%,-0.24151:0.00058%,-71.14798:0.00058%,-2.42942:0.00039%,4.44364:0.00039%,-1.02014:0.00039%,-64.19493:0.00039%,-5.1466400000000005:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,4.076980000000001:0.00019%,-5.08665:0.00019%,1.47576:0.00019%,1.46509:0.00019%,4.29964:0.00019%,14.253910000000001:0.00019%,-68.79874000000001:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,10.67005:0.00019%,-1.27347:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.9032%,1:21.04284%,5:18.16708%,4:17.51499%,2:17.362%,0:0.00989%]
[INFO] ** service:[0.0048200000000000005:99.9938%,-211.73542999999998:0.00116%,-211.08818:0.00097%,-205.44247:0.00078%,-211.07873999999998:0.00078%,-211.09762999999998:0.00058%,-211.08346:0.00058%,-186.43601999999998:0.00058%,-186.44547:0.00039%,-185.9872:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.40523%,9:25.90378%,7:18.16786%,1:17.51576%,11:0.00136%,10:0.00136%,14:0.00116%,3:0.00097%,2:0.00097%,21:0.00058%,15:0.00039%,4:0.00039%,8:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1400 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.6571 - tp: 69860.0000 - fp: 10136.0000 - tn: 309864.0000 - fn: 10140.0000 - accuracy: 0.9493 - precision: 0.8733 - recall: 0.8733 - auc: 0.9296 - val_loss: 0.5722 - val_tp: 19290.0000 - val_fp: 710.0000 - val_tn: 79290.0000 - val_fn: 710.0000 - val_accuracy: 0.9858 - val_precision: 0.9645 - val_recall: 0.9645 - val_auc: 0.9778
[INFO] saving weights to checkpoints/lstm-epoch-3-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5533 - tp: 77024.0000 - fp: 2976.0000 - tn: 317024.0000 - fn: 2976.0000 - accuracy: 0.9851 - precision: 0.9628 - recall: 0.9628 - auc: 0.9774 - val_loss: 0.5633 - val_tp: 19301.0000 - val_fp: 699.0000 - val_tn: 79301.0000 - val_fn: 699.0000 - val_accuracy: 0.9860 - val_precision: 0.9650 - val_recall: 0.9650 - val_auc: 0.9782
[INFO] saving weights to checkpoints/lstm-epoch-3-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3020 - tp: 78083.0000 - fp: 1917.0000 - tn: 318083.0000 - fn: 1917.0000 - accuracy: 0.9904 - precision: 0.9760 - recall: 0.9760 - auc: 0.9863 - val_loss: 1.8079 - val_tp: 17757.0000 - val_fp: 2243.0000 - val_tn: 77757.0000 - val_fn: 2243.0000 - val_accuracy: 0.9551 - val_precision: 0.8878 - val_recall: 0.8878 - val_auc: 0.9289
[INFO] saving weights to checkpoints/lstm-epoch-3-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.1270 - tp: 41365.0000 - fp: 38635.0000 - tn: 281365.0000 - fn: 38635.0000 - accuracy: 0.8068 - precision: 0.5171 - recall: 0.5171 - auc: 0.8416 - val_loss: 0.5553 - val_tp: 10662.0000 - val_fp: 9338.0000 - val_tn: 70662.0000 - val_fn: 9338.0000 - val_accuracy: 0.8132 - val_precision: 0.5331 - val_recall: 0.5331 - val_auc: 0.9453
[INFO] saving weights to checkpoints/lstm-epoch-3-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5057 - tp: 45644.0000 - fp: 34356.0000 - tn: 285644.0000 - fn: 34356.0000 - accuracy: 0.8282 - precision: 0.5706 - recall: 0.5706 - auc: 0.9355 - val_loss: 0.3180 - val_tp: 19019.0000 - val_fp: 981.0000 - val_tn: 79019.0000 - val_fn: 981.0000 - val_accuracy: 0.9804 - val_precision: 0.9510 - val_recall: 0.9510 - val_auc: 0.9922
[INFO] saving weights to checkpoints/lstm-epoch-3-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 2-2/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99864%,7:0.00058%,30:0.00039%,31:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:72.18764%,Single Stage Single Point:27.81236%]
[INFO] ** dst:[21:43.31348%,10:21.03199%,8:18.13606%,9:17.51615%,22:0.00078%,16:0.00039%,15:0.00039%,2:0.00039%,24:0.00019%,18:0.00019%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99961%,3:0.00039%]
[INFO] ** modbus_function_code:[0.02961:99.99864%,-33.760870000000004:0.00136%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99884%,0:0.00136%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99942%,1:0.00039%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.38545%,20:25.96059%,13:18.13606%,6:17.51635%,1:0.00058%,17:0.00039%,16:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.95982%,-0.32151:21.03199%,-1.27613:18.13567%,-0.23351:17.51596%,-0.33484:17.35347%,-71.33197:0.00039%,1.45709:0.00039%,12.60597:0.00019%,-1.2708:0.00019%,-1.02014:0.00019%,-0.24151:0.00019%,4.076980000000001:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-1.27347:0.00019%,-3.3787199999999995:0.00019%,-0.24950999999999998:0.00019%,10.67005:0.00019%,4.29964:0.00019%]
[INFO] ** scada_tag:[3:25.95943%,1:21.03199%,5:18.13567%,4:17.51576%,2:17.35327%,0:0.00388%]
[INFO] ** service:[0.0048200000000000005:99.99864%,-211.09762999999998:0.00058%,-211.73542999999998:0.00039%,-186.43601999999998:0.00019%,-211.35747999999998:0.00019%]
[INFO] ** src:[22:38.38545%,9:25.96059%,7:18.13606%,1:17.51635%,3:0.00058%,14:0.00039%,21:0.00019%,15:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1403 (0.27204%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3025 - tp: 75978.0000 - fp: 4022.0000 - tn: 315978.0000 - fn: 4022.0000 - accuracy: 0.9799 - precision: 0.9497 - recall: 0.9497 - auc: 0.9948 - val_loss: 0.2084 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3670 - tp: 59776.0000 - fp: 20224.0000 - tn: 299776.0000 - fn: 20224.0000 - accuracy: 0.8989 - precision: 0.7472 - recall: 0.7472 - auc: 0.9680 - val_loss: 0.4131 - val_tp: 11181.0000 - val_fp: 8819.0000 - val_tn: 71181.0000 - val_fn: 8819.0000 - val_accuracy: 0.8236 - val_precision: 0.5591 - val_recall: 0.5591 - val_auc: 0.9466
[INFO] saving weights to checkpoints/lstm-epoch-3-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1364 - tp: 71337.0000 - fp: 8663.0000 - tn: 311337.0000 - fn: 8663.0000 - accuracy: 0.9567 - precision: 0.8917 - recall: 0.8917 - auc: 0.9954 - val_loss: 6.6505 - val_tp: 10612.0000 - val_fp: 9388.0000 - val_tn: 70612.0000 - val_fn: 9388.0000 - val_accuracy: 0.8122 - val_precision: 0.5306 - val_recall: 0.5306 - val_auc: 0.7179
[INFO] saving weights to checkpoints/lstm-epoch-3-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6105 - tp: 74117.0000 - fp: 5883.0000 - tn: 314117.0000 - fn: 5883.0000 - accuracy: 0.9706 - precision: 0.9265 - recall: 0.9265 - auc: 0.9758 - val_loss: 0.1964 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3660 - tp: 60320.0000 - fp: 19680.0000 - tn: 300320.0000 - fn: 19680.0000 - accuracy: 0.9016 - precision: 0.7540 - recall: 0.7540 - auc: 0.9691 - val_loss: 0.4425 - val_tp: 10576.0000 - val_fp: 9424.0000 - val_tn: 70576.0000 - val_fn: 9424.0000 - val_accuracy: 0.8115 - val_precision: 0.5288 - val_recall: 0.5288 - val_auc: 0.9445
[INFO] saving weights to checkpoints/lstm-epoch-3-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 3-3/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99108%,30:0.00233%,22:0.00116%,31:0.00097%,26:0.00097%,17:0.00097%,7:0.00078%,27:0.00039%,0:0.00039%,28:0.00019%,23:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:87.11675%,Single Stage Single Point:12.88325%]
[INFO] ** dst:[21:43.30611%,10:21.08861%,8:18.1539%,9:17.4415%,6:0.00233%,15:0.00155%,18:0.00136%,16:0.00136%,22:0.00097%,2:0.00039%,7:0.00039%,25:0.00039%,17:0.00039%,12:0.00019%,24:0.00019%,19:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99845%,0:0.00155%]
[INFO] ** i/f_name:[2:99.99845%,3:0.00155%]
[INFO] ** modbus_function_code:[0.02961:99.99108%,-33.760870000000004:0.00873%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99632%,11:49.99476%,0:0.00873%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99884%,2:0.00116%]
[INFO] ** proto:[0:99.9938%,2:0.00465%,1:0.00155%]
[INFO] ** proxy_src_ip:[18:38.42036%,20:25.97475%,13:18.15409%,6:17.44189%,17:0.00233%,1:0.00155%,14:0.00136%,7:0.00097%,11:0.00078%,10:0.00078%,21:0.00058%,16:0.00019%,15:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97397%,-0.32151:21.08841%,-1.27613:18.15351%,-0.23351:17.44131%,-0.33484:17.33194%,-71.33197:0.00155%,-71.14798:0.00116%,-71.14931:0.00116%,-64.19493:0.00039%,-0.08551:0.00039%,1.45709:0.00039%,-0.24151:0.00039%,13.431270000000001:0.00019%,14.4699:0.00019%,4.076980000000001:0.00019%,-5.1466400000000005:0.00019%,-1.02014:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,12.60597:0.00019%,-5.08665:0.00019%,1.46509:0.00019%,-2.1481:0.00019%,-1.27347:0.00019%,10.67005:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,6.1115699999999995:0.00019%,4.44364:0.00019%,13.86459:0.00019%,4.29964:0.00019%,-0.24950999999999998:0.00019%,-3.3787199999999995:0.00019%,10.192739999999999:0.00019%,-68.79874000000001:0.00019%,14.253910000000001:0.00019%,4.90362:0.00019%,-68.36943000000001:0.00019%]
[INFO] ** scada_tag:[3:25.97358%,1:21.08822%,5:18.15331%,4:17.44111%,2:17.33175%,0:0.01202%]
[INFO] ** service:[0.0048200000000000005:99.99127%,-211.73542999999998:0.00155%,-186.43601999999998:0.00136%,-211.08346:0.00116%,-211.08818:0.00116%,-205.44247:0.00097%,-211.09762999999998:0.00078%,-186.44547:0.00039%,-202.75898:0.00039%,-183.8612:0.00019%,-185.9872:0.00019%,-201.23771000000002:0.00019%,-211.35747999999998:0.00019%,-211.07873999999998:0.00019%]
[INFO] ** src:[22:38.42036%,9:25.97475%,7:18.15409%,1:17.44189%,21:0.00213%,3:0.00175%,2:0.00136%,11:0.00078%,10:0.00078%,4:0.00078%,14:0.00039%,8:0.00039%,17:0.00019%,15:0.00019%,13:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1400 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2597 - tp: 72134.0000 - fp: 7866.0000 - tn: 312134.0000 - fn: 7866.0000 - accuracy: 0.9607 - precision: 0.9017 - recall: 0.9017 - auc: 0.9901 - val_loss: 0.1938 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2820 - tp: 70338.0000 - fp: 9662.0000 - tn: 310338.0000 - fn: 9662.0000 - accuracy: 0.9517 - precision: 0.8792 - recall: 0.8792 - auc: 0.9846 - val_loss: 0.5629 - val_tp: 10611.0000 - val_fp: 9389.0000 - val_tn: 70611.0000 - val_fn: 9389.0000 - val_accuracy: 0.8122 - val_precision: 0.5306 - val_recall: 0.5306 - val_auc: 0.9449
[INFO] saving weights to checkpoints/lstm-epoch-3-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1282 - tp: 70803.0000 - fp: 9197.0000 - tn: 310803.0000 - fn: 9197.0000 - accuracy: 0.9540 - precision: 0.8850 - recall: 0.8850 - auc: 0.9965 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0342 - tp: 77331.0000 - fp: 2669.0000 - tn: 317331.0000 - fn: 2669.0000 - accuracy: 0.9867 - precision: 0.9666 - recall: 0.9666 - auc: 0.9997 - val_loss: 1.0829e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0310 - tp: 77416.0000 - fp: 2584.0000 - tn: 317416.0000 - fn: 2584.0000 - accuracy: 0.9871 - precision: 0.9677 - recall: 0.9677 - auc: 0.9997 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 4-4/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99767%,30:0.00136%,31:0.00039%,33:0.00019%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:91.51096%,Single Stage Single Point:8.48904%]
[INFO] ** dst:[21:43.35517%,10:20.94143%,8:18.17174%,9:17.52817%,15:0.00136%,22:0.00116%,18:0.00039%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99884%,0:0.00116%]
[INFO] ** i/f_name:[2:99.99864%,3:0.00136%]
[INFO] ** modbus_function_code:[0.02961:99.99767%,-33.760870000000004:0.00233%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99787%,0:0.00233%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99884%,2:0.00116%]
[INFO] ** proto:[0:99.99806%,1:0.00136%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.25884%,20:26.03815%,13:18.17174%,6:17.52856%,17:0.00136%,21:0.00039%,16:0.00039%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.03738%,-0.32151:20.94124%,-1.27613:18.17135%,-0.23351:17.52798%,-0.33484:17.3176%,-71.33197:0.00136%,1.45709:0.00039%,-0.24151:0.00039%,-1.02014:0.00039%,-0.08551:0.00039%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,14.4699:0.00019%,-49.275529999999996:0.00019%,-1.2708:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:26.03718%,1:20.94105%,5:18.17135%,4:17.52759%,2:17.3174%,0:0.00543%]
[INFO] ** service:[0.0048200000000000005:99.99787%,-211.73542999999998:0.00136%,-186.43601999999998:0.00039%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.25884%,9:26.03815%,7:18.17174%,1:17.52856%,21:0.00116%,15:0.00039%,4:0.00039%,17:0.00019%,14:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1411 (0.2736%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0284 - tp: 77461.0000 - fp: 2539.0000 - tn: 317461.0000 - fn: 2539.0000 - accuracy: 0.9873 - precision: 0.9683 - recall: 0.9683 - auc: 0.9997 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0251 - tp: 77503.0000 - fp: 2497.0000 - tn: 317503.0000 - fn: 2497.0000 - accuracy: 0.9875 - precision: 0.9688 - recall: 0.9688 - auc: 0.9997 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0219 - tp: 78137.0000 - fp: 1863.0000 - tn: 318137.0000 - fn: 1863.0000 - accuracy: 0.9907 - precision: 0.9767 - recall: 0.9767 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.9407 - val_tp: 8906.0000 - val_fp: 11094.0000 - val_tn: 68906.0000 - val_fn: 11094.0000 - val_accuracy: 0.7781 - val_precision: 0.4453 - val_recall: 0.4453 - val_auc: 0.6533
[INFO] saving weights to checkpoints/lstm-epoch-3-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.6953 - tp: 56697.0000 - fp: 23303.0000 - tn: 296697.0000 - fn: 23303.0000 - accuracy: 0.8835 - precision: 0.7087 - recall: 0.7087 - auc: 0.9057 - val_loss: 0.5322 - val_tp: 8386.0000 - val_fp: 11614.0000 - val_tn: 68386.0000 - val_fn: 11614.0000 - val_accuracy: 0.7677 - val_precision: 0.4193 - val_recall: 0.4193 - val_auc: 0.9132
[INFO] saving weights to checkpoints/lstm-epoch-3-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 5-5/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.9967%,30:0.00233%,37:0.00019%,26:0.00019%,12:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:89.07458%,Single Stage Single Point:10.92542%]
[INFO] ** dst:[21:43.36641%,10:20.76285%,8:18.24813%,9:17.61873%,15:0.00233%,22:0.00078%,25:0.00019%,24:0.00019%,6:0.00019%,2:0.00019%]
[INFO] ** i/f_dir:[1:99.99806%,0:0.00194%]
[INFO] ** i/f_name:[2:99.99767%,3:0.00233%]
[INFO] ** modbus_function_code:[0.02961:99.9967%,-33.760870000000004:0.0033%]
[INFO] ** modbus_function_description:[7:49.99884%,11:49.99787%,0:0.0033%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99825%,2:0.00175%]
[INFO] ** proto:[0:99.99729%,1:0.00233%,2:0.00039%]
[INFO] ** proxy_src_ip:[18:37.99416%,20:26.13491%,13:18.24833%,6:17.61911%,17:0.00233%,21:0.00019%,16:0.00019%,7:0.00019%,5:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.13472%,-0.32151:20.76246%,-1.27613:18.24813%,-0.23351:17.61873%,-0.33484:17.2317%,-71.33197:0.00233%,-0.24151:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,1.45709:0.00019%,2.22906:0.00019%,-49.275529999999996:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:26.13433%,1:20.76227%,5:18.24794%,4:17.61873%,2:17.2317%,0:0.00504%]
[INFO] ** service:[0.0048200000000000005:99.99709%,-211.73542999999998:0.00233%,-186.44547:0.00019%,-211.08346:0.00019%,-211.35747999999998:0.00019%]
[INFO] ** src:[22:37.99416%,9:26.13491%,7:18.24833%,1:17.61911%,21:0.00194%,14:0.00058%,16:0.00019%,15:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1409 (0.27321%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4946 - tp: 58402.0000 - fp: 21598.0000 - tn: 298402.0000 - fn: 21598.0000 - accuracy: 0.8920 - precision: 0.7300 - recall: 0.7300 - auc: 0.9602 - val_loss: 0.4587 - val_tp: 12789.0000 - val_fp: 7211.0000 - val_tn: 72789.0000 - val_fn: 7211.0000 - val_accuracy: 0.8558 - val_precision: 0.6395 - val_recall: 0.6395 - val_auc: 0.9484
[INFO] saving weights to checkpoints/lstm-epoch-3-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2370 - tp: 74220.0000 - fp: 5780.0000 - tn: 314220.0000 - fn: 5780.0000 - accuracy: 0.9711 - precision: 0.9277 - recall: 0.9277 - auc: 0.9945 - val_loss: 0.1406 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2638 - tp: 65113.0000 - fp: 14887.0000 - tn: 305113.0000 - fn: 14887.0000 - accuracy: 0.9256 - precision: 0.8139 - recall: 0.8139 - auc: 0.9859 - val_loss: 0.0229 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0281 - tp: 78590.0000 - fp: 1410.0000 - tn: 318590.0000 - fn: 1410.0000 - accuracy: 0.9930 - precision: 0.9824 - recall: 0.9824 - auc: 0.9998 - val_loss: 5.3652e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0219 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3004e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 6-6/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99554%,30:0.00349%,31:0.00019%,27:0.00019%,26:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:92.16538%,Single Stage Single Point:7.83462%]
[INFO] ** dst:[21:43.37708%,10:20.7295%,8:18.28517%,9:17.60321%,15:0.00349%,22:0.00039%,25:0.00019%,24:0.00019%,18:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.9967%,0:0.0033%]
[INFO] ** i/f_name:[2:99.99651%,3:0.00349%]
[INFO] ** modbus_function_code:[0.02961:99.99554%,-33.760870000000004:0.00446%]
[INFO] ** modbus_function_description:[7:49.99845%,11:49.99709%,0:0.00446%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.99554%,1:0.00349%,2:0.00097%]
[INFO] ** proxy_src_ip:[18:37.94665%,20:26.16012%,13:18.28536%,6:17.60341%,17:0.00349%,14:0.00058%,16:0.00019%,11:0.00019%]
[INFO] ** s_port:[1.45442:26.15973%,-0.32151:20.7295%,-1.27613:18.28478%,-0.23351:17.60302%,-0.33484:17.21715%,-71.33197:0.00349%,-0.24151:0.00019%,-1.2708:0.00019%,-64.19493:0.00019%,-1.02014:0.00019%,13.431270000000001:0.00019%,4.90362:0.00019%,-71.14798:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-1.27347:0.00019%,-68.36943000000001:0.00019%]
[INFO] ** scada_tag:[3:26.15953%,1:20.7293%,5:18.28459%,4:17.60263%,2:17.21696%,0:0.00698%]
[INFO] ** service:[0.0048200000000000005:99.99554%,-211.73542999999998:0.00349%,-186.44547:0.00019%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-201.23771000000002:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:37.94665%,9:26.16012%,7:18.28536%,1:17.60341%,14:0.00349%,2:0.00058%,15:0.00019%,10:0.00019%]
[INFO] ** type:[0:99.99903%,1:0.00097%]
[INFO] ** unixtime:1412 (0.27379%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0192 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4221e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0177 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7277e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0165 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8569e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0149 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7241e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4944 - tp: 66088.0000 - fp: 13912.0000 - tn: 306088.0000 - fn: 13912.0000 - accuracy: 0.9304 - precision: 0.8261 - recall: 0.8261 - auc: 0.9727 - val_loss: 0.1672 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 7-7/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99535%,30:0.00136%,22:0.00097%,17:0.00078%,26:0.00058%,31:0.00039%,28:0.00019%,27:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:82.14064%,Single Stage Single Point:17.85936%]
[INFO] ** dst:[21:43.36157%,10:20.74695%,8:18.24794%,9:17.63715%,6:0.00155%,22:0.00136%,15:0.00136%,16:0.00078%,24:0.00039%,18:0.00039%,17:0.00039%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99864%,0:0.00136%]
[INFO] ** i/f_name:[2:99.99864%,3:0.00136%]
[INFO] ** modbus_function_code:[0.02961:99.99535%,-33.760870000000004:0.00465%]
[INFO] ** modbus_function_description:[7:49.99845%,11:49.9969%,0:0.00465%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99651%,2:0.00213%,1:0.00136%]
[INFO] ** proxy_src_ip:[18:37.97147%,20:26.13782%,13:18.24833%,6:17.63734%,17:0.00136%,11:0.00078%,1:0.00078%,21:0.00058%,16:0.00039%,14:0.00039%,7:0.00039%,10:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.13685%,-0.32151:20.74695%,-1.27613:18.24774%,-0.23351:17.63695%,-0.33484:17.22452%,-71.33197:0.00136%,-71.14931:0.00097%,-71.14798:0.00058%,1.45709:0.00058%,-1.02014:0.00039%,-1.27347:0.00039%,-0.24151:0.00039%,-58.035180000000004:0.00019%,-1.2708:0.00019%,-5.1466400000000005:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-5.08665:0.00019%,14.253910000000001:0.00019%,-68.79874000000001:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:26.13646%,1:20.74695%,5:18.24774%,4:17.63676%,2:17.22452%,0:0.00756%]
[INFO] ** service:[0.0048200000000000005:99.99535%,-211.73542999999998:0.00136%,-211.08818:0.00097%,-205.44247:0.00078%,-211.08346:0.00058%,-186.43601999999998:0.00039%,-211.09762999999998:0.00019%,-185.9872:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:37.97147%,9:26.13782%,7:18.24833%,1:17.63734%,14:0.00136%,10:0.00078%,3:0.00078%,4:0.00058%,21:0.00039%,15:0.00039%,2:0.00039%,11:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1409 (0.27321%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1660 - tp: 78118.0000 - fp: 1882.0000 - tn: 318118.0000 - fn: 1882.0000 - accuracy: 0.9906 - precision: 0.9765 - recall: 0.9765 - auc: 0.9975 - val_loss: 0.1046 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1186 - tp: 78403.0000 - fp: 1597.0000 - tn: 318403.0000 - fn: 1597.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9982 - val_loss: 0.0745 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2819 - tp: 69847.0000 - fp: 10153.0000 - tn: 309847.0000 - fn: 10153.0000 - accuracy: 0.9492 - precision: 0.8731 - recall: 0.8731 - auc: 0.9865 - val_loss: 0.4877 - val_tp: 12846.0000 - val_fp: 7154.0000 - val_tn: 72846.0000 - val_fn: 7154.0000 - val_accuracy: 0.8569 - val_precision: 0.6423 - val_recall: 0.6423 - val_auc: 0.9680
[INFO] saving weights to checkpoints/lstm-epoch-3-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3483 - tp: 52791.0000 - fp: 27209.0000 - tn: 292791.0000 - fn: 27209.0000 - accuracy: 0.8640 - precision: 0.6599 - recall: 0.6599 - auc: 0.9702 - val_loss: 0.2195 - val_tp: 16168.0000 - val_fp: 3832.0000 - val_tn: 76168.0000 - val_fn: 3832.0000 - val_accuracy: 0.9234 - val_precision: 0.8084 - val_recall: 0.8084 - val_auc: 0.9865
[INFO] saving weights to checkpoints/lstm-epoch-3-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0776 - tp: 78267.0000 - fp: 1733.0000 - tn: 318267.0000 - fn: 1733.0000 - accuracy: 0.9913 - precision: 0.9783 - recall: 0.9783 - auc: 0.9998 - val_loss: 0.0100 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 8-8/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99709%,30:0.00097%,0:0.00058%,24:0.00019%,23:0.00019%,22:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:94.45866%,Single Stage Single Point:5.54134%]
[INFO] ** dst:[21:43.43312%,10:20.81133%,8:18.1727%,9:17.57917%,22:0.00136%,15:0.00097%,25:0.00058%,19:0.00039%,26:0.00019%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99942%,0:0.00058%]
[INFO] ** i/f_name:[2:99.99903%,3:0.00097%]
[INFO] ** modbus_function_code:[0.02961:99.99709%,-33.760870000000004:0.00271%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99961%,11:49.99748%,0:0.00271%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99961%,2:0.00039%]
[INFO] ** proto:[0:99.99825%,1:0.00097%,2:0.00078%]
[INFO] ** proxy_src_ip:[18:38.10003%,20:26.14499%,13:18.17193%,6:17.57956%,10:0.00116%,17:0.00097%,16:0.00058%,14:0.00039%,11:0.00019%,5:0.00019%]
[INFO] ** s_port:[1.45442:26.14441%,-0.32151:20.81133%,-1.27613:18.17174%,-0.23351:17.57898%,-0.33484:17.2887%,-71.33197:0.00097%,-15.039579999999999:0.00078%,-1.02014:0.00058%,-64.19493:0.00058%,1.45709:0.00039%,-0.24151:0.00039%,4.66896:0.00039%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-71.14931:0.00019%]
[INFO] ** scada_tag:[3:26.14402%,1:20.81113%,5:18.17174%,4:17.57878%,2:17.28851%,0:0.00582%]
[INFO] ** service:[0.0048200000000000005:99.99787%,-211.73542999999998:0.00097%,-186.44547:0.00058%,-211.07873999999998:0.00039%,-211.08818:0.00019%]
[INFO] ** src:[22:38.10003%,9:26.14499%,7:18.17193%,1:17.57956%,11:0.00116%,15:0.00058%,14:0.00058%,21:0.00039%,2:0.00039%,16:0.00019%,10:0.00019%]
[INFO] ** type:[0:99.99942%,1:0.00039%,2:0.00019%]
[INFO] ** unixtime:1413 (0.27398%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0264 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.2104e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0183 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8458e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0167 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3043e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2583 - tp: 76006.0000 - fp: 3994.0000 - tn: 316006.0000 - fn: 3994.0000 - accuracy: 0.9800 - precision: 0.9501 - recall: 0.9501 - auc: 0.9905 - val_loss: 0.3589 - val_tp: 16360.0000 - val_fp: 3640.0000 - val_tn: 76360.0000 - val_fn: 3640.0000 - val_accuracy: 0.9272 - val_precision: 0.8180 - val_recall: 0.8180 - val_auc: 0.9834
[INFO] saving weights to checkpoints/lstm-epoch-3-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2752 - tp: 65652.0000 - fp: 14348.0000 - tn: 305652.0000 - fn: 14348.0000 - accuracy: 0.9283 - precision: 0.8206 - recall: 0.8206 - auc: 0.9827 - val_loss: 0.2346 - val_tp: 16769.0000 - val_fp: 3231.0000 - val_tn: 76769.0000 - val_fn: 3231.0000 - val_accuracy: 0.9354 - val_precision: 0.8385 - val_recall: 0.8385 - val_auc: 0.9840
[INFO] saving weights to checkpoints/lstm-epoch-3-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 9-9/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99825%,30:0.00097%,31:0.00039%,26:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:95.67327%,Single Stage Single Point:4.32673%]
[INFO] ** dst:[21:43.3606%,10:20.77351%,8:18.28963%,9:17.57355%,15:0.00097%,22:0.00078%,18:0.00039%,25:0.00019%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99903%,0:0.00097%]
[INFO] ** i/f_name:[2:99.99903%,3:0.00097%]
[INFO] ** modbus_function_code:[0.02961:99.99825%,-33.760870000000004:0.00175%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99825%,0:0.00175%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99981%,2:0.00019%]
[INFO] ** proto:[0:99.99825%,1:0.00097%,2:0.00078%]
[INFO] ** proxy_src_ip:[18:38.00579%,20:26.1289%,13:18.28982%,6:17.57374%,17:0.00097%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.12812%,-0.32151:20.77351%,-1.27613:18.28943%,-0.23351:17.57335%,-0.33484:17.23228%,-71.33197:0.00097%,1.45709:0.00039%,-0.24151:0.00039%,-0.08551:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.12773%,1:20.77332%,5:18.28943%,4:17.57316%,2:17.23228%,0:0.00407%]
[INFO] ** service:[0.0048200000000000005:99.99825%,-211.73542999999998:0.00097%,-186.43601999999998:0.00039%,-186.44547:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.00579%,9:26.1289%,7:18.28982%,1:17.57374%,14:0.00078%,21:0.00019%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1411 (0.2736%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2550 - tp: 66457.0000 - fp: 13543.0000 - tn: 306457.0000 - fn: 13543.0000 - accuracy: 0.9323 - precision: 0.8307 - recall: 0.8307 - auc: 0.9844 - val_loss: 0.2259 - val_tp: 16722.0000 - val_fp: 3278.0000 - val_tn: 76722.0000 - val_fn: 3278.0000 - val_accuracy: 0.9344 - val_precision: 0.8361 - val_recall: 0.8361 - val_auc: 0.9866
[INFO] saving weights to checkpoints/lstm-epoch-3-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1985 - tp: 75978.0000 - fp: 4022.0000 - tn: 315978.0000 - fn: 4022.0000 - accuracy: 0.9799 - precision: 0.9497 - recall: 0.9497 - auc: 0.9950 - val_loss: 0.1081 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0601 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0077 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0298 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0019 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0169 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.5427e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 10-10/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99651%,30:0.00194%,24:0.00019%,23:0.00019%,22:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:94.07648%,Single Stage Single Point:5.92352%]
[INFO] ** dst:[21:43.41489%,10:20.81288%,8:18.22002%,9:17.54853%,15:0.00194%,22:0.00058%,24:0.00039%,19:0.00039%,26:0.00019%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99825%,0:0.00175%]
[INFO] ** i/f_name:[2:99.99806%,3:0.00194%]
[INFO] ** modbus_function_code:[0.02961:99.99651%,-33.760870000000004:0.0033%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99884%,11:49.99767%,0:0.0033%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99922%,1:0.00078%]
[INFO] ** proto:[0:99.99767%,1:0.00194%,2:0.00039%]
[INFO] ** proxy_src_ip:[18:38.09906%,20:26.12909%,13:18.22021%,6:17.54795%,17:0.00194%,10:0.00097%,14:0.00039%,16:0.00019%,5:0.00019%]
[INFO] ** s_port:[1.45442:26.12851%,-0.32151:20.81288%,-1.27613:18.21963%,-0.23351:17.54756%,-0.33484:17.28618%,-71.33197:0.00194%,-10.51843:0.00078%,5.71692:0.00039%,-1.27347:0.00039%,1.46509:0.00019%,1.47576:0.00019%,-0.24950999999999998:0.00019%,1.45709:0.00019%,-0.24151:0.00019%,-71.14931:0.00019%,-1.02014:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.12812%,1:20.81268%,5:18.21963%,4:17.54737%,2:17.28599%,0:0.0062%]
[INFO] ** service:[0.0048200000000000005:99.99729%,-211.73542999999998:0.00194%,-211.07873999999998:0.00039%,-186.44547:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.09906%,9:26.12909%,7:18.22021%,1:17.54795%,14:0.00194%,11:0.00097%,2:0.00039%,16:0.00019%,15:0.00019%]
[INFO] ** type:[0:99.99845%,1:0.00136%,2:0.00019%]
[INFO] ** unixtime:1409 (0.27321%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0117 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9695e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0098 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0347 - val_tp: 18412.0000 - val_fp: 1588.0000 - val_tn: 78412.0000 - val_fn: 1588.0000 - val_accuracy: 0.9682 - val_precision: 0.9206 - val_recall: 0.9206 - val_auc: 0.9518
[INFO] saving weights to checkpoints/lstm-epoch-3-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6220 - tp: 53827.0000 - fp: 26173.0000 - tn: 293827.0000 - fn: 26173.0000 - accuracy: 0.8691 - precision: 0.6728 - recall: 0.6728 - auc: 0.9627 - val_loss: 0.3829 - val_tp: 19083.0000 - val_fp: 917.0000 - val_tn: 79083.0000 - val_fn: 917.0000 - val_accuracy: 0.9817 - val_precision: 0.9542 - val_recall: 0.9542 - val_auc: 0.9757
[INFO] saving weights to checkpoints/lstm-epoch-3-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1465 - tp: 79869.0000 - fp: 131.0000 - tn: 319869.0000 - fn: 131.0000 - accuracy: 0.9993 - precision: 0.9984 - recall: 0.9984 - auc: 0.9994 - val_loss: 0.1049 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0951 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0746 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 11-11/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99884%,31:0.00039%,30:0.00039%,26:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.38483%,10:20.88055%,8:18.19791%,9:17.53418%,22:0.00136%,18:0.00039%,15:0.00039%,25:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99961%,3:0.00039%]
[INFO] ** modbus_function_code:[0.02961:99.99884%,-33.760870000000004:0.00116%]
[INFO] ** modbus_function_description:[7:50.00058%,11:49.99825%,0:0.00116%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99884%,2:0.00078%,1:0.00039%]
[INFO] ** proxy_src_ip:[18:38.1487%,20:26.11707%,13:18.19791%,6:17.53457%,16:0.00058%,17:0.00039%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.11649%,-0.32151:20.88055%,-1.27613:18.19772%,-0.23351:17.53399%,-0.33484:17.26815%,-0.24151:0.00058%,-1.02014:0.00058%,-0.08551:0.00039%,-71.33197:0.00039%,-71.14798:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.1161%,1:20.88055%,5:18.19752%,4:17.5336%,2:17.26796%,0:0.00427%]
[INFO] ** service:[0.0048200000000000005:99.99884%,-211.73542999999998:0.00039%,-186.43601999999998:0.00039%,-186.44547:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.1487%,9:26.11707%,7:18.19791%,1:17.53457%,15:0.00058%,14:0.00039%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1410 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0661 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0495 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0444 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0235 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0159 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.8413e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0063 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7782e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0048 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.9035e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 12-12/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99767%,30:0.00213%,9:0.00019%]
[INFO] ** classification:[normal:92.98249%,Single Stage Single Point:7.01751%]
[INFO] ** dst:[21:43.3922%,10:20.87221%,8:18.1919%,9:17.54039%,15:0.00213%,22:0.00058%,24:0.00039%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99825%,0:0.00175%]
[INFO] ** i/f_name:[2:99.99787%,3:0.00213%]
[INFO] ** modbus_function_code:[0.02961:99.99767%,-33.760870000000004:0.00233%]
[INFO] ** modbus_function_description:[7:49.99961%,11:49.99806%,0:0.00233%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99825%,2:0.00175%]
[INFO] ** proto:[0:99.99787%,1:0.00213%]
[INFO] ** proxy_src_ip:[18:38.139%,20:26.1258%,13:18.19209%,6:17.54058%,17:0.00213%,16:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:26.12521%,-0.32151:20.87221%,-1.27613:18.19151%,-0.23351:17.5402%,-0.33484:17.26679%,-71.33197:0.00213%,-1.27347:0.00039%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.12483%,1:20.87221%,5:18.19151%,4:17.53981%,2:17.26679%,0:0.00485%]
[INFO] ** service:[0.0048200000000000005:99.99767%,-211.73542999999998:0.00213%,-183.8612:0.00019%]
[INFO] ** src:[22:38.139%,9:26.1258%,7:18.19209%,1:17.54058%,21:0.00175%,14:0.00039%,15:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1410 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0043 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0401e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0040 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1507e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6937 - tp: 55617.0000 - fp: 24383.0000 - tn: 295617.0000 - fn: 24383.0000 - accuracy: 0.8781 - precision: 0.6952 - recall: 0.6952 - auc: 0.9626 - val_loss: 0.3843 - val_tp: 13565.0000 - val_fp: 6435.0000 - val_tn: 73565.0000 - val_fn: 6435.0000 - val_accuracy: 0.8713 - val_precision: 0.6783 - val_recall: 0.6783 - val_auc: 0.9741
[INFO] saving weights to checkpoints/lstm-epoch-3-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1576 - tp: 77223.0000 - fp: 2777.0000 - tn: 317223.0000 - fn: 2777.0000 - accuracy: 0.9861 - precision: 0.9653 - recall: 0.9653 - auc: 0.9966 - val_loss: 0.0966 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0851 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0650 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 13-13/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99632%,31:0.00078%,26:0.00058%,0:0.00058%,30:0.00039%,22:0.00039%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:85.16396%,Single Stage Single Point:14.83604%]
[INFO] ** dst:[21:43.35439%,10:20.80008%,8:18.27935%,9:17.56191%,22:0.00116%,6:0.00097%,18:0.00078%,25:0.00058%,15:0.00039%,24:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99961%,3:0.00039%]
[INFO] ** modbus_function_code:[0.02961:99.99632%,-33.760870000000004:0.00349%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99884%,11:49.99748%,0:0.00349%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99709%,2:0.00252%,1:0.00039%]
[INFO] ** proxy_src_ip:[18:38.05214%,20:26.10272%,13:18.27954%,6:17.56133%,10:0.00116%,11:0.00097%,16:0.00058%,17:0.00039%,7:0.00039%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.10214%,-0.32151:20.80008%,-1.27613:18.27916%,-0.23351:17.56094%,-0.33484:17.25206%,-9.78512:0.00078%,-71.14798:0.00058%,-64.19493:0.00058%,-1.02014:0.00058%,-0.08551:0.00039%,-71.14931:0.00039%,-0.24151:0.00039%,-71.33197:0.00039%,-1.27347:0.00019%,1.46509:0.00019%,-68.79874000000001:0.00019%,14.540560000000001:0.00019%,1.45709:0.00019%,-1.2708:0.00019%,6.1115699999999995:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:26.10175%,1:20.79989%,5:18.27916%,4:17.56094%,2:17.25186%,0:0.0064%]
[INFO] ** service:[0.0048200000000000005:99.99709%,-186.43601999999998:0.00078%,-186.44547:0.00058%,-211.08346:0.00058%,-211.73542999999998:0.00039%,-211.08818:0.00039%,-202.75898:0.00019%]
[INFO] ** src:[22:38.05214%,9:26.10272%,7:18.27954%,1:17.56133%,11:0.00116%,10:0.00097%,15:0.00058%,21:0.00039%,14:0.00039%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1410 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0543 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0191 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0091 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0018 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0070 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0018 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6866 - tp: 54287.0000 - fp: 25713.0000 - tn: 294287.0000 - fn: 25713.0000 - accuracy: 0.8714 - precision: 0.6786 - recall: 0.6786 - auc: 0.9626 - val_loss: 0.3573 - val_tp: 13554.0000 - val_fp: 6446.0000 - val_tn: 73554.0000 - val_fn: 6446.0000 - val_accuracy: 0.8711 - val_precision: 0.6777 - val_recall: 0.6777 - val_auc: 0.9740
[INFO] saving weights to checkpoints/lstm-epoch-3-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2962 - tp: 55571.0000 - fp: 24429.0000 - tn: 295571.0000 - fn: 24429.0000 - accuracy: 0.8779 - precision: 0.6946 - recall: 0.6946 - auc: 0.9730 - val_loss: 0.1883 - val_tp: 19762.0000 - val_fp: 238.0000 - val_tn: 79762.0000 - val_fn: 238.0000 - val_accuracy: 0.9952 - val_precision: 0.9881 - val_recall: 0.9881 - val_auc: 0.9997
[INFO] saving weights to checkpoints/lstm-epoch-3-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 14-14/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99961%,30:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:95.53308%,Single Stage Single Point:4.46692%]
[INFO] ** dst:[21:43.34722%,10:20.81133%,8:18.26772%,9:17.57219%,22:0.00078%,24:0.00039%,15:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99961%,-33.760870000000004:0.00039%]
[INFO] ** modbus_function_description:[7:50.00097%,11:49.99864%,0:0.00039%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99981%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.05%,20:26.10912%,13:18.26791%,6:17.57238%,17:0.00019%,16:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:26.10834%,-0.32151:20.81133%,-1.27613:18.26733%,-0.23351:17.572%,-0.33484:17.23868%,-1.27347:0.00039%,1.45709:0.00039%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:26.10796%,1:20.81133%,5:18.26714%,4:17.57161%,2:17.23848%,0:0.00349%]
[INFO] ** service:[0.0048200000000000005:99.99961%,-183.8612:0.00019%,-211.73542999999998:0.00019%]
[INFO] ** src:[22:38.05%,9:26.10912%,7:18.26791%,1:17.57238%,15:0.00019%,14:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1409 (0.27321%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2338 - tp: 71417.0000 - fp: 8583.0000 - tn: 311417.0000 - fn: 8583.0000 - accuracy: 0.9571 - precision: 0.8927 - recall: 0.8927 - auc: 0.9913 - val_loss: 0.4007 - val_tp: 12807.0000 - val_fp: 7193.0000 - val_tn: 72807.0000 - val_fn: 7193.0000 - val_accuracy: 0.8561 - val_precision: 0.6403 - val_recall: 0.6403 - val_auc: 0.9677
[INFO] saving weights to checkpoints/lstm-epoch-3-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2222 - tp: 73195.0000 - fp: 6805.0000 - tn: 313195.0000 - fn: 6805.0000 - accuracy: 0.9660 - precision: 0.9149 - recall: 0.9149 - auc: 0.9953 - val_loss: 0.1583 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1434 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1094 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1018 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0815 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0764 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0616 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 15-15/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99612%,30:0.0031%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:89.29078%,Single Stage Multi Point:10.70844%,Single Stage Single Point:0.00078%]
[INFO] ** dst:[21:43.29467%,10:20.77507%,8:18.316%,9:17.60884%,15:0.0031%,22:0.00155%,25:0.00019%,24:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.9969%,0:0.0031%]
[INFO] ** i/f_name:[2:99.9969%,3:0.0031%]
[INFO] ** modbus_function_code:[0.02961:99.99612%,-33.760870000000004:0.00388%]
[INFO] ** modbus_function_description:[7:49.99903%,11:49.99709%,0:0.00388%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99709%,2:0.00291%]
[INFO] ** proto:[0:99.99651%,1:0.0031%,2:0.00039%]
[INFO] ** proxy_src_ip:[18:38.00424%,20:26.06607%,13:18.3158%,6:17.60942%,17:0.0031%,16:0.00058%,7:0.00039%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.0653%,-0.32151:20.77487%,-1.27613:18.31561%,-0.23351:17.60864%,-0.33484:17.22937%,-71.33197:0.0031%,-1.02014:0.00058%,-0.24151:0.00058%,1.45709:0.00039%,-64.19493:0.00019%,-61.95768:0.00019%,-71.14798:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,10.192739999999999:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%]
[INFO] ** scada_tag:[3:26.06491%,1:20.77468%,5:18.31561%,4:17.60826%,2:17.22918%,0:0.00737%]
[INFO] ** service:[0.0048200000000000005:99.99632%,-211.73542999999998:0.0031%,-186.44547:0.00019%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.00424%,9:26.06607%,7:18.3158%,1:17.60942%,21:0.0033%,15:0.00058%,16:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1418 (0.27495%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0499 - tp: 79991.0000 - fp: 9.0000 - tn: 319991.0000 - fn: 9.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 0.0377 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0214 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.8710e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0097 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3982e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0056 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.8929 - val_tp: 18892.0000 - val_fp: 1108.0000 - val_tn: 78892.0000 - val_fn: 1108.0000 - val_accuracy: 0.9778 - val_precision: 0.9446 - val_recall: 0.9446 - val_auc: 0.9654
[INFO] saving weights to checkpoints/lstm-epoch-3-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5324 - tp: 42627.0000 - fp: 37373.0000 - tn: 282627.0000 - fn: 37373.0000 - accuracy: 0.8131 - precision: 0.5328 - recall: 0.5328 - auc: 0.7051 - val_loss: 7.5473 - val_tp: 10635.0000 - val_fp: 9365.0000 - val_tn: 70635.0000 - val_fn: 9365.0000 - val_accuracy: 0.8127 - val_precision: 0.5318 - val_recall: 0.5318 - val_auc: 0.7073
[INFO] saving weights to checkpoints/lstm-epoch-3-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 16-16/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (455414, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (455414, 17)

[INFO] analyzing data
[INFO] 455414 rows
[INFO] ** appi_name:[21:99.99846%,30:0.00132%,33:0.00022%]
[INFO] ** classification:[normal:83.33626%,Single Stage Multi Point:16.66374%]
[INFO] ** dst:[21:43.35659%,10:20.79844%,8:18.2524%,9:17.58971%,22:0.00132%,15:0.00132%,24:0.00022%]
[INFO] ** i/f_dir:[1:99.99868%,0:0.00132%]
[INFO] ** i/f_name:[2:99.99868%,3:0.00132%]
[INFO] ** modbus_function_code:[0.02961:99.99846%,-33.760870000000004:0.00154%]
[INFO] ** modbus_function_description:[7:50.00066%,11:49.9978%,0:0.00154%]
[INFO] ** modbus_transaction_id:65536 (14.39042%)
[INFO] ** orig:[0:99.99868%,2:0.00132%]
[INFO] ** proto:[0:99.99868%,1:0.00132%]
[INFO] ** proxy_src_ip:[18:38.0478%,20:26.10745%,13:18.25284%,6:17.58993%,17:0.00132%,16:0.00044%,21:0.00022%]
[INFO] ** s_port:[1.45442:26.1068%,-0.32151:20.79822%,-1.27613:18.2524%,-0.23351:17.58949%,-0.33484:17.24958%,-71.33197:0.00132%,1.45709:0.00044%,-0.24151:0.00044%,-1.02014:0.00044%,-1.27347:0.00022%,1.47576:0.00022%,-49.275529999999996:0.00022%,-1.2708:0.00022%]
[INFO] ** scada_tag:[3:26.10636%,1:20.79822%,5:18.25218%,4:17.58905%,2:17.24936%,0:0.00483%]
[INFO] ** service:[0.0048200000000000005:99.99868%,-211.73542999999998:0.00132%]
[INFO] ** src:[22:38.0478%,9:26.10745%,7:18.25284%,1:17.58993%,21:0.00132%,15:0.00044%,4:0.00022%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1246 (0.2736%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/455414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5590 - tp: 42494.0000 - fp: 37506.0000 - tn: 282494.0000 - fn: 37506.0000 - accuracy: 0.8125 - precision: 0.5312 - recall: 0.5312 - auc: 0.7045 - val_loss: 7.5562 - val_tp: 10624.0000 - val_fp: 9376.0000 - val_tn: 70624.0000 - val_fn: 9376.0000 - val_accuracy: 0.8125 - val_precision: 0.5312 - val_recall: 0.5312 - val_auc: 0.7070
[INFO] saving weights to checkpoints/lstm-epoch-3-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/455414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.8469 - tp: 50993.0000 - fp: 29007.0000 - tn: 290993.0000 - fn: 29007.0000 - accuracy: 0.8550 - precision: 0.6374 - recall: 0.6374 - auc: 0.7715 - val_loss: 1.5175e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/455414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0041 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1691e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/455414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0040 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0048e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/455414
[33m[INFO] loading file 17-17/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555414, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555414, 17)

[INFO] analyzing data
[INFO] 555414 rows
[INFO] ** appi_name:[21:99.99712%,7:0.00054%,26:0.00036%,0:0.00036%,33:0.00018%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.44558%,Multi Stage Multi Point:5.55442%]
[INFO] ** dst:[21:43.3464%,10:20.84661%,8:18.20444%,9:17.59966%,22:0.00072%,6:0.00054%,25:0.00036%,16:0.00036%,2:0.00036%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99712%,-33.760870000000004:0.0027%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99946%,11:49.99766%,0:0.0027%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.79949%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99874%,2:0.00126%]
[INFO] ** proxy_src_ip:[18:38.07718%,20:26.11637%,13:18.2039%,6:17.59948%,10:0.00108%,11:0.0009%,1:0.00036%,21:0.00018%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.11547%,-0.32151:20.84643%,-1.27613:18.20354%,-0.23351:17.5993%,-0.33484:17.23075%,6.0369:0.00072%,1.47576:0.00036%,-71.14798:0.00036%,1.45709:0.00036%,-64.19493:0.00036%,1.46509:0.00018%,-68.79874000000001:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,6.15557:0.00018%,6.06224:0.00018%,8.55414:0.00018%,-3.3787199999999995:0.00018%,-4.3880099999999995:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.11529%,1:20.84625%,5:18.20336%,4:17.59894%,2:17.23075%,0:0.0054%]
[INFO] ** service:[0.0048200000000000005:99.99802%,-211.09762999999998:0.00054%,-211.08346:0.00036%,-186.44547:0.00036%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.07718%,9:26.11637%,7:18.2039%,1:17.59948%,11:0.00108%,10:0.0009%,3:0.00036%,21:0.00018%,15:0.00018%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1517 (0.27313%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0037 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.5590e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0035 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5448e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0033 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.1823e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.7189 - tp: 71482.0000 - fp: 8518.0000 - tn: 311482.0000 - fn: 8518.0000 - accuracy: 0.9574 - precision: 0.8935 - recall: 0.8935 - auc: 0.9330 - val_loss: 2.9456 - val_tp: 16345.0000 - val_fp: 3655.0000 - val_tn: 76345.0000 - val_fn: 3655.0000 - val_accuracy: 0.9269 - val_precision: 0.8173 - val_recall: 0.8173 - val_auc: 0.8858
[INFO] saving weights to checkpoints/lstm-epoch-3-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9177 - tp: 65530.0000 - fp: 14470.0000 - tn: 305530.0000 - fn: 14470.0000 - accuracy: 0.9277 - precision: 0.8191 - recall: 0.8191 - auc: 0.8863 - val_loss: 2.9238 - val_tp: 16372.0000 - val_fp: 3628.0000 - val_tn: 76372.0000 - val_fn: 3628.0000 - val_accuracy: 0.9274 - val_precision: 0.8186 - val_recall: 0.8186 - val_auc: 0.8866
[INFO] saving weights to checkpoints/lstm-epoch-3-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/555414
[33m[INFO] loading file 18-18/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555414, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555414, 17)

[INFO] analyzing data
[INFO] 555414 rows
[INFO] ** appi_name:[21:99.9982%,30:0.00054%,7:0.00054%,31:0.00018%,27:0.00018%,22:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:82.43166%,Multi Stage Multi Point:17.56834%]
[INFO] ** dst:[21:43.34154%,10:20.83311%,8:18.25989%,9:17.56257%,22:0.00072%,15:0.00054%,24:0.00036%,16:0.00036%,2:0.00036%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99946%,0:0.00054%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.9982%,-33.760870000000004:0.0018%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.9982%,0:0.0018%]
[INFO] ** modbus_transaction_id:65536 (11.79949%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99892%,2:0.00054%,1:0.00054%]
[INFO] ** proxy_src_ip:[18:38.07754%,20:26.09765%,13:18.26025%,6:17.56275%,17:0.00054%,11:0.00054%,1:0.00036%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.09693%,-0.32151:20.83311%,-1.27613:18.25971%,-0.23351:17.56239%,-0.33484:17.24443%,-71.33197:0.00054%,-1.27347:0.00036%,1.45709:0.00036%,-0.24151:0.00036%,1.47576:0.00018%,1.46509:0.00018%,3.6236699999999997:0.00018%,-1.2708:0.00018%,-2.48275:0.00018%,6.06224:0.00018%,-3.3787199999999995:0.00018%,8.10082:0.00018%,6.45955:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.09657%,1:20.83293%,5:18.25953%,4:17.56221%,2:17.24425%,0:0.0045%]
[INFO] ** service:[0.0048200000000000005:99.9982%,-211.09762999999998:0.00054%,-211.73542999999998:0.00054%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.07754%,9:26.09765%,7:18.26025%,1:17.56275%,14:0.00054%,10:0.00054%,3:0.00036%,21:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1518 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5012 - tp: 77526.0000 - fp: 2474.0000 - tn: 317526.0000 - fn: 2474.0000 - accuracy: 0.9876 - precision: 0.9691 - recall: 0.9691 - auc: 0.9805 - val_loss: 6.1305 - val_tp: 12393.0000 - val_fp: 7607.0000 - val_tn: 72393.0000 - val_fn: 7607.0000 - val_accuracy: 0.8479 - val_precision: 0.6197 - val_recall: 0.6197 - val_auc: 0.7623
[INFO] saving weights to checkpoints/lstm-epoch-3-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1322 - tp: 49572.0000 - fp: 30428.0000 - tn: 289572.0000 - fn: 30428.0000 - accuracy: 0.8479 - precision: 0.6197 - recall: 0.6197 - auc: 0.7607 - val_loss: 6.0395 - val_tp: 12506.0000 - val_fp: 7494.0000 - val_tn: 72506.0000 - val_fn: 7494.0000 - val_accuracy: 0.8501 - val_precision: 0.6253 - val_recall: 0.6253 - val_auc: 0.7658
[INFO] saving weights to checkpoints/lstm-epoch-3-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1460 - tp: 49503.0000 - fp: 30497.0000 - tn: 289503.0000 - fn: 30497.0000 - accuracy: 0.8475 - precision: 0.6188 - recall: 0.6188 - auc: 0.7601 - val_loss: 6.1474 - val_tp: 12372.0000 - val_fp: 7628.0000 - val_tn: 72372.0000 - val_fn: 7628.0000 - val_accuracy: 0.8474 - val_precision: 0.6186 - val_recall: 0.6186 - val_auc: 0.7616
[INFO] saving weights to checkpoints/lstm-epoch-3-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.3087 - tp: 68551.0000 - fp: 11449.0000 - tn: 308551.0000 - fn: 11449.0000 - accuracy: 0.9428 - precision: 0.8569 - recall: 0.8569 - auc: 0.9100 - val_loss: 2.2227e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0023 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9970e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/555414
[33m[INFO] loading file 19-19/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555414, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555414, 17)

[INFO] analyzing data
[INFO] 555414 rows
[INFO] ** appi_name:[21:99.99802%,26:0.00036%,0:0.00036%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:87.11592%,Single Stage Multi Point:12.88408%]
[INFO] ** dst:[21:43.38601%,10:20.82591%,8:18.21236%,9:17.57302%,22:0.00126%,6:0.00054%,25:0.00036%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99802%,-33.760870000000004:0.0018%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99802%,0:0.0018%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.79949%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99874%,2:0.00126%]
[INFO] ** proxy_src_ip:[18:38.11337%,20:26.09873%,13:18.21236%,6:17.57302%,10:0.00108%,11:0.0009%,16:0.00054%]
[INFO] ** s_port:[1.45442:26.09765%,-0.32151:20.82591%,-1.27613:18.212%,-0.23351:17.57284%,-0.33484:17.28746%,-5.20264:0.00072%,1.45709:0.00054%,-1.02014:0.00054%,-64.19493:0.00036%,-71.14798:0.00036%,1.46509:0.00036%,-1.27347:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-71.14931:0.00018%,-68.79874000000001:0.00018%,0.75578:0.00018%]
[INFO] ** scada_tag:[3:26.09729%,1:20.82573%,5:18.21182%,4:17.57266%,2:17.28728%,0:0.00522%]
[INFO] ** service:[0.0048200000000000005:99.99874%,-211.08346:0.00036%,-186.44547:0.00036%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.11337%,9:26.09873%,7:18.21236%,1:17.57302%,11:0.00108%,10:0.0009%,15:0.00054%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1519 (0.27349%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0019 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7517e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0018 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6467e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0017 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5292e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2237 - tp: 78897.0000 - fp: 1103.0000 - tn: 318897.0000 - fn: 1103.0000 - accuracy: 0.9945 - precision: 0.9862 - recall: 0.9862 - auc: 0.9913 - val_loss: 9.7974 - val_tp: 7843.0000 - val_fp: 12157.0000 - val_tn: 67843.0000 - val_fn: 12157.0000 - val_accuracy: 0.7569 - val_precision: 0.3922 - val_recall: 0.3922 - val_auc: 0.6201
[INFO] saving weights to checkpoints/lstm-epoch-3-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.8380 - tp: 31173.0000 - fp: 48827.0000 - tn: 271173.0000 - fn: 48827.0000 - accuracy: 0.7559 - precision: 0.3897 - recall: 0.3897 - auc: 0.6161 - val_loss: 7.6343 - val_tp: 10527.0000 - val_fp: 9473.0000 - val_tn: 70527.0000 - val_fn: 9473.0000 - val_accuracy: 0.8105 - val_precision: 0.5264 - val_recall: 0.5264 - val_auc: 0.7040
[INFO] saving weights to checkpoints/lstm-epoch-3-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/555414
[33m[INFO] loading file 20-20/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555414, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555414, 17)

[INFO] analyzing data
[INFO] 555414 rows
[INFO] ** appi_name:[21:99.99658%,30:0.00288%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:92.6219%,Single Stage Multi Point:7.3781%]
[INFO] ** dst:[21:43.42508%,10:20.83671%,8:18.16087%,9:17.57248%,15:0.00288%,22:0.00108%,24:0.00036%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99748%,0:0.00252%]
[INFO] ** i/f_name:[2:99.99712%,3:0.00288%]
[INFO] ** modbus_function_code:[0.02961:99.99658%,-33.760870000000004:0.00342%]
[INFO] ** modbus_function_description:[7:49.99946%,11:49.99712%,0:0.00342%]
[INFO] ** modbus_transaction_id:65536 (11.79949%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99658%,1:0.00288%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.11499%,20:26.14734%,13:18.16105%,6:17.57302%,17:0.00288%,14:0.00054%,16:0.00018%]
[INFO] ** s_port:[1.45442:26.14662%,-0.32151:20.83671%,-1.27613:18.16051%,-0.23351:17.5723%,-0.33484:17.27828%,-71.33197:0.00288%,-0.24151:0.00054%,1.45709:0.00036%,-1.27347:0.00036%,13.431270000000001:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-71.14798:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:26.14608%,1:20.83653%,5:18.16051%,4:17.57194%,2:17.2781%,0:0.00684%]
[INFO] ** service:[0.0048200000000000005:99.99658%,-211.73542999999998:0.00288%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.11499%,9:26.14734%,7:18.16105%,1:17.57302%,14:0.00288%,2:0.00054%,15:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1518 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0013 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3183e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.4612 - tp: 67789.0000 - fp: 12211.0000 - tn: 307789.0000 - fn: 12211.0000 - accuracy: 0.9389 - precision: 0.8474 - recall: 0.8474 - auc: 0.9041 - val_loss: 2.9625 - val_tp: 16324.0000 - val_fp: 3676.0000 - val_tn: 76324.0000 - val_fn: 3676.0000 - val_accuracy: 0.9265 - val_precision: 0.8162 - val_recall: 0.8162 - val_auc: 0.8851
[INFO] saving weights to checkpoints/lstm-epoch-3-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9443 - tp: 65391.0000 - fp: 14609.0000 - tn: 305391.0000 - fn: 14609.0000 - accuracy: 0.9270 - precision: 0.8174 - recall: 0.8174 - auc: 0.8851 - val_loss: 2.9424 - val_tp: 16349.0000 - val_fp: 3651.0000 - val_tn: 76349.0000 - val_fn: 3651.0000 - val_accuracy: 0.9270 - val_precision: 0.8174 - val_recall: 0.8174 - val_auc: 0.8859
[INFO] saving weights to checkpoints/lstm-epoch-3-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3773 - tp: 73168.0000 - fp: 6832.0000 - tn: 313168.0000 - fn: 6832.0000 - accuracy: 0.9658 - precision: 0.9146 - recall: 0.9146 - auc: 0.9463 - val_loss: 1.2414e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.6958e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2043e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/555414
[33m[INFO] loading file 21-21/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555412, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555412, 17)

[INFO] analyzing data
[INFO] 555412 rows
[INFO] ** appi_name:[21:99.99604%,30:0.00108%,7:0.00054%,26:0.00036%,22:0.00036%,0:0.00036%,31:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:98.90118%,Multi Stage Single Point:1.09882%]
[INFO] ** dst:[21:43.31001%,10:20.98352%,8:18.16795%,9:17.53365%,15:0.00108%,22:0.0009%,24:0.00072%,6:0.00072%,25:0.00036%,16:0.00036%,2:0.00036%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99604%,-33.760870000000004:0.00378%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99892%,11:49.99712%,0:0.00378%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.79953%)
[INFO] ** orig:[0:99.99928%,2:0.00072%]
[INFO] ** proto:[0:99.99748%,2:0.00144%,1:0.00108%]
[INFO] ** proxy_src_ip:[18:38.30868%,20:25.98449%,13:18.16867%,6:17.53365%,17:0.00108%,10:0.00108%,11:0.0009%,16:0.00054%,1:0.00036%,21:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.98395%,-0.32151:20.9828%,-1.27613:18.16777%,-0.23351:17.53347%,-0.33484:17.32588%,-71.33197:0.00108%,-1.27347:0.00072%,-6.64392:0.00072%,-1.02014:0.00054%,-64.19493:0.00036%,-71.14931:0.00036%,-71.14798:0.00036%,1.47576:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,6.62488:0.00018%,10.15141:0.00018%,-68.79874000000001:0.00018%,7.060860000000001:0.00018%,-3.3787199999999995:0.00018%,-2.2440900000000004:0.00018%,1.45709:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.98341%,1:20.98262%,5:18.16759%,4:17.53311%,2:17.32588%,0:0.00738%]
[INFO] ** service:[0.0048200000000000005:99.99676%,-211.73542999999998:0.00108%,-211.09762999999998:0.00054%,-211.08346:0.00036%,-186.44547:0.00036%,-211.08818:0.00036%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.30868%,9:25.98449%,7:18.16867%,1:17.53365%,11:0.00108%,21:0.0009%,10:0.0009%,15:0.00054%,14:0.00036%,3:0.00036%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1513 (0.27241%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555412
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.6276e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/555412
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.7931e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/555412
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.0028e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/555412
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.3974e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.2742e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/555412
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.7906e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/555412
[33m[INFO] loading file 22-22/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (324453, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (324453, 17)

[INFO] analyzing data
[INFO] 324453 rows
[INFO] ** appi_name:[21:99.9926%,30:0.00647%,23:0.00031%,22:0.00031%,18:0.00031%]
[INFO] ** classification:[normal:59.14601%,Multi Stage Single Point:40.85399%]
[INFO] ** dst:[21:43.30365%,10:21.00427%,8:18.10956%,9:17.57389%,15:0.00647%,22:0.00123%,19:0.00062%,26:0.00031%]
[INFO] ** i/f_dir:[1:99.99384%,0:0.00616%]
[INFO] ** i/f_name:[2:99.99353%,3:0.00616%,0:0.00031%]
[INFO] ** modbus_function_code:[0.02961:99.9926%,-33.760870000000004:0.0074%]
[INFO] ** modbus_function_description:[7:49.99707%,11:49.99553%,0:0.0074%]
[INFO] ** modbus_transaction_id:65534 (20.1983%)
[INFO] ** orig:[0:99.99507%,2:0.00431%,1:0.00062%]
[INFO] ** proto:[0:99.99322%,1:0.00647%,2:0.00031%]
[INFO] ** proxy_src_ip:[18:38.32943%,20:25.97942%,13:18.10894%,6:17.57481%,17:0.00647%,14:0.00062%,10:0.00031%]
[INFO] ** s_port:[1.45442:25.97849%,-0.32151:21.00427%,-1.27613:18.10894%,-0.23351:17.57389%,-0.33484:17.32516%,-71.33197:0.00647%,1.45709:0.00062%,-0.24151:0.00062%,7.228860000000001:0.00062%,-0.24950999999999998:0.00031%,1.46509:0.00031%,-71.14931:0.00031%]
[INFO] ** scada_tag:[3:25.97818%,1:21.00427%,5:18.10894%,4:17.57358%,2:17.32516%,0:0.00986%]
[INFO] ** service:[0.0048200000000000005:99.9926%,-211.73542999999998:0.00647%,-211.07873999999998:0.00062%,-211.08818:0.00031%]
[INFO] ** src:[22:38.32943%,9:25.97942%,7:18.10894%,1:17.57481%,21:0.00431%,14:0.00216%,2:0.00062%,11:0.00031%]
[INFO] ** type:[0:99.99815%,1:0.00185%]
[INFO] ** unixtime:895 (0.27585%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/324453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.5534 - tp: 62365.0000 - fp: 17635.0000 - tn: 302365.0000 - fn: 17635.0000 - accuracy: 0.9118 - precision: 0.7796 - recall: 0.7796 - auc: 0.8613 - val_loss: 7.5626 - val_tp: 10616.0000 - val_fp: 9384.0000 - val_tn: 70616.0000 - val_fn: 9384.0000 - val_accuracy: 0.8123 - val_precision: 0.5308 - val_recall: 0.5308 - val_auc: 0.7068
[INFO] saving weights to checkpoints/lstm-epoch-3-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/324453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5701 - tp: 42428.0000 - fp: 37572.0000 - tn: 282428.0000 - fn: 37572.0000 - accuracy: 0.8121 - precision: 0.5304 - recall: 0.5304 - auc: 0.7047 - val_loss: 7.5900 - val_tp: 10582.0000 - val_fp: 9418.0000 - val_tn: 70582.0000 - val_fn: 9418.0000 - val_accuracy: 0.8116 - val_precision: 0.5291 - val_recall: 0.5291 - val_auc: 0.7057
[INFO] saving weights to checkpoints/lstm-epoch-3-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/324453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5858 - tp: 42350.0000 - fp: 37650.0000 - tn: 282350.0000 - fn: 37650.0000 - accuracy: 0.8118 - precision: 0.5294 - recall: 0.5294 - auc: 0.7040 - val_loss: 7.6077 - val_tp: 10560.0000 - val_fp: 9440.0000 - val_tn: 70560.0000 - val_fn: 9440.0000 - val_accuracy: 0.8112 - val_precision: 0.5280 - val_recall: 0.5280 - val_auc: 0.7050
[INFO] saving weights to checkpoints/lstm-epoch-3-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/324453
[33m[INFO] loading file 23-23/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524453, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524453, 17)

[INFO] analyzing data
[INFO] 524453 rows
[INFO] ** appi_name:[21:99.99886%,31:0.00038%,30:0.00038%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:96.09345%,Multi Stage Single Point:3.90655%]
[INFO] ** dst:[21:43.32743%,10:21.00303%,8:18.13985%,9:17.5274%,22:0.00095%,24:0.00038%,18:0.00038%,15:0.00038%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99886%,-33.760870000000004:0.00114%]
[INFO] ** modbus_function_description:[7:50.00029%,11:49.99857%,0:0.00114%]
[INFO] ** modbus_transaction_id:65536 (12.49607%)
[INFO] ** orig:[0:99.99981%,2:0.00019%]
[INFO] ** proto:[0:99.99905%,2:0.00057%,1:0.00038%]
[INFO] ** proxy_src_ip:[18:38.34929%,20:25.98136%,13:18.14004%,6:17.5276%,16:0.00057%,17:0.00038%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98078%,-0.32151:21.00284%,-1.27613:18.13947%,-0.23351:17.52721%,-0.33484:17.34645%,-1.02014:0.00057%,-1.27347:0.00038%,-0.08551:0.00038%,-71.33197:0.00038%,1.45709:0.00019%,-0.24151:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,1.46509:0.00019%,-64.19493:0.00019%,-0.24950999999999998:0.00019%,-49.275529999999996:0.00019%]
[INFO] ** scada_tag:[3:25.9804%,1:21.00284%,5:18.13928%,4:17.52702%,2:17.34626%,0:0.00419%]
[INFO] ** service:[0.0048200000000000005:99.99905%,-211.73542999999998:0.00038%,-186.43601999999998:0.00038%,-186.44547:0.00019%]
[INFO] ** src:[22:38.34929%,9:25.98136%,7:18.14004%,1:17.5276%,15:0.00057%,21:0.00019%,17:0.00019%,14:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1426 (0.2719%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.1281 - tp: 59512.0000 - fp: 20488.0000 - tn: 299512.0000 - fn: 20488.0000 - accuracy: 0.8976 - precision: 0.7439 - recall: 0.7439 - auc: 0.8390 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.0148e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.6071e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.3209e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.0055e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/524453
[33m[INFO] loading file 24-24/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524453, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524453, 17)

[INFO] analyzing data
[INFO] 524453 rows
[INFO] ** appi_name:[21:99.99295%,30:0.00343%,26:0.00057%,31:0.00038%,27:0.00038%,22:0.00038%,0:0.00038%,24:0.00019%,23:0.00019%,19:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,11:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:95.1416%,Multi Stage Single Point:4.8584%]
[INFO] ** dst:[21:43.35851%,10:21.02324%,8:18.1021%,9:17.50891%,15:0.00343%,22:0.00114%,6:0.00076%,25:0.00038%,19:0.00038%,18:0.00038%,7:0.00038%,26:0.00019%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99676%,0:0.00324%]
[INFO] ** i/f_name:[2:99.99657%,3:0.00343%]
[INFO] ** modbus_function_code:[0.02961:99.99295%,-33.760870000000004:0.00648%,-0.415:0.00019%,0.9188299999999999:0.00019%,0.47422:0.00019%]
[INFO] ** modbus_function_description:[7:49.99743%,11:49.99552%,0:0.00648%,15:0.00019%,10:0.00019%,2:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.49607%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99447%,1:0.00343%,2:0.0021%]
[INFO] ** proxy_src_ip:[18:38.4023%,20:25.98021%,13:18.10191%,6:17.50815%,17:0.00343%,10:0.00133%,14:0.00095%,11:0.00095%,21:0.00038%,16:0.00038%]
[INFO] ** s_port:[1.45442:25.97945%,-0.32151:21.02324%,-1.27613:18.10172%,-0.23351:17.50757%,-0.33484:17.37906%,-71.33197:0.00343%,-9.58113:0.00076%,-71.14798:0.00057%,1.45709:0.00038%,-0.24151:0.00038%,-1.02014:0.00038%,-31.55091:0.00038%,7.6315100000000005:0.00038%,-71.14931:0.00038%,-64.19493:0.00038%,-68.79874000000001:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,-1.27347:0.00019%,7.4901800000000005:0.00019%,13.431270000000001:0.00019%,11.862:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:25.97926%,1:21.02324%,5:18.10153%,4:17.50719%,2:17.37887%,0:0.00992%]
[INFO] ** service:[0.0048200000000000005:99.99409%,-211.73542999999998:0.00343%,-211.08346:0.00057%,-211.07873999999998:0.00038%,-202.75898:0.00038%,-186.44547:0.00038%,-186.43601999999998:0.00038%,-211.08818:0.00038%]
[INFO] ** src:[22:38.4023%,9:25.98021%,7:18.10191%,1:17.50815%,14:0.00343%,11:0.00133%,10:0.00095%,2:0.00095%,15:0.00038%,4:0.00038%]
[INFO] ** type:[0:99.99867%,1:0.00095%,2:0.00038%]
[INFO] ** unixtime:1425 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.7139e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.5879e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3381e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.9004e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2002e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.9516 - tp: 70314.0000 - fp: 9686.0000 - tn: 310314.0000 - fn: 9686.0000 - accuracy: 0.9516 - precision: 0.8789 - recall: 0.8789 - auc: 0.9243 - val_loss: 5.7340 - val_tp: 12885.0000 - val_fp: 7115.0000 - val_tn: 72885.0000 - val_fn: 7115.0000 - val_accuracy: 0.8577 - val_precision: 0.6442 - val_recall: 0.6442 - val_auc: 0.7777
[INFO] saving weights to checkpoints/lstm-epoch-3-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/524453
[33m[INFO] loading file 25-25/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524453, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524453, 17)

[INFO] analyzing data
[INFO] 524453 rows
[INFO] ** appi_name:[21:99.99619%,30:0.00114%,17:0.00076%,22:0.00057%,31:0.00038%,28:0.00019%,26:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** classification:[normal:64.34228%,Multi Stage Single Point:35.65772%]
[INFO] ** dst:[21:43.31523%,10:21.02247%,8:18.14843%,9:17.50929%,15:0.00114%,22:0.00095%,16:0.00076%,6:0.00076%,18:0.00038%,17:0.00038%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99886%,0:0.00114%]
[INFO] ** i/f_name:[2:99.99886%,3:0.00114%]
[INFO] ** modbus_function_code:[0.02961:99.99619%,-33.760870000000004:0.00381%]
[INFO] ** modbus_function_description:[7:49.99895%,11:49.99724%,0:0.00381%]
[INFO] ** modbus_transaction_id:65536 (12.49607%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99771%,2:0.00114%,1:0.00114%]
[INFO] ** proxy_src_ip:[18:38.38533%,20:25.95218%,13:18.14843%,6:17.50986%,17:0.00114%,1:0.00095%,21:0.00076%,16:0.00038%,14:0.00038%,7:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.9518%,-0.32151:21.02209%,-1.27613:18.14805%,-0.23351:17.50929%,-0.33484:17.36323%,-71.33197:0.00114%,-71.14931:0.00057%,-0.24151:0.00038%,-1.02014:0.00038%,-49.275529999999996:0.00038%,1.46509:0.00019%,-5.1466400000000005:0.00019%,-1.27347:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,-0.24950999999999998:0.00019%,2.52505:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,6.1115699999999995:0.00019%,-5.08665:0.00019%,1.45709:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:25.95142%,1:21.0219%,5:18.14786%,4:17.5091%,2:17.36304%,0:0.00667%]
[INFO] ** service:[0.0048200000000000005:99.99657%,-211.73542999999998:0.00114%,-205.44247:0.00076%,-211.08818:0.00057%,-186.43601999999998:0.00038%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.38533%,9:25.95218%,7:18.14843%,1:17.50986%,14:0.00114%,3:0.00095%,4:0.00076%,21:0.00038%,15:0.00038%,2:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1425 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7500 - tp: 51461.0000 - fp: 28539.0000 - tn: 291461.0000 - fn: 28539.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.7770 - val_loss: 5.7421 - val_tp: 12875.0000 - val_fp: 7125.0000 - val_tn: 72875.0000 - val_fn: 7125.0000 - val_accuracy: 0.8575 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.7773
[INFO] saving weights to checkpoints/lstm-epoch-3-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7445 - tp: 51488.0000 - fp: 28512.0000 - tn: 291488.0000 - fn: 28512.0000 - accuracy: 0.8574 - precision: 0.6436 - recall: 0.6436 - auc: 0.7772 - val_loss: 5.7453 - val_tp: 12871.0000 - val_fp: 7129.0000 - val_tn: 72871.0000 - val_fn: 7129.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.7772
[INFO] saving weights to checkpoints/lstm-epoch-3-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7512 - tp: 51455.0000 - fp: 28545.0000 - tn: 291455.0000 - fn: 28545.0000 - accuracy: 0.8573 - precision: 0.6432 - recall: 0.6432 - auc: 0.7770 - val_loss: 5.7558 - val_tp: 12858.0000 - val_fp: 7142.0000 - val_tn: 72858.0000 - val_fn: 7142.0000 - val_accuracy: 0.8572 - val_precision: 0.6429 - val_recall: 0.6429 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-3-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7415 - tp: 51503.0000 - fp: 28497.0000 - tn: 291503.0000 - fn: 28497.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7774 - val_loss: 5.7759 - val_tp: 12833.0000 - val_fp: 7167.0000 - val_tn: 72833.0000 - val_fn: 7167.0000 - val_accuracy: 0.8567 - val_precision: 0.6417 - val_recall: 0.6417 - val_auc: 0.7760
[INFO] saving weights to checkpoints/lstm-epoch-3-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7405 - tp: 51508.0000 - fp: 28492.0000 - tn: 291508.0000 - fn: 28492.0000 - accuracy: 0.8575 - precision: 0.6439 - recall: 0.6439 - auc: 0.7774 - val_loss: 5.7590 - val_tp: 12854.0000 - val_fp: 7146.0000 - val_tn: 72854.0000 - val_fn: 7146.0000 - val_accuracy: 0.8571 - val_precision: 0.6427 - val_recall: 0.6427 - val_auc: 0.7767
[INFO] saving weights to checkpoints/lstm-epoch-3-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/524453
[33m[INFO] loading file 26-26/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524453, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524453, 17)

[INFO] analyzing data
[INFO] 524453 rows
[INFO] ** appi_name:[21:99.99847%,7:0.00057%,31:0.00019%,30:0.00019%,22:0.00019%,12:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:64.40005%,Single Stage Single Point:30.45306%,Multi Stage Single Point:5.14689%]
[INFO] ** dst:[21:43.31027%,10:21.08769%,8:18.11907%,9:17.4805%,22:0.00076%,24:0.00038%,16:0.00038%,2:0.00038%,18:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99847%,-33.760870000000004:0.00153%]
[INFO] ** modbus_function_description:[7:49.9999%,11:49.99857%,0:0.00153%]
[INFO] ** modbus_transaction_id:65536 (12.49607%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99943%,2:0.00038%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.47094%,20:25.9272%,13:18.11945%,6:17.4805%,1:0.00057%,21:0.00038%,16:0.00038%,17:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.92663%,-0.32151:21.08749%,-1.27613:18.11888%,-0.23351:17.48031%,-0.33484:17.38345%,-1.27347:0.00038%,-1.02014:0.00038%,7.66617:0.00019%,-71.14931:0.00019%,11.57001:0.00019%,-3.3787199999999995:0.00019%,2.52505:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%,1.45709:0.00019%,-49.275529999999996:0.00019%,1.47576:0.00019%,1.46509:0.00019%,14.191239999999999:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.92625%,1:21.08749%,5:18.11888%,4:17.48012%,2:17.38345%,0:0.00381%]
[INFO] ** service:[0.0048200000000000005:99.99867%,-211.09762999999998:0.00057%,-211.35747999999998:0.00019%,-211.73542999999998:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.47094%,9:25.9272%,7:18.11945%,1:17.4805%,3:0.00057%,15:0.00038%,4:0.00038%,21:0.00019%,14:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1423 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.5729 - tp: 51602.0000 - fp: 28398.0000 - tn: 291602.0000 - fn: 28398.0000 - accuracy: 0.8580 - precision: 0.6450 - recall: 0.6450 - auc: 0.7862 - val_loss: 1.5236 - val_tp: 13596.0000 - val_fp: 6404.0000 - val_tn: 73596.0000 - val_fn: 6404.0000 - val_accuracy: 0.8719 - val_precision: 0.6798 - val_recall: 0.6798 - val_auc: 0.9702
[INFO] saving weights to checkpoints/lstm-epoch-3-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2096 - tp: 54186.0000 - fp: 25814.0000 - tn: 294186.0000 - fn: 25814.0000 - accuracy: 0.8709 - precision: 0.6773 - recall: 0.6773 - auc: 0.9718 - val_loss: 1.0017 - val_tp: 13523.0000 - val_fp: 6477.0000 - val_tn: 73523.0000 - val_fn: 6477.0000 - val_accuracy: 0.8705 - val_precision: 0.6762 - val_recall: 0.6762 - val_auc: 0.9738
[INFO] saving weights to checkpoints/lstm-epoch-3-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8582 - tp: 54289.0000 - fp: 25711.0000 - tn: 294289.0000 - fn: 25711.0000 - accuracy: 0.8714 - precision: 0.6786 - recall: 0.6786 - auc: 0.9725 - val_loss: 0.7294 - val_tp: 13612.0000 - val_fp: 6388.0000 - val_tn: 73612.0000 - val_fn: 6388.0000 - val_accuracy: 0.8722 - val_precision: 0.6806 - val_recall: 0.6806 - val_auc: 0.9745
[INFO] saving weights to checkpoints/lstm-epoch-3-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6385 - tp: 54330.0000 - fp: 25670.0000 - tn: 294330.0000 - fn: 25670.0000 - accuracy: 0.8717 - precision: 0.6791 - recall: 0.6791 - auc: 0.9726 - val_loss: 0.5437 - val_tp: 13608.0000 - val_fp: 6392.0000 - val_tn: 73608.0000 - val_fn: 6392.0000 - val_accuracy: 0.8722 - val_precision: 0.6804 - val_recall: 0.6804 - val_auc: 0.9745
[INFO] saving weights to checkpoints/lstm-epoch-3-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4792 - tp: 54313.0000 - fp: 25687.0000 - tn: 294313.0000 - fn: 25687.0000 - accuracy: 0.8716 - precision: 0.6789 - recall: 0.6789 - auc: 0.9726 - val_loss: 0.4050 - val_tp: 13609.0000 - val_fp: 6391.0000 - val_tn: 73609.0000 - val_fn: 6391.0000 - val_accuracy: 0.8722 - val_precision: 0.6805 - val_recall: 0.6805 - val_auc: 0.9745
[INFO] saving weights to checkpoints/lstm-epoch-3-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/524453
[33m[INFO] loading file 27-27/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (464583, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (464583, 17)

[INFO] analyzing data
[INFO] 464583 rows
[INFO] ** appi_name:[21:99.99935%,30:0.00065%]
[INFO] ** classification:[normal:64.3377%,Single Stage Single Point:35.6623%]
[INFO] ** dst:[21:43.27192%,10:21.06384%,8:18.18965%,9:17.47287%,22:0.00086%,15:0.00065%,24:0.00022%]
[INFO] ** i/f_dir:[1:99.99978%,0:0.00022%]
[INFO] ** i/f_name:[2:99.99935%,3:0.00065%]
[INFO] ** modbus_function_code:[0.02961:99.99935%,-33.760870000000004:0.00065%]
[INFO] ** modbus_function_description:[7:50.00054%,11:49.99882%,0:0.00065%]
[INFO] ** modbus_transaction_id:65536 (14.10641%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99935%,1:0.00065%]
[INFO] ** proxy_src_ip:[18:38.40433%,20:25.93207%,13:18.18943%,6:17.47309%,17:0.00065%,16:0.00043%]
[INFO] ** s_port:[1.45442:25.93143%,-0.32151:21.06384%,-1.27613:18.18921%,-0.23351:17.47266%,-0.33484:17.3405%,-71.33197:0.00065%,-1.02014:0.00043%,-1.27347:0.00022%,1.45709:0.00022%,-0.24950999999999998:0.00022%,1.46509:0.00022%,1.47576:0.00022%,-0.24151:0.00022%]
[INFO] ** scada_tag:[3:25.931%,1:21.06362%,5:18.189%,4:17.47244%,2:17.34028%,0:0.00366%]
[INFO] ** service:[0.0048200000000000005:99.99935%,-211.73542999999998:0.00065%]
[INFO] ** src:[22:38.40433%,9:25.93207%,7:18.18943%,1:17.47309%,14:0.00065%,15:0.00043%]
[INFO] ** type:[0:99.99957%,1:0.00043%]
[INFO] ** unixtime:1262 (0.27164%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/464583
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3623 - tp: 54386.0000 - fp: 25614.0000 - tn: 294386.0000 - fn: 25614.0000 - accuracy: 0.8719 - precision: 0.6798 - recall: 0.6798 - auc: 0.9727 - val_loss: 0.2993 - val_tp: 13726.0000 - val_fp: 6274.0000 - val_tn: 73726.0000 - val_fn: 6274.0000 - val_accuracy: 0.8745 - val_precision: 0.6863 - val_recall: 0.6863 - val_auc: 0.9754
[INFO] saving weights to checkpoints/lstm-epoch-3-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/464583
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2746 - tp: 54708.0000 - fp: 25292.0000 - tn: 294708.0000 - fn: 25292.0000 - accuracy: 0.8735 - precision: 0.6838 - recall: 0.6838 - auc: 0.9734 - val_loss: 0.2224 - val_tp: 13862.0000 - val_fp: 6138.0000 - val_tn: 73862.0000 - val_fn: 6138.0000 - val_accuracy: 0.8772 - val_precision: 0.6931 - val_recall: 0.6931 - val_auc: 0.9765
[INFO] saving weights to checkpoints/lstm-epoch-3-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/464583
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2158 - tp: 74532.0000 - fp: 5468.0000 - tn: 314532.0000 - fn: 5468.0000 - accuracy: 0.9727 - precision: 0.9316 - recall: 0.9316 - auc: 0.9969 - val_loss: 0.1737 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/464583
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1747 - tp: 78393.0000 - fp: 1607.0000 - tn: 318393.0000 - fn: 1607.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9983 - val_loss: 0.1379 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/464583
[33m[INFO] loading file 28-28/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (398499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (398499, 17)

[INFO] analyzing data
[INFO] 398499 rows
[INFO] ** appi_name:[21:99.99247%,30:0.00176%,17:0.00125%,22:0.001%,7:0.001%,31:0.00075%,26:0.00075%,28:0.00025%,27:0.00025%,8:0.00025%,0:0.00025%]
[INFO] ** classification:[normal:64.31283%,Single Stage Single Point:35.68717%]
[INFO] ** dst:[21:43.28543%,10:21.01963%,8:18.2023%,9:17.48461%,6:0.00201%,16:0.00176%,18:0.00125%,15:0.00075%,22:0.0005%,17:0.0005%,2:0.0005%,25:0.00025%,7:0.00025%,0:0.00025%]
[INFO] ** i/f_dir:[1:99.99925%,0:0.00075%]
[INFO] ** i/f_name:[2:99.99925%,3:0.00075%]
[INFO] ** modbus_function_code:[0.02961:99.99247%,-33.760870000000004:0.00753%]
[INFO] ** modbus_function_description:[7:49.99636%,11:49.99611%,0:0.00753%]
[INFO] ** modbus_transaction_id:65536 (16.44571%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99548%,2:0.00376%,1:0.00075%]
[INFO] ** proxy_src_ip:[18:38.34263%,20:25.96242%,13:18.20256%,6:17.48486%,1:0.00201%,17:0.00176%,14:0.00151%,7:0.00125%,21:0.00075%,0:0.00025%]
[INFO] ** s_port:[1.45442:25.96217%,-0.32151:21.01963%,-1.27613:18.2023%,-0.23351:17.48436%,-0.33484:17.323%,-71.14798:0.001%,-71.14931:0.001%,-71.33197:0.00075%,-0.08551:0.0005%,-0.24151:0.0005%,7.66617:0.00025%,-58.035180000000004:0.00025%,-1.2708:0.00025%,-64.19493:0.00025%,-5.1466400000000005:0.00025%,13.431270000000001:0.00025%,11.57001:0.00025%,14.4699:0.00025%,1.47576:0.00025%,14.191239999999999:0.00025%,-5.08665:0.00025%,10.192739999999999:0.00025%,-3.3787199999999995:0.00025%,6.1115699999999995:0.00025%,2.05573:0.00025%,-43.76509:0.00025%,2.52505:0.00025%,11.862:0.00025%,-58.032509999999995:0.00025%]
[INFO] ** scada_tag:[3:25.96192%,1:21.01963%,5:18.2023%,4:17.48411%,2:17.323%,0:0.00903%]
[INFO] ** service:[0.0048200000000000005:99.99247%,-205.44247:0.00125%,-186.43601999999998:0.00125%,-211.09762999999998:0.001%,-211.08346:0.001%,-211.08818:0.001%,-211.73542999999998:0.00075%,-186.44547:0.00025%,-183.8612:0.00025%,-185.9872:0.00025%,-211.35747999999998:0.00025%,-202.75898:0.00025%]
[INFO] ** src:[22:38.34263%,9:25.96242%,7:18.20256%,1:17.48486%,3:0.00226%,2:0.00151%,21:0.00125%,4:0.001%,14:0.00075%,8:0.0005%,17:0.00025%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1083 (0.27177%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/398499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1466 - tp: 78399.0000 - fp: 1601.0000 - tn: 318399.0000 - fn: 1601.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9984 - val_loss: 0.1118 - val_tp: 19996.0000 - val_fp: 4.0000 - val_tn: 79996.0000 - val_fn: 4.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/398499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1277 - tp: 78342.0000 - fp: 1658.0000 - tn: 318342.0000 - fn: 1658.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9982 - val_loss: 0.0913 - val_tp: 19996.0000 - val_fp: 4.0000 - val_tn: 79996.0000 - val_fn: 4.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/398499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1119 - tp: 78426.0000 - fp: 1574.0000 - tn: 318426.0000 - fn: 1574.0000 - accuracy: 0.9921 - precision: 0.9803 - recall: 0.9803 - auc: 0.9984 - val_loss: 0.0757 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/398499
[33m[INFO] loading file 29-29/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598499, 17)

[INFO] analyzing data
[INFO] 598499 rows
[INFO] ** appi_name:[21:99.99883%,30:0.0005%,31:0.00017%,26:0.00017%,9:0.00017%,3:0.00017%]
[INFO] ** classification:[normal:64.38123%,Single Stage Single Point:35.61877%]
[INFO] ** dst:[21:43.31536%,10:21.06453%,8:18.14874%,9:17.4697%,22:0.0005%,15:0.0005%,24:0.00017%,18:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99967%,0:0.00033%]
[INFO] ** i/f_name:[2:99.9995%,3:0.0005%]
[INFO] ** modbus_function_code:[0.02961:99.99883%,-33.760870000000004:0.00117%]
[INFO] ** modbus_function_description:[7:49.99975%,11:49.99908%,0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (10.95006%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99916%,1:0.0005%,2:0.00033%]
[INFO] ** proxy_src_ip:[18:38.43214%,20:25.94808%,13:18.14907%,6:17.46937%,17:0.0005%,21:0.00017%,16:0.00017%,7:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.94741%,-0.32151:21.06436%,-1.27613:18.14874%,-0.23351:17.46937%,-0.33484:17.36778%,-71.33197:0.0005%,1.45709:0.00033%,1.47576:0.00033%,-71.14798:0.00017%,-1.27347:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,6.1115699999999995:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:25.94708%,1:21.0642%,5:18.14874%,4:17.46904%,2:17.36778%,0:0.00317%]
[INFO] ** service:[0.0048200000000000005:99.999%,-211.73542999999998:0.0005%,-183.8612:0.00017%,-211.08346:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.43214%,9:25.94808%,7:18.14907%,1:17.46937%,14:0.0005%,21:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1625 (0.27151%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1026 - tp: 78392.0000 - fp: 1608.0000 - tn: 318392.0000 - fn: 1608.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9983 - val_loss: 0.0643 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0949 - tp: 78387.0000 - fp: 1613.0000 - tn: 318387.0000 - fn: 1613.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9983 - val_loss: 0.0548 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0884 - tp: 78427.0000 - fp: 1573.0000 - tn: 318427.0000 - fn: 1573.0000 - accuracy: 0.9921 - precision: 0.9803 - recall: 0.9803 - auc: 0.9984 - val_loss: 0.0477 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0842 - tp: 78425.0000 - fp: 1575.0000 - tn: 318425.0000 - fn: 1575.0000 - accuracy: 0.9921 - precision: 0.9803 - recall: 0.9803 - auc: 0.9984 - val_loss: 0.0422 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0741 - tp: 78438.0000 - fp: 1562.0000 - tn: 318438.0000 - fn: 1562.0000 - accuracy: 0.9922 - precision: 0.9805 - recall: 0.9805 - auc: 0.9987 - val_loss: 0.0111 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/598499
[33m[INFO] loading file 30-30/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598499, 17)

[INFO] analyzing data
[INFO] 598499 rows
[INFO] ** appi_name:[21:99.99749%,30:0.00167%,26:0.00017%,17:0.00017%,12:0.00017%,3:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.37287%,Single Stage Single Point:35.62713%]
[INFO] ** dst:[21:43.34143%,10:21.02861%,8:18.14506%,9:17.48173%,15:0.00167%,22:0.00067%,24:0.00033%,25:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.9985%,0:0.0015%]
[INFO] ** i/f_name:[2:99.99833%,3:0.00167%]
[INFO] ** modbus_function_code:[0.02961:99.99749%,-33.760870000000004:0.00251%]
[INFO] ** modbus_function_description:[7:49.99958%,11:49.99791%,0:0.00251%]
[INFO] ** modbus_transaction_id:65536 (10.95006%)
[INFO] ** orig:[0:99.99916%,2:0.0005%,1:0.00033%]
[INFO] ** proto:[0:99.99799%,1:0.00167%,2:0.00033%]
[INFO] ** proxy_src_ip:[18:38.3755%,20:25.9942%,13:18.14539%,6:17.48223%,17:0.00167%,7:0.00033%,0:0.00033%,16:0.00017%,5:0.00017%]
[INFO] ** s_port:[1.45442:25.99403%,-0.32151:21.02827%,-1.27613:18.14489%,-0.23351:17.48157%,-0.33484:17.34723%,-71.33197:0.00167%,-0.24151:0.0005%,-1.27347:0.00033%,-61.95768:0.00033%,-71.14798:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:25.99369%,1:21.02827%,5:18.14473%,4:17.4814%,2:17.34706%,0:0.00485%]
[INFO] ** service:[0.0048200000000000005:99.99783%,-211.73542999999998:0.00167%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.3755%,9:25.9942%,7:18.14539%,1:17.48223%,14:0.00117%,21:0.00084%,8:0.00033%,16:0.00017%,15:0.00017%]
[INFO] ** type:[0:99.99916%,1:0.00084%]
[INFO] ** unixtime:1627 (0.27185%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0650 - tp: 78345.0000 - fp: 1655.0000 - tn: 318345.0000 - fn: 1655.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9991 - val_loss: 0.0013 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0615 - tp: 78445.0000 - fp: 1555.0000 - tn: 318445.0000 - fn: 1555.0000 - accuracy: 0.9922 - precision: 0.9806 - recall: 0.9806 - auc: 0.9991 - val_loss: 0.0021 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-3-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0635 - tp: 78358.0000 - fp: 1642.0000 - tn: 318358.0000 - fn: 1642.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9991 - val_loss: 0.0011 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0629 - tp: 78391.0000 - fp: 1609.0000 - tn: 318391.0000 - fn: 1609.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9991 - val_loss: 7.1900e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0615 - tp: 78432.0000 - fp: 1568.0000 - tn: 318432.0000 - fn: 1568.0000 - accuracy: 0.9922 - precision: 0.9804 - recall: 0.9804 - auc: 0.9991 - val_loss: 6.3199e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/598499
[33m[INFO] loading file 31-31/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598499, 17)

[INFO] analyzing data
[INFO] 598499 rows
[INFO] ** appi_name:[21:99.99967%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.37939%,Single Stage Single Point:35.62061%]
[INFO] ** dst:[21:43.32956%,10:21.04849%,8:18.12133%,9:17.49894%,22:0.001%,24:0.00033%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99967%,-33.760870000000004:0.00033%]
[INFO] ** modbus_function_description:[7:50.00008%,11:49.99958%,0:0.00033%]
[INFO] ** modbus_transaction_id:65536 (10.95006%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.3999%,20:25.97882%,13:18.12167%,6:17.49878%,16:0.0005%,7:0.00033%]
[INFO] ** s_port:[1.45442:25.97799%,-0.32151:21.04849%,-1.27613:18.12117%,-0.23351:17.49861%,-0.33484:17.35141%,-1.02014:0.0005%,-1.27347:0.00033%,1.45709:0.00033%,1.47576:0.00033%,-71.14798:0.00017%,1.46509:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.97765%,1:21.04832%,5:18.121%,4:17.49827%,2:17.35124%,0:0.00351%]
[INFO] ** service:[0.0048200000000000005:99.99967%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.3999%,9:25.97882%,7:18.12167%,1:17.49878%,15:0.0005%,21:0.00033%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1626 (0.27168%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0619 - tp: 78416.0000 - fp: 1584.0000 - tn: 318416.0000 - fn: 1584.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9991 - val_loss: 0.0010 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0597 - tp: 78489.0000 - fp: 1511.0000 - tn: 318489.0000 - fn: 1511.0000 - accuracy: 0.9924 - precision: 0.9811 - recall: 0.9811 - auc: 0.9992 - val_loss: 5.6648e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0610 - tp: 78440.0000 - fp: 1560.0000 - tn: 318440.0000 - fn: 1560.0000 - accuracy: 0.9922 - precision: 0.9805 - recall: 0.9805 - auc: 0.9992 - val_loss: 8.9083e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0616 - tp: 78431.0000 - fp: 1569.0000 - tn: 318431.0000 - fn: 1569.0000 - accuracy: 0.9922 - precision: 0.9804 - recall: 0.9804 - auc: 0.9991 - val_loss: 4.7415e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0622 - tp: 78402.0000 - fp: 1598.0000 - tn: 318402.0000 - fn: 1598.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9991 - val_loss: 4.3403e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/598499
[33m[INFO] loading file 32-32/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598499, 17)

[INFO] analyzing data
[INFO] 598499 rows
[INFO] ** appi_name:[21:99.99666%,30:0.00284%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.38507%,Single Stage Single Point:35.61493%]
[INFO] ** dst:[21:43.32071%,10:21.06002%,8:18.14907%,9:17.46586%,15:0.00284%,22:0.00084%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99749%,0:0.00251%]
[INFO] ** i/f_name:[2:99.99716%,3:0.00284%]
[INFO] ** modbus_function_code:[0.02961:99.99666%,-33.760870000000004:0.00334%]
[INFO] ** modbus_function_description:[7:49.99908%,11:49.99758%,0:0.00334%]
[INFO] ** modbus_transaction_id:65536 (10.95006%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99666%,1:0.00284%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.4278%,20:25.95326%,13:18.14907%,6:17.46636%,17:0.00284%,14:0.0005%,16:0.00017%]
[INFO] ** s_port:[1.45442:25.95276%,-0.32151:21.06002%,-1.27613:18.14874%,-0.23351:17.46569%,-0.33484:17.36778%,-71.33197:0.00284%,-0.24151:0.0005%,-1.2708:0.00017%,-1.02014:0.00017%,13.431270000000001:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.95242%,1:21.05985%,5:18.14874%,4:17.46536%,2:17.36778%,0:0.00585%]
[INFO] ** service:[0.0048200000000000005:99.99666%,-211.73542999999998:0.00284%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.4278%,9:25.95326%,7:18.14907%,1:17.46636%,14:0.00284%,2:0.0005%,15:0.00017%]
[INFO] ** type:[0:99.99967%,1:0.00033%]
[INFO] ** unixtime:1624 (0.27135%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0631 - tp: 78376.0000 - fp: 1624.0000 - tn: 318376.0000 - fn: 1624.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9991 - val_loss: 4.2041e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0608 - tp: 78458.0000 - fp: 1542.0000 - tn: 318458.0000 - fn: 1542.0000 - accuracy: 0.9923 - precision: 0.9807 - recall: 0.9807 - auc: 0.9992 - val_loss: 5.1891e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0624 - tp: 78402.0000 - fp: 1598.0000 - tn: 318402.0000 - fn: 1598.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9991 - val_loss: 4.3985e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0606 - tp: 78455.0000 - fp: 1545.0000 - tn: 318455.0000 - fn: 1545.0000 - accuracy: 0.9923 - precision: 0.9807 - recall: 0.9807 - auc: 0.9992 - val_loss: 0.0022 - val_tp: 19990.0000 - val_fp: 10.0000 - val_tn: 79990.0000 - val_fn: 10.0000 - val_accuracy: 0.9998 - val_precision: 0.9995 - val_recall: 0.9995 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-3-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0631 - tp: 78393.0000 - fp: 1607.0000 - tn: 318393.0000 - fn: 1607.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9991 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/598499
[33m[INFO] loading file 33-33/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598499, 17)

[INFO] analyzing data
[INFO] 598499 rows
[INFO] ** appi_name:[21:99.99716%,30:0.001%,17:0.00067%,22:0.0005%,31:0.00017%,28:0.00017%,26:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.39259%,Single Stage Single Point:35.60741%]
[INFO] ** dst:[21:43.32656%,10:21.06152%,8:18.12183%,9:17.48558%,22:0.00134%,15:0.001%,16:0.00067%,6:0.00067%,24:0.00033%,17:0.00033%,18:0.00017%]
[INFO] ** i/f_dir:[1:99.999%,0:0.001%]
[INFO] ** i/f_name:[2:99.999%,3:0.001%]
[INFO] ** modbus_function_code:[0.02961:99.99716%,-33.760870000000004:0.00284%]
[INFO] ** modbus_function_description:[7:49.99942%,11:49.99774%,0:0.00284%]
[INFO] ** modbus_transaction_id:65536 (10.95006%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99816%,1:0.001%,2:0.00084%]
[INFO] ** proxy_src_ip:[18:38.41928%,20:25.96963%,13:18.12183%,6:17.48574%,17:0.001%,16:0.00067%,1:0.00067%,21:0.00033%,14:0.00033%,7:0.00033%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.9688%,-0.32151:21.06152%,-1.27613:18.1215%,-0.23351:17.48541%,-0.33484:17.35776%,-71.33197:0.001%,-1.02014:0.00067%,1.45709:0.0005%,-71.14931:0.0005%,-1.27347:0.00033%,-5.08665:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,-71.14798:0.00017%,-58.032509999999995:0.00017%,-58.035180000000004:0.00017%,-0.24151:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.96846%,1:21.06136%,5:18.12133%,4:17.48524%,2:17.35776%,0:0.00585%]
[INFO] ** service:[0.0048200000000000005:99.99716%,-211.73542999999998:0.001%,-205.44247:0.00067%,-211.08818:0.0005%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.41928%,9:25.96963%,7:18.12183%,1:17.48574%,14:0.001%,15:0.00067%,3:0.00067%,21:0.00033%,4:0.00033%,2:0.00033%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1627 (0.27185%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0626 - tp: 78391.0000 - fp: 1609.0000 - tn: 318391.0000 - fn: 1609.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9991 - val_loss: 7.6489e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0612 - tp: 78447.0000 - fp: 1553.0000 - tn: 318447.0000 - fn: 1553.0000 - accuracy: 0.9922 - precision: 0.9806 - recall: 0.9806 - auc: 0.9991 - val_loss: 7.5031e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0624 - tp: 78405.0000 - fp: 1595.0000 - tn: 318405.0000 - fn: 1595.0000 - accuracy: 0.9920 - precision: 0.9801 - recall: 0.9801 - auc: 0.9991 - val_loss: 6.2845e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0622 - tp: 78413.0000 - fp: 1587.0000 - tn: 318413.0000 - fn: 1587.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9991 - val_loss: 8.8665e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0645 - tp: 78314.0000 - fp: 1686.0000 - tn: 318314.0000 - fn: 1686.0000 - accuracy: 0.9916 - precision: 0.9789 - recall: 0.9789 - auc: 0.9991 - val_loss: 8.3459e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/598499
[33m[INFO] loading file 34-34/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (439932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (439932, 17)

[INFO] analyzing data
[INFO] 439932 rows
[INFO] ** appi_name:[21:99.99773%,30:0.00068%,7:0.00068%,31:0.00023%,22:0.00023%,8:0.00023%,6:0.00023%]
[INFO] ** classification:[normal:64.35745%,Single Stage Single Point:35.64255%]
[INFO] ** dst:[21:43.29737%,10:21.05712%,8:18.18372%,9:17.45906%,22:0.00068%,15:0.00068%,16:0.00045%,2:0.00045%,18:0.00023%,6:0.00023%]
[INFO] ** i/f_dir:[1:99.99932%,0:0.00068%]
[INFO] ** i/f_name:[2:99.99932%,3:0.00068%]
[INFO] ** modbus_function_code:[0.02961:99.99773%,-33.760870000000004:0.00227%]
[INFO] ** modbus_function_description:[7:49.99932%,11:49.99841%,0:0.00227%]
[INFO] ** modbus_transaction_id:65536 (14.89685%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99886%,1:0.00068%,2:0.00045%]
[INFO] ** proxy_src_ip:[18:38.40139%,20:25.95333%,13:18.18349%,6:17.45952%,17:0.00068%,1:0.00068%,21:0.00045%,14:0.00023%,7:0.00023%]
[INFO] ** s_port:[1.45442:25.95287%,-0.32151:21.05689%,-1.27613:18.18349%,-0.23351:17.45883%,-0.33484:17.3445%,-0.24151:0.00068%,-71.33197:0.00068%,-3.0613900000000003:0.00023%,-3.3787199999999995:0.00023%,14.191239999999999:0.00023%,1.46509:0.00023%,1.47576:0.00023%,11.57001:0.00023%,-49.275529999999996:0.00023%,-71.14931:0.00023%,7.66617:0.00023%]
[INFO] ** scada_tag:[3:25.95265%,1:21.05666%,5:18.18326%,4:17.45838%,2:17.3445%,0:0.00455%]
[INFO] ** service:[0.0048200000000000005:99.99795%,-211.09762999999998:0.00068%,-211.73542999999998:0.00068%,-186.43601999999998:0.00023%,-211.35747999999998:0.00023%,-211.08818:0.00023%]
[INFO] ** src:[22:38.40139%,9:25.95333%,7:18.18349%,1:17.45952%,14:0.00068%,3:0.00068%,4:0.00045%,21:0.00023%,2:0.00023%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1195 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/439932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0622 - tp: 78395.0000 - fp: 1605.0000 - tn: 318395.0000 - fn: 1605.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9991 - val_loss: 6.7502e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/439932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0622 - tp: 78410.0000 - fp: 1590.0000 - tn: 318410.0000 - fn: 1590.0000 - accuracy: 0.9920 - precision: 0.9801 - recall: 0.9801 - auc: 0.9991 - val_loss: 0.0010 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/439932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0623 - tp: 78404.0000 - fp: 1596.0000 - tn: 318404.0000 - fn: 1596.0000 - accuracy: 0.9920 - precision: 0.9801 - recall: 0.9801 - auc: 0.9991 - val_loss: 0.0013 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-3-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/439932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0639 - tp: 78348.0000 - fp: 1652.0000 - tn: 318348.0000 - fn: 1652.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9991 - val_loss: 8.9303e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-33-34-batch-300000-400000
[INFO] processing batch 400000-500000/439932
[33m[INFO] loading file 35-35/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:99.99889%,30:0.00111%]
[INFO] ** classification:[normal:64.36866%,Single Stage Single Point:35.63134%]
[INFO] ** dst:[21:43.33305%,10:21.03302%,8:18.15377%,9:17.47794%,22:0.00111%,15:0.00111%]
[INFO] ** i/f_dir:[1:99.99907%,0:0.00093%]
[INFO] ** i/f_name:[2:99.99889%,3:0.00111%]
[INFO] ** modbus_function_code:[0.02961:99.99889%,-33.760870000000004:0.00111%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.9987%,0:0.00111%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.99889%,1:0.00111%]
[INFO] ** proxy_src_ip:[18:38.39669%,20:25.96994%,13:18.1534%,6:17.47813%,17:0.00111%,16:0.00074%]
[INFO] ** s_port:[1.45442:25.96938%,-0.32151:21.03302%,-1.27613:18.1534%,-0.23351:17.47776%,-0.33484:17.36367%,-71.33197:0.00111%,-1.02014:0.00074%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.96901%,1:21.03302%,5:18.15321%,4:17.47739%,2:17.36367%,0:0.0037%]
[INFO] ** service:[0.0048200000000000005:99.99889%,-211.73542999999998:0.00111%]
[INFO] ** src:[22:38.39669%,9:25.96994%,7:18.1534%,1:17.47813%,14:0.00111%,15:0.00074%]
[INFO] ** type:[0:99.99907%,1:0.00093%]
[INFO] ** unixtime:1465 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0630 - tp: 78372.0000 - fp: 1628.0000 - tn: 318372.0000 - fn: 1628.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9991 - val_loss: 6.4192e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0630 - tp: 78365.0000 - fp: 1635.0000 - tn: 318365.0000 - fn: 1635.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9991 - val_loss: 8.5231e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0627 - tp: 78385.0000 - fp: 1615.0000 - tn: 318385.0000 - fn: 1615.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9991 - val_loss: 0.0013 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0611 - tp: 78440.0000 - fp: 1560.0000 - tn: 318440.0000 - fn: 1560.0000 - accuracy: 0.9922 - precision: 0.9805 - recall: 0.9805 - auc: 0.9992 - val_loss: 3.9734e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0630 - tp: 78373.0000 - fp: 1627.0000 - tn: 318373.0000 - fn: 1627.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9991 - val_loss: 7.0841e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 36-36/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:99.9987%,30:0.00056%,31:0.00037%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.35496%,Single Stage Single Point:35.64504%]
[INFO] ** dst:[21:43.33138%,10:21.02154%,8:18.15673%,9:17.48813%,22:0.00074%,15:0.00056%,24:0.00037%,18:0.00037%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99944%,0:0.00056%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.9987%,-33.760870000000004:0.0013%]
[INFO] ** modbus_function_description:[7:50.00037%,11:49.99833%,0:0.0013%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99889%,2:0.00056%,1:0.00056%]
[INFO] ** proxy_src_ip:[18:38.3702%,20:25.9829%,13:18.15692%,6:17.48868%,17:0.00056%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98235%,-0.32151:21.02135%,-1.27613:18.15636%,-0.23351:17.48794%,-0.33484:17.34885%,-0.24151:0.00056%,-71.33197:0.00056%,-1.27347:0.00037%,-0.08551:0.00037%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-49.275529999999996:0.00019%,-1.2708:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:25.98198%,1:21.02117%,5:18.15618%,4:17.48776%,2:17.34867%,0:0.00426%]
[INFO] ** service:[0.0048200000000000005:99.99889%,-211.73542999999998:0.00056%,-186.43601999999998:0.00037%,-186.44547:0.00019%]
[INFO] ** src:[22:38.3702%,9:25.9829%,7:18.15692%,1:17.48868%,14:0.00056%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1467 (0.2717%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0639 - tp: 78336.0000 - fp: 1664.0000 - tn: 318336.0000 - fn: 1664.0000 - accuracy: 0.9917 - precision: 0.9792 - recall: 0.9792 - auc: 0.9991 - val_loss: 6.4979e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0632 - tp: 78360.0000 - fp: 1640.0000 - tn: 318360.0000 - fn: 1640.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9991 - val_loss: 5.0209e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0619 - tp: 78432.0000 - fp: 1568.0000 - tn: 318432.0000 - fn: 1568.0000 - accuracy: 0.9922 - precision: 0.9804 - recall: 0.9804 - auc: 0.9991 - val_loss: 7.2548e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0627 - tp: 78387.0000 - fp: 1613.0000 - tn: 318387.0000 - fn: 1613.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9991 - val_loss: 0.0010 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0645 - tp: 78334.0000 - fp: 1666.0000 - tn: 318334.0000 - fn: 1666.0000 - accuracy: 0.9917 - precision: 0.9792 - recall: 0.9792 - auc: 0.9990 - val_loss: 0.0012 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 37-37/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:99.99889%,30:0.00074%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.38033%,Single Stage Single Point:35.61967%]
[INFO] ** dst:[21:43.33675%,10:21.04172%,8:18.13691%,9:17.48257%,22:0.00074%,15:0.00074%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99926%,3:0.00074%]
[INFO] ** modbus_function_code:[0.02961:99.99889%,-33.760870000000004:0.00111%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99889%,0:0.00111%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99907%,1:0.00074%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.39317%,20:25.98568%,13:18.1371%,6:17.48257%,17:0.00074%,16:0.00037%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.98512%,-0.32151:21.04172%,-1.27613:18.13673%,-0.23351:17.48239%,-0.33484:17.35144%,-71.33197:0.00074%,-1.02014:0.00037%,-71.14798:0.00019%,-1.27347:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%,14.4699:0.00019%]
[INFO] ** scada_tag:[3:25.98494%,1:21.04172%,5:18.13654%,4:17.4822%,2:17.35126%,0:0.00333%]
[INFO] ** service:[0.0048200000000000005:99.99889%,-211.73542999999998:0.00074%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.39317%,9:25.98568%,7:18.1371%,1:17.48257%,14:0.00074%,15:0.00037%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1467 (0.2717%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0625 - tp: 78394.0000 - fp: 1606.0000 - tn: 318394.0000 - fn: 1606.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9991 - val_loss: 6.1873e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0619 - tp: 78405.0000 - fp: 1595.0000 - tn: 318405.0000 - fn: 1595.0000 - accuracy: 0.9920 - precision: 0.9801 - recall: 0.9801 - auc: 0.9991 - val_loss: 5.1997e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0606 - tp: 78465.0000 - fp: 1535.0000 - tn: 318465.0000 - fn: 1535.0000 - accuracy: 0.9923 - precision: 0.9808 - recall: 0.9808 - auc: 0.9992 - val_loss: 4.2959e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0627 - tp: 78394.0000 - fp: 1606.0000 - tn: 318394.0000 - fn: 1606.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9991 - val_loss: 3.6048e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0641 - tp: 78331.0000 - fp: 1669.0000 - tn: 318331.0000 - fn: 1669.0000 - accuracy: 0.9917 - precision: 0.9791 - recall: 0.9791 - auc: 0.9991 - val_loss: 4.1449e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 38-38/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:99.99907%,30:0.00019%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.40793%,Single Stage Single Point:35.59207%]
[INFO] ** dst:[21:43.32138%,10:21.08451%,8:18.09858%,9:17.49368%,22:0.00093%,25:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99907%,-33.760870000000004:0.00093%]
[INFO] ** modbus_function_description:[7:49.99963%,11:49.99944%,0:0.00093%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99944%,2:0.00037%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.45373%,20:25.95271%,13:18.09839%,6:17.49405%,7:0.00037%,17:0.00019%,16:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95197%,-0.32151:21.08432%,-1.27613:18.0982%,-0.23351:17.4935%,-0.33484:17.36941%,-0.24151:0.00037%,1.45709:0.00037%,-64.19493:0.00019%,10.192739999999999:0.00019%,-1.02014:0.00019%,-71.14798:0.00019%,-61.95768:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.9516%,1:21.08432%,5:18.0982%,4:17.49331%,2:17.36941%,0:0.00315%]
[INFO] ** service:[0.0048200000000000005:99.99926%,-211.08346:0.00019%,-205.44247:0.00019%,-186.44547:0.00019%,-211.73542999999998:0.00019%]
[INFO] ** src:[22:38.45373%,9:25.95271%,7:18.09839%,1:17.49405%,21:0.00037%,16:0.00019%,15:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1468 (0.27189%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0612 - tp: 78440.0000 - fp: 1560.0000 - tn: 318440.0000 - fn: 1560.0000 - accuracy: 0.9922 - precision: 0.9805 - recall: 0.9805 - auc: 0.9992 - val_loss: 3.7314e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0635 - tp: 78351.0000 - fp: 1649.0000 - tn: 318351.0000 - fn: 1649.0000 - accuracy: 0.9918 - precision: 0.9794 - recall: 0.9794 - auc: 0.9991 - val_loss: 3.6950e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0631 - tp: 78375.0000 - fp: 1625.0000 - tn: 318375.0000 - fn: 1625.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9991 - val_loss: 6.5138e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0636 - tp: 78364.0000 - fp: 1636.0000 - tn: 318364.0000 - fn: 1636.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9991 - val_loss: 4.8148e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0630 - tp: 78380.0000 - fp: 1620.0000 - tn: 318380.0000 - fn: 1620.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9991 - val_loss: 6.5990e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 39-39/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.41089%,Single Stage Single Point:35.58911%]
[INFO] ** dst:[21:43.32453%,10:21.08543%,8:18.1271%,9:17.46183%,22:0.00093%,24:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99981%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.45595%,20:25.95438%,13:18.12728%,6:17.46183%,16:0.00056%]
[INFO] ** s_port:[1.45442:25.95382%,-0.32151:21.08543%,-1.27613:18.12691%,-0.23351:17.46164%,-0.33484:17.37052%,-1.02014:0.00056%,-1.27347:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95345%,1:21.08525%,5:18.12673%,4:17.46164%,2:17.37034%,0:0.00259%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.45595%,9:25.95438%,7:18.12728%,1:17.46183%,15:0.00056%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1465 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0629 - tp: 78389.0000 - fp: 1611.0000 - tn: 318389.0000 - fn: 1611.0000 - accuracy: 0.9919 - precision: 0.9799 - recall: 0.9799 - auc: 0.9991 - val_loss: 8.2045e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0621 - tp: 78401.0000 - fp: 1599.0000 - tn: 318401.0000 - fn: 1599.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9991 - val_loss: 6.2164e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0651 - tp: 78289.0000 - fp: 1711.0000 - tn: 318289.0000 - fn: 1711.0000 - accuracy: 0.9914 - precision: 0.9786 - recall: 0.9786 - auc: 0.9990 - val_loss: 5.1664e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0613 - tp: 78440.0000 - fp: 1560.0000 - tn: 318440.0000 - fn: 1560.0000 - accuracy: 0.9922 - precision: 0.9805 - recall: 0.9805 - auc: 0.9991 - val_loss: 4.2959e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0632 - tp: 78362.0000 - fp: 1638.0000 - tn: 318362.0000 - fn: 1638.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9991 - val_loss: 3.9999e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 40-40/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:99.9963%,30:0.00315%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.33847%,Single Stage Single Point:35.66153%]
[INFO] ** dst:[21:43.29453%,10:21.03895%,8:18.19377%,9:17.46794%,15:0.00315%,22:0.00093%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99704%,0:0.00296%]
[INFO] ** i/f_name:[2:99.99685%,3:0.00315%]
[INFO] ** modbus_function_code:[0.02961:99.9963%,-33.760870000000004:0.0037%]
[INFO] ** modbus_function_description:[7:49.99907%,11:49.99722%,0:0.0037%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.9963%,1:0.00315%,2:0.00056%]
[INFO] ** proxy_src_ip:[18:38.35668%,20:25.97772%,13:18.19359%,6:17.46831%,17:0.00315%,14:0.00056%]
[INFO] ** s_port:[1.45442:25.97679%,-0.32151:21.03895%,-1.27613:18.1934%,-0.23351:17.46776%,-0.33484:17.31774%,-71.33197:0.00315%,1.45709:0.00056%,-0.24151:0.00037%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,13.431270000000001:0.00019%]
[INFO] ** scada_tag:[3:25.97642%,1:21.03876%,5:18.19322%,4:17.46738%,2:17.31755%,0:0.00667%]
[INFO] ** service:[0.0048200000000000005:99.9963%,-211.73542999999998:0.00315%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.35668%,9:25.97772%,7:18.19359%,1:17.46831%,14:0.00315%,2:0.00056%]
[INFO] ** type:[0:99.99907%,1:0.00093%]
[INFO] ** unixtime:1468 (0.27189%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0633 - tp: 78361.0000 - fp: 1639.0000 - tn: 318361.0000 - fn: 1639.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9991 - val_loss: 6.8524e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0625 - tp: 78397.0000 - fp: 1603.0000 - tn: 318397.0000 - fn: 1603.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9991 - val_loss: 2.9936e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0647 - tp: 78312.0000 - fp: 1688.0000 - tn: 318312.0000 - fn: 1688.0000 - accuracy: 0.9916 - precision: 0.9789 - recall: 0.9789 - auc: 0.9991 - val_loss: 4.4182e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0619 - tp: 78419.0000 - fp: 1581.0000 - tn: 318419.0000 - fn: 1581.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9991 - val_loss: 0.0011 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0613 - tp: 78444.0000 - fp: 1556.0000 - tn: 318444.0000 - fn: 1556.0000 - accuracy: 0.9922 - precision: 0.9805 - recall: 0.9805 - auc: 0.9991 - val_loss: 7.2469e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 41-41/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (480090, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (480090, 17)

[INFO] analyzing data
[INFO] 480090 rows
[INFO] ** appi_name:[21:99.99646%,30:0.00104%,22:0.00083%,17:0.00083%,32:0.00021%,28:0.00021%,26:0.00021%,7:0.00021%]
[INFO] ** classification:[normal:64.39084%,Single Stage Single Point:35.60916%]
[INFO] ** dst:[21:43.3225%,10:21.06397%,8:18.13535%,9:17.4736%,16:0.00104%,15:0.00104%,6:0.00104%,22:0.00062%,24:0.00042%,17:0.00042%]
[INFO] ** i/f_dir:[1:99.99896%,0:0.00104%]
[INFO] ** i/f_name:[2:99.99896%,3:0.00104%]
[INFO] ** modbus_function_code:[0.02961:99.99646%,-33.760870000000004:0.00354%]
[INFO] ** modbus_function_description:[7:49.99896%,11:49.9975%,0:0.00354%]
[INFO] ** modbus_transaction_id:65536 (13.65077%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99771%,2:0.00125%,1:0.00104%]
[INFO] ** proxy_src_ip:[18:38.43779%,20:25.94888%,13:18.13556%,6:17.47381%,17:0.00104%,1:0.00083%,21:0.00042%,16:0.00042%,14:0.00042%,0:0.00042%,7:0.00021%,2:0.00021%]
[INFO] ** s_port:[1.45442:25.94847%,-0.32151:21.06397%,-1.27613:18.13493%,-0.23351:17.47339%,-0.33484:17.37383%,-71.33197:0.00104%,-71.14931:0.00083%,-1.02014:0.00042%,-1.27347:0.00042%,-71.14798:0.00021%,-0.24151:0.00021%,-58.035180000000004:0.00021%,-1.2708:0.00021%,-5.1466400000000005:0.00021%,1.47576:0.00021%,1.46509:0.00021%,-64.19226:0.00021%,-5.08665:0.00021%,-0.24950999999999998:0.00021%,2.05573:0.00021%,-43.76509:0.00021%,-58.032509999999995:0.00021%]
[INFO] ** scada_tag:[3:25.94826%,1:21.06397%,5:18.13493%,4:17.47318%,2:17.37383%,0:0.00583%]
[INFO] ** service:[0.0048200000000000005:99.99646%,-211.73542999999998:0.00104%,-205.44247:0.00083%,-211.08818:0.00083%,89.64175:0.00021%,-211.09762999999998:0.00021%,-211.08346:0.00021%,-185.9872:0.00021%]
[INFO] ** src:[22:38.43779%,9:25.94888%,7:18.13556%,1:17.47381%,14:0.00104%,3:0.00083%,15:0.00042%,8:0.00042%,4:0.00042%,2:0.00042%,21:0.00021%,17:0.00021%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1302 (0.2712%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/480090
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0627 - tp: 78394.0000 - fp: 1606.0000 - tn: 318394.0000 - fn: 1606.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9991 - val_loss: 7.9426e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/480090
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0626 - tp: 78399.0000 - fp: 1601.0000 - tn: 318399.0000 - fn: 1601.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9991 - val_loss: 5.9896e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/480090
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0639 - tp: 78331.0000 - fp: 1669.0000 - tn: 318331.0000 - fn: 1669.0000 - accuracy: 0.9917 - precision: 0.9791 - recall: 0.9791 - auc: 0.9991 - val_loss: 5.1010e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/480090
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0633 - tp: 78366.0000 - fp: 1634.0000 - tn: 318366.0000 - fn: 1634.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9991 - val_loss: 0.0014 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/480090
[33m[INFO] loading file 42-42/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (423604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (423604, 17)

[INFO] analyzing data
[INFO] 423604 rows
[INFO] ** appi_name:[21:99.99197%,30:0.00212%,17:0.00118%,31:0.00094%,26:0.00094%,7:0.00094%,22:0.00071%,28:0.00024%,27:0.00024%,9:0.00024%,8:0.00024%,0:0.00024%]
[INFO] ** classification:[normal:64.39104%,Single Stage Single Point:35.60896%]
[INFO] ** dst:[21:43.32702%,10:21.05528%,8:18.16413%,9:17.44436%,16:0.00212%,6:0.00189%,18:0.00118%,22:0.00094%,2:0.00094%,15:0.00071%,17:0.00047%,25:0.00024%,24:0.00024%,7:0.00024%,0:0.00024%]
[INFO] ** i/f_dir:[1:99.99929%,0:0.00071%]
[INFO] ** i/f_name:[2:99.99929%,3:0.00071%]
[INFO] ** modbus_function_code:[0.02961:99.99197%,-33.760870000000004:0.00803%]
[INFO] ** modbus_function_description:[7:49.99693%,11:49.99504%,0:0.00803%]
[INFO] ** modbus_transaction_id:65536 (15.47105%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99575%,2:0.00354%,1:0.00071%]
[INFO] ** proxy_src_ip:[18:38.42079%,20:25.96175%,13:18.16461%,6:17.44436%,17:0.00212%,1:0.00212%,14:0.00142%,21:0.00094%,7:0.00071%,16:0.00047%,0:0.00047%,2:0.00024%]
[INFO] ** s_port:[1.45442:25.96128%,-0.32151:21.05528%,-1.27613:18.16413%,-0.23351:17.44412%,-0.33484:17.36551%,-71.14798:0.00094%,-71.14931:0.00094%,-71.33197:0.00071%,11.57001:0.00047%,-0.08551:0.00047%,-3.3787199999999995:0.00047%,-1.02014:0.00047%,-5.1466400000000005:0.00024%,-0.24151:0.00024%,13.431270000000001:0.00024%,0.31847:0.00024%,-1.2708:0.00024%,-58.035180000000004:0.00024%,7.66617:0.00024%,-64.19493:0.00024%,1.47576:0.00024%,14.4699:0.00024%,15.912510000000001:0.00024%,14.191239999999999:0.00024%,7.9608300000000005:0.00024%,-5.08665:0.00024%,10.192739999999999:0.00024%,-3.0613900000000003:0.00024%,1.45709:0.00024%,2.05573:0.00024%,-43.76509:0.00024%,11.862:0.00024%,-1.27347:0.00024%,-58.032509999999995:0.00024%]
[INFO] ** scada_tag:[3:25.9608%,1:21.05528%,5:18.1639%,4:17.44412%,2:17.36528%,0:0.01062%]
[INFO] ** service:[0.0048200000000000005:99.99197%,-211.09762999999998:0.00165%,-205.44247:0.00118%,-186.43601999999998:0.00118%,-211.08346:0.00094%,-211.08818:0.00094%,-211.73542999999998:0.00071%,-211.35747999999998:0.00047%,-186.44547:0.00024%,-183.8612:0.00024%,-185.9872:0.00024%,-202.75898:0.00024%]
[INFO] ** src:[22:38.42079%,9:25.96175%,7:18.16461%,1:17.44436%,3:0.00283%,2:0.00165%,4:0.00118%,21:0.00094%,14:0.00071%,15:0.00047%,8:0.00047%,17:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1150 (0.27148%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/423604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0640 - tp: 78337.0000 - fp: 1663.0000 - tn: 318337.0000 - fn: 1663.0000 - accuracy: 0.9917 - precision: 0.9792 - recall: 0.9792 - auc: 0.9991 - val_loss: 8.0311e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/423604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0630 - tp: 78376.0000 - fp: 1624.0000 - tn: 318376.0000 - fn: 1624.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9991 - val_loss: 0.0010 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/423604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0614 - tp: 78435.0000 - fp: 1565.0000 - tn: 318435.0000 - fn: 1565.0000 - accuracy: 0.9922 - precision: 0.9804 - recall: 0.9804 - auc: 0.9991 - val_loss: 6.7421e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/423604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0620 - tp: 78418.0000 - fp: 1582.0000 - tn: 318418.0000 - fn: 1582.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9991 - val_loss: 0.0014 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-41-42-batch-300000-400000
[INFO] processing batch 400000-500000/423604
[33m[INFO] loading file 43-43/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99924%,30:0.00057%,26:0.00019%]
[INFO] ** classification:[normal:64.39867%,Single Stage Single Point:35.60133%]
[INFO] ** dst:[21:43.3316%,10:21.06535%,8:18.13088%,9:17.47026%,22:0.00095%,15:0.00057%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99924%,-33.760870000000004:0.00076%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99924%,0:0.00076%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99924%,1:0.00057%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.41816%,20:25.97918%,13:18.13107%,6:17.47045%,17:0.00057%,16:0.00038%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.9786%,-0.32151:21.06535%,-1.27613:18.13069%,-0.23351:17.47007%,-0.33484:17.35281%,-71.33197:0.00057%,1.45709:0.00038%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.97822%,1:21.06535%,5:18.1305%,4:17.46969%,2:17.35262%,0:0.00363%]
[INFO] ** service:[0.0048200000000000005:99.99924%,-211.73542999999998:0.00057%,-211.08346:0.00019%]
[INFO] ** src:[22:38.41816%,9:25.97918%,7:18.13107%,1:17.47045%,14:0.00057%,15:0.00038%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1424 (0.27196%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0626 - tp: 78393.0000 - fp: 1607.0000 - tn: 318393.0000 - fn: 1607.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9991 - val_loss: 4.1727e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0613 - tp: 78430.0000 - fp: 1570.0000 - tn: 318430.0000 - fn: 1570.0000 - accuracy: 0.9921 - precision: 0.9804 - recall: 0.9804 - auc: 0.9991 - val_loss: 0.0012 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0603 - tp: 78481.0000 - fp: 1519.0000 - tn: 318481.0000 - fn: 1519.0000 - accuracy: 0.9924 - precision: 0.9810 - recall: 0.9810 - auc: 0.9992 - val_loss: 4.5485e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0629 - tp: 78368.0000 - fp: 1632.0000 - tn: 318368.0000 - fn: 1632.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9991 - val_loss: 4.1571e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0598 - tp: 78488.0000 - fp: 1512.0000 - tn: 318488.0000 - fn: 1512.0000 - accuracy: 0.9924 - precision: 0.9811 - recall: 0.9811 - auc: 0.9992 - val_loss: 3.4001e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 44-44/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99809%,30:0.00076%,31:0.00057%,0:0.00038%,22:0.00019%]
[INFO] ** classification:[normal:64.36868%,Single Stage Single Point:35.63132%]
[INFO] ** dst:[21:43.32282%,10:21.04262%,8:18.16506%,9:17.46606%,22:0.00115%,15:0.00076%,18:0.00057%,25:0.00038%,24:0.00038%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99924%,0:0.00076%]
[INFO] ** i/f_name:[2:99.99924%,3:0.00076%]
[INFO] ** modbus_function_code:[0.02961:99.99809%,-33.760870000000004:0.00191%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.9979%,0:0.00191%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99809%,2:0.00115%,1:0.00076%]
[INFO] ** proxy_src_ip:[18:38.41395%,20:25.95206%,13:18.16525%,6:17.46664%,17:0.00076%,7:0.00038%,16:0.00019%,5:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95129%,-0.32151:21.04262%,-1.27613:18.16468%,-0.23351:17.46587%,-0.33484:17.37133%,-71.33197:0.00076%,-0.24151:0.00057%,1.45709:0.00038%,-64.19493:0.00038%,-0.08551:0.00038%,-1.27347:0.00038%,1.46509:0.00019%,1.47576:0.00019%,-0.24950999999999998:0.00019%,4.42897:0.00019%,-71.14931:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95072%,1:21.04262%,5:18.16468%,4:17.46549%,2:17.37114%,0:0.00535%]
[INFO] ** service:[0.0048200000000000005:99.99809%,-211.73542999999998:0.00076%,-186.43601999999998:0.00057%,-186.44547:0.00038%,-211.08818:0.00019%]
[INFO] ** src:[22:38.41395%,9:25.95206%,7:18.16525%,1:17.46664%,14:0.00076%,21:0.00038%,17:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1421 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0619 - tp: 78427.0000 - fp: 1573.0000 - tn: 318427.0000 - fn: 1573.0000 - accuracy: 0.9921 - precision: 0.9803 - recall: 0.9803 - auc: 0.9991 - val_loss: 4.4390e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0615 - tp: 78433.0000 - fp: 1567.0000 - tn: 318433.0000 - fn: 1567.0000 - accuracy: 0.9922 - precision: 0.9804 - recall: 0.9804 - auc: 0.9991 - val_loss: 5.7959e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0624 - tp: 78397.0000 - fp: 1603.0000 - tn: 318397.0000 - fn: 1603.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9991 - val_loss: 4.8434e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0629 - tp: 78377.0000 - fp: 1623.0000 - tn: 318377.0000 - fn: 1623.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9991 - val_loss: 0.0018 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-3-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0641 - tp: 78327.0000 - fp: 1673.0000 - tn: 318327.0000 - fn: 1673.0000 - accuracy: 0.9916 - precision: 0.9791 - recall: 0.9791 - auc: 0.9991 - val_loss: 0.0014 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 45-45/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99905%,30:0.00057%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.41681%,Single Stage Single Point:35.58319%]
[INFO] ** dst:[21:43.32301%,10:21.09151%,8:18.12152%,9:17.46186%,22:0.00115%,15:0.00057%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99905%,-33.760870000000004:0.00095%]
[INFO] ** modbus_function_description:[7:50.00038%,11:49.99866%,0:0.00095%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99924%,1:0.00057%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.48596%,20:25.92933%,13:18.12133%,6:17.46205%,17:0.00057%,16:0.00038%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.92856%,-0.32151:21.09151%,-1.27613:18.12133%,-0.23351:17.46167%,-0.33484:17.39444%,1.45709:0.00057%,-71.33197:0.00057%,-1.02014:0.00038%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.92799%,1:21.09132%,5:18.12133%,4:17.46167%,2:17.39425%,0:0.00344%]
[INFO] ** service:[0.0048200000000000005:99.99905%,-211.73542999999998:0.00057%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.48596%,9:25.92933%,7:18.12133%,1:17.46205%,14:0.00057%,15:0.00038%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1421 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0669 - tp: 78237.0000 - fp: 1763.0000 - tn: 318237.0000 - fn: 1763.0000 - accuracy: 0.9912 - precision: 0.9780 - recall: 0.9780 - auc: 0.9990 - val_loss: 5.0040e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0630 - tp: 78368.0000 - fp: 1632.0000 - tn: 318368.0000 - fn: 1632.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9991 - val_loss: 0.0012 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0641 - tp: 78338.0000 - fp: 1662.0000 - tn: 318338.0000 - fn: 1662.0000 - accuracy: 0.9917 - precision: 0.9792 - recall: 0.9792 - auc: 0.9991 - val_loss: 3.9709e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0642 - tp: 78320.0000 - fp: 1680.0000 - tn: 318320.0000 - fn: 1680.0000 - accuracy: 0.9916 - precision: 0.9790 - recall: 0.9790 - auc: 0.9991 - val_loss: 3.5846e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0640 - tp: 78342.0000 - fp: 1658.0000 - tn: 318342.0000 - fn: 1658.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9991 - val_loss: 3.0748e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 46-46/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99809%,30:0.00115%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.42139%,Single Stage Single Point:35.57861%]
[INFO] ** dst:[21:43.34745%,10:21.07127%,8:18.10624%,9:17.47236%,15:0.00115%,22:0.00095%,25:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99905%,0:0.00095%]
[INFO] ** i/f_name:[2:99.99885%,3:0.00115%]
[INFO] ** modbus_function_code:[0.02961:99.99809%,-33.760870000000004:0.00191%]
[INFO] ** modbus_function_description:[11:49.99924%,7:49.99885%,0:0.00191%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99847%,1:0.00115%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.44298%,20:25.97555%,13:18.10624%,6:17.47294%,17:0.00115%,16:0.00038%,7:0.00038%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97536%,-0.32151:21.07108%,-1.27613:18.10605%,-0.23351:17.47217%,-0.33484:17.37191%,-71.33197:0.00115%,-0.24151:0.00057%,-1.02014:0.00038%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,10.192739999999999:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.97497%,1:21.07089%,5:18.10586%,4:17.47179%,2:17.37191%,0:0.00458%]
[INFO] ** service:[0.0048200000000000005:99.99828%,-211.73542999999998:0.00115%,-186.44547:0.00019%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.44298%,9:25.97555%,7:18.10624%,1:17.47294%,14:0.00115%,21:0.00038%,15:0.00038%,16:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99905%,1:0.00095%]
[INFO] ** unixtime:1423 (0.27177%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0624 - tp: 78398.0000 - fp: 1602.0000 - tn: 318398.0000 - fn: 1602.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9991 - val_loss: 9.6347e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0619 - tp: 78414.0000 - fp: 1586.0000 - tn: 318414.0000 - fn: 1586.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9991 - val_loss: 3.8627e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0631 - tp: 78364.0000 - fp: 1636.0000 - tn: 318364.0000 - fn: 1636.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9991 - val_loss: 3.3387e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0625 - tp: 78381.0000 - fp: 1619.0000 - tn: 318381.0000 - fn: 1619.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9991 - val_loss: 6.2269e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0630 - tp: 78382.0000 - fp: 1618.0000 - tn: 318382.0000 - fn: 1618.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9991 - val_loss: 2.8102e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 47-47/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99943%,33:0.00019%,26:0.00019%,17:0.00019%]
[INFO] ** classification:[normal:64.3958%,Single Stage Single Point:35.6042%]
[INFO] ** dst:[21:43.30486%,10:21.08884%,8:18.12725%,9:17.47657%,22:0.00172%,24:0.00038%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99943%,-33.760870000000004:0.00057%]
[INFO] ** modbus_function_description:[7:50.00095%,11:49.99847%,0:0.00057%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99981%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.46036%,20:25.9341%,13:18.12763%,6:17.47695%,16:0.00038%,7:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.93315%,-0.32151:21.08884%,-1.27613:18.12706%,-0.23351:17.47638%,-0.33484:17.37153%,1.45709:0.00057%,-0.24151:0.00057%,-1.27347:0.00038%,-1.02014:0.00038%,-71.14798:0.00019%,-61.95635:0.00019%,10.192739999999999:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.93257%,1:21.08865%,5:18.12687%,4:17.47618%,2:17.37133%,0:0.00439%]
[INFO] ** service:[0.0048200000000000005:99.99962%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.46036%,9:25.9341%,7:18.12763%,1:17.47695%,21:0.00038%,15:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1421 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0634 - tp: 78378.0000 - fp: 1622.0000 - tn: 318378.0000 - fn: 1622.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9991 - val_loss: 3.5886e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0617 - tp: 78420.0000 - fp: 1580.0000 - tn: 318420.0000 - fn: 1580.0000 - accuracy: 0.9921 - precision: 0.9803 - recall: 0.9803 - auc: 0.9991 - val_loss: 3.4040e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0630 - tp: 78379.0000 - fp: 1621.0000 - tn: 318379.0000 - fn: 1621.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9991 - val_loss: 0.0011 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0611 - tp: 78439.0000 - fp: 1561.0000 - tn: 318439.0000 - fn: 1561.0000 - accuracy: 0.9922 - precision: 0.9805 - recall: 0.9805 - auc: 0.9991 - val_loss: 3.0739e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0632 - tp: 78372.0000 - fp: 1628.0000 - tn: 318372.0000 - fn: 1628.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9991 - val_loss: 2.9024e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 48-48/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99656%,30:0.00267%,33:0.00019%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.41758%,Single Stage Single Point:35.58242%]
[INFO] ** dst:[21:43.33046%,10:21.08311%,8:18.11254%,9:17.4695%,15:0.00267%,22:0.00095%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99771%,0:0.00229%]
[INFO] ** i/f_name:[2:99.99733%,3:0.00267%]
[INFO] ** modbus_function_code:[0.02961:99.99656%,-33.760870000000004:0.00344%]
[INFO] ** modbus_function_description:[7:49.99885%,11:49.99771%,0:0.00344%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99675%,1:0.00267%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.45444%,20:25.95931%,13:18.11293%,6:17.4695%,17:0.00267%,14:0.00057%,16:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95893%,-0.32151:21.08311%,-1.27613:18.11254%,-0.23351:17.46931%,-0.33484:17.37133%,-71.33197:0.00267%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,1.45709:0.00019%,-61.95635:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,13.431270000000001:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95855%,1:21.08311%,5:18.11254%,4:17.46931%,2:17.37114%,0:0.00535%]
[INFO] ** service:[0.0048200000000000005:99.99675%,-211.73542999999998:0.00267%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.45444%,9:25.95931%,7:18.11293%,1:17.4695%,14:0.00267%,2:0.00057%,15:0.00038%,8:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1421 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0636 - tp: 78355.0000 - fp: 1645.0000 - tn: 318355.0000 - fn: 1645.0000 - accuracy: 0.9918 - precision: 0.9794 - recall: 0.9794 - auc: 0.9991 - val_loss: 2.8532e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0617 - tp: 78416.0000 - fp: 1584.0000 - tn: 318416.0000 - fn: 1584.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9991 - val_loss: 2.6176e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0648 - tp: 78307.0000 - fp: 1693.0000 - tn: 318307.0000 - fn: 1693.0000 - accuracy: 0.9915 - precision: 0.9788 - recall: 0.9788 - auc: 0.9991 - val_loss: 2.6407e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0625 - tp: 78405.0000 - fp: 1595.0000 - tn: 318405.0000 - fn: 1595.0000 - accuracy: 0.9920 - precision: 0.9801 - recall: 0.9801 - auc: 0.9991 - val_loss: 7.4639e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0600 - tp: 78483.0000 - fp: 1517.0000 - tn: 318483.0000 - fn: 1517.0000 - accuracy: 0.9924 - precision: 0.9810 - recall: 0.9810 - auc: 0.9992 - val_loss: 7.1763e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 49-49/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99733%,30:0.00095%,17:0.00076%,22:0.00038%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.36601%,Single Stage Single Point:35.63399%]
[INFO] ** dst:[21:43.30219%,10:21.05943%,8:18.14367%,9:17.49032%,22:0.00134%,15:0.00095%,16:0.00076%,6:0.00057%,24:0.00038%,17:0.00038%]
[INFO] ** i/f_dir:[1:99.99905%,0:0.00095%]
[INFO] ** i/f_name:[2:99.99905%,3:0.00095%]
[INFO] ** modbus_function_code:[0.02961:99.99733%,-33.760870000000004:0.00267%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99771%,0:0.00267%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99847%,1:0.00095%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.4193%,20:25.94308%,13:18.14367%,6:17.49089%,17:0.00095%,1:0.00076%,21:0.00038%,16:0.00038%,14:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.94232%,-0.32151:21.05943%,-1.27613:18.14329%,-0.23351:17.49013%,-0.33484:17.35988%,-71.33197:0.00095%,-0.24151:0.00057%,1.45709:0.00038%,-1.02014:0.00038%,-71.14931:0.00038%,-1.27347:0.00038%,-71.14798:0.00019%,-58.035180000000004:0.00019%,-5.1466400000000005:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-5.08665:0.00019%,-0.24950999999999998:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.94193%,1:21.05924%,5:18.1431%,4:17.48974%,2:17.35988%,0:0.00611%]
[INFO] ** service:[0.0048200000000000005:99.99733%,-211.73542999999998:0.00095%,-205.44247:0.00076%,-211.08818:0.00038%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.4193%,9:25.94308%,7:18.14367%,1:17.49089%,14:0.00095%,3:0.00076%,15:0.00038%,4:0.00038%,2:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1422 (0.27158%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0636 - tp: 78370.0000 - fp: 1630.0000 - tn: 318370.0000 - fn: 1630.0000 - accuracy: 0.9919 - precision: 0.9796 - recall: 0.9796 - auc: 0.9991 - val_loss: 7.2100e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0627 - tp: 78388.0000 - fp: 1612.0000 - tn: 318388.0000 - fn: 1612.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9991 - val_loss: 3.8776e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0630 - tp: 78383.0000 - fp: 1617.0000 - tn: 318383.0000 - fn: 1617.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9991 - val_loss: 3.5102e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0642 - tp: 78336.0000 - fp: 1664.0000 - tn: 318336.0000 - fn: 1664.0000 - accuracy: 0.9917 - precision: 0.9792 - recall: 0.9792 - auc: 0.9991 - val_loss: 0.0013 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-3-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0613 - tp: 78433.0000 - fp: 1567.0000 - tn: 318433.0000 - fn: 1567.0000 - accuracy: 0.9922 - precision: 0.9804 - recall: 0.9804 - auc: 0.9991 - val_loss: 5.7496e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 50-50/50 on epoch 3/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (373586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (373586, 17)

[INFO] analyzing data
[INFO] 373586 rows
[INFO] ** appi_name:[21:99.99732%,30:0.00107%,7:0.0008%,31:0.00027%,22:0.00027%,8:0.00027%]
[INFO] ** classification:[normal:64.29631%,Single Stage Single Point:35.70369%]
[INFO] ** dst:[21:43.25216%,10:21.04094%,8:18.22713%,9:17.4763%,15:0.00107%,22:0.00054%,16:0.00054%,2:0.00054%,24:0.00027%,18:0.00027%,6:0.00027%]
[INFO] ** i/f_dir:[1:99.99893%,0:0.00107%]
[INFO] ** i/f_name:[2:99.99893%,3:0.00107%]
[INFO] ** modbus_function_code:[0.02961:99.99732%,-33.760870000000004:0.00268%]
[INFO] ** modbus_function_description:[11:49.99893%,7:49.99839%,0:0.00268%]
[INFO] ** modbus_transaction_id:65535 (17.54215%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99839%,1:0.00107%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.36145%,20:25.93191%,13:18.2274%,6:17.4763%,17:0.00107%,1:0.0008%,21:0.00027%,16:0.00027%,14:0.00027%,7:0.00027%]
[INFO] ** s_port:[1.45442:25.93138%,-0.32151:21.04094%,-1.27613:18.22686%,-0.23351:17.4763%,-0.33484:17.32051%,-71.33197:0.00107%,-3.3787199999999995:0.00027%,4.33564:0.00027%,15.912510000000001:0.00027%,7.9608300000000005:0.00027%,1.46509:0.00027%,1.45709:0.00027%,-1.27347:0.00027%,-71.14931:0.00027%,-1.02014:0.00027%,-1.2708:0.00027%,0.31847:0.00027%]
[INFO] ** scada_tag:[3:25.93111%,1:21.04067%,5:18.22659%,4:17.4763%,2:17.32024%,0:0.00509%]
[INFO] ** service:[0.0048200000000000005:99.99732%,-211.73542999999998:0.00107%,-211.09762999999998:0.0008%,-186.43601999999998:0.00027%,-211.35747999999998:0.00027%,-211.08818:0.00027%]
[INFO] ** src:[22:38.36145%,9:25.93191%,7:18.2274%,1:17.4763%,14:0.00107%,3:0.0008%,21:0.00027%,15:0.00027%,4:0.00027%,2:0.00027%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1015 (0.27169%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/373586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0628 - tp: 78392.0000 - fp: 1608.0000 - tn: 318392.0000 - fn: 1608.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9991 - val_loss: 6.1997e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/373586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0608 - tp: 78455.0000 - fp: 1545.0000 - tn: 318455.0000 - fn: 1545.0000 - accuracy: 0.9923 - precision: 0.9807 - recall: 0.9807 - auc: 0.9991 - val_loss: 4.9962e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/373586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0626 - tp: 78399.0000 - fp: 1601.0000 - tn: 318399.0000 - fn: 1601.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9991 - val_loss: 7.1756e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/373586
[33m[INFO] epoch 4/100[0m
[33m[INFO] loading file 1-1/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99355%,30:0.00105%,22:0.00087%,17:0.0007%,7:0.0007%,31:0.00052%,26:0.00052%,23:0.00035%,18:0.00035%,0:0.00035%,28:0.00017%,27:0.00017%,24:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:77.37096%,Single Stage Single Point:22.62904%]
[INFO] ** dst:[21:43.26762%,10:21.03643%,8:18.17129%,9:17.51769%,6:0.00139%,22:0.00105%,16:0.00105%,15:0.00105%,18:0.00052%,26:0.00035%,25:0.00035%,19:0.00035%,17:0.00035%,24:0.00017%,7:0.00017%,2:0.00017%]
[INFO] ** i/f_dir:[1:99.99895%,0:0.00105%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99355%,-33.760870000000004:0.00628%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99756%,11:49.99599%,0:0.00628%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99651%,2:0.00244%,1:0.00105%]
[INFO] ** proxy_src_ip:[18:38.39581%,20:25.90788%,13:18.17147%,6:17.51804%,11:0.00122%,10:0.00122%,17:0.00105%,1:0.00105%,14:0.00087%,7:0.00052%,21:0.00035%,16:0.00035%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.90736%,-0.32151:21.03573%,-1.27613:18.17112%,-0.23351:17.51751%,-0.33484:17.36008%,-71.33197:0.00105%,-71.14931:0.00087%,-2.1481:0.0007%,-71.14798:0.00052%,-0.24151:0.00052%,-64.19493:0.00035%,-2.42942:0.00035%,4.44364:0.00035%,-1.02014:0.00035%,1.47576:0.00017%,-5.1466400000000005:0.00017%,-1.27347:0.00017%,10.67005:0.00017%,4.29964:0.00017%,-5.08665:0.00017%,1.45709:0.00017%,-68.79874000000001:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,14.253910000000001:0.00017%,4.076980000000001:0.00017%,-58.032509999999995:0.00017%,-58.035180000000004:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,0.31847:0.00017%]
[INFO] ** scada_tag:[3:25.90719%,1:21.03556%,5:18.17077%,4:17.51734%,2:17.35991%,0:0.00924%]
[INFO] ** service:[0.0048200000000000005:99.99425%,-211.73542999999998:0.00105%,-211.08818:0.00087%,-211.09762999999998:0.0007%,-205.44247:0.0007%,-211.07873999999998:0.0007%,-211.08346:0.00052%,-186.43601999999998:0.00052%,-186.44547:0.00035%,-185.9872:0.00017%,-202.75898:0.00017%]
[INFO] ** src:[22:38.39581%,9:25.90788%,7:18.17147%,1:17.51804%,11:0.00122%,10:0.00122%,14:0.00105%,3:0.00105%,2:0.00087%,21:0.00052%,15:0.00035%,4:0.00035%,8:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1557 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1792 - tp: 76150.0000 - fp: 3850.0000 - tn: 316150.0000 - fn: 3850.0000 - accuracy: 0.9808 - precision: 0.9519 - recall: 0.9519 - auc: 0.9943 - val_loss: 1.0376 - val_tp: 14866.0000 - val_fp: 5134.0000 - val_tn: 74866.0000 - val_fn: 5134.0000 - val_accuracy: 0.8973 - val_precision: 0.7433 - val_recall: 0.7433 - val_auc: 0.9600
[INFO] saving weights to checkpoints/lstm-epoch-4-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1090 - tp: 76139.0000 - fp: 3861.0000 - tn: 316139.0000 - fn: 3861.0000 - accuracy: 0.9807 - precision: 0.9517 - recall: 0.9517 - auc: 0.9977 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0353 - tp: 77489.0000 - fp: 2511.0000 - tn: 317489.0000 - fn: 2511.0000 - accuracy: 0.9874 - precision: 0.9686 - recall: 0.9686 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.9073 - tp: 63350.0000 - fp: 16650.0000 - tn: 303350.0000 - fn: 16650.0000 - accuracy: 0.9168 - precision: 0.7919 - recall: 0.7919 - auc: 0.9525 - val_loss: 0.9129 - val_tp: 10612.0000 - val_fp: 9388.0000 - val_tn: 70612.0000 - val_fn: 9388.0000 - val_accuracy: 0.8122 - val_precision: 0.5306 - val_recall: 0.5306 - val_auc: 0.9241
[INFO] saving weights to checkpoints/lstm-epoch-4-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4648 - tp: 62697.0000 - fp: 17303.0000 - tn: 302697.0000 - fn: 17303.0000 - accuracy: 0.9135 - precision: 0.7837 - recall: 0.7837 - auc: 0.9678 - val_loss: 0.2899 - val_tp: 18917.0000 - val_fp: 1083.0000 - val_tn: 78917.0000 - val_fn: 1083.0000 - val_accuracy: 0.9783 - val_precision: 0.9459 - val_recall: 0.9459 - val_auc: 0.9980
[INFO] saving weights to checkpoints/lstm-epoch-4-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 2-2/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99861%,30:0.00052%,7:0.00052%,31:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:70.25834%,Single Stage Single Point:29.74166%]
[INFO] ** dst:[21:43.31417%,10:21.02475%,8:18.13677%,9:17.52187%,22:0.00087%,15:0.00052%,16:0.00035%,2:0.00035%,24:0.00017%,18:0.00017%]
[INFO] ** i/f_dir:[1:99.99948%,0:0.00052%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.99861%,-33.760870000000004:0.00139%]
[INFO] ** modbus_function_description:[7:49.99983%,11:49.99878%,0:0.00139%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9993%,1:0.00052%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.37716%,20:25.96228%,13:18.13677%,6:17.52222%,17:0.00052%,1:0.00052%,16:0.00017%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.96158%,-0.32151:21.02475%,-1.27613:18.13643%,-0.23351:17.5217%,-0.33484:17.35241%,-71.33197:0.00052%,-0.24151:0.00035%,1.45709:0.00035%,1.46509:0.00017%,1.47576:0.00017%,12.60597:0.00017%,10.67005:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,4.076980000000001:0.00017%,-3.3787199999999995:0.00017%,4.29964:0.00017%,-1.27347:0.00017%]
[INFO] ** scada_tag:[3:25.96123%,1:21.02475%,5:18.13643%,4:17.52135%,2:17.35224%,0:0.00401%]
[INFO] ** service:[0.0048200000000000005:99.99861%,-211.09762999999998:0.00052%,-211.73542999999998:0.00052%,-211.35747999999998:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.37716%,9:25.96228%,7:18.13677%,1:17.52222%,14:0.00052%,3:0.00052%,21:0.00017%,15:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1560 (0.27197%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2281 - tp: 75888.0000 - fp: 4112.0000 - tn: 315888.0000 - fn: 4112.0000 - accuracy: 0.9794 - precision: 0.9486 - recall: 0.9486 - auc: 0.9949 - val_loss: 0.0849 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1043 - tp: 77980.0000 - fp: 2020.0000 - tn: 317980.0000 - fn: 2020.0000 - accuracy: 0.9899 - precision: 0.9747 - recall: 0.9747 - auc: 0.9982 - val_loss: 0.0118 - val_tp: 19980.0000 - val_fp: 20.0000 - val_tn: 79980.0000 - val_fn: 20.0000 - val_accuracy: 0.9996 - val_precision: 0.9990 - val_recall: 0.9990 - val_auc: 0.9996
[INFO] saving weights to checkpoints/lstm-epoch-4-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2572 - tp: 70313.0000 - fp: 9687.0000 - tn: 310313.0000 - fn: 9687.0000 - accuracy: 0.9516 - precision: 0.8789 - recall: 0.8789 - auc: 0.9898 - val_loss: 6.4177e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2773 - tp: 53130.0000 - fp: 26870.0000 - tn: 293130.0000 - fn: 26870.0000 - accuracy: 0.8657 - precision: 0.6641 - recall: 0.6641 - auc: 0.9175 - val_loss: 0.6903 - val_tp: 15845.0000 - val_fp: 4155.0000 - val_tn: 75845.0000 - val_fn: 4155.0000 - val_accuracy: 0.9169 - val_precision: 0.7922 - val_recall: 0.7922 - val_auc: 0.9510
[INFO] saving weights to checkpoints/lstm-epoch-4-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3239 - tp: 72814.0000 - fp: 7186.0000 - tn: 312814.0000 - fn: 7186.0000 - accuracy: 0.9641 - precision: 0.9102 - recall: 0.9102 - auc: 0.9897 - val_loss: 0.1454 - val_tp: 19995.0000 - val_fp: 5.0000 - val_tn: 79995.0000 - val_fn: 5.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 3-3/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99198%,30:0.00209%,22:0.00105%,31:0.00087%,26:0.00087%,17:0.00087%,7:0.0007%,27:0.00035%,0:0.00035%,28:0.00017%,23:0.00017%,15:0.00017%,8:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:88.37716%,Single Stage Single Point:11.62284%]
[INFO] ** dst:[21:43.30719%,10:21.08054%,8:18.15874%,9:17.44464%,6:0.00209%,15:0.00139%,18:0.00122%,16:0.00122%,22:0.00087%,2:0.00035%,7:0.00035%,25:0.00035%,17:0.00035%,12:0.00017%,24:0.00017%,19:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99861%,0:0.00139%]
[INFO] ** i/f_name:[2:99.99861%,3:0.00139%]
[INFO] ** modbus_function_code:[0.02961:99.99198%,-33.760870000000004:0.00785%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99669%,11:49.99529%,0:0.00785%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99895%,2:0.00105%]
[INFO] ** proto:[0:99.99442%,2:0.00418%,1:0.00139%]
[INFO] ** proxy_src_ip:[18:38.40523%,20:25.98268%,13:18.15909%,6:17.44499%,17:0.00209%,1:0.00139%,14:0.00122%,7:0.00087%,11:0.0007%,10:0.0007%,21:0.00052%,16:0.00017%,15:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.98198%,-0.32151:21.08036%,-1.27613:18.15839%,-0.23351:17.44446%,-0.33484:17.32486%,-71.33197:0.00139%,-71.14931:0.00105%,-71.14798:0.00105%,-64.19493:0.00035%,-1.2708:0.00035%,-0.08551:0.00035%,1.45709:0.00035%,-0.24151:0.00035%,13.86459:0.00017%,2.05573:0.00017%,6.1115699999999995:0.00017%,4.44364:0.00017%,-5.08665:0.00017%,-3.3787199999999995:0.00017%,10.192739999999999:0.00017%,4.29964:0.00017%,14.4699:0.00017%,-43.76509:0.00017%,-58.035180000000004:0.00017%,4.90362:0.00017%,4.076980000000001:0.00017%,-58.032509999999995:0.00017%,-1.27347:0.00017%,-1.02014:0.00017%,-5.1466400000000005:0.00017%,13.431270000000001:0.00017%,12.60597:0.00017%,1.47576:0.00017%,1.46509:0.00017%,14.253910000000001:0.00017%,-68.79874000000001:0.00017%,-0.24950999999999998:0.00017%,-2.1481:0.00017%,10.67005:0.00017%,-68.36943000000001:0.00017%]
[INFO] ** scada_tag:[3:25.98163%,1:21.08019%,5:18.15822%,4:17.44429%,2:17.32469%,0:0.01098%]
[INFO] ** service:[0.0048200000000000005:99.99215%,-211.73542999999998:0.00139%,-186.43601999999998:0.00122%,-211.08346:0.00105%,-211.08818:0.00105%,-205.44247:0.00087%,-211.09762999999998:0.0007%,-202.75898:0.00035%,-186.44547:0.00035%,-183.8612:0.00017%,-185.9872:0.00017%,-201.23771000000002:0.00017%,-211.35747999999998:0.00017%,-211.07873999999998:0.00017%]
[INFO] ** src:[22:38.40523%,9:25.98268%,7:18.15909%,1:17.44499%,21:0.00192%,3:0.00157%,2:0.00122%,11:0.0007%,10:0.0007%,4:0.0007%,14:0.00035%,8:0.00035%,17:0.00017%,15:0.00017%,13:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1558 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1740 - tp: 71378.0000 - fp: 8622.0000 - tn: 311378.0000 - fn: 8622.0000 - accuracy: 0.9569 - precision: 0.8922 - recall: 0.8922 - auc: 0.9947 - val_loss: 6.7992 - val_tp: 10572.0000 - val_fp: 9428.0000 - val_tn: 70572.0000 - val_fn: 9428.0000 - val_accuracy: 0.8114 - val_precision: 0.5286 - val_recall: 0.5286 - val_auc: 0.7148
[INFO] saving weights to checkpoints/lstm-epoch-4-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3014 - tp: 76348.0000 - fp: 3652.0000 - tn: 316348.0000 - fn: 3652.0000 - accuracy: 0.9817 - precision: 0.9543 - recall: 0.9543 - auc: 0.9907 - val_loss: 0.1048 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4379 - tp: 55462.0000 - fp: 24538.0000 - tn: 295462.0000 - fn: 24538.0000 - accuracy: 0.8773 - precision: 0.6933 - recall: 0.6933 - auc: 0.9620 - val_loss: 0.2312 - val_tp: 18025.0000 - val_fp: 1975.0000 - val_tn: 78025.0000 - val_fn: 1975.0000 - val_accuracy: 0.9605 - val_precision: 0.9013 - val_recall: 0.9013 - val_auc: 0.9949
[INFO] saving weights to checkpoints/lstm-epoch-4-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0778 - tp: 75921.0000 - fp: 4079.0000 - tn: 315921.0000 - fn: 4079.0000 - accuracy: 0.9796 - precision: 0.9490 - recall: 0.9490 - auc: 0.9990 - val_loss: 0.0056 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0348 - tp: 77416.0000 - fp: 2584.0000 - tn: 317416.0000 - fn: 2584.0000 - accuracy: 0.9871 - precision: 0.9677 - recall: 0.9677 - auc: 0.9997 - val_loss: 0.0015 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 4-4/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99773%,30:0.00122%,31:0.00035%,33:0.00017%,26:0.00017%,23:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:92.36732%,Single Stage Single Point:7.63268%]
[INFO] ** dst:[21:43.34938%,10:20.951%,8:18.17565%,9:17.5203%,22:0.00122%,15:0.00122%,24:0.00035%,18:0.00035%,19:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99895%,0:0.00105%]
[INFO] ** i/f_name:[2:99.99878%,3:0.00122%]
[INFO] ** modbus_function_code:[0.02961:99.99773%,-33.760870000000004:0.00227%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99773%,0:0.00227%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99895%,2:0.00105%]
[INFO] ** proto:[0:99.99826%,1:0.00122%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.26227%,20:26.03847%,13:18.17583%,6:17.52065%,17:0.00122%,16:0.00052%,21:0.00035%,14:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.03777%,-0.32151:20.95083%,-1.27613:18.1753%,-0.23351:17.52013%,-0.33484:17.31144%,-71.33197:0.00122%,-1.02014:0.00052%,1.45709:0.00035%,-0.08551:0.00035%,-1.27347:0.00035%,-0.24151:0.00035%,14.4699:0.00017%,4.44364:0.00017%,-71.14798:0.00017%,-1.2708:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:26.03742%,1:20.95065%,5:18.1753%,4:17.51978%,2:17.31127%,0:0.00558%]
[INFO] ** service:[0.0048200000000000005:99.99791%,-211.73542999999998:0.00122%,-186.43601999999998:0.00035%,-183.8612:0.00017%,-211.08346:0.00017%,-211.07873999999998:0.00017%]
[INFO] ** src:[22:38.26227%,9:26.03847%,7:18.17583%,1:17.52065%,21:0.00105%,15:0.00052%,4:0.00035%,17:0.00017%,14:0.00017%,8:0.00017%,3:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1568 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0280 - tp: 77514.0000 - fp: 2486.0000 - tn: 317514.0000 - fn: 2486.0000 - accuracy: 0.9876 - precision: 0.9689 - recall: 0.9689 - auc: 0.9998 - val_loss: 4.9126e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0248 - tp: 78389.0000 - fp: 1611.0000 - tn: 318389.0000 - fn: 1611.0000 - accuracy: 0.9919 - precision: 0.9799 - recall: 0.9799 - auc: 0.9998 - val_loss: 1.5059e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0216 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.2420e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7532e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.1283 - tp: 55111.0000 - fp: 24889.0000 - tn: 295111.0000 - fn: 24889.0000 - accuracy: 0.8756 - precision: 0.6889 - recall: 0.6889 - auc: 0.9092 - val_loss: 0.7188 - val_tp: 7842.0000 - val_fp: 12158.0000 - val_tn: 67842.0000 - val_fn: 12158.0000 - val_accuracy: 0.7568 - val_precision: 0.3921 - val_recall: 0.3921 - val_auc: 0.8963
[INFO] saving weights to checkpoints/lstm-epoch-4-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 5-5/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99616%,30:0.00279%,37:0.00017%,26:0.00017%,12:0.00017%,9:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:88.95144%,Single Stage Single Point:11.04856%]
[INFO] ** dst:[21:43.36473%,10:20.77108%,8:18.23737%,9:17.62229%,15:0.00279%,22:0.00087%,25:0.00017%,24:0.00017%,6:0.00017%,2:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99756%,0:0.00244%]
[INFO] ** i/f_name:[2:99.99721%,3:0.00279%]
[INFO] ** modbus_function_code:[0.02961:99.99616%,-33.760870000000004:0.00384%]
[INFO] ** modbus_function_description:[7:49.99861%,11:49.99756%,0:0.00384%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99773%,2:0.00227%]
[INFO] ** proto:[0:99.99686%,1:0.00279%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.00895%,20:26.12721%,13:18.23737%,6:17.62247%,17:0.00279%,1:0.00035%,21:0.00017%,16:0.00017%,7:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.12651%,-0.32151:20.77073%,-1.27613:18.2372%,-0.23351:17.62212%,-0.33484:17.23822%,-71.33197:0.00279%,-0.24151:0.00035%,1.45709:0.00035%,1.47576:0.00017%,1.46509:0.00017%,-49.275529999999996:0.00017%,-1.27347:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,2.22906:0.00017%,14.4699:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.12616%,1:20.77056%,5:18.23702%,4:17.62212%,2:17.23822%,0:0.00593%]
[INFO] ** service:[0.0048200000000000005:99.99651%,-211.73542999999998:0.00279%,-183.8612:0.00017%,-211.08346:0.00017%,-211.35747999999998:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.00895%,9:26.12721%,7:18.23737%,1:17.62247%,21:0.00244%,14:0.00052%,3:0.00035%,16:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1571 (0.27389%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3602 - tp: 72873.0000 - fp: 7127.0000 - tn: 312873.0000 - fn: 7127.0000 - accuracy: 0.9644 - precision: 0.9109 - recall: 0.9109 - auc: 0.9798 - val_loss: 0.1691 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6249 - tp: 52996.0000 - fp: 27004.0000 - tn: 292996.0000 - fn: 27004.0000 - accuracy: 0.8650 - precision: 0.6625 - recall: 0.6625 - auc: 0.9260 - val_loss: 0.5645 - val_tp: 12869.0000 - val_fp: 7131.0000 - val_tn: 72869.0000 - val_fn: 7131.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.9383
[INFO] saving weights to checkpoints/lstm-epoch-4-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5345 - tp: 57790.0000 - fp: 22210.0000 - tn: 297790.0000 - fn: 22210.0000 - accuracy: 0.8889 - precision: 0.7224 - recall: 0.7224 - auc: 0.9405 - val_loss: 0.2940 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1808 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0250 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0853 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0102 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 6-6/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99599%,30:0.00314%,31:0.00017%,27:0.00017%,26:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:92.95572%,Single Stage Single Point:7.04428%]
[INFO] ** dst:[21:43.37606%,10:20.73046%,8:18.27869%,9:17.61009%,15:0.00314%,22:0.00052%,25:0.00017%,24:0.00017%,18:0.00017%,12:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99704%,0:0.00296%]
[INFO] ** i/f_name:[2:99.99686%,3:0.00314%]
[INFO] ** modbus_function_code:[0.02961:99.99599%,-33.760870000000004:0.00401%]
[INFO] ** modbus_function_description:[7:49.99878%,11:49.99721%,0:0.00401%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.99599%,1:0.00314%,2:0.00087%]
[INFO] ** proxy_src_ip:[18:37.94061%,20:26.16608%,13:18.27886%,6:17.61026%,17:0.00314%,14:0.00052%,16:0.00035%,11:0.00017%]
[INFO] ** s_port:[1.45442:26.16574%,-0.32151:20.73046%,-1.27613:18.27834%,-0.23351:17.60991%,-0.33484:17.21015%,-71.33197:0.00314%,-1.02014:0.00035%,-71.14798:0.00017%,-64.19493:0.00017%,4.90362:0.00017%,-1.2708:0.00017%,-0.24151:0.00017%,13.431270000000001:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-68.36943000000001:0.00017%]
[INFO] ** scada_tag:[3:26.16556%,1:20.73011%,5:18.27817%,4:17.60957%,2:17.20997%,0:0.00662%]
[INFO] ** service:[0.0048200000000000005:99.99599%,-211.73542999999998:0.00314%,-211.08346:0.00017%,-201.23771000000002:0.00017%,-202.75898:0.00017%,-186.44547:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:37.94061%,9:26.16608%,7:18.27886%,1:17.61026%,14:0.00314%,2:0.00052%,15:0.00035%,10:0.00017%]
[INFO] ** type:[0:99.99913%,1:0.00087%]
[INFO] ** unixtime:1570 (0.27372%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0509 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0032 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0290 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0018 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0232 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0013 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0153 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0671e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3574 - tp: 73340.0000 - fp: 6660.0000 - tn: 313340.0000 - fn: 6660.0000 - accuracy: 0.9667 - precision: 0.9168 - recall: 0.9168 - auc: 0.9769 - val_loss: 0.9649 - val_tp: 12742.0000 - val_fp: 7258.0000 - val_tn: 72742.0000 - val_fn: 7258.0000 - val_accuracy: 0.8548 - val_precision: 0.6371 - val_recall: 0.6371 - val_auc: 0.9296
[INFO] saving weights to checkpoints/lstm-epoch-4-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 7-7/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99547%,30:0.00157%,22:0.00087%,17:0.0007%,26:0.00052%,31:0.00035%,28:0.00017%,27:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:80.31577%,Single Stage Single Point:19.68423%]
[INFO] ** dst:[21:43.36368%,10:20.73848%,8:18.25149%,9:17.64007%,15:0.00157%,22:0.00139%,6:0.00139%,16:0.0007%,24:0.00035%,18:0.00035%,17:0.00035%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.99843%,0:0.00157%]
[INFO] ** i/f_name:[2:99.99843%,3:0.00157%]
[INFO] ** modbus_function_code:[0.02961:99.99547%,-33.760870000000004:0.00453%]
[INFO] ** modbus_function_description:[7:49.99843%,11:49.99704%,0:0.00453%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99651%,2:0.00192%,1:0.00157%]
[INFO] ** proxy_src_ip:[18:37.96031%,20:26.14255%,13:18.25184%,6:17.64025%,17:0.00157%,11:0.0007%,1:0.0007%,21:0.00052%,16:0.00052%,14:0.00035%,7:0.00035%,10:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.14168%,-0.32151:20.73848%,-1.27613:18.25132%,-0.23351:17.6399%,-0.33484:17.22183%,-71.33197:0.00157%,-71.14931:0.00087%,-1.02014:0.00052%,-71.14798:0.00052%,1.45709:0.00052%,-0.24151:0.00035%,-1.27347:0.00035%,1.47576:0.00017%,1.46509:0.00017%,14.253910000000001:0.00017%,-1.2708:0.00017%,-58.035180000000004:0.00017%,-58.032509999999995:0.00017%,-68.79874000000001:0.00017%,-43.76509:0.00017%,2.05573:0.00017%,6.1115699999999995:0.00017%,-5.08665:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:26.14133%,1:20.73848%,5:18.25114%,4:17.63973%,2:17.22165%,0:0.00767%]
[INFO] ** service:[0.0048200000000000005:99.99547%,-211.73542999999998:0.00157%,-211.08818:0.00087%,-205.44247:0.0007%,-211.08346:0.00052%,-186.43601999999998:0.00035%,-211.09762999999998:0.00017%,-185.9872:0.00017%,-202.75898:0.00017%]
[INFO] ** src:[22:37.96031%,9:26.14255%,7:18.25184%,1:17.64025%,14:0.00157%,10:0.0007%,3:0.0007%,15:0.00052%,4:0.00052%,21:0.00035%,2:0.00035%,11:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1567 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7729 - tp: 51243.0000 - fp: 28757.0000 - tn: 291243.0000 - fn: 28757.0000 - accuracy: 0.8562 - precision: 0.6405 - recall: 0.6405 - auc: 0.9189 - val_loss: 0.6064 - val_tp: 12802.0000 - val_fp: 7198.0000 - val_tn: 72802.0000 - val_fn: 7198.0000 - val_accuracy: 0.8560 - val_precision: 0.6401 - val_recall: 0.6401 - val_auc: 0.9318
[INFO] saving weights to checkpoints/lstm-epoch-4-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5604 - tp: 57494.0000 - fp: 22506.0000 - tn: 297494.0000 - fn: 22506.0000 - accuracy: 0.8875 - precision: 0.7187 - recall: 0.7187 - auc: 0.9389 - val_loss: 0.3236 - val_tp: 18392.0000 - val_fp: 1608.0000 - val_tn: 78392.0000 - val_fn: 1608.0000 - val_accuracy: 0.9678 - val_precision: 0.9196 - val_recall: 0.9196 - val_auc: 0.9948
[INFO] saving weights to checkpoints/lstm-epoch-4-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4248 - tp: 65298.0000 - fp: 14702.0000 - tn: 305298.0000 - fn: 14702.0000 - accuracy: 0.9265 - precision: 0.8162 - recall: 0.8162 - auc: 0.9577 - val_loss: 0.1968 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3192 - tp: 74449.0000 - fp: 5551.0000 - tn: 314449.0000 - fn: 5551.0000 - accuracy: 0.9722 - precision: 0.9306 - recall: 0.9306 - auc: 0.9829 - val_loss: 0.1417 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1208 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0839 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 8-8/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99721%,30:0.00105%,0:0.00052%,24:0.00017%,23:0.00017%,22:0.00017%,18:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:95.01766%,Single Stage Single Point:4.98234%]
[INFO] ** dst:[21:43.4179%,10:20.80176%,8:18.19483%,9:17.58202%,22:0.00122%,15:0.00105%,25:0.00052%,19:0.00035%,26:0.00017%,24:0.00017%]
[INFO] ** i/f_dir:[1:99.9993%,0:0.0007%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99721%,-33.760870000000004:0.00262%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99965%,11:49.99756%,0:0.00262%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99965%,2:0.00035%]
[INFO] ** proto:[0:99.99826%,1:0.00105%,2:0.0007%]
[INFO] ** proxy_src_ip:[18:38.08461%,20:26.13558%,13:18.19413%,6:17.58237%,17:0.00105%,10:0.00105%,16:0.00052%,14:0.00035%,11:0.00017%,5:0.00017%]
[INFO] ** s_port:[1.45442:26.13505%,-0.32151:20.80176%,-1.27613:18.19396%,-0.23351:17.58184%,-0.33484:17.28285%,-71.33197:0.00105%,-15.039579999999999:0.0007%,-1.02014:0.00052%,-64.19493:0.00052%,1.45709:0.00035%,-0.24151:0.00035%,4.66896:0.00035%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,-71.14931:0.00017%]
[INFO] ** scada_tag:[3:26.13453%,1:20.80159%,5:18.19396%,4:17.58167%,2:17.28267%,0:0.00558%]
[INFO] ** service:[0.0048200000000000005:99.99791%,-211.73542999999998:0.00105%,-186.44547:0.00052%,-211.07873999999998:0.00035%,-211.08818:0.00017%]
[INFO] ** src:[22:38.08461%,9:26.13558%,7:18.19413%,1:17.58237%,11:0.00105%,14:0.0007%,15:0.00052%,21:0.00035%,2:0.00035%,16:0.00017%,10:0.00017%]
[INFO] ** type:[0:99.99948%,1:0.00035%,2:0.00017%]
[INFO] ** unixtime:1570 (0.27372%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0573 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0383 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0427 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0293 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0308 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0238 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0243 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0195 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5650 - tp: 68385.0000 - fp: 11615.0000 - tn: 308385.0000 - fn: 11615.0000 - accuracy: 0.9419 - precision: 0.8548 - recall: 0.8548 - auc: 0.9653 - val_loss: 0.5123 - val_tp: 16386.0000 - val_fp: 3614.0000 - val_tn: 76386.0000 - val_fn: 3614.0000 - val_accuracy: 0.9277 - val_precision: 0.8193 - val_recall: 0.8193 - val_auc: 0.9642
[INFO] saving weights to checkpoints/lstm-epoch-4-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 9-9/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99826%,30:0.00105%,31:0.00035%,26:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:94.27636%,Single Stage Single Point:5.72364%]
[INFO] ** dst:[21:43.37362%,10:20.77387%,8:18.27782%,9:17.57191%,15:0.00105%,22:0.00087%,18:0.00035%,25:0.00017%,24:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99895%,0:0.00105%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99826%,-33.760870000000004:0.00174%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99826%,0:0.00174%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99965%,2:0.00035%]
[INFO] ** proto:[0:99.99826%,1:0.00105%,2:0.0007%]
[INFO] ** proxy_src_ip:[18:38.01069%,20:26.13732%,13:18.27782%,6:17.57226%,17:0.00105%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.13662%,-0.32151:20.77387%,-1.27613:18.27747%,-0.23351:17.57173%,-0.33484:17.23682%,-71.33197:0.00105%,-0.24151:0.00035%,1.45709:0.00035%,-0.08551:0.00035%,1.46509:0.00017%,1.47576:0.00017%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.13627%,1:20.77369%,5:18.27747%,4:17.57156%,2:17.23665%,0:0.00436%]
[INFO] ** service:[0.0048200000000000005:99.99826%,-211.73542999999998:0.00105%,-186.43601999999998:0.00035%,-211.08346:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.01069%,9:26.13732%,7:18.27782%,1:17.57226%,14:0.0007%,21:0.00035%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1570 (0.27372%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4841 - tp: 65478.0000 - fp: 14522.0000 - tn: 305478.0000 - fn: 14522.0000 - accuracy: 0.9274 - precision: 0.8185 - recall: 0.8185 - auc: 0.9626 - val_loss: 0.4595 - val_tp: 16308.0000 - val_fp: 3692.0000 - val_tn: 76308.0000 - val_fn: 3692.0000 - val_accuracy: 0.9262 - val_precision: 0.8154 - val_recall: 0.8154 - val_auc: 0.9636
[INFO] saving weights to checkpoints/lstm-epoch-4-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4482 - tp: 65384.0000 - fp: 14616.0000 - tn: 305384.0000 - fn: 14616.0000 - accuracy: 0.9269 - precision: 0.8173 - recall: 0.8173 - auc: 0.9630 - val_loss: 0.1615 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1192 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0839 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0705 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0563 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0495 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0413 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 10-10/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99634%,30:0.00174%,31:0.00035%,26:0.00017%,24:0.00017%,23:0.00017%,22:0.00017%,18:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:94.67403%,Single Stage Single Point:5.32597%]
[INFO] ** dst:[21:43.4118%,10:20.80769%,8:18.2222%,9:17.55447%,15:0.00174%,22:0.00052%,24:0.00035%,19:0.00035%,18:0.00035%,26:0.00017%,25:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99843%,0:0.00157%]
[INFO] ** i/f_name:[2:99.99826%,3:0.00174%]
[INFO] ** modbus_function_code:[0.02961:99.99634%,-33.760870000000004:0.00349%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99895%,11:49.99738%,0:0.00349%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.9993%,1:0.0007%]
[INFO] ** proto:[0:99.99738%,1:0.00174%,2:0.00087%]
[INFO] ** proxy_src_ip:[18:38.08426%,20:26.13575%,13:18.22238%,6:17.55378%,17:0.00174%,10:0.00087%,14:0.00035%,21:0.00017%,16:0.00017%,5:0.00017%,2:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.13505%,-0.32151:20.80769%,-1.27613:18.22185%,-0.23351:17.55343%,-0.33484:17.27657%,-71.33197:0.00174%,-10.51843:0.0007%,-0.08551:0.00035%,-1.27347:0.00035%,5.71692:0.00035%,1.47576:0.00035%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-71.14931:0.00017%,-64.19493:0.00017%,1.45709:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.1347%,1:20.80752%,5:18.22185%,4:17.55325%,2:17.2764%,0:0.00628%]
[INFO] ** service:[0.0048200000000000005:99.99704%,-211.73542999999998:0.00174%,-211.07873999999998:0.00035%,-186.43601999999998:0.00035%,-211.08346:0.00017%,-186.44547:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.08426%,9:26.13575%,7:18.22238%,1:17.55378%,14:0.00174%,11:0.00087%,2:0.00035%,17:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%]
[INFO] ** type:[0:99.99861%,1:0.00122%,2:0.00017%]
[INFO] ** unixtime:1567 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0374 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0320 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0293 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0254 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4067 - tp: 70464.0000 - fp: 9536.0000 - tn: 310464.0000 - fn: 9536.0000 - accuracy: 0.9523 - precision: 0.8808 - recall: 0.8808 - auc: 0.9757 - val_loss: 1.0535 - val_tp: 12813.0000 - val_fp: 7187.0000 - val_tn: 72813.0000 - val_fn: 7187.0000 - val_accuracy: 0.8563 - val_precision: 0.6406 - val_recall: 0.6406 - val_auc: 0.9289
[INFO] saving weights to checkpoints/lstm-epoch-4-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4827 - tp: 66165.0000 - fp: 13835.0000 - tn: 306165.0000 - fn: 13835.0000 - accuracy: 0.9308 - precision: 0.8271 - recall: 0.8271 - auc: 0.9653 - val_loss: 0.1293 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0755 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0572 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 11-11/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99895%,31:0.00035%,30:0.00035%,26:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.39314%,10:20.87411%,8:18.19344%,9:17.53704%,22:0.00122%,18:0.00035%,15:0.00035%,25:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99965%,0:0.00035%]
[INFO] ** i/f_name:[2:99.99965%,3:0.00035%]
[INFO] ** modbus_function_code:[0.02961:99.99895%,-33.760870000000004:0.00105%]
[INFO] ** modbus_function_description:[7:50.00052%,11:49.99843%,0:0.00105%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99895%,2:0.0007%,1:0.00035%]
[INFO] ** proxy_src_ip:[18:38.15069%,20:26.11692%,13:18.19344%,6:17.53739%,16:0.00052%,17:0.00035%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.1164%,-0.32151:20.87411%,-1.27613:18.19326%,-0.23351:17.53686%,-0.33484:17.27657%,-0.24151:0.00052%,-1.02014:0.00052%,-0.08551:0.00035%,-71.33197:0.00035%,-71.14798:0.00017%,1.45709:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:26.11605%,1:20.87394%,5:18.19309%,4:17.53652%,2:17.2764%,0:0.00401%]
[INFO] ** service:[0.0048200000000000005:99.99895%,-211.73542999999998:0.00035%,-186.43601999999998:0.00035%,-211.08346:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.15069%,9:26.11692%,7:18.19344%,1:17.53739%,15:0.00052%,14:0.00035%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1568 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0495 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0410 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0320 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0021 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0040 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.7361e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0024 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2670e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0019 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2653e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 12-12/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99791%,30:0.00192%,9:0.00017%]
[INFO] ** classification:[normal:93.6904%,Single Stage Single Point:6.3096%]
[INFO] ** dst:[21:43.40657%,10:20.8851%,8:18.17635%,9:17.52902%,15:0.00192%,22:0.00052%,24:0.00035%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99843%,0:0.00157%]
[INFO] ** i/f_name:[2:99.99808%,3:0.00192%]
[INFO] ** modbus_function_code:[0.02961:99.99791%,-33.760870000000004:0.00209%]
[INFO] ** modbus_function_description:[7:49.99965%,11:49.99826%,0:0.00209%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99843%,2:0.00157%]
[INFO] ** proto:[0:99.99808%,1:0.00192%]
[INFO] ** proxy_src_ip:[18:38.15871%,20:26.13331%,13:18.17652%,6:17.52919%,17:0.00192%,16:0.00017%,1:0.00017%]
[INFO] ** s_port:[1.45442:26.13279%,-0.32151:20.8851%,-1.27613:18.176%,-0.23351:17.52884%,-0.33484:17.27361%,-71.33197:0.00192%,-1.27347:0.00035%,1.45709:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:26.13244%,1:20.8851%,5:18.176%,4:17.5285%,2:17.27361%,0:0.00436%]
[INFO] ** service:[0.0048200000000000005:99.99791%,-211.73542999999998:0.00192%,-183.8612:0.00017%]
[INFO] ** src:[22:38.15871%,9:26.13331%,7:18.17652%,1:17.52919%,21:0.00157%,14:0.00035%,15:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1568 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0016 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5482e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0014 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3237e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3171 - tp: 74395.0000 - fp: 5605.0000 - tn: 314395.0000 - fn: 5605.0000 - accuracy: 0.9720 - precision: 0.9299 - recall: 0.9299 - auc: 0.9806 - val_loss: 1.0863 - val_tp: 12841.0000 - val_fp: 7159.0000 - val_tn: 72841.0000 - val_fn: 7159.0000 - val_accuracy: 0.8568 - val_precision: 0.6421 - val_recall: 0.6421 - val_auc: 0.9144
[INFO] saving weights to checkpoints/lstm-epoch-4-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6447 - tp: 59338.0000 - fp: 20662.0000 - tn: 299338.0000 - fn: 20662.0000 - accuracy: 0.8967 - precision: 0.7417 - recall: 0.7417 - auc: 0.9471 - val_loss: 0.2444 - val_tp: 18113.0000 - val_fp: 1887.0000 - val_tn: 78113.0000 - val_fn: 1887.0000 - val_accuracy: 0.9623 - val_precision: 0.9057 - val_recall: 0.9057 - val_auc: 0.9876
[INFO] saving weights to checkpoints/lstm-epoch-4-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0225 - tp: 79525.0000 - fp: 475.0000 - tn: 319525.0000 - fn: 475.0000 - accuracy: 0.9976 - precision: 0.9941 - recall: 0.9941 - auc: 1.0000 - val_loss: 2.4455e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 13-13/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99651%,31:0.0007%,30:0.00052%,26:0.00052%,0:0.00052%,22:0.00035%,27:0.00017%,24:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:86.66059%,Single Stage Single Point:13.33941%]
[INFO] ** dst:[21:43.35653%,10:20.80368%,8:18.27695%,9:17.55883%,22:0.00105%,6:0.00087%,18:0.0007%,25:0.00052%,15:0.00052%,24:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.99965%,0:0.00035%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.99651%,-33.760870000000004:0.00331%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99878%,11:49.99773%,0:0.00331%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99721%,2:0.00227%,1:0.00052%]
[INFO] ** proxy_src_ip:[18:38.05027%,20:26.1103%,13:18.27712%,6:17.55831%,10:0.00105%,11:0.00087%,17:0.00052%,16:0.00052%,7:0.00035%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.10977%,-0.32151:20.80368%,-1.27613:18.27677%,-0.23351:17.55796%,-0.33484:17.24659%,-9.78512:0.0007%,-64.19493:0.00052%,-1.02014:0.00052%,-71.14798:0.00052%,-71.33197:0.00052%,-0.24151:0.00035%,-71.14931:0.00035%,-0.08551:0.00035%,1.47576:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-1.2708:0.00017%,-68.79874000000001:0.00017%,6.1115699999999995:0.00017%,14.540560000000001:0.00017%,1.45709:0.00017%]
[INFO] ** scada_tag:[3:26.10942%,1:20.80351%,5:18.27677%,4:17.55796%,2:17.24641%,0:0.00593%]
[INFO] ** service:[0.0048200000000000005:99.99721%,-186.43601999999998:0.0007%,-211.08346:0.00052%,-186.44547:0.00052%,-211.73542999999998:0.00052%,-211.08818:0.00035%,-202.75898:0.00017%]
[INFO] ** src:[22:38.05027%,9:26.1103%,7:18.27712%,1:17.55831%,11:0.00105%,10:0.00087%,15:0.00052%,14:0.00052%,21:0.00035%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99965%,2:0.00017%,1:0.00017%]
[INFO] ** unixtime:1567 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0054 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6216e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0047 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6301e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0042 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2826e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2792 - tp: 72770.0000 - fp: 7230.0000 - tn: 312770.0000 - fn: 7230.0000 - accuracy: 0.9639 - precision: 0.9096 - recall: 0.9096 - auc: 0.9883 - val_loss: 0.5857 - val_tp: 12841.0000 - val_fp: 7159.0000 - val_tn: 72841.0000 - val_fn: 7159.0000 - val_accuracy: 0.8568 - val_precision: 0.6421 - val_recall: 0.6421 - val_auc: 0.9680
[INFO] saving weights to checkpoints/lstm-epoch-4-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2895 - tp: 64725.0000 - fp: 15275.0000 - tn: 304725.0000 - fn: 15275.0000 - accuracy: 0.9236 - precision: 0.8091 - recall: 0.8091 - auc: 0.9894 - val_loss: 0.0255 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 14-14/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99895%,31:0.00035%,30:0.00035%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:92.37272%,Single Stage Single Point:7.62728%]
[INFO] ** dst:[21:43.35392%,10:20.80856%,8:18.26474%,9:17.57069%,22:0.0007%,24:0.00035%,18:0.00035%,15:0.00035%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.99965%,3:0.00035%]
[INFO] ** modbus_function_code:[0.02961:99.99895%,-33.760870000000004:0.00105%]
[INFO] ** modbus_function_description:[7:50.00035%,11:49.99861%,0:0.00105%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99913%,2:0.00052%,1:0.00035%]
[INFO] ** proxy_src_ip:[18:38.05253%,20:26.11047%,13:18.26492%,6:17.57086%,17:0.00035%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.10977%,-0.32151:20.80856%,-1.27613:18.26439%,-0.23351:17.57051%,-0.33484:17.24397%,-1.27347:0.00035%,-0.08551:0.00035%,-71.33197:0.00035%,1.45709:0.00035%,1.47576:0.00017%,1.46509:0.00017%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,-0.24950999999999998:0.00017%,14.4699:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.10942%,1:20.80856%,5:18.26422%,4:17.57016%,2:17.2438%,0:0.00384%]
[INFO] ** service:[0.0048200000000000005:99.99895%,-211.73542999999998:0.00035%,-186.43601999999998:0.00035%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.05253%,9:26.11047%,7:18.26492%,1:17.57086%,14:0.00035%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1567 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1814 - tp: 65609.0000 - fp: 14391.0000 - tn: 305609.0000 - fn: 14391.0000 - accuracy: 0.9280 - precision: 0.8201 - recall: 0.8201 - auc: 0.9910 - val_loss: 0.0121 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2913 - tp: 70444.0000 - fp: 9556.0000 - tn: 310444.0000 - fn: 9556.0000 - accuracy: 0.9522 - precision: 0.8806 - recall: 0.8806 - auc: 0.9858 - val_loss: 0.1654 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0885 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0133 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0221 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0096 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0172 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0063 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 15-15/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99634%,30:0.00296%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:90.3711%,Single Stage Multi Point:9.6282%,Single Stage Single Point:0.0007%]
[INFO] ** dst:[21:43.30528%,10:20.77666%,8:18.31112%,9:17.60172%,15:0.00296%,22:0.00157%,25:0.00017%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99721%,0:0.00279%]
[INFO] ** i/f_name:[2:99.99704%,3:0.00296%]
[INFO] ** modbus_function_code:[0.02961:99.99634%,-33.760870000000004:0.00366%]
[INFO] ** modbus_function_description:[7:49.99913%,11:49.99721%,0:0.00366%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99738%,2:0.00262%]
[INFO] ** proto:[0:99.99669%,1:0.00296%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.00999%,20:26.07264%,13:18.31077%,6:17.60224%,17:0.00296%,16:0.0007%,7:0.00035%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.07177%,-0.32151:20.77648%,-1.27613:18.31059%,-0.23351:17.60155%,-0.33484:17.23351%,-71.33197:0.00296%,-1.02014:0.0007%,-0.24151:0.00052%,1.46509:0.00035%,1.45709:0.00035%,1.47576:0.00017%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,-61.95768:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.07142%,1:20.77631%,5:18.31059%,4:17.6012%,2:17.23316%,0:0.00732%]
[INFO] ** service:[0.0048200000000000005:99.99651%,-211.73542999999998:0.00296%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.00999%,9:26.07264%,7:18.31077%,1:17.60224%,21:0.00296%,15:0.0007%,14:0.00035%,16:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1576 (0.27476%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0094 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0012 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0085 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1481e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0077 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5311e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0067 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2474e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.3067 - tp: 68578.0000 - fp: 11422.0000 - tn: 308578.0000 - fn: 11422.0000 - accuracy: 0.9429 - precision: 0.8572 - recall: 0.8572 - auc: 0.9102 - val_loss: 7.5376 - val_tp: 10647.0000 - val_fp: 9353.0000 - val_tn: 70647.0000 - val_fn: 9353.0000 - val_accuracy: 0.8129 - val_precision: 0.5324 - val_recall: 0.5324 - val_auc: 0.7077
[INFO] saving weights to checkpoints/lstm-epoch-4-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 16-16/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513276, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513276, 17)

[INFO] analyzing data
[INFO] 513276 rows
[INFO] ** appi_name:[21:99.99805%,30:0.00175%,33:0.00019%]
[INFO] ** classification:[normal:79.94062%,Single Stage Multi Point:20.05938%]
[INFO] ** dst:[21:43.34276%,10:20.79486%,8:18.26152%,9:17.59774%,15:0.00175%,22:0.00117%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99825%,0:0.00175%]
[INFO] ** i/f_name:[2:99.99825%,3:0.00175%]
[INFO] ** modbus_function_code:[0.02961:99.99805%,-33.760870000000004:0.00195%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99805%,0:0.00195%]
[INFO] ** modbus_transaction_id:65536 (12.76818%)
[INFO] ** orig:[0:99.99825%,2:0.00175%]
[INFO] ** proto:[0:99.99825%,1:0.00175%]
[INFO] ** proxy_src_ip:[18:38.04035%,20:26.09746%,13:18.26191%,6:17.59794%,17:0.00175%,16:0.00039%,21:0.00019%]
[INFO] ** s_port:[1.45442:26.09688%,-0.32151:20.79466%,-1.27613:18.26152%,-0.23351:17.59755%,-0.33484:17.24569%,-71.33197:0.00175%,1.45709:0.00039%,-0.24151:0.00039%,-1.02014:0.00039%,-1.27347:0.00019%,1.47576:0.00019%,-49.275529999999996:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.09649%,1:20.79447%,5:18.26133%,4:17.59716%,2:17.2455%,0:0.00507%]
[INFO] ** service:[0.0048200000000000005:99.99825%,-211.73542999999998:0.00175%]
[INFO] ** src:[22:38.04035%,9:26.09746%,7:18.26191%,1:17.59794%,21:0.00175%,15:0.00039%,4:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1406 (0.27393%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5533 - tp: 42526.0000 - fp: 37474.0000 - tn: 282526.0000 - fn: 37474.0000 - accuracy: 0.8126 - precision: 0.5316 - recall: 0.5316 - auc: 0.7053 - val_loss: 7.5811 - val_tp: 10593.0000 - val_fp: 9407.0000 - val_tn: 70593.0000 - val_fn: 9407.0000 - val_accuracy: 0.8119 - val_precision: 0.5296 - val_recall: 0.5296 - val_auc: 0.7060
[INFO] saving weights to checkpoints/lstm-epoch-4-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5490 - tp: 42546.0000 - fp: 37454.0000 - tn: 282546.0000 - fn: 37454.0000 - accuracy: 0.8127 - precision: 0.5318 - recall: 0.5318 - auc: 0.7056 - val_loss: 7.5465 - val_tp: 10636.0000 - val_fp: 9364.0000 - val_tn: 70636.0000 - val_fn: 9364.0000 - val_accuracy: 0.8127 - val_precision: 0.5318 - val_recall: 0.5318 - val_auc: 0.7074
[INFO] saving weights to checkpoints/lstm-epoch-4-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.8707 - tp: 70739.0000 - fp: 9261.0000 - tn: 310739.0000 - fn: 9261.0000 - accuracy: 0.9537 - precision: 0.8842 - recall: 0.8842 - auc: 0.9271 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0049 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0046 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-15-16-batch-400000-500000
[INFO] processing batch 500000-600000/513276
[33m[INFO] loading file 17-17/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513276, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513276, 17)

[INFO] analyzing data
[INFO] 513276 rows
[INFO] ** appi_name:[21:99.99708%,7:0.00058%,26:0.00039%,0:0.00039%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:93.98959%,Multi Stage Multi Point:6.01041%]
[INFO] ** dst:[21:43.34802%,10:20.85038%,8:18.2019%,9:17.59658%,22:0.00078%,6:0.00058%,25:0.00039%,16:0.00039%,2:0.00039%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99708%,-33.760870000000004:0.00273%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99961%,11:49.99747%,0:0.00273%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.76818%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99864%,2:0.00136%]
[INFO] ** proxy_src_ip:[18:38.08633%,20:26.11285%,13:18.20132%,6:17.59638%,10:0.00117%,11:0.00097%,1:0.00039%,16:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.11188%,-0.32151:20.85038%,-1.27613:18.20093%,-0.23351:17.59619%,-0.33484:17.23595%,6.0369:0.00078%,-64.19493:0.00039%,1.47576:0.00039%,-71.14798:0.00039%,1.45709:0.00039%,-3.3787199999999995:0.00019%,-68.79874000000001:0.00019%,-1.27347:0.00019%,1.46509:0.00019%,8.55414:0.00019%,6.06224:0.00019%,-4.3880099999999995:0.00019%,-0.24151:0.00019%,-71.14931:0.00019%,-1.02014:0.00019%,6.15557:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.11168%,1:20.85019%,5:18.20073%,4:17.5958%,2:17.23595%,0:0.00565%]
[INFO] ** service:[0.0048200000000000005:99.99786%,-211.09762999999998:0.00058%,-186.44547:0.00039%,-211.08346:0.00039%,-186.43601999999998:0.00019%,-211.35747999999998:0.00019%,-211.08818:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.08633%,9:26.11285%,7:18.20132%,1:17.59638%,11:0.00117%,10:0.00097%,3:0.00039%,21:0.00019%,15:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1403 (0.27334%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0041 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0036 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0033 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2975 - val_tp: 18390.0000 - val_fp: 1610.0000 - val_tn: 78390.0000 - val_fn: 1610.0000 - val_accuracy: 0.9678 - val_precision: 0.9195 - val_recall: 0.9195 - val_auc: 0.9497
[INFO] saving weights to checkpoints/lstm-epoch-4-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9392 - tp: 65424.0000 - fp: 14576.0000 - tn: 305424.0000 - fn: 14576.0000 - accuracy: 0.9271 - precision: 0.8178 - recall: 0.8178 - auc: 0.8854 - val_loss: 2.8996 - val_tp: 16402.0000 - val_fp: 3598.0000 - val_tn: 76402.0000 - val_fn: 3598.0000 - val_accuracy: 0.9280 - val_precision: 0.8201 - val_recall: 0.8201 - val_auc: 0.8876
[INFO] saving weights to checkpoints/lstm-epoch-4-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.2319 - tp: 68934.0000 - fp: 11066.0000 - tn: 308934.0000 - fn: 11066.0000 - accuracy: 0.9447 - precision: 0.8617 - recall: 0.8617 - auc: 0.9130 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/513276
[33m[INFO] loading file 18-18/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513276, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513276, 17)

[INFO] analyzing data
[INFO] 513276 rows
[INFO] ** appi_name:[21:99.99805%,30:0.00058%,7:0.00058%,31:0.00019%,27:0.00019%,22:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:81.10218%,Multi Stage Multi Point:18.89782%]
[INFO] ** dst:[21:43.34413%,10:20.82661%,8:18.26678%,9:17.55936%,22:0.00078%,15:0.00058%,24:0.00039%,16:0.00039%,2:0.00039%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99942%,0:0.00058%]
[INFO] ** i/f_name:[2:99.99942%,3:0.00058%]
[INFO] ** modbus_function_code:[0.02961:99.99805%,-33.760870000000004:0.00195%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99786%,0:0.00195%]
[INFO] ** modbus_transaction_id:65536 (12.76818%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,2:0.00058%,1:0.00058%]
[INFO] ** proxy_src_ip:[18:38.0686%,20:26.10272%,13:18.26717%,6:17.55956%,17:0.00058%,11:0.00058%,1:0.00039%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.10194%,-0.32151:20.82661%,-1.27613:18.26659%,-0.23351:17.55917%,-0.33484:17.24199%,-71.33197:0.00058%,1.45709:0.00039%,-0.24151:0.00039%,-1.27347:0.00039%,-1.2708:0.00019%,-71.14931:0.00019%,6.45955:0.00019%,-2.48275:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-3.3787199999999995:0.00019%,3.6236699999999997:0.00019%,6.06224:0.00019%,8.10082:0.00019%]
[INFO] ** scada_tag:[3:26.10155%,1:20.82642%,5:18.26639%,4:17.55897%,2:17.2418%,0:0.00487%]
[INFO] ** service:[0.0048200000000000005:99.99805%,-211.09762999999998:0.00058%,-211.73542999999998:0.00058%,-186.43601999999998:0.00019%,-211.35747999999998:0.00019%,-211.08818:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.0686%,9:26.10272%,7:18.26717%,1:17.55956%,14:0.00058%,10:0.00058%,3:0.00039%,21:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1403 (0.27334%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.6164 - tp: 62060.0000 - fp: 17940.0000 - tn: 302060.0000 - fn: 17940.0000 - accuracy: 0.9103 - precision: 0.7757 - recall: 0.7757 - auc: 0.8590 - val_loss: 6.1023 - val_tp: 12428.0000 - val_fp: 7572.0000 - val_tn: 72428.0000 - val_fn: 7572.0000 - val_accuracy: 0.8486 - val_precision: 0.6214 - val_recall: 0.6214 - val_auc: 0.7634
[INFO] saving weights to checkpoints/lstm-epoch-4-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1249 - tp: 49607.0000 - fp: 30393.0000 - tn: 289607.0000 - fn: 30393.0000 - accuracy: 0.8480 - precision: 0.6201 - recall: 0.6201 - auc: 0.7611 - val_loss: 6.1587 - val_tp: 12358.0000 - val_fp: 7642.0000 - val_tn: 72358.0000 - val_fn: 7642.0000 - val_accuracy: 0.8472 - val_precision: 0.6179 - val_recall: 0.6179 - val_auc: 0.7612
[INFO] saving weights to checkpoints/lstm-epoch-4-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1275 - tp: 49594.0000 - fp: 30406.0000 - tn: 289594.0000 - fn: 30406.0000 - accuracy: 0.8480 - precision: 0.6199 - recall: 0.6199 - auc: 0.7609 - val_loss: 2.4540 - val_tp: 16955.0000 - val_fp: 3045.0000 - val_tn: 76955.0000 - val_fn: 3045.0000 - val_accuracy: 0.9391 - val_precision: 0.8478 - val_recall: 0.8478 - val_auc: 0.9048
[INFO] saving weights to checkpoints/lstm-epoch-4-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0020 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0017 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/513276
[33m[INFO] loading file 19-19/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513276, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513276, 17)

[INFO] analyzing data
[INFO] 513276 rows
[INFO] ** appi_name:[21:99.99786%,26:0.00039%,0:0.00039%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:86.05818%,Single Stage Multi Point:13.94182%]
[INFO] ** dst:[21:43.38075%,10:20.82895%,8:18.21437%,9:17.573%,22:0.00136%,6:0.00058%,25:0.00039%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99786%,-33.760870000000004:0.00195%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99786%,0:0.00195%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.76818%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99864%,2:0.00136%]
[INFO] ** proxy_src_ip:[18:38.11828%,20:26.09142%,13:18.21457%,6:17.573%,10:0.00117%,11:0.00097%,16:0.00058%]
[INFO] ** s_port:[1.45442:26.09045%,-0.32151:20.82895%,-1.27613:18.21418%,-0.23351:17.57281%,-0.33484:17.28933%,-5.20264:0.00078%,1.45709:0.00058%,-1.02014:0.00058%,-64.19493:0.00039%,-71.14798:0.00039%,-1.27347:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-71.14931:0.00019%,1.46509:0.00019%,-68.79874000000001:0.00019%,-1.2708:0.00019%,0.75578:0.00019%]
[INFO] ** scada_tag:[3:26.09006%,1:20.82875%,5:18.21398%,4:17.57261%,2:17.28933%,0:0.00526%]
[INFO] ** service:[0.0048200000000000005:99.99864%,-186.44547:0.00039%,-211.08346:0.00039%,-186.43601999999998:0.00019%,-211.08818:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.11828%,9:26.09142%,7:18.21457%,1:17.573%,11:0.00117%,10:0.00097%,15:0.00058%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1404 (0.27354%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0015 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0013 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0012 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.3831 - tp: 53285.0000 - fp: 26715.0000 - tn: 293285.0000 - fn: 26715.0000 - accuracy: 0.8664 - precision: 0.6661 - recall: 0.6661 - auc: 0.7900 - val_loss: 9.8530 - val_tp: 7774.0000 - val_fp: 12226.0000 - val_tn: 67774.0000 - val_fn: 12226.0000 - val_accuracy: 0.7555 - val_precision: 0.3887 - val_recall: 0.3887 - val_auc: 0.6179
[INFO] saving weights to checkpoints/lstm-epoch-4-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.5725 - tp: 47381.0000 - fp: 32619.0000 - tn: 287381.0000 - fn: 32619.0000 - accuracy: 0.8369 - precision: 0.5923 - recall: 0.5923 - auc: 0.7436 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/513276
[33m[INFO] loading file 20-20/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513276, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513276, 17)

[INFO] analyzing data
[INFO] 513276 rows
[INFO] ** appi_name:[21:99.9963%,30:0.00312%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:92.01619%,Single Stage Multi Point:7.98381%]
[INFO] ** dst:[21:43.42245%,10:20.8385%,8:18.16528%,9:17.56852%,15:0.00312%,22:0.00117%,24:0.00039%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99727%,0:0.00273%]
[INFO] ** i/f_name:[2:99.99688%,3:0.00312%]
[INFO] ** modbus_function_code:[0.02961:99.9963%,-33.760870000000004:0.0037%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99649%,0:0.0037%]
[INFO] ** modbus_transaction_id:65536 (12.76818%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9963%,1:0.00312%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.1175%,20:26.14402%,13:18.16547%,6:17.56911%,17:0.00312%,14:0.00058%,16:0.00019%]
[INFO] ** s_port:[1.45442:26.14324%,-0.32151:20.8385%,-1.27613:18.16489%,-0.23351:17.56833%,-0.33484:17.27901%,-71.33197:0.00312%,-0.24151:0.00058%,1.45709:0.00039%,-1.27347:0.00039%,-1.2708:0.00019%,-1.02014:0.00019%,13.431270000000001:0.00019%,-71.14798:0.00019%,1.47576:0.00019%,-0.24950999999999998:0.00019%,11.862:0.00019%,1.46509:0.00019%]
[INFO] ** scada_tag:[3:26.14285%,1:20.8383%,5:18.16489%,4:17.56794%,2:17.27881%,0:0.00721%]
[INFO] ** service:[0.0048200000000000005:99.9963%,-211.73542999999998:0.00312%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.1175%,9:26.14402%,7:18.16547%,1:17.56911%,14:0.00312%,2:0.00058%,15:0.00019%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1403 (0.27334%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3363 - tp: 78335.0000 - fp: 1665.0000 - tn: 318335.0000 - fn: 1665.0000 - accuracy: 0.9917 - precision: 0.9792 - recall: 0.9792 - auc: 0.9869 - val_loss: 2.9262 - val_tp: 16369.0000 - val_fp: 3631.0000 - val_tn: 76369.0000 - val_fn: 3631.0000 - val_accuracy: 0.9274 - val_precision: 0.8184 - val_recall: 0.8184 - val_auc: 0.8865
[INFO] saving weights to checkpoints/lstm-epoch-4-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9430 - tp: 65396.0000 - fp: 14604.0000 - tn: 305396.0000 - fn: 14604.0000 - accuracy: 0.9270 - precision: 0.8174 - recall: 0.8174 - auc: 0.8853 - val_loss: 2.9609 - val_tp: 16326.0000 - val_fp: 3674.0000 - val_tn: 76326.0000 - val_fn: 3674.0000 - val_accuracy: 0.9265 - val_precision: 0.8163 - val_recall: 0.8163 - val_auc: 0.8852
[INFO] saving weights to checkpoints/lstm-epoch-4-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9429 - tp: 65396.0000 - fp: 14604.0000 - tn: 305396.0000 - fn: 14604.0000 - accuracy: 0.9270 - precision: 0.8174 - recall: 0.8174 - auc: 0.8852 - val_loss: 2.2573 - val_tp: 17199.0000 - val_fp: 2801.0000 - val_tn: 77199.0000 - val_fn: 2801.0000 - val_accuracy: 0.9440 - val_precision: 0.8600 - val_recall: 0.8600 - val_auc: 0.9125
[INFO] saving weights to checkpoints/lstm-epoch-4-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1059e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.3242e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/513276
[33m[INFO] loading file 21-21/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513274, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513274, 17)

[INFO] analyzing data
[INFO] 513274 rows
[INFO] ** appi_name:[21:99.9961%,30:0.00078%,7:0.00058%,26:0.00039%,22:0.00039%,0:0.00039%,31:0.00019%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:98.81097%,Multi Stage Single Point:1.18903%]
[INFO] ** dst:[21:43.30767%,10:20.99892%,8:18.16301%,9:17.52592%,22:0.00097%,15:0.00078%,6:0.00078%,25:0.00039%,24:0.00039%,16:0.00039%,2:0.00039%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name:[2:99.99922%,3:0.00078%]
[INFO] ** modbus_function_code:[0.02961:99.9961%,-33.760870000000004:0.0037%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99883%,11:49.99727%,0:0.0037%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.76823%)
[INFO] ** orig:[0:99.99922%,2:0.00078%]
[INFO] ** proto:[0:99.99766%,2:0.00156%,1:0.00078%]
[INFO] ** proxy_src_ip:[18:38.33352%,20:25.97287%,13:18.1632%,6:17.52592%,10:0.00117%,11:0.00097%,17:0.00078%,16:0.00058%,1:0.00039%,21:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.97229%,-0.32151:20.99814%,-1.27613:18.16281%,-0.23351:17.52573%,-0.33484:17.33538%,-6.64392:0.00078%,-71.33197:0.00078%,-1.02014:0.00058%,-1.27347:0.00039%,-71.14931:0.00039%,-71.14798:0.00039%,-64.19493:0.00039%,1.45709:0.00019%,-2.2440900000000004:0.00019%,-3.3787199999999995:0.00019%,-68.79874000000001:0.00019%,10.15141:0.00019%,1.46509:0.00019%,1.47576:0.00019%,7.060860000000001:0.00019%,-0.24151:0.00019%,6.62488:0.00019%]
[INFO] ** scada_tag:[3:25.9719%,1:20.99795%,5:18.16262%,4:17.52553%,2:17.33538%,0:0.00662%]
[INFO] ** service:[0.0048200000000000005:99.99688%,-211.73542999999998:0.00078%,-211.09762999999998:0.00058%,-186.44547:0.00039%,-211.08346:0.00039%,-211.08818:0.00039%,-186.43601999999998:0.00019%,-211.35747999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.33352%,9:25.97287%,7:18.1632%,1:17.52592%,11:0.00117%,21:0.00097%,10:0.00097%,15:0.00058%,3:0.00039%,4:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1398 (0.27237%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513274
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.7447e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/513274
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.1021e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/513274
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.5301e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/513274
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.1350e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/513274
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.7913e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1922e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/513274
[33m[INFO] loading file 22-22/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (282315, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (282315, 17)

[INFO] analyzing data
[INFO] 282315 rows
[INFO] ** appi_name:[21:99.99221%,30:0.00673%,23:0.00035%,22:0.00035%,18:0.00035%]
[INFO] ** classification:[normal:53.04819%,Multi Stage Single Point:46.95181%]
[INFO] ** dst:[21:43.30907%,10:21.00703%,8:18.10177%,9:17.57292%,15:0.00673%,22:0.00142%,19:0.00071%,26:0.00035%]
[INFO] ** i/f_dir:[1:99.99362%,0:0.00638%]
[INFO] ** i/f_name:[2:99.99327%,3:0.00638%,0:0.00035%]
[INFO] ** modbus_function_code:[0.02961:99.99221%,-33.760870000000004:0.00779%]
[INFO] ** modbus_function_description:[7:49.99699%,11:49.99522%,0:0.00779%]
[INFO] ** modbus_transaction_id:65534 (23.21308%)
[INFO] ** orig:[0:99.99504%,2:0.00425%,1:0.00071%]
[INFO] ** proto:[0:99.99292%,1:0.00673%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.33023%,20:25.98693%,13:18.10106%,6:17.57399%,17:0.00673%,14:0.00071%,10:0.00035%]
[INFO] ** s_port:[1.45442:25.98587%,-0.32151:21.00703%,-1.27613:18.10106%,-0.23351:17.57292%,-0.33484:17.3232%,-71.33197:0.00673%,1.45709:0.00071%,-0.24151:0.00071%,7.228860000000001:0.00071%,-0.24950999999999998:0.00035%,1.46509:0.00035%,-71.14931:0.00035%]
[INFO] ** scada_tag:[3:25.98551%,1:21.00703%,5:18.10106%,4:17.57257%,2:17.3232%,0:0.01063%]
[INFO] ** service:[0.0048200000000000005:99.99221%,-211.73542999999998:0.00673%,-211.07873999999998:0.00071%,-211.08818:0.00035%]
[INFO] ** src:[22:38.33023%,9:25.98693%,7:18.10106%,1:17.57399%,21:0.00425%,14:0.00248%,2:0.00071%,11:0.00035%]
[INFO] ** type:[0:99.99787%,1:0.00213%]
[INFO] ** unixtime:779 (0.27593%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/282315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5355 - tp: 42599.0000 - fp: 37401.0000 - tn: 282599.0000 - fn: 37401.0000 - accuracy: 0.8130 - precision: 0.5325 - recall: 0.5325 - auc: 0.7061 - val_loss: 7.5763 - val_tp: 10599.0000 - val_fp: 9401.0000 - val_tn: 70599.0000 - val_fn: 9401.0000 - val_accuracy: 0.8120 - val_precision: 0.5300 - val_recall: 0.5300 - val_auc: 0.7062
[INFO] saving weights to checkpoints/lstm-epoch-4-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/282315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5911 - tp: 42323.0000 - fp: 37677.0000 - tn: 282323.0000 - fn: 37677.0000 - accuracy: 0.8116 - precision: 0.5290 - recall: 0.5290 - auc: 0.7038 - val_loss: 7.5997 - val_tp: 10570.0000 - val_fp: 9430.0000 - val_tn: 70570.0000 - val_fn: 9430.0000 - val_accuracy: 0.8114 - val_precision: 0.5285 - val_recall: 0.5285 - val_auc: 0.7053
[INFO] saving weights to checkpoints/lstm-epoch-4-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/282315
[33m[INFO] loading file 23-23/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582315, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582315, 17)

[INFO] analyzing data
[INFO] 582315 rows
[INFO] ** appi_name:[21:99.99828%,30:0.00103%,31:0.00034%,33:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:91.81234%,Multi Stage Single Point:8.18766%]
[INFO] ** dst:[21:43.32397%,10:20.99809%,8:18.14053%,9:17.5345%,22:0.00103%,15:0.00103%,24:0.00034%,18:0.00034%,25:0.00017%]
[INFO] ** i/f_dir:[1:99.99897%,0:0.00103%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99828%,-33.760870000000004:0.00172%]
[INFO] ** modbus_function_description:[7:50.00009%,11:49.9982%,0:0.00172%]
[INFO] ** modbus_transaction_id:65536 (11.25439%)
[INFO] ** orig:[0:99.99948%,2:0.00052%]
[INFO] ** proto:[0:99.99845%,1:0.00103%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.33561%,20:25.98697%,13:18.14053%,6:17.53467%,17:0.00103%,16:0.00052%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.98611%,-0.32151:20.99791%,-1.27613:18.14001%,-0.23351:17.53432%,-0.33484:17.3377%,-71.33197:0.00103%,-1.02014:0.00052%,-0.08551:0.00034%,-1.27347:0.00034%,1.45709:0.00034%,1.46509:0.00034%,-0.24151:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.98576%,1:20.99791%,5:18.13984%,4:17.53415%,2:17.33752%,0:0.00481%]
[INFO] ** service:[0.0048200000000000005:99.99845%,-211.73542999999998:0.00103%,-186.43601999999998:0.00034%,-186.44547:0.00017%]
[INFO] ** src:[22:38.33561%,9:25.98697%,7:18.14053%,1:17.53467%,21:0.00052%,15:0.00052%,14:0.00052%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1586 (0.27236%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5672 - tp: 42442.0000 - fp: 37558.0000 - tn: 282442.0000 - fn: 37558.0000 - accuracy: 0.8122 - precision: 0.5305 - recall: 0.5305 - auc: 0.7047 - val_loss: 7.5747 - val_tp: 10601.0000 - val_fp: 9399.0000 - val_tn: 70601.0000 - val_fn: 9399.0000 - val_accuracy: 0.8120 - val_precision: 0.5300 - val_recall: 0.5300 - val_auc: 0.7063
[INFO] saving weights to checkpoints/lstm-epoch-4-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1455 - tp: 79279.0000 - fp: 721.0000 - tn: 319279.0000 - fn: 721.0000 - accuracy: 0.9964 - precision: 0.9910 - recall: 0.9910 - auc: 0.9943 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.7460e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4904e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3332e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/582315
[33m[INFO] loading file 24-24/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582315, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582315, 17)

[INFO] analyzing data
[INFO] 582315 rows
[INFO] ** appi_name:[21:99.99365%,30:0.00309%,26:0.00052%,31:0.00034%,27:0.00034%,22:0.00034%,0:0.00034%,24:0.00017%,23:0.00017%,19:0.00017%,18:0.00017%,16:0.00017%,15:0.00017%,11:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:95.62436%,Multi Stage Single Point:4.37564%]
[INFO] ** dst:[21:43.36897%,10:21.0089%,8:18.1%,9:17.51526%,15:0.00309%,22:0.0012%,6:0.00069%,25:0.00034%,24:0.00034%,19:0.00034%,18:0.00034%,7:0.00034%,26:0.00017%]
[INFO] ** i/f_dir:[1:99.99708%,0:0.00292%]
[INFO] ** i/f_name:[2:99.99691%,3:0.00309%]
[INFO] ** modbus_function_code:[0.02961:99.99365%,-33.760870000000004:0.00584%,-0.415:0.00017%,0.9188299999999999:0.00017%,0.47422:0.00017%]
[INFO] ** modbus_function_description:[7:49.9982%,11:49.99545%,0:0.00584%,15:0.00017%,10:0.00017%,2:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.25439%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99502%,1:0.00309%,2:0.00189%]
[INFO] ** proxy_src_ip:[18:38.38575%,20:25.99315%,13:18.09983%,6:17.51458%,17:0.00309%,10:0.0012%,14:0.00086%,11:0.00086%,21:0.00034%,16:0.00034%]
[INFO] ** s_port:[1.45442:25.99212%,-0.32151:21.0089%,-1.27613:18.09948%,-0.23351:17.51389%,-0.33484:17.37685%,-71.33197:0.00309%,-9.58113:0.00069%,-71.14798:0.00052%,1.45709:0.00052%,-0.24950999999999998:0.00034%,-1.27347:0.00034%,-0.24151:0.00034%,-1.02014:0.00034%,-31.55091:0.00034%,7.6315100000000005:0.00034%,-71.14931:0.00034%,-64.19493:0.00034%,1.47576:0.00034%,-68.79874000000001:0.00017%,1.46509:0.00017%,7.4901800000000005:0.00017%,13.431270000000001:0.00017%,11.862:0.00017%]
[INFO] ** scada_tag:[3:25.99195%,1:21.0089%,5:18.09931%,4:17.51355%,2:17.37668%,0:0.00962%]
[INFO] ** service:[0.0048200000000000005:99.99468%,-211.73542999999998:0.00309%,-211.08346:0.00052%,-211.07873999999998:0.00034%,-202.75898:0.00034%,-186.44547:0.00034%,-186.43601999999998:0.00034%,-211.08818:0.00034%]
[INFO] ** src:[22:38.38575%,9:25.99315%,7:18.09983%,1:17.51458%,14:0.00309%,11:0.0012%,10:0.00086%,2:0.00086%,15:0.00034%,4:0.00034%]
[INFO] ** type:[0:99.9988%,1:0.00086%,2:0.00034%]
[INFO] ** unixtime:1582 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0977e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.7860e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.5478e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.7530e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.6858e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/582315
[33m[INFO] loading file 25-25/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582315, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582315, 17)

[INFO] analyzing data
[INFO] 582315 rows
[INFO] ** appi_name:[21:99.99657%,30:0.00103%,17:0.00069%,22:0.00052%,31:0.00034%,28:0.00017%,26:0.00017%,12:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** classification:[normal:65.00021%,Multi Stage Single Point:34.99979%]
[INFO] ** dst:[21:43.32535%,10:21.02968%,8:18.12696%,9:17.51389%,15:0.00103%,22:0.00086%,16:0.00069%,6:0.00069%,18:0.00034%,17:0.00034%,24:0.00017%]
[INFO] ** i/f_dir:[1:99.99897%,0:0.00103%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99657%,-33.760870000000004:0.00343%]
[INFO] ** modbus_function_description:[7:49.99906%,11:49.99751%,0:0.00343%]
[INFO] ** modbus_transaction_id:65536 (11.25439%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99794%,2:0.00103%,1:0.00103%]
[INFO] ** proxy_src_ip:[18:38.39674%,20:25.95829%,13:18.12696%,6:17.51423%,17:0.00103%,1:0.00086%,21:0.00069%,16:0.00034%,14:0.00034%,7:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95777%,-0.32151:21.02934%,-1.27613:18.12662%,-0.23351:17.51372%,-0.33484:17.3674%,-71.33197:0.00103%,-71.14931:0.00052%,-49.275529999999996:0.00034%,-0.24151:0.00034%,-1.02014:0.00034%,-58.032509999999995:0.00017%,-5.08665:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,2.52505:0.00017%,-71.14798:0.00017%,-58.035180000000004:0.00017%,-1.2708:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.95743%,1:21.02917%,5:18.12644%,4:17.51355%,2:17.36723%,0:0.00618%]
[INFO] ** service:[0.0048200000000000005:99.99691%,-211.73542999999998:0.00103%,-205.44247:0.00069%,-211.08818:0.00052%,-186.43601999999998:0.00034%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%]
[INFO] ** src:[22:38.39674%,9:25.95829%,7:18.12696%,1:17.51423%,14:0.00103%,3:0.00086%,4:0.00069%,21:0.00034%,15:0.00034%,2:0.00034%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1582 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.9697 - tp: 55334.0000 - fp: 24666.0000 - tn: 295334.0000 - fn: 24666.0000 - accuracy: 0.8767 - precision: 0.6917 - recall: 0.6917 - auc: 0.8073 - val_loss: 5.7582 - val_tp: 12855.0000 - val_fp: 7145.0000 - val_tn: 72855.0000 - val_fn: 7145.0000 - val_accuracy: 0.8571 - val_precision: 0.6428 - val_recall: 0.6428 - val_auc: 0.7767
[INFO] saving weights to checkpoints/lstm-epoch-4-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7524 - tp: 51449.0000 - fp: 28551.0000 - tn: 291449.0000 - fn: 28551.0000 - accuracy: 0.8572 - precision: 0.6431 - recall: 0.6431 - auc: 0.7769 - val_loss: 5.7445 - val_tp: 12872.0000 - val_fp: 7128.0000 - val_tn: 72872.0000 - val_fn: 7128.0000 - val_accuracy: 0.8574 - val_precision: 0.6436 - val_recall: 0.6436 - val_auc: 0.7772
[INFO] saving weights to checkpoints/lstm-epoch-4-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7492 - tp: 51465.0000 - fp: 28535.0000 - tn: 291465.0000 - fn: 28535.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.7771 - val_loss: 5.7453 - val_tp: 12871.0000 - val_fp: 7129.0000 - val_tn: 72871.0000 - val_fn: 7129.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.7772
[INFO] saving weights to checkpoints/lstm-epoch-4-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7463 - tp: 51479.0000 - fp: 28521.0000 - tn: 291479.0000 - fn: 28521.0000 - accuracy: 0.8574 - precision: 0.6435 - recall: 0.6435 - auc: 0.7772 - val_loss: 5.7276 - val_tp: 12893.0000 - val_fp: 7107.0000 - val_tn: 72893.0000 - val_fn: 7107.0000 - val_accuracy: 0.8579 - val_precision: 0.6446 - val_recall: 0.6446 - val_auc: 0.7779
[INFO] saving weights to checkpoints/lstm-epoch-4-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7570 - tp: 51426.0000 - fp: 28574.0000 - tn: 291426.0000 - fn: 28574.0000 - accuracy: 0.8571 - precision: 0.6428 - recall: 0.6428 - auc: 0.7768 - val_loss: 5.7630 - val_tp: 12849.0000 - val_fp: 7151.0000 - val_tn: 72849.0000 - val_fn: 7151.0000 - val_accuracy: 0.8570 - val_precision: 0.6424 - val_recall: 0.6424 - val_auc: 0.7765
[INFO] saving weights to checkpoints/lstm-epoch-4-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/582315
[33m[INFO] loading file 26-26/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582315, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582315, 17)

[INFO] analyzing data
[INFO] 582315 rows
[INFO] ** appi_name:[21:99.99828%,30:0.00052%,7:0.00052%,31:0.00017%,22:0.00017%,12:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:64.40191%,Single Stage Single Point:27.42708%,Multi Stage Single Point:8.17101%]
[INFO] ** dst:[21:43.30938%,10:21.09013%,8:18.11923%,9:17.47851%,22:0.00086%,15:0.00052%,24:0.00034%,16:0.00034%,2:0.00034%,18:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99948%,0:0.00052%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.99828%,-33.760870000000004:0.00172%]
[INFO] ** modbus_function_description:[7:49.99974%,11:49.99854%,0:0.00172%]
[INFO] ** modbus_transaction_id:65536 (11.25439%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99914%,1:0.00052%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.4699%,20:25.92978%,13:18.11957%,6:17.47868%,17:0.00052%,1:0.00052%,21:0.00034%,16:0.00034%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.92927%,-0.32151:21.08996%,-1.27613:18.11906%,-0.23351:17.47834%,-0.33484:17.37994%,-71.33197:0.00052%,-1.02014:0.00034%,-1.27347:0.00034%,-0.24151:0.00034%,-49.275529999999996:0.00017%,1.47576:0.00017%,1.45709:0.00017%,1.46509:0.00017%,-1.2708:0.00017%,14.191239999999999:0.00017%,2.52505:0.00017%,-3.3787199999999995:0.00017%,11.57001:0.00017%,-71.14931:0.00017%,7.66617:0.00017%]
[INFO] ** scada_tag:[3:25.92892%,1:21.08996%,5:18.11889%,4:17.47817%,2:17.37994%,0:0.00412%]
[INFO] ** service:[0.0048200000000000005:99.99845%,-211.09762999999998:0.00052%,-211.73542999999998:0.00052%,-211.35747999999998:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.4699%,9:25.92978%,7:18.11957%,1:17.47868%,14:0.00052%,3:0.00052%,15:0.00034%,4:0.00034%,21:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1581 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7379 - tp: 51521.0000 - fp: 28479.0000 - tn: 291521.0000 - fn: 28479.0000 - accuracy: 0.8576 - precision: 0.6440 - recall: 0.6440 - auc: 0.7775 - val_loss: 5.7356 - val_tp: 12883.0000 - val_fp: 7117.0000 - val_tn: 72883.0000 - val_fn: 7117.0000 - val_accuracy: 0.8577 - val_precision: 0.6442 - val_recall: 0.6442 - val_auc: 0.7776
[INFO] saving weights to checkpoints/lstm-epoch-4-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.7810 - tp: 51575.0000 - fp: 28425.0000 - tn: 291575.0000 - fn: 28425.0000 - accuracy: 0.8579 - precision: 0.6447 - recall: 0.6447 - auc: 0.8037 - val_loss: 1.7158 - val_tp: 12899.0000 - val_fp: 7101.0000 - val_tn: 72899.0000 - val_fn: 7101.0000 - val_accuracy: 0.8580 - val_precision: 0.6449 - val_recall: 0.6449 - val_auc: 0.9219
[INFO] saving weights to checkpoints/lstm-epoch-4-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4938 - tp: 51440.0000 - fp: 28560.0000 - tn: 291440.0000 - fn: 28560.0000 - accuracy: 0.8572 - precision: 0.6430 - recall: 0.6430 - auc: 0.9233 - val_loss: 1.2898 - val_tp: 12889.0000 - val_fp: 7111.0000 - val_tn: 72889.0000 - val_fn: 7111.0000 - val_accuracy: 0.8578 - val_precision: 0.6445 - val_recall: 0.6445 - val_auc: 0.9294
[INFO] saving weights to checkpoints/lstm-epoch-4-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8836 - tp: 52742.0000 - fp: 27258.0000 - tn: 292742.0000 - fn: 27258.0000 - accuracy: 0.8637 - precision: 0.6593 - recall: 0.6593 - auc: 0.9363 - val_loss: 0.4881 - val_tp: 13080.0000 - val_fp: 6920.0000 - val_tn: 73080.0000 - val_fn: 6920.0000 - val_accuracy: 0.8616 - val_precision: 0.6540 - val_recall: 0.6540 - val_auc: 0.9452
[INFO] saving weights to checkpoints/lstm-epoch-4-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3886 - tp: 66146.0000 - fp: 13854.0000 - tn: 306146.0000 - fn: 13854.0000 - accuracy: 0.9307 - precision: 0.8268 - recall: 0.8268 - auc: 0.9789 - val_loss: 0.0718 - val_tp: 19253.0000 - val_fp: 747.0000 - val_tn: 79253.0000 - val_fn: 747.0000 - val_accuracy: 0.9851 - val_precision: 0.9627 - val_recall: 0.9627 - val_auc: 0.9995
[INFO] saving weights to checkpoints/lstm-epoch-4-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/582315
[33m[INFO] loading file 27-27/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (522445, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (522445, 17)

[INFO] analyzing data
[INFO] 522445 rows
[INFO] ** appi_name:[21:99.99943%,30:0.00057%]
[INFO] ** classification:[normal:64.35816%,Single Stage Single Point:35.64184%]
[INFO] ** dst:[21:43.28838%,10:21.06806%,8:18.1711%,9:17.47093%,22:0.00077%,15:0.00057%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99943%,-33.760870000000004:0.00057%]
[INFO] ** modbus_function_description:[7:50.00048%,11:49.99895%,0:0.00057%]
[INFO] ** modbus_transaction_id:65536 (12.5441%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99943%,1:0.00057%]
[INFO] ** proxy_src_ip:[18:38.42089%,20:25.93613%,13:18.17091%,6:17.47112%,17:0.00057%,16:0.00038%]
[INFO] ** s_port:[1.45442:25.93555%,-0.32151:21.06806%,-1.27613:18.17072%,-0.23351:17.47074%,-0.33484:17.35283%,-71.33197:0.00057%,-1.02014:0.00038%,-1.27347:0.00019%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.93517%,1:21.06786%,5:18.17053%,4:17.47055%,2:17.35264%,0:0.00325%]
[INFO] ** service:[0.0048200000000000005:99.99943%,-211.73542999999998:0.00057%]
[INFO] ** src:[22:38.42089%,9:25.93613%,7:18.17091%,1:17.47112%,14:0.00057%,15:0.00038%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1419 (0.27161%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/522445
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1809 - tp: 74968.0000 - fp: 5032.0000 - tn: 314968.0000 - fn: 5032.0000 - accuracy: 0.9748 - precision: 0.9371 - recall: 0.9371 - auc: 0.9957 - val_loss: 0.1237 - val_tp: 19401.0000 - val_fp: 599.0000 - val_tn: 79401.0000 - val_fn: 599.0000 - val_accuracy: 0.9880 - val_precision: 0.9700 - val_recall: 0.9700 - val_auc: 0.9977
[INFO] saving weights to checkpoints/lstm-epoch-4-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/522445
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1385 - tp: 76264.0000 - fp: 3736.0000 - tn: 316264.0000 - fn: 3736.0000 - accuracy: 0.9813 - precision: 0.9533 - recall: 0.9533 - auc: 0.9981 - val_loss: 3.6066e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/522445
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1215 - tp: 76484.0000 - fp: 3516.0000 - tn: 316484.0000 - fn: 3516.0000 - accuracy: 0.9824 - precision: 0.9560 - recall: 0.9560 - auc: 0.9990 - val_loss: 1.3813e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/522445
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1124 - tp: 76550.0000 - fp: 3450.0000 - tn: 316550.0000 - fn: 3450.0000 - accuracy: 0.9827 - precision: 0.9569 - recall: 0.9569 - auc: 0.9992 - val_loss: 1.1224e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/522445
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1071 - tp: 76480.0000 - fp: 3520.0000 - tn: 316480.0000 - fn: 3520.0000 - accuracy: 0.9824 - precision: 0.9560 - recall: 0.9560 - auc: 0.9993 - val_loss: 4.7685e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-26-27-batch-400000-500000
[INFO] processing batch 500000-600000/522445
[33m[INFO] loading file 28-28/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (356361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (356361, 17)

[INFO] analyzing data
[INFO] 356361 rows
[INFO] ** appi_name:[21:99.99186%,30:0.00168%,17:0.0014%,22:0.00112%,7:0.00112%,31:0.00084%,26:0.00084%,28:0.00028%,27:0.00028%,8:0.00028%,0:0.00028%]
[INFO] ** classification:[normal:64.2994%,Single Stage Single Point:35.7006%]
[INFO] ** dst:[21:43.27718%,10:21.0138%,8:18.21383%,9:17.48648%,6:0.00224%,16:0.00196%,18:0.0014%,22:0.00056%,17:0.00056%,15:0.00056%,2:0.00056%,25:0.00028%,7:0.00028%,0:0.00028%]
[INFO] ** i/f_dir:[1:99.99944%,0:0.00056%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99186%,-33.760870000000004:0.00814%]
[INFO] ** modbus_function_description:[11:49.99593%,7:49.99593%,0:0.00814%]
[INFO] ** modbus_transaction_id:65535 (18.39006%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99523%,2:0.00421%,1:0.00056%]
[INFO] ** proxy_src_ip:[18:38.32967%,20:25.96131%,13:18.21411%,6:17.48676%,1:0.00224%,17:0.00168%,14:0.00168%,7:0.0014%,21:0.00084%,0:0.00028%]
[INFO] ** s_port:[1.45442:25.96103%,-0.32151:21.0138%,-1.27613:18.21383%,-0.23351:17.4862%,-0.33484:17.31587%,-71.14798:0.00112%,-71.14931:0.00112%,-71.33197:0.00056%,-0.08551:0.00056%,-0.24151:0.00056%,7.66617:0.00028%,-58.035180000000004:0.00028%,-1.2708:0.00028%,-64.19493:0.00028%,-5.1466400000000005:0.00028%,13.431270000000001:0.00028%,11.57001:0.00028%,14.4699:0.00028%,1.47576:0.00028%,14.191239999999999:0.00028%,-5.08665:0.00028%,10.192739999999999:0.00028%,-3.3787199999999995:0.00028%,6.1115699999999995:0.00028%,2.05573:0.00028%,-43.76509:0.00028%,2.52505:0.00028%,11.862:0.00028%,-58.032509999999995:0.00028%]
[INFO] ** scada_tag:[3:25.96103%,1:21.0138%,5:18.21383%,4:17.48592%,2:17.31587%,0:0.00954%]
[INFO] ** service:[0.0048200000000000005:99.99186%,-205.44247:0.0014%,-186.43601999999998:0.0014%,-211.09762999999998:0.00112%,-211.08346:0.00112%,-211.08818:0.00112%,-211.73542999999998:0.00056%,-186.44547:0.00028%,-183.8612:0.00028%,-185.9872:0.00028%,-211.35747999999998:0.00028%,-202.75898:0.00028%]
[INFO] ** src:[22:38.32967%,9:25.96131%,7:18.21411%,1:17.48676%,3:0.00253%,2:0.00168%,21:0.0014%,4:0.00112%,14:0.00056%,8:0.00056%,17:0.00028%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:969 (0.27192%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/356361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1267 - tp: 76186.0000 - fp: 3814.0000 - tn: 316186.0000 - fn: 3814.0000 - accuracy: 0.9809 - precision: 0.9523 - recall: 0.9523 - auc: 0.9980 - val_loss: 7.1642e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/356361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0843 - tp: 76820.0000 - fp: 3180.0000 - tn: 316820.0000 - fn: 3180.0000 - accuracy: 0.9841 - precision: 0.9603 - recall: 0.9603 - auc: 0.9993 - val_loss: 0.0010 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-4-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/356361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0764 - tp: 76880.0000 - fp: 3120.0000 - tn: 316880.0000 - fn: 3120.0000 - accuracy: 0.9844 - precision: 0.9610 - recall: 0.9610 - auc: 0.9994 - val_loss: 4.2765e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/356361
[33m[INFO] loading file 29-29/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (556361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (556361, 17)

[INFO] analyzing data
[INFO] 556361 rows
[INFO] ** appi_name:[21:99.99874%,30:0.00054%,31:0.00018%,26:0.00018%,9:0.00018%,3:0.00018%]
[INFO] ** classification:[normal:64.39668%,Single Stage Single Point:35.60332%]
[INFO] ** dst:[21:43.33356%,10:21.06168%,8:18.13786%,9:17.4651%,22:0.00054%,15:0.00054%,24:0.00018%,18:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.99874%,-33.760870000000004:0.00126%]
[INFO] ** modbus_function_description:[7:49.99973%,11:49.99901%,0:0.00126%]
[INFO] ** modbus_transaction_id:65536 (11.7794%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9991%,1:0.00054%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.44303%,20:25.95239%,13:18.13822%,6:17.46492%,17:0.00054%,21:0.00018%,16:0.00018%,7:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95186%,-0.32151:21.06151%,-1.27613:18.13786%,-0.23351:17.46492%,-0.33484:17.38152%,-71.33197:0.00054%,1.45709:0.00036%,-71.14798:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,6.1115699999999995:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.9515%,1:21.06133%,5:18.13786%,4:17.46456%,2:17.38152%,0:0.00324%]
[INFO] ** service:[0.0048200000000000005:99.99892%,-211.73542999999998:0.00054%,-183.8612:0.00018%,-211.08346:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.44303%,9:25.95239%,7:18.13822%,1:17.46492%,14:0.00054%,21:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1511 (0.27159%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0688 - tp: 76857.0000 - fp: 3143.0000 - tn: 316857.0000 - fn: 3143.0000 - accuracy: 0.9843 - precision: 0.9607 - recall: 0.9607 - auc: 0.9994 - val_loss: 7.0719e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0488 - tp: 77713.0000 - fp: 2287.0000 - tn: 317713.0000 - fn: 2287.0000 - accuracy: 0.9886 - precision: 0.9714 - recall: 0.9714 - auc: 0.9996 - val_loss: 7.1320e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0375 - tp: 78243.0000 - fp: 1757.0000 - tn: 318243.0000 - fn: 1757.0000 - accuracy: 0.9912 - precision: 0.9780 - recall: 0.9780 - auc: 0.9997 - val_loss: 3.7134e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0360 - tp: 78218.0000 - fp: 1782.0000 - tn: 318218.0000 - fn: 1782.0000 - accuracy: 0.9911 - precision: 0.9777 - recall: 0.9777 - auc: 0.9997 - val_loss: 8.0618e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0344 - tp: 78252.0000 - fp: 1748.0000 - tn: 318252.0000 - fn: 1748.0000 - accuracy: 0.9913 - precision: 0.9782 - recall: 0.9782 - auc: 0.9997 - val_loss: 2.1952e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/556361
[33m[INFO] loading file 30-30/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (556361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (556361, 17)

[INFO] analyzing data
[INFO] 556361 rows
[INFO] ** appi_name:[21:99.99748%,30:0.0018%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.36864%,Single Stage Single Point:35.63136%]
[INFO] ** dst:[21:43.33769%,10:21.02789%,8:18.14829%,9:17.48271%,15:0.0018%,22:0.00072%,24:0.00036%,25:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99838%,0:0.00162%]
[INFO] ** i/f_name:[2:99.9982%,3:0.0018%]
[INFO] ** modbus_function_code:[0.02961:99.99748%,-33.760870000000004:0.00252%]
[INFO] ** modbus_function_description:[7:49.99973%,11:49.99775%,0:0.00252%]
[INFO] ** modbus_transaction_id:65536 (11.7794%)
[INFO] ** orig:[0:99.9991%,2:0.00054%,1:0.00036%]
[INFO] ** proto:[0:99.99784%,1:0.0018%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.36825%,20:25.99715%,13:18.14865%,6:17.48325%,17:0.0018%,7:0.00036%,16:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.99697%,-0.32151:21.02771%,-1.27613:18.14811%,-0.23351:17.48253%,-0.33484:17.34054%,-71.33197:0.0018%,-0.24151:0.00054%,-1.27347:0.00036%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.99661%,1:21.02771%,5:18.14793%,4:17.48235%,2:17.34036%,0:0.00503%]
[INFO] ** service:[0.0048200000000000005:99.99766%,-211.73542999999998:0.0018%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.36825%,9:25.99715%,7:18.14865%,1:17.48325%,14:0.00126%,21:0.0009%,16:0.00018%,15:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.9991%,1:0.0009%]
[INFO] ** unixtime:1513 (0.27195%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0349 - tp: 78166.0000 - fp: 1834.0000 - tn: 318166.0000 - fn: 1834.0000 - accuracy: 0.9908 - precision: 0.9771 - recall: 0.9771 - auc: 0.9997 - val_loss: 2.1227e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0336 - tp: 78170.0000 - fp: 1830.0000 - tn: 318170.0000 - fn: 1830.0000 - accuracy: 0.9909 - precision: 0.9771 - recall: 0.9771 - auc: 0.9997 - val_loss: 1.9414e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0320 - tp: 78210.0000 - fp: 1790.0000 - tn: 318210.0000 - fn: 1790.0000 - accuracy: 0.9910 - precision: 0.9776 - recall: 0.9776 - auc: 0.9997 - val_loss: 1.6639e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0311 - tp: 78216.0000 - fp: 1784.0000 - tn: 318216.0000 - fn: 1784.0000 - accuracy: 0.9911 - precision: 0.9777 - recall: 0.9777 - auc: 0.9997 - val_loss: 1.6623e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0304 - tp: 78256.0000 - fp: 1744.0000 - tn: 318256.0000 - fn: 1744.0000 - accuracy: 0.9913 - precision: 0.9782 - recall: 0.9782 - auc: 0.9998 - val_loss: 1.4268e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/556361
[33m[INFO] loading file 31-31/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (556361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (556361, 17)

[INFO] analyzing data
[INFO] 556361 rows
[INFO] ** appi_name:[21:99.99964%,26:0.00018%,17:0.00018%]
[INFO] ** classification:[normal:64.37547%,Single Stage Single Point:35.62453%]
[INFO] ** dst:[21:43.32115%,10:21.0527%,8:18.12528%,9:17.49907%,22:0.00108%,24:0.00036%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99964%,-33.760870000000004:0.00036%]
[INFO] ** modbus_function_description:[7:50.00009%,11:49.99955%,0:0.00036%]
[INFO] ** modbus_transaction_id:65536 (11.7794%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.39557%,20:25.979%,13:18.12546%,6:17.49907%,16:0.00054%,7:0.00036%]
[INFO] ** s_port:[1.45442:25.97828%,-0.32151:21.0527%,-1.27613:18.1251%,-0.23351:17.49889%,-0.33484:17.34288%,-1.02014:0.00054%,-1.27347:0.00036%,1.45709:0.00036%,-71.14798:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,10.192739999999999:0.00018%]
[INFO] ** scada_tag:[3:25.97792%,1:21.05252%,5:18.12492%,4:17.49853%,2:17.3427%,0:0.00342%]
[INFO] ** service:[0.0048200000000000005:99.99964%,-211.08346:0.00018%,-205.44247:0.00018%]
[INFO] ** src:[22:38.39557%,9:25.979%,7:18.12546%,1:17.49907%,15:0.00054%,21:0.00036%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1512 (0.27177%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0302 - tp: 78213.0000 - fp: 1787.0000 - tn: 318213.0000 - fn: 1787.0000 - accuracy: 0.9911 - precision: 0.9777 - recall: 0.9777 - auc: 0.9997 - val_loss: 1.3388e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0302 - tp: 78209.0000 - fp: 1791.0000 - tn: 318209.0000 - fn: 1791.0000 - accuracy: 0.9910 - precision: 0.9776 - recall: 0.9776 - auc: 0.9998 - val_loss: 1.2989e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0292 - tp: 78273.0000 - fp: 1727.0000 - tn: 318273.0000 - fn: 1727.0000 - accuracy: 0.9914 - precision: 0.9784 - recall: 0.9784 - auc: 0.9998 - val_loss: 1.2638e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0297 - tp: 78181.0000 - fp: 1819.0000 - tn: 318181.0000 - fn: 1819.0000 - accuracy: 0.9909 - precision: 0.9773 - recall: 0.9773 - auc: 0.9998 - val_loss: 1.2527e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0285 - tp: 78371.0000 - fp: 1629.0000 - tn: 318371.0000 - fn: 1629.0000 - accuracy: 0.9919 - precision: 0.9796 - recall: 0.9796 - auc: 0.9998 - val_loss: 1.2252e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/556361
[33m[INFO] loading file 32-32/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (556361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (556361, 17)

[INFO] analyzing data
[INFO] 556361 rows
[INFO] ** appi_name:[21:99.99641%,30:0.00306%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.37583%,Single Stage Single Point:35.62417%]
[INFO] ** dst:[21:43.32331%,10:21.04784%,8:18.15907%,9:17.4651%,15:0.00306%,22:0.0009%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9973%,0:0.0027%]
[INFO] ** i/f_name:[2:99.99694%,3:0.00306%]
[INFO] ** modbus_function_code:[0.02961:99.99641%,-33.760870000000004:0.00359%]
[INFO] ** modbus_function_description:[7:49.99919%,11:49.99721%,0:0.00359%]
[INFO] ** modbus_transaction_id:65536 (11.7794%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99641%,1:0.00306%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.41373%,20:25.95779%,13:18.15907%,6:17.46564%,17:0.00306%,14:0.00054%,16:0.00018%]
[INFO] ** s_port:[1.45442:25.95725%,-0.32151:21.04784%,-1.27613:18.15871%,-0.23351:17.46492%,-0.33484:17.36588%,-71.33197:0.00306%,-0.24151:0.00054%,-1.2708:0.00018%,-1.02014:0.00018%,13.431270000000001:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,1.45709:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:25.95689%,1:21.04767%,5:18.15871%,4:17.46456%,2:17.36588%,0:0.00629%]
[INFO] ** service:[0.0048200000000000005:99.99641%,-211.73542999999998:0.00306%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.41373%,9:25.95779%,7:18.15907%,1:17.46564%,14:0.00306%,2:0.00054%,15:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1510 (0.27141%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0301 - tp: 78376.0000 - fp: 1624.0000 - tn: 318376.0000 - fn: 1624.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9998 - val_loss: 1.2001e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0307 - tp: 78344.0000 - fp: 1656.0000 - tn: 318344.0000 - fn: 1656.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9998 - val_loss: 1.1991e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0293 - tp: 78408.0000 - fp: 1592.0000 - tn: 318408.0000 - fn: 1592.0000 - accuracy: 0.9920 - precision: 0.9801 - recall: 0.9801 - auc: 0.9998 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0301 - tp: 78378.0000 - fp: 1622.0000 - tn: 318378.0000 - fn: 1622.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9997 - val_loss: 1.1986e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0288 - tp: 78430.0000 - fp: 1570.0000 - tn: 318430.0000 - fn: 1570.0000 - accuracy: 0.9922 - precision: 0.9804 - recall: 0.9804 - auc: 0.9998 - val_loss: 1.1971e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/556361
[33m[INFO] loading file 33-33/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (556361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (556361, 17)

[INFO] analyzing data
[INFO] 556361 rows
[INFO] ** appi_name:[21:99.99694%,30:0.00108%,17:0.00072%,22:0.00054%,31:0.00018%,28:0.00018%,26:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.39218%,Single Stage Single Point:35.60782%]
[INFO] ** dst:[21:43.32421%,10:21.06312%,8:18.12151%,9:17.48631%,22:0.00144%,15:0.00108%,16:0.00072%,6:0.00072%,24:0.00036%,17:0.00036%,18:0.00018%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99694%,-33.760870000000004:0.00306%]
[INFO] ** modbus_function_description:[7:49.99955%,11:49.99739%,0:0.00306%]
[INFO] ** modbus_transaction_id:65536 (11.7794%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99802%,1:0.00108%,2:0.0009%]
[INFO] ** proxy_src_ip:[18:38.42146%,20:25.96677%,13:18.12151%,6:17.48649%,17:0.00108%,16:0.00072%,1:0.00072%,21:0.00036%,14:0.00036%,7:0.00036%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.96587%,-0.32151:21.06312%,-1.27613:18.12115%,-0.23351:17.48613%,-0.33484:17.35833%,-71.33197:0.00108%,-1.02014:0.00072%,1.45709:0.00054%,-71.14931:0.00054%,-1.27347:0.00036%,-5.08665:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,-43.76509:0.00018%,-71.14798:0.00018%,-58.032509999999995:0.00018%,-58.035180000000004:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:25.96552%,1:21.06312%,5:18.12097%,4:17.48595%,2:17.35833%,0:0.00611%]
[INFO] ** service:[0.0048200000000000005:99.99694%,-211.73542999999998:0.00108%,-205.44247:0.00072%,-211.08818:0.00054%,-211.09762999999998:0.00018%,-211.08346:0.00018%,-185.9872:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.42146%,9:25.96677%,7:18.12151%,1:17.48649%,14:0.00108%,15:0.00072%,3:0.00072%,21:0.00036%,4:0.00036%,2:0.00036%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1513 (0.27195%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0293 - tp: 78414.0000 - fp: 1586.0000 - tn: 318414.0000 - fn: 1586.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0287 - tp: 78423.0000 - fp: 1577.0000 - tn: 318423.0000 - fn: 1577.0000 - accuracy: 0.9921 - precision: 0.9803 - recall: 0.9803 - auc: 0.9998 - val_loss: 1.2060e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0297 - tp: 78427.0000 - fp: 1573.0000 - tn: 318427.0000 - fn: 1573.0000 - accuracy: 0.9921 - precision: 0.9803 - recall: 0.9803 - auc: 0.9998 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0286 - tp: 78439.0000 - fp: 1561.0000 - tn: 318439.0000 - fn: 1561.0000 - accuracy: 0.9922 - precision: 0.9805 - recall: 0.9805 - auc: 0.9998 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0297 - tp: 78398.0000 - fp: 1602.0000 - tn: 318398.0000 - fn: 1602.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/556361
[33m[INFO] loading file 34-34/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (397794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (397794, 17)

[INFO] analyzing data
[INFO] 397794 rows
[INFO] ** appi_name:[21:99.99749%,30:0.00075%,7:0.00075%,31:0.00025%,22:0.00025%,8:0.00025%,6:0.00025%]
[INFO] ** classification:[normal:64.33858%,Single Stage Single Point:35.66142%]
[INFO] ** dst:[21:43.27592%,10:21.05939%,8:18.19535%,9:17.46633%,22:0.00075%,15:0.00075%,16:0.0005%,2:0.0005%,18:0.00025%,6:0.00025%]
[INFO] ** i/f_dir:[1:99.99925%,0:0.00075%]
[INFO] ** i/f_name:[2:99.99925%,3:0.00075%]
[INFO] ** modbus_function_code:[0.02961:99.99749%,-33.760870000000004:0.00251%]
[INFO] ** modbus_function_description:[7:49.99925%,11:49.99824%,0:0.00251%]
[INFO] ** modbus_transaction_id:65536 (16.47486%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99874%,1:0.00075%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.38997%,20:25.94559%,13:18.1951%,6:17.46683%,17:0.00075%,1:0.00075%,21:0.0005%,14:0.00025%,7:0.00025%]
[INFO] ** s_port:[1.45442:25.94509%,-0.32151:21.05914%,-1.27613:18.1951%,-0.23351:17.46608%,-0.33484:17.33083%,-0.24151:0.00075%,-71.33197:0.00075%,-3.0613900000000003:0.00025%,-3.3787199999999995:0.00025%,14.191239999999999:0.00025%,1.46509:0.00025%,1.47576:0.00025%,11.57001:0.00025%,-49.275529999999996:0.00025%,-71.14931:0.00025%,7.66617:0.00025%]
[INFO] ** scada_tag:[3:25.94484%,1:21.05889%,5:18.19484%,4:17.46557%,2:17.33083%,0:0.00503%]
[INFO] ** service:[0.0048200000000000005:99.99774%,-211.09762999999998:0.00075%,-211.73542999999998:0.00075%,-186.43601999999998:0.00025%,-211.35747999999998:0.00025%,-211.08818:0.00025%]
[INFO] ** src:[22:38.38997%,9:25.94559%,7:18.1951%,1:17.46683%,14:0.00075%,3:0.00075%,4:0.0005%,21:0.00025%,2:0.00025%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1080 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/397794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0292 - tp: 78391.0000 - fp: 1609.0000 - tn: 318391.0000 - fn: 1609.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/397794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0294 - tp: 78365.0000 - fp: 1635.0000 - tn: 318365.0000 - fn: 1635.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/397794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0305 - tp: 78272.0000 - fp: 1728.0000 - tn: 318272.0000 - fn: 1728.0000 - accuracy: 0.9914 - precision: 0.9784 - recall: 0.9784 - auc: 0.9997 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/397794
[33m[INFO] loading file 35-35/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.999%,30:0.001%]
[INFO] ** classification:[normal:64.35745%,Single Stage Single Point:35.64255%]
[INFO] ** dst:[21:43.31994%,10:21.03501%,8:18.16863%,9:17.47425%,22:0.00117%,15:0.001%]
[INFO] ** i/f_dir:[1:99.99916%,0:0.00084%]
[INFO] ** i/f_name:[2:99.999%,3:0.001%]
[INFO] ** modbus_function_code:[0.02961:99.999%,-33.760870000000004:0.001%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99883%,0:0.001%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:99.99967%,1:0.00033%]
[INFO] ** proto:[0:99.999%,1:0.001%]
[INFO] ** proxy_src_ip:[18:38.3868%,20:25.96864%,13:18.1683%,6:17.47458%,17:0.001%,16:0.00067%]
[INFO] ** s_port:[1.45442:25.96814%,-0.32151:21.03501%,-1.27613:18.1683%,-0.23351:17.47408%,-0.33484:17.3518%,-71.33197:0.001%,-1.02014:0.00067%,-0.24151:0.00033%,1.45709:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.96781%,1:21.03501%,5:18.16813%,4:17.47375%,2:17.3518%,0:0.00351%]
[INFO] ** service:[0.0048200000000000005:99.999%,-211.73542999999998:0.001%]
[INFO] ** src:[22:38.3868%,9:25.96864%,7:18.1683%,1:17.47458%,14:0.001%,15:0.00067%]
[INFO] ** type:[0:99.99916%,1:0.00084%]
[INFO] ** unixtime:1623 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0289 - tp: 78424.0000 - fp: 1576.0000 - tn: 318424.0000 - fn: 1576.0000 - accuracy: 0.9921 - precision: 0.9803 - recall: 0.9803 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0294 - tp: 78384.0000 - fp: 1616.0000 - tn: 318384.0000 - fn: 1616.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0297 - tp: 78423.0000 - fp: 1577.0000 - tn: 318423.0000 - fn: 1577.0000 - accuracy: 0.9921 - precision: 0.9803 - recall: 0.9803 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0312 - tp: 78244.0000 - fp: 1756.0000 - tn: 318244.0000 - fn: 1756.0000 - accuracy: 0.9912 - precision: 0.9780 - recall: 0.9780 - auc: 0.9997 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0290 - tp: 78413.0000 - fp: 1587.0000 - tn: 318413.0000 - fn: 1587.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 36-36/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.99866%,30:0.00067%,31:0.00033%,33:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.36448%,Single Stage Single Point:35.63552%]
[INFO] ** dst:[21:43.33031%,10:21.03199%,8:18.14973%,9:17.48562%,22:0.00084%,15:0.00067%,24:0.00033%,18:0.00033%,25:0.00017%]
[INFO] ** i/f_dir:[1:99.99933%,0:0.00067%]
[INFO] ** i/f_name:[2:99.99933%,3:0.00067%]
[INFO] ** modbus_function_code:[0.02961:99.99866%,-33.760870000000004:0.00134%]
[INFO] ** modbus_function_description:[7:50.00033%,11:49.99833%,0:0.00134%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,1:0.00067%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.3853%,20:25.97718%,13:18.1499%,6:17.48612%,17:0.00067%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.97667%,-0.32151:21.03183%,-1.27613:18.1494%,-0.23351:17.48545%,-0.33484:17.35347%,-71.33197:0.00067%,-0.24151:0.0005%,-0.08551:0.00033%,-1.27347:0.00033%,1.45709:0.00017%,1.47576:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,-64.19493:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.97634%,1:21.03166%,5:18.14923%,4:17.48529%,2:17.3533%,0:0.00418%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.73542999999998:0.00067%,-186.43601999999998:0.00033%,-186.44547:0.00017%]
[INFO] ** src:[22:38.3853%,9:25.97718%,7:18.1499%,1:17.48612%,14:0.00067%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1623 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0296 - tp: 78409.0000 - fp: 1591.0000 - tn: 318409.0000 - fn: 1591.0000 - accuracy: 0.9920 - precision: 0.9801 - recall: 0.9801 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0300 - tp: 78331.0000 - fp: 1669.0000 - tn: 318331.0000 - fn: 1669.0000 - accuracy: 0.9917 - precision: 0.9791 - recall: 0.9791 - auc: 0.9998 - val_loss: 1.1922e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0296 - tp: 78381.0000 - fp: 1619.0000 - tn: 318381.0000 - fn: 1619.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9998 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0284 - tp: 78464.0000 - fp: 1536.0000 - tn: 318464.0000 - fn: 1536.0000 - accuracy: 0.9923 - precision: 0.9808 - recall: 0.9808 - auc: 0.9998 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0287 - tp: 78454.0000 - fp: 1546.0000 - tn: 318454.0000 - fn: 1546.0000 - accuracy: 0.9923 - precision: 0.9807 - recall: 0.9807 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 37-37/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.99849%,30:0.00067%,31:0.00033%,33:0.00017%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:64.37686%,Single Stage Single Point:35.62314%]
[INFO] ** dst:[21:43.33767%,10:21.03701%,8:18.14036%,9:17.48278%,22:0.00067%,15:0.00067%,18:0.00033%,24:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99967%,0:0.00033%]
[INFO] ** i/f_name:[2:99.99933%,3:0.00067%]
[INFO] ** modbus_function_code:[0.02961:99.99849%,-33.760870000000004:0.00151%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99849%,0:0.00151%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,1:0.00067%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.38346%,20:25.9914%,13:18.14036%,6:17.48295%,17:0.00067%,21:0.00033%,16:0.00033%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.99089%,-0.32151:21.03685%,-1.27613:18.14003%,-0.23351:17.48261%,-0.33484:17.34661%,-71.33197:0.00067%,-0.08551:0.00033%,-1.02014:0.00033%,-0.24151:0.00017%,14.4699:0.00017%,-1.2708:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.99056%,1:21.03685%,5:18.13986%,4:17.48244%,2:17.34644%,0:0.00385%]
[INFO] ** service:[0.0048200000000000005:99.99866%,-211.73542999999998:0.00067%,-186.43601999999998:0.00033%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.38346%,9:25.9914%,7:18.14036%,1:17.48295%,14:0.00067%,15:0.00033%,4:0.00033%,17:0.00017%,8:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99967%,1:0.00033%]
[INFO] ** unixtime:1624 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0294 - tp: 78351.0000 - fp: 1649.0000 - tn: 318351.0000 - fn: 1649.0000 - accuracy: 0.9918 - precision: 0.9794 - recall: 0.9794 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0288 - tp: 78399.0000 - fp: 1601.0000 - tn: 318399.0000 - fn: 1601.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0297 - tp: 78328.0000 - fp: 1672.0000 - tn: 318328.0000 - fn: 1672.0000 - accuracy: 0.9916 - precision: 0.9791 - recall: 0.9791 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0297 - tp: 78354.0000 - fp: 1646.0000 - tn: 318354.0000 - fn: 1646.0000 - accuracy: 0.9918 - precision: 0.9794 - recall: 0.9794 - auc: 0.9998 - val_loss: 2.5956e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0289 - tp: 78428.0000 - fp: 1572.0000 - tn: 318428.0000 - fn: 1572.0000 - accuracy: 0.9921 - precision: 0.9804 - recall: 0.9804 - auc: 0.9998 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 38-38/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.999%,30:0.00033%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.41048%,Single Stage Single Point:35.58952%]
[INFO] ** dst:[21:43.32379%,10:21.08469%,8:18.09486%,9:17.49482%,22:0.00084%,15:0.00033%,25:0.00017%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.99967%,3:0.00033%]
[INFO] ** modbus_function_code:[0.02961:99.999%,-33.760870000000004:0.001%]
[INFO] ** modbus_function_description:[7:49.99967%,11:49.99933%,0:0.001%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99933%,2:0.00033%,1:0.00033%]
[INFO] ** proxy_src_ip:[18:38.44669%,20:25.96246%,13:18.09469%,6:17.49499%,17:0.00033%,7:0.00033%,16:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.96162%,-0.32151:21.08452%,-1.27613:18.09453%,-0.23351:17.49449%,-0.33484:17.36217%,1.47576:0.00033%,-0.24151:0.00033%,-71.33197:0.00033%,1.45709:0.00033%,-1.27347:0.00017%,1.46509:0.00017%,-61.95768:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:25.96128%,1:21.08452%,5:18.09453%,4:17.49432%,2:17.362%,0:0.00335%]
[INFO] ** service:[0.0048200000000000005:99.99916%,-211.73542999999998:0.00033%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.44669%,9:25.96246%,7:18.09469%,1:17.49499%,21:0.00033%,14:0.00033%,16:0.00017%,15:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1624 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0297 - tp: 78366.0000 - fp: 1634.0000 - tn: 318366.0000 - fn: 1634.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0299 - tp: 78339.0000 - fp: 1661.0000 - tn: 318339.0000 - fn: 1661.0000 - accuracy: 0.9917 - precision: 0.9792 - recall: 0.9792 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0288 - tp: 78430.0000 - fp: 1570.0000 - tn: 318430.0000 - fn: 1570.0000 - accuracy: 0.9922 - precision: 0.9804 - recall: 0.9804 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0297 - tp: 78415.0000 - fp: 1585.0000 - tn: 318415.0000 - fn: 1585.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0301 - tp: 78410.0000 - fp: 1590.0000 - tn: 318410.0000 - fn: 1590.0000 - accuracy: 0.9921 - precision: 0.9801 - recall: 0.9801 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 39-39/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.99967%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.39593%,Single Stage Single Point:35.60407%]
[INFO] ** dst:[21:43.31158%,10:21.08302%,8:18.13668%,9:17.46722%,22:0.001%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99967%,-33.760870000000004:0.00033%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.9995%,0:0.00033%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.44451%,20:25.95058%,13:18.13685%,6:17.46722%,16:0.0005%,7:0.00033%]
[INFO] ** s_port:[1.45442:25.94991%,-0.32151:21.08302%,-1.27613:18.13652%,-0.23351:17.46705%,-0.33484:17.3615%,-1.02014:0.0005%,1.45709:0.00033%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.94957%,1:21.08285%,5:18.13635%,4:17.46705%,2:17.36133%,0:0.00284%]
[INFO] ** service:[0.0048200000000000005:99.99967%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.44451%,9:25.95058%,7:18.13685%,1:17.46722%,15:0.0005%,21:0.00033%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1622 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0301 - tp: 78398.0000 - fp: 1602.0000 - tn: 318398.0000 - fn: 1602.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9998 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0300 - tp: 78363.0000 - fp: 1637.0000 - tn: 318363.0000 - fn: 1637.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0290 - tp: 78376.0000 - fp: 1624.0000 - tn: 318376.0000 - fn: 1624.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0298 - tp: 78357.0000 - fp: 1643.0000 - tn: 318357.0000 - fn: 1643.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0291 - tp: 78416.0000 - fp: 1584.0000 - tn: 318416.0000 - fn: 1584.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 40-40/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.99665%,30:0.00284%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.33253%,Single Stage Single Point:35.66747%]
[INFO] ** dst:[21:43.291%,10:21.03701%,8:18.20192%,9:17.46572%,15:0.00284%,22:0.00084%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99732%,0:0.00268%]
[INFO] ** i/f_name:[2:99.99716%,3:0.00284%]
[INFO] ** modbus_function_code:[0.02961:99.99665%,-33.760870000000004:0.00335%]
[INFO] ** modbus_function_description:[7:49.99933%,11:49.99732%,0:0.00335%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:99.99967%,1:0.00033%]
[INFO] ** proto:[0:99.99665%,1:0.00284%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.35652%,20:25.97232%,13:18.20176%,6:17.46605%,17:0.00284%,14:0.0005%]
[INFO] ** s_port:[1.45442:25.97149%,-0.32151:21.03701%,-1.27613:18.20159%,-0.23351:17.46555%,-0.33484:17.31951%,-71.33197:0.00284%,1.45709:0.0005%,-0.24151:0.00033%,-71.14798:0.00017%,-1.27347:0.00017%,11.862:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%,13.431270000000001:0.00017%]
[INFO] ** scada_tag:[3:25.97115%,1:21.03685%,5:18.20142%,4:17.46521%,2:17.31934%,0:0.00602%]
[INFO] ** service:[0.0048200000000000005:99.99665%,-211.73542999999998:0.00284%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.35652%,9:25.97232%,7:18.20176%,1:17.46605%,14:0.00284%,2:0.0005%]
[INFO] ** type:[0:99.99916%,1:0.00084%]
[INFO] ** unixtime:1625 (0.27183%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0292 - tp: 78382.0000 - fp: 1618.0000 - tn: 318382.0000 - fn: 1618.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0298 - tp: 78353.0000 - fp: 1647.0000 - tn: 318353.0000 - fn: 1647.0000 - accuracy: 0.9918 - precision: 0.9794 - recall: 0.9794 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0295 - tp: 78377.0000 - fp: 1623.0000 - tn: 318377.0000 - fn: 1623.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9998 - val_loss: 7.6473e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0296 - tp: 78357.0000 - fp: 1643.0000 - tn: 318357.0000 - fn: 1643.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0298 - tp: 78333.0000 - fp: 1667.0000 - tn: 318333.0000 - fn: 1667.0000 - accuracy: 0.9917 - precision: 0.9792 - recall: 0.9792 - auc: 0.9998 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 41-41/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (537952, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (537952, 17)

[INFO] analyzing data
[INFO] 537952 rows
[INFO] ** appi_name:[21:99.99684%,30:0.00093%,22:0.00074%,17:0.00074%,32:0.00019%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.38511%,Single Stage Single Point:35.61489%]
[INFO] ** dst:[21:43.32654%,10:21.05467%,8:18.14418%,9:17.47052%,16:0.00093%,15:0.00093%,6:0.00093%,22:0.00056%,24:0.00037%,17:0.00037%]
[INFO] ** i/f_dir:[1:99.99907%,0:0.00093%]
[INFO] ** i/f_name:[2:99.99907%,3:0.00093%]
[INFO] ** modbus_function_code:[0.02961:99.99684%,-33.760870000000004:0.00316%]
[INFO] ** modbus_function_description:[7:49.99907%,11:49.99777%,0:0.00316%]
[INFO] ** modbus_transaction_id:65536 (12.1825%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99796%,2:0.00112%,1:0.00093%]
[INFO] ** proxy_src_ip:[18:38.42425%,20:25.95715%,13:18.14437%,6:17.4707%,17:0.00093%,1:0.00074%,21:0.00037%,16:0.00037%,14:0.00037%,0:0.00037%,7:0.00019%,2:0.00019%]
[INFO] ** s_port:[1.45442:25.95678%,-0.32151:21.05467%,-1.27613:18.14381%,-0.23351:17.47033%,-0.33484:17.36958%,-71.33197:0.00093%,-71.14931:0.00074%,-1.27347:0.00037%,-1.02014:0.00037%,-0.24151:0.00019%,-5.1466400000000005:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,1.46509:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,-5.08665:0.00019%,-64.19226:0.00019%,-0.24950999999999998:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:25.95641%,1:21.05467%,5:18.14381%,4:17.47015%,2:17.36939%,0:0.00558%]
[INFO] ** service:[0.0048200000000000005:99.99684%,-211.73542999999998:0.00093%,-205.44247:0.00074%,-211.08818:0.00074%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%,89.64175:0.00019%]
[INFO] ** src:[22:38.42425%,9:25.95715%,7:18.14437%,1:17.4707%,14:0.00093%,3:0.00074%,15:0.00037%,8:0.00037%,4:0.00037%,2:0.00037%,21:0.00019%,17:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1459 (0.27121%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/537952
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0297 - tp: 78369.0000 - fp: 1631.0000 - tn: 318369.0000 - fn: 1631.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/537952
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0301 - tp: 78355.0000 - fp: 1645.0000 - tn: 318355.0000 - fn: 1645.0000 - accuracy: 0.9918 - precision: 0.9794 - recall: 0.9794 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/537952
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0286 - tp: 78465.0000 - fp: 1535.0000 - tn: 318465.0000 - fn: 1535.0000 - accuracy: 0.9923 - precision: 0.9808 - recall: 0.9808 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/537952
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0283 - tp: 78424.0000 - fp: 1576.0000 - tn: 318424.0000 - fn: 1576.0000 - accuracy: 0.9921 - precision: 0.9803 - recall: 0.9803 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/537952
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0297 - tp: 78404.0000 - fp: 1596.0000 - tn: 318404.0000 - fn: 1596.0000 - accuracy: 0.9920 - precision: 0.9801 - recall: 0.9801 - auc: 0.9998 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-40-41-batch-400000-500000
[INFO] processing batch 500000-600000/537952
[33m[INFO] loading file 42-42/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (381466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (381466, 17)

[INFO] analyzing data
[INFO] 381466 rows
[INFO] ** appi_name:[21:99.99109%,30:0.00236%,17:0.00131%,31:0.00105%,26:0.00105%,7:0.00105%,22:0.00079%,28:0.00026%,27:0.00026%,9:0.00026%,8:0.00026%,0:0.00026%]
[INFO] ** classification:[normal:64.36563%,Single Stage Single Point:35.63437%]
[INFO] ** dst:[21:43.31159%,10:21.0446%,8:18.18511%,9:17.449%,16:0.00236%,6:0.0021%,18:0.00131%,2:0.00105%,22:0.00079%,15:0.00079%,17:0.00052%,25:0.00026%,7:0.00026%,0:0.00026%]
[INFO] ** i/f_dir:[1:99.99921%,0:0.00079%]
[INFO] ** i/f_name:[2:99.99921%,3:0.00079%]
[INFO] ** modbus_function_code:[0.02961:99.99109%,-33.760870000000004:0.00891%]
[INFO] ** modbus_function_description:[7:49.99633%,11:49.99476%,0:0.00891%]
[INFO] ** modbus_transaction_id:65536 (17.18004%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99528%,2:0.00393%,1:0.00079%]
[INFO] ** proxy_src_ip:[18:38.40395%,20:25.95251%,13:18.18537%,6:17.449%,17:0.00236%,1:0.00236%,14:0.00157%,21:0.00105%,7:0.00079%,0:0.00052%,16:0.00026%,2:0.00026%]
[INFO] ** s_port:[1.45442:25.95199%,-0.32151:21.0446%,-1.27613:18.18511%,-0.23351:17.44874%,-0.33484:17.35935%,-71.14931:0.00105%,-71.14798:0.00105%,-71.33197:0.00079%,-3.3787199999999995:0.00052%,-0.08551:0.00052%,11.57001:0.00052%,13.431270000000001:0.00026%,-5.1466400000000005:0.00026%,0.31847:0.00026%,-1.02014:0.00026%,-64.19493:0.00026%,-1.2708:0.00026%,-58.035180000000004:0.00026%,7.66617:0.00026%,-0.24151:0.00026%,1.47576:0.00026%,14.4699:0.00026%,15.912510000000001:0.00026%,14.191239999999999:0.00026%,7.9608300000000005:0.00026%,-5.08665:0.00026%,10.192739999999999:0.00026%,-3.0613900000000003:0.00026%,1.45709:0.00026%,2.05573:0.00026%,-43.76509:0.00026%,11.862:0.00026%,-58.032509999999995:0.00026%]
[INFO] ** scada_tag:[3:25.95146%,1:21.0446%,5:18.18484%,4:17.44874%,2:17.35908%,0:0.01127%]
[INFO] ** service:[0.0048200000000000005:99.99109%,-211.09762999999998:0.00184%,-205.44247:0.00131%,-186.43601999999998:0.00131%,-211.08346:0.00105%,-211.08818:0.00105%,-211.73542999999998:0.00079%,-211.35747999999998:0.00052%,-186.44547:0.00026%,-183.8612:0.00026%,-185.9872:0.00026%,-202.75898:0.00026%]
[INFO] ** src:[22:38.40395%,9:25.95251%,7:18.18537%,1:17.449%,3:0.00315%,2:0.00184%,4:0.00131%,21:0.00105%,14:0.00079%,8:0.00052%,17:0.00026%,15:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1035 (0.27132%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/381466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0297 - tp: 78395.0000 - fp: 1605.0000 - tn: 318395.0000 - fn: 1605.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/381466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0292 - tp: 78398.0000 - fp: 1602.0000 - tn: 318398.0000 - fn: 1602.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9998 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/381466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0294 - tp: 78405.0000 - fp: 1595.0000 - tn: 318405.0000 - fn: 1595.0000 - accuracy: 0.9920 - precision: 0.9801 - recall: 0.9801 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/381466
[33m[INFO] loading file 43-43/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.9988%,30:0.00052%,26:0.00034%,8:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.39276%,Single Stage Single Point:35.60724%]
[INFO] ** dst:[21:43.32085%,10:21.06968%,8:18.13623%,9:17.47084%,22:0.00103%,15:0.00052%,6:0.00034%,2:0.00034%,24:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.9988%,-33.760870000000004:0.0012%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.9988%,0:0.0012%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99914%,1:0.00052%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.4179%,20:25.97314%,13:18.1364%,6:17.47101%,17:0.00052%,1:0.00052%,16:0.00034%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.97246%,-0.32151:21.06968%,-1.27613:18.13606%,-0.23351:17.4705%,-0.33484:17.34822%,-71.33197:0.00052%,-71.14798:0.00034%,1.45709:0.00034%,1.47576:0.00034%,-0.24151:0.00034%,-1.02014:0.00034%,0.31847:0.00017%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,-1.2708:0.00017%,-3.3787199999999995:0.00017%]
[INFO] ** scada_tag:[3:25.97211%,1:21.06968%,5:18.13588%,4:17.47015%,2:17.34805%,0:0.00413%]
[INFO] ** service:[0.0048200000000000005:99.9988%,-211.73542999999998:0.00052%,-211.08346:0.00034%,-211.09762999999998:0.00017%,-211.35747999999998:0.00017%]
[INFO] ** src:[22:38.4179%,9:25.97314%,7:18.1364%,1:17.47101%,14:0.00052%,3:0.00052%,15:0.00034%,21:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1581 (0.2719%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0296 - tp: 78381.0000 - fp: 1619.0000 - tn: 318381.0000 - fn: 1619.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0297 - tp: 78392.0000 - fp: 1608.0000 - tn: 318392.0000 - fn: 1608.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0299 - tp: 78420.0000 - fp: 1580.0000 - tn: 318420.0000 - fn: 1580.0000 - accuracy: 0.9921 - precision: 0.9803 - recall: 0.9803 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0305 - tp: 78317.0000 - fp: 1683.0000 - tn: 318317.0000 - fn: 1683.0000 - accuracy: 0.9916 - precision: 0.9790 - recall: 0.9790 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0295 - tp: 78376.0000 - fp: 1624.0000 - tn: 318376.0000 - fn: 1624.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 44-44/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.99828%,30:0.00069%,31:0.00052%,0:0.00034%,22:0.00017%]
[INFO] ** classification:[normal:64.39345%,Single Stage Single Point:35.60655%]
[INFO] ** dst:[21:43.33512%,10:21.0554%,8:18.14981%,9:17.45657%,22:0.00103%,15:0.00069%,18:0.00052%,25:0.00034%,24:0.00034%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99931%,0:0.00069%]
[INFO] ** i/f_name:[2:99.99931%,3:0.00069%]
[INFO] ** modbus_function_code:[0.02961:99.99828%,-33.760870000000004:0.00172%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99811%,0:0.00172%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99828%,2:0.00103%,1:0.00069%]
[INFO] ** proxy_src_ip:[18:38.4375%,20:25.95354%,13:18.14999%,6:17.45708%,17:0.00069%,7:0.00034%,16:0.00017%,5:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95285%,-0.32151:21.0554%,-1.27613:18.14947%,-0.23351:17.45639%,-0.33484:17.3821%,-71.33197:0.00069%,-0.24151:0.00052%,-0.08551:0.00034%,-64.19493:0.00034%,-1.27347:0.00034%,1.45709:0.00034%,-1.02014:0.00017%,-1.2708:0.00017%,1.47576:0.00017%,-71.14931:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,4.42897:0.00017%]
[INFO] ** scada_tag:[3:25.95233%,1:21.0554%,5:18.14947%,4:17.45605%,2:17.38193%,0:0.00482%]
[INFO] ** service:[0.0048200000000000005:99.99828%,-211.73542999999998:0.00069%,-186.43601999999998:0.00052%,-186.44547:0.00034%,-211.08818:0.00017%]
[INFO] ** src:[22:38.4375%,9:25.95354%,7:18.14999%,1:17.45708%,14:0.00069%,21:0.00034%,17:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1578 (0.27138%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0297 - tp: 78381.0000 - fp: 1619.0000 - tn: 318381.0000 - fn: 1619.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9998 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0289 - tp: 78398.0000 - fp: 1602.0000 - tn: 318398.0000 - fn: 1602.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9998 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0296 - tp: 78329.0000 - fp: 1671.0000 - tn: 318329.0000 - fn: 1671.0000 - accuracy: 0.9916 - precision: 0.9791 - recall: 0.9791 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0300 - tp: 78370.0000 - fp: 1630.0000 - tn: 318370.0000 - fn: 1630.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0312 - tp: 78336.0000 - fp: 1664.0000 - tn: 318336.0000 - fn: 1664.0000 - accuracy: 0.9917 - precision: 0.9792 - recall: 0.9792 - auc: 0.9997 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 45-45/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.9988%,30:0.00052%,31:0.00034%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:64.41649%,Single Stage Single Point:35.58351%]
[INFO] ** dst:[21:43.32308%,10:21.09066%,8:18.12832%,9:17.45536%,22:0.00138%,15:0.00052%,18:0.00034%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.9988%,-33.760870000000004:0.0012%]
[INFO] ** modbus_function_description:[7:50.00052%,11:49.99828%,0:0.0012%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99897%,2:0.00052%,1:0.00052%]
[INFO] ** proxy_src_ip:[18:38.48342%,20:25.93101%,13:18.12815%,6:17.45588%,17:0.00052%,16:0.00034%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.93032%,-0.32151:21.09066%,-1.27613:18.12815%,-0.23351:17.45519%,-0.33484:17.39276%,1.45709:0.00052%,-0.24151:0.00052%,-71.33197:0.00052%,-1.02014:0.00034%,-0.08551:0.00034%,-71.14798:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:25.92981%,1:21.09049%,5:18.12815%,4:17.45519%,2:17.39259%,0:0.00378%]
[INFO] ** service:[0.0048200000000000005:99.9988%,-211.73542999999998:0.00052%,-186.43601999999998:0.00034%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.48342%,9:25.93101%,7:18.12815%,1:17.45588%,14:0.00052%,15:0.00034%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1578 (0.27138%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0297 - tp: 78387.0000 - fp: 1613.0000 - tn: 318387.0000 - fn: 1613.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0299 - tp: 78346.0000 - fp: 1654.0000 - tn: 318346.0000 - fn: 1654.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0295 - tp: 78399.0000 - fp: 1601.0000 - tn: 318399.0000 - fn: 1601.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0298 - tp: 78400.0000 - fp: 1600.0000 - tn: 318400.0000 - fn: 1600.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0290 - tp: 78351.0000 - fp: 1649.0000 - tn: 318351.0000 - fn: 1649.0000 - accuracy: 0.9918 - precision: 0.9794 - recall: 0.9794 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 46-46/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.99828%,30:0.00103%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.41924%,Single Stage Single Point:35.58076%]
[INFO] ** dst:[21:43.34578%,10:21.07088%,8:18.1082%,9:17.47256%,22:0.00103%,15:0.00103%,25:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99914%,0:0.00086%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99828%,-33.760870000000004:0.00172%]
[INFO] ** modbus_function_description:[11:49.99931%,7:49.99897%,0:0.00172%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99862%,1:0.00103%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.44163%,20:25.97504%,13:18.1082%,6:17.47308%,17:0.00103%,16:0.00034%,7:0.00034%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.97469%,-0.32151:21.07071%,-1.27613:18.10802%,-0.23351:17.47239%,-0.33484:17.37092%,-71.33197:0.00103%,-0.24151:0.00052%,-1.02014:0.00034%,-71.14798:0.00017%,1.45709:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,-61.95768:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:25.97435%,1:21.07054%,5:18.10785%,4:17.47204%,2:17.37092%,0:0.0043%]
[INFO] ** service:[0.0048200000000000005:99.99845%,-211.73542999999998:0.00103%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.44163%,9:25.97504%,7:18.1082%,1:17.47308%,14:0.00103%,21:0.00034%,15:0.00034%,16:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99914%,1:0.00086%]
[INFO] ** unixtime:1581 (0.2719%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0288 - tp: 78411.0000 - fp: 1589.0000 - tn: 318411.0000 - fn: 1589.0000 - accuracy: 0.9921 - precision: 0.9801 - recall: 0.9801 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0300 - tp: 78365.0000 - fp: 1635.0000 - tn: 318365.0000 - fn: 1635.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9998 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0300 - tp: 78357.0000 - fp: 1643.0000 - tn: 318357.0000 - fn: 1643.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0291 - tp: 78374.0000 - fp: 1626.0000 - tn: 318374.0000 - fn: 1626.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0292 - tp: 78426.0000 - fp: 1574.0000 - tn: 318426.0000 - fn: 1574.0000 - accuracy: 0.9921 - precision: 0.9803 - recall: 0.9803 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 47-47/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.99948%,33:0.00017%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.39603%,Single Stage Single Point:35.60397%]
[INFO] ** dst:[21:43.31018%,10:21.08395%,8:18.1278%,9:17.47583%,22:0.00155%,24:0.00034%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99948%,-33.760870000000004:0.00052%]
[INFO] ** modbus_function_description:[7:50.00103%,11:49.99845%,0:0.00052%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.45401%,20:25.94081%,13:18.12815%,6:17.47617%,16:0.00034%,7:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.93995%,-0.32151:21.08395%,-1.27613:18.12763%,-0.23351:17.47566%,-0.33484:17.37006%,1.45709:0.00052%,-0.24151:0.00052%,-1.27347:0.00034%,-1.02014:0.00034%,-71.14798:0.00017%,-61.95635:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.93944%,1:21.08378%,5:18.12746%,4:17.47548%,2:17.36989%,0:0.00396%]
[INFO] ** service:[0.0048200000000000005:99.99966%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.45401%,9:25.94081%,7:18.12815%,1:17.47617%,21:0.00034%,15:0.00034%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1579 (0.27156%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0293 - tp: 78372.0000 - fp: 1628.0000 - tn: 318372.0000 - fn: 1628.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0283 - tp: 78428.0000 - fp: 1572.0000 - tn: 318428.0000 - fn: 1572.0000 - accuracy: 0.9921 - precision: 0.9804 - recall: 0.9804 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0299 - tp: 78394.0000 - fp: 1606.0000 - tn: 318394.0000 - fn: 1606.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0296 - tp: 78375.0000 - fp: 1625.0000 - tn: 318375.0000 - fn: 1625.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0295 - tp: 78387.0000 - fp: 1613.0000 - tn: 318387.0000 - fn: 1613.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 48-48/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.9969%,30:0.00241%,33:0.00017%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.42973%,Single Stage Single Point:35.57027%]
[INFO] ** dst:[21:43.33031%,10:21.09564%,8:18.10407%,9:17.46603%,15:0.00241%,22:0.00086%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99794%,0:0.00206%]
[INFO] ** i/f_name:[2:99.99759%,3:0.00241%]
[INFO] ** modbus_function_code:[0.02961:99.9969%,-33.760870000000004:0.0031%]
[INFO] ** modbus_function_description:[7:49.99897%,11:49.99794%,0:0.0031%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99708%,1:0.00241%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.47207%,20:25.95423%,13:18.10424%,6:17.46603%,17:0.00241%,14:0.00052%,16:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95371%,-0.32151:21.09564%,-1.27613:18.1039%,-0.23351:17.46585%,-0.33484:17.37642%,-71.33197:0.00241%,-1.02014:0.00034%,-1.2708:0.00017%,13.431270000000001:0.00017%,-0.24151:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-61.95635:0.00017%,1.45709:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.95337%,1:21.09547%,5:18.1039%,4:17.46585%,2:17.37625%,0:0.00516%]
[INFO] ** service:[0.0048200000000000005:99.99708%,-211.73542999999998:0.00241%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.47207%,9:25.95423%,7:18.10424%,1:17.46603%,14:0.00241%,2:0.00052%,15:0.00034%,8:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1578 (0.27138%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0299 - tp: 78391.0000 - fp: 1609.0000 - tn: 318391.0000 - fn: 1609.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0292 - tp: 78403.0000 - fp: 1597.0000 - tn: 318403.0000 - fn: 1597.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0293 - tp: 78396.0000 - fp: 1604.0000 - tn: 318396.0000 - fn: 1604.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0292 - tp: 78428.0000 - fp: 1572.0000 - tn: 318428.0000 - fn: 1572.0000 - accuracy: 0.9921 - precision: 0.9804 - recall: 0.9804 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0301 - tp: 78369.0000 - fp: 1631.0000 - tn: 318369.0000 - fn: 1631.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9997 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 49-49/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.99742%,30:0.00086%,17:0.00069%,26:0.00034%,22:0.00034%,28:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.38124%,Single Stage Single Point:35.61876%]
[INFO] ** dst:[21:43.31878%,10:21.05815%,8:18.12866%,9:17.48993%,22:0.00155%,15:0.00086%,16:0.00069%,6:0.00069%,24:0.00034%,17:0.00034%]
[INFO] ** i/f_dir:[1:99.99914%,0:0.00086%]
[INFO] ** i/f_name:[2:99.99914%,3:0.00086%]
[INFO] ** modbus_function_code:[0.02961:99.99742%,-33.760870000000004:0.00258%]
[INFO] ** modbus_function_description:[7:49.99983%,11:49.99759%,0:0.00258%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99845%,1:0.00086%,2:0.00069%]
[INFO] ** proxy_src_ip:[18:38.4234%,20:25.95423%,13:18.12883%,6:17.49062%,17:0.00086%,1:0.00069%,14:0.00052%,21:0.00034%,16:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95337%,-0.32151:21.05815%,-1.27613:18.12832%,-0.23351:17.48976%,-0.33484:17.36525%,-71.33197:0.00086%,-0.24151:0.00069%,1.45709:0.00052%,-1.27347:0.00034%,-71.14931:0.00034%,-1.02014:0.00034%,-71.14798:0.00034%,1.47576:0.00017%,-1.2708:0.00017%,-58.035180000000004:0.00017%,-58.032509999999995:0.00017%,1.46509:0.00017%,-43.76509:0.00017%,2.05573:0.00017%,-5.08665:0.00017%,-0.24950999999999998:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.95302%,1:21.05798%,5:18.12815%,4:17.48941%,2:17.36525%,0:0.00619%]
[INFO] ** service:[0.0048200000000000005:99.99742%,-211.73542999999998:0.00086%,-205.44247:0.00069%,-211.08346:0.00034%,-211.08818:0.00034%,-211.09762999999998:0.00017%,-185.9872:0.00017%]
[INFO] ** src:[22:38.4234%,9:25.95423%,7:18.12883%,1:17.49062%,14:0.00086%,3:0.00069%,2:0.00052%,15:0.00034%,4:0.00034%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1579 (0.27156%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0292 - tp: 78402.0000 - fp: 1598.0000 - tn: 318402.0000 - fn: 1598.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0290 - tp: 78435.0000 - fp: 1565.0000 - tn: 318435.0000 - fn: 1565.0000 - accuracy: 0.9922 - precision: 0.9804 - recall: 0.9804 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0293 - tp: 78457.0000 - fp: 1543.0000 - tn: 318457.0000 - fn: 1543.0000 - accuracy: 0.9923 - precision: 0.9807 - recall: 0.9807 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0293 - tp: 78420.0000 - fp: 1580.0000 - tn: 318420.0000 - fn: 1580.0000 - accuracy: 0.9921 - precision: 0.9803 - recall: 0.9803 - auc: 0.9998 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0294 - tp: 78429.0000 - fp: 1571.0000 - tn: 318429.0000 - fn: 1571.0000 - accuracy: 0.9921 - precision: 0.9804 - recall: 0.9804 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 50-50/50 on epoch 4/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (431448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (431448, 17)

[INFO] analyzing data
[INFO] 431448 rows
[INFO] ** appi_name:[21:99.99745%,30:0.00116%,7:0.0007%,31:0.00023%,22:0.00023%,8:0.00023%]
[INFO] ** classification:[normal:64.3132%,Single Stage Single Point:35.6868%]
[INFO] ** dst:[21:43.26593%,10:21.04402%,8:18.21425%,9:17.47233%,15:0.00116%,22:0.0007%,16:0.00046%,2:0.00046%,24:0.00023%,18:0.00023%,6:0.00023%]
[INFO] ** i/f_dir:[1:99.99884%,0:0.00116%]
[INFO] ** i/f_name:[2:99.99884%,3:0.00116%]
[INFO] ** modbus_function_code:[0.02961:99.99745%,-33.760870000000004:0.00255%]
[INFO] ** modbus_function_description:[7:49.99884%,11:49.99861%,0:0.00255%]
[INFO] ** modbus_transaction_id:65536 (15.18978%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99838%,1:0.00116%,2:0.00046%]
[INFO] ** proxy_src_ip:[18:38.3694%,20:25.94079%,13:18.21448%,6:17.47233%,17:0.00116%,1:0.0007%,16:0.00046%,21:0.00023%,14:0.00023%,7:0.00023%]
[INFO] ** s_port:[1.45442:25.94032%,-0.32151:21.04402%,-1.27613:18.21401%,-0.23351:17.47233%,-0.33484:17.32538%,-71.33197:0.00116%,-1.02014:0.00046%,-3.3787199999999995:0.00023%,4.33564:0.00023%,15.912510000000001:0.00023%,7.9608300000000005:0.00023%,1.46509:0.00023%,1.45709:0.00023%,-1.27347:0.00023%,-71.14931:0.00023%,-1.2708:0.00023%,0.31847:0.00023%]
[INFO] ** scada_tag:[3:25.94009%,1:21.04379%,5:18.21378%,4:17.47233%,2:17.32515%,0:0.00487%]
[INFO] ** service:[0.0048200000000000005:99.99745%,-211.73542999999998:0.00116%,-211.09762999999998:0.0007%,-186.43601999999998:0.00023%,-211.35747999999998:0.00023%,-211.08818:0.00023%]
[INFO] ** src:[22:38.3694%,9:25.94079%,7:18.21448%,1:17.47233%,14:0.00116%,3:0.0007%,15:0.00046%,21:0.00023%,4:0.00023%,2:0.00023%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1172 (0.27164%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/431448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0299 - tp: 78396.0000 - fp: 1604.0000 - tn: 318396.0000 - fn: 1604.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/431448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0291 - tp: 78437.0000 - fp: 1563.0000 - tn: 318437.0000 - fn: 1563.0000 - accuracy: 0.9922 - precision: 0.9805 - recall: 0.9805 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/431448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0296 - tp: 78390.0000 - fp: 1610.0000 - tn: 318390.0000 - fn: 1610.0000 - accuracy: 0.9919 - precision: 0.9799 - recall: 0.9799 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/431448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0287 - tp: 78446.0000 - fp: 1554.0000 - tn: 318446.0000 - fn: 1554.0000 - accuracy: 0.9922 - precision: 0.9806 - recall: 0.9806 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-49-50-batch-300000-400000
[INFO] processing batch 400000-500000/431448
[33m[INFO] epoch 5/100[0m
[33m[INFO] loading file 1-1/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99323%,30:0.00113%,22:0.00094%,17:0.00075%,31:0.00056%,26:0.00056%,7:0.00056%,23:0.00038%,18:0.00038%,0:0.00038%,28:0.00019%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:78.41614%,Single Stage Single Point:21.58386%]
[INFO] ** dst:[21:43.27272%,10:21.04063%,8:18.16321%,9:17.51611%,6:0.00151%,22:0.00113%,16:0.00113%,15:0.00113%,18:0.00056%,26:0.00038%,25:0.00038%,19:0.00038%,17:0.00038%,24:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99887%,0:0.00113%]
[INFO] ** i/f_name:[2:99.99887%,3:0.00113%]
[INFO] ** modbus_function_code:[0.02961:99.99323%,-33.760870000000004:0.00659%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99755%,11:49.99567%,0:0.00659%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99624%,2:0.00263%,1:0.00113%]
[INFO] ** proxy_src_ip:[18:38.40413%,20:25.90884%,13:18.1634%,6:17.51648%,11:0.00132%,10:0.00132%,17:0.00113%,14:0.00094%,1:0.00094%,7:0.00056%,21:0.00038%,16:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.90827%,-0.32151:21.03988%,-1.27613:18.16302%,-0.23351:17.51592%,-0.33484:17.36426%,-71.33197:0.00113%,-71.14931:0.00094%,-2.1481:0.00075%,-0.24151:0.00056%,-71.14798:0.00056%,-1.02014:0.00038%,-64.19493:0.00038%,-2.42942:0.00038%,4.44364:0.00038%,-43.76509:0.00019%,10.67005:0.00019%,4.29964:0.00019%,-5.08665:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,1.47576:0.00019%,1.46509:0.00019%,4.076980000000001:0.00019%,-58.032509999999995:0.00019%,-58.035180000000004:0.00019%,-1.2708:0.00019%,-1.27347:0.00019%,-5.1466400000000005:0.00019%,-68.79874000000001:0.00019%,14.253910000000001:0.00019%,1.45709:0.00019%]
[INFO] ** scada_tag:[3:25.90809%,1:21.03969%,5:18.16264%,4:17.51573%,2:17.36407%,0:0.00978%]
[INFO] ** service:[0.0048200000000000005:99.99398%,-211.73542999999998:0.00113%,-211.08818:0.00094%,-205.44247:0.00075%,-211.07873999999998:0.00075%,-211.09762999999998:0.00056%,-211.08346:0.00056%,-186.43601999999998:0.00056%,-186.44547:0.00038%,-185.9872:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.40413%,9:25.90884%,7:18.1634%,1:17.51648%,11:0.00132%,10:0.00132%,14:0.00113%,3:0.00094%,2:0.00094%,21:0.00056%,15:0.00038%,4:0.00038%,8:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1442 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4548 - tp: 73340.0000 - fp: 6660.0000 - tn: 313340.0000 - fn: 6660.0000 - accuracy: 0.9667 - precision: 0.9168 - recall: 0.9168 - auc: 0.9801 - val_loss: 0.0453 - val_tp: 19876.0000 - val_fp: 124.0000 - val_tn: 79876.0000 - val_fn: 124.0000 - val_accuracy: 0.9975 - val_precision: 0.9938 - val_recall: 0.9938 - val_auc: 0.9998
[INFO] saving weights to checkpoints/lstm-epoch-5-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0252 - tp: 79969.0000 - fp: 31.0000 - tn: 319969.0000 - fn: 31.0000 - accuracy: 0.9998 - precision: 0.9996 - recall: 0.9996 - auc: 1.0000 - val_loss: 7.0433e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0155 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0918e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0607 - tp: 46175.0000 - fp: 33825.0000 - tn: 286175.0000 - fn: 33825.0000 - accuracy: 0.8309 - precision: 0.5772 - recall: 0.5772 - auc: 0.8953 - val_loss: 0.5990 - val_tp: 10668.0000 - val_fp: 9332.0000 - val_tn: 70668.0000 - val_fn: 9332.0000 - val_accuracy: 0.8134 - val_precision: 0.5334 - val_recall: 0.5334 - val_auc: 0.8986
[INFO] saving weights to checkpoints/lstm-epoch-5-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5939 - tp: 47406.0000 - fp: 32594.0000 - tn: 287406.0000 - fn: 32594.0000 - accuracy: 0.8370 - precision: 0.5926 - recall: 0.5926 - auc: 0.9161 - val_loss: 0.5700 - val_tp: 12818.0000 - val_fp: 7182.0000 - val_tn: 72818.0000 - val_fn: 7182.0000 - val_accuracy: 0.8564 - val_precision: 0.6409 - val_recall: 0.6409 - val_auc: 0.9234
[INFO] saving weights to checkpoints/lstm-epoch-5-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 2-2/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99868%,7:0.00056%,30:0.00038%,31:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:71.62432%,Single Stage Single Point:28.37568%]
[INFO] ** dst:[21:43.31186%,10:21.0267%,8:18.14759%,9:17.51159%,22:0.00075%,16:0.00038%,15:0.00038%,2:0.00038%,24:0.00019%,18:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99868%,-33.760870000000004:0.00132%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99868%,0:0.00132%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99944%,1:0.00038%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.37741%,20:25.96171%,13:18.14759%,6:17.51178%,1:0.00056%,17:0.00038%,16:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.96096%,-0.32151:21.0267%,-1.27613:18.14721%,-0.23351:17.5114%,-0.33484:17.35071%,-71.33197:0.00038%,1.45709:0.00038%,1.46509:0.00019%,1.47576:0.00019%,12.60597:0.00019%,10.67005:0.00019%,-0.24950999999999998:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,4.076980000000001:0.00019%,-3.3787199999999995:0.00019%,4.29964:0.00019%,-1.27347:0.00019%]
[INFO] ** scada_tag:[3:25.96058%,1:21.0267%,5:18.14721%,4:17.51121%,2:17.35052%,0:0.00376%]
[INFO] ** service:[0.0048200000000000005:99.99868%,-211.09762999999998:0.00056%,-211.73542999999998:0.00038%,-211.35747999999998:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.37741%,9:25.96171%,7:18.14759%,1:17.51178%,3:0.00056%,14:0.00038%,21:0.00019%,15:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1446 (0.27209%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5802 - tp: 48809.0000 - fp: 31191.0000 - tn: 288809.0000 - fn: 31191.0000 - accuracy: 0.8440 - precision: 0.6101 - recall: 0.6101 - auc: 0.9218 - val_loss: 0.5445 - val_tp: 13334.0000 - val_fp: 6666.0000 - val_tn: 73334.0000 - val_fn: 6666.0000 - val_accuracy: 0.8667 - val_precision: 0.6667 - val_recall: 0.6667 - val_auc: 0.9370
[INFO] saving weights to checkpoints/lstm-epoch-5-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5535 - tp: 52885.0000 - fp: 27115.0000 - tn: 292885.0000 - fn: 27115.0000 - accuracy: 0.8644 - precision: 0.6611 - recall: 0.6611 - auc: 0.9339 - val_loss: 0.4026 - val_tp: 19872.0000 - val_fp: 128.0000 - val_tn: 79872.0000 - val_fn: 128.0000 - val_accuracy: 0.9974 - val_precision: 0.9936 - val_recall: 0.9936 - val_auc: 0.9997
[INFO] saving weights to checkpoints/lstm-epoch-5-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0509 - tp: 79988.0000 - fp: 12.0000 - tn: 319988.0000 - fn: 12.0000 - accuracy: 0.9999 - precision: 0.9998 - recall: 0.9998 - auc: 1.0000 - val_loss: 0.9567 - val_tp: 17800.0000 - val_fp: 2200.0000 - val_tn: 77800.0000 - val_fn: 2200.0000 - val_accuracy: 0.9560 - val_precision: 0.8900 - val_recall: 0.8900 - val_auc: 0.9322
[INFO] saving weights to checkpoints/lstm-epoch-5-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6430 - tp: 50372.0000 - fp: 29628.0000 - tn: 290372.0000 - fn: 29628.0000 - accuracy: 0.8519 - precision: 0.6296 - recall: 0.6296 - auc: 0.9248 - val_loss: 0.5234 - val_tp: 13775.0000 - val_fp: 6225.0000 - val_tn: 73775.0000 - val_fn: 6225.0000 - val_accuracy: 0.8755 - val_precision: 0.6888 - val_recall: 0.6888 - val_auc: 0.9428
[INFO] saving weights to checkpoints/lstm-epoch-5-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5259 - tp: 54171.0000 - fp: 25829.0000 - tn: 294171.0000 - fn: 25829.0000 - accuracy: 0.8709 - precision: 0.6771 - recall: 0.6771 - auc: 0.9417 - val_loss: 0.4533 - val_tp: 17952.0000 - val_fp: 2048.0000 - val_tn: 77952.0000 - val_fn: 2048.0000 - val_accuracy: 0.9590 - val_precision: 0.8976 - val_recall: 0.8976 - val_auc: 0.9753
[INFO] saving weights to checkpoints/lstm-epoch-5-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 3-3/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99134%,30:0.00226%,22:0.00113%,31:0.00094%,26:0.00094%,17:0.00094%,7:0.00075%,27:0.00038%,0:0.00038%,28:0.00019%,23:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:87.49793%,Single Stage Single Point:12.50207%]
[INFO] ** dst:[21:43.3049%,10:21.08899%,8:18.15493%,9:17.44159%,6:0.00226%,15:0.00151%,18:0.00132%,16:0.00132%,22:0.00094%,2:0.00038%,7:0.00038%,25:0.00038%,17:0.00038%,12:0.00019%,24:0.00019%,19:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99849%,0:0.00151%]
[INFO] ** i/f_name:[2:99.99849%,3:0.00151%]
[INFO] ** modbus_function_code:[0.02961:99.99134%,-33.760870000000004:0.00847%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99642%,11:49.99492%,0:0.00847%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99887%,2:0.00113%]
[INFO] ** proto:[0:99.99398%,2:0.00452%,1:0.00151%]
[INFO] ** proxy_src_ip:[18:38.41731%,20:25.97695%,13:18.15512%,6:17.44197%,17:0.00226%,1:0.00151%,14:0.00132%,7:0.00094%,11:0.00075%,10:0.00075%,21:0.00056%,16:0.00019%,15:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.9762%,-0.32151:21.0888%,-1.27613:18.15455%,-0.23351:17.44141%,-0.33484:17.32851%,-71.33197:0.00151%,-71.14931:0.00113%,-71.14798:0.00113%,-64.19493:0.00038%,-0.08551:0.00038%,1.45709:0.00038%,-0.24151:0.00038%,14.4699:0.00019%,4.29964:0.00019%,4.90362:0.00019%,10.192739999999999:0.00019%,-3.3787199999999995:0.00019%,13.86459:0.00019%,4.44364:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-5.08665:0.00019%,-58.035180000000004:0.00019%,4.076980000000001:0.00019%,-58.032509999999995:0.00019%,-1.27347:0.00019%,-1.2708:0.00019%,-1.02014:0.00019%,-5.1466400000000005:0.00019%,13.431270000000001:0.00019%,12.60597:0.00019%,1.47576:0.00019%,1.46509:0.00019%,14.253910000000001:0.00019%,-68.79874000000001:0.00019%,-0.24950999999999998:0.00019%,-2.1481:0.00019%,10.67005:0.00019%,-68.36943000000001:0.00019%]
[INFO] ** scada_tag:[3:25.97582%,1:21.08861%,5:18.15436%,4:17.44122%,2:17.32832%,0:0.01167%]
[INFO] ** service:[0.0048200000000000005:99.99153%,-211.73542999999998:0.00151%,-186.43601999999998:0.00132%,-211.08346:0.00113%,-211.08818:0.00113%,-205.44247:0.00094%,-211.09762999999998:0.00075%,-202.75898:0.00038%,-186.44547:0.00038%,-183.8612:0.00019%,-185.9872:0.00019%,-201.23771000000002:0.00019%,-211.35747999999998:0.00019%,-211.07873999999998:0.00019%]
[INFO] ** src:[22:38.41731%,9:25.97695%,7:18.15512%,1:17.44197%,21:0.00207%,3:0.00169%,2:0.00132%,11:0.00075%,10:0.00075%,4:0.00075%,14:0.00038%,8:0.00038%,17:0.00019%,15:0.00019%,13:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1443 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3266 - tp: 65218.0000 - fp: 14782.0000 - tn: 305218.0000 - fn: 14782.0000 - accuracy: 0.9261 - precision: 0.8152 - recall: 0.8152 - auc: 0.9806 - val_loss: 0.3655 - val_tp: 16518.0000 - val_fp: 3482.0000 - val_tn: 76518.0000 - val_fn: 3482.0000 - val_accuracy: 0.9304 - val_precision: 0.8259 - val_recall: 0.8259 - val_auc: 0.9796
[INFO] saving weights to checkpoints/lstm-epoch-5-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2304 - tp: 72216.0000 - fp: 7784.0000 - tn: 312216.0000 - fn: 7784.0000 - accuracy: 0.9611 - precision: 0.9027 - recall: 0.9027 - auc: 0.9931 - val_loss: 2.0314 - val_tp: 10322.0000 - val_fp: 9678.0000 - val_tn: 70322.0000 - val_fn: 9678.0000 - val_accuracy: 0.8064 - val_precision: 0.5161 - val_recall: 0.5161 - val_auc: 0.8497
[INFO] saving weights to checkpoints/lstm-epoch-5-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0359 - tp: 79640.0000 - fp: 360.0000 - tn: 319640.0000 - fn: 360.0000 - accuracy: 0.9982 - precision: 0.9955 - recall: 0.9955 - auc: 0.9992 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0158 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0139 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 4-4/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99774%,30:0.00132%,31:0.00038%,33:0.00019%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:91.76213%,Single Stage Single Point:8.23787%]
[INFO] ** dst:[21:43.35118%,10:20.9409%,8:18.17694%,9:17.52759%,15:0.00132%,22:0.00113%,18:0.00038%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99887%,0:0.00113%]
[INFO] ** i/f_name:[2:99.99868%,3:0.00132%]
[INFO] ** modbus_function_code:[0.02961:99.99774%,-33.760870000000004:0.00226%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99812%,0:0.00226%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99887%,2:0.00113%]
[INFO] ** proto:[0:99.99812%,1:0.00132%,2:0.00056%]
[INFO] ** proxy_src_ip:[18:38.25398%,20:26.03848%,13:18.17694%,6:17.52796%,17:0.00132%,21:0.00038%,16:0.00038%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.03773%,-0.32151:20.94071%,-1.27613:18.17657%,-0.23351:17.5274%,-0.33484:17.31326%,-71.33197:0.00132%,-1.02014:0.00038%,1.45709:0.00038%,-0.08551:0.00038%,-0.24151:0.00038%,14.4699:0.00019%,-1.2708:0.00019%,-71.14798:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-49.275529999999996:0.00019%]
[INFO] ** scada_tag:[3:26.03754%,1:20.94052%,5:18.17657%,4:17.52702%,2:17.31308%,0:0.00527%]
[INFO] ** service:[0.0048200000000000005:99.99793%,-211.73542999999998:0.00132%,-186.43601999999998:0.00038%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.25398%,9:26.03848%,7:18.17694%,1:17.52796%,21:0.00113%,15:0.00038%,4:0.00038%,17:0.00019%,14:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1453 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0124 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0109 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0098 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0085 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2024 - val_tp: 18508.0000 - val_fp: 1492.0000 - val_tn: 78508.0000 - val_fn: 1492.0000 - val_accuracy: 0.9702 - val_precision: 0.9254 - val_recall: 0.9254 - val_auc: 0.9534
[INFO] saving weights to checkpoints/lstm-epoch-5-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.5888 - tp: 47481.0000 - fp: 32519.0000 - tn: 287481.0000 - fn: 32519.0000 - accuracy: 0.8374 - precision: 0.5935 - recall: 0.5935 - auc: 0.8789 - val_loss: 0.8215 - val_tp: 7380.0000 - val_fp: 12620.0000 - val_tn: 67380.0000 - val_fn: 12620.0000 - val_accuracy: 0.7476 - val_precision: 0.3690 - val_recall: 0.3690 - val_auc: 0.8626
[INFO] saving weights to checkpoints/lstm-epoch-5-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 5-5/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99642%,30:0.00245%,37:0.00019%,26:0.00019%,12:0.00019%,9:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:89.39783%,Single Stage Single Point:10.60217%]
[INFO] ** dst:[21:43.36229%,10:20.76779%,8:18.24261%,9:17.62317%,15:0.00245%,22:0.00075%,25:0.00019%,24:0.00019%,6:0.00019%,2:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99793%,0:0.00207%]
[INFO] ** i/f_name:[2:99.99755%,3:0.00245%]
[INFO] ** modbus_function_code:[0.02961:99.99642%,-33.760870000000004:0.00358%]
[INFO] ** modbus_function_description:[7:49.99868%,11:49.99774%,0:0.00358%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99812%,2:0.00188%]
[INFO] ** proto:[0:99.99718%,1:0.00245%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.00108%,20:26.12899%,13:18.2428%,6:17.62336%,17:0.00245%,1:0.00038%,21:0.00019%,16:0.00019%,7:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.12861%,-0.32151:20.76741%,-1.27613:18.24261%,-0.23351:17.62298%,-0.33484:17.23367%,-71.33197:0.00245%,-0.24151:0.00038%,1.47576:0.00019%,-49.275529999999996:0.00019%,-1.27347:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,1.45709:0.00019%,2.22906:0.00019%,14.4699:0.00019%,-64.19493:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:26.12824%,1:20.76722%,5:18.24242%,4:17.62298%,2:17.23367%,0:0.00546%]
[INFO] ** service:[0.0048200000000000005:99.9968%,-211.73542999999998:0.00245%,-183.8612:0.00019%,-211.08346:0.00019%,-211.35747999999998:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.00108%,9:26.12899%,7:18.2428%,1:17.62336%,21:0.00207%,14:0.00056%,3:0.00038%,16:0.00019%,15:0.00019%,8:0.00019%,4:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1453 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3367 - tp: 72111.0000 - fp: 7889.0000 - tn: 312111.0000 - fn: 7889.0000 - accuracy: 0.9606 - precision: 0.9014 - recall: 0.9014 - auc: 0.9817 - val_loss: 0.7648 - val_tp: 12817.0000 - val_fp: 7183.0000 - val_tn: 72817.0000 - val_fn: 7183.0000 - val_accuracy: 0.8563 - val_precision: 0.6409 - val_recall: 0.6409 - val_auc: 0.9401
[INFO] saving weights to checkpoints/lstm-epoch-5-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3536 - tp: 62521.0000 - fp: 17479.0000 - tn: 302521.0000 - fn: 17479.0000 - accuracy: 0.9126 - precision: 0.7815 - recall: 0.7815 - auc: 0.9793 - val_loss: 0.0422 - val_tp: 19609.0000 - val_fp: 391.0000 - val_tn: 79609.0000 - val_fn: 391.0000 - val_accuracy: 0.9922 - val_precision: 0.9804 - val_recall: 0.9804 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-5-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2763 - tp: 69835.0000 - fp: 10165.0000 - tn: 309835.0000 - fn: 10165.0000 - accuracy: 0.9492 - precision: 0.8729 - recall: 0.8729 - auc: 0.9869 - val_loss: 0.1440 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0943 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0248 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0292 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0042 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 6-6/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99567%,30:0.00339%,31:0.00019%,27:0.00019%,26:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:92.39719%,Single Stage Single Point:7.60281%]
[INFO] ** dst:[21:43.37903%,10:20.72846%,8:18.28288%,9:17.60473%,15:0.00339%,22:0.00038%,25:0.00019%,24:0.00019%,18:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.9968%,0:0.0032%]
[INFO] ** i/f_name:[2:99.99661%,3:0.00339%]
[INFO] ** modbus_function_code:[0.02961:99.99567%,-33.760870000000004:0.00433%]
[INFO] ** modbus_function_description:[7:49.99831%,11:49.99737%,0:0.00433%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99567%,1:0.00339%,2:0.00094%]
[INFO] ** proxy_src_ip:[18:37.94219%,20:26.1655%,13:18.28307%,6:17.60492%,17:0.00339%,14:0.00056%,16:0.00019%,11:0.00019%]
[INFO] ** s_port:[1.45442:26.16512%,-0.32151:20.72846%,-1.27613:18.2825%,-0.23351:17.60454%,-0.33484:17.21373%,-71.33197:0.00339%,-71.14798:0.00019%,-1.02014:0.00019%,-64.19493:0.00019%,4.90362:0.00019%,-1.2708:0.00019%,-0.24151:0.00019%,13.431270000000001:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-68.36943000000001:0.00019%]
[INFO] ** scada_tag:[3:26.16493%,1:20.72827%,5:18.28232%,4:17.60417%,2:17.21354%,0:0.00677%]
[INFO] ** service:[0.0048200000000000005:99.99567%,-211.73542999999998:0.00339%,-211.08346:0.00019%,-201.23771000000002:0.00019%,-202.75898:0.00019%,-186.44547:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:37.94219%,9:26.1655%,7:18.28307%,1:17.60492%,14:0.00339%,2:0.00056%,15:0.00019%,10:0.00019%]
[INFO] ** type:[0:99.99906%,1:0.00094%]
[INFO] ** unixtime:1455 (0.27378%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0184 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0013 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0127 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3370e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0099 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7237e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0086 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7064e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4695 - tp: 64382.0000 - fp: 15618.0000 - tn: 304382.0000 - fn: 15618.0000 - accuracy: 0.9219 - precision: 0.8048 - recall: 0.8048 - auc: 0.9740 - val_loss: 0.1580 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 7-7/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99511%,30:0.00169%,22:0.00094%,17:0.00075%,26:0.00056%,31:0.00038%,28:0.00019%,27:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:81.6046%,Single Stage Single Point:18.3954%]
[INFO] ** dst:[21:43.36134%,10:20.74408%,8:18.25353%,9:17.63427%,15:0.00169%,22:0.00151%,6:0.00151%,16:0.00075%,24:0.00038%,18:0.00038%,17:0.00038%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99831%,0:0.00169%]
[INFO] ** i/f_name:[2:99.99831%,3:0.00169%]
[INFO] ** modbus_function_code:[0.02961:99.99511%,-33.760870000000004:0.00489%]
[INFO] ** modbus_function_description:[7:49.99831%,11:49.9968%,0:0.00489%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99624%,2:0.00207%,1:0.00169%]
[INFO] ** proxy_src_ip:[18:37.96853%,20:26.13765%,13:18.2539%,6:17.63446%,17:0.00169%,11:0.00075%,1:0.00075%,21:0.00056%,16:0.00056%,14:0.00038%,7:0.00038%,10:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.13671%,-0.32151:20.74408%,-1.27613:18.25334%,-0.23351:17.63409%,-0.33484:17.22445%,-71.33197:0.00169%,-71.14931:0.00094%,-1.02014:0.00056%,-71.14798:0.00056%,1.45709:0.00056%,-0.24151:0.00038%,-1.27347:0.00038%,1.47576:0.00019%,1.46509:0.00019%,14.253910000000001:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,-68.79874000000001:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,6.1115699999999995:0.00019%,-5.08665:0.00019%,-5.1466400000000005:0.00019%]
[INFO] ** scada_tag:[3:26.13633%,1:20.74408%,5:18.25315%,4:17.6339%,2:17.22445%,0:0.00809%]
[INFO] ** service:[0.0048200000000000005:99.99511%,-211.73542999999998:0.00169%,-211.08818:0.00094%,-205.44247:0.00075%,-211.08346:0.00056%,-186.43601999999998:0.00038%,-211.09762999999998:0.00019%,-185.9872:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:37.96853%,9:26.13765%,7:18.2539%,1:17.63446%,14:0.00169%,10:0.00075%,3:0.00075%,15:0.00056%,4:0.00056%,21:0.00038%,2:0.00038%,11:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1452 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0876 - tp: 76763.0000 - fp: 3237.0000 - tn: 316763.0000 - fn: 3237.0000 - accuracy: 0.9838 - precision: 0.9595 - recall: 0.9595 - auc: 0.9990 - val_loss: 0.0025 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-5-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0403 - tp: 78204.0000 - fp: 1796.0000 - tn: 318204.0000 - fn: 1796.0000 - accuracy: 0.9910 - precision: 0.9776 - recall: 0.9776 - auc: 0.9998 - val_loss: 0.0010 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-5-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1740 - tp: 75805.0000 - fp: 4195.0000 - tn: 315805.0000 - fn: 4195.0000 - accuracy: 0.9790 - precision: 0.9476 - recall: 0.9476 - auc: 0.9938 - val_loss: 0.8351 - val_tp: 12856.0000 - val_fp: 7144.0000 - val_tn: 72856.0000 - val_fn: 7144.0000 - val_accuracy: 0.8571 - val_precision: 0.6428 - val_recall: 0.6428 - val_auc: 0.9681
[INFO] saving weights to checkpoints/lstm-epoch-5-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1066 - tp: 77423.0000 - fp: 2577.0000 - tn: 317423.0000 - fn: 2577.0000 - accuracy: 0.9871 - precision: 0.9678 - recall: 0.9678 - auc: 0.9982 - val_loss: 0.0048 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.8508e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 8-8/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99699%,30:0.00113%,0:0.00056%,24:0.00019%,23:0.00019%,22:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:94.62262%,Single Stage Single Point:5.37738%]
[INFO] ** dst:[21:43.4272%,10:20.80975%,8:18.17901%,9:17.58027%,22:0.00132%,15:0.00113%,25:0.00056%,19:0.00038%,26:0.00019%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99925%,0:0.00075%]
[INFO] ** i/f_name:[2:99.99887%,3:0.00113%]
[INFO] ** modbus_function_code:[0.02961:99.99699%,-33.760870000000004:0.00282%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99737%,0:0.00282%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99962%,2:0.00038%]
[INFO] ** proto:[0:99.99812%,1:0.00113%,2:0.00075%]
[INFO] ** proxy_src_ip:[18:38.09686%,20:26.14066%,13:18.17826%,6:17.58065%,17:0.00113%,10:0.00113%,16:0.00056%,14:0.00038%,11:0.00019%,5:0.00019%]
[INFO] ** s_port:[1.45442:26.14009%,-0.32151:20.80975%,-1.27613:18.17807%,-0.23351:17.58008%,-0.33484:17.28711%,-71.33197:0.00113%,-15.039579999999999:0.00075%,-1.02014:0.00056%,-64.19493:0.00056%,1.45709:0.00038%,-0.24151:0.00038%,4.66896:0.00038%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-71.14931:0.00019%]
[INFO] ** scada_tag:[3:26.13972%,1:20.80956%,5:18.17807%,4:17.57989%,2:17.28692%,0:0.00583%]
[INFO] ** service:[0.0048200000000000005:99.99774%,-211.73542999999998:0.00113%,-186.44547:0.00056%,-211.07873999999998:0.00038%,-211.08818:0.00019%]
[INFO] ** src:[22:38.09686%,9:26.14066%,7:18.17826%,1:17.58065%,11:0.00113%,14:0.00075%,15:0.00056%,21:0.00038%,2:0.00038%,16:0.00019%,10:0.00019%]
[INFO] ** type:[0:99.99944%,1:0.00038%,2:0.00019%]
[INFO] ** unixtime:1456 (0.27397%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0145 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1029e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0121 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.8723e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0105 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2047e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0911 - tp: 78864.0000 - fp: 1136.0000 - tn: 318864.0000 - fn: 1136.0000 - accuracy: 0.9943 - precision: 0.9858 - recall: 0.9858 - auc: 0.9963 - val_loss: 0.5720 - val_tp: 16406.0000 - val_fp: 3594.0000 - val_tn: 76406.0000 - val_fn: 3594.0000 - val_accuracy: 0.9281 - val_precision: 0.8203 - val_recall: 0.8203 - val_auc: 0.9838
[INFO] saving weights to checkpoints/lstm-epoch-5-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3112 - tp: 66046.0000 - fp: 13954.0000 - tn: 306046.0000 - fn: 13954.0000 - accuracy: 0.9302 - precision: 0.8256 - recall: 0.8256 - auc: 0.9837 - val_loss: 0.2488 - val_tp: 16735.0000 - val_fp: 3265.0000 - val_tn: 76735.0000 - val_fn: 3265.0000 - val_accuracy: 0.9347 - val_precision: 0.8367 - val_recall: 0.8367 - val_auc: 0.9875
[INFO] saving weights to checkpoints/lstm-epoch-5-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 9-9/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99831%,30:0.00094%,31:0.00038%,26:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:95.26332%,Single Stage Single Point:4.73668%]
[INFO] ** dst:[21:43.36341%,10:20.77776%,8:18.28646%,9:17.56973%,15:0.00094%,22:0.00075%,18:0.00038%,25:0.00019%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99906%,0:0.00094%]
[INFO] ** i/f_name:[2:99.99906%,3:0.00094%]
[INFO] ** modbus_function_code:[0.02961:99.99831%,-33.760870000000004:0.00169%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99849%,0:0.00169%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99981%,2:0.00019%]
[INFO] ** proto:[0:99.99831%,1:0.00094%,2:0.00075%]
[INFO] ** proxy_src_ip:[18:38.01407%,20:26.12767%,13:18.28664%,6:17.56992%,17:0.00094%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.12692%,-0.32151:20.77776%,-1.27613:18.28627%,-0.23351:17.56955%,-0.33484:17.23631%,-71.33197:0.00094%,1.45709:0.00038%,-0.24151:0.00038%,-0.08551:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:26.12654%,1:20.77757%,5:18.28627%,4:17.56936%,2:17.23631%,0:0.00395%]
[INFO] ** service:[0.0048200000000000005:99.99831%,-211.73542999999998:0.00094%,-186.43601999999998:0.00038%,-211.08346:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.01407%,9:26.12767%,7:18.28664%,1:17.56992%,14:0.00075%,21:0.00019%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1454 (0.27359%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2473 - tp: 67203.0000 - fp: 12797.0000 - tn: 307203.0000 - fn: 12797.0000 - accuracy: 0.9360 - precision: 0.8400 - recall: 0.8400 - auc: 0.9868 - val_loss: 0.2263 - val_tp: 17115.0000 - val_fp: 2885.0000 - val_tn: 77115.0000 - val_fn: 2885.0000 - val_accuracy: 0.9423 - val_precision: 0.8558 - val_recall: 0.8558 - val_auc: 0.9886
[INFO] saving weights to checkpoints/lstm-epoch-5-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2079 - tp: 72846.0000 - fp: 7154.0000 - tn: 312846.0000 - fn: 7154.0000 - accuracy: 0.9642 - precision: 0.9106 - recall: 0.9106 - auc: 0.9924 - val_loss: 0.1050 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0354 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.1593e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0106 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.8132e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0086 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4860e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 10-10/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99605%,30:0.00188%,31:0.00038%,26:0.00019%,24:0.00019%,23:0.00019%,22:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:94.25174%,Single Stage Single Point:5.74826%]
[INFO] ** dst:[21:43.4097%,10:20.81107%,8:18.22605%,9:17.54904%,15:0.00188%,22:0.00056%,24:0.00038%,19:0.00038%,18:0.00038%,26:0.00019%,25:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99831%,0:0.00169%]
[INFO] ** i/f_name:[2:99.99812%,3:0.00188%]
[INFO] ** modbus_function_code:[0.02961:99.99605%,-33.760870000000004:0.00376%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99868%,11:49.99737%,0:0.00376%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99925%,1:0.00075%]
[INFO] ** proto:[0:99.99718%,1:0.00188%,2:0.00094%]
[INFO] ** proxy_src_ip:[18:38.09234%,20:26.1288%,13:18.22624%,6:17.54847%,17:0.00188%,10:0.00094%,14:0.00038%,21:0.00019%,16:0.00019%,5:0.00019%,2:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.12824%,-0.32151:20.81107%,-1.27613:18.22568%,-0.23351:17.5481%,-0.33484:17.28128%,-71.33197:0.00188%,-10.51843:0.00075%,-0.08551:0.00038%,-1.27347:0.00038%,5.71692:0.00038%,1.47576:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-71.14931:0.00019%,-64.19493:0.00019%,1.45709:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:26.12786%,1:20.81088%,5:18.22568%,4:17.54791%,2:17.28109%,0:0.00659%]
[INFO] ** service:[0.0048200000000000005:99.9968%,-211.73542999999998:0.00188%,-211.07873999999998:0.00038%,-186.43601999999998:0.00038%,-211.08346:0.00019%,-186.44547:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.09234%,9:26.1288%,7:18.22624%,1:17.54847%,14:0.00188%,11:0.00094%,2:0.00038%,17:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,4:0.00019%]
[INFO] ** type:[0:99.99849%,1:0.00132%,2:0.00019%]
[INFO] ** unixtime:1452 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0074 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2408e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0066 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.6307e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5471 - tp: 58079.0000 - fp: 21921.0000 - tn: 298079.0000 - fn: 21921.0000 - accuracy: 0.8904 - precision: 0.7260 - recall: 0.7260 - auc: 0.9662 - val_loss: 0.2169 - val_tp: 17212.0000 - val_fp: 2788.0000 - val_tn: 77212.0000 - val_fn: 2788.0000 - val_accuracy: 0.9442 - val_precision: 0.8606 - val_recall: 0.8606 - val_auc: 0.9909
[INFO] saving weights to checkpoints/lstm-epoch-5-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1611 - tp: 79223.0000 - fp: 777.0000 - tn: 319223.0000 - fn: 777.0000 - accuracy: 0.9961 - precision: 0.9903 - recall: 0.9903 - auc: 0.9992 - val_loss: 0.0869 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0285 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0041 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 11-11/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99887%,31:0.00038%,30:0.00038%,26:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.38298%,10:20.87617%,8:18.20178%,9:17.53662%,22:0.00132%,18:0.00038%,15:0.00038%,25:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99887%,-33.760870000000004:0.00113%]
[INFO] ** modbus_function_description:[7:50.00056%,11:49.99831%,0:0.00113%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99887%,2:0.00075%,1:0.00038%]
[INFO] ** proxy_src_ip:[18:38.14371%,20:26.11582%,13:18.20178%,6:17.53699%,16:0.00056%,17:0.00038%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.11525%,-0.32151:20.87617%,-1.27613:18.20159%,-0.23351:17.53643%,-0.33484:17.26754%,-0.24151:0.00056%,-1.02014:0.00056%,-0.08551:0.00038%,-71.33197:0.00038%,-71.14798:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:26.11488%,1:20.87617%,5:18.2014%,4:17.53605%,2:17.26735%,0:0.00414%]
[INFO] ** service:[0.0048200000000000005:99.99887%,-211.73542999999998:0.00038%,-186.43601999999998:0.00038%,-211.08346:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.14371%,9:26.11582%,7:18.20178%,1:17.53699%,15:0.00056%,14:0.00038%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1453 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0127 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0018 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0106 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.5840e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0090 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0061e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0079 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3879e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0075 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.6625e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 12-12/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99774%,30:0.00207%,9:0.00019%]
[INFO] ** classification:[normal:93.19011%,Single Stage Single Point:6.80989%]
[INFO] ** dst:[21:43.39672%,10:20.87542%,8:18.19011%,9:17.53455%,15:0.00207%,22:0.00056%,24:0.00038%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99831%,0:0.00169%]
[INFO] ** i/f_name:[2:99.99793%,3:0.00207%]
[INFO] ** modbus_function_code:[0.02961:99.99774%,-33.760870000000004:0.00226%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99812%,0:0.00226%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99831%,2:0.00169%]
[INFO] ** proto:[0:99.99793%,1:0.00207%]
[INFO] ** proxy_src_ip:[18:38.14729%,20:26.12523%,13:18.1903%,6:17.53474%,17:0.00207%,16:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:26.12466%,-0.32151:20.87542%,-1.27613:18.18974%,-0.23351:17.53436%,-0.33484:17.27187%,-71.33197:0.00207%,-1.27347:0.00038%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,14.4699:0.00019%]
[INFO] ** scada_tag:[3:26.12429%,1:20.87542%,5:18.18974%,4:17.53398%,2:17.27187%,0:0.0047%]
[INFO] ** service:[0.0048200000000000005:99.99774%,-211.73542999999998:0.00207%,-183.8612:0.00019%]
[INFO] ** src:[22:38.14729%,9:26.12523%,7:18.1903%,1:17.53474%,21:0.00169%,14:0.00038%,15:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1453 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0068 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6805e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0061 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0251e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6543 - tp: 62597.0000 - fp: 17403.0000 - tn: 302597.0000 - fn: 17403.0000 - accuracy: 0.9130 - precision: 0.7825 - recall: 0.7825 - auc: 0.9530 - val_loss: 0.3325 - val_tp: 18060.0000 - val_fp: 1940.0000 - val_tn: 78060.0000 - val_fn: 1940.0000 - val_accuracy: 0.9612 - val_precision: 0.9030 - val_recall: 0.9030 - val_auc: 0.9904
[INFO] saving weights to checkpoints/lstm-epoch-5-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3076 - tp: 71190.0000 - fp: 8810.0000 - tn: 311190.0000 - fn: 8810.0000 - accuracy: 0.9560 - precision: 0.8899 - recall: 0.8899 - auc: 0.9872 - val_loss: 0.1469 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0879 - tp: 79987.0000 - fp: 13.0000 - tn: 319987.0000 - fn: 13.0000 - accuracy: 0.9999 - precision: 0.9998 - recall: 0.9998 - auc: 1.0000 - val_loss: 0.0592 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 13-13/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99642%,31:0.00075%,26:0.00056%,0:0.00056%,30:0.00038%,22:0.00038%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:85.60292%,Single Stage Single Point:14.39708%]
[INFO] ** dst:[21:43.35457%,10:20.79921%,8:18.28025%,9:17.56183%,22:0.00113%,6:0.00094%,18:0.00075%,25:0.00056%,15:0.00038%,24:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99642%,-33.760870000000004:0.00339%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99868%,11:49.99774%,0:0.00339%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99718%,2:0.00245%,1:0.00038%]
[INFO] ** proxy_src_ip:[18:38.05114%,20:26.10302%,13:18.28043%,6:17.56127%,10:0.00113%,11:0.00094%,16:0.00056%,17:0.00038%,7:0.00038%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.10246%,-0.32151:20.79921%,-1.27613:18.28006%,-0.23351:17.56089%,-0.33484:17.25192%,-9.78512:0.00075%,-64.19493:0.00056%,-1.02014:0.00056%,-71.14798:0.00056%,-0.24151:0.00038%,-71.14931:0.00038%,-0.08551:0.00038%,-71.33197:0.00038%,1.47576:0.00019%,-1.27347:0.00019%,1.46509:0.00019%,-1.2708:0.00019%,-68.79874000000001:0.00019%,6.1115699999999995:0.00019%,14.540560000000001:0.00019%,1.45709:0.00019%]
[INFO] ** scada_tag:[3:26.10208%,1:20.79902%,5:18.28006%,4:17.56089%,2:17.25173%,0:0.00621%]
[INFO] ** service:[0.0048200000000000005:99.99718%,-186.43601999999998:0.00075%,-211.08346:0.00056%,-186.44547:0.00056%,-211.73542999999998:0.00038%,-211.08818:0.00038%,-202.75898:0.00019%]
[INFO] ** src:[22:38.05114%,9:26.10302%,7:18.28043%,1:17.56127%,11:0.00113%,10:0.00094%,15:0.00056%,21:0.00038%,14:0.00038%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1452 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0438 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0407 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0351 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0296 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0262 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0228 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5969 - tp: 62669.0000 - fp: 17331.0000 - tn: 302669.0000 - fn: 17331.0000 - accuracy: 0.9133 - precision: 0.7834 - recall: 0.7834 - auc: 0.9588 - val_loss: 0.1696 - val_tp: 19571.0000 - val_fp: 429.0000 - val_tn: 79571.0000 - val_fn: 429.0000 - val_accuracy: 0.9914 - val_precision: 0.9786 - val_recall: 0.9786 - val_auc: 0.9995
[INFO] saving weights to checkpoints/lstm-epoch-5-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1308 - tp: 77290.0000 - fp: 2710.0000 - tn: 317290.0000 - fn: 2710.0000 - accuracy: 0.9865 - precision: 0.9661 - recall: 0.9661 - auc: 0.9942 - val_loss: 0.0343 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 14-14/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99962%,30:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:94.60248%,Single Stage Single Point:5.39752%]
[INFO] ** dst:[21:43.34629%,10:20.80994%,8:18.26651%,9:17.57576%,22:0.00075%,24:0.00038%,15:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99962%,-33.760870000000004:0.00038%]
[INFO] ** modbus_function_description:[7:50.00075%,11:49.99887%,0:0.00038%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99981%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.04775%,20:26.10905%,13:18.2667%,6:17.57594%,17:0.00019%,16:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:26.10829%,-0.32151:20.80994%,-1.27613:18.26613%,-0.23351:17.57557%,-0.33484:17.23781%,-1.27347:0.00038%,1.45709:0.00038%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,14.4699:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:26.10792%,1:20.80994%,5:18.26595%,4:17.57519%,2:17.23762%,0:0.00339%]
[INFO] ** service:[0.0048200000000000005:99.99962%,-183.8612:0.00019%,-211.73542999999998:0.00019%]
[INFO] ** src:[22:38.04775%,9:26.10905%,7:18.2667%,1:17.57594%,15:0.00019%,14:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1452 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1375 - tp: 77199.0000 - fp: 2801.0000 - tn: 317199.0000 - fn: 2801.0000 - accuracy: 0.9860 - precision: 0.9650 - recall: 0.9650 - auc: 0.9931 - val_loss: 3.3241 - val_tp: 12830.0000 - val_fp: 7170.0000 - val_tn: 72830.0000 - val_fn: 7170.0000 - val_accuracy: 0.8566 - val_precision: 0.6415 - val_recall: 0.6415 - val_auc: 0.7496
[INFO] saving weights to checkpoints/lstm-epoch-5-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1345 - tp: 78719.0000 - fp: 1281.0000 - tn: 318719.0000 - fn: 1281.0000 - accuracy: 0.9936 - precision: 0.9840 - recall: 0.9840 - auc: 0.9932 - val_loss: 0.0250 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0232 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0195 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0186 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0164 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0159 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0141 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 15-15/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99624%,30:0.00301%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:89.60764%,Single Stage Multi Point:10.39161%,Single Stage Single Point:0.00075%]
[INFO] ** dst:[21:43.29963%,10:20.774%,8:18.31355%,9:17.60756%,15:0.00301%,22:0.00151%,25:0.00019%,24:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99699%,0:0.00301%]
[INFO] ** i/f_name:[2:99.99699%,3:0.00301%]
[INFO] ** modbus_function_code:[0.02961:99.99624%,-33.760870000000004:0.00376%]
[INFO] ** modbus_function_description:[7:49.99906%,11:49.99718%,0:0.00376%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99718%,2:0.00282%]
[INFO] ** proto:[0:99.99661%,1:0.00301%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.00579%,20:26.0684%,13:18.31336%,6:17.60812%,17:0.00301%,16:0.00056%,7:0.00038%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.06765%,-0.32151:20.77381%,-1.27613:18.31317%,-0.23351:17.60737%,-0.33484:17.23198%,-71.33197:0.00301%,-0.24151:0.00056%,-1.02014:0.00056%,1.45709:0.00038%,1.46509:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,-61.95768:0.00019%,10.192739999999999:0.00019%,-64.19493:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:26.06727%,1:20.77362%,5:18.31317%,4:17.60699%,2:17.23179%,0:0.00715%]
[INFO] ** service:[0.0048200000000000005:99.99642%,-211.73542999999998:0.00301%,-211.08346:0.00019%,-205.44247:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.00579%,9:26.0684%,7:18.31336%,1:17.60812%,21:0.0032%,15:0.00056%,16:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1461 (0.27491%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0139 - tp: 79996.0000 - fp: 4.0000 - tn: 319996.0000 - fn: 4.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 0.0120 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0116 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0105 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0100 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0087 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0085 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0076 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.2698 - tp: 48900.0000 - fp: 31100.0000 - tn: 288900.0000 - fn: 31100.0000 - accuracy: 0.8445 - precision: 0.6112 - recall: 0.6112 - auc: 0.7409 - val_loss: 7.5541 - val_tp: 10630.0000 - val_fp: 9370.0000 - val_tn: 70630.0000 - val_fn: 9370.0000 - val_accuracy: 0.8126 - val_precision: 0.5315 - val_recall: 0.5315 - val_auc: 0.6891
[INFO] saving weights to checkpoints/lstm-epoch-5-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 16-16/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (471138, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (471138, 17)

[INFO] analyzing data
[INFO] 471138 rows
[INFO] ** appi_name:[21:99.9983%,30:0.00149%,33:0.00021%]
[INFO] ** classification:[normal:82.32683%,Single Stage Multi Point:17.67317%]
[INFO] ** dst:[21:43.35312%,10:20.80049%,8:18.2507%,9:17.59272%,15:0.00149%,22:0.00127%,24:0.00021%]
[INFO] ** i/f_dir:[1:99.99851%,0:0.00149%]
[INFO] ** i/f_name:[2:99.99851%,3:0.00149%]
[INFO] ** modbus_function_code:[0.02961:99.9983%,-33.760870000000004:0.0017%]
[INFO] ** modbus_function_description:[7:50.00042%,11:49.99788%,0:0.0017%]
[INFO] ** modbus_transaction_id:65536 (13.91015%)
[INFO] ** orig:[0:99.99851%,2:0.00149%]
[INFO] ** proto:[0:99.99851%,1:0.00149%]
[INFO] ** proxy_src_ip:[18:38.0483%,20:26.10551%,13:18.25113%,6:17.59293%,17:0.00149%,16:0.00042%,21:0.00021%]
[INFO] ** s_port:[1.45442:26.10488%,-0.32151:20.80028%,-1.27613:18.2507%,-0.23351:17.59251%,-0.33484:17.24802%,-71.33197:0.00149%,1.45709:0.00042%,-0.24151:0.00042%,-1.02014:0.00042%,-1.27347:0.00021%,1.47576:0.00021%,-49.275529999999996:0.00021%,-1.2708:0.00021%]
[INFO] ** scada_tag:[3:26.10445%,1:20.80028%,5:18.25049%,4:17.59209%,2:17.24781%,0:0.00488%]
[INFO] ** service:[0.0048200000000000005:99.99851%,-211.73542999999998:0.00149%]
[INFO] ** src:[22:38.0483%,9:26.10551%,7:18.25113%,1:17.59293%,21:0.00149%,15:0.00042%,4:0.00021%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1289 (0.27359%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/471138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5645 - tp: 42469.0000 - fp: 37531.0000 - tn: 282469.0000 - fn: 37531.0000 - accuracy: 0.8123 - precision: 0.5309 - recall: 0.5309 - auc: 0.6875 - val_loss: 7.5451 - val_tp: 10641.0000 - val_fp: 9359.0000 - val_tn: 70641.0000 - val_fn: 9359.0000 - val_accuracy: 0.8128 - val_precision: 0.5321 - val_recall: 0.5321 - val_auc: 0.6894
[INFO] saving weights to checkpoints/lstm-epoch-5-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/471138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.3316 - tp: 43625.0000 - fp: 36375.0000 - tn: 283625.0000 - fn: 36375.0000 - accuracy: 0.8181 - precision: 0.5453 - recall: 0.5453 - auc: 0.6971 - val_loss: 0.0063 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/471138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0061 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0054 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/471138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0053 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0047 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/471138
[33m[INFO] loading file 17-17/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571138, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571138, 17)

[INFO] analyzing data
[INFO] 571138 rows
[INFO] ** appi_name:[21:99.9972%,7:0.00053%,26:0.00035%,0:0.00035%,33:0.00018%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.5985%,Multi Stage Multi Point:5.4015%]
[INFO] ** dst:[21:43.35257%,10:20.84172%,8:18.20348%,9:17.59942%,22:0.0007%,6:0.00053%,25:0.00035%,16:0.00035%,2:0.00035%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.9972%,-33.760870000000004:0.00263%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99965%,11:49.99755%,0:0.00263%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.47463%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99877%,2:0.00123%]
[INFO] ** proxy_src_ip:[18:38.07871%,20:26.11611%,13:18.20296%,6:17.59925%,10:0.00105%,11:0.00088%,1:0.00035%,21:0.00018%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.11523%,-0.32151:20.84155%,-1.27613:18.20261%,-0.23351:17.59907%,-0.33484:17.23717%,6.0369:0.0007%,1.47576:0.00035%,-71.14798:0.00035%,1.45709:0.00035%,-64.19493:0.00035%,1.46509:0.00018%,-68.79874000000001:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,6.15557:0.00018%,6.06224:0.00018%,8.55414:0.00018%,-3.3787199999999995:0.00018%,-4.3880099999999995:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.11505%,1:20.84137%,5:18.20243%,4:17.59855%,2:17.23717%,0:0.00543%]
[INFO] ** service:[0.0048200000000000005:99.99807%,-211.09762999999998:0.00053%,-211.08346:0.00035%,-186.44547:0.00035%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.07871%,9:26.11611%,7:18.20296%,1:17.59925%,11:0.00105%,10:0.00088%,3:0.00035%,21:0.00018%,15:0.00018%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1560 (0.27314%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0046 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0041 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0039 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0035 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0035 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0031 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.1429 - tp: 74342.0000 - fp: 5658.0000 - tn: 314342.0000 - fn: 5658.0000 - accuracy: 0.9717 - precision: 0.9293 - recall: 0.9293 - auc: 0.9481 - val_loss: 2.9394 - val_tp: 16356.0000 - val_fp: 3644.0000 - val_tn: 76356.0000 - val_fn: 3644.0000 - val_accuracy: 0.9271 - val_precision: 0.8178 - val_recall: 0.8178 - val_auc: 0.8664
[INFO] saving weights to checkpoints/lstm-epoch-5-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9196 - tp: 65522.0000 - fp: 14478.0000 - tn: 305522.0000 - fn: 14478.0000 - accuracy: 0.9276 - precision: 0.8190 - recall: 0.8190 - auc: 0.8672 - val_loss: 2.9246 - val_tp: 16374.0000 - val_fp: 3626.0000 - val_tn: 76374.0000 - val_fn: 3626.0000 - val_accuracy: 0.9275 - val_precision: 0.8187 - val_recall: 0.8187 - val_auc: 0.8670
[INFO] saving weights to checkpoints/lstm-epoch-5-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/571138
[33m[INFO] loading file 18-18/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571138, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571138, 17)

[INFO] analyzing data
[INFO] 571138 rows
[INFO] ** appi_name:[21:99.99825%,30:0.00053%,7:0.00053%,31:0.00018%,27:0.00018%,22:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:82.41371%,Multi Stage Multi Point:17.58629%]
[INFO] ** dst:[21:43.34224%,10:20.83279%,8:18.25881%,9:17.56336%,22:0.0007%,15:0.00053%,24:0.00035%,16:0.00035%,2:0.00035%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99947%,0:0.00053%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99825%,-33.760870000000004:0.00175%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99825%,0:0.00175%]
[INFO] ** modbus_transaction_id:65536 (11.47463%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99895%,2:0.00053%,1:0.00053%]
[INFO] ** proxy_src_ip:[18:38.08029%,20:26.09527%,13:18.25916%,6:17.56353%,17:0.00053%,11:0.00053%,1:0.00035%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.09457%,-0.32151:20.83279%,-1.27613:18.25863%,-0.23351:17.56318%,-0.33484:17.2475%,-71.33197:0.00053%,-1.27347:0.00035%,1.45709:0.00035%,-0.24151:0.00035%,1.47576:0.00018%,1.46509:0.00018%,3.6236699999999997:0.00018%,-1.2708:0.00018%,-2.48275:0.00018%,6.06224:0.00018%,-3.3787199999999995:0.00018%,8.10082:0.00018%,6.45955:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.09422%,1:20.83262%,5:18.25846%,4:17.56301%,2:17.24732%,0:0.00438%]
[INFO] ** service:[0.0048200000000000005:99.99825%,-211.09762999999998:0.00053%,-211.73542999999998:0.00053%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.08029%,9:26.09527%,7:18.25916%,1:17.56353%,14:0.00053%,10:0.00053%,3:0.00035%,21:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1561 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6962 - tp: 76556.0000 - fp: 3444.0000 - tn: 316556.0000 - fn: 3444.0000 - accuracy: 0.9828 - precision: 0.9570 - recall: 0.9570 - auc: 0.9700 - val_loss: 2.8345 - val_tp: 16485.0000 - val_fp: 3515.0000 - val_tn: 76485.0000 - val_fn: 3515.0000 - val_accuracy: 0.9297 - val_precision: 0.8242 - val_recall: 0.8242 - val_auc: 0.8901
[INFO] saving weights to checkpoints/lstm-epoch-5-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1203 - tp: 49629.0000 - fp: 30371.0000 - tn: 289629.0000 - fn: 30371.0000 - accuracy: 0.8481 - precision: 0.6204 - recall: 0.6204 - auc: 0.7627 - val_loss: 6.1631 - val_tp: 12354.0000 - val_fp: 7646.0000 - val_tn: 72354.0000 - val_fn: 7646.0000 - val_accuracy: 0.8471 - val_precision: 0.6177 - val_recall: 0.6177 - val_auc: 0.7611
[INFO] saving weights to checkpoints/lstm-epoch-5-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1329 - tp: 49566.0000 - fp: 30434.0000 - tn: 289566.0000 - fn: 30434.0000 - accuracy: 0.8478 - precision: 0.6196 - recall: 0.6196 - auc: 0.7622 - val_loss: 6.0993 - val_tp: 12433.0000 - val_fp: 7567.0000 - val_tn: 72433.0000 - val_fn: 7567.0000 - val_accuracy: 0.8487 - val_precision: 0.6216 - val_recall: 0.6216 - val_auc: 0.7635
[INFO] saving weights to checkpoints/lstm-epoch-5-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.5201 - tp: 62535.0000 - fp: 17465.0000 - tn: 302535.0000 - fn: 17465.0000 - accuracy: 0.9127 - precision: 0.7817 - recall: 0.7817 - auc: 0.8636 - val_loss: 0.0016 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0015 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0014 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/571138
[33m[INFO] loading file 19-19/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571138, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571138, 17)

[INFO] analyzing data
[INFO] 571138 rows
[INFO] ** appi_name:[21:99.99807%,26:0.00035%,0:0.00035%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:87.47063%,Single Stage Multi Point:12.52937%]
[INFO] ** dst:[21:43.39161%,10:20.82439%,8:18.20803%,9:17.57334%,22:0.00123%,6:0.00053%,25:0.00035%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99807%,-33.760870000000004:0.00175%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99807%,0:0.00175%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.47463%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99877%,2:0.00123%]
[INFO] ** proxy_src_ip:[18:38.1118%,20:26.10437%,13:18.20803%,6:17.57334%,10:0.00105%,11:0.00088%,16:0.00053%]
[INFO] ** s_port:[1.45442:26.10332%,-0.32151:20.82439%,-1.27613:18.20768%,-0.23351:17.57316%,-0.33484:17.28742%,-5.20264:0.0007%,1.45709:0.00053%,-1.02014:0.00053%,-64.19493:0.00035%,-71.14798:0.00035%,1.46509:0.00035%,-1.27347:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-71.14931:0.00018%,-68.79874000000001:0.00018%,0.75578:0.00018%]
[INFO] ** scada_tag:[3:26.10297%,1:20.82421%,5:18.20751%,4:17.57299%,2:17.28724%,0:0.00508%]
[INFO] ** service:[0.0048200000000000005:99.99877%,-211.08346:0.00035%,-186.44547:0.00035%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.1118%,9:26.10437%,7:18.20803%,1:17.57334%,11:0.00105%,10:0.00088%,15:0.00053%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1562 (0.27349%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0014 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0012 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0012 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0010 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.2437e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.0090e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9824 - val_tp: 16300.0000 - val_fp: 3700.0000 - val_tn: 76300.0000 - val_fn: 3700.0000 - val_accuracy: 0.9260 - val_precision: 0.8150 - val_recall: 0.8150 - val_auc: 0.8844
[INFO] saving weights to checkpoints/lstm-epoch-5-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.8232 - tp: 31244.0000 - fp: 48756.0000 - tn: 271244.0000 - fn: 48756.0000 - accuracy: 0.7562 - precision: 0.3905 - recall: 0.3905 - auc: 0.6191 - val_loss: 9.8667 - val_tp: 7757.0000 - val_fp: 12243.0000 - val_tn: 67757.0000 - val_fn: 12243.0000 - val_accuracy: 0.7551 - val_precision: 0.3878 - val_recall: 0.3878 - val_auc: 0.6174
[INFO] saving weights to checkpoints/lstm-epoch-5-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/571138
[33m[INFO] loading file 20-20/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571138, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571138, 17)

[INFO] analyzing data
[INFO] 571138 rows
[INFO] ** appi_name:[21:99.99667%,30:0.0028%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:91.62374%,Single Stage Multi Point:8.37626%]
[INFO] ** dst:[21:43.42313%,10:20.8377%,8:18.16006%,9:17.57421%,15:0.0028%,22:0.00123%,24:0.00035%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99755%,0:0.00245%]
[INFO] ** i/f_name:[2:99.9972%,3:0.0028%]
[INFO] ** modbus_function_code:[0.02961:99.99667%,-33.760870000000004:0.00333%]
[INFO] ** modbus_function_description:[7:49.99982%,11:49.99685%,0:0.00333%]
[INFO] ** modbus_transaction_id:65536 (11.47463%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99667%,1:0.0028%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.11303%,20:26.1485%,13:18.16023%,6:17.57474%,17:0.0028%,14:0.00053%,16:0.00018%]
[INFO] ** s_port:[1.45442:26.14762%,-0.32151:20.8377%,-1.27613:18.15971%,-0.23351:17.57404%,-0.33484:17.27533%,-71.33197:0.0028%,1.45709:0.00053%,-0.24151:0.00053%,-1.27347:0.00035%,13.431270000000001:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-71.14798:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:26.1471%,1:20.83752%,5:18.15971%,4:17.57369%,2:17.27516%,0:0.00683%]
[INFO] ** service:[0.0048200000000000005:99.99667%,-211.73542999999998:0.0028%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.11303%,9:26.1485%,7:18.16023%,1:17.57474%,14:0.0028%,2:0.00053%,15:0.00018%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1561 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3830 - tp: 73139.0000 - fp: 6861.0000 - tn: 313139.0000 - fn: 6861.0000 - accuracy: 0.9657 - precision: 0.9142 - recall: 0.9142 - auc: 0.9464 - val_loss: 7.1530e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.8867 - tp: 70639.0000 - fp: 9361.0000 - tn: 310639.0000 - fn: 9361.0000 - accuracy: 0.9532 - precision: 0.8830 - recall: 0.8830 - auc: 0.9269 - val_loss: 2.9228 - val_tp: 16374.0000 - val_fp: 3626.0000 - val_tn: 76374.0000 - val_fn: 3626.0000 - val_accuracy: 0.9275 - val_precision: 0.8187 - val_recall: 0.8187 - val_auc: 0.8867
[INFO] saving weights to checkpoints/lstm-epoch-5-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9575 - tp: 65324.0000 - fp: 14676.0000 - tn: 305324.0000 - fn: 14676.0000 - accuracy: 0.9266 - precision: 0.8166 - recall: 0.8166 - auc: 0.8853 - val_loss: 2.9082 - val_tp: 16392.0000 - val_fp: 3608.0000 - val_tn: 76392.0000 - val_fn: 3608.0000 - val_accuracy: 0.9278 - val_precision: 0.8196 - val_recall: 0.8196 - val_auc: 0.8873
[INFO] saving weights to checkpoints/lstm-epoch-5-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.9565 - tp: 70292.0000 - fp: 9708.0000 - tn: 310292.0000 - fn: 9708.0000 - accuracy: 0.9515 - precision: 0.8787 - recall: 0.8787 - auc: 0.9242 - val_loss: 4.7278e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.5914e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.1408e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/571138
[33m[INFO] loading file 21-21/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571136, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571136, 17)

[INFO] analyzing data
[INFO] 571136 rows
[INFO] ** appi_name:[21:99.99615%,30:0.00105%,7:0.00053%,26:0.00035%,22:0.00035%,0:0.00035%,31:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:98.93143%,Multi Stage Single Point:1.06857%]
[INFO] ** dst:[21:43.31718%,10:20.98029%,8:18.16275%,9:17.53505%,15:0.00105%,22:0.00088%,24:0.0007%,6:0.0007%,25:0.00035%,16:0.00035%,2:0.00035%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99895%,0:0.00105%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99615%,-33.760870000000004:0.00368%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99912%,11:49.99702%,0:0.00368%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.47468%)
[INFO] ** orig:[0:99.9993%,2:0.0007%]
[INFO] ** proto:[0:99.99755%,2:0.0014%,1:0.00105%]
[INFO] ** proxy_src_ip:[18:38.30594%,20:25.99136%,13:18.16345%,6:17.53488%,17:0.00105%,10:0.00105%,11:0.00088%,16:0.00053%,1:0.00035%,21:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.99066%,-0.32151:20.97959%,-1.27613:18.16257%,-0.23351:17.5347%,-0.33484:17.32635%,-71.33197:0.00105%,-1.27347:0.0007%,-6.64392:0.0007%,-1.02014:0.00053%,-64.19493:0.00035%,-71.14931:0.00035%,-71.14798:0.00035%,1.47576:0.00035%,1.46509:0.00018%,-1.2708:0.00018%,6.62488:0.00018%,10.15141:0.00018%,-68.79874000000001:0.00018%,7.060860000000001:0.00018%,-3.3787199999999995:0.00018%,-2.2440900000000004:0.00018%,1.45709:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.99013%,1:20.97942%,5:18.1624%,4:17.53435%,2:17.32635%,0:0.00735%]
[INFO] ** service:[0.0048200000000000005:99.99685%,-211.73542999999998:0.00105%,-211.09762999999998:0.00053%,-211.08346:0.00035%,-186.44547:0.00035%,-211.08818:0.00035%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.30594%,9:25.99136%,7:18.16345%,1:17.53488%,11:0.00105%,21:0.00088%,10:0.00088%,15:0.00053%,14:0.00035%,3:0.00035%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1556 (0.27244%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571136
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.0312e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5838e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/571136
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.5230e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1640e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/571136
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.0959e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7912e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/571136
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.7223e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4555e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/571136
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.4033e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1632e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/571136
[33m[INFO] loading file 22-22/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (340177, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (340177, 17)

[INFO] analyzing data
[INFO] 340177 rows
[INFO] ** appi_name:[21:99.99265%,30:0.00647%,23:0.00029%,22:0.00029%,18:0.00029%]
[INFO] ** classification:[normal:61.0344%,Multi Stage Single Point:38.9656%]
[INFO] ** dst:[21:43.31392%,10:21.00171%,8:18.09911%,9:17.57673%,15:0.00647%,22:0.00118%,19:0.00059%,26:0.00029%]
[INFO] ** i/f_dir:[1:99.99383%,0:0.00617%]
[INFO] ** i/f_name:[2:99.99353%,3:0.00617%,0:0.00029%]
[INFO] ** modbus_function_code:[0.02961:99.99265%,-33.760870000000004:0.00735%]
[INFO] ** modbus_function_description:[7:49.99721%,11:49.99544%,0:0.00735%]
[INFO] ** modbus_transaction_id:65534 (19.26468%)
[INFO] ** orig:[0:99.995%,2:0.00441%,1:0.00059%]
[INFO] ** proto:[0:99.99324%,1:0.00647%,2:0.00029%]
[INFO] ** proxy_src_ip:[18:38.32622%,20:25.99029%,13:18.09852%,6:17.57761%,17:0.00647%,14:0.00059%,10:0.00029%]
[INFO] ** s_port:[1.45442:25.98941%,-0.32151:21.00171%,-1.27613:18.09852%,-0.23351:17.57673%,-0.33484:17.32451%,-71.33197:0.00647%,1.45709:0.00059%,-0.24151:0.00059%,7.228860000000001:0.00059%,-0.24950999999999998:0.00029%,1.46509:0.00029%,-71.14931:0.00029%]
[INFO] ** scada_tag:[3:25.98912%,1:21.00171%,5:18.09852%,4:17.57644%,2:17.32451%,0:0.0097%]
[INFO] ** service:[0.0048200000000000005:99.99265%,-211.73542999999998:0.00647%,-211.07873999999998:0.00059%,-211.08818:0.00029%]
[INFO] ** src:[22:38.32622%,9:25.99029%,7:18.09852%,1:17.57761%,21:0.00441%,14:0.00206%,2:0.00059%,11:0.00029%]
[INFO] ** type:[0:99.99824%,1:0.00176%]
[INFO] ** unixtime:939 (0.27603%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/340177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.0651 - tp: 69751.0000 - fp: 10249.0000 - tn: 309751.0000 - fn: 10249.0000 - accuracy: 0.9488 - precision: 0.8719 - recall: 0.8719 - auc: 0.9199 - val_loss: 7.5595 - val_tp: 10620.0000 - val_fp: 9380.0000 - val_tn: 70620.0000 - val_fn: 9380.0000 - val_accuracy: 0.8124 - val_precision: 0.5310 - val_recall: 0.5310 - val_auc: 0.7069
[INFO] saving weights to checkpoints/lstm-epoch-5-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/340177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5722 - tp: 42417.0000 - fp: 37583.0000 - tn: 282417.0000 - fn: 37583.0000 - accuracy: 0.8121 - precision: 0.5302 - recall: 0.5302 - auc: 0.7064 - val_loss: 7.5667 - val_tp: 10611.0000 - val_fp: 9389.0000 - val_tn: 70611.0000 - val_fn: 9389.0000 - val_accuracy: 0.8122 - val_precision: 0.5306 - val_recall: 0.5306 - val_auc: 0.7066
[INFO] saving weights to checkpoints/lstm-epoch-5-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/340177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5959 - tp: 42299.0000 - fp: 37701.0000 - tn: 282299.0000 - fn: 37701.0000 - accuracy: 0.8115 - precision: 0.5287 - recall: 0.5287 - auc: 0.7055 - val_loss: 7.5546 - val_tp: 10626.0000 - val_fp: 9374.0000 - val_tn: 70626.0000 - val_fn: 9374.0000 - val_accuracy: 0.8125 - val_precision: 0.5313 - val_recall: 0.5313 - val_auc: 0.7071
[INFO] saving weights to checkpoints/lstm-epoch-5-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/340177
[33m[INFO] loading file 23-23/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540177, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540177, 17)

[INFO] analyzing data
[INFO] 540177 rows
[INFO] ** appi_name:[21:99.99889%,31:0.00037%,30:0.00037%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:94.83299%,Multi Stage Single Point:5.16701%]
[INFO] ** dst:[21:43.33098%,10:21.00793%,8:18.13369%,9:17.52518%,22:0.00093%,24:0.00037%,18:0.00037%,15:0.00037%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99963%,3:0.00037%]
[INFO] ** modbus_function_code:[0.02961:99.99889%,-33.760870000000004:0.00111%]
[INFO] ** modbus_function_description:[7:50.00028%,11:49.99861%,0:0.00111%]
[INFO] ** modbus_transaction_id:65536 (12.13232%)
[INFO] ** orig:[0:99.99981%,2:0.00019%]
[INFO] ** proto:[0:99.99907%,2:0.00056%,1:0.00037%]
[INFO] ** proxy_src_ip:[18:38.35613%,20:25.98296%,13:18.13387%,6:17.52537%,16:0.00056%,17:0.00037%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98241%,-0.32151:21.00774%,-1.27613:18.13332%,-0.23351:17.525%,-0.33484:17.34839%,-1.02014:0.00056%,-1.27347:0.00037%,-0.08551:0.00037%,-71.33197:0.00037%,1.45709:0.00019%,-0.24151:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,1.46509:0.00019%,-64.19493:0.00019%,-0.24950999999999998:0.00019%,-49.275529999999996:0.00019%]
[INFO] ** scada_tag:[3:25.98204%,1:21.00774%,5:18.13313%,4:17.52481%,2:17.3482%,0:0.00407%]
[INFO] ** service:[0.0048200000000000005:99.99907%,-211.73542999999998:0.00037%,-186.43601999999998:0.00037%,-186.44547:0.00019%]
[INFO] ** src:[22:38.35613%,9:25.98296%,7:18.13387%,1:17.52537%,15:0.00056%,21:0.00019%,17:0.00019%,14:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1469 (0.27195%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.6235 - tp: 52089.0000 - fp: 27911.0000 - tn: 292089.0000 - fn: 27911.0000 - accuracy: 0.8604 - precision: 0.6511 - recall: 0.6511 - auc: 0.7819 - val_loss: 1.5964e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.5515e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3816e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3389e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1965e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.1628e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0429e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0148e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.1294e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/540177
[33m[INFO] loading file 24-24/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540177, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540177, 17)

[INFO] analyzing data
[INFO] 540177 rows
[INFO] ** appi_name:[21:99.99315%,30:0.00333%,26:0.00056%,31:0.00037%,27:0.00037%,22:0.00037%,0:0.00037%,24:0.00019%,23:0.00019%,19:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,11:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:95.28303%,Multi Stage Single Point:4.71697%]
[INFO] ** dst:[21:43.35671%,10:21.02403%,8:18.10481%,9:17.50722%,15:0.00333%,22:0.00111%,6:0.00074%,25:0.00037%,24:0.00037%,19:0.00037%,18:0.00037%,7:0.00037%,26:0.00019%]
[INFO] ** i/f_dir:[1:99.99685%,0:0.00315%]
[INFO] ** i/f_name:[2:99.99667%,3:0.00333%]
[INFO] ** modbus_function_code:[0.02961:99.99315%,-33.760870000000004:0.00629%,-0.415:0.00019%,0.9188299999999999:0.00019%,0.47422:0.00019%]
[INFO] ** modbus_function_description:[7:49.9975%,11:49.99565%,0:0.00629%,15:0.00019%,10:0.00019%,2:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.13232%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.99463%,1:0.00333%,2:0.00204%]
[INFO] ** proxy_src_ip:[18:38.40223%,20:25.97926%,13:18.10481%,6:17.50648%,17:0.00333%,10:0.0013%,14:0.00093%,11:0.00093%,21:0.00037%,16:0.00037%]
[INFO] ** s_port:[1.45442:25.97852%,-0.32151:21.02403%,-1.27613:18.10444%,-0.23351:17.50593%,-0.33484:17.37819%,-71.33197:0.00333%,-9.58113:0.00074%,-71.14798:0.00056%,-1.27347:0.00037%,1.45709:0.00037%,-0.24151:0.00037%,-1.02014:0.00037%,-31.55091:0.00037%,7.6315100000000005:0.00037%,-71.14931:0.00037%,-64.19493:0.00037%,-68.79874000000001:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,7.4901800000000005:0.00019%,13.431270000000001:0.00019%,11.862:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:25.97834%,1:21.02403%,5:18.10425%,4:17.50556%,2:17.37801%,0:0.00981%]
[INFO] ** service:[0.0048200000000000005:99.99426%,-211.73542999999998:0.00333%,-211.08346:0.00056%,-211.07873999999998:0.00037%,-202.75898:0.00037%,-186.44547:0.00037%,-186.43601999999998:0.00037%,-211.08818:0.00037%]
[INFO] ** src:[22:38.40223%,9:25.97926%,7:18.10481%,1:17.50648%,14:0.00333%,11:0.0013%,10:0.00093%,2:0.00093%,15:0.00037%,4:0.00037%]
[INFO] ** type:[0:99.9987%,1:0.00093%,2:0.00037%]
[INFO] ** unixtime:1467 (0.27158%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.7839e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.9358e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.7449e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.9692e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.7888e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.1165e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.9817e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3790e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8326 - tp: 75868.0000 - fp: 4132.0000 - tn: 315868.0000 - fn: 4132.0000 - accuracy: 0.9793 - precision: 0.9484 - recall: 0.9484 - auc: 0.9677 - val_loss: 5.7107 - val_tp: 12914.0000 - val_fp: 7086.0000 - val_tn: 72914.0000 - val_fn: 7086.0000 - val_accuracy: 0.8583 - val_precision: 0.6457 - val_recall: 0.6457 - val_auc: 0.7786
[INFO] saving weights to checkpoints/lstm-epoch-5-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/540177
[33m[INFO] loading file 25-25/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540177, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540177, 17)

[INFO] analyzing data
[INFO] 540177 rows
[INFO] ** appi_name:[21:99.9963%,30:0.00111%,17:0.00074%,22:0.00056%,31:0.00037%,28:0.00019%,26:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** classification:[normal:64.34669%,Multi Stage Single Point:35.65331%]
[INFO] ** dst:[21:43.31932%,10:21.02292%,8:18.14424%,9:17.50908%,15:0.00111%,22:0.00093%,16:0.00074%,6:0.00074%,18:0.00037%,17:0.00037%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99889%,0:0.00111%]
[INFO] ** i/f_name:[2:99.99889%,3:0.00111%]
[INFO] ** modbus_function_code:[0.02961:99.9963%,-33.760870000000004:0.0037%]
[INFO] ** modbus_function_description:[7:49.99898%,11:49.99732%,0:0.0037%]
[INFO] ** modbus_transaction_id:65536 (12.13232%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99778%,2:0.00111%,1:0.00111%]
[INFO] ** proxy_src_ip:[18:38.38631%,20:25.95575%,13:18.14424%,6:17.50963%,17:0.00111%,1:0.00093%,21:0.00074%,16:0.00037%,14:0.00037%,7:0.00037%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95538%,-0.32151:21.02255%,-1.27613:18.14387%,-0.23351:17.50908%,-0.33484:17.36375%,-71.33197:0.00111%,-71.14931:0.00056%,-0.24151:0.00037%,-1.02014:0.00037%,-49.275529999999996:0.00037%,1.46509:0.00019%,-5.1466400000000005:0.00019%,-1.27347:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,-0.24950999999999998:0.00019%,2.52505:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,6.1115699999999995:0.00019%,-5.08665:0.00019%,1.45709:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:25.95501%,1:21.02237%,5:18.14368%,4:17.50889%,2:17.36357%,0:0.00648%]
[INFO] ** service:[0.0048200000000000005:99.99667%,-211.73542999999998:0.00111%,-205.44247:0.00074%,-211.08818:0.00056%,-186.43601999999998:0.00037%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.38631%,9:25.95575%,7:18.14424%,1:17.50963%,14:0.00111%,3:0.00093%,4:0.00074%,21:0.00037%,15:0.00037%,2:0.00037%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1468 (0.27176%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7421 - tp: 51500.0000 - fp: 28500.0000 - tn: 291500.0000 - fn: 28500.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7773 - val_loss: 5.7615 - val_tp: 12851.0000 - val_fp: 7149.0000 - val_tn: 72851.0000 - val_fn: 7149.0000 - val_accuracy: 0.8570 - val_precision: 0.6425 - val_recall: 0.6425 - val_auc: 0.7766
[INFO] saving weights to checkpoints/lstm-epoch-5-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7488 - tp: 51467.0000 - fp: 28533.0000 - tn: 291467.0000 - fn: 28533.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.7771 - val_loss: 5.7220 - val_tp: 12900.0000 - val_fp: 7100.0000 - val_tn: 72900.0000 - val_fn: 7100.0000 - val_accuracy: 0.8580 - val_precision: 0.6450 - val_recall: 0.6450 - val_auc: 0.7781
[INFO] saving weights to checkpoints/lstm-epoch-5-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7473 - tp: 51474.0000 - fp: 28526.0000 - tn: 291474.0000 - fn: 28526.0000 - accuracy: 0.8574 - precision: 0.6434 - recall: 0.6434 - auc: 0.7771 - val_loss: 5.7671 - val_tp: 12844.0000 - val_fp: 7156.0000 - val_tn: 72844.0000 - val_fn: 7156.0000 - val_accuracy: 0.8569 - val_precision: 0.6422 - val_recall: 0.6422 - val_auc: 0.7764
[INFO] saving weights to checkpoints/lstm-epoch-5-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7415 - tp: 51503.0000 - fp: 28497.0000 - tn: 291503.0000 - fn: 28497.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7774 - val_loss: 5.7647 - val_tp: 12847.0000 - val_fp: 7153.0000 - val_tn: 72847.0000 - val_fn: 7153.0000 - val_accuracy: 0.8569 - val_precision: 0.6424 - val_recall: 0.6424 - val_auc: 0.7765
[INFO] saving weights to checkpoints/lstm-epoch-5-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7498 - tp: 51462.0000 - fp: 28538.0000 - tn: 291462.0000 - fn: 28538.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.7770 - val_loss: 5.7421 - val_tp: 12875.0000 - val_fp: 7125.0000 - val_tn: 72875.0000 - val_fn: 7125.0000 - val_accuracy: 0.8575 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.7773
[INFO] saving weights to checkpoints/lstm-epoch-5-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/540177
[33m[INFO] loading file 26-26/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540177, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540177, 17)

[INFO] analyzing data
[INFO] 540177 rows
[INFO] ** appi_name:[21:99.99852%,7:0.00056%,31:0.00019%,30:0.00019%,22:0.00019%,12:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:64.39963%,Single Stage Single Point:29.56661%,Multi Stage Single Point:6.03376%]
[INFO] ** dst:[21:43.31173%,10:21.08587%,8:18.11647%,9:17.48353%,22:0.00074%,24:0.00037%,16:0.00037%,2:0.00037%,18:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99852%,-33.760870000000004:0.00148%]
[INFO] ** modbus_function_description:[7:49.99991%,11:49.99861%,0:0.00148%]
[INFO] ** modbus_transaction_id:65536 (12.13232%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99944%,2:0.00037%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.46721%,20:25.93057%,13:18.11684%,6:17.48353%,1:0.00056%,21:0.00037%,16:0.00037%,17:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.93002%,-0.32151:21.08568%,-1.27613:18.11628%,-0.23351:17.48334%,-0.33484:17.38152%,-1.27347:0.00037%,-1.02014:0.00037%,7.66617:0.00019%,-71.14931:0.00019%,11.57001:0.00019%,-3.3787199999999995:0.00019%,2.52505:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%,1.45709:0.00019%,-49.275529999999996:0.00019%,1.47576:0.00019%,1.46509:0.00019%,14.191239999999999:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.92965%,1:21.08568%,5:18.11628%,4:17.48316%,2:17.38152%,0:0.0037%]
[INFO] ** service:[0.0048200000000000005:99.9987%,-211.09762999999998:0.00056%,-211.35747999999998:0.00019%,-211.73542999999998:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.46721%,9:25.93057%,7:18.11684%,1:17.48353%,3:0.00056%,15:0.00037%,4:0.00037%,21:0.00019%,14:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1466 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7383 - tp: 51519.0000 - fp: 28481.0000 - tn: 291519.0000 - fn: 28481.0000 - accuracy: 0.8576 - precision: 0.6440 - recall: 0.6440 - auc: 0.7775 - val_loss: 5.7429 - val_tp: 12874.0000 - val_fp: 7126.0000 - val_tn: 72874.0000 - val_fn: 7126.0000 - val_accuracy: 0.8575 - val_precision: 0.6437 - val_recall: 0.6437 - val_auc: 0.7773
[INFO] saving weights to checkpoints/lstm-epoch-5-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.6309 - tp: 66114.0000 - fp: 13886.0000 - tn: 306114.0000 - fn: 13886.0000 - accuracy: 0.9306 - precision: 0.8264 - recall: 0.8264 - auc: 0.8953 - val_loss: 8.5559e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1949 - tp: 78177.0000 - fp: 1823.0000 - tn: 318177.0000 - fn: 1823.0000 - accuracy: 0.9909 - precision: 0.9772 - recall: 0.9772 - auc: 0.9856 - val_loss: 2.1693e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1958 - tp: 78146.0000 - fp: 1854.0000 - tn: 318146.0000 - fn: 1854.0000 - accuracy: 0.9907 - precision: 0.9768 - recall: 0.9768 - auc: 0.9852 - val_loss: 2.6406e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1886 - tp: 78175.0000 - fp: 1825.0000 - tn: 318175.0000 - fn: 1825.0000 - accuracy: 0.9909 - precision: 0.9772 - recall: 0.9772 - auc: 0.9855 - val_loss: 2.9810e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/540177
[33m[INFO] loading file 27-27/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (480307, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (480307, 17)

[INFO] analyzing data
[INFO] 480307 rows
[INFO] ** appi_name:[21:99.99938%,30:0.00062%]
[INFO] ** classification:[normal:64.33802%,Single Stage Single Point:35.66198%]
[INFO] ** dst:[21:43.27149%,10:21.06465%,8:18.18733%,9:17.47487%,22:0.00083%,15:0.00062%,24:0.00021%]
[INFO] ** i/f_dir:[1:99.99979%,0:0.00021%]
[INFO] ** i/f_name:[2:99.99938%,3:0.00062%]
[INFO] ** modbus_function_code:[0.02961:99.99938%,-33.760870000000004:0.00062%]
[INFO] ** modbus_function_description:[7:50.00031%,11:49.99906%,0:0.00062%]
[INFO] ** modbus_transaction_id:65536 (13.64461%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99938%,1:0.00062%]
[INFO] ** proxy_src_ip:[18:38.40585%,20:25.93092%,13:18.18712%,6:17.47507%,17:0.00062%,16:0.00042%]
[INFO] ** s_port:[1.45442:25.93029%,-0.32151:21.06465%,-1.27613:18.18691%,-0.23351:17.47466%,-0.33484:17.3412%,-71.33197:0.00062%,-1.02014:0.00042%,-1.27347:0.00021%,1.45709:0.00021%,-0.24950999999999998:0.00021%,1.46509:0.00021%,1.47576:0.00021%,-0.24151:0.00021%]
[INFO] ** scada_tag:[3:25.92987%,1:21.06444%,5:18.1867%,4:17.47445%,2:17.34099%,0:0.00354%]
[INFO] ** service:[0.0048200000000000005:99.99938%,-211.73542999999998:0.00062%]
[INFO] ** src:[22:38.40585%,9:25.93092%,7:18.18712%,1:17.47507%,14:0.00062%,15:0.00042%]
[INFO] ** type:[0:99.99958%,1:0.00042%]
[INFO] ** unixtime:1305 (0.2717%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/480307
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1803 - tp: 78218.0000 - fp: 1782.0000 - tn: 318218.0000 - fn: 1782.0000 - accuracy: 0.9911 - precision: 0.9777 - recall: 0.9777 - auc: 0.9859 - val_loss: 3.2427e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/480307
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1797 - tp: 78184.0000 - fp: 1816.0000 - tn: 318184.0000 - fn: 1816.0000 - accuracy: 0.9909 - precision: 0.9773 - recall: 0.9773 - auc: 0.9857 - val_loss: 3.8469e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/480307
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1687 - tp: 78250.0000 - fp: 1750.0000 - tn: 318250.0000 - fn: 1750.0000 - accuracy: 0.9913 - precision: 0.9781 - recall: 0.9781 - auc: 0.9863 - val_loss: 0.0013 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/480307
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1627 - tp: 78265.0000 - fp: 1735.0000 - tn: 318265.0000 - fn: 1735.0000 - accuracy: 0.9913 - precision: 0.9783 - recall: 0.9783 - auc: 0.9864 - val_loss: 5.4441e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/480307
[33m[INFO] loading file 28-28/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (414223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (414223, 17)

[INFO] analyzing data
[INFO] 414223 rows
[INFO] ** appi_name:[21:99.99276%,30:0.00169%,17:0.00121%,22:0.00097%,7:0.00097%,31:0.00072%,26:0.00072%,28:0.00024%,27:0.00024%,8:0.00024%,0:0.00024%]
[INFO] ** classification:[normal:64.31922%,Single Stage Single Point:35.68078%]
[INFO] ** dst:[21:43.28272%,10:21.02901%,8:18.20203%,9:17.47851%,6:0.00193%,16:0.00169%,18:0.00121%,15:0.00072%,22:0.00048%,17:0.00048%,2:0.00048%,25:0.00024%,7:0.00024%,0:0.00024%]
[INFO] ** i/f_dir:[1:99.99928%,0:0.00072%]
[INFO] ** i/f_name:[2:99.99928%,3:0.00072%]
[INFO] ** modbus_function_code:[0.02961:99.99276%,-33.760870000000004:0.00724%]
[INFO] ** modbus_function_description:[7:49.9965%,11:49.99626%,0:0.00724%]
[INFO] ** modbus_transaction_id:65536 (15.82143%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99565%,2:0.00362%,1:0.00072%]
[INFO] ** proxy_src_ip:[18:38.35132%,20:25.96041%,13:18.20227%,6:17.47875%,1:0.00193%,17:0.00169%,14:0.00145%,7:0.00121%,21:0.00072%,0:0.00024%]
[INFO] ** s_port:[1.45442:25.96017%,-0.32151:21.02901%,-1.27613:18.20203%,-0.23351:17.47827%,-0.33484:17.32231%,-71.14798:0.00097%,-71.14931:0.00097%,-71.33197:0.00072%,-0.08551:0.00048%,-0.24151:0.00048%,7.66617:0.00024%,-58.035180000000004:0.00024%,-1.2708:0.00024%,-64.19493:0.00024%,-5.1466400000000005:0.00024%,13.431270000000001:0.00024%,11.57001:0.00024%,14.4699:0.00024%,1.47576:0.00024%,14.191239999999999:0.00024%,-5.08665:0.00024%,10.192739999999999:0.00024%,-3.3787199999999995:0.00024%,6.1115699999999995:0.00024%,2.05573:0.00024%,-43.76509:0.00024%,2.52505:0.00024%,11.862:0.00024%,-58.032509999999995:0.00024%]
[INFO] ** scada_tag:[3:25.95993%,1:21.02877%,5:18.20203%,4:17.47778%,2:17.32231%,0:0.00917%]
[INFO] ** service:[0.0048200000000000005:99.99276%,-205.44247:0.00121%,-186.43601999999998:0.00121%,-211.09762999999998:0.00097%,-211.08346:0.00097%,-211.08818:0.00097%,-211.73542999999998:0.00072%,-186.44547:0.00024%,-183.8612:0.00024%,-185.9872:0.00024%,-211.35747999999998:0.00024%,-202.75898:0.00024%]
[INFO] ** src:[22:38.35132%,9:25.96041%,7:18.20227%,1:17.47875%,3:0.00217%,2:0.00145%,21:0.00121%,4:0.00097%,14:0.00072%,8:0.00048%,17:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1126 (0.27183%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/414223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1621 - tp: 78216.0000 - fp: 1784.0000 - tn: 318216.0000 - fn: 1784.0000 - accuracy: 0.9911 - precision: 0.9777 - recall: 0.9777 - auc: 0.9860 - val_loss: 0.0015 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/414223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1555 - tp: 78235.0000 - fp: 1765.0000 - tn: 318235.0000 - fn: 1765.0000 - accuracy: 0.9912 - precision: 0.9779 - recall: 0.9779 - auc: 0.9862 - val_loss: 0.0013 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/414223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1545 - tp: 78179.0000 - fp: 1821.0000 - tn: 318179.0000 - fn: 1821.0000 - accuracy: 0.9909 - precision: 0.9772 - recall: 0.9772 - auc: 0.9858 - val_loss: 0.0035 - val_tp: 19996.0000 - val_fp: 4.0000 - val_tn: 79996.0000 - val_fn: 4.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-5-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/414223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1445 - tp: 78213.0000 - fp: 1787.0000 - tn: 318213.0000 - fn: 1787.0000 - accuracy: 0.9911 - precision: 0.9777 - recall: 0.9777 - auc: 0.9860 - val_loss: 0.0014 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-27-28-batch-300000-400000
[INFO] processing batch 400000-500000/414223
[33m[INFO] loading file 29-29/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (514223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (514223, 17)

[INFO] analyzing data
[INFO] 514223 rows
[INFO] ** appi_name:[21:99.99883%,30:0.00058%,26:0.00019%,9:0.00019%,3:0.00019%]
[INFO] ** classification:[normal:64.38666%,Single Stage Single Point:35.61334%]
[INFO] ** dst:[21:43.32809%,10:21.05721%,8:18.14602%,9:17.46694%,22:0.00058%,15:0.00058%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99942%,3:0.00058%]
[INFO] ** modbus_function_code:[0.02961:99.99883%,-33.760870000000004:0.00117%]
[INFO] ** modbus_function_description:[7:49.9999%,11:49.99893%,0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (12.74467%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99922%,1:0.00058%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.43955%,20:25.94594%,13:18.14641%,6:17.46674%,17:0.00058%,21:0.00019%,16:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.94536%,-0.32151:21.05701%,-1.27613:18.14602%,-0.23351:17.46674%,-0.33484:17.38254%,-71.33197:0.00058%,1.45709:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.94497%,1:21.05682%,5:18.14602%,4:17.46635%,2:17.38254%,0:0.00331%]
[INFO] ** service:[0.0048200000000000005:99.99903%,-211.73542999999998:0.00058%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.43955%,9:25.94594%,7:18.14641%,1:17.46674%,14:0.00058%,15:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1397 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1627 - tp: 78039.0000 - fp: 1961.0000 - tn: 318039.0000 - fn: 1961.0000 - accuracy: 0.9902 - precision: 0.9755 - recall: 0.9755 - auc: 0.9850 - val_loss: 0.0017 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1319 - tp: 78205.0000 - fp: 1795.0000 - tn: 318205.0000 - fn: 1795.0000 - accuracy: 0.9910 - precision: 0.9776 - recall: 0.9776 - auc: 0.9859 - val_loss: 0.0033 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1201 - tp: 78279.0000 - fp: 1721.0000 - tn: 318279.0000 - fn: 1721.0000 - accuracy: 0.9914 - precision: 0.9785 - recall: 0.9785 - auc: 0.9866 - val_loss: 0.0034 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1180 - tp: 78217.0000 - fp: 1783.0000 - tn: 318217.0000 - fn: 1783.0000 - accuracy: 0.9911 - precision: 0.9777 - recall: 0.9777 - auc: 0.9963 - val_loss: 0.0047 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1148 - tp: 78177.0000 - fp: 1823.0000 - tn: 318177.0000 - fn: 1823.0000 - accuracy: 0.9909 - precision: 0.9772 - recall: 0.9772 - auc: 0.9961 - val_loss: 0.0065 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/514223
[33m[INFO] loading file 30-30/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (514223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (514223, 17)

[INFO] analyzing data
[INFO] 514223 rows
[INFO] ** appi_name:[21:99.99747%,30:0.00175%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.36779%,Single Stage Single Point:35.63221%]
[INFO] ** dst:[21:43.34034%,10:21.02434%,8:18.14407%,9:17.48774%,15:0.00175%,22:0.00078%,24:0.00039%,25:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99825%,0:0.00175%]
[INFO] ** i/f_name:[2:99.99825%,3:0.00175%]
[INFO] ** modbus_function_code:[0.02961:99.99747%,-33.760870000000004:0.00253%]
[INFO] ** modbus_function_description:[7:49.9999%,11:49.99757%,0:0.00253%]
[INFO] ** modbus_transaction_id:65536 (12.74467%)
[INFO] ** orig:[0:99.99903%,2:0.00058%,1:0.00039%]
[INFO] ** proto:[0:99.99786%,1:0.00175%,2:0.00039%]
[INFO] ** proxy_src_ip:[18:38.36487%,20:25.99961%,13:18.14446%,6:17.48833%,17:0.00175%,7:0.00039%,16:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.99942%,-0.32151:21.02415%,-1.27613:18.14388%,-0.23351:17.48755%,-0.33484:17.34073%,-71.33197:0.00175%,-0.24151:0.00058%,-1.27347:0.00039%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,10.192739999999999:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.99903%,1:21.02415%,5:18.14368%,4:17.48735%,2:17.34053%,0:0.00525%]
[INFO] ** service:[0.0048200000000000005:99.99767%,-211.73542999999998:0.00175%,-186.44547:0.00019%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.36487%,9:25.99961%,7:18.14446%,1:17.48833%,14:0.00117%,21:0.00097%,16:0.00019%,15:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99922%,1:0.00078%]
[INFO] ** unixtime:1398 (0.27187%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1067 - tp: 78229.0000 - fp: 1771.0000 - tn: 318229.0000 - fn: 1771.0000 - accuracy: 0.9911 - precision: 0.9779 - recall: 0.9779 - auc: 0.9962 - val_loss: 0.0119 - val_tp: 19996.0000 - val_fp: 4.0000 - val_tn: 79996.0000 - val_fn: 4.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 0.9998
[INFO] saving weights to checkpoints/lstm-epoch-5-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1076 - tp: 78131.0000 - fp: 1869.0000 - tn: 318131.0000 - fn: 1869.0000 - accuracy: 0.9907 - precision: 0.9766 - recall: 0.9766 - auc: 0.9960 - val_loss: 0.0116 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1017 - tp: 78201.0000 - fp: 1799.0000 - tn: 318201.0000 - fn: 1799.0000 - accuracy: 0.9910 - precision: 0.9775 - recall: 0.9775 - auc: 0.9960 - val_loss: 0.0153 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0980 - tp: 78242.0000 - fp: 1758.0000 - tn: 318242.0000 - fn: 1758.0000 - accuracy: 0.9912 - precision: 0.9780 - recall: 0.9780 - auc: 0.9961 - val_loss: 0.0168 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0984 - tp: 78216.0000 - fp: 1784.0000 - tn: 318216.0000 - fn: 1784.0000 - accuracy: 0.9911 - precision: 0.9777 - recall: 0.9777 - auc: 0.9963 - val_loss: 0.0189 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/514223
[33m[INFO] loading file 31-31/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (514223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (514223, 17)

[INFO] analyzing data
[INFO] 514223 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.37674%,Single Stage Single Point:35.62326%]
[INFO] ** dst:[21:43.31642%,10:21.05915%,8:18.12521%,9:17.49786%,22:0.00097%,24:0.00039%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.0001%,11:49.9999%]
[INFO] ** modbus_transaction_id:65536 (12.74467%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.40688%,20:25.96947%,13:18.1254%,6:17.49786%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.96869%,-0.32151:21.05915%,-1.27613:18.12502%,-0.23351:17.49766%,-0.33484:17.34773%,-1.27347:0.00039%,1.45709:0.00039%,-1.02014:0.00039%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.96831%,1:21.05896%,5:18.12482%,4:17.49747%,2:17.34753%,0:0.00292%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.40688%,9:25.96947%,7:18.1254%,1:17.49786%,15:0.00039%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1397 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0970 - tp: 78237.0000 - fp: 1763.0000 - tn: 318237.0000 - fn: 1763.0000 - accuracy: 0.9912 - precision: 0.9780 - recall: 0.9780 - auc: 0.9962 - val_loss: 0.0202 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0981 - tp: 78209.0000 - fp: 1791.0000 - tn: 318209.0000 - fn: 1791.0000 - accuracy: 0.9910 - precision: 0.9776 - recall: 0.9776 - auc: 0.9963 - val_loss: 0.0211 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0987 - tp: 78198.0000 - fp: 1802.0000 - tn: 318198.0000 - fn: 1802.0000 - accuracy: 0.9910 - precision: 0.9775 - recall: 0.9775 - auc: 0.9962 - val_loss: 0.0217 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0999 - tp: 78167.0000 - fp: 1833.0000 - tn: 318167.0000 - fn: 1833.0000 - accuracy: 0.9908 - precision: 0.9771 - recall: 0.9771 - auc: 0.9962 - val_loss: 0.0221 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0990 - tp: 78186.0000 - fp: 1814.0000 - tn: 318186.0000 - fn: 1814.0000 - accuracy: 0.9909 - precision: 0.9773 - recall: 0.9773 - auc: 0.9962 - val_loss: 0.0225 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/514223
[33m[INFO] loading file 32-32/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (514223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (514223, 17)

[INFO] analyzing data
[INFO] 514223 rows
[INFO] ** appi_name:[21:99.99611%,30:0.00331%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.37674%,Single Stage Single Point:35.62326%]
[INFO] ** dst:[21:43.3205%,10:21.05118%,8:18.16002%,9:17.46344%,15:0.00331%,22:0.00097%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99708%,0:0.00292%]
[INFO] ** i/f_name:[2:99.99669%,3:0.00331%]
[INFO] ** modbus_function_code:[0.02961:99.99611%,-33.760870000000004:0.00389%]
[INFO] ** modbus_function_description:[7:49.99893%,11:49.99718%,0:0.00389%]
[INFO] ** modbus_transaction_id:65536 (12.74467%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99611%,1:0.00331%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.40999%,20:25.96208%,13:18.15983%,6:17.46402%,17:0.00331%,14:0.00058%,16:0.00019%]
[INFO] ** s_port:[1.45442:25.9615%,-0.32151:21.05118%,-1.27613:18.15963%,-0.23351:17.46324%,-0.33484:17.35881%,-71.33197:0.00331%,-0.24151:0.00058%,-71.14798:0.00019%,11.862:0.00019%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,13.431270000000001:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.96111%,1:21.05098%,5:18.15963%,4:17.46285%,2:17.35881%,0:0.00661%]
[INFO] ** service:[0.0048200000000000005:99.99611%,-211.73542999999998:0.00331%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.40999%,9:25.96208%,7:18.15983%,1:17.46402%,14:0.00331%,2:0.00058%,15:0.00019%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1396 (0.27148%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0979 - tp: 78212.0000 - fp: 1788.0000 - tn: 318212.0000 - fn: 1788.0000 - accuracy: 0.9911 - precision: 0.9776 - recall: 0.9776 - auc: 0.9963 - val_loss: 0.0229 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0987 - tp: 78194.0000 - fp: 1806.0000 - tn: 318194.0000 - fn: 1806.0000 - accuracy: 0.9910 - precision: 0.9774 - recall: 0.9774 - auc: 0.9962 - val_loss: 0.0222 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0983 - tp: 78203.0000 - fp: 1797.0000 - tn: 318203.0000 - fn: 1797.0000 - accuracy: 0.9910 - precision: 0.9775 - recall: 0.9775 - auc: 0.9963 - val_loss: 0.0229 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0975 - tp: 78250.0000 - fp: 1750.0000 - tn: 318250.0000 - fn: 1750.0000 - accuracy: 0.9912 - precision: 0.9781 - recall: 0.9781 - auc: 0.9963 - val_loss: 0.0217 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0954 - tp: 78270.0000 - fp: 1730.0000 - tn: 318270.0000 - fn: 1730.0000 - accuracy: 0.9913 - precision: 0.9784 - recall: 0.9784 - auc: 0.9964 - val_loss: 0.0213 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/514223
[33m[INFO] loading file 33-33/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (514223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (514223, 17)

[INFO] analyzing data
[INFO] 514223 rows
[INFO] ** appi_name:[21:99.99669%,30:0.00117%,17:0.00078%,22:0.00058%,31:0.00019%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.40008%,Single Stage Single Point:35.59992%]
[INFO] ** dst:[21:43.33587%,10:21.05915%,8:18.10985%,9:17.49008%,22:0.00136%,15:0.00117%,16:0.00078%,6:0.00078%,24:0.00039%,17:0.00039%,18:0.00019%]
[INFO] ** i/f_dir:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name:[2:99.99883%,3:0.00117%]
[INFO] ** modbus_function_code:[0.02961:99.99669%,-33.760870000000004:0.00331%]
[INFO] ** modbus_function_description:[7:49.99951%,11:49.99718%,0:0.00331%]
[INFO] ** modbus_transaction_id:65536 (12.74467%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99786%,1:0.00117%,2:0.00097%]
[INFO] ** proxy_src_ip:[18:38.42516%,20:25.97064%,13:18.10985%,6:17.49027%,17:0.00117%,16:0.00078%,1:0.00078%,21:0.00039%,14:0.00039%,7:0.00039%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.96986%,-0.32151:21.05915%,-1.27613:18.10946%,-0.23351:17.48988%,-0.33484:17.36601%,-71.33197:0.00117%,-1.02014:0.00078%,-71.14931:0.00058%,1.45709:0.00039%,-1.27347:0.00039%,-71.14798:0.00019%,-58.035180000000004:0.00019%,-5.1466400000000005:0.00019%,-0.24151:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-5.08665:0.00019%,-0.24950999999999998:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.96947%,1:21.05915%,5:18.10926%,4:17.48969%,2:17.36601%,0:0.00642%]
[INFO] ** service:[0.0048200000000000005:99.99669%,-211.73542999999998:0.00117%,-205.44247:0.00078%,-211.08818:0.00058%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.42516%,9:25.97064%,7:18.10985%,1:17.49027%,14:0.00117%,15:0.00078%,3:0.00078%,21:0.00039%,4:0.00039%,2:0.00039%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1399 (0.27206%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0975 - tp: 78225.0000 - fp: 1775.0000 - tn: 318225.0000 - fn: 1775.0000 - accuracy: 0.9911 - precision: 0.9778 - recall: 0.9778 - auc: 0.9963 - val_loss: 0.0217 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0988 - tp: 78190.0000 - fp: 1810.0000 - tn: 318190.0000 - fn: 1810.0000 - accuracy: 0.9910 - precision: 0.9774 - recall: 0.9774 - auc: 0.9962 - val_loss: 0.0220 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0980 - tp: 78211.0000 - fp: 1789.0000 - tn: 318211.0000 - fn: 1789.0000 - accuracy: 0.9911 - precision: 0.9776 - recall: 0.9776 - auc: 0.9963 - val_loss: 0.0221 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0970 - tp: 78252.0000 - fp: 1748.0000 - tn: 318252.0000 - fn: 1748.0000 - accuracy: 0.9913 - precision: 0.9782 - recall: 0.9782 - auc: 0.9963 - val_loss: 0.0216 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0989 - tp: 78190.0000 - fp: 1810.0000 - tn: 318190.0000 - fn: 1810.0000 - accuracy: 0.9910 - precision: 0.9774 - recall: 0.9774 - auc: 0.9962 - val_loss: 0.0227 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/514223
[33m[INFO] loading file 34-34/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (355656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (355656, 17)

[INFO] analyzing data
[INFO] 355656 rows
[INFO] ** appi_name:[21:99.99747%,7:0.00084%,30:0.00056%,31:0.00028%,22:0.00028%,8:0.00028%,6:0.00028%]
[INFO] ** classification:[normal:64.33014%,Single Stage Single Point:35.66986%]
[INFO] ** dst:[21:43.26934%,10:21.05771%,8:18.21564%,9:17.45423%,22:0.00084%,16:0.00056%,15:0.00056%,2:0.00056%,18:0.00028%,6:0.00028%]
[INFO] ** i/f_dir:[1:99.99944%,0:0.00056%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99747%,-33.760870000000004:0.00253%]
[INFO] ** modbus_function_description:[7:49.99916%,11:49.99831%,0:0.00253%]
[INFO] ** modbus_transaction_id:65536 (18.42679%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99888%,2:0.00056%,1:0.00056%]
[INFO] ** proxy_src_ip:[18:38.3795%,20:25.94754%,13:18.21564%,6:17.45479%,1:0.00084%,21:0.00056%,17:0.00056%,14:0.00028%,7:0.00028%]
[INFO] ** s_port:[1.45442:25.94726%,-0.32151:21.05743%,-1.27613:18.21564%,-0.23351:17.45394%,-0.33484:17.32208%,-0.24151:0.00084%,-71.33197:0.00056%,-3.0613900000000003:0.00028%,-3.3787199999999995:0.00028%,14.191239999999999:0.00028%,1.47576:0.00028%,11.57001:0.00028%,-49.275529999999996:0.00028%,-71.14931:0.00028%,7.66617:0.00028%]
[INFO] ** scada_tag:[3:25.94698%,1:21.05715%,5:18.21535%,4:17.45366%,2:17.32208%,0:0.00478%]
[INFO] ** service:[0.0048200000000000005:99.99775%,-211.09762999999998:0.00084%,-211.73542999999998:0.00056%,-186.43601999999998:0.00028%,-211.35747999999998:0.00028%,-211.08818:0.00028%]
[INFO] ** src:[22:38.3795%,9:25.94754%,7:18.21564%,1:17.45479%,3:0.00084%,14:0.00056%,4:0.00056%,21:0.00028%,2:0.00028%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:966 (0.27161%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/355656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0989 - tp: 78186.0000 - fp: 1814.0000 - tn: 318186.0000 - fn: 1814.0000 - accuracy: 0.9909 - precision: 0.9773 - recall: 0.9773 - auc: 0.9962 - val_loss: 0.0220 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/355656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0984 - tp: 78201.0000 - fp: 1799.0000 - tn: 318201.0000 - fn: 1799.0000 - accuracy: 0.9910 - precision: 0.9775 - recall: 0.9775 - auc: 0.9962 - val_loss: 0.0228 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/355656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0991 - tp: 78184.0000 - fp: 1816.0000 - tn: 318184.0000 - fn: 1816.0000 - accuracy: 0.9909 - precision: 0.9773 - recall: 0.9773 - auc: 0.9962 - val_loss: 0.0224 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/355656
[33m[INFO] loading file 35-35/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:99.99892%,30:0.00108%]
[INFO] ** classification:[normal:64.36716%,Single Stage Single Point:35.63284%]
[INFO] ** dst:[21:43.32771%,10:21.03694%,8:18.15782%,9:17.47538%,22:0.00108%,15:0.00108%]
[INFO] ** i/f_dir:[1:99.9991%,0:0.0009%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99892%,-33.760870000000004:0.00108%]
[INFO] ** modbus_function_description:[7:50.00036%,11:49.99856%,0:0.00108%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:99.99964%,1:0.00036%]
[INFO] ** proto:[0:99.99892%,1:0.00108%]
[INFO] ** proxy_src_ip:[18:38.39714%,20:25.96804%,13:18.15746%,6:17.47556%,17:0.00108%,16:0.00072%]
[INFO] ** s_port:[1.45442:25.96751%,-0.32151:21.03694%,-1.27613:18.15746%,-0.23351:17.4752%,-0.33484:17.3602%,-71.33197:0.00108%,-1.02014:0.00072%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.96715%,1:21.03694%,5:18.15728%,4:17.47484%,2:17.3602%,0:0.0036%]
[INFO] ** service:[0.0048200000000000005:99.99892%,-211.73542999999998:0.00108%]
[INFO] ** src:[22:38.39714%,9:25.96804%,7:18.15746%,1:17.47556%,14:0.00108%,15:0.00072%]
[INFO] ** type:[0:99.9991%,1:0.0009%]
[INFO] ** unixtime:1508 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1008 - tp: 78142.0000 - fp: 1858.0000 - tn: 318142.0000 - fn: 1858.0000 - accuracy: 0.9907 - precision: 0.9768 - recall: 0.9768 - auc: 0.9961 - val_loss: 0.0227 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0983 - tp: 78205.0000 - fp: 1795.0000 - tn: 318205.0000 - fn: 1795.0000 - accuracy: 0.9910 - precision: 0.9776 - recall: 0.9776 - auc: 0.9963 - val_loss: 0.0223 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0982 - tp: 78212.0000 - fp: 1788.0000 - tn: 318212.0000 - fn: 1788.0000 - accuracy: 0.9911 - precision: 0.9776 - recall: 0.9776 - auc: 0.9963 - val_loss: 0.0221 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0969 - tp: 78234.0000 - fp: 1766.0000 - tn: 318234.0000 - fn: 1766.0000 - accuracy: 0.9912 - precision: 0.9779 - recall: 0.9779 - auc: 0.9963 - val_loss: 0.0220 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0998 - tp: 78167.0000 - fp: 1833.0000 - tn: 318167.0000 - fn: 1833.0000 - accuracy: 0.9908 - precision: 0.9771 - recall: 0.9771 - auc: 0.9962 - val_loss: 0.0224 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 36-36/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:99.99856%,30:0.00072%,31:0.00036%,33:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.36158%,Single Stage Single Point:35.63842%]
[INFO] ** dst:[21:43.33149%,10:21.02776%,8:18.14828%,9:17.48996%,22:0.0009%,15:0.00072%,24:0.00036%,18:0.00036%,25:0.00018%]
[INFO] ** i/f_dir:[1:99.99928%,0:0.00072%]
[INFO] ** i/f_name:[2:99.99928%,3:0.00072%]
[INFO] ** modbus_function_code:[0.02961:99.99856%,-33.760870000000004:0.00144%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99838%,0:0.00144%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99874%,1:0.00072%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.37734%,20:25.98208%,13:18.14846%,6:17.4905%,17:0.00072%,21:0.00018%,16:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98154%,-0.32151:21.02758%,-1.27613:18.14792%,-0.23351:17.48978%,-0.33484:17.34976%,-71.33197:0.00072%,-0.24151:0.00054%,-0.08551:0.00036%,-1.27347:0.00036%,1.45709:0.00018%,1.47576:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,1.46509:0.00018%,-64.19493:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:25.98118%,1:21.0274%,5:18.14774%,4:17.4896%,2:17.34958%,0:0.0045%]
[INFO] ** service:[0.0048200000000000005:99.99874%,-211.73542999999998:0.00072%,-186.43601999999998:0.00036%,-186.44547:0.00018%]
[INFO] ** src:[22:38.37734%,9:25.98208%,7:18.14846%,1:17.4905%,14:0.00072%,17:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1509 (0.27157%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0976 - tp: 78223.0000 - fp: 1777.0000 - tn: 318223.0000 - fn: 1777.0000 - accuracy: 0.9911 - precision: 0.9778 - recall: 0.9778 - auc: 0.9963 - val_loss: 0.0231 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-5-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0966 - tp: 78242.0000 - fp: 1758.0000 - tn: 318242.0000 - fn: 1758.0000 - accuracy: 0.9912 - precision: 0.9780 - recall: 0.9780 - auc: 0.9963 - val_loss: 0.0218 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0985 - tp: 78199.0000 - fp: 1801.0000 - tn: 318199.0000 - fn: 1801.0000 - accuracy: 0.9910 - precision: 0.9775 - recall: 0.9775 - auc: 0.9962 - val_loss: 0.0223 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0984 - tp: 78200.0000 - fp: 1800.0000 - tn: 318200.0000 - fn: 1800.0000 - accuracy: 0.9910 - precision: 0.9775 - recall: 0.9775 - auc: 0.9963 - val_loss: 0.0219 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0962 - tp: 78255.0000 - fp: 1745.0000 - tn: 318255.0000 - fn: 1745.0000 - accuracy: 0.9913 - precision: 0.9782 - recall: 0.9782 - auc: 0.9964 - val_loss: 0.0224 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 37-37/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:99.99892%,30:0.00072%,26:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:64.37436%,Single Stage Single Point:35.62564%]
[INFO] ** dst:[21:43.33311%,10:21.03928%,8:18.13856%,9:17.48708%,22:0.00072%,15:0.00072%,24:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99928%,3:0.00072%]
[INFO] ** modbus_function_code:[0.02961:99.99892%,-33.760870000000004:0.00108%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99874%,0:0.00108%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9991%,1:0.00072%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.38634%,20:25.9864%,13:18.13856%,6:17.48726%,17:0.00072%,16:0.00036%,21:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:25.98586%,-0.32151:21.03928%,-1.27613:18.1382%,-0.23351:17.4869%,-0.33484:17.34706%,-71.33197:0.00072%,-1.02014:0.00036%,-71.14798:0.00018%,-1.27347:0.00018%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.2708:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.98568%,1:21.03928%,5:18.13802%,4:17.48672%,2:17.34688%,0:0.00342%]
[INFO] ** service:[0.0048200000000000005:99.99892%,-211.73542999999998:0.00072%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.38634%,9:25.9864%,7:18.13856%,1:17.48726%,14:0.00072%,15:0.00036%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1509 (0.27157%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0963 - tp: 78251.0000 - fp: 1749.0000 - tn: 318251.0000 - fn: 1749.0000 - accuracy: 0.9913 - precision: 0.9781 - recall: 0.9781 - auc: 0.9964 - val_loss: 0.0213 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0952 - tp: 78275.0000 - fp: 1725.0000 - tn: 318275.0000 - fn: 1725.0000 - accuracy: 0.9914 - precision: 0.9784 - recall: 0.9784 - auc: 0.9964 - val_loss: 0.0215 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0977 - tp: 78217.0000 - fp: 1783.0000 - tn: 318217.0000 - fn: 1783.0000 - accuracy: 0.9911 - precision: 0.9777 - recall: 0.9777 - auc: 0.9963 - val_loss: 0.0215 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0960 - tp: 78257.0000 - fp: 1743.0000 - tn: 318257.0000 - fn: 1743.0000 - accuracy: 0.9913 - precision: 0.9782 - recall: 0.9782 - auc: 0.9964 - val_loss: 0.0222 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0966 - tp: 78247.0000 - fp: 1753.0000 - tn: 318247.0000 - fn: 1753.0000 - accuracy: 0.9912 - precision: 0.9781 - recall: 0.9781 - auc: 0.9963 - val_loss: 0.0222 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 38-38/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:99.9991%,30:0.00018%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.40981%,Single Stage Single Point:35.59019%]
[INFO] ** dst:[21:43.31889%,10:21.08895%,8:18.09681%,9:17.49356%,22:0.0009%,25:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99982%,0:0.00018%]
[INFO] ** i/f_name:[2:99.99982%,3:0.00018%]
[INFO] ** modbus_function_code:[0.02961:99.9991%,-33.760870000000004:0.0009%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99946%,0:0.0009%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99946%,2:0.00036%,1:0.00018%]
[INFO] ** proxy_src_ip:[18:38.45689%,20:25.95149%,13:18.09663%,6:17.49392%,7:0.00036%,17:0.00018%,16:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95077%,-0.32151:21.08877%,-1.27613:18.09645%,-0.23351:17.49338%,-0.33484:17.36812%,-0.24151:0.00036%,1.45709:0.00036%,-64.19493:0.00018%,10.192739999999999:0.00018%,-1.02014:0.00018%,-71.14798:0.00018%,-61.95768:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-71.33197:0.00018%]
[INFO] ** scada_tag:[3:25.95041%,1:21.08877%,5:18.09645%,4:17.4932%,2:17.36812%,0:0.00306%]
[INFO] ** service:[0.0048200000000000005:99.99928%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%,-211.73542999999998:0.00018%]
[INFO] ** src:[22:38.45689%,9:25.95149%,7:18.09663%,1:17.49392%,21:0.00036%,16:0.00018%,15:0.00018%,14:0.00018%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1510 (0.27175%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0936 - tp: 78312.0000 - fp: 1688.0000 - tn: 318312.0000 - fn: 1688.0000 - accuracy: 0.9916 - precision: 0.9789 - recall: 0.9789 - auc: 0.9965 - val_loss: 0.0208 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0960 - tp: 78257.0000 - fp: 1743.0000 - tn: 318257.0000 - fn: 1743.0000 - accuracy: 0.9913 - precision: 0.9782 - recall: 0.9782 - auc: 0.9964 - val_loss: 0.0214 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0971 - tp: 78228.0000 - fp: 1772.0000 - tn: 318228.0000 - fn: 1772.0000 - accuracy: 0.9911 - precision: 0.9779 - recall: 0.9779 - auc: 0.9963 - val_loss: 0.0219 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0936 - tp: 78319.0000 - fp: 1681.0000 - tn: 318319.0000 - fn: 1681.0000 - accuracy: 0.9916 - precision: 0.9790 - recall: 0.9790 - auc: 0.9965 - val_loss: 0.0213 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0995 - tp: 78173.0000 - fp: 1827.0000 - tn: 318173.0000 - fn: 1827.0000 - accuracy: 0.9909 - precision: 0.9772 - recall: 0.9772 - auc: 0.9962 - val_loss: 0.0221 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 39-39/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.40208%,Single Stage Single Point:35.59792%]
[INFO] ** dst:[21:43.32177%,10:21.07941%,8:18.13316%,9:17.46458%,22:0.0009%,24:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99982%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.44807%,20:25.95347%,13:18.13334%,6:17.46458%,16:0.00054%]
[INFO] ** s_port:[1.45442:25.95293%,-0.32151:21.07941%,-1.27613:18.13298%,-0.23351:17.4644%,-0.33484:17.36866%,-1.02014:0.00054%,-1.27347:0.00018%,1.45709:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.2708:0.00018%]
[INFO] ** scada_tag:[3:25.95257%,1:21.07923%,5:18.1328%,4:17.4644%,2:17.36848%,0:0.00252%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.44807%,9:25.95347%,7:18.13334%,1:17.46458%,15:0.00054%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1508 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0964 - tp: 78249.0000 - fp: 1751.0000 - tn: 318249.0000 - fn: 1751.0000 - accuracy: 0.9912 - precision: 0.9781 - recall: 0.9781 - auc: 0.9964 - val_loss: 0.0216 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0592 - tp: 79056.0000 - fp: 944.0000 - tn: 319056.0000 - fn: 944.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9983 - val_loss: 0.0147 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0583 - tp: 79077.0000 - fp: 923.0000 - tn: 319077.0000 - fn: 923.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9981 - val_loss: 0.0127 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0565 - tp: 79109.0000 - fp: 891.0000 - tn: 319109.0000 - fn: 891.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9982 - val_loss: 0.0118 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0554 - tp: 79130.0000 - fp: 870.0000 - tn: 319130.0000 - fn: 870.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9982 - val_loss: 0.0112 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 40-40/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:99.9964%,30:0.00306%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.33801%,Single Stage Single Point:35.66199%]
[INFO] ** dst:[21:43.29621%,10:21.03694%,8:18.19615%,9:17.46602%,15:0.00306%,22:0.0009%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99712%,0:0.00288%]
[INFO] ** i/f_name:[2:99.99694%,3:0.00306%]
[INFO] ** modbus_function_code:[0.02961:99.9964%,-33.760870000000004:0.0036%]
[INFO] ** modbus_function_description:[7:49.99928%,11:49.99712%,0:0.0036%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:99.99964%,1:0.00036%]
[INFO] ** proto:[0:99.9964%,1:0.00306%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.35665%,20:25.9774%,13:18.19597%,6:17.46638%,17:0.00306%,14:0.00054%]
[INFO] ** s_port:[1.45442:25.9765%,-0.32151:21.03694%,-1.27613:18.19579%,-0.23351:17.46584%,-0.33484:17.31971%,-71.33197:0.00306%,1.45709:0.00054%,-0.24151:0.00036%,-71.14798:0.00018%,-1.27347:0.00018%,11.862:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,13.431270000000001:0.00018%]
[INFO] ** scada_tag:[3:25.97614%,1:21.03676%,5:18.19561%,4:17.46548%,2:17.31953%,0:0.00648%]
[INFO] ** service:[0.0048200000000000005:99.9964%,-211.73542999999998:0.00306%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.35665%,9:25.9774%,7:18.19597%,1:17.46638%,14:0.00306%,2:0.00054%]
[INFO] ** type:[0:99.9991%,1:0.0009%]
[INFO] ** unixtime:1511 (0.27193%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0566 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9982 - val_loss: 0.0120 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0550 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9982 - val_loss: 0.0109 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0540 - tp: 79156.0000 - fp: 844.0000 - tn: 319156.0000 - fn: 844.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9983 - val_loss: 0.0105 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0577 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9981 - val_loss: 0.0108 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0571 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9981 - val_loss: 0.0109 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 41-41/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (495814, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (495814, 17)

[INFO] analyzing data
[INFO] 495814 rows
[INFO] ** appi_name:[21:99.99657%,30:0.00101%,22:0.00081%,17:0.00081%,32:0.0002%,28:0.0002%,26:0.0002%,7:0.0002%]
[INFO] ** classification:[normal:64.38786%,Single Stage Single Point:35.61214%]
[INFO] ** dst:[21:43.32008%,10:21.06354%,8:18.14108%,9:17.47087%,16:0.00101%,15:0.00101%,6:0.00101%,22:0.00061%,24:0.0004%,17:0.0004%]
[INFO] ** i/f_dir:[1:99.99899%,0:0.00101%]
[INFO] ** i/f_name:[2:99.99899%,3:0.00101%]
[INFO] ** modbus_function_code:[0.02961:99.99657%,-33.760870000000004:0.00343%]
[INFO] ** modbus_function_description:[7:49.99899%,11:49.99758%,0:0.00343%]
[INFO] ** modbus_transaction_id:65536 (13.21786%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99778%,2:0.00121%,1:0.00101%]
[INFO] ** proxy_src_ip:[18:38.43256%,20:25.95126%,13:18.14128%,6:17.47107%,17:0.00101%,1:0.00081%,21:0.0004%,16:0.0004%,14:0.0004%,0:0.0004%,7:0.0002%,2:0.0002%]
[INFO] ** s_port:[1.45442:25.95086%,-0.32151:21.06354%,-1.27613:18.14067%,-0.23351:17.47066%,-0.33484:17.36901%,-71.33197:0.00101%,-71.14931:0.00081%,-1.02014:0.0004%,-1.27347:0.0004%,-71.14798:0.0002%,-0.24151:0.0002%,-58.035180000000004:0.0002%,-1.2708:0.0002%,-5.1466400000000005:0.0002%,1.47576:0.0002%,1.46509:0.0002%,-64.19226:0.0002%,-5.08665:0.0002%,-0.24950999999999998:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:25.95066%,1:21.06354%,5:18.14067%,4:17.47046%,2:17.36901%,0:0.00565%]
[INFO] ** service:[0.0048200000000000005:99.99657%,-211.73542999999998:0.00101%,-205.44247:0.00081%,-211.08818:0.00081%,89.64175:0.0002%,-211.09762999999998:0.0002%,-211.08346:0.0002%,-185.9872:0.0002%]
[INFO] ** src:[22:38.43256%,9:25.95126%,7:18.14128%,1:17.47107%,14:0.00101%,3:0.00081%,15:0.0004%,8:0.0004%,4:0.0004%,2:0.0004%,21:0.0002%,17:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1345 (0.27127%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/495814
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0585 - tp: 79072.0000 - fp: 928.0000 - tn: 319072.0000 - fn: 928.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9981 - val_loss: 0.0120 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/495814
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0598 - tp: 79046.0000 - fp: 954.0000 - tn: 319046.0000 - fn: 954.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9980 - val_loss: 0.0116 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/495814
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0566 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9982 - val_loss: 0.0120 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/495814
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0572 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9981 - val_loss: 0.0121 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/495814
[33m[INFO] loading file 42-42/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (439328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (439328, 17)

[INFO] analyzing data
[INFO] 439328 rows
[INFO] ** appi_name:[21:99.99203%,30:0.00228%,17:0.00114%,31:0.00091%,26:0.00091%,7:0.00091%,22:0.00068%,28:0.00023%,27:0.00023%,9:0.00023%,8:0.00023%,0:0.00023%]
[INFO] ** classification:[normal:64.38037%,Single Stage Single Point:35.61963%]
[INFO] ** dst:[21:43.31843%,10:21.05329%,8:18.17139%,9:17.44778%,16:0.00205%,6:0.00182%,18:0.00114%,22:0.00091%,15:0.00091%,2:0.00091%,17:0.00046%,25:0.00023%,24:0.00023%,7:0.00023%,0:0.00023%]
[INFO] ** i/f_dir:[1:99.99909%,0:0.00091%]
[INFO] ** i/f_name:[2:99.99909%,3:0.00091%]
[INFO] ** modbus_function_code:[0.02961:99.99203%,-33.760870000000004:0.00797%]
[INFO] ** modbus_function_description:[7:49.99704%,11:49.99499%,0:0.00797%]
[INFO] ** modbus_transaction_id:65536 (14.91733%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99568%,2:0.00341%,1:0.00091%]
[INFO] ** proxy_src_ip:[18:38.41003%,20:25.96192%,13:18.17184%,6:17.44778%,17:0.00228%,1:0.00205%,14:0.00137%,21:0.00091%,7:0.00068%,16:0.00046%,0:0.00046%,2:0.00023%]
[INFO] ** s_port:[1.45442:25.96147%,-0.32151:21.05329%,-1.27613:18.17139%,-0.23351:17.44756%,-0.33484:17.35674%,-71.14798:0.00091%,-71.33197:0.00091%,-71.14931:0.00091%,11.57001:0.00046%,-0.08551:0.00046%,-3.3787199999999995:0.00046%,-1.02014:0.00046%,-5.1466400000000005:0.00023%,-0.24151:0.00023%,13.431270000000001:0.00023%,0.31847:0.00023%,-1.2708:0.00023%,-58.035180000000004:0.00023%,7.66617:0.00023%,-64.19493:0.00023%,1.47576:0.00023%,14.4699:0.00023%,15.912510000000001:0.00023%,14.191239999999999:0.00023%,7.9608300000000005:0.00023%,-5.08665:0.00023%,10.192739999999999:0.00023%,-3.0613900000000003:0.00023%,1.45709:0.00023%,2.05573:0.00023%,-43.76509:0.00023%,11.862:0.00023%,-1.27347:0.00023%,-58.032509999999995:0.00023%]
[INFO] ** scada_tag:[3:25.96101%,1:21.05329%,5:18.17116%,4:17.44756%,2:17.35651%,0:0.01047%]
[INFO] ** service:[0.0048200000000000005:99.99203%,-211.09762999999998:0.00159%,-205.44247:0.00114%,-186.43601999999998:0.00114%,-211.08346:0.00091%,-211.73542999999998:0.00091%,-211.08818:0.00091%,-211.35747999999998:0.00046%,-186.44547:0.00023%,-183.8612:0.00023%,-185.9872:0.00023%,-202.75898:0.00023%]
[INFO] ** src:[22:38.41003%,9:25.96192%,7:18.17184%,1:17.44778%,3:0.00273%,2:0.00159%,4:0.00114%,21:0.00091%,14:0.00091%,15:0.00046%,8:0.00046%,17:0.00023%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1192 (0.27132%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/439328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0572 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9981 - val_loss: 0.0114 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/439328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0582 - tp: 79083.0000 - fp: 917.0000 - tn: 319083.0000 - fn: 917.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9981 - val_loss: 0.0112 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/439328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0553 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9982 - val_loss: 0.0107 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/439328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0539 - tp: 79158.0000 - fp: 842.0000 - tn: 319158.0000 - fn: 842.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9983 - val_loss: 0.0106 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-41-42-batch-300000-400000
[INFO] processing batch 400000-500000/439328
[33m[INFO] loading file 43-43/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99926%,30:0.00056%,26:0.00019%]
[INFO] ** classification:[normal:64.39569%,Single Stage Single Point:35.60431%]
[INFO] ** dst:[21:43.32688%,10:21.06714%,8:18.13182%,9:17.4723%,22:0.00093%,15:0.00056%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99926%,-33.760870000000004:0.00074%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99907%,0:0.00074%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99926%,1:0.00056%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.41577%,20:25.97881%,13:18.13201%,6:17.4723%,17:0.00056%,16:0.00037%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.97807%,-0.32151:21.06714%,-1.27613:18.13164%,-0.23351:17.47193%,-0.33484:17.34863%,-71.33197:0.00056%,1.45709:0.00037%,1.47576:0.00037%,-1.02014:0.00037%,-71.14798:0.00019%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.9777%,1:21.06714%,5:18.13145%,4:17.47156%,2:17.34844%,0:0.00371%]
[INFO] ** service:[0.0048200000000000005:99.99926%,-211.73542999999998:0.00056%,-211.08346:0.00019%]
[INFO] ** src:[22:38.41577%,9:25.97881%,7:18.13201%,1:17.4723%,14:0.00056%,15:0.00037%,3:0.00019%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1467 (0.27201%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0553 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9982 - val_loss: 0.0107 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0561 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9982 - val_loss: 0.0111 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0582 - tp: 79075.0000 - fp: 925.0000 - tn: 319075.0000 - fn: 925.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9981 - val_loss: 0.0111 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0556 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9982 - val_loss: 0.0111 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0567 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9982 - val_loss: 0.0111 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 44-44/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99815%,30:0.00074%,31:0.00056%,0:0.00037%,22:0.00019%]
[INFO] ** classification:[normal:64.38123%,Single Stage Single Point:35.61877%]
[INFO] ** dst:[21:43.33411%,10:21.04397%,8:18.15611%,9:17.46247%,22:0.00111%,15:0.00074%,18:0.00056%,25:0.00037%,24:0.00037%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99926%,0:0.00074%]
[INFO] ** i/f_name:[2:99.99926%,3:0.00074%]
[INFO] ** modbus_function_code:[0.02961:99.99815%,-33.760870000000004:0.00185%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99796%,0:0.00185%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99815%,2:0.00111%,1:0.00074%]
[INFO] ** proxy_src_ip:[18:38.42226%,20:25.95638%,13:18.1563%,6:17.46303%,17:0.00074%,7:0.00037%,16:0.00019%,5:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95563%,-0.32151:21.04397%,-1.27613:18.15574%,-0.23351:17.46229%,-0.33484:17.37829%,-71.33197:0.00074%,-0.24151:0.00056%,-0.08551:0.00037%,-64.19493:0.00037%,-1.27347:0.00037%,1.45709:0.00037%,-1.02014:0.00019%,-1.2708:0.00019%,1.47576:0.00019%,-71.14931:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,4.42897:0.00019%]
[INFO] ** scada_tag:[3:25.95508%,1:21.04397%,5:18.15574%,4:17.46192%,2:17.37811%,0:0.00519%]
[INFO] ** service:[0.0048200000000000005:99.99815%,-211.73542999999998:0.00074%,-186.43601999999998:0.00056%,-186.44547:0.00037%,-211.08818:0.00019%]
[INFO] ** src:[22:38.42226%,9:25.95638%,7:18.1563%,1:17.46303%,14:0.00074%,21:0.00037%,17:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1463 (0.27126%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0565 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9982 - val_loss: 0.0118 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0563 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9982 - val_loss: 0.0109 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0562 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9982 - val_loss: 0.0110 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0567 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9982 - val_loss: 0.0111 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0569 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9982 - val_loss: 0.0110 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 45-45/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99907%,30:0.00056%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.41813%,Single Stage Single Point:35.58187%]
[INFO] ** dst:[21:43.3254%,10:21.09032%,8:18.11884%,9:17.46321%,22:0.0013%,15:0.00056%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99907%,-33.760870000000004:0.00093%]
[INFO] ** modbus_function_description:[7:50.00074%,11:49.99833%,0:0.00093%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99926%,1:0.00056%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.49012%,20:25.92634%,13:18.11866%,6:17.46358%,17:0.00056%,16:0.00037%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.9256%,-0.32151:21.09032%,-1.27613:18.11866%,-0.23351:17.46303%,-0.33484:17.3998%,1.45709:0.00056%,-71.33197:0.00056%,-0.24151:0.00037%,-1.02014:0.00037%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,14.4699:0.00019%]
[INFO] ** scada_tag:[3:25.92504%,1:21.09013%,5:18.11866%,4:17.46303%,2:17.39962%,0:0.00352%]
[INFO] ** service:[0.0048200000000000005:99.99907%,-211.73542999999998:0.00056%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.49012%,9:25.92634%,7:18.11866%,1:17.46358%,14:0.00056%,15:0.00037%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1463 (0.27126%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0549 - tp: 79143.0000 - fp: 857.0000 - tn: 319143.0000 - fn: 857.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9982 - val_loss: 0.0108 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0560 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9982 - val_loss: 0.0109 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0561 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9982 - val_loss: 0.0110 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0571 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9981 - val_loss: 0.0111 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0558 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9982 - val_loss: 0.0109 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 46-46/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99815%,30:0.00111%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.42925%,Single Stage Single Point:35.57075%]
[INFO] ** dst:[21:43.35136%,10:21.07512%,8:18.09808%,9:17.47267%,22:0.00111%,15:0.00111%,25:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99907%,0:0.00093%]
[INFO] ** i/f_name:[2:99.99889%,3:0.00111%]
[INFO] ** modbus_function_code:[0.02961:99.99815%,-33.760870000000004:0.00185%]
[INFO] ** modbus_function_description:[11:49.99907%,7:49.99907%,0:0.00185%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.99852%,1:0.00111%,2:0.00037%]
[INFO] ** proxy_src_ip:[18:38.45452%,20:25.97195%,13:18.09808%,6:17.47323%,17:0.00111%,16:0.00037%,7:0.00037%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97158%,-0.32151:21.07493%,-1.27613:18.09789%,-0.23351:17.47248%,-0.33484:17.37959%,-71.33197:0.00111%,-0.24151:0.00056%,-1.02014:0.00037%,-71.14798:0.00019%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-1.2708:0.00019%,10.192739999999999:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:25.97121%,1:21.07474%,5:18.09771%,4:17.47211%,2:17.37959%,0:0.00464%]
[INFO] ** service:[0.0048200000000000005:99.99833%,-211.73542999999998:0.00111%,-211.08346:0.00019%,-205.44247:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.45452%,9:25.97195%,7:18.09808%,1:17.47323%,14:0.00111%,21:0.00037%,15:0.00037%,16:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99907%,1:0.00093%]
[INFO] ** unixtime:1466 (0.27182%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0528 - tp: 79189.0000 - fp: 811.0000 - tn: 319189.0000 - fn: 811.0000 - accuracy: 0.9959 - precision: 0.9899 - recall: 0.9899 - auc: 0.9983 - val_loss: 0.0104 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0564 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9982 - val_loss: 0.0107 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0573 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9981 - val_loss: 0.0110 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0553 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9982 - val_loss: 0.0108 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0543 - tp: 79154.0000 - fp: 846.0000 - tn: 319154.0000 - fn: 846.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9983 - val_loss: 0.0106 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 47-47/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99944%,33:0.00019%,26:0.00019%,17:0.00019%]
[INFO] ** classification:[normal:64.39458%,Single Stage Single Point:35.60542%]
[INFO] ** dst:[21:43.30704%,10:21.0855%,8:18.12719%,9:17.47786%,22:0.00167%,24:0.00037%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99944%,-33.760870000000004:0.00056%]
[INFO] ** modbus_function_description:[7:50.00111%,11:49.99833%,0:0.00056%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99981%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.45712%,20:25.93617%,13:18.12756%,6:17.47823%,16:0.00037%,7:0.00037%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.93524%,-0.32151:21.0855%,-1.27613:18.127%,-0.23351:17.47768%,-0.33484:17.37162%,1.45709:0.00056%,-0.24151:0.00056%,-1.27347:0.00037%,-1.02014:0.00037%,-71.14798:0.00019%,-61.95635:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,10.192739999999999:0.00019%]
[INFO] ** scada_tag:[3:25.93468%,1:21.08531%,5:18.12682%,4:17.47749%,2:17.37143%,0:0.00426%]
[INFO] ** service:[0.0048200000000000005:99.99963%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.45712%,9:25.93617%,7:18.12756%,1:17.47823%,21:0.00037%,15:0.00037%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1464 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0552 - tp: 79136.0000 - fp: 864.0000 - tn: 319136.0000 - fn: 864.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9982 - val_loss: 0.0106 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0561 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9982 - val_loss: 0.0108 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0622 - tp: 78995.0000 - fp: 1005.0000 - tn: 318995.0000 - fn: 1005.0000 - accuracy: 0.9950 - precision: 0.9874 - recall: 0.9874 - auc: 0.9979 - val_loss: 0.0121 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0558 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9982 - val_loss: 0.0114 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0569 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9982 - val_loss: 0.0120 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 48-48/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99666%,30:0.0026%,33:0.00019%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.42313%,Single Stage Single Point:35.57687%]
[INFO] ** dst:[21:43.33485%,10:21.08439%,8:18.11106%,9:17.46544%,15:0.0026%,22:0.00093%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99778%,0:0.00222%]
[INFO] ** i/f_name:[2:99.9974%,3:0.0026%]
[INFO] ** modbus_function_code:[0.02961:99.99666%,-33.760870000000004:0.00334%]
[INFO] ** modbus_function_description:[7:49.99889%,11:49.99778%,0:0.00334%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99685%,1:0.0026%,2:0.00056%]
[INFO] ** proxy_src_ip:[18:38.4586%,20:25.96083%,13:18.11143%,6:17.46544%,17:0.0026%,14:0.00056%,16:0.00037%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.96045%,-0.32151:21.08439%,-1.27613:18.11106%,-0.23351:17.46525%,-0.33484:17.37421%,-71.33197:0.0026%,-1.02014:0.00037%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,1.45709:0.00019%,-61.95635:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,13.431270000000001:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.96008%,1:21.08439%,5:18.11106%,4:17.46525%,2:17.37403%,0:0.00519%]
[INFO] ** service:[0.0048200000000000005:99.99685%,-211.73542999999998:0.0026%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.4586%,9:25.96083%,7:18.11143%,1:17.46544%,14:0.0026%,2:0.00056%,15:0.00037%,8:0.00019%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1463 (0.27126%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0592 - tp: 79057.0000 - fp: 943.0000 - tn: 319057.0000 - fn: 943.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9981 - val_loss: 0.0115 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0586 - tp: 79065.0000 - fp: 935.0000 - tn: 319065.0000 - fn: 935.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9981 - val_loss: 0.0116 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0554 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9982 - val_loss: 0.0112 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0556 - tp: 79144.0000 - fp: 856.0000 - tn: 319144.0000 - fn: 856.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9982 - val_loss: 0.0107 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0569 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9982 - val_loss: 0.0112 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 49-49/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99722%,30:0.00093%,17:0.00074%,26:0.00037%,22:0.00037%,28:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.37048%,Single Stage Single Point:35.62952%]
[INFO] ** dst:[21:43.30964%,10:21.05639%,8:18.13813%,9:17.4914%,22:0.0013%,15:0.00093%,16:0.00074%,6:0.00074%,24:0.00037%,17:0.00037%]
[INFO] ** i/f_dir:[1:99.99907%,0:0.00093%]
[INFO] ** i/f_name:[2:99.99907%,3:0.00093%]
[INFO] ** modbus_function_code:[0.02961:99.99722%,-33.760870000000004:0.00278%]
[INFO] ** modbus_function_description:[7:49.99944%,11:49.99778%,0:0.00278%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99833%,1:0.00093%,2:0.00074%]
[INFO] ** proxy_src_ip:[18:38.41762%,20:25.94914%,13:18.13813%,6:17.49195%,17:0.00093%,1:0.00074%,14:0.00056%,21:0.00037%,16:0.00037%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.9484%,-0.32151:21.05639%,-1.27613:18.13776%,-0.23351:17.49121%,-0.33484:17.36123%,-71.33197:0.00093%,-0.24151:0.00056%,-1.27347:0.00037%,-1.02014:0.00037%,1.45709:0.00037%,-71.14931:0.00037%,-71.14798:0.00037%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-5.1466400000000005:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,-5.08665:0.00019%]
[INFO] ** scada_tag:[3:25.94803%,1:21.0562%,5:18.13757%,4:17.49084%,2:17.36123%,0:0.00612%]
[INFO] ** service:[0.0048200000000000005:99.99722%,-211.73542999999998:0.00093%,-205.44247:0.00074%,-211.08346:0.00037%,-211.08818:0.00037%,-211.09762999999998:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.41762%,9:25.94914%,7:18.13813%,1:17.49195%,14:0.00093%,3:0.00074%,2:0.00056%,15:0.00037%,4:0.00037%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1465 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0582 - tp: 79077.0000 - fp: 923.0000 - tn: 319077.0000 - fn: 923.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9981 - val_loss: 0.0112 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0597 - tp: 79048.0000 - fp: 952.0000 - tn: 319048.0000 - fn: 952.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9980 - val_loss: 0.0118 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0572 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9981 - val_loss: 0.0113 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0542 - tp: 79152.0000 - fp: 848.0000 - tn: 319152.0000 - fn: 848.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9983 - val_loss: 0.0108 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0598 - tp: 79045.0000 - fp: 955.0000 - tn: 319045.0000 - fn: 955.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9980 - val_loss: 0.0114 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 50-50/50 on epoch 5/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (389310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (389310, 17)

[INFO] analyzing data
[INFO] 389310 rows
[INFO] ** appi_name:[21:99.99743%,30:0.00103%,7:0.00077%,31:0.00026%,22:0.00026%,8:0.00026%]
[INFO] ** classification:[normal:64.30197%,Single Stage Single Point:35.69803%]
[INFO] ** dst:[21:43.25884%,10:21.04005%,8:18.22301%,9:17.47476%,15:0.00103%,22:0.00051%,16:0.00051%,2:0.00051%,24:0.00026%,18:0.00026%,6:0.00026%]
[INFO] ** i/f_dir:[1:99.99897%,0:0.00103%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99743%,-33.760870000000004:0.00257%]
[INFO] ** modbus_function_description:[11:49.99872%,7:49.99872%,0:0.00257%]
[INFO] ** modbus_transaction_id:65536 (16.83389%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99846%,1:0.00103%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.36583%,20:25.93332%,13:18.22327%,6:17.47476%,17:0.00103%,1:0.00077%,21:0.00026%,16:0.00026%,14:0.00026%,7:0.00026%]
[INFO] ** s_port:[1.45442:25.9328%,-0.32151:21.04005%,-1.27613:18.22275%,-0.23351:17.47476%,-0.33484:17.32578%,-71.33197:0.00103%,-3.3787199999999995:0.00026%,4.33564:0.00026%,15.912510000000001:0.00026%,7.9608300000000005:0.00026%,1.46509:0.00026%,1.45709:0.00026%,-1.27347:0.00026%,-71.14931:0.00026%,-1.02014:0.00026%,-1.2708:0.00026%,0.31847:0.00026%]
[INFO] ** scada_tag:[3:25.93255%,1:21.03979%,5:18.2225%,4:17.47476%,2:17.32552%,0:0.00488%]
[INFO] ** service:[0.0048200000000000005:99.99743%,-211.73542999999998:0.00103%,-211.09762999999998:0.00077%,-186.43601999999998:0.00026%,-211.35747999999998:0.00026%,-211.08818:0.00026%]
[INFO] ** src:[22:38.36583%,9:25.93332%,7:18.22327%,1:17.47476%,14:0.00103%,3:0.00077%,21:0.00026%,15:0.00026%,4:0.00026%,2:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1058 (0.27176%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/389310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0569 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9982 - val_loss: 0.0112 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/389310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0569 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9982 - val_loss: 0.0111 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/389310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0578 - tp: 79084.0000 - fp: 916.0000 - tn: 319084.0000 - fn: 916.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9981 - val_loss: 0.0112 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/389310
[33m[INFO] epoch 6/100[0m
[33m[INFO] loading file 1-1/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99338%,22:0.00102%,30:0.00102%,7:0.00068%,17:0.00068%,31:0.00051%,26:0.00051%,23:0.00034%,18:0.00034%,0:0.00034%,24:0.00017%,27:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,28:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:77.01872%,Single Stage Single Point:22.98128%]
[INFO] ** dst:[21:43.27043%,10:21.02968%,8:18.17481%,9:17.51794%,6:0.00153%,22:0.00102%,16:0.00102%,15:0.00102%,18:0.00051%,26:0.00034%,25:0.00034%,19:0.00034%,17:0.00034%,2:0.00034%,24:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.99898%,0:0.00102%]
[INFO] ** i/f_name:[2:99.99898%,3:0.00102%]
[INFO] ** modbus_function_code:[0.02961:99.99338%,-33.760870000000004:0.00645%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99762%,11:49.99576%,0:0.00645%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99644%,2:0.00255%,1:0.00102%]
[INFO] ** proxy_src_ip:[18:38.38896%,20:25.91081%,13:18.17498%,6:17.51828%,11:0.00119%,10:0.00119%,1:0.00119%,17:0.00102%,14:0.00085%,21:0.00051%,7:0.00051%,16:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.9103%,-0.32151:21.029%,-1.27613:18.17464%,-0.23351:17.51778%,-0.33484:17.35996%,-71.33197:0.00102%,-71.14931:0.00102%,-2.1481:0.00068%,-71.14798:0.00051%,-0.24151:0.00051%,-64.19493:0.00034%,-2.42942:0.00034%,4.44364:0.00034%,-1.02014:0.00034%,1.47576:0.00017%,6.1115699999999995:0.00017%,-1.27347:0.00017%,10.67005:0.00017%,4.29964:0.00017%,-5.08665:0.00017%,-3.3787199999999995:0.00017%,1.45709:0.00017%,-68.79874000000001:0.00017%,2.05573:0.00017%,-5.1466400000000005:0.00017%,-43.76509:0.00017%,14.253910000000001:0.00017%,4.076980000000001:0.00017%,-58.032509999999995:0.00017%,-58.035180000000004:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,0.31847:0.00017%]
[INFO] ** scada_tag:[3:25.91013%,1:21.02883%,5:18.17431%,4:17.51761%,2:17.35979%,0:0.00933%]
[INFO] ** service:[0.0048200000000000005:99.99406%,-211.73542999999998:0.00102%,-211.08818:0.00102%,-211.09762999999998:0.00068%,-205.44247:0.00068%,-211.07873999999998:0.00068%,-211.08346:0.00051%,-186.43601999999998:0.00051%,-186.44547:0.00034%,-185.9872:0.00017%,-211.35747999999998:0.00017%,-202.75898:0.00017%]
[INFO] ** src:[22:38.38896%,9:25.91081%,7:18.17498%,1:17.51828%,11:0.00119%,10:0.00119%,3:0.00119%,14:0.00102%,2:0.00085%,21:0.00051%,4:0.00051%,15:0.00034%,8:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1599 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0576 - tp: 79086.0000 - fp: 914.0000 - tn: 319086.0000 - fn: 914.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9981 - val_loss: 3.0592 - val_tp: 16218.0000 - val_fp: 3782.0000 - val_tn: 76218.0000 - val_fn: 3782.0000 - val_accuracy: 0.9244 - val_precision: 0.8109 - val_recall: 0.8109 - val_auc: 0.8513
[INFO] saving weights to checkpoints/lstm-epoch-6-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2428 - tp: 78511.0000 - fp: 1489.0000 - tn: 318511.0000 - fn: 1489.0000 - accuracy: 0.9926 - precision: 0.9814 - recall: 0.9814 - auc: 0.9870 - val_loss: 0.0068 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0066 - tp: 79981.0000 - fp: 19.0000 - tn: 319981.0000 - fn: 19.0000 - accuracy: 0.9999 - precision: 0.9998 - recall: 0.9998 - auc: 1.0000 - val_loss: 0.0053 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2898 - tp: 74753.0000 - fp: 5247.0000 - tn: 314753.0000 - fn: 5247.0000 - accuracy: 0.9738 - precision: 0.9344 - recall: 0.9344 - auc: 0.9884 - val_loss: 1.7843 - val_tp: 10573.0000 - val_fp: 9427.0000 - val_tn: 70573.0000 - val_fn: 9427.0000 - val_accuracy: 0.8115 - val_precision: 0.5286 - val_recall: 0.5286 - val_auc: 0.9176
[INFO] saving weights to checkpoints/lstm-epoch-6-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3631 - tp: 42475.0000 - fp: 37525.0000 - tn: 282475.0000 - fn: 37525.0000 - accuracy: 0.8124 - precision: 0.5309 - recall: 0.5309 - auc: 0.9192 - val_loss: 1.0849 - val_tp: 10611.0000 - val_fp: 9389.0000 - val_tn: 70611.0000 - val_fn: 9389.0000 - val_accuracy: 0.8122 - val_precision: 0.5306 - val_recall: 0.5306 - val_auc: 0.9245
[INFO] saving weights to checkpoints/lstm-epoch-6-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 2-2/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99864%,30:0.00051%,7:0.00051%,31:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:69.79943%,Single Stage Single Point:30.20057%]
[INFO] ** dst:[21:43.30895%,10:21.02985%,8:18.13579%,9:17.52304%,22:0.00085%,15:0.00051%,16:0.00034%,2:0.00034%,24:0.00017%,18:0.00017%]
[INFO] ** i/f_dir:[1:99.99949%,0:0.00051%]
[INFO] ** i/f_name:[2:99.99949%,3:0.00051%]
[INFO] ** modbus_function_code:[0.02961:99.99864%,-33.760870000000004:0.00136%]
[INFO] ** modbus_function_description:[7:49.99983%,11:49.99881%,0:0.00136%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99932%,1:0.00051%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.38336%,20:25.95595%,13:18.13579%,6:17.52337%,17:0.00051%,1:0.00051%,16:0.00017%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.95527%,-0.32151:21.02985%,-1.27613:18.13545%,-0.23351:17.52287%,-0.33484:17.35352%,-71.33197:0.00051%,-0.24151:0.00034%,1.45709:0.00034%,1.46509:0.00017%,1.47576:0.00017%,12.60597:0.00017%,10.67005:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,4.076980000000001:0.00017%,-3.3787199999999995:0.00017%,4.29964:0.00017%,-1.27347:0.00017%]
[INFO] ** scada_tag:[3:25.95493%,1:21.02985%,5:18.13545%,4:17.52253%,2:17.35335%,0:0.0039%]
[INFO] ** service:[0.0048200000000000005:99.99864%,-211.09762999999998:0.00051%,-211.73542999999998:0.00051%,-211.35747999999998:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.38336%,9:25.95595%,7:18.13579%,1:17.52337%,14:0.00051%,3:0.00051%,21:0.00017%,15:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1602 (0.27184%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.9240 - tp: 42452.0000 - fp: 37548.0000 - tn: 282452.0000 - fn: 37548.0000 - accuracy: 0.8123 - precision: 0.5307 - recall: 0.5307 - auc: 0.9214 - val_loss: 0.7844 - val_tp: 10587.0000 - val_fp: 9413.0000 - val_tn: 70587.0000 - val_fn: 9413.0000 - val_accuracy: 0.8117 - val_precision: 0.5293 - val_recall: 0.5293 - val_auc: 0.9242
[INFO] saving weights to checkpoints/lstm-epoch-6-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6942 - tp: 42437.0000 - fp: 37563.0000 - tn: 282437.0000 - fn: 37563.0000 - accuracy: 0.8122 - precision: 0.5305 - recall: 0.5305 - auc: 0.9215 - val_loss: 0.6065 - val_tp: 10599.0000 - val_fp: 9401.0000 - val_tn: 70599.0000 - val_fn: 9401.0000 - val_accuracy: 0.8120 - val_precision: 0.5300 - val_recall: 0.5300 - val_auc: 0.9243
[INFO] saving weights to checkpoints/lstm-epoch-6-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3127 - tp: 72625.0000 - fp: 7375.0000 - tn: 312625.0000 - fn: 7375.0000 - accuracy: 0.9631 - precision: 0.9078 - recall: 0.9078 - auc: 0.9847 - val_loss: 0.2091 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3633 - tp: 67398.0000 - fp: 12602.0000 - tn: 307398.0000 - fn: 12602.0000 - accuracy: 0.9370 - precision: 0.8425 - recall: 0.8425 - auc: 0.9742 - val_loss: 0.6733 - val_tp: 10605.0000 - val_fp: 9395.0000 - val_tn: 70605.0000 - val_fn: 9395.0000 - val_accuracy: 0.8121 - val_precision: 0.5303 - val_recall: 0.5303 - val_auc: 0.9245
[INFO] saving weights to checkpoints/lstm-epoch-6-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6010 - tp: 42322.0000 - fp: 37678.0000 - tn: 282322.0000 - fn: 37678.0000 - accuracy: 0.8116 - precision: 0.5290 - recall: 0.5290 - auc: 0.9228 - val_loss: 0.5268 - val_tp: 10586.0000 - val_fp: 9414.0000 - val_tn: 70586.0000 - val_fn: 9414.0000 - val_accuracy: 0.8117 - val_precision: 0.5293 - val_recall: 0.5293 - val_auc: 0.9242
[INFO] saving weights to checkpoints/lstm-epoch-6-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 3-3/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99219%,30:0.00204%,22:0.00102%,31:0.00085%,26:0.00085%,17:0.00085%,7:0.00068%,27:0.00034%,0:0.00034%,28:0.00017%,23:0.00017%,15:0.00017%,8:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:87.43514%,Single Stage Single Point:12.56486%]
[INFO] ** dst:[21:43.30794%,10:21.07804%,8:18.15971%,9:17.44566%,6:0.00204%,15:0.00136%,18:0.00119%,16:0.00119%,22:0.00085%,2:0.00034%,7:0.00034%,25:0.00034%,17:0.00034%,12:0.00017%,24:0.00017%,19:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99864%,0:0.00136%]
[INFO] ** i/f_name:[2:99.99864%,3:0.00136%]
[INFO] ** modbus_function_code:[0.02961:99.99219%,-33.760870000000004:0.00764%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99695%,11:49.99525%,0:0.00764%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99898%,2:0.00102%]
[INFO] ** proto:[0:99.99457%,2:0.00407%,1:0.00136%]
[INFO] ** proxy_src_ip:[18:38.40457%,20:25.98157%,13:18.16005%,6:17.446%,17:0.00204%,1:0.00136%,14:0.00119%,7:0.00085%,11:0.00068%,10:0.00068%,21:0.00051%,16:0.00017%,15:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.98089%,-0.32151:21.07787%,-1.27613:18.15937%,-0.23351:17.44549%,-0.33484:17.3267%,-71.33197:0.00136%,-71.14931:0.00102%,-71.14798:0.00102%,-64.19493:0.00034%,-1.2708:0.00034%,-0.08551:0.00034%,1.45709:0.00034%,-0.24151:0.00034%,13.86459:0.00017%,2.05573:0.00017%,6.1115699999999995:0.00017%,4.44364:0.00017%,-5.08665:0.00017%,-3.3787199999999995:0.00017%,10.192739999999999:0.00017%,4.29964:0.00017%,14.4699:0.00017%,-43.76509:0.00017%,-58.035180000000004:0.00017%,4.90362:0.00017%,4.076980000000001:0.00017%,-58.032509999999995:0.00017%,-1.27347:0.00017%,-1.02014:0.00017%,-5.1466400000000005:0.00017%,13.431270000000001:0.00017%,12.60597:0.00017%,1.47576:0.00017%,1.46509:0.00017%,14.253910000000001:0.00017%,-68.79874000000001:0.00017%,-0.24950999999999998:0.00017%,-2.1481:0.00017%,10.67005:0.00017%,-68.36943000000001:0.00017%]
[INFO] ** scada_tag:[3:25.98055%,1:21.0777%,5:18.1592%,4:17.44532%,2:17.32653%,0:0.01069%]
[INFO] ** service:[0.0048200000000000005:99.99236%,-211.73542999999998:0.00136%,-186.43601999999998:0.00119%,-211.08346:0.00102%,-211.08818:0.00102%,-205.44247:0.00085%,-211.09762999999998:0.00068%,-202.75898:0.00034%,-186.44547:0.00034%,-183.8612:0.00017%,-185.9872:0.00017%,-201.23771000000002:0.00017%,-211.35747999999998:0.00017%,-211.07873999999998:0.00017%]
[INFO] ** src:[22:38.40457%,9:25.98157%,7:18.16005%,1:17.446%,21:0.00187%,3:0.00153%,2:0.00119%,11:0.00068%,10:0.00068%,4:0.00068%,14:0.00034%,8:0.00034%,17:0.00017%,15:0.00017%,13:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1601 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3469 - tp: 72396.0000 - fp: 7604.0000 - tn: 312396.0000 - fn: 7604.0000 - accuracy: 0.9620 - precision: 0.9050 - recall: 0.9050 - auc: 0.9845 - val_loss: 0.3316 - val_tp: 17863.0000 - val_fp: 2137.0000 - val_tn: 77863.0000 - val_fn: 2137.0000 - val_accuracy: 0.9573 - val_precision: 0.8931 - val_recall: 0.8931 - val_auc: 0.9827
[INFO] saving weights to checkpoints/lstm-epoch-6-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5457 - tp: 42327.0000 - fp: 37673.0000 - tn: 282327.0000 - fn: 37673.0000 - accuracy: 0.8116 - precision: 0.5291 - recall: 0.5291 - auc: 0.9226 - val_loss: 0.4864 - val_tp: 10589.0000 - val_fp: 9411.0000 - val_tn: 70589.0000 - val_fn: 9411.0000 - val_accuracy: 0.8118 - val_precision: 0.5294 - val_recall: 0.5294 - val_auc: 0.9242
[INFO] saving weights to checkpoints/lstm-epoch-6-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4278 - tp: 62779.0000 - fp: 17221.0000 - tn: 302779.0000 - fn: 17221.0000 - accuracy: 0.9139 - precision: 0.7847 - recall: 0.7847 - auc: 0.9651 - val_loss: 0.3365 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2732 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.2126 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1800 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1470 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 4-4/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99779%,30:0.00119%,31:0.00034%,33:0.00017%,26:0.00017%,23:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:92.57097%,Single Stage Single Point:7.42903%]
[INFO] ** dst:[21:43.35019%,10:20.95026%,8:18.17651%,9:17.51947%,22:0.00119%,15:0.00119%,24:0.00034%,18:0.00034%,19:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99898%,0:0.00102%]
[INFO] ** i/f_name:[2:99.99881%,3:0.00119%]
[INFO] ** modbus_function_code:[0.02961:99.99779%,-33.760870000000004:0.00221%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99779%,0:0.00221%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99898%,2:0.00102%]
[INFO] ** proto:[0:99.9983%,1:0.00119%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.26034%,20:26.04045%,13:18.17668%,6:17.51981%,17:0.00119%,16:0.00051%,21:0.00034%,14:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.03978%,-0.32151:20.95009%,-1.27613:18.17617%,-0.23351:17.5193%,-0.33484:17.31024%,-71.33197:0.00119%,-1.02014:0.00051%,1.45709:0.00034%,-0.08551:0.00034%,-1.27347:0.00034%,-0.24151:0.00034%,14.4699:0.00017%,4.44364:0.00017%,-71.14798:0.00017%,-1.2708:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:26.03944%,1:20.94992%,5:18.17617%,4:17.51896%,2:17.31007%,0:0.00543%]
[INFO] ** service:[0.0048200000000000005:99.99796%,-211.73542999999998:0.00119%,-186.43601999999998:0.00034%,-183.8612:0.00017%,-211.08346:0.00017%,-211.07873999999998:0.00017%]
[INFO] ** src:[22:38.26034%,9:26.04045%,7:18.17668%,1:17.51981%,21:0.00102%,15:0.00051%,4:0.00034%,17:0.00017%,14:0.00017%,8:0.00017%,3:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1611 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1296 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1100 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0983 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0852 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0776 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0677 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0624 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0550 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6097 - tp: 64932.0000 - fp: 15068.0000 - tn: 304932.0000 - fn: 15068.0000 - accuracy: 0.9247 - precision: 0.8116 - recall: 0.8116 - auc: 0.9507 - val_loss: 1.3839 - val_tp: 7812.0000 - val_fp: 12188.0000 - val_tn: 67812.0000 - val_fn: 12188.0000 - val_accuracy: 0.7562 - val_precision: 0.3906 - val_recall: 0.3906 - val_auc: 0.8476
[INFO] saving weights to checkpoints/lstm-epoch-6-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 5-5/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99627%,30:0.00272%,37:0.00017%,26:0.00017%,12:0.00017%,9:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:87.62298%,Single Stage Single Point:12.37702%]
[INFO] ** dst:[21:43.36224%,10:20.77005%,8:18.24252%,9:17.62078%,15:0.00272%,22:0.00085%,25:0.00017%,24:0.00017%,6:0.00017%,2:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99762%,0:0.00238%]
[INFO] ** i/f_name:[2:99.99728%,3:0.00272%]
[INFO] ** modbus_function_code:[0.02961:99.99627%,-33.760870000000004:0.00373%]
[INFO] ** modbus_function_description:[7:49.99864%,11:49.99762%,0:0.00373%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99779%,2:0.00221%]
[INFO] ** proto:[0:99.99695%,1:0.00272%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.00682%,20:26.12581%,13:18.24252%,6:17.62095%,17:0.00272%,1:0.00034%,21:0.00017%,16:0.00017%,7:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.12513%,-0.32151:20.76971%,-1.27613:18.24235%,-0.23351:17.62061%,-0.33484:17.23711%,-71.33197:0.00272%,-0.24151:0.00034%,1.45709:0.00034%,1.47576:0.00017%,1.46509:0.00017%,-49.275529999999996:0.00017%,-1.27347:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,2.22906:0.00017%,14.4699:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.12479%,1:20.76954%,5:18.24218%,4:17.62061%,2:17.23694%,0:0.00594%]
[INFO] ** service:[0.0048200000000000005:99.99661%,-211.73542999999998:0.00272%,-183.8612:0.00017%,-211.08346:0.00017%,-211.35747999999998:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.00682%,9:26.12581%,7:18.24252%,1:17.62095%,21:0.00238%,14:0.00051%,3:0.00034%,16:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1614 (0.27388%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5365 - tp: 63397.0000 - fp: 16603.0000 - tn: 303397.0000 - fn: 16603.0000 - accuracy: 0.9170 - precision: 0.7925 - recall: 0.7925 - auc: 0.9468 - val_loss: 0.1585 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5231 - tp: 62666.0000 - fp: 17334.0000 - tn: 302666.0000 - fn: 17334.0000 - accuracy: 0.9133 - precision: 0.7833 - recall: 0.7833 - auc: 0.9508 - val_loss: 0.3645 - val_tp: 16669.0000 - val_fp: 3331.0000 - val_tn: 76669.0000 - val_fn: 3331.0000 - val_accuracy: 0.9334 - val_precision: 0.8335 - val_recall: 0.8335 - val_auc: 0.9853
[INFO] saving weights to checkpoints/lstm-epoch-6-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3017 - tp: 73405.0000 - fp: 6595.0000 - tn: 313405.0000 - fn: 6595.0000 - accuracy: 0.9670 - precision: 0.9176 - recall: 0.9176 - auc: 0.9832 - val_loss: 1.5561 - val_tp: 12817.0000 - val_fp: 7183.0000 - val_tn: 72817.0000 - val_fn: 7183.0000 - val_accuracy: 0.8563 - val_precision: 0.6409 - val_recall: 0.6409 - val_auc: 0.8440
[INFO] saving weights to checkpoints/lstm-epoch-6-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1455 - tp: 78978.0000 - fp: 1022.0000 - tn: 318978.0000 - fn: 1022.0000 - accuracy: 0.9949 - precision: 0.9872 - recall: 0.9872 - auc: 0.9963 - val_loss: 0.0741 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0670 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0524 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 6-6/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.9961%,30:0.00305%,31:0.00017%,27:0.00017%,26:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:93.14368%,Single Stage Single Point:6.85632%]
[INFO] ** dst:[21:43.37785%,10:20.73221%,8:18.27833%,9:17.60703%,15:0.00305%,22:0.00051%,25:0.00017%,24:0.00017%,18:0.00017%,12:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99712%,0:0.00288%]
[INFO] ** i/f_name:[2:99.99695%,3:0.00305%]
[INFO] ** modbus_function_code:[0.02961:99.9961%,-33.760870000000004:0.0039%]
[INFO] ** modbus_function_description:[7:49.99864%,11:49.99745%,0:0.0039%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.9961%,1:0.00305%,2:0.00085%]
[INFO] ** proxy_src_ip:[18:37.95031%,20:26.15992%,13:18.2785%,6:17.6072%,17:0.00305%,14:0.00051%,16:0.00034%,11:0.00017%]
[INFO] ** s_port:[1.45442:26.15958%,-0.32151:20.73221%,-1.27613:18.27799%,-0.23351:17.60686%,-0.33484:17.2181%,-71.33197:0.00305%,-1.02014:0.00034%,-71.14798:0.00017%,-64.19493:0.00017%,4.90362:0.00017%,-1.2708:0.00017%,-0.24151:0.00017%,13.431270000000001:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-68.36943000000001:0.00017%]
[INFO] ** scada_tag:[3:26.15941%,1:20.73187%,5:18.27782%,4:17.60652%,2:17.21793%,0:0.00645%]
[INFO] ** service:[0.0048200000000000005:99.9961%,-211.73542999999998:0.00305%,-211.08346:0.00017%,-201.23771000000002:0.00017%,-202.75898:0.00017%,-186.44547:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:37.95031%,9:26.15992%,7:18.2785%,1:17.6072%,14:0.00305%,2:0.00051%,15:0.00034%,10:0.00017%]
[INFO] ** type:[0:99.99915%,1:0.00085%]
[INFO] ** unixtime:1613 (0.27371%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0494 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0401 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0385 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0321 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0310 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0261 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0254 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0218 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0857 - tp: 78956.0000 - fp: 1044.0000 - tn: 318956.0000 - fn: 1044.0000 - accuracy: 0.9948 - precision: 0.9869 - recall: 0.9869 - auc: 0.9949 - val_loss: 1.3481 - val_tp: 12837.0000 - val_fp: 7163.0000 - val_tn: 72837.0000 - val_fn: 7163.0000 - val_accuracy: 0.8567 - val_precision: 0.6418 - val_recall: 0.6418 - val_auc: 0.8676
[INFO] saving weights to checkpoints/lstm-epoch-6-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 7-7/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99525%,30:0.00187%,22:0.00085%,17:0.00068%,26:0.00051%,31:0.00034%,28:0.00017%,27:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:79.87188%,Single Stage Single Point:20.12812%]
[INFO] ** dst:[21:43.36275%,10:20.7278%,8:18.2583%,9:17.6447%,15:0.00187%,22:0.00136%,6:0.00136%,16:0.00068%,24:0.00034%,18:0.00034%,17:0.00034%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.99813%,0:0.00187%]
[INFO] ** i/f_name:[2:99.99813%,3:0.00187%]
[INFO] ** modbus_function_code:[0.02961:99.99525%,-33.760870000000004:0.00475%]
[INFO] ** modbus_function_description:[7:49.9983%,11:49.99695%,0:0.00475%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99627%,2:0.00187%,1:0.00187%]
[INFO] ** proxy_src_ip:[18:37.94913%,20:26.1421%,13:18.25864%,6:17.64487%,17:0.00187%,11:0.00068%,1:0.00068%,21:0.00051%,16:0.00051%,14:0.00034%,7:0.00034%,10:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.14125%,-0.32151:20.7278%,-1.27613:18.25813%,-0.23351:17.64453%,-0.33484:17.22133%,-71.33197:0.00187%,-71.14931:0.00085%,-1.02014:0.00051%,-71.14798:0.00051%,1.45709:0.00051%,-0.24151:0.00034%,-1.27347:0.00034%,1.47576:0.00017%,1.46509:0.00017%,14.253910000000001:0.00017%,-1.2708:0.00017%,-58.035180000000004:0.00017%,-58.032509999999995:0.00017%,-68.79874000000001:0.00017%,-43.76509:0.00017%,2.05573:0.00017%,6.1115699999999995:0.00017%,-5.08665:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:26.14091%,1:20.7278%,5:18.25796%,4:17.64436%,2:17.22116%,0:0.00781%]
[INFO] ** service:[0.0048200000000000005:99.99525%,-211.73542999999998:0.00187%,-211.08818:0.00085%,-205.44247:0.00068%,-211.08346:0.00051%,-186.43601999999998:0.00034%,-211.09762999999998:0.00017%,-185.9872:0.00017%,-202.75898:0.00017%]
[INFO] ** src:[22:37.94913%,9:26.1421%,7:18.25864%,1:17.64487%,14:0.00187%,10:0.00068%,3:0.00068%,15:0.00051%,4:0.00051%,21:0.00034%,2:0.00034%,11:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99932%,1:0.00068%]
[INFO] ** unixtime:1611 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3953 - tp: 70499.0000 - fp: 9501.0000 - tn: 310499.0000 - fn: 9501.0000 - accuracy: 0.9525 - precision: 0.8812 - recall: 0.8812 - auc: 0.9756 - val_loss: 0.0294 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1684 - tp: 76431.0000 - fp: 3569.0000 - tn: 316431.0000 - fn: 3569.0000 - accuracy: 0.9822 - precision: 0.9554 - recall: 0.9554 - auc: 0.9916 - val_loss: 0.0326 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1690 - tp: 76379.0000 - fp: 3621.0000 - tn: 316379.0000 - fn: 3621.0000 - accuracy: 0.9819 - precision: 0.9547 - recall: 0.9547 - auc: 0.9918 - val_loss: 0.0346 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4645 - tp: 68059.0000 - fp: 11941.0000 - tn: 308059.0000 - fn: 11941.0000 - accuracy: 0.9403 - precision: 0.8507 - recall: 0.8507 - auc: 0.9749 - val_loss: 0.1303 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0536 - tp: 79900.0000 - fp: 100.0000 - tn: 319900.0000 - fn: 100.0000 - accuracy: 0.9995 - precision: 0.9987 - recall: 0.9987 - auc: 1.0000 - val_loss: 0.0376 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 8-8/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99678%,30:0.00102%,0:0.00051%,28:0.00017%,26:0.00017%,24:0.00017%,23:0.00017%,22:0.00017%,18:0.00017%,17:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:95.1506%,Single Stage Single Point:4.8494%]
[INFO] ** dst:[21:43.4162%,10:20.80179%,8:18.19535%,9:17.5826%,22:0.00136%,15:0.00102%,25:0.00051%,19:0.00034%,17:0.00034%,26:0.00017%,24:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99932%,0:0.00068%]
[INFO] ** i/f_name:[2:99.99898%,3:0.00102%]
[INFO] ** modbus_function_code:[0.02961:99.99678%,-33.760870000000004:0.00305%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99966%,11:49.99712%,0:0.00305%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99966%,2:0.00034%]
[INFO] ** proto:[0:99.99813%,1:0.00102%,2:0.00085%]
[INFO] ** proxy_src_ip:[18:38.08284%,20:26.13548%,13:18.19484%,6:17.58294%,17:0.00102%,10:0.00102%,16:0.00068%,1:0.00051%,14:0.00034%,11:0.00017%,5:0.00017%]
[INFO] ** s_port:[1.45442:26.13497%,-0.32151:20.80179%,-1.27613:18.1945%,-0.23351:17.58243%,-0.33484:17.28106%,-71.33197:0.00102%,-1.02014:0.00068%,-15.039579999999999:0.00068%,-64.19493:0.00051%,4.66896:0.00034%,-0.24151:0.00034%,1.45709:0.00034%,-5.1466400000000005:0.00017%,-1.27347:0.00017%,-1.2708:0.00017%,1.47576:0.00017%,-5.08665:0.00017%,-71.14931:0.00017%,-0.24950999999999998:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.13446%,1:20.80162%,5:18.1945%,4:17.58226%,2:17.28089%,0:0.00628%]
[INFO] ** service:[0.0048200000000000005:99.99745%,-211.73542999999998:0.00102%,-186.44547:0.00051%,-211.07873999999998:0.00034%,-211.08346:0.00017%,-185.9872:0.00017%,-205.44247:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.08284%,9:26.13548%,7:18.19484%,1:17.58294%,11:0.00102%,15:0.00068%,14:0.00068%,3:0.00051%,21:0.00034%,2:0.00034%,16:0.00017%,10:0.00017%]
[INFO] ** type:[0:99.99949%,1:0.00034%,2:0.00017%]
[INFO] ** unixtime:1613 (0.27371%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0328 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0287 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0255 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0227 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0185 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0168 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0153 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4347 - tp: 71224.0000 - fp: 8776.0000 - tn: 311224.0000 - fn: 8776.0000 - accuracy: 0.9561 - precision: 0.8903 - recall: 0.8903 - auc: 0.9726 - val_loss: 0.6368 - val_tp: 16394.0000 - val_fp: 3606.0000 - val_tn: 76394.0000 - val_fn: 3606.0000 - val_accuracy: 0.9279 - val_precision: 0.8197 - val_recall: 0.8197 - val_auc: 0.9549
[INFO] saving weights to checkpoints/lstm-epoch-6-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 9-9/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.9983%,30:0.00102%,31:0.00034%,26:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:93.94597%,Single Stage Single Point:6.05403%]
[INFO] ** dst:[21:43.38124%,10:20.77243%,8:18.27323%,9:17.57038%,15:0.00102%,22:0.00085%,18:0.00034%,25:0.00017%,24:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99898%,0:0.00102%]
[INFO] ** i/f_name:[2:99.99898%,3:0.00102%]
[INFO] ** modbus_function_code:[0.02961:99.9983%,-33.760870000000004:0.0017%]
[INFO] ** modbus_function_description:[7:49.99983%,11:49.99847%,0:0.0017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99966%,2:0.00034%]
[INFO] ** proto:[0:99.9983%,1:0.00102%,2:0.00068%]
[INFO] ** proxy_src_ip:[18:38.01225%,20:26.14193%,13:18.27323%,6:17.57072%,17:0.00102%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.14125%,-0.32151:20.77243%,-1.27613:18.2729%,-0.23351:17.57021%,-0.33484:17.23982%,-71.33197:0.00102%,-0.24151:0.00034%,1.45709:0.00034%,-0.08551:0.00034%,1.46509:0.00017%,1.47576:0.00017%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.14091%,1:20.77226%,5:18.2729%,4:17.57004%,2:17.23965%,0:0.00424%]
[INFO] ** service:[0.0048200000000000005:99.9983%,-211.73542999999998:0.00102%,-186.43601999999998:0.00034%,-211.08346:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.01225%,9:26.14193%,7:18.27323%,1:17.57072%,14:0.00068%,21:0.00034%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1614 (0.27388%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5735 - tp: 65490.0000 - fp: 14510.0000 - tn: 305490.0000 - fn: 14510.0000 - accuracy: 0.9275 - precision: 0.8186 - recall: 0.8186 - auc: 0.9548 - val_loss: 0.5257 - val_tp: 16361.0000 - val_fp: 3639.0000 - val_tn: 76361.0000 - val_fn: 3639.0000 - val_accuracy: 0.9272 - val_precision: 0.8181 - val_recall: 0.8181 - val_auc: 0.9545
[INFO] saving weights to checkpoints/lstm-epoch-6-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5061 - tp: 65274.0000 - fp: 14726.0000 - tn: 305274.0000 - fn: 14726.0000 - accuracy: 0.9264 - precision: 0.8159 - recall: 0.8159 - auc: 0.9541 - val_loss: 0.4057 - val_tp: 17198.0000 - val_fp: 2802.0000 - val_tn: 77198.0000 - val_fn: 2802.0000 - val_accuracy: 0.9440 - val_precision: 0.8599 - val_recall: 0.8599 - val_auc: 0.9650
[INFO] saving weights to checkpoints/lstm-epoch-6-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1054 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0795 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0654 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0542 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0467 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0403 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 10-10/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99644%,30:0.0017%,31:0.00034%,26:0.00017%,24:0.00017%,23:0.00017%,22:0.00017%,18:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:94.81614%,Single Stage Single Point:5.18386%]
[INFO] ** dst:[21:43.40924%,10:20.80891%,8:18.22793%,9:17.55002%,15:0.0017%,24:0.00051%,22:0.00051%,19:0.00034%,18:0.00034%,26:0.00017%,25:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99847%,0:0.00153%]
[INFO] ** i/f_name:[2:99.9983%,3:0.0017%]
[INFO] ** modbus_function_code:[0.02961:99.99644%,-33.760870000000004:0.00339%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99915%,11:49.99728%,0:0.00339%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99932%,1:0.00068%]
[INFO] ** proto:[0:99.99745%,1:0.0017%,2:0.00085%]
[INFO] ** proxy_src_ip:[18:38.08165%,20:26.13701%,13:18.22827%,6:17.54934%,17:0.0017%,10:0.00085%,14:0.00034%,21:0.00017%,16:0.00017%,5:0.00017%,2:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.13633%,-0.32151:20.80891%,-1.27613:18.22759%,-0.23351:17.549%,-0.33484:17.27274%,-71.33197:0.0017%,-10.51843:0.00068%,-1.27347:0.00051%,-0.08551:0.00034%,5.71692:0.00034%,1.47576:0.00034%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-71.14931:0.00017%,-64.19493:0.00017%,1.45709:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.13599%,1:20.80874%,5:18.22759%,4:17.54883%,2:17.27257%,0:0.00628%]
[INFO] ** service:[0.0048200000000000005:99.99712%,-211.73542999999998:0.0017%,-211.07873999999998:0.00034%,-186.43601999999998:0.00034%,-211.08346:0.00017%,-186.44547:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.08165%,9:26.13701%,7:18.22827%,1:17.54934%,14:0.0017%,11:0.00085%,2:0.00034%,17:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%]
[INFO] ** type:[0:99.99864%,1:0.00119%,2:0.00017%]
[INFO] ** unixtime:1610 (0.2732%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0356 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0314 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0282 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0252 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2022 - tp: 76098.0000 - fp: 3902.0000 - tn: 316098.0000 - fn: 3902.0000 - accuracy: 0.9805 - precision: 0.9512 - recall: 0.9512 - auc: 0.9878 - val_loss: 1.2810 - val_tp: 12829.0000 - val_fp: 7171.0000 - val_tn: 72829.0000 - val_fn: 7171.0000 - val_accuracy: 0.8566 - val_precision: 0.6414 - val_recall: 0.6414 - val_auc: 0.9104
[INFO] saving weights to checkpoints/lstm-epoch-6-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7579 - tp: 60524.0000 - fp: 19476.0000 - tn: 300524.0000 - fn: 19476.0000 - accuracy: 0.9026 - precision: 0.7566 - recall: 0.7566 - auc: 0.9395 - val_loss: 0.0890 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0771 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0646 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 11-11/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99898%,31:0.00034%,30:0.00034%,26:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.39465%,10:20.86983%,8:18.19331%,9:17.54%,22:0.00119%,18:0.00034%,15:0.00034%,25:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99966%,3:0.00034%]
[INFO] ** modbus_function_code:[0.02961:99.99898%,-33.760870000000004:0.00102%]
[INFO] ** modbus_function_description:[7:50.00068%,11:49.9983%,0:0.00102%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99898%,2:0.00068%,1:0.00034%]
[INFO] ** proxy_src_ip:[18:38.14444%,20:26.12038%,13:18.19331%,6:17.54034%,16:0.00051%,17:0.00034%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.11987%,-0.32151:20.86983%,-1.27613:18.19314%,-0.23351:17.53983%,-0.33484:17.27461%,-0.24151:0.00051%,-1.02014:0.00051%,-0.08551:0.00034%,-71.33197:0.00034%,-71.14798:0.00017%,1.45709:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:26.11953%,1:20.86966%,5:18.19297%,4:17.5395%,2:17.27444%,0:0.0039%]
[INFO] ** service:[0.0048200000000000005:99.99898%,-211.73542999999998:0.00034%,-186.43601999999998:0.00034%,-211.08346:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.14444%,9:26.12038%,7:18.19331%,1:17.54034%,15:0.00051%,14:0.00034%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1610 (0.2732%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0559 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0484 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0428 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0379 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0341 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0306 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0277 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0251 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0230 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0209 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 12-12/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99728%,30:0.00204%,31:0.00034%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:93.85875%,Single Stage Single Point:6.14125%]
[INFO] ** dst:[21:43.40602%,10:20.88205%,8:18.17923%,9:17.52914%,15:0.00204%,22:0.00051%,24:0.00034%,18:0.00034%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.9983%,0:0.0017%]
[INFO] ** i/f_name:[2:99.99796%,3:0.00204%]
[INFO] ** modbus_function_code:[0.02961:99.99728%,-33.760870000000004:0.00272%]
[INFO] ** modbus_function_description:[7:49.99932%,11:49.99796%,0:0.00272%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99847%,2:0.00153%]
[INFO] ** proto:[0:99.99745%,1:0.00204%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.15309%,20:26.13531%,13:18.1794%,6:17.52931%,17:0.00204%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.1348%,-0.32151:20.88205%,-1.27613:18.17889%,-0.23351:17.52897%,-0.33484:17.27105%,-71.33197:0.00204%,-1.27347:0.00034%,-0.08551:0.00034%,1.46509:0.00017%,1.47576:0.00017%,-0.24950999999999998:0.00017%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,1.45709:0.00017%,14.4699:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.13446%,1:20.88205%,5:18.17889%,4:17.52864%,2:17.27105%,0:0.00492%]
[INFO] ** service:[0.0048200000000000005:99.99728%,-211.73542999999998:0.00204%,-186.43601999999998:0.00034%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.15309%,9:26.13531%,7:18.1794%,1:17.52931%,21:0.00153%,14:0.00051%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1611 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0191 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0161 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0152 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0131 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0131 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2812 - val_tp: 12867.0000 - val_fp: 7133.0000 - val_tn: 72867.0000 - val_fn: 7133.0000 - val_accuracy: 0.8573 - val_precision: 0.6434 - val_recall: 0.6434 - val_auc: 0.8323
[INFO] saving weights to checkpoints/lstm-epoch-6-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4471 - tp: 71081.0000 - fp: 8919.0000 - tn: 311081.0000 - fn: 8919.0000 - accuracy: 0.9554 - precision: 0.8885 - recall: 0.8885 - auc: 0.9752 - val_loss: 4.9394 - val_tp: 13241.0000 - val_fp: 6759.0000 - val_tn: 73241.0000 - val_fn: 6759.0000 - val_accuracy: 0.8648 - val_precision: 0.6621 - val_recall: 0.6621 - val_auc: 0.7347
[INFO] saving weights to checkpoints/lstm-epoch-6-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2710 - tp: 77868.0000 - fp: 2132.0000 - tn: 317868.0000 - fn: 2132.0000 - accuracy: 0.9893 - precision: 0.9733 - recall: 0.9733 - auc: 0.9836 - val_loss: 0.0131 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 13-13/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99661%,31:0.00068%,30:0.00051%,26:0.00051%,0:0.00051%,22:0.00034%,27:0.00017%,24:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:87.01651%,Single Stage Single Point:12.98349%]
[INFO] ** dst:[21:43.35766%,10:20.80908%,8:18.2729%,9:17.55646%,22:0.00102%,6:0.00085%,18:0.00068%,25:0.00051%,15:0.00051%,24:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99949%,3:0.00051%]
[INFO] ** modbus_function_code:[0.02961:99.99661%,-33.760870000000004:0.00322%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99881%,11:49.99779%,0:0.00322%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99728%,2:0.00221%,1:0.00051%]
[INFO] ** proxy_src_ip:[18:38.05433%,20:26.11274%,13:18.27307%,6:17.55596%,10:0.00102%,11:0.00085%,17:0.00051%,16:0.00051%,7:0.00034%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.11223%,-0.32151:20.80908%,-1.27613:18.27273%,-0.23351:17.55562%,-0.33484:17.24525%,-9.78512:0.00068%,-64.19493:0.00051%,-1.02014:0.00051%,-71.14798:0.00051%,-71.33197:0.00051%,-0.24151:0.00034%,-71.14931:0.00034%,-0.08551:0.00034%,1.47576:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-1.2708:0.00017%,-68.79874000000001:0.00017%,6.1115699999999995:0.00017%,14.540560000000001:0.00017%,1.45709:0.00017%]
[INFO] ** scada_tag:[3:26.11189%,1:20.80891%,5:18.27273%,4:17.55562%,2:17.24508%,0:0.00577%]
[INFO] ** service:[0.0048200000000000005:99.99728%,-186.43601999999998:0.00068%,-211.08346:0.00051%,-186.44547:0.00051%,-211.73542999999998:0.00051%,-211.08818:0.00034%,-202.75898:0.00017%]
[INFO] ** src:[22:38.05433%,9:26.11274%,7:18.27307%,1:17.55596%,11:0.00102%,10:0.00085%,15:0.00051%,14:0.00051%,21:0.00034%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99966%,2:0.00017%,1:0.00017%]
[INFO] ** unixtime:1610 (0.2732%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0131 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0119 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0104 - tp: 79995.0000 - fp: 5.0000 - tn: 319995.0000 - fn: 5.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 0.0027 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0041 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2012 - tp: 78390.0000 - fp: 1610.0000 - tn: 318390.0000 - fn: 1610.0000 - accuracy: 0.9919 - precision: 0.9799 - recall: 0.9799 - auc: 0.9903 - val_loss: 1.5729 - val_tp: 12841.0000 - val_fp: 7159.0000 - val_tn: 72841.0000 - val_fn: 7159.0000 - val_accuracy: 0.8568 - val_precision: 0.6421 - val_recall: 0.6421 - val_auc: 0.9118
[INFO] saving weights to checkpoints/lstm-epoch-6-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4543 - tp: 69605.0000 - fp: 10395.0000 - tn: 309605.0000 - fn: 10395.0000 - accuracy: 0.9480 - precision: 0.8701 - recall: 0.8701 - auc: 0.9778 - val_loss: 0.0158 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 14-14/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99898%,31:0.00034%,30:0.00034%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:91.61613%,Single Stage Single Point:8.38387%]
[INFO] ** dst:[21:43.35341%,10:20.80518%,8:18.26848%,9:17.57089%,22:0.00068%,24:0.00034%,18:0.00034%,15:0.00034%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.99966%,3:0.00034%]
[INFO] ** modbus_function_code:[0.02961:99.99898%,-33.760870000000004:0.00102%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99881%,0:0.00102%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99915%,2:0.00051%,1:0.00034%]
[INFO] ** proxy_src_ip:[18:38.04297%,20:26.11614%,13:18.26865%,6:17.57106%,17:0.00034%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.11546%,-0.32151:20.80518%,-1.27613:18.26814%,-0.23351:17.57072%,-0.33484:17.23779%,-1.27347:0.00034%,-0.08551:0.00034%,-71.33197:0.00034%,1.45709:0.00034%,1.47576:0.00017%,1.46509:0.00017%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,-0.24950999999999998:0.00017%,14.4699:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.11512%,1:20.80518%,5:18.26797%,4:17.57038%,2:17.23762%,0:0.00373%]
[INFO] ** service:[0.0048200000000000005:99.99898%,-211.73542999999998:0.00034%,-186.43601999999998:0.00034%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.04297%,9:26.11614%,7:18.26865%,1:17.57106%,14:0.00034%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1610 (0.2732%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1920 - tp: 75755.0000 - fp: 4245.0000 - tn: 315755.0000 - fn: 4245.0000 - accuracy: 0.9788 - precision: 0.9469 - recall: 0.9469 - auc: 0.9923 - val_loss: 0.0196 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4745 - tp: 65808.0000 - fp: 14192.0000 - tn: 305808.0000 - fn: 14192.0000 - accuracy: 0.9290 - precision: 0.8226 - recall: 0.8226 - auc: 0.9734 - val_loss: 0.1354 - val_tp: 19980.0000 - val_fp: 20.0000 - val_tn: 79980.0000 - val_fn: 20.0000 - val_accuracy: 0.9996 - val_precision: 0.9990 - val_recall: 0.9990 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0128 - tp: 79854.0000 - fp: 146.0000 - tn: 319854.0000 - fn: 146.0000 - accuracy: 0.9993 - precision: 0.9982 - recall: 0.9982 - auc: 1.0000 - val_loss: 2.3935e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0023 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2156e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0017 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5487e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 15-15/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99644%,30:0.00288%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:90.62802%,Single Stage Multi Point:9.3713%,Single Stage Single Point:0.00068%]
[INFO] ** dst:[21:43.30285%,10:20.78363%,8:18.31023%,9:17.59821%,15:0.00288%,22:0.00153%,25:0.00017%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99728%,0:0.00272%]
[INFO] ** i/f_name:[2:99.99712%,3:0.00288%]
[INFO] ** modbus_function_code:[0.02961:99.99644%,-33.760870000000004:0.00356%]
[INFO] ** modbus_function_description:[7:49.99915%,11:49.99728%,0:0.00356%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99745%,2:0.00255%]
[INFO] ** proto:[0:99.99678%,1:0.00288%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.01972%,20:26.06743%,13:18.30989%,6:17.59872%,17:0.00288%,16:0.00068%,7:0.00034%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.06659%,-0.32151:20.78346%,-1.27613:18.30972%,-0.23351:17.59804%,-0.33484:17.23626%,-71.33197:0.00288%,-1.02014:0.00068%,-0.24151:0.00051%,1.46509:0.00034%,1.45709:0.00034%,1.47576:0.00017%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,-61.95768:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.06625%,1:20.78329%,5:18.30972%,4:17.5977%,2:17.23592%,0:0.00713%]
[INFO] ** service:[0.0048200000000000005:99.99661%,-211.73542999999998:0.00288%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.01972%,9:26.06743%,7:18.30989%,1:17.59872%,21:0.00288%,15:0.00068%,14:0.00034%,16:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1618 (0.27456%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0019 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.0636e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0017 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2613e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0018 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2382e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0014 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2209e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8223 - tp: 75925.0000 - fp: 4075.0000 - tn: 315925.0000 - fn: 4075.0000 - accuracy: 0.9796 - precision: 0.9491 - recall: 0.9491 - auc: 0.9679 - val_loss: 7.5368 - val_tp: 10648.0000 - val_fp: 9352.0000 - val_tn: 70648.0000 - val_fn: 9352.0000 - val_accuracy: 0.8130 - val_precision: 0.5324 - val_recall: 0.5324 - val_auc: 0.7078
[INFO] saving weights to checkpoints/lstm-epoch-6-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 16-16/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529000, 17)

[INFO] analyzing data
[INFO] 529000 rows
[INFO] ** appi_name:[21:99.99792%,30:0.0017%,33:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:79.14783%,Single Stage Multi Point:20.85217%]
[INFO] ** dst:[21:43.33724%,10:20.79565%,8:18.26749%,9:17.59641%,15:0.0017%,22:0.00113%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.9983%,0:0.0017%]
[INFO] ** i/f_name:[2:99.9983%,3:0.0017%]
[INFO] ** modbus_function_code:[0.02961:99.99792%,-33.760870000000004:0.00208%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99792%,0:0.00208%]
[INFO] ** modbus_transaction_id:65536 (12.38866%)
[INFO] ** orig:[0:99.9983%,2:0.0017%]
[INFO] ** proto:[0:99.99811%,1:0.0017%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.04121%,20:26.09187%,13:18.26786%,6:17.5966%,17:0.0017%,16:0.00038%,21:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.0913%,-0.32151:20.79546%,-1.27613:18.26749%,-0.23351:17.59622%,-0.33484:17.24575%,-71.33197:0.0017%,1.45709:0.00038%,-0.24151:0.00038%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,-49.275529999999996:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.09093%,1:20.79527%,5:18.2673%,4:17.59584%,2:17.24556%,0:0.0051%]
[INFO] ** service:[0.0048200000000000005:99.99811%,-211.73542999999998:0.0017%,-211.08346:0.00019%]
[INFO] ** src:[22:38.04121%,9:26.09187%,7:18.26786%,1:17.5966%,21:0.00189%,15:0.00038%,4:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1449 (0.27391%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5402 - tp: 42579.0000 - fp: 37421.0000 - tn: 282579.0000 - fn: 37421.0000 - accuracy: 0.8129 - precision: 0.5322 - recall: 0.5322 - auc: 0.7053 - val_loss: 7.5884 - val_tp: 10584.0000 - val_fp: 9416.0000 - val_tn: 70584.0000 - val_fn: 9416.0000 - val_accuracy: 0.8117 - val_precision: 0.5292 - val_recall: 0.5292 - val_auc: 0.7058
[INFO] saving weights to checkpoints/lstm-epoch-6-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5492 - tp: 42534.0000 - fp: 37466.0000 - tn: 282534.0000 - fn: 37466.0000 - accuracy: 0.8127 - precision: 0.5317 - recall: 0.5317 - auc: 0.7052 - val_loss: 7.5586 - val_tp: 10621.0000 - val_fp: 9379.0000 - val_tn: 70621.0000 - val_fn: 9379.0000 - val_accuracy: 0.8124 - val_precision: 0.5311 - val_recall: 0.5311 - val_auc: 0.7069
[INFO] saving weights to checkpoints/lstm-epoch-6-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.3508 - tp: 63374.0000 - fp: 16626.0000 - tn: 303374.0000 - fn: 16626.0000 - accuracy: 0.9169 - precision: 0.7922 - recall: 0.7922 - auc: 0.8691 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0013 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0012 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2719e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-15-16-batch-400000-500000
[INFO] processing batch 500000-600000/529000
[33m[INFO] loading file 17-17/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529000, 17)

[INFO] analyzing data
[INFO] 529000 rows
[INFO] ** appi_name:[21:99.99716%,7:0.00057%,26:0.00038%,0:0.00038%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:94.16824%,Multi Stage Multi Point:5.83176%]
[INFO] ** dst:[21:43.34556%,10:20.84934%,8:18.20359%,9:17.59849%,22:0.00076%,6:0.00057%,25:0.00038%,16:0.00038%,2:0.00038%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99716%,-33.760870000000004:0.00265%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99754%,0:0.00265%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.38866%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99868%,2:0.00132%]
[INFO] ** proxy_src_ip:[18:38.08299%,20:26.11267%,13:18.20302%,6:17.5983%,10:0.00113%,11:0.00095%,1:0.00038%,16:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.11172%,-0.32151:20.84934%,-1.27613:18.20265%,-0.23351:17.59811%,-0.33484:17.23365%,6.0369:0.00076%,-71.14798:0.00038%,1.47576:0.00038%,-64.19493:0.00038%,1.45709:0.00038%,1.46509:0.00019%,-68.79874000000001:0.00019%,-1.27347:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,6.15557:0.00019%,6.06224:0.00019%,8.55414:0.00019%,-3.3787199999999995:0.00019%,-4.3880099999999995:0.00019%,-71.14931:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:26.11153%,1:20.84915%,5:18.20246%,4:17.59773%,2:17.23365%,0:0.00548%]
[INFO] ** service:[0.0048200000000000005:99.99792%,-211.09762999999998:0.00057%,-211.08346:0.00038%,-186.44547:0.00038%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.08299%,9:26.11267%,7:18.20302%,1:17.5983%,11:0.00113%,10:0.00095%,3:0.00038%,21:0.00019%,15:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1446 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0011 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0011 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0010 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.6917 - tp: 66644.0000 - fp: 13356.0000 - tn: 306644.0000 - fn: 13356.0000 - accuracy: 0.9332 - precision: 0.8331 - recall: 0.8331 - auc: 0.8950 - val_loss: 2.9005 - val_tp: 16401.0000 - val_fp: 3599.0000 - val_tn: 76401.0000 - val_fn: 3599.0000 - val_accuracy: 0.9280 - val_precision: 0.8201 - val_recall: 0.8201 - val_auc: 0.8875
[INFO] saving weights to checkpoints/lstm-epoch-6-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.8003 - tp: 66105.0000 - fp: 13895.0000 - tn: 306105.0000 - fn: 13895.0000 - accuracy: 0.9305 - precision: 0.8263 - recall: 0.8263 - auc: 0.8908 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/529000
[33m[INFO] loading file 18-18/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529000, 17)

[INFO] analyzing data
[INFO] 529000 rows
[INFO] ** appi_name:[21:99.99811%,30:0.00057%,7:0.00057%,31:0.00019%,27:0.00019%,22:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:81.66389%,Multi Stage Multi Point:18.33611%]
[INFO] ** dst:[21:43.33894%,10:20.83251%,8:18.26578%,9:17.55974%,22:0.00076%,15:0.00057%,24:0.00038%,16:0.00038%,2:0.00038%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99943%,0:0.00057%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99811%,-33.760870000000004:0.00189%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99811%,0:0.00189%]
[INFO] ** modbus_transaction_id:65536 (12.38866%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99887%,2:0.00057%,1:0.00057%]
[INFO] ** proxy_src_ip:[18:38.07524%,20:26.09679%,13:18.26616%,6:17.55992%,17:0.00057%,11:0.00057%,1:0.00038%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.09603%,-0.32151:20.83251%,-1.27613:18.2656%,-0.23351:17.55955%,-0.33484:17.24272%,-71.33197:0.00057%,-1.27347:0.00038%,1.45709:0.00038%,-0.24151:0.00038%,1.47576:0.00019%,1.46509:0.00019%,3.6236699999999997:0.00019%,-1.2708:0.00019%,-2.48275:0.00019%,6.06224:0.00019%,-3.3787199999999995:0.00019%,8.10082:0.00019%,6.45955:0.00019%,-71.14931:0.00019%]
[INFO] ** scada_tag:[3:26.09565%,1:20.83233%,5:18.26541%,4:17.55936%,2:17.24253%,0:0.00473%]
[INFO] ** service:[0.0048200000000000005:99.99811%,-211.09762999999998:0.00057%,-211.73542999999998:0.00057%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.07524%,9:26.09679%,7:18.26616%,1:17.55992%,14:0.00057%,10:0.00057%,3:0.00038%,21:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1446 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.4082 - tp: 68051.0000 - fp: 11949.0000 - tn: 308051.0000 - fn: 11949.0000 - accuracy: 0.9403 - precision: 0.8506 - recall: 0.8506 - auc: 0.9060 - val_loss: 6.1208 - val_tp: 12405.0000 - val_fp: 7595.0000 - val_tn: 72405.0000 - val_fn: 7595.0000 - val_accuracy: 0.8481 - val_precision: 0.6202 - val_recall: 0.6202 - val_auc: 0.7627
[INFO] saving weights to checkpoints/lstm-epoch-6-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1139 - tp: 49657.0000 - fp: 30343.0000 - tn: 289657.0000 - fn: 30343.0000 - accuracy: 0.8483 - precision: 0.6207 - recall: 0.6207 - auc: 0.7614 - val_loss: 6.1636 - val_tp: 12352.0000 - val_fp: 7648.0000 - val_tn: 72352.0000 - val_fn: 7648.0000 - val_accuracy: 0.8470 - val_precision: 0.6176 - val_recall: 0.6176 - val_auc: 0.7610
[INFO] saving weights to checkpoints/lstm-epoch-6-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1368 - tp: 49543.0000 - fp: 30457.0000 - tn: 289543.0000 - fn: 30457.0000 - accuracy: 0.8477 - precision: 0.6193 - recall: 0.6193 - auc: 0.7606 - val_loss: 6.1136 - val_tp: 12414.0000 - val_fp: 7586.0000 - val_tn: 72414.0000 - val_fn: 7586.0000 - val_accuracy: 0.8483 - val_precision: 0.6207 - val_recall: 0.6207 - val_auc: 0.7629
[INFO] saving weights to checkpoints/lstm-epoch-6-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2868 - tp: 78580.0000 - fp: 1420.0000 - tn: 318580.0000 - fn: 1420.0000 - accuracy: 0.9929 - precision: 0.9822 - recall: 0.9822 - auc: 0.9888 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.9252e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/529000
[33m[INFO] loading file 19-19/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529000, 17)

[INFO] analyzing data
[INFO] 529000 rows
[INFO] ** appi_name:[21:99.99792%,26:0.00038%,0:0.00038%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:86.47259%,Single Stage Multi Point:13.52741%]
[INFO] ** dst:[21:43.3811%,10:20.8259%,8:18.21739%,9:17.57278%,22:0.00132%,6:0.00057%,25:0.00038%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99792%,-33.760870000000004:0.00189%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99773%,0:0.00189%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.38866%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99868%,2:0.00132%]
[INFO] ** proxy_src_ip:[18:38.11304%,20:26.09414%,13:18.21739%,6:17.57278%,10:0.00113%,11:0.00095%,16:0.00057%]
[INFO] ** s_port:[1.45442:26.09301%,-0.32151:20.8259%,-1.27613:18.21701%,-0.23351:17.57259%,-0.33484:17.28715%,-5.20264:0.00076%,1.45709:0.00057%,-1.02014:0.00057%,-64.19493:0.00038%,-71.14798:0.00038%,1.46509:0.00038%,-1.27347:0.00019%,-0.24151:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-71.14931:0.00019%,-68.79874000000001:0.00019%,0.75578:0.00019%]
[INFO] ** scada_tag:[3:26.09263%,1:20.82571%,5:18.21682%,4:17.5724%,2:17.28696%,0:0.00548%]
[INFO] ** service:[0.0048200000000000005:99.99868%,-211.08346:0.00038%,-186.44547:0.00038%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.11304%,9:26.09414%,7:18.21739%,1:17.57278%,11:0.00113%,10:0.00095%,15:0.00057%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1447 (0.27353%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.2005e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.8949e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.3310e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.4565 - tp: 62846.0000 - fp: 17154.0000 - tn: 302846.0000 - fn: 17154.0000 - accuracy: 0.9142 - precision: 0.7856 - recall: 0.7856 - auc: 0.8651 - val_loss: 9.8095 - val_tp: 7828.0000 - val_fp: 12172.0000 - val_tn: 67828.0000 - val_fn: 12172.0000 - val_accuracy: 0.7566 - val_precision: 0.3914 - val_recall: 0.3914 - val_auc: 0.6196
[INFO] saving weights to checkpoints/lstm-epoch-6-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.5094 - tp: 37766.0000 - fp: 42234.0000 - tn: 277766.0000 - fn: 42234.0000 - accuracy: 0.7888 - precision: 0.4721 - recall: 0.4721 - auc: 0.6680 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/529000
[33m[INFO] loading file 20-20/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529000, 17)

[INFO] analyzing data
[INFO] 529000 rows
[INFO] ** appi_name:[21:99.99641%,30:0.00302%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:92.2535%,Single Stage Multi Point:7.7465%]
[INFO] ** dst:[21:43.42476%,10:20.83913%,8:18.16616%,9:17.56484%,15:0.00302%,22:0.00113%,24:0.00038%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99735%,0:0.00265%]
[INFO] ** i/f_name:[2:99.99698%,3:0.00302%]
[INFO] ** modbus_function_code:[0.02961:99.99641%,-33.760870000000004:0.00359%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99679%,0:0.00359%]
[INFO] ** modbus_transaction_id:65536 (12.38866%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99641%,1:0.00302%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.11739%,20:26.14707%,13:18.16635%,6:17.56541%,17:0.00302%,14:0.00057%,16:0.00019%]
[INFO] ** s_port:[1.45442:26.14631%,-0.32151:20.83913%,-1.27613:18.16578%,-0.23351:17.56465%,-0.33484:17.27826%,-71.33197:0.00302%,-0.24151:0.00057%,1.45709:0.00038%,-1.27347:0.00038%,13.431270000000001:0.00019%,-1.2708:0.00019%,-1.02014:0.00019%,-71.14798:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,11.862:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:26.14594%,1:20.83894%,5:18.16578%,4:17.56427%,2:17.27807%,0:0.00699%]
[INFO] ** service:[0.0048200000000000005:99.99641%,-211.73542999999998:0.00302%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.11739%,9:26.14707%,7:18.16635%,1:17.56541%,14:0.00302%,2:0.00057%,15:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1446 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.2188e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9559 - val_tp: 17573.0000 - val_fp: 2427.0000 - val_tn: 77573.0000 - val_fn: 2427.0000 - val_accuracy: 0.9515 - val_precision: 0.8787 - val_recall: 0.8787 - val_auc: 0.9242
[INFO] saving weights to checkpoints/lstm-epoch-6-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9445 - tp: 65387.0000 - fp: 14613.0000 - tn: 305387.0000 - fn: 14613.0000 - accuracy: 0.9269 - precision: 0.8173 - recall: 0.8173 - auc: 0.8852 - val_loss: 2.9327 - val_tp: 16361.0000 - val_fp: 3639.0000 - val_tn: 76361.0000 - val_fn: 3639.0000 - val_accuracy: 0.9272 - val_precision: 0.8181 - val_recall: 0.8181 - val_auc: 0.8863
[INFO] saving weights to checkpoints/lstm-epoch-6-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9497 - tp: 65361.0000 - fp: 14639.0000 - tn: 305361.0000 - fn: 14639.0000 - accuracy: 0.9268 - precision: 0.8170 - recall: 0.8170 - auc: 0.8849 - val_loss: 2.9222 - val_tp: 16374.0000 - val_fp: 3626.0000 - val_tn: 76374.0000 - val_fn: 3626.0000 - val_accuracy: 0.9275 - val_precision: 0.8187 - val_recall: 0.8187 - val_auc: 0.8867
[INFO] saving weights to checkpoints/lstm-epoch-6-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4103 - tp: 77965.0000 - fp: 2035.0000 - tn: 317965.0000 - fn: 2035.0000 - accuracy: 0.9898 - precision: 0.9746 - recall: 0.9746 - auc: 0.9840 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.8277e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9245e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/529000
[33m[INFO] loading file 21-21/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528998, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528998, 17)

[INFO] analyzing data
[INFO] 528998 rows
[INFO] ** appi_name:[21:99.99622%,30:0.00076%,7:0.00057%,26:0.00038%,22:0.00038%,0:0.00038%,31:0.00019%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:98.84631%,Multi Stage Single Point:1.15369%]
[INFO] ** dst:[21:43.30489%,10:20.99403%,8:18.16963%,9:17.5271%,22:0.00095%,15:0.00076%,6:0.00076%,25:0.00038%,24:0.00038%,16:0.00038%,2:0.00038%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99924%,0:0.00076%]
[INFO] ** i/f_name:[2:99.99924%,3:0.00076%]
[INFO] ** modbus_function_code:[0.02961:99.99622%,-33.760870000000004:0.00359%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99868%,11:49.99754%,0:0.00359%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.3887%)
[INFO] ** orig:[0:99.99924%,2:0.00076%]
[INFO] ** proto:[0:99.99773%,2:0.00151%,1:0.00076%]
[INFO] ** proxy_src_ip:[18:38.32529%,20:25.97344%,13:18.16982%,6:17.5271%,10:0.00113%,11:0.00095%,17:0.00076%,16:0.00057%,1:0.00038%,21:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.97288%,-0.32151:20.99327%,-1.27613:18.16944%,-0.23351:17.52691%,-0.33484:17.33201%,-71.33197:0.00076%,-6.64392:0.00076%,-1.02014:0.00057%,-1.27347:0.00038%,-64.19493:0.00038%,-71.14931:0.00038%,-71.14798:0.00038%,1.47576:0.00019%,1.46509:0.00019%,6.62488:0.00019%,10.15141:0.00019%,-68.79874000000001:0.00019%,7.060860000000001:0.00019%,-3.3787199999999995:0.00019%,-2.2440900000000004:0.00019%,1.45709:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.9725%,1:20.99309%,5:18.16926%,4:17.52672%,2:17.33201%,0:0.00643%]
[INFO] ** service:[0.0048200000000000005:99.99698%,-211.73542999999998:0.00076%,-211.09762999999998:0.00057%,-211.08346:0.00038%,-186.44547:0.00038%,-211.08818:0.00038%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.32529%,9:25.97344%,7:18.16982%,1:17.5271%,11:0.00113%,21:0.00095%,10:0.00095%,15:0.00057%,3:0.00038%,4:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1440 (0.27221%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528998
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.5117e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/528998
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.2127e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/528998
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.9865e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/528998
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.7094e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/528998
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.5552e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/528998
[33m[INFO] loading file 22-22/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (298039, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (298039, 17)

[INFO] analyzing data
[INFO] 298039 rows
[INFO] ** appi_name:[21:99.99228%,30:0.00671%,23:0.00034%,22:0.00034%,18:0.00034%]
[INFO] ** classification:[normal:55.52528%,Multi Stage Single Point:44.47472%]
[INFO] ** dst:[21:43.3044%,10:21.00094%,8:18.11307%,9:17.57253%,15:0.00671%,22:0.00134%,19:0.00067%,26:0.00034%]
[INFO] ** i/f_dir:[1:99.99362%,0:0.00638%]
[INFO] ** i/f_name:[2:99.99329%,3:0.00638%,0:0.00034%]
[INFO] ** modbus_function_code:[0.02961:99.99228%,-33.760870000000004:0.00772%]
[INFO] ** modbus_function_description:[7:49.99715%,11:49.99513%,0:0.00772%]
[INFO] ** modbus_transaction_id:65534 (21.9884%)
[INFO] ** orig:[0:99.99497%,2:0.00436%,1:0.00067%]
[INFO] ** proto:[0:99.99295%,1:0.00671%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.32653%,20:25.97982%,13:18.11239%,6:17.57354%,17:0.00671%,14:0.00067%,10:0.00034%]
[INFO] ** s_port:[1.45442:25.97881%,-0.32151:21.00094%,-1.27613:18.11239%,-0.23351:17.57253%,-0.33484:17.32558%,-71.33197:0.00671%,1.45709:0.00067%,-0.24151:0.00067%,7.228860000000001:0.00067%,-0.24950999999999998:0.00034%,1.46509:0.00034%,-71.14931:0.00034%]
[INFO] ** scada_tag:[3:25.97848%,1:21.00094%,5:18.11239%,4:17.5722%,2:17.32558%,0:0.0104%]
[INFO] ** service:[0.0048200000000000005:99.99228%,-211.73542999999998:0.00671%,-211.07873999999998:0.00067%,-211.08818:0.00034%]
[INFO] ** src:[22:38.32653%,9:25.97982%,7:18.11239%,1:17.57354%,21:0.00436%,14:0.00235%,2:0.00067%,11:0.00034%]
[INFO] ** type:[0:99.99799%,1:0.00201%]
[INFO] ** unixtime:823 (0.27614%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/298039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.0514 - tp: 49965.0000 - fp: 30035.0000 - tn: 289965.0000 - fn: 30035.0000 - accuracy: 0.8498 - precision: 0.6246 - recall: 0.6246 - auc: 0.7654 - val_loss: 7.5473 - val_tp: 10635.0000 - val_fp: 9365.0000 - val_tn: 70635.0000 - val_fn: 9365.0000 - val_accuracy: 0.8127 - val_precision: 0.5318 - val_recall: 0.5318 - val_auc: 0.7073
[INFO] saving weights to checkpoints/lstm-epoch-6-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/298039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5861 - tp: 42348.0000 - fp: 37652.0000 - tn: 282348.0000 - fn: 37652.0000 - accuracy: 0.8117 - precision: 0.5293 - recall: 0.5293 - auc: 0.7058 - val_loss: 7.6061 - val_tp: 10562.0000 - val_fp: 9438.0000 - val_tn: 70562.0000 - val_fn: 9438.0000 - val_accuracy: 0.8112 - val_precision: 0.5281 - val_recall: 0.5281 - val_auc: 0.7051
[INFO] saving weights to checkpoints/lstm-epoch-6-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/298039
[33m[INFO] loading file 23-23/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598039, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598039, 17)

[INFO] analyzing data
[INFO] 598039 rows
[INFO] ** appi_name:[21:99.99816%,30:0.00117%,31:0.00033%,33:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:90.78706%,Multi Stage Single Point:9.21294%]
[INFO] ** dst:[21:43.32443%,10:21.00749%,8:18.1326%,9:17.53247%,15:0.00117%,22:0.001%,24:0.00033%,18:0.00033%,25:0.00017%]
[INFO] ** i/f_dir:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name:[2:99.99883%,3:0.00117%]
[INFO] ** modbus_function_code:[0.02961:99.99816%,-33.760870000000004:0.00184%]
[INFO] ** modbus_function_description:[7:50.00008%,11:49.99808%,0:0.00184%]
[INFO] ** modbus_transaction_id:65536 (10.95848%)
[INFO] ** orig:[0:99.99933%,2:0.00067%]
[INFO] ** proto:[0:99.99833%,1:0.00117%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.34967%,20:25.98275%,13:18.1326%,6:17.53264%,17:0.00117%,16:0.0005%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.98192%,-0.32151:21.00733%,-1.27613:18.1321%,-0.23351:17.5323%,-0.33484:17.34235%,-71.33197:0.00117%,-1.02014:0.0005%,-0.08551:0.00033%,-1.27347:0.00033%,1.45709:0.00033%,1.46509:0.00033%,-0.24151:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.98158%,1:21.00733%,5:18.13193%,4:17.53213%,2:17.34218%,0:0.00485%]
[INFO] ** service:[0.0048200000000000005:99.99833%,-211.73542999999998:0.00117%,-186.43601999999998:0.00033%,-186.44547:0.00017%]
[INFO] ** src:[22:38.34967%,9:25.98275%,7:18.1326%,1:17.53264%,21:0.00067%,15:0.0005%,14:0.0005%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99967%,1:0.00033%]
[INFO] ** unixtime:1629 (0.27239%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5804 - tp: 42376.0000 - fp: 37624.0000 - tn: 282376.0000 - fn: 37624.0000 - accuracy: 0.8119 - precision: 0.5297 - recall: 0.5297 - auc: 0.7061 - val_loss: 7.5400 - val_tp: 10644.0000 - val_fp: 9356.0000 - val_tn: 70644.0000 - val_fn: 9356.0000 - val_accuracy: 0.8129 - val_precision: 0.5322 - val_recall: 0.5322 - val_auc: 0.7076
[INFO] saving weights to checkpoints/lstm-epoch-6-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.6355 - tp: 71883.0000 - fp: 8117.0000 - tn: 311883.0000 - fn: 8117.0000 - accuracy: 0.9594 - precision: 0.8985 - recall: 0.8985 - auc: 0.9366 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.6976e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.6334e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.4471e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/598039
[33m[INFO] loading file 24-24/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598039, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598039, 17)

[INFO] analyzing data
[INFO] 598039 rows
[INFO] ** appi_name:[21:99.99381%,30:0.00301%,26:0.0005%,31:0.00033%,27:0.00033%,22:0.00033%,0:0.00033%,24:0.00017%,23:0.00017%,19:0.00017%,18:0.00017%,16:0.00017%,15:0.00017%,11:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:95.73941%,Multi Stage Single Point:4.26059%]
[INFO] ** dst:[21:43.3669%,10:21.00749%,8:18.10267%,9:17.51625%,15:0.00301%,22:0.00117%,6:0.00067%,25:0.00033%,24:0.00033%,19:0.00033%,18:0.00033%,7:0.00033%,26:0.00017%]
[INFO] ** i/f_dir:[1:99.99716%,0:0.00284%]
[INFO] ** i/f_name:[2:99.99699%,3:0.00301%]
[INFO] ** modbus_function_code:[0.02961:99.99381%,-33.760870000000004:0.00569%,-0.415:0.00017%,0.9188299999999999:0.00017%,0.47422:0.00017%]
[INFO] ** modbus_function_description:[7:49.99808%,11:49.99574%,0:0.00569%,15:0.00017%,10:0.00017%,2:0.00017%]
[INFO] ** modbus_transaction_id:65536 (10.95848%)
[INFO] ** orig:[0:99.99967%,1:0.00033%]
[INFO] ** proto:[0:99.99515%,1:0.00301%,2:0.00184%]
[INFO] ** proxy_src_ip:[18:38.38111%,20:25.99429%,13:18.1025%,6:17.51558%,17:0.00301%,10:0.00117%,14:0.00084%,11:0.00084%,21:0.00033%,16:0.00033%]
[INFO] ** s_port:[1.45442:25.99329%,-0.32151:21.00749%,-1.27613:18.10216%,-0.23351:17.51491%,-0.33484:17.37362%,-71.33197:0.00301%,-9.58113:0.00067%,-71.14798:0.0005%,1.45709:0.0005%,-0.24950999999999998:0.00033%,-1.27347:0.00033%,-0.24151:0.00033%,-1.02014:0.00033%,-31.55091:0.00033%,7.6315100000000005:0.00033%,-71.14931:0.00033%,-64.19493:0.00033%,1.47576:0.00033%,-68.79874000000001:0.00017%,1.46509:0.00017%,7.4901800000000005:0.00017%,13.431270000000001:0.00017%,11.862:0.00017%]
[INFO] ** scada_tag:[3:25.99295%,1:21.00749%,5:18.102%,4:17.51441%,2:17.37345%,0:0.0097%]
[INFO] ** service:[0.0048200000000000005:99.99482%,-211.73542999999998:0.00301%,-211.08346:0.0005%,-211.07873999999998:0.00033%,-202.75898:0.00033%,-186.44547:0.00033%,-186.43601999999998:0.00033%,-211.08818:0.00033%]
[INFO] ** src:[22:38.38111%,9:25.99429%,7:18.1025%,1:17.51558%,14:0.00301%,11:0.00117%,10:0.00084%,2:0.00084%,15:0.00033%,4:0.00033%]
[INFO] ** type:[0:99.99883%,1:0.00084%,2:0.00033%]
[INFO] ** unixtime:1625 (0.27172%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.8789e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.9307e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.1966e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.7896e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1922e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.0008e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/598039
[33m[INFO] loading file 25-25/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598039, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598039, 17)

[INFO] analyzing data
[INFO] 598039 rows
[INFO] ** appi_name:[21:99.99666%,30:0.001%,17:0.00067%,22:0.0005%,31:0.00033%,28:0.00017%,26:0.00017%,12:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** classification:[normal:65.92045%,Multi Stage Single Point:34.07955%]
[INFO] ** dst:[21:43.32945%,10:21.03224%,8:18.12524%,9:17.50906%,15:0.001%,22:0.00084%,16:0.00067%,6:0.00067%,18:0.00033%,17:0.00033%,24:0.00017%]
[INFO] ** i/f_dir:[1:99.999%,0:0.001%]
[INFO] ** i/f_name:[2:99.999%,3:0.001%]
[INFO] ** modbus_function_code:[0.02961:99.99666%,-33.760870000000004:0.00334%]
[INFO] ** modbus_function_description:[7:49.99908%,11:49.99758%,0:0.00334%]
[INFO] ** modbus_transaction_id:65536 (10.95848%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99799%,2:0.001%,1:0.001%]
[INFO] ** proxy_src_ip:[18:38.39816%,20:25.96352%,13:18.12524%,6:17.50939%,17:0.001%,1:0.00084%,21:0.00067%,16:0.00033%,14:0.00033%,7:0.00033%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.96302%,-0.32151:21.03191%,-1.27613:18.1249%,-0.23351:17.50889%,-0.33484:17.36626%,-71.33197:0.001%,-71.14931:0.0005%,-49.275529999999996:0.00033%,-0.24151:0.00033%,-1.02014:0.00033%,-58.032509999999995:0.00017%,-5.08665:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,2.52505:0.00017%,-71.14798:0.00017%,-58.035180000000004:0.00017%,-1.2708:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.96269%,1:21.03174%,5:18.12474%,4:17.50872%,2:17.36609%,0:0.00602%]
[INFO] ** service:[0.0048200000000000005:99.99699%,-211.73542999999998:0.001%,-205.44247:0.00067%,-211.08818:0.0005%,-186.43601999999998:0.00033%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%]
[INFO] ** src:[22:38.39816%,9:25.96352%,7:18.12524%,1:17.50939%,14:0.001%,3:0.00084%,4:0.00067%,21:0.00033%,15:0.00033%,2:0.00033%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1625 (0.27172%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.8394 - tp: 60944.0000 - fp: 19056.0000 - tn: 300944.0000 - fn: 19056.0000 - accuracy: 0.9047 - precision: 0.7618 - recall: 0.7618 - auc: 0.8511 - val_loss: 5.7421 - val_tp: 12875.0000 - val_fp: 7125.0000 - val_tn: 72875.0000 - val_fn: 7125.0000 - val_accuracy: 0.8575 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.7773
[INFO] saving weights to checkpoints/lstm-epoch-6-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7560 - tp: 51431.0000 - fp: 28569.0000 - tn: 291431.0000 - fn: 28569.0000 - accuracy: 0.8572 - precision: 0.6429 - recall: 0.6429 - auc: 0.7768 - val_loss: 5.7614 - val_tp: 12851.0000 - val_fp: 7149.0000 - val_tn: 72851.0000 - val_fn: 7149.0000 - val_accuracy: 0.8570 - val_precision: 0.6425 - val_recall: 0.6425 - val_auc: 0.7766
[INFO] saving weights to checkpoints/lstm-epoch-6-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7407 - tp: 51507.0000 - fp: 28493.0000 - tn: 291507.0000 - fn: 28493.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7774 - val_loss: 5.7896 - val_tp: 12816.0000 - val_fp: 7184.0000 - val_tn: 72816.0000 - val_fn: 7184.0000 - val_accuracy: 0.8563 - val_precision: 0.6408 - val_recall: 0.6408 - val_auc: 0.7755
[INFO] saving weights to checkpoints/lstm-epoch-6-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7435 - tp: 51493.0000 - fp: 28507.0000 - tn: 291493.0000 - fn: 28507.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.7773 - val_loss: 5.7227 - val_tp: 12899.0000 - val_fp: 7101.0000 - val_tn: 72899.0000 - val_fn: 7101.0000 - val_accuracy: 0.8580 - val_precision: 0.6449 - val_recall: 0.6449 - val_auc: 0.7781
[INFO] saving weights to checkpoints/lstm-epoch-6-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7568 - tp: 51427.0000 - fp: 28573.0000 - tn: 291427.0000 - fn: 28573.0000 - accuracy: 0.8571 - precision: 0.6428 - recall: 0.6428 - auc: 0.7768 - val_loss: 5.7227 - val_tp: 12899.0000 - val_fp: 7101.0000 - val_tn: 72899.0000 - val_fn: 7101.0000 - val_accuracy: 0.8580 - val_precision: 0.6449 - val_recall: 0.6449 - val_auc: 0.7781
[INFO] saving weights to checkpoints/lstm-epoch-6-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/598039
[33m[INFO] loading file 26-26/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598039, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598039, 17)

[INFO] analyzing data
[INFO] 598039 rows
[INFO] ** appi_name:[21:99.99833%,30:0.0005%,7:0.0005%,31:0.00017%,22:0.00017%,12:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:64.39329%,Single Stage Single Point:26.70595%,Multi Stage Single Point:8.90076%]
[INFO] ** dst:[21:43.30654%,10:21.08441%,8:18.12691%,9:17.47946%,22:0.00084%,15:0.0005%,24:0.00033%,16:0.00033%,2:0.00033%,18:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.9995%,0:0.0005%]
[INFO] ** i/f_name:[2:99.9995%,3:0.0005%]
[INFO] ** modbus_function_code:[0.02961:99.99833%,-33.760870000000004:0.00167%]
[INFO] ** modbus_function_description:[7:49.99975%,11:49.99858%,0:0.00167%]
[INFO] ** modbus_transaction_id:65536 (10.95848%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99916%,1:0.0005%,2:0.00033%]
[INFO] ** proxy_src_ip:[18:38.46054%,20:25.93058%,13:18.12725%,6:17.47963%,17:0.0005%,1:0.0005%,21:0.00033%,16:0.00033%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.93008%,-0.32151:21.08424%,-1.27613:18.12674%,-0.23351:17.47929%,-0.33484:17.37629%,-71.33197:0.0005%,-1.02014:0.00033%,-1.27347:0.00033%,-0.24151:0.00033%,-49.275529999999996:0.00017%,1.47576:0.00017%,1.45709:0.00017%,1.46509:0.00017%,-1.2708:0.00017%,14.191239999999999:0.00017%,2.52505:0.00017%,-3.3787199999999995:0.00017%,11.57001:0.00017%,-71.14931:0.00017%,7.66617:0.00017%]
[INFO] ** scada_tag:[3:25.92975%,1:21.08424%,5:18.12658%,4:17.47913%,2:17.37629%,0:0.00401%]
[INFO] ** service:[0.0048200000000000005:99.9985%,-211.09762999999998:0.0005%,-211.73542999999998:0.0005%,-211.35747999999998:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.46054%,9:25.93058%,7:18.12725%,1:17.47963%,14:0.0005%,3:0.0005%,15:0.00033%,4:0.00033%,21:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1623 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7419 - tp: 51501.0000 - fp: 28499.0000 - tn: 291501.0000 - fn: 28499.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7774 - val_loss: 5.7638 - val_tp: 12848.0000 - val_fp: 7152.0000 - val_tn: 72848.0000 - val_fn: 7152.0000 - val_accuracy: 0.8570 - val_precision: 0.6424 - val_recall: 0.6424 - val_auc: 0.7765
[INFO] saving weights to checkpoints/lstm-epoch-6-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.8593 - tp: 59191.0000 - fp: 20809.0000 - tn: 299191.0000 - fn: 20809.0000 - accuracy: 0.8960 - precision: 0.7399 - recall: 0.7399 - auc: 0.8430 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-6-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2632 - tp: 76356.0000 - fp: 3644.0000 - tn: 316356.0000 - fn: 3644.0000 - accuracy: 0.9818 - precision: 0.9545 - recall: 0.9545 - auc: 0.9714 - val_loss: 0.0024 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2203 - tp: 76479.0000 - fp: 3521.0000 - tn: 316479.0000 - fn: 3521.0000 - accuracy: 0.9824 - precision: 0.9560 - recall: 0.9560 - auc: 0.9938 - val_loss: 0.0049 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1991 - tp: 76406.0000 - fp: 3594.0000 - tn: 316406.0000 - fn: 3594.0000 - accuracy: 0.9820 - precision: 0.9551 - recall: 0.9551 - auc: 0.9941 - val_loss: 0.0084 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/598039
[33m[INFO] loading file 27-27/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (538169, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (538169, 17)

[INFO] analyzing data
[INFO] 538169 rows
[INFO] ** appi_name:[21:99.99944%,30:0.00056%]
[INFO] ** classification:[normal:64.35283%,Single Stage Single Point:35.64717%]
[INFO] ** dst:[21:43.28399%,10:21.06717%,8:18.16994%,9:17.47741%,22:0.00074%,15:0.00056%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99944%,-33.760870000000004:0.00056%]
[INFO] ** modbus_function_description:[7:50.00028%,11:49.99916%,0:0.00056%]
[INFO] ** modbus_transaction_id:65536 (12.17759%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99944%,1:0.00056%]
[INFO] ** proxy_src_ip:[18:38.41953%,20:25.93219%,13:18.16976%,6:17.4776%,17:0.00056%,16:0.00037%]
[INFO] ** s_port:[1.45442:25.93163%,-0.32151:21.06717%,-1.27613:18.16957%,-0.23351:17.47722%,-0.33484:17.35236%,-71.33197:0.00056%,-1.02014:0.00037%,-1.27347:0.00019%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.93126%,1:21.06699%,5:18.16939%,4:17.47704%,2:17.35217%,0:0.00316%]
[INFO] ** service:[0.0048200000000000005:99.99944%,-211.73542999999998:0.00056%]
[INFO] ** src:[22:38.41953%,9:25.93219%,7:18.16976%,1:17.4776%,14:0.00056%,15:0.00037%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1461 (0.27148%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/538169
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1739 - tp: 76532.0000 - fp: 3468.0000 - tn: 316532.0000 - fn: 3468.0000 - accuracy: 0.9827 - precision: 0.9567 - recall: 0.9567 - auc: 0.9944 - val_loss: 0.0306 - val_tp: 19950.0000 - val_fp: 50.0000 - val_tn: 79950.0000 - val_fn: 50.0000 - val_accuracy: 0.9990 - val_precision: 0.9975 - val_recall: 0.9975 - val_auc: 0.9991
[INFO] saving weights to checkpoints/lstm-epoch-6-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/538169
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1619 - tp: 76530.0000 - fp: 3470.0000 - tn: 316530.0000 - fn: 3470.0000 - accuracy: 0.9827 - precision: 0.9566 - recall: 0.9566 - auc: 0.9945 - val_loss: 0.0201 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/538169
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1189 - tp: 77384.0000 - fp: 2616.0000 - tn: 317384.0000 - fn: 2616.0000 - accuracy: 0.9869 - precision: 0.9673 - recall: 0.9673 - auc: 0.9967 - val_loss: 0.0221 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/538169
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0847 - tp: 78298.0000 - fp: 1702.0000 - tn: 318298.0000 - fn: 1702.0000 - accuracy: 0.9915 - precision: 0.9787 - recall: 0.9787 - auc: 0.9982 - val_loss: 0.0200 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/538169
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0636 - tp: 78824.0000 - fp: 1176.0000 - tn: 318824.0000 - fn: 1176.0000 - accuracy: 0.9941 - precision: 0.9853 - recall: 0.9853 - auc: 0.9986 - val_loss: 0.0159 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-26-27-batch-400000-500000
[INFO] processing batch 500000-600000/538169
[33m[INFO] loading file 28-28/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (372085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (372085, 17)

[INFO] analyzing data
[INFO] 372085 rows
[INFO] ** appi_name:[21:99.99221%,30:0.00161%,17:0.00134%,22:0.00108%,7:0.00108%,31:0.00081%,26:0.00081%,28:0.00027%,27:0.00027%,8:0.00027%,0:0.00027%]
[INFO] ** classification:[normal:64.30654%,Single Stage Single Point:35.69346%]
[INFO] ** dst:[21:43.27775%,10:21.02073%,8:18.20821%,9:17.48498%,6:0.00215%,16:0.00188%,18:0.00134%,22:0.00054%,17:0.00054%,15:0.00054%,2:0.00054%,25:0.00027%,7:0.00027%,0:0.00027%]
[INFO] ** i/f_dir:[1:99.99946%,0:0.00054%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.99221%,-33.760870000000004:0.00779%]
[INFO] ** modbus_function_description:[11:49.9961%,7:49.9961%,0:0.00779%]
[INFO] ** modbus_transaction_id:65535 (17.61291%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99543%,2:0.00403%,1:0.00054%]
[INFO] ** proxy_src_ip:[18:38.3356%,20:25.96288%,13:18.20847%,6:17.48525%,1:0.00215%,17:0.00161%,14:0.00161%,7:0.00134%,21:0.00081%,0:0.00027%]
[INFO] ** s_port:[1.45442:25.96262%,-0.32151:21.02073%,-1.27613:18.20821%,-0.23351:17.48471%,-0.33484:17.31486%,-71.14798:0.00108%,-71.14931:0.00108%,-71.33197:0.00054%,-0.08551:0.00054%,-0.24151:0.00054%,7.66617:0.00027%,-58.035180000000004:0.00027%,-1.2708:0.00027%,-64.19493:0.00027%,-5.1466400000000005:0.00027%,13.431270000000001:0.00027%,11.57001:0.00027%,14.4699:0.00027%,1.47576:0.00027%,14.191239999999999:0.00027%,-5.08665:0.00027%,10.192739999999999:0.00027%,-3.3787199999999995:0.00027%,6.1115699999999995:0.00027%,2.05573:0.00027%,-43.76509:0.00027%,2.52505:0.00027%,11.862:0.00027%,-58.032509999999995:0.00027%]
[INFO] ** scada_tag:[3:25.96262%,1:21.02073%,5:18.20821%,4:17.48445%,2:17.31486%,0:0.00914%]
[INFO] ** service:[0.0048200000000000005:99.99221%,-205.44247:0.00134%,-186.43601999999998:0.00134%,-211.09762999999998:0.00108%,-211.08346:0.00108%,-211.08818:0.00108%,-211.73542999999998:0.00054%,-186.44547:0.00027%,-183.8612:0.00027%,-185.9872:0.00027%,-211.35747999999998:0.00027%,-202.75898:0.00027%]
[INFO] ** src:[22:38.3356%,9:25.96288%,7:18.20847%,1:17.48525%,3:0.00242%,2:0.00161%,21:0.00134%,4:0.00108%,14:0.00054%,8:0.00054%,17:0.00027%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1011 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/372085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0556 - tp: 79050.0000 - fp: 950.0000 - tn: 319050.0000 - fn: 950.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9987 - val_loss: 0.0136 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/372085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0514 - tp: 79124.0000 - fp: 876.0000 - tn: 319124.0000 - fn: 876.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9988 - val_loss: 0.0127 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/372085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0526 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9987 - val_loss: 0.0109 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/372085
[33m[INFO] loading file 29-29/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (572085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (572085, 17)

[INFO] analyzing data
[INFO] 572085 rows
[INFO] ** appi_name:[21:99.99878%,30:0.00052%,31:0.00017%,26:0.00017%,9:0.00017%,3:0.00017%]
[INFO] ** classification:[normal:64.38973%,Single Stage Single Point:35.61027%]
[INFO] ** dst:[21:43.32853%,10:21.05981%,8:18.14346%,9:17.46646%,22:0.00052%,15:0.00052%,24:0.00017%,18:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99965%,0:0.00035%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.99878%,-33.760870000000004:0.00122%]
[INFO] ** modbus_function_description:[7:49.99974%,11:49.99904%,0:0.00122%]
[INFO] ** modbus_transaction_id:65536 (11.45564%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99913%,1:0.00052%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.43502%,20:25.95349%,13:18.14381%,6:17.46629%,17:0.00052%,21:0.00017%,16:0.00017%,7:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95296%,-0.32151:21.05963%,-1.27613:18.14346%,-0.23351:17.46629%,-0.33484:17.37539%,-71.33197:0.00052%,1.45709:0.00035%,-71.14798:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,6.1115699999999995:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:25.95261%,1:21.05946%,5:18.14346%,4:17.46594%,2:17.37539%,0:0.00315%]
[INFO] ** service:[0.0048200000000000005:99.99895%,-211.73542999999998:0.00052%,-183.8612:0.00017%,-211.08346:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.43502%,9:25.95349%,7:18.14381%,1:17.46629%,14:0.00052%,21:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1554 (0.27164%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0497 - tp: 79146.0000 - fp: 854.0000 - tn: 319146.0000 - fn: 854.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9989 - val_loss: 0.0102 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0511 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9986 - val_loss: 0.0096 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0513 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9988 - val_loss: 0.0095 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0517 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9988 - val_loss: 0.0097 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0512 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9988 - val_loss: 0.0098 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/572085
[33m[INFO] loading file 30-30/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (572085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (572085, 17)

[INFO] analyzing data
[INFO] 572085 rows
[INFO] ** appi_name:[21:99.99755%,30:0.00175%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.36963%,Single Stage Single Point:35.63037%]
[INFO] ** dst:[21:43.33709%,10:21.02957%,8:18.14765%,9:17.48237%,15:0.00175%,22:0.0007%,24:0.00035%,25:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99843%,0:0.00157%]
[INFO] ** i/f_name:[2:99.99825%,3:0.00175%]
[INFO] ** modbus_function_code:[0.02961:99.99755%,-33.760870000000004:0.00245%]
[INFO] ** modbus_function_description:[7:49.99956%,11:49.99799%,0:0.00245%]
[INFO] ** modbus_transaction_id:65536 (11.45564%)
[INFO] ** orig:[0:99.99913%,2:0.00052%,1:0.00035%]
[INFO] ** proto:[0:99.9979%,1:0.00175%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.37192%,20:25.99456%,13:18.148%,6:17.48289%,17:0.00175%,7:0.00035%,16:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.99439%,-0.32151:21.02939%,-1.27613:18.14748%,-0.23351:17.48219%,-0.33484:17.34253%,-71.33197:0.00175%,-0.24151:0.00052%,-1.27347:0.00035%,-71.14798:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:25.99404%,1:21.02939%,5:18.1473%,4:17.48202%,2:17.34235%,0:0.00489%]
[INFO] ** service:[0.0048200000000000005:99.99773%,-211.73542999999998:0.00175%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.37192%,9:25.99456%,7:18.148%,1:17.48289%,14:0.00122%,21:0.00087%,16:0.00017%,15:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99913%,1:0.00087%]
[INFO] ** unixtime:1555 (0.27181%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0507 - tp: 79109.0000 - fp: 891.0000 - tn: 319109.0000 - fn: 891.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9989 - val_loss: 0.0099 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0507 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9989 - val_loss: 0.0089 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0502 - tp: 79124.0000 - fp: 876.0000 - tn: 319124.0000 - fn: 876.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9989 - val_loss: 0.0087 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0506 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9989 - val_loss: 0.0085 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0496 - tp: 79141.0000 - fp: 859.0000 - tn: 319141.0000 - fn: 859.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9989 - val_loss: 0.0092 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-6-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/572085
[33m[INFO] loading file 31-31/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (572085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (572085, 17)

[INFO] analyzing data
[INFO] 572085 rows
[INFO] ** appi_name:[21:99.99965%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.37575%,Single Stage Single Point:35.62425%]
[INFO] ** dst:[21:43.32468%,10:21.04949%,8:18.12003%,9:17.50404%,22:0.00105%,24:0.00035%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99965%,-33.760870000000004:0.00035%]
[INFO] ** modbus_function_description:[7:49.99991%,11:49.99974%,0:0.00035%]
[INFO] ** modbus_transaction_id:65536 (11.45564%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.39342%,20:25.98145%,13:18.12021%,6:17.50404%,16:0.00052%,7:0.00035%]
[INFO] ** s_port:[1.45442:25.98075%,-0.32151:21.04949%,-1.27613:18.11986%,-0.23351:17.50387%,-0.33484:17.34393%,-1.02014:0.00052%,-1.27347:0.00035%,1.45709:0.00035%,-71.14798:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.98041%,1:21.04932%,5:18.11969%,4:17.50352%,2:17.34375%,0:0.00332%]
[INFO] ** service:[0.0048200000000000005:99.99965%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.39342%,9:25.98145%,7:18.12021%,1:17.50404%,15:0.00052%,21:0.00035%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1554 (0.27164%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0504 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9989 - val_loss: 0.0088 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0520 - tp: 79084.0000 - fp: 916.0000 - tn: 319084.0000 - fn: 916.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9988 - val_loss: 0.0088 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0510 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9989 - val_loss: 0.0086 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0512 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9989 - val_loss: 0.0085 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0501 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9989 - val_loss: 0.0084 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/572085
[33m[INFO] loading file 32-32/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (572085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (572085, 17)

[INFO] analyzing data
[INFO] 572085 rows
[INFO] ** appi_name:[21:99.9965%,30:0.00297%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.38309%,Single Stage Single Point:35.61691%]
[INFO] ** dst:[21:43.32188%,10:21.05666%,8:18.15307%,9:17.46384%,15:0.00297%,22:0.00087%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99738%,0:0.00262%]
[INFO] ** i/f_name:[2:99.99703%,3:0.00297%]
[INFO] ** modbus_function_code:[0.02961:99.9965%,-33.760870000000004:0.0035%]
[INFO] ** modbus_function_description:[7:49.99904%,11:49.99747%,0:0.0035%]
[INFO] ** modbus_transaction_id:65536 (11.45564%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9965%,1:0.00297%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.42471%,20:25.95419%,13:18.15307%,6:17.46436%,17:0.00297%,14:0.00052%,16:0.00017%]
[INFO] ** s_port:[1.45442:25.95366%,-0.32151:21.05666%,-1.27613:18.15272%,-0.23351:17.46366%,-0.33484:17.36805%,-71.33197:0.00297%,-0.24151:0.00052%,-1.2708:0.00017%,-1.02014:0.00017%,13.431270000000001:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.95331%,1:21.05649%,5:18.15272%,4:17.46331%,2:17.36805%,0:0.00612%]
[INFO] ** service:[0.0048200000000000005:99.9965%,-211.73542999999998:0.00297%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.42471%,9:25.95419%,7:18.15307%,1:17.46436%,14:0.00297%,2:0.00052%,15:0.00017%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1552 (0.27129%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0509 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9989 - val_loss: 0.0088 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0524 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9988 - val_loss: 0.0087 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0499 - tp: 79132.0000 - fp: 868.0000 - tn: 319132.0000 - fn: 868.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9989 - val_loss: 0.0085 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0534 - tp: 79076.0000 - fp: 924.0000 - tn: 319076.0000 - fn: 924.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9988 - val_loss: 0.0093 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0521 - tp: 79082.0000 - fp: 918.0000 - tn: 319082.0000 - fn: 918.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9988 - val_loss: 0.0088 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/572085
[33m[INFO] loading file 33-33/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (572085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (572085, 17)

[INFO] analyzing data
[INFO] 572085 rows
[INFO] ** appi_name:[21:99.99703%,30:0.00105%,17:0.0007%,22:0.00052%,31:0.00017%,28:0.00017%,26:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.39183%,Single Stage Single Point:35.60817%]
[INFO] ** dst:[21:43.32363%,10:21.06348%,8:18.1251%,9:17.48307%,22:0.0014%,15:0.00105%,16:0.0007%,6:0.0007%,24:0.00035%,17:0.00035%,18:0.00017%]
[INFO] ** i/f_dir:[1:99.99895%,0:0.00105%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99703%,-33.760870000000004:0.00297%]
[INFO] ** modbus_function_description:[7:49.99956%,11:49.99747%,0:0.00297%]
[INFO] ** modbus_transaction_id:65536 (11.45564%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99808%,1:0.00105%,2:0.00087%]
[INFO] ** proxy_src_ip:[18:38.42104%,20:25.96695%,13:18.1251%,6:17.48324%,17:0.00105%,16:0.0007%,1:0.0007%,21:0.00035%,14:0.00035%,7:0.00035%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.96607%,-0.32151:21.06348%,-1.27613:18.12475%,-0.23351:17.48289%,-0.33484:17.35756%,-71.33197:0.00105%,-1.02014:0.0007%,1.45709:0.00052%,-71.14931:0.00052%,-1.27347:0.00035%,-5.08665:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,-71.14798:0.00017%,-58.032509999999995:0.00017%,-58.035180000000004:0.00017%,-0.24151:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.96572%,1:21.06348%,5:18.12458%,4:17.48272%,2:17.35756%,0:0.00594%]
[INFO] ** service:[0.0048200000000000005:99.99703%,-211.73542999999998:0.00105%,-205.44247:0.0007%,-211.08818:0.00052%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.42104%,9:25.96695%,7:18.1251%,1:17.48324%,14:0.00105%,15:0.0007%,3:0.0007%,21:0.00035%,4:0.00035%,2:0.00035%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1556 (0.27199%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0490 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9990 - val_loss: 0.0085 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0536 - tp: 79055.0000 - fp: 945.0000 - tn: 319055.0000 - fn: 945.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9988 - val_loss: 0.0087 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0501 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9989 - val_loss: 0.0095 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0524 - tp: 79073.0000 - fp: 927.0000 - tn: 319073.0000 - fn: 927.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9989 - val_loss: 0.0088 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0522 - tp: 79084.0000 - fp: 916.0000 - tn: 319084.0000 - fn: 916.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9988 - val_loss: 0.0087 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/572085
[33m[INFO] loading file 34-34/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (413518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (413518, 17)

[INFO] analyzing data
[INFO] 413518 rows
[INFO] ** appi_name:[21:99.99758%,30:0.00073%,7:0.00073%,31:0.00024%,22:0.00024%,8:0.00024%,6:0.00024%]
[INFO] ** classification:[normal:64.34061%,Single Stage Single Point:35.65939%]
[INFO] ** dst:[21:43.28228%,10:21.05519%,8:18.18929%,9:17.47034%,22:0.00073%,15:0.00073%,16:0.00048%,2:0.00048%,18:0.00024%,6:0.00024%]
[INFO] ** i/f_dir:[1:99.99927%,0:0.00073%]
[INFO] ** i/f_name:[2:99.99927%,3:0.00073%]
[INFO] ** modbus_function_code:[0.02961:99.99758%,-33.760870000000004:0.00242%]
[INFO] ** modbus_function_description:[7:49.99927%,11:49.99831%,0:0.00242%]
[INFO] ** modbus_transaction_id:65536 (15.8484%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99879%,1:0.00073%,2:0.00048%]
[INFO] ** proxy_src_ip:[18:38.38866%,20:25.94905%,13:18.18905%,6:17.47082%,17:0.00073%,1:0.00073%,21:0.00048%,14:0.00024%,7:0.00024%]
[INFO] ** s_port:[1.45442:25.94857%,-0.32151:21.05495%,-1.27613:18.18905%,-0.23351:17.4701%,-0.33484:17.33371%,-0.24151:0.00073%,-71.33197:0.00073%,-3.0613900000000003:0.00024%,-3.3787199999999995:0.00024%,14.191239999999999:0.00024%,1.46509:0.00024%,1.47576:0.00024%,11.57001:0.00024%,-49.275529999999996:0.00024%,-71.14931:0.00024%,7.66617:0.00024%]
[INFO] ** scada_tag:[3:25.94833%,1:21.05471%,5:18.18881%,4:17.46961%,2:17.33371%,0:0.00484%]
[INFO] ** service:[0.0048200000000000005:99.99782%,-211.09762999999998:0.00073%,-211.73542999999998:0.00073%,-186.43601999999998:0.00024%,-211.35747999999998:0.00024%,-211.08818:0.00024%]
[INFO] ** src:[22:38.38866%,9:25.94905%,7:18.18905%,1:17.47082%,14:0.00073%,3:0.00073%,4:0.00048%,21:0.00024%,2:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1123 (0.27157%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/413518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0540 - tp: 79033.0000 - fp: 967.0000 - tn: 319033.0000 - fn: 967.0000 - accuracy: 0.9952 - precision: 0.9879 - recall: 0.9879 - auc: 0.9988 - val_loss: 0.0093 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/413518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0492 - tp: 79144.0000 - fp: 856.0000 - tn: 319144.0000 - fn: 856.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9989 - val_loss: 0.0087 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/413518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0493 - tp: 79136.0000 - fp: 864.0000 - tn: 319136.0000 - fn: 864.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9990 - val_loss: 0.0071 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/413518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0505 - tp: 79081.0000 - fp: 919.0000 - tn: 319081.0000 - fn: 919.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9990 - val_loss: 0.0064 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-33-34-batch-300000-400000
[INFO] processing batch 400000-500000/413518
[33m[INFO] loading file 35-35/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:99.99883%,30:0.00117%]
[INFO] ** classification:[normal:64.38002%,Single Stage Single Point:35.61998%]
[INFO] ** dst:[21:43.33422%,10:21.04308%,8:18.14523%,9:17.47514%,22:0.00117%,15:0.00117%]
[INFO] ** i/f_dir:[1:99.99903%,0:0.00097%]
[INFO] ** i/f_name:[2:99.99883%,3:0.00117%]
[INFO] ** modbus_function_code:[0.02961:99.99883%,-33.760870000000004:0.00117%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99864%,0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip:[18:38.40897%,20:25.9689%,13:18.14484%,6:17.47534%,17:0.00117%,16:0.00078%]
[INFO] ** s_port:[1.45442:25.96832%,-0.32151:21.04308%,-1.27613:18.14484%,-0.23351:17.47495%,-0.33484:17.3659%,-71.33197:0.00117%,-1.02014:0.00078%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.96793%,1:21.04308%,5:18.14464%,4:17.47456%,2:17.3659%,0:0.00389%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.73542999999998:0.00117%]
[INFO] ** src:[22:38.40897%,9:25.9689%,7:18.14484%,1:17.47534%,14:0.00117%,15:0.00078%]
[INFO] ** type:[0:99.99903%,1:0.00097%]
[INFO] ** unixtime:1394 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0430 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9996 - val_loss: 1.9683e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0341 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9998 - val_loss: 2.6723e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0284 - tp: 79153.0000 - fp: 847.0000 - tn: 319153.0000 - fn: 847.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0233 - tp: 79178.0000 - fp: 822.0000 - tn: 319178.0000 - fn: 822.0000 - accuracy: 0.9959 - precision: 0.9897 - recall: 0.9897 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0230 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/513518
[33m[INFO] loading file 36-36/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:99.99864%,30:0.00058%,31:0.00039%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.36094%,Single Stage Single Point:35.63906%]
[INFO] ** dst:[21:43.33597%,10:21.02283%,8:18.15672%,9:17.48215%,22:0.00078%,15:0.00058%,24:0.00039%,18:0.00039%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99942%,0:0.00058%]
[INFO] ** i/f_name:[2:99.99942%,3:0.00058%]
[INFO] ** modbus_function_code:[0.02961:99.99864%,-33.760870000000004:0.00136%]
[INFO] ** modbus_function_description:[7:50.00039%,11:49.99825%,0:0.00136%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,2:0.00058%,1:0.00058%]
[INFO] ** proxy_src_ip:[18:38.37509%,20:25.9839%,13:18.15691%,6:17.48274%,17:0.00058%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98332%,-0.32151:21.02263%,-1.27613:18.15633%,-0.23351:17.48196%,-0.33484:17.35246%,-0.24151:0.00058%,-71.33197:0.00058%,-1.27347:0.00039%,-0.08551:0.00039%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-49.275529999999996:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.98293%,1:21.02244%,5:18.15613%,4:17.48176%,2:17.35226%,0:0.00448%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.73542999999998:0.00058%,-186.43601999999998:0.00039%,-186.44547:0.00019%]
[INFO] ** src:[22:38.37509%,9:25.9839%,7:18.15691%,1:17.48274%,14:0.00058%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1395 (0.27166%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0224 - tp: 79077.0000 - fp: 923.0000 - tn: 319077.0000 - fn: 923.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-6-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0216 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79138.0000 - fp: 862.0000 - tn: 319138.0000 - fn: 862.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79123.0000 - fp: 877.0000 - tn: 319123.0000 - fn: 877.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/513518
[33m[INFO] loading file 37-37/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:99.99883%,30:0.00078%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.3884%,Single Stage Single Point:35.6116%]
[INFO] ** dst:[21:43.33811%,10:21.04834%,8:18.13198%,9:17.47943%,22:0.00078%,15:0.00078%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99922%,3:0.00078%]
[INFO] ** modbus_function_code:[0.02961:99.99883%,-33.760870000000004:0.00117%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99864%,0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99903%,1:0.00078%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.39515%,20:25.99169%,13:18.13218%,6:17.47943%,17:0.00078%,16:0.00039%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.9911%,-0.32151:21.04834%,-1.27613:18.13179%,-0.23351:17.47923%,-0.33484:17.34681%,-71.33197:0.00078%,-1.02014:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.99091%,1:21.04834%,5:18.13159%,4:17.47904%,2:17.34662%,0:0.00351%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.73542999999998:0.00078%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.39515%,9:25.99169%,7:18.13218%,1:17.47943%,14:0.00078%,15:0.00039%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1395 (0.27166%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79056.0000 - fp: 944.0000 - tn: 319056.0000 - fn: 944.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-6-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79085.0000 - fp: 915.0000 - tn: 319085.0000 - fn: 915.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/513518
[33m[INFO] loading file 38-38/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:99.99903%,30:0.00019%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.40806%,Single Stage Single Point:35.59194%]
[INFO] ** dst:[21:43.31922%,10:21.0867%,8:18.09888%,9:17.49325%,22:0.00097%,25:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99903%,-33.760870000000004:0.00097%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99922%,0:0.00097%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99942%,2:0.00039%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.45513%,20:25.95138%,13:18.09868%,6:17.49364%,7:0.00039%,17:0.00019%,16:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.9506%,-0.32151:21.08651%,-1.27613:18.09849%,-0.23351:17.49306%,-0.33484:17.36862%,1.45709:0.00039%,-0.24151:0.00039%,-71.14798:0.00019%,-64.19493:0.00019%,-1.02014:0.00019%,-61.95768:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,10.192739999999999:0.00019%,-0.24950999999999998:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.95021%,1:21.08651%,5:18.09849%,4:17.49286%,2:17.36862%,0:0.00331%]
[INFO] ** service:[0.0048200000000000005:99.99922%,-186.44547:0.00019%,-211.08346:0.00019%,-211.73542999999998:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.45513%,9:25.95138%,7:18.09868%,1:17.49364%,21:0.00039%,16:0.00019%,15:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1396 (0.27185%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 5.9429e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79145.0000 - fp: 855.0000 - tn: 319145.0000 - fn: 855.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/513518
[33m[INFO] loading file 39-39/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.41546%,Single Stage Single Point:35.58454%]
[INFO] ** dst:[21:43.32467%,10:21.09001%,8:18.13004%,9:17.45411%,22:0.00097%,24:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00078%,11:49.99922%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.46311%,20:25.95177%,13:18.13043%,6:17.45411%,16:0.00058%]
[INFO] ** s_port:[1.45442:25.95138%,-0.32151:21.09001%,-1.27613:18.13004%,-0.23351:17.45392%,-0.33484:17.3731%,-1.02014:0.00058%,-1.27347:0.00019%,1.45709:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95099%,1:21.08982%,5:18.12984%,4:17.45392%,2:17.37291%,0:0.00253%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.46311%,9:25.95177%,7:18.13043%,1:17.45411%,15:0.00058%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1394 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79136.0000 - fp: 864.0000 - tn: 319136.0000 - fn: 864.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79123.0000 - fp: 877.0000 - tn: 319123.0000 - fn: 877.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/513518
[33m[INFO] loading file 40-40/50 on epoch 6/100[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:99.99611%,30:0.00331%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.34516%,Single Stage Single Point:35.65484%]
[INFO] ** dst:[21:43.30559%,10:21.03451%,8:18.18281%,9:17.47222%,15:0.00331%,22:0.00078%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99688%,0:0.00312%]
[INFO] ** i/f_name:[2:99.99669%,3:0.00331%]
[INFO] ** modbus_function_code:[0.02961:99.99611%,-33.760870000000004:0.00389%]
[INFO] ** modbus_function_description:[7:49.99903%,11:49.99708%,0:0.00389%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.99611%,1:0.00331%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.35445%,20:25.98643%,13:18.18261%,6:17.47261%,17:0.00331%,14:0.00058%]
[INFO] ** s_port:[1.45442:25.98565%,-0.32151:21.03451%,-1.27613:18.18242%,-0.23351:17.47203%,-0.33484:17.31994%,-71.33197:0.00331%,1.45709:0.00039%,-0.24151:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,13.431270000000001:0.00019%]
[INFO] ** scada_tag:[3:25.98526%,1:21.03432%,5:18.18223%,4:17.47164%,2:17.31974%,0:0.00682%]
[INFO] ** service:[0.0048200000000000005:99.99611%,-211.73542999999998:0.00331%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.35445%,9:25.98643%,7:18.18261%,1:17.47261%,14:0.00331%,2:0.00058%]
[INFO] ** type:[0:99.99903%,1:0.00097%]
[INFO] ** unixtime:1397 (0.27204%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79085.0000 - fp: 915.0000 - tn: 319085.0000 - fn: 915.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79128.0000 - fp: 872.0000 - tn: 319128.0000 - fn: 872.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79091.0000 - fp: 909.0000 - tn: 319091.0000 - fn: 909.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79136.0000 - fp: 864.0000 - tn: 319136.0000 - fn: 864.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
