2020-02-02 20:49:10.714365: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory
2020-02-02 20:49:10.714523: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory
2020-02-02 20:49:10.714538: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-02-02 20:49:11.514561: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2020-02-02 20:49:11.514592: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-02-02 20:49:11.514621: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (bastia): /proc/driver/nvidia/version does not exist
2020-02-02 20:49:11.514808: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-02-02 20:49:11.523805: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2112050000 Hz
2020-02-02 20:49:11.525068: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x40cc3d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-02-02 20:49:11.525092: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-02-02 20:49:15.370032: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-02 20:49:15.386604: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 20:49:15.394152: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 20:49:15.454325: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-02 20:49:15.457976: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-02 20:49:15.463343: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 20:49:15.468677: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 20:49:15.482294: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-02 20:49:19.192954: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-02 20:49:19.197126: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 20:49:19.199053: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 20:49:19.213366: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-02 20:49:19.214248: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-02 20:49:19.215608: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 20:49:19.216987: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 20:49:19.221477: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
Date: 2020-02-02 20:49:11.508786
[INFO] input_shape (10, 16)
[INFO] LSTM first and last layer neurons: 5
adding core layer 0
[INFO] created DNN
[33m[INFO] epoch 1/10[0m
[33m[INFO] loading file 1-1/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1356 (0.2712%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9988%,3:0.0012%]
[INFO] ** i/f_dir:[1:99.9988%,0:0.0012%]
[INFO] ** src:[22:38.4088%,9:25.8982%,7:18.1636%,1:17.5218%,11:0.0014%,10:0.0014%,14:0.0012%,3:0.001%,2:0.001%,21:0.0006%,15:0.0004%,4:0.0004%,8:0.0002%]
[INFO] ** dst:[21:43.266%,10:21.0416%,8:18.1634%,9:17.5214%,6:0.0016%,16:0.0012%,15:0.0012%,22:0.001%,18:0.0006%,26:0.0004%,25:0.0004%,19:0.0004%,17:0.0004%,24:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.996%,2:0.0028%,1:0.0012%]
[INFO] ** appi_name:[21:99.9928%,30:0.0012%,22:0.001%,17:0.0008%,31:0.0006%,26:0.0006%,7:0.0006%,23:0.0004%,18:0.0004%,0:0.0004%,28:0.0002%,27:0.0002%,24:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.4088%,20:25.8982%,13:18.1636%,6:17.5218%,11:0.0014%,10:0.0014%,17:0.0012%,14:0.001%,1:0.001%,7:0.0006%,21:0.0004%,16:0.0004%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9928%,-33.760870000000004:0.007%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9974%,11:49.9954%,0:0.007%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:25.8976%,1:21.0406%,5:18.163%,4:17.521%,2:17.3678%,0:0.01%]
[INFO] ** service:[0.0048200000000000005:99.9936%,-211.73542999999998:0.0012%,-211.08818:0.001%,-205.44247:0.0008%,-211.07873999999998:0.0008%,-211.09762999999998:0.0006%,-211.08346:0.0006%,-186.43601999999998:0.0006%,-186.44547:0.0004%,-185.9872:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:25.8978%,-0.32151:21.0408%,-1.27613:18.1632%,-0.23351:17.5212%,-0.33484:17.368%,-71.33197:0.0012%,-71.14931:0.001%,-2.1481:0.0008%,-0.24151:0.0006%,-71.14798:0.0006%,-2.42942:0.0004%,4.44364:0.0004%,-1.02014:0.0004%,-64.19493:0.0004%,-5.1466400000000005:0.0002%,-1.2708:0.0002%,-58.035180000000004:0.0002%,4.076980000000001:0.0002%,-5.08665:0.0002%,1.47576:0.0002%,1.46509:0.0002%,4.29964:0.0002%,14.253910000000001:0.0002%,-68.79874000000001:0.0002%,6.1115699999999995:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,10.67005:0.0002%,-1.27347:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** classification:[normal:79.2972%,Single Stage Single Point:20.7028%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.7330 - tp: 41068.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 38932.0000 - accuracy: 0.9027 - precision: 1.0000 - recall: 0.5134 - auc: 0.9833 - val_loss: 0.1529 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1839 - tp: 76241.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 3759.0000 - accuracy: 0.9906 - precision: 1.0000 - recall: 0.9530 - auc: 1.0000 - val_loss: 0.0393 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1281 - tp: 77291.0000 - fp: 225.0000 - tn: 319775.0000 - fn: 2709.0000 - accuracy: 0.9927 - precision: 0.9971 - recall: 0.9661 - auc: 0.9979 - val_loss: 3.2970 - val_tp: 10606.0000 - val_fp: 9394.0000 - val_tn: 70606.0000 - val_fn: 9394.0000 - val_accuracy: 0.8121 - val_precision: 0.5303 - val_recall: 0.5303 - val_auc: 0.6920
[INFO] saving weights to checkpoints/lstm-epoch-1-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.7131 - tp: 34117.0000 - fp: 29766.0000 - tn: 290234.0000 - fn: 45883.0000 - accuracy: 0.8109 - precision: 0.5341 - recall: 0.4265 - auc: 0.7669 - val_loss: 0.9236 - val_tp: 9492.0000 - val_fp: 7965.0000 - val_tn: 72035.0000 - val_fn: 10508.0000 - val_accuracy: 0.8153 - val_precision: 0.5437 - val_recall: 0.4746 - val_auc: 0.9214
[INFO] saving weights to checkpoints/lstm-epoch-1-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7680 - tp: 34903.0000 - fp: 14420.0000 - tn: 305580.0000 - fn: 45097.0000 - accuracy: 0.8512 - precision: 0.7076 - recall: 0.4363 - auc: 0.9353 - val_loss: 0.4618 - val_tp: 18380.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 1620.0000 - val_accuracy: 0.9838 - val_precision: 1.0000 - val_recall: 0.9190 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-0-1-batch-400000-500000
[33m[INFO] loading file 2-2/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1359 (0.2718%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9996%,3:0.0004%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** src:[22:38.3832%,9:25.9606%,7:18.1352%,1:17.52%,14:0.0004%,3:0.0004%,15:0.0002%]
[INFO] ** dst:[21:43.3108%,10:21.0326%,8:18.135%,9:17.5198%,22:0.0008%,15:0.0004%,2:0.0004%,24:0.0002%]
[INFO] ** proto:[0:99.9996%,1:0.0004%]
[INFO] ** appi_name:[21:99.9992%,30:0.0004%,8:0.0002%,7:0.0002%]
[INFO] ** proxy_src_ip:[18:38.3832%,20:25.9606%,13:18.1352%,6:17.52%,17:0.0004%,1:0.0004%,16:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9992%,-33.760870000000004:0.0008%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.9992%,0:0.0008%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:25.9596%,1:21.0326%,5:18.1348%,4:17.5194%,2:17.3504%,0:0.0032%]
[INFO] ** service:[0.0048200000000000005:99.9992%,-211.73542999999998:0.0004%,-211.09762999999998:0.0002%,-211.35747999999998:0.0002%]
[INFO] ** s_port:[1.45442:25.96%,-0.32151:21.0326%,-1.27613:18.1348%,-0.23351:17.5196%,-0.33484:17.3506%,1.45709:0.0004%,-71.33197:0.0004%,-1.27347:0.0002%,-0.24950999999999998:0.0002%,-3.3787199999999995:0.0002%,1.47576:0.0002%,12.60597:0.0002%,-0.24151:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:72.7902%,Single Stage Single Point:27.2098%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4344 - tp: 61615.0000 - fp: 3203.0000 - tn: 316797.0000 - fn: 18385.0000 - accuracy: 0.9460 - precision: 0.9506 - recall: 0.7702 - auc: 0.9924 - val_loss: 0.2299 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4680 - tp: 60222.0000 - fp: 11653.0000 - tn: 308347.0000 - fn: 19778.0000 - accuracy: 0.9214 - precision: 0.8379 - recall: 0.7528 - auc: 0.9712 - val_loss: 0.2131 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3560 - tp: 68962.0000 - fp: 7039.0000 - tn: 312961.0000 - fn: 11038.0000 - accuracy: 0.9548 - precision: 0.9074 - recall: 0.8620 - auc: 0.9829 - val_loss: 0.8384 - val_tp: 10593.0000 - val_fp: 9407.0000 - val_tn: 70593.0000 - val_fn: 9407.0000 - val_accuracy: 0.8119 - val_precision: 0.5296 - val_recall: 0.5296 - val_auc: 0.9447
[INFO] saving weights to checkpoints/lstm-epoch-1-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3070 - tp: 66753.0000 - fp: 4919.0000 - tn: 315081.0000 - fn: 13247.0000 - accuracy: 0.9546 - precision: 0.9314 - recall: 0.8344 - auc: 0.9930 - val_loss: 0.1118 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4520 - tp: 61445.0000 - fp: 12721.0000 - tn: 307279.0000 - fn: 18555.0000 - accuracy: 0.9218 - precision: 0.8285 - recall: 0.7681 - auc: 0.9711 - val_loss: 0.1686 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-1-2-batch-400000-500000
[33m[INFO] loading file 3-3/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1357 (0.2714%)
[INFO] ** orig:[0:99.9988%,2:0.0012%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9984%,3:0.0016%]
[INFO] ** i/f_dir:[1:99.9984%,0:0.0016%]
[INFO] ** src:[22:38.418%,9:25.9724%,7:18.1538%,1:17.4466%,21:0.0022%,3:0.0018%,2:0.0014%,11:0.0008%,10:0.0008%,4:0.0008%,14:0.0004%,8:0.0004%,17:0.0002%,15:0.0002%,13:0.0002%]
[INFO] ** dst:[21:43.3012%,10:21.0888%,8:18.1536%,9:17.4462%,6:0.0024%,15:0.0016%,18:0.0014%,16:0.0014%,22:0.001%,2:0.0004%,7:0.0004%,25:0.0004%,17:0.0004%,12:0.0002%,24:0.0002%,19:0.0002%,0:0.0002%]
[INFO] ** proto:[0:99.9936%,2:0.0048%,1:0.0016%]
[INFO] ** appi_name:[21:99.9908%,30:0.0024%,22:0.0012%,31:0.001%,26:0.001%,17:0.001%,7:0.0008%,27:0.0004%,0:0.0004%,28:0.0002%,23:0.0002%,15:0.0002%,8:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.418%,20:25.9724%,13:18.1538%,6:17.4466%,17:0.0024%,1:0.0016%,14:0.0014%,7:0.001%,11:0.0008%,10:0.0008%,21:0.0006%,16:0.0002%,15:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9908%,-33.760870000000004:0.009%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9962%,11:49.9946%,0:0.009%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:25.9712%,1:21.0884%,5:18.153%,4:17.4458%,2:17.3292%,0:0.0124%]
[INFO] ** service:[0.0048200000000000005:99.991%,-211.73542999999998:0.0016%,-186.43601999999998:0.0014%,-211.08346:0.0012%,-211.08818:0.0012%,-205.44247:0.001%,-211.09762999999998:0.0008%,-186.44547:0.0004%,-202.75898:0.0004%,-183.8612:0.0002%,-185.9872:0.0002%,-201.23771000000002:0.0002%,-211.35747999999998:0.0002%,-211.07873999999998:0.0002%]
[INFO] ** s_port:[1.45442:25.9716%,-0.32151:21.0886%,-1.27613:18.1532%,-0.23351:17.446%,-0.33484:17.3294%,-71.33197:0.0016%,-71.14798:0.0012%,-71.14931:0.0012%,-64.19493:0.0004%,-0.08551:0.0004%,1.45709:0.0004%,-0.24151:0.0004%,13.431270000000001:0.0002%,14.4699:0.0002%,4.076980000000001:0.0002%,-5.1466400000000005:0.0002%,-1.02014:0.0002%,1.47576:0.0002%,-1.2708:0.0002%,-58.035180000000004:0.0002%,-58.032509999999995:0.0002%,12.60597:0.0002%,-5.08665:0.0002%,1.46509:0.0002%,-2.1481:0.0002%,-1.27347:0.0002%,10.67005:0.0002%,-43.76509:0.0002%,2.05573:0.0002%,6.1115699999999995:0.0002%,4.44364:0.0002%,13.86459:0.0002%,4.29964:0.0002%,-0.24950999999999998:0.0002%,-3.3787199999999995:0.0002%,10.192739999999999:0.0002%,-68.79874000000001:0.0002%,14.253910000000001:0.0002%,4.90362:0.0002%,-68.36943000000001:0.0002%]
[INFO] ** classification:[normal:86.7116%,Single Stage Single Point:13.2884%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3116 - tp: 66323.0000 - fp: 7427.0000 - tn: 312573.0000 - fn: 13677.0000 - accuracy: 0.9472 - precision: 0.8993 - recall: 0.8290 - auc: 0.9876 - val_loss: 0.0974 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4376 - tp: 58147.0000 - fp: 14951.0000 - tn: 305049.0000 - fn: 21853.0000 - accuracy: 0.9080 - precision: 0.7955 - recall: 0.7268 - auc: 0.9695 - val_loss: 0.3223 - val_tp: 16829.0000 - val_fp: 834.0000 - val_tn: 79166.0000 - val_fn: 3171.0000 - val_accuracy: 0.9599 - val_precision: 0.9528 - val_recall: 0.8414 - val_auc: 0.9945
[INFO] saving weights to checkpoints/lstm-epoch-1-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0779 - tp: 77434.0000 - fp: 22.0000 - tn: 319978.0000 - fn: 2566.0000 - accuracy: 0.9935 - precision: 0.9997 - recall: 0.9679 - auc: 1.0000 - val_loss: 0.0060 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0494 - tp: 78663.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 1337.0000 - accuracy: 0.9967 - precision: 1.0000 - recall: 0.9833 - auc: 1.0000 - val_loss: 0.0031 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0379 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0019 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-2-3-batch-400000-500000
[33m[INFO] loading file 4-4/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1367 (0.2734%)
[INFO] ** orig:[0:99.9988%,2:0.0012%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** i/f_name:[2:99.9986%,3:0.0014%]
[INFO] ** i/f_dir:[1:99.9988%,0:0.0012%]
[INFO] ** src:[22:38.2474%,9:26.0432%,7:18.1738%,1:17.5328%,21:0.0012%,15:0.0004%,4:0.0004%,17:0.0002%,14:0.0002%,8:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3578%,10:20.9324%,8:18.1738%,9:17.5324%,15:0.0014%,22:0.0012%,18:0.0004%,24:0.0002%,6:0.0002%,0:0.0002%]
[INFO] ** proto:[0:99.998%,1:0.0014%,2:0.0006%]
[INFO] ** appi_name:[21:99.9976%,30:0.0014%,31:0.0004%,33:0.0002%,26:0.0002%,9:0.0002%]
[INFO] ** proxy_src_ip:[18:38.2474%,20:26.0432%,13:18.1738%,6:17.5328%,17:0.0014%,21:0.0004%,16:0.0004%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9976%,-33.760870000000004:0.0024%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.9978%,0:0.0024%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.0422%,1:20.932%,5:18.1734%,4:17.5318%,2:17.315%,0:0.0056%]
[INFO] ** service:[0.0048200000000000005:99.9978%,-211.73542999999998:0.0014%,-186.43601999999998:0.0004%,-183.8612:0.0002%,-211.08346:0.0002%]
[INFO] ** s_port:[1.45442:26.0424%,-0.32151:20.9322%,-1.27613:18.1734%,-0.23351:17.5322%,-0.33484:17.3152%,-71.33197:0.0014%,1.45709:0.0004%,-0.24151:0.0004%,-1.02014:0.0004%,-0.08551:0.0004%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,14.4699:0.0002%,-49.275529999999996:0.0002%,-1.2708:0.0002%,-71.14798:0.0002%]
[INFO] ** classification:[normal:91.244%,Single Stage Single Point:8.756%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0302 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0013 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0252 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.7726e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0219 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.2849e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5459 - tp: 71528.0000 - fp: 8472.0000 - tn: 311528.0000 - fn: 8472.0000 - accuracy: 0.9576 - precision: 0.8941 - recall: 0.8941 - auc: 0.9569 - val_loss: 1.3777 - val_tp: 7806.0000 - val_fp: 12194.0000 - val_tn: 67806.0000 - val_fn: 12194.0000 - val_accuracy: 0.7561 - val_precision: 0.3903 - val_recall: 0.3903 - val_auc: 0.8808
[INFO] saving weights to checkpoints/lstm-epoch-1-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5440 - tp: 53840.0000 - fp: 20676.0000 - tn: 299324.0000 - fn: 26160.0000 - accuracy: 0.8829 - precision: 0.7225 - recall: 0.6730 - auc: 0.9521 - val_loss: 0.3159 - val_tp: 19996.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 4.0000 - val_accuracy: 0.9999 - val_precision: 0.9999 - val_recall: 0.9998 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-3-4-batch-400000-500000
[33m[INFO] loading file 5-5/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0:99.9982%,2:0.0018%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** i/f_name:[2:99.9978%,3:0.0022%]
[INFO] ** i/f_dir:[1:99.998%,0:0.002%]
[INFO] ** src:[22:37.992%,9:26.1346%,7:18.252%,1:17.618%,21:0.002%,14:0.0004%,16:0.0002%,15:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.365%,10:20.7618%,8:18.2518%,9:17.6176%,15:0.0022%,22:0.0008%,25:0.0002%,24:0.0002%,6:0.0002%,2:0.0002%]
[INFO] ** proto:[0:99.9974%,1:0.0022%,2:0.0004%]
[INFO] ** appi_name:[21:99.9968%,30:0.0022%,37:0.0002%,26:0.0002%,12:0.0002%,6:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:37.992%,20:26.1346%,13:18.252%,6:17.618%,17:0.0022%,21:0.0002%,16:0.0002%,7:0.0002%,5:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9968%,-33.760870000000004:0.0032%]
[INFO] ** modbus_function_description:[7:49.999%,11:49.9978%,0:0.0032%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.134%,1:20.7612%,5:18.2516%,4:17.6176%,2:17.2306%,0:0.005%]
[INFO] ** service:[0.0048200000000000005:99.9972%,-211.73542999999998:0.0022%,-186.44547:0.0002%,-211.08346:0.0002%,-211.35747999999998:0.0002%]
[INFO] ** s_port:[1.45442:26.1344%,-0.32151:20.7614%,-1.27613:18.2518%,-0.23351:17.6176%,-0.33484:17.2306%,-71.33197:0.0022%,-0.24151:0.0004%,-71.14798:0.0002%,-1.27347:0.0002%,1.45709:0.0002%,2.22906:0.0002%,-49.275529999999996:0.0002%,-61.95768:0.0002%,-1.02014:0.0002%,-64.19493:0.0002%]
[INFO] ** classification:[normal:88.731%,Single Stage Single Point:11.269%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3683 - tp: 63737.0000 - fp: 13426.0000 - tn: 306574.0000 - fn: 16263.0000 - accuracy: 0.9258 - precision: 0.8260 - recall: 0.7967 - auc: 0.9795 - val_loss: 0.3114 - val_tp: 13147.0000 - val_fp: 6663.0000 - val_tn: 73337.0000 - val_fn: 6853.0000 - val_accuracy: 0.8648 - val_precision: 0.6637 - val_recall: 0.6574 - val_auc: 0.9693
[INFO] saving weights to checkpoints/lstm-epoch-1-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1756 - tp: 74668.0000 - fp: 4744.0000 - tn: 315256.0000 - fn: 5332.0000 - accuracy: 0.9748 - precision: 0.9403 - recall: 0.9334 - auc: 0.9977 - val_loss: 0.6291 - val_tp: 15796.0000 - val_fp: 4204.0000 - val_tn: 75796.0000 - val_fn: 4204.0000 - val_accuracy: 0.9159 - val_precision: 0.7898 - val_recall: 0.7898 - val_auc: 0.9810
[INFO] saving weights to checkpoints/lstm-epoch-1-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0852 - tp: 78934.0000 - fp: 1052.0000 - tn: 318948.0000 - fn: 1066.0000 - accuracy: 0.9947 - precision: 0.9868 - recall: 0.9867 - auc: 0.9982 - val_loss: 0.0031 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0290 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0017 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0215 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0010 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-4-5-batch-400000-500000
[33m[INFO] loading file 6-6/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1369 (0.2738%)
[INFO] ** orig:[0:99.9996%,1:0.0004%]
[INFO] ** type:[0:99.999%,1:0.001%]
[INFO] ** i/f_name:[2:99.9964%,3:0.0036%]
[INFO] ** i/f_dir:[1:99.9966%,0:0.0034%]
[INFO] ** src:[22:37.9454%,9:26.1658%,7:18.285%,1:17.5992%,14:0.0036%,2:0.0006%,15:0.0002%,10:0.0002%]
[INFO] ** dst:[21:43.3788%,10:20.7322%,8:18.2848%,9:17.599%,15:0.0036%,22:0.0004%,25:0.0002%,24:0.0002%,18:0.0002%,12:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** proto:[0:99.9954%,1:0.0036%,2:0.001%]
[INFO] ** appi_name:[21:99.9954%,30:0.0036%,31:0.0002%,27:0.0002%,26:0.0002%,5:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:37.9454%,20:26.1658%,13:18.285%,6:17.5992%,17:0.0036%,14:0.0006%,16:0.0002%,11:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9954%,-33.760870000000004:0.0046%]
[INFO] ** modbus_function_description:[7:49.9984%,11:49.997%,0:0.0046%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1652%,1:20.732%,5:18.2842%,4:17.5984%,2:17.213%,0:0.0072%]
[INFO] ** service:[0.0048200000000000005:99.9954%,-211.73542999999998:0.0036%,-186.44547:0.0002%,-211.08346:0.0002%,-186.43601999999998:0.0002%,-201.23771000000002:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.1654%,-0.32151:20.7322%,-1.27613:18.2844%,-0.23351:17.5988%,-0.33484:17.2132%,-71.33197:0.0036%,-0.24151:0.0002%,-1.2708:0.0002%,-64.19493:0.0002%,-1.02014:0.0002%,13.431270000000001:0.0002%,4.90362:0.0002%,-71.14798:0.0002%,1.47576:0.0002%,1.46509:0.0002%,-0.24950999999999998:0.0002%,-1.27347:0.0002%,-68.36943000000001:0.0002%]
[INFO] ** classification:[normal:91.919%,Single Stage Single Point:8.081%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0173 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.0550e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0146 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8794e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0121 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4838e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0102 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8440 - val_tp: 15632.0000 - val_fp: 4368.0000 - val_tn: 75632.0000 - val_fn: 4368.0000 - val_accuracy: 0.9126 - val_precision: 0.7816 - val_recall: 0.7816 - val_auc: 0.8635
[INFO] saving weights to checkpoints/lstm-epoch-1-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6097 - tp: 69014.0000 - fp: 10428.0000 - tn: 309572.0000 - fn: 10986.0000 - accuracy: 0.9465 - precision: 0.8687 - recall: 0.8627 - auc: 0.9518 - val_loss: 0.0499 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-5-6-batch-400000-500000
[33m[INFO] loading file 7-7/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9986%,3:0.0014%]
[INFO] ** i/f_dir:[1:99.9986%,0:0.0014%]
[INFO] ** src:[22:37.9848%,9:26.133%,7:18.2404%,1:17.6366%,14:0.0014%,10:0.0008%,3:0.0008%,4:0.0006%,21:0.0004%,15:0.0004%,2:0.0004%,11:0.0002%,8:0.0002%]
[INFO] ** dst:[21:43.358%,10:20.759%,8:18.24%,9:17.6364%,6:0.0016%,22:0.0014%,15:0.0014%,16:0.0008%,24:0.0004%,18:0.0004%,17:0.0004%,7:0.0002%]
[INFO] ** proto:[0:99.9964%,2:0.0022%,1:0.0014%]
[INFO] ** appi_name:[21:99.9952%,30:0.0014%,22:0.001%,17:0.0008%,26:0.0006%,31:0.0004%,28:0.0002%,27:0.0002%,7:0.0002%]
[INFO] ** proxy_src_ip:[18:37.9848%,20:26.133%,13:18.2404%,6:17.6366%,17:0.0014%,11:0.0008%,1:0.0008%,21:0.0006%,16:0.0004%,14:0.0004%,7:0.0004%,10:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9952%,-33.760870000000004:0.0048%]
[INFO] ** modbus_function_description:[7:49.9984%,11:49.9968%,0:0.0048%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1316%,1:20.759%,5:18.2398%,4:17.636%,2:17.2258%,0:0.0078%]
[INFO] ** service:[0.0048200000000000005:99.9952%,-211.73542999999998:0.0014%,-211.08818:0.001%,-205.44247:0.0008%,-211.08346:0.0006%,-186.43601999999998:0.0004%,-211.09762999999998:0.0002%,-185.9872:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.132%,-0.32151:20.759%,-1.27613:18.2398%,-0.23351:17.6362%,-0.33484:17.2258%,-71.33197:0.0014%,-71.14931:0.001%,-71.14798:0.0006%,1.45709:0.0006%,-1.02014:0.0004%,-1.27347:0.0004%,-0.24151:0.0004%,-58.035180000000004:0.0002%,-1.2708:0.0002%,-5.1466400000000005:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-5.08665:0.0002%,14.253910000000001:0.0002%,-68.79874000000001:0.0002%,6.1115699999999995:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** classification:[normal:82.7162%,Single Stage Single Point:17.2838%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1199 - tp: 76394.0000 - fp: 3606.0000 - tn: 316394.0000 - fn: 3606.0000 - accuracy: 0.9820 - precision: 0.9549 - recall: 0.9549 - auc: 0.9989 - val_loss: 0.0218 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0949 - tp: 76820.0000 - fp: 2949.0000 - tn: 317051.0000 - fn: 3180.0000 - accuracy: 0.9847 - precision: 0.9630 - recall: 0.9603 - auc: 0.9992 - val_loss: 0.0126 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3053 - tp: 68387.0000 - fp: 11032.0000 - tn: 308968.0000 - fn: 11613.0000 - accuracy: 0.9434 - precision: 0.8611 - recall: 0.8548 - auc: 0.9848 - val_loss: 0.1069 - val_tp: 19995.0000 - val_fp: 5.0000 - val_tn: 79995.0000 - val_fn: 5.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0336 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0019 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0225 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-6-7-batch-400000-500000
[33m[INFO] loading file 8-8/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1369 (0.2738%)
[INFO] ** orig:[0:99.9996%,2:0.0004%]
[INFO] ** type:[0:99.9994%,1:0.0004%,2:0.0002%]
[INFO] ** i/f_name:[2:99.999%,3:0.001%]
[INFO] ** i/f_dir:[1:99.9994%,0:0.0006%]
[INFO] ** src:[22:38.1046%,9:26.147%,7:18.1632%,1:17.5816%,11:0.0012%,15:0.0006%,14:0.0006%,21:0.0004%,2:0.0004%,16:0.0002%,10:0.0002%]
[INFO] ** dst:[21:43.4334%,10:20.8176%,8:18.164%,9:17.5812%,22:0.0014%,15:0.001%,25:0.0006%,19:0.0004%,26:0.0002%,24:0.0002%]
[INFO] ** proto:[0:99.9982%,1:0.001%,2:0.0008%]
[INFO] ** appi_name:[21:99.997%,30:0.001%,0:0.0006%,24:0.0002%,23:0.0002%,22:0.0002%,18:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.1046%,20:26.147%,13:18.1632%,6:17.5816%,10:0.0012%,17:0.001%,16:0.0006%,14:0.0004%,11:0.0002%,5:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.997%,-33.760870000000004:0.0028%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.9972%,0:0.0028%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.146%,1:20.8174%,5:18.163%,4:17.5808%,2:17.2868%,0:0.006%]
[INFO] ** service:[0.0048200000000000005:99.9978%,-211.73542999999998:0.001%,-186.44547:0.0006%,-211.07873999999998:0.0004%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.1464%,-0.32151:20.8176%,-1.27613:18.163%,-0.23351:17.581%,-0.33484:17.287%,-71.33197:0.001%,-15.039579999999999:0.0008%,-1.02014:0.0006%,-64.19493:0.0006%,1.45709:0.0004%,-0.24151:0.0004%,4.66896:0.0004%,-1.27347:0.0002%,-0.24950999999999998:0.0002%,1.47576:0.0002%,-71.14931:0.0002%]
[INFO] ** classification:[normal:94.2844%,Single Stage Single Point:5.7156%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0180 - tp: 79997.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.5251e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0137 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0089e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0112 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6230e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3583 - tp: 72249.0000 - fp: 7604.0000 - tn: 312396.0000 - fn: 7751.0000 - accuracy: 0.9616 - precision: 0.9048 - recall: 0.9031 - auc: 0.9773 - val_loss: 0.1868 - val_tp: 16368.0000 - val_fp: 3632.0000 - val_tn: 76368.0000 - val_fn: 3632.0000 - val_accuracy: 0.9274 - val_precision: 0.8184 - val_recall: 0.8184 - val_auc: 0.9918
[INFO] saving weights to checkpoints/lstm-epoch-1-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0891 - tp: 77855.0000 - fp: 2083.0000 - tn: 317917.0000 - fn: 2145.0000 - accuracy: 0.9894 - precision: 0.9739 - recall: 0.9732 - auc: 0.9992 - val_loss: 0.0146 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-7-8-batch-400000-500000
[33m[INFO] loading file 9-9/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9992%,3:0.0008%]
[INFO] ** i/f_dir:[1:99.9992%,0:0.0008%]
[INFO] ** src:[22:38.0%,9:26.1346%,7:18.2984%,1:17.5654%,14:0.0008%,17:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3632%,10:20.7708%,8:18.2982%,9:17.5652%,22:0.0008%,15:0.0008%,18:0.0004%,25:0.0002%,24:0.0002%,6:0.0002%]
[INFO] ** proto:[0:99.9984%,2:0.0008%,1:0.0008%]
[INFO] ** appi_name:[21:99.9984%,30:0.0008%,31:0.0004%,26:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:38.0%,20:26.1346%,13:18.2984%,6:17.5654%,17:0.0008%,21:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9984%,-33.760870000000004:0.0016%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.9986%,0:0.0016%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1334%,1:20.7708%,5:18.298%,4:17.5648%,2:17.2292%,0:0.0038%]
[INFO] ** service:[0.0048200000000000005:99.9984%,-211.73542999999998:0.0008%,-186.43601999999998:0.0004%,-186.44547:0.0002%,-211.08346:0.0002%]
[INFO] ** s_port:[1.45442:26.1338%,-0.32151:20.7708%,-1.27613:18.298%,-0.23351:17.565%,-0.33484:17.2292%,-71.33197:0.0008%,1.45709:0.0004%,-0.24151:0.0004%,-0.08551:0.0004%,-71.14798:0.0002%,-1.27347:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:96.1038%,Single Stage Single Point:3.8962%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0607 - tp: 78728.0000 - fp: 1139.0000 - tn: 318861.0000 - fn: 1272.0000 - accuracy: 0.9940 - precision: 0.9857 - recall: 0.9841 - auc: 0.9997 - val_loss: 0.0068 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1269 - tp: 78361.0000 - fp: 1632.0000 - tn: 318368.0000 - fn: 1639.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9795 - auc: 0.9924 - val_loss: 0.0034 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0171 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0114 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.5542e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0090 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3898e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-8-9-batch-400000-500000
[33m[INFO] loading file 10-10/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0:99.9992%,1:0.0008%]
[INFO] ** type:[0:99.9984%,1:0.0014%,2:0.0002%]
[INFO] ** i/f_name:[2:99.998%,3:0.002%]
[INFO] ** i/f_dir:[1:99.9982%,0:0.0018%]
[INFO] ** src:[22:38.097%,9:26.13%,7:18.2188%,1:17.5504%,14:0.002%,11:0.001%,2:0.0004%,16:0.0002%,15:0.0002%]
[INFO] ** dst:[21:43.4154%,10:20.8112%,8:18.2186%,9:17.551%,15:0.002%,22:0.0006%,24:0.0004%,19:0.0004%,26:0.0002%,25:0.0002%]
[INFO] ** proto:[0:99.9976%,1:0.002%,2:0.0004%]
[INFO] ** appi_name:[21:99.9964%,30:0.002%,24:0.0002%,23:0.0002%,22:0.0002%,18:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:38.097%,20:26.13%,13:18.2188%,6:17.5504%,17:0.002%,10:0.001%,14:0.0004%,16:0.0002%,5:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9964%,-33.760870000000004:0.0034%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9988%,11:49.9976%,0:0.0034%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.129%,1:20.811%,5:18.2182%,4:17.5498%,2:17.2856%,0:0.0064%]
[INFO] ** service:[0.0048200000000000005:99.9972%,-211.73542999999998:0.002%,-211.07873999999998:0.0004%,-186.44547:0.0002%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.1294%,-0.32151:20.8112%,-1.27613:18.2182%,-0.23351:17.55%,-0.33484:17.2858%,-71.33197:0.002%,-10.51843:0.0008%,5.71692:0.0004%,-1.27347:0.0004%,1.46509:0.0002%,1.47576:0.0002%,-0.24950999999999998:0.0002%,1.45709:0.0002%,-0.24151:0.0002%,-71.14931:0.0002%,-1.02014:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:93.8902%,Single Stage Single Point:6.1098%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0074 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2059e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0124 - tp: 79936.0000 - fp: 64.0000 - tn: 319936.0000 - fn: 64.0000 - accuracy: 0.9997 - precision: 0.9992 - recall: 0.9992 - auc: 0.9996 - val_loss: 2.9659 - val_tp: 12843.0000 - val_fp: 7157.0000 - val_tn: 72843.0000 - val_fn: 7157.0000 - val_accuracy: 0.8569 - val_precision: 0.6421 - val_recall: 0.6421 - val_auc: 0.7763
[INFO] saving weights to checkpoints/lstm-epoch-1-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7359 - tp: 59656.0000 - fp: 20186.0000 - tn: 299814.0000 - fn: 20344.0000 - accuracy: 0.8987 - precision: 0.7472 - recall: 0.7457 - auc: 0.9368 - val_loss: 0.4325 - val_tp: 12813.0000 - val_fp: 7187.0000 - val_tn: 72813.0000 - val_fn: 7187.0000 - val_accuracy: 0.8563 - val_precision: 0.6406 - val_recall: 0.6406 - val_auc: 0.9677
[INFO] saving weights to checkpoints/lstm-epoch-1-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0396 - tp: 79492.0000 - fp: 503.0000 - tn: 319497.0000 - fn: 508.0000 - accuracy: 0.9975 - precision: 0.9937 - recall: 0.9937 - auc: 0.9999 - val_loss: 0.0045 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0138 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0020 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-9-10-batch-400000-500000
[33m[INFO] loading file 11-11/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9996%,3:0.0004%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** src:[22:38.147%,9:26.1112%,7:18.2032%,1:17.5368%,15:0.0006%,14:0.0004%,17:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3768%,10:20.881%,8:18.2034%,9:17.5362%,22:0.0014%,18:0.0004%,15:0.0004%,25:0.0002%,6:0.0002%]
[INFO] ** proto:[0:99.9988%,2:0.0008%,1:0.0004%]
[INFO] ** appi_name:[21:99.9988%,31:0.0004%,30:0.0004%,26:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:38.147%,20:26.1112%,13:18.2032%,6:17.5368%,16:0.0006%,17:0.0004%,21:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9988%,-33.760870000000004:0.0012%]
[INFO] ** modbus_function_description:[7:50.0004%,11:49.9984%,0:0.0012%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1104%,1:20.881%,5:18.203%,4:17.536%,2:17.2658%,0:0.0038%]
[INFO] ** service:[0.0048200000000000005:99.9988%,-211.73542999999998:0.0004%,-186.43601999999998:0.0004%,-186.44547:0.0002%,-211.08346:0.0002%]
[INFO] ** s_port:[1.45442:26.1108%,-0.32151:20.881%,-1.27613:18.2032%,-0.23351:17.5362%,-0.33484:17.266%,-0.24151:0.0006%,-1.02014:0.0006%,-0.08551:0.0004%,-71.33197:0.0004%,-71.14798:0.0002%,1.45709:0.0002%,1.46509:0.0002%,-64.19493:0.0002%]
[INFO] ** classification:[normal:100.0%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0109 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0014 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0088 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.2769e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0075 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.6809e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0065 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0236e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0057 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8685e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-10-11-batch-400000-500000
[33m[INFO] loading file 12-12/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:99.9982%,2:0.0018%]
[INFO] ** type:[0:99.9996%,1:0.0004%]
[INFO] ** i/f_name:[2:99.9978%,3:0.0022%]
[INFO] ** i/f_dir:[1:99.9982%,0:0.0018%]
[INFO] ** src:[22:38.138%,9:26.1258%,7:18.1958%,1:17.5378%,21:0.0018%,14:0.0004%,15:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3898%,10:20.8738%,8:18.1954%,9:17.5376%,15:0.0022%,22:0.0006%,24:0.0004%,0:0.0002%]
[INFO] ** proto:[0:99.9978%,1:0.0022%]
[INFO] ** appi_name:[21:99.9976%,30:0.0022%,9:0.0002%]
[INFO] ** proxy_src_ip:[18:38.138%,20:26.1258%,13:18.1958%,6:17.5378%,17:0.0022%,16:0.0002%,1:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9976%,-33.760870000000004:0.0024%]
[INFO] ** modbus_function_description:[7:49.9994%,11:49.9982%,0:0.0024%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.125%,1:20.8738%,5:18.1952%,4:17.537%,2:17.2642%,0:0.0048%]
[INFO] ** service:[0.0048200000000000005:99.9976%,-211.73542999999998:0.0022%,-183.8612:0.0002%]
[INFO] ** s_port:[1.45442:26.1254%,-0.32151:20.8738%,-1.27613:18.1952%,-0.23351:17.5374%,-0.33484:17.2642%,-71.33197:0.0022%,-1.27347:0.0004%,1.45709:0.0002%,-0.24950999999999998:0.0002%,1.47576:0.0002%,14.4699:0.0002%,-0.24151:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:92.7618%,Single Stage Single Point:7.2382%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0049 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2113e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0044 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3768 - val_tp: 16689.0000 - val_fp: 3311.0000 - val_tn: 76689.0000 - val_fn: 3311.0000 - val_accuracy: 0.9338 - val_precision: 0.8345 - val_recall: 0.8345 - val_auc: 0.8965
[INFO] saving weights to checkpoints/lstm-epoch-1-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3730 - tp: 72353.0000 - fp: 7588.0000 - tn: 312412.0000 - fn: 7647.0000 - accuracy: 0.9619 - precision: 0.9051 - recall: 0.9044 - auc: 0.9765 - val_loss: 0.4908 - val_tp: 17100.0000 - val_fp: 2900.0000 - val_tn: 77100.0000 - val_fn: 2900.0000 - val_accuracy: 0.9420 - val_precision: 0.8550 - val_recall: 0.8550 - val_auc: 0.9869
[INFO] saving weights to checkpoints/lstm-epoch-1-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1129 - tp: 77714.0000 - fp: 2283.0000 - tn: 317717.0000 - fn: 2286.0000 - accuracy: 0.9886 - precision: 0.9715 - recall: 0.9714 - auc: 0.9953 - val_loss: 0.0032 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0110 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0020 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-11-12-batch-400000-500000
[33m[INFO] loading file 13-13/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9996%,3:0.0004%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** src:[22:38.0458%,9:26.115%,7:18.2794%,1:17.5554%,11:0.0012%,10:0.001%,15:0.0006%,21:0.0004%,14:0.0004%,17:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3642%,10:20.7962%,8:18.2792%,9:17.556%,22:0.0012%,6:0.001%,18:0.0008%,25:0.0006%,15:0.0004%,24:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.997%,2:0.0026%,1:0.0004%]
[INFO] ** appi_name:[21:99.9962%,31:0.0008%,26:0.0006%,0:0.0006%,30:0.0004%,22:0.0004%,27:0.0002%,24:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.0458%,20:26.115%,13:18.2794%,6:17.5554%,10:0.0012%,11:0.001%,16:0.0006%,17:0.0004%,7:0.0004%,21:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9962%,-33.760870000000004:0.0036%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9988%,11:49.9974%,0:0.0036%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.114%,1:20.796%,5:18.279%,4:17.555%,2:17.2494%,0:0.0066%]
[INFO] ** service:[0.0048200000000000005:99.997%,-186.43601999999998:0.0008%,-186.44547:0.0006%,-211.08346:0.0006%,-211.73542999999998:0.0004%,-211.08818:0.0004%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.1144%,-0.32151:20.7962%,-1.27613:18.279%,-0.23351:17.555%,-0.33484:17.2496%,-9.78512:0.0008%,-71.14798:0.0006%,-64.19493:0.0006%,-1.02014:0.0006%,-0.08551:0.0004%,-71.14931:0.0004%,-0.24151:0.0004%,-71.33197:0.0004%,-1.27347:0.0002%,1.46509:0.0002%,-68.79874000000001:0.0002%,14.540560000000001:0.0002%,1.45709:0.0002%,-1.2708:0.0002%,6.1115699999999995:0.0002%,1.47576:0.0002%]
[INFO] ** classification:[normal:84.6974%,Single Stage Single Point:15.3026%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0092 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0014 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0077 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0010 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0066 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7706 - val_tp: 15075.0000 - val_fp: 4925.0000 - val_tn: 75075.0000 - val_fn: 4925.0000 - val_accuracy: 0.9015 - val_precision: 0.7538 - val_recall: 0.7538 - val_auc: 0.8461
[INFO] saving weights to checkpoints/lstm-epoch-1-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3932 - tp: 71293.0000 - fp: 8655.0000 - tn: 311345.0000 - fn: 8707.0000 - accuracy: 0.9566 - precision: 0.8917 - recall: 0.8912 - auc: 0.9737 - val_loss: 0.0252 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0842 - tp: 78082.0000 - fp: 1909.0000 - tn: 318091.0000 - fn: 1918.0000 - accuracy: 0.9904 - precision: 0.9761 - recall: 0.9760 - auc: 0.9991 - val_loss: 0.0082 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-12-13-batch-400000-500000
[33m[INFO] loading file 14-14/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** i/f_name:[2:99.9998%,3:0.0002%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** src:[22:38.0404%,9:26.1076%,7:18.2758%,1:17.5756%,15:0.0002%,14:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3416%,10:20.8058%,8:18.2756%,9:17.5754%,22:0.0008%,24:0.0004%,15:0.0002%,0:0.0002%]
[INFO] ** proto:[0:99.9998%,1:0.0002%]
[INFO] ** appi_name:[21:99.9996%,30:0.0002%,9:0.0002%]
[INFO] ** proxy_src_ip:[18:38.0404%,20:26.1076%,13:18.2758%,6:17.5756%,17:0.0002%,16:0.0002%,1:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9996%,-33.760870000000004:0.0004%]
[INFO] ** modbus_function_description:[7:50.0008%,11:49.9988%,0:0.0004%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1064%,1:20.8058%,5:18.275%,4:17.5748%,2:17.2344%,0:0.0036%]
[INFO] ** service:[0.0048200000000000005:99.9996%,-183.8612:0.0002%,-211.73542999999998:0.0002%]
[INFO] ** s_port:[1.45442:26.1068%,-0.32151:20.8058%,-1.27613:18.2752%,-0.23351:17.5752%,-0.33484:17.2346%,-1.27347:0.0004%,1.45709:0.0004%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,14.4699:0.0002%,-0.24151:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%,-71.33197:0.0002%]
[INFO] ** classification:[normal:96.5086%,Single Stage Single Point:3.4914%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3690 - tp: 67014.0000 - fp: 12963.0000 - tn: 307037.0000 - fn: 12986.0000 - accuracy: 0.9351 - precision: 0.8379 - recall: 0.8377 - auc: 0.9795 - val_loss: 0.2346 - val_tp: 18385.0000 - val_fp: 1597.0000 - val_tn: 78403.0000 - val_fn: 1615.0000 - val_accuracy: 0.9679 - val_precision: 0.9201 - val_recall: 0.9193 - val_auc: 0.9916
[INFO] saving weights to checkpoints/lstm-epoch-1-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0237 - tp: 79789.0000 - fp: 210.0000 - tn: 319790.0000 - fn: 211.0000 - accuracy: 0.9989 - precision: 0.9974 - recall: 0.9974 - auc: 1.0000 - val_loss: 0.0025 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0122 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0015 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0102 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.9564e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0085 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.1445e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-13-14-batch-400000-500000
[33m[INFO] loading file 15-15/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1374 (0.2748%)
[INFO] ** orig:[0:99.997%,2:0.003%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9968%,3:0.0032%]
[INFO] ** i/f_dir:[1:99.9968%,0:0.0032%]
[INFO] ** src:[22:38.005%,9:26.0626%,7:18.3142%,1:17.6136%,21:0.0034%,15:0.0006%,16:0.0002%,14:0.0002%,8:0.0002%]
[INFO] ** dst:[21:43.2978%,10:20.7692%,8:18.3144%,9:17.613%,15:0.0032%,22:0.0016%,25:0.0002%,24:0.0002%,16:0.0002%,6:0.0002%]
[INFO] ** proto:[0:99.9964%,1:0.0032%,2:0.0004%]
[INFO] ** appi_name:[21:99.996%,30:0.0032%,26:0.0002%,17:0.0002%,12:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:38.005%,20:26.0626%,13:18.3142%,6:17.6136%,17:0.0032%,16:0.0006%,7:0.0004%,5:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.996%,-33.760870000000004:0.004%]
[INFO] ** modbus_function_description:[7:49.999%,11:49.997%,0:0.004%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.0614%,1:20.7688%,5:18.314%,4:17.6124%,2:17.2358%,0:0.0076%]
[INFO] ** service:[0.0048200000000000005:99.9962%,-211.73542999999998:0.0032%,-186.44547:0.0002%,-211.08346:0.0002%,-205.44247:0.0002%]
[INFO] ** s_port:[1.45442:26.0618%,-0.32151:20.769%,-1.27613:18.314%,-0.23351:17.6128%,-0.33484:17.236%,-71.33197:0.0032%,-1.02014:0.0006%,-0.24151:0.0006%,1.45709:0.0004%,-64.19493:0.0002%,-61.95768:0.0002%,-71.14798:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,10.192739999999999:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%]
[INFO] ** classification:[normal:88.954%,Single Stage Multi Point:11.0452%,Single Stage Single Point:0.0008%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0075 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3842e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0067 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.1275e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0057 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2186e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0051 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.2298 - val_tp: 11586.0000 - val_fp: 8414.0000 - val_tn: 71586.0000 - val_fn: 8414.0000 - val_accuracy: 0.8317 - val_precision: 0.5793 - val_recall: 0.5793 - val_auc: 0.7371
[INFO] saving weights to checkpoints/lstm-epoch-1-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.1779 - tp: 42008.0000 - fp: 37217.0000 - tn: 282783.0000 - fn: 37992.0000 - accuracy: 0.8120 - precision: 0.5302 - recall: 0.5251 - auc: 0.7204 - val_loss: 1.5595 - val_tp: 10627.0000 - val_fp: 9373.0000 - val_tn: 70627.0000 - val_fn: 9373.0000 - val_accuracy: 0.8125 - val_precision: 0.5314 - val_recall: 0.5314 - val_auc: 0.8703
[INFO] saving weights to checkpoints/lstm-epoch-1-files-14-15-batch-400000-500000
[33m[INFO] loading file 16-16/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (439690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (439690, 17)

[INFO] analyzing data
[INFO] 439690 rows
[INFO] ** unixtime:1201 (0.27315%)
[INFO] ** orig:[0:99.99886%,2:0.00114%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.99886%,3:0.00114%]
[INFO] ** i/f_dir:[1:99.99886%,0:0.00114%]
[INFO] ** src:[22:38.05363%,9:26.10544%,7:18.25172%,1:17.58762%,21:0.00114%,15:0.00023%,4:0.00023%]
[INFO] ** dst:[21:43.35941%,10:20.79943%,8:18.25127%,9:17.58762%,15:0.00114%,22:0.00091%,24:0.00023%]
[INFO] ** proto:[0:99.99886%,1:0.00114%]
[INFO] ** appi_name:[21:99.99864%,30:0.00114%,33:0.00023%]
[INFO] ** proxy_src_ip:[18:38.05363%,20:26.10544%,13:18.25172%,6:17.58762%,17:0.00114%,21:0.00023%,16:0.00023%]
[INFO] ** modbus_function_code:[0.02961:99.99864%,-33.760870000000004:0.00136%]
[INFO] ** modbus_function_description:[7:50.00045%,11:49.99818%,0:0.00136%]
[INFO] ** modbus_transaction_id:65536 (14.90505%)
[INFO] ** scada_tag:[3:26.1043%,1:20.7992%,5:18.25104%,4:17.58694%,2:17.25443%,0:0.00409%]
[INFO] ** service:[0.0048200000000000005:99.99886%,-211.73542999999998:0.00114%]
[INFO] ** s_port:[1.45442:26.10476%,-0.32151:20.7992%,-1.27613:18.25127%,-0.23351:17.58739%,-0.33484:17.25443%,-71.33197:0.00114%,1.45709:0.00045%,-1.27347:0.00023%,1.47576:0.00023%,-49.275529999999996:0.00023%,-0.24151:0.00023%,-1.02014:0.00023%,-1.2708:0.00023%]
[INFO] ** classification:[normal:84.4188%,Single Stage Multi Point:15.5812%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/439690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.7534 - tp: 40863.0000 - fp: 38976.0000 - tn: 281024.0000 - fn: 39137.0000 - accuracy: 0.8047 - precision: 0.5118 - recall: 0.5108 - auc: 0.8040 - val_loss: 1.1148 - val_tp: 10618.0000 - val_fp: 9382.0000 - val_tn: 70618.0000 - val_fn: 9382.0000 - val_accuracy: 0.8124 - val_precision: 0.5309 - val_recall: 0.5309 - val_auc: 0.8827
[INFO] saving weights to checkpoints/lstm-epoch-1-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/439690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0955 - tp: 52292.0000 - fp: 27604.0000 - tn: 292396.0000 - fn: 27708.0000 - accuracy: 0.8617 - precision: 0.6545 - recall: 0.6536 - auc: 0.8975 - val_loss: 0.0629 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/439690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0485 - tp: 79410.0000 - fp: 590.0000 - tn: 319410.0000 - fn: 590.0000 - accuracy: 0.9970 - precision: 0.9926 - recall: 0.9926 - auc: 1.0000 - val_loss: 0.0090 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/439690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0153 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0055 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/439690
[33m[INFO] loading file 17-17/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539690, 17)

[INFO] analyzing data
[INFO] 539690 rows
[INFO] ** appi_name:[21:99.99722%,7:0.00056%,26:0.00037%,0:0.00037%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:94.28376%,Multi Stage Multi Point:5.71624%]
[INFO] ** dst:[21:43.34562%,10:20.85123%,8:18.201%,9:17.59918%,22:0.00074%,6:0.00056%,25:0.00037%,16:0.00037%,2:0.00037%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99722%,-33.760870000000004:0.00259%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99963%,11:49.99759%,0:0.00259%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.14327%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9987%,2:0.0013%]
[INFO] ** proxy_src_ip:[18:38.08316%,20:26.11444%,13:18.20045%,6:17.59899%,10:0.00111%,11:0.00093%,1:0.00037%,16:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.11351%,-0.32151:20.85123%,-1.27613:18.20008%,-0.23351:17.59881%,-0.33484:17.23193%,6.0369:0.00074%,-71.14798:0.00037%,1.47576:0.00037%,-64.19493:0.00037%,1.45709:0.00037%,1.46509:0.00019%,-68.79874000000001:0.00019%,-1.27347:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,6.15557:0.00019%,6.06224:0.00019%,8.55414:0.00019%,-3.3787199999999995:0.00019%,-4.3880099999999995:0.00019%,-71.14931:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:26.11332%,1:20.85104%,5:18.19989%,4:17.59844%,2:17.23193%,0:0.00537%]
[INFO] ** service:[0.0048200000000000005:99.99796%,-211.09762999999998:0.00056%,-211.08346:0.00037%,-186.44547:0.00037%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.08316%,9:26.11444%,7:18.20045%,1:17.59899%,11:0.00111%,10:0.00093%,3:0.00037%,21:0.00019%,15:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1475 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0120 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0039 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0099 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0031 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0086 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0025 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.9671 - tp: 67501.0000 - fp: 11883.0000 - tn: 308117.0000 - fn: 12499.0000 - accuracy: 0.9390 - precision: 0.8503 - recall: 0.8438 - auc: 0.9192 - val_loss: 0.6349 - val_tp: 16369.0000 - val_fp: 3631.0000 - val_tn: 76369.0000 - val_fn: 3631.0000 - val_accuracy: 0.9274 - val_precision: 0.8184 - val_recall: 0.8184 - val_auc: 0.9661
[INFO] saving weights to checkpoints/lstm-epoch-1-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5546 - tp: 67314.0000 - fp: 11351.0000 - tn: 308649.0000 - fn: 12686.0000 - accuracy: 0.9399 - precision: 0.8557 - recall: 0.8414 - auc: 0.9641 - val_loss: 0.1685 - val_tp: 17641.0000 - val_fp: 1799.0000 - val_tn: 78201.0000 - val_fn: 2359.0000 - val_accuracy: 0.9584 - val_precision: 0.9075 - val_recall: 0.8820 - val_auc: 0.9953
[INFO] saving weights to checkpoints/lstm-epoch-1-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/539690
[33m[INFO] loading file 18-18/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539690, 17)

[INFO] analyzing data
[INFO] 539690 rows
[INFO] ** appi_name:[21:99.99815%,30:0.00056%,7:0.00056%,31:0.00019%,27:0.00019%,22:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:82.02709%,Multi Stage Multi Point:17.97291%]
[INFO] ** dst:[21:43.33692%,10:20.8327%,8:18.26604%,9:17.56138%,22:0.00074%,15:0.00056%,24:0.00037%,16:0.00037%,2:0.00037%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99944%,0:0.00056%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99815%,-33.760870000000004:0.00185%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99815%,0:0.00185%]
[INFO] ** modbus_transaction_id:65536 (12.14327%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99889%,2:0.00056%,1:0.00056%]
[INFO] ** proxy_src_ip:[18:38.07371%,20:26.09646%,13:18.26641%,6:17.56156%,17:0.00056%,11:0.00056%,1:0.00037%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.09572%,-0.32151:20.8327%,-1.27613:18.26586%,-0.23351:17.56119%,-0.33484:17.24101%,-71.33197:0.00056%,-1.27347:0.00037%,1.45709:0.00037%,-0.24151:0.00037%,1.47576:0.00019%,1.46509:0.00019%,3.6236699999999997:0.00019%,-1.2708:0.00019%,-2.48275:0.00019%,6.06224:0.00019%,-3.3787199999999995:0.00019%,8.10082:0.00019%,6.45955:0.00019%,-71.14931:0.00019%]
[INFO] ** scada_tag:[3:26.09535%,1:20.83251%,5:18.26567%,4:17.56101%,2:17.24082%,0:0.00463%]
[INFO] ** service:[0.0048200000000000005:99.99815%,-211.09762999999998:0.00056%,-211.73542999999998:0.00056%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.07371%,9:26.09646%,7:18.26641%,1:17.56156%,14:0.00056%,10:0.00056%,3:0.00037%,21:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1475 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3885 - tp: 71210.0000 - fp: 8311.0000 - tn: 311689.0000 - fn: 8790.0000 - accuracy: 0.9572 - precision: 0.8955 - recall: 0.8901 - auc: 0.9785 - val_loss: 0.6326 - val_tp: 12369.0000 - val_fp: 7631.0000 - val_tn: 72369.0000 - val_fn: 7631.0000 - val_accuracy: 0.8474 - val_precision: 0.6184 - val_recall: 0.6184 - val_auc: 0.9636
[INFO] saving weights to checkpoints/lstm-epoch-1-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4087 - tp: 69694.0000 - fp: 8022.0000 - tn: 311978.0000 - fn: 10306.0000 - accuracy: 0.9542 - precision: 0.8968 - recall: 0.8712 - auc: 0.9788 - val_loss: 0.0185 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2303 - tp: 74044.0000 - fp: 5719.0000 - tn: 314281.0000 - fn: 5956.0000 - accuracy: 0.9708 - precision: 0.9283 - recall: 0.9255 - auc: 0.9896 - val_loss: 0.0058 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4756 - tp: 71091.0000 - fp: 8523.0000 - tn: 311477.0000 - fn: 8909.0000 - accuracy: 0.9564 - precision: 0.8929 - recall: 0.8886 - auc: 0.9691 - val_loss: 0.0341 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0142 - tp: 79985.0000 - fp: 9.0000 - tn: 319991.0000 - fn: 15.0000 - accuracy: 0.9999 - precision: 0.9999 - recall: 0.9998 - auc: 1.0000 - val_loss: 0.0048 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/539690
[33m[INFO] loading file 19-19/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539690, 17)

[INFO] analyzing data
[INFO] 539690 rows
[INFO] ** appi_name:[21:99.99796%,26:0.00037%,0:0.00037%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:86.74054%,Single Stage Multi Point:13.25946%]
[INFO] ** dst:[21:43.38213%,10:20.82492%,8:18.21879%,9:17.57138%,22:0.0013%,6:0.00056%,25:0.00037%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99796%,-33.760870000000004:0.00185%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99815%,0:0.00185%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.14327%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9987%,2:0.0013%]
[INFO] ** proxy_src_ip:[18:38.11318%,20:26.09405%,13:18.21879%,6:17.57138%,10:0.00111%,11:0.00093%,16:0.00056%]
[INFO] ** s_port:[1.45442:26.09294%,-0.32151:20.82492%,-1.27613:18.21842%,-0.23351:17.5712%,-0.33484:17.28826%,-5.20264:0.00074%,1.45709:0.00056%,-1.02014:0.00056%,-64.19493:0.00037%,-71.14798:0.00037%,1.46509:0.00037%,-1.27347:0.00019%,-0.24151:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-71.14931:0.00019%,-68.79874000000001:0.00019%,0.75578:0.00019%]
[INFO] ** scada_tag:[3:26.09257%,1:20.82473%,5:18.21824%,4:17.57101%,2:17.28807%,0:0.00537%]
[INFO] ** service:[0.0048200000000000005:99.9987%,-211.08346:0.00037%,-186.44547:0.00037%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.11318%,9:26.09405%,7:18.21879%,1:17.57138%,11:0.00111%,10:0.00093%,15:0.00056%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1476 (0.27349%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0069 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0032 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0057 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0026 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0051 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0022 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6200 - tp: 69316.0000 - fp: 10680.0000 - tn: 309320.0000 - fn: 10684.0000 - accuracy: 0.9466 - precision: 0.8665 - recall: 0.8665 - auc: 0.9474 - val_loss: 2.0184 - val_tp: 7882.0000 - val_fp: 12118.0000 - val_tn: 67882.0000 - val_fn: 12118.0000 - val_accuracy: 0.7576 - val_precision: 0.3941 - val_recall: 0.3941 - val_auc: 0.8575
[INFO] saving weights to checkpoints/lstm-epoch-1-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3533 - tp: 38135.0000 - fp: 41202.0000 - tn: 278798.0000 - fn: 41865.0000 - accuracy: 0.7923 - precision: 0.4807 - recall: 0.4767 - auc: 0.8515 - val_loss: 0.4614 - val_tp: 16957.0000 - val_fp: 2900.0000 - val_tn: 77100.0000 - val_fn: 3043.0000 - val_accuracy: 0.9406 - val_precision: 0.8540 - val_recall: 0.8479 - val_auc: 0.9851
[INFO] saving weights to checkpoints/lstm-epoch-1-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/539690
[33m[INFO] loading file 20-20/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539690, 17)

[INFO] analyzing data
[INFO] 539690 rows
[INFO] ** appi_name:[21:99.99648%,30:0.00296%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:92.40694%,Single Stage Multi Point:7.59306%]
[INFO] ** dst:[21:43.42697%,10:20.83529%,8:18.16487%,9:17.56786%,15:0.00296%,22:0.00111%,24:0.00037%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99741%,0:0.00259%]
[INFO] ** i/f_name:[2:99.99704%,3:0.00296%]
[INFO] ** modbus_function_code:[0.02961:99.99648%,-33.760870000000004:0.00352%]
[INFO] ** modbus_function_description:[7:49.99944%,11:49.99704%,0:0.00352%]
[INFO] ** modbus_transaction_id:65536 (12.14327%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99648%,1:0.00296%,2:0.00056%]
[INFO] ** proxy_src_ip:[18:38.11373%,20:26.14909%,13:18.16506%,6:17.56842%,17:0.00296%,14:0.00056%,16:0.00019%]
[INFO] ** s_port:[1.45442:26.14834%,-0.32151:20.83529%,-1.27613:18.1645%,-0.23351:17.56768%,-0.33484:17.27844%,-71.33197:0.00296%,-0.24151:0.00056%,1.45709:0.00037%,-1.27347:0.00037%,13.431270000000001:0.00019%,-1.2708:0.00019%,-1.02014:0.00019%,-71.14798:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,11.862:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:26.14797%,1:20.83511%,5:18.1645%,4:17.56731%,2:17.27825%,0:0.00686%]
[INFO] ** service:[0.0048200000000000005:99.99648%,-211.73542999999998:0.00296%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.11373%,9:26.14909%,7:18.16506%,1:17.56842%,14:0.00296%,2:0.00056%,15:0.00019%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1475 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0664 - tp: 78922.0000 - fp: 1049.0000 - tn: 318951.0000 - fn: 1078.0000 - accuracy: 0.9947 - precision: 0.9869 - recall: 0.9865 - auc: 0.9996 - val_loss: 0.1514 - val_tp: 19491.0000 - val_fp: 509.0000 - val_tn: 79491.0000 - val_fn: 509.0000 - val_accuracy: 0.9898 - val_precision: 0.9746 - val_recall: 0.9746 - val_auc: 0.9823
[INFO] saving weights to checkpoints/lstm-epoch-1-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6077 - tp: 64578.0000 - fp: 15411.0000 - tn: 304589.0000 - fn: 15422.0000 - accuracy: 0.9229 - precision: 0.8073 - recall: 0.8072 - auc: 0.9522 - val_loss: 0.4577 - val_tp: 16357.0000 - val_fp: 3643.0000 - val_tn: 76357.0000 - val_fn: 3643.0000 - val_accuracy: 0.9271 - val_precision: 0.8178 - val_recall: 0.8178 - val_auc: 0.9823
[INFO] saving weights to checkpoints/lstm-epoch-1-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5069 - tp: 65089.0000 - fp: 14882.0000 - tn: 305118.0000 - fn: 14911.0000 - accuracy: 0.9255 - precision: 0.8139 - recall: 0.8136 - auc: 0.9637 - val_loss: 0.4151 - val_tp: 16370.0000 - val_fp: 3630.0000 - val_tn: 76370.0000 - val_fn: 3630.0000 - val_accuracy: 0.9274 - val_precision: 0.8185 - val_recall: 0.8185 - val_auc: 0.9831
[INFO] saving weights to checkpoints/lstm-epoch-1-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1991 - tp: 75978.0000 - fp: 4022.0000 - tn: 315978.0000 - fn: 4022.0000 - accuracy: 0.9799 - precision: 0.9497 - recall: 0.9497 - auc: 0.9917 - val_loss: 0.0424 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0196 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0061 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/539690
[33m[INFO] loading file 21-21/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539688, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539688, 17)

[INFO] analyzing data
[INFO] 539688 rows
[INFO] ** appi_name:[21:99.99611%,30:0.00093%,7:0.00056%,26:0.00037%,22:0.00037%,0:0.00037%,31:0.00019%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:98.86916%,Multi Stage Single Point:1.13084%]
[INFO] ** dst:[21:43.30539%,10:20.98583%,8:18.17142%,9:17.53272%,22:0.00093%,15:0.00093%,6:0.00074%,24:0.00056%,25:0.00037%,16:0.00037%,2:0.00037%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99907%,0:0.00093%]
[INFO] ** i/f_name:[2:99.99907%,3:0.00093%]
[INFO] ** modbus_function_code:[0.02961:99.99611%,-33.760870000000004:0.00371%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.9987%,11:49.99741%,0:0.00371%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.14331%)
[INFO] ** orig:[0:99.99926%,2:0.00074%]
[INFO] ** proto:[0:99.99759%,2:0.00148%,1:0.00093%]
[INFO] ** proxy_src_ip:[18:38.31288%,20:25.97816%,13:18.1718%,6:17.53272%,10:0.00111%,17:0.00093%,11:0.00093%,16:0.00056%,1:0.00037%,21:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.9776%,-0.32151:20.98509%,-1.27613:18.17124%,-0.23351:17.53254%,-0.33484:17.32779%,-71.33197:0.00093%,-6.64392:0.00074%,-1.27347:0.00056%,-1.02014:0.00056%,-64.19493:0.00037%,-71.14931:0.00037%,-71.14798:0.00037%,1.47576:0.00019%,1.46509:0.00019%,6.62488:0.00019%,10.15141:0.00019%,-68.79874000000001:0.00019%,7.060860000000001:0.00019%,-3.3787199999999995:0.00019%,-2.2440900000000004:0.00019%,1.45709:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.97723%,1:20.9849%,5:18.17105%,4:17.53217%,2:17.32779%,0:0.00686%]
[INFO] ** service:[0.0048200000000000005:99.99685%,-211.73542999999998:0.00093%,-211.09762999999998:0.00056%,-211.08346:0.00037%,-186.44547:0.00037%,-211.08818:0.00037%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.31288%,9:25.97816%,7:18.1718%,1:17.53272%,11:0.00111%,21:0.00093%,10:0.00093%,15:0.00056%,3:0.00037%,14:0.00019%,4:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1470 (0.27238%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539688
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0123 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0043 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/539688
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0097 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0032 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/539688
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0080 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0025 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/539688
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0069 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0020 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/539688
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0060 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0016 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/539688
[33m[INFO] loading file 22-22/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (308729, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (308729, 17)

[INFO] analyzing data
[INFO] 308729 rows
[INFO] ** appi_name:[21:99.99223%,30:0.0068%,23:0.00032%,22:0.00032%,18:0.00032%]
[INFO] ** classification:[normal:57.06526%,Multi Stage Single Point:42.93474%]
[INFO] ** dst:[21:43.30108%,10:21.00386%,8:18.11394%,9:17.57205%,15:0.0068%,22:0.0013%,19:0.00065%,26:0.00032%]
[INFO] ** i/f_dir:[1:99.99352%,0:0.00648%]
[INFO] ** i/f_name:[2:99.9932%,3:0.00648%,0:0.00032%]
[INFO] ** modbus_function_code:[0.02961:99.99223%,-33.760870000000004:0.00777%]
[INFO] ** modbus_function_description:[7:49.99725%,11:49.99498%,0:0.00777%]
[INFO] ** modbus_transaction_id:65534 (21.22703%)
[INFO] ** orig:[0:99.99482%,2:0.00453%,1:0.00065%]
[INFO] ** proto:[0:99.99287%,1:0.0068%,2:0.00032%]
[INFO] ** proxy_src_ip:[18:38.32682%,20:25.97909%,13:18.1133%,6:17.57302%,17:0.0068%,14:0.00065%,10:0.00032%]
[INFO] ** s_port:[1.45442:25.97812%,-0.32151:21.00386%,-1.27613:18.1133%,-0.23351:17.57205%,-0.33484:17.32296%,-71.33197:0.0068%,1.45709:0.00065%,-0.24151:0.00065%,7.228860000000001:0.00065%,-0.24950999999999998:0.00032%,1.46509:0.00032%,-71.14931:0.00032%]
[INFO] ** scada_tag:[3:25.9778%,1:21.00386%,5:18.1133%,4:17.57172%,2:17.32296%,0:0.01037%]
[INFO] ** service:[0.0048200000000000005:99.99223%,-211.73542999999998:0.0068%,-211.07873999999998:0.00065%,-211.08818:0.00032%]
[INFO] ** src:[22:38.32682%,9:25.97909%,7:18.1133%,1:17.57302%,21:0.00453%,14:0.00227%,2:0.00065%,11:0.00032%]
[INFO] ** type:[0:99.99806%,1:0.00194%]
[INFO] ** unixtime:853 (0.27629%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/308729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.7520 - tp: 55006.0000 - fp: 24994.0000 - tn: 295006.0000 - fn: 24994.0000 - accuracy: 0.8750 - precision: 0.6876 - recall: 0.6876 - auc: 0.7514 - val_loss: 3.3279 - val_tp: 10612.0000 - val_fp: 9388.0000 - val_tn: 70612.0000 - val_fn: 9388.0000 - val_accuracy: 0.8122 - val_precision: 0.5306 - val_recall: 0.5306 - val_auc: 0.6421
[INFO] saving weights to checkpoints/lstm-epoch-1-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/308729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.7681 - tp: 42398.0000 - fp: 37602.0000 - tn: 282398.0000 - fn: 37602.0000 - accuracy: 0.8120 - precision: 0.5300 - recall: 0.5300 - auc: 0.6728 - val_loss: 2.3004 - val_tp: 10527.0000 - val_fp: 9473.0000 - val_tn: 70527.0000 - val_fn: 9473.0000 - val_accuracy: 0.8105 - val_precision: 0.5264 - val_recall: 0.5264 - val_auc: 0.6448
[INFO] saving weights to checkpoints/lstm-epoch-1-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/308729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.0454 - tp: 42370.0000 - fp: 37630.0000 - tn: 282370.0000 - fn: 37630.0000 - accuracy: 0.8118 - precision: 0.5296 - recall: 0.5296 - auc: 0.7222 - val_loss: 1.7073 - val_tp: 10624.0000 - val_fp: 9376.0000 - val_tn: 70624.0000 - val_fn: 9376.0000 - val_accuracy: 0.8125 - val_precision: 0.5312 - val_recall: 0.5312 - val_auc: 0.8751
[INFO] saving weights to checkpoints/lstm-epoch-1-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/308729
[33m[INFO] loading file 23-23/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (508729, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (508729, 17)

[INFO] analyzing data
[INFO] 508729 rows
[INFO] ** appi_name:[21:99.99902%,31:0.00039%,33:0.0002%,30:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:97.42024%,Multi Stage Single Point:2.57976%]
[INFO] ** dst:[21:43.3384%,10:20.99821%,8:18.13618%,9:17.52505%,22:0.00098%,24:0.00039%,18:0.00039%,25:0.0002%,15:0.0002%]
[INFO] ** i/f_dir:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name:[2:99.9998%,3:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.99902%,-33.760870000000004:0.00098%]
[INFO] ** modbus_function_description:[7:50.00049%,11:49.99853%,0:0.00098%]
[INFO] ** modbus_transaction_id:65536 (12.8823%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99921%,2:0.00059%,1:0.0002%]
[INFO] ** proxy_src_ip:[18:38.34596%,20:25.99085%,13:18.13638%,6:17.52524%,16:0.00059%,21:0.0002%,17:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.99026%,-0.32151:20.99802%,-1.27613:18.13579%,-0.23351:17.52485%,-0.33484:17.34794%,-1.02014:0.00059%,-0.08551:0.00039%,-1.27347:0.00039%,1.47576:0.0002%,-49.275529999999996:0.0002%,1.46509:0.0002%,-0.24151:0.0002%,-0.24950999999999998:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%,1.45709:0.0002%,-71.33197:0.0002%]
[INFO] ** scada_tag:[3:25.98987%,1:20.99802%,5:18.13559%,4:17.52465%,2:17.34774%,0:0.00413%]
[INFO] ** service:[0.0048200000000000005:99.99921%,-186.43601999999998:0.00039%,-186.44547:0.0002%,-211.73542999999998:0.0002%]
[INFO] ** src:[22:38.34596%,9:25.99085%,7:18.13638%,1:17.52524%,15:0.00059%,17:0.0002%,14:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1383 (0.27185%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7830 - tp: 66876.0000 - fp: 13124.0000 - tn: 306876.0000 - fn: 13124.0000 - accuracy: 0.9344 - precision: 0.8360 - recall: 0.8360 - auc: 0.9049 - val_loss: 0.0505 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1153 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0298 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0648 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0211 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0448 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0162 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0338 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0130 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/508729
[33m[INFO] loading file 24-24/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (508729, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (508729, 17)

[INFO] analyzing data
[INFO] 508729 rows
[INFO] ** appi_name:[21:99.99273%,30:0.00354%,26:0.00059%,31:0.00039%,27:0.00039%,22:0.00039%,0:0.00039%,24:0.0002%,23:0.0002%,19:0.0002%,18:0.0002%,16:0.0002%,15:0.0002%,11:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:94.99144%,Multi Stage Single Point:5.00856%]
[INFO] ** dst:[21:43.36081%,10:21.0334%,8:18.09451%,9:17.50382%,15:0.00354%,22:0.00118%,6:0.00079%,25:0.00039%,19:0.00039%,18:0.00039%,7:0.00039%,26:0.0002%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.99666%,0:0.00334%]
[INFO] ** i/f_name:[2:99.99646%,3:0.00354%]
[INFO] ** modbus_function_code:[0.02961:99.99273%,-33.760870000000004:0.00668%,0.47422:0.0002%,-0.415:0.0002%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.99735%,11:49.99538%,0:0.00668%,15:0.0002%,10:0.0002%,2:0.0002%]
[INFO] ** modbus_transaction_id:65536 (12.8823%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.9943%,1:0.00354%,2:0.00216%]
[INFO] ** proxy_src_ip:[18:38.41888%,20:25.97611%,13:18.09431%,6:17.50303%,17:0.00354%,10:0.00138%,14:0.00098%,11:0.00098%,21:0.00039%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.97532%,-0.32151:21.0334%,-1.27613:18.09411%,-0.23351:17.50244%,-0.33484:17.38548%,-71.33197:0.00354%,-9.58113:0.00079%,-71.14798:0.00059%,7.6315100000000005:0.00039%,-64.19493:0.00039%,-1.02014:0.00039%,-71.14931:0.00039%,-0.24151:0.00039%,1.45709:0.00039%,-31.55091:0.00039%,7.4901800000000005:0.0002%,-1.27347:0.0002%,1.47576:0.0002%,1.46509:0.0002%,13.431270000000001:0.0002%,-68.79874000000001:0.0002%,-0.24950999999999998:0.0002%,11.862:0.0002%]
[INFO] ** scada_tag:[3:25.97513%,1:21.0334%,5:18.09392%,4:17.50205%,2:17.38529%,0:0.01022%]
[INFO] ** service:[0.0048200000000000005:99.99391%,-211.73542999999998:0.00354%,-211.08346:0.00059%,-186.44547:0.00039%,-186.43601999999998:0.00039%,-211.07873999999998:0.00039%,-211.08818:0.00039%,-202.75898:0.00039%]
[INFO] ** src:[22:38.41888%,9:25.97611%,7:18.09431%,1:17.50303%,14:0.00354%,11:0.00138%,10:0.00098%,2:0.00098%,15:0.00039%,4:0.00039%]
[INFO] ** type:[0:99.99862%,1:0.00098%,2:0.00039%]
[INFO] ** unixtime:1382 (0.27166%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0268 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0107 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0218 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0090 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0181 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0077 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0143 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0069 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.9641 - tp: 64722.0000 - fp: 15278.0000 - tn: 304722.0000 - fn: 15278.0000 - accuracy: 0.9236 - precision: 0.8090 - recall: 0.8090 - auc: 0.9100 - val_loss: 1.5049 - val_tp: 12899.0000 - val_fp: 7101.0000 - val_tn: 72899.0000 - val_fn: 7101.0000 - val_accuracy: 0.8580 - val_precision: 0.6449 - val_recall: 0.6449 - val_auc: 0.9112
[INFO] saving weights to checkpoints/lstm-epoch-1-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/508729
[33m[INFO] loading file 25-25/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (508729, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (508729, 17)

[INFO] analyzing data
[INFO] 508729 rows
[INFO] ** appi_name:[21:99.99627%,30:0.00098%,17:0.00079%,22:0.00059%,31:0.00039%,28:0.0002%,26:0.0002%,12:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** classification:[normal:64.33661%,Multi Stage Single Point:35.66339%]
[INFO] ** dst:[21:43.31029%,10:21.022%,8:18.1521%,9:17.51109%,22:0.00098%,15:0.00098%,16:0.00079%,6:0.00079%,18:0.00039%,17:0.00039%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.99902%,0:0.00098%]
[INFO] ** i/f_name:[2:99.99902%,3:0.00098%]
[INFO] ** modbus_function_code:[0.02961:99.99627%,-33.760870000000004:0.00373%]
[INFO] ** modbus_function_description:[7:49.99892%,11:49.99735%,0:0.00373%]
[INFO] ** modbus_transaction_id:65536 (12.8823%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99784%,2:0.00118%,1:0.00098%]
[INFO] ** proxy_src_ip:[18:38.38154%,20:25.95036%,13:18.1523%,6:17.51168%,17:0.00098%,1:0.00098%,21:0.00079%,16:0.00039%,14:0.00039%,7:0.00039%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.95016%,-0.32151:21.0216%,-1.27613:18.1519%,-0.23351:17.51109%,-0.33484:17.35993%,-71.33197:0.00098%,-71.14931:0.00059%,-1.02014:0.00039%,-0.24151:0.00039%,-49.275529999999996:0.00039%,-71.14798:0.0002%,-58.035180000000004:0.0002%,-1.2708:0.0002%,-5.1466400000000005:0.0002%,-5.08665:0.0002%,-1.27347:0.0002%,-0.24950999999999998:0.0002%,1.45709:0.0002%,6.1115699999999995:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,2.52505:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:25.94977%,1:21.02141%,5:18.15171%,4:17.51089%,2:17.35973%,0:0.00649%]
[INFO] ** service:[0.0048200000000000005:99.99666%,-211.73542999999998:0.00098%,-205.44247:0.00079%,-211.08818:0.00059%,-186.43601999999998:0.00039%,-211.09762999999998:0.0002%,-211.08346:0.0002%,-185.9872:0.0002%]
[INFO] ** src:[22:38.38154%,9:25.95036%,7:18.1523%,1:17.51168%,14:0.00098%,3:0.00098%,4:0.00079%,21:0.00039%,15:0.00039%,2:0.00039%,8:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1382 (0.27166%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3792 - tp: 51427.0000 - fp: 28573.0000 - tn: 291427.0000 - fn: 28573.0000 - accuracy: 0.8571 - precision: 0.6428 - recall: 0.6428 - auc: 0.8314 - val_loss: 1.1024 - val_tp: 12863.0000 - val_fp: 7137.0000 - val_tn: 72863.0000 - val_fn: 7137.0000 - val_accuracy: 0.8573 - val_precision: 0.6431 - val_recall: 0.6431 - val_auc: 0.9106
[INFO] saving weights to checkpoints/lstm-epoch-1-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2455 - tp: 51501.0000 - fp: 28499.0000 - tn: 291501.0000 - fn: 28499.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.8765 - val_loss: 1.0018 - val_tp: 12862.0000 - val_fp: 7138.0000 - val_tn: 72862.0000 - val_fn: 7138.0000 - val_accuracy: 0.8572 - val_precision: 0.6431 - val_recall: 0.6431 - val_auc: 0.9104
[INFO] saving weights to checkpoints/lstm-epoch-1-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0169 - tp: 56949.0000 - fp: 23025.0000 - tn: 296975.0000 - fn: 23051.0000 - accuracy: 0.8848 - precision: 0.7121 - recall: 0.7119 - auc: 0.9064 - val_loss: 0.6680 - val_tp: 12880.0000 - val_fp: 7120.0000 - val_tn: 72880.0000 - val_fn: 7120.0000 - val_accuracy: 0.8576 - val_precision: 0.6440 - val_recall: 0.6440 - val_auc: 0.9683
[INFO] saving weights to checkpoints/lstm-epoch-1-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7596 - tp: 65300.0000 - fp: 14692.0000 - tn: 305308.0000 - fn: 14700.0000 - accuracy: 0.9265 - precision: 0.8163 - recall: 0.8163 - auc: 0.9540 - val_loss: 0.4182 - val_tp: 12872.0000 - val_fp: 7128.0000 - val_tn: 72872.0000 - val_fn: 7128.0000 - val_accuracy: 0.8574 - val_precision: 0.6436 - val_recall: 0.6436 - val_auc: 0.9682
[INFO] saving weights to checkpoints/lstm-epoch-1-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6366 - tp: 65551.0000 - fp: 14449.0000 - tn: 305551.0000 - fn: 14449.0000 - accuracy: 0.9278 - precision: 0.8194 - recall: 0.8194 - auc: 0.9687 - val_loss: 0.2722 - val_tp: 16551.0000 - val_fp: 2280.0000 - val_tn: 77720.0000 - val_fn: 3449.0000 - val_accuracy: 0.9427 - val_precision: 0.8789 - val_recall: 0.8275 - val_auc: 0.9829
[INFO] saving weights to checkpoints/lstm-epoch-1-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/508729
[33m[INFO] loading file 26-26/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (508729, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (508729, 17)

[INFO] analyzing data
[INFO] 508729 rows
[INFO] ** appi_name:[21:99.99882%,7:0.00059%,30:0.0002%,22:0.0002%,8:0.0002%]
[INFO] ** classification:[normal:64.39696%,Single Stage Single Point:31.39432%,Multi Stage Single Point:4.20872%]
[INFO] ** dst:[21:43.31068%,10:21.08431%,8:18.12026%,9:17.48239%,22:0.00079%,24:0.00039%,16:0.00039%,2:0.00039%,15:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name:[2:99.9998%,3:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.99882%,-33.760870000000004:0.00118%]
[INFO] ** modbus_function_description:[7:50.0001%,11:49.99872%,0:0.00118%]
[INFO] ** modbus_transaction_id:65536 (12.8823%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99961%,2:0.0002%,1:0.0002%]
[INFO] ** proxy_src_ip:[18:38.4692%,20:25.92618%,13:18.12065%,6:17.48239%,16:0.00039%,1:0.00039%,21:0.0002%,17:0.0002%,14:0.0002%,7:0.0002%]
[INFO] ** s_port:[1.45442:25.92559%,-0.32151:21.08431%,-1.27613:18.12006%,-0.23351:17.4822%,-0.33484:17.38489%,-1.27347:0.00039%,-1.02014:0.00039%,7.66617:0.0002%,-1.2708:0.0002%,-71.14931:0.0002%,-0.24151:0.0002%,11.57001:0.0002%,1.47576:0.0002%,1.46509:0.0002%,14.191239999999999:0.0002%,-3.3787199999999995:0.0002%,1.45709:0.0002%,-71.33197:0.0002%]
[INFO] ** scada_tag:[3:25.9252%,1:21.08431%,5:18.12006%,4:17.482%,2:17.38489%,0:0.00354%]
[INFO] ** service:[0.0048200000000000005:99.99882%,-211.09762999999998:0.00059%,-211.73542999999998:0.0002%,-211.35747999999998:0.0002%,-211.08818:0.0002%]
[INFO] ** src:[22:38.4692%,9:25.92618%,7:18.12065%,1:17.48239%,15:0.00039%,3:0.00039%,21:0.0002%,14:0.0002%,4:0.0002%,2:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1381 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.9281 - tp: 62269.0000 - fp: 17723.0000 - tn: 302277.0000 - fn: 17731.0000 - accuracy: 0.9114 - precision: 0.7784 - recall: 0.7784 - auc: 0.9329 - val_loss: 1.5161 - val_tp: 12898.0000 - val_fp: 7013.0000 - val_tn: 72987.0000 - val_fn: 7102.0000 - val_accuracy: 0.8589 - val_precision: 0.6478 - val_recall: 0.6449 - val_auc: 0.9370
[INFO] saving weights to checkpoints/lstm-epoch-1-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.9827 - tp: 56537.0000 - fp: 21444.0000 - tn: 298556.0000 - fn: 23463.0000 - accuracy: 0.8877 - precision: 0.7250 - recall: 0.7067 - auc: 0.9204 - val_loss: 0.5346 - val_tp: 12872.0000 - val_fp: 7128.0000 - val_tn: 72872.0000 - val_fn: 7128.0000 - val_accuracy: 0.8574 - val_precision: 0.6436 - val_recall: 0.6436 - val_auc: 0.9612
[INFO] saving weights to checkpoints/lstm-epoch-1-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6236 - tp: 63997.0000 - fp: 15958.0000 - tn: 304042.0000 - fn: 16003.0000 - accuracy: 0.9201 - precision: 0.8004 - recall: 0.8000 - auc: 0.9579 - val_loss: 0.2418 - val_tp: 19115.0000 - val_fp: 843.0000 - val_tn: 79157.0000 - val_fn: 885.0000 - val_accuracy: 0.9827 - val_precision: 0.9578 - val_recall: 0.9557 - val_auc: 0.9966
[INFO] saving weights to checkpoints/lstm-epoch-1-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4559 - tp: 65632.0000 - fp: 10913.0000 - tn: 309087.0000 - fn: 14368.0000 - accuracy: 0.9368 - precision: 0.8574 - recall: 0.8204 - auc: 0.9802 - val_loss: 0.1223 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3713 - tp: 65779.0000 - fp: 7788.0000 - tn: 312212.0000 - fn: 14221.0000 - accuracy: 0.9450 - precision: 0.8941 - recall: 0.8222 - auc: 0.9836 - val_loss: 0.0663 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/508729
[33m[INFO] loading file 27-27/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (448859, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (448859, 17)

[INFO] analyzing data
[INFO] 448859 rows
[INFO] ** appi_name:[21:99.99933%,30:0.00067%]
[INFO] ** classification:[normal:64.33735%,Single Stage Single Point:35.66265%]
[INFO] ** dst:[21:43.2715%,10:21.06385%,8:18.1948%,9:17.46807%,22:0.00089%,15:0.00067%,24:0.00022%]
[INFO] ** i/f_dir:[1:99.99978%,0:0.00022%]
[INFO] ** i/f_name:[2:99.99933%,3:0.00067%]
[INFO] ** modbus_function_code:[0.02961:99.99933%,-33.760870000000004:0.00067%]
[INFO] ** modbus_function_description:[7:50.00033%,11:49.999%,0:0.00067%]
[INFO] ** modbus_transaction_id:65536 (14.60058%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99933%,1:0.00067%]
[INFO] ** proxy_src_ip:[18:38.40493%,20:25.93108%,13:18.19458%,6:17.46829%,17:0.00067%,16:0.00045%]
[INFO] ** s_port:[1.45442:25.93041%,-0.32151:21.06385%,-1.27613:18.19436%,-0.23351:17.46785%,-0.33484:17.34108%,-71.33197:0.00067%,-1.02014:0.00045%,-1.27347:0.00022%,1.45709:0.00022%,-0.24950999999999998:0.00022%,1.46509:0.00022%,1.47576:0.00022%,-0.24151:0.00022%]
[INFO] ** scada_tag:[3:25.92997%,1:21.06363%,5:18.19413%,4:17.46762%,2:17.34086%,0:0.00379%]
[INFO] ** service:[0.0048200000000000005:99.99933%,-211.73542999999998:0.00067%]
[INFO] ** src:[22:38.40493%,9:25.93108%,7:18.19458%,1:17.46829%,14:0.00067%,15:0.00045%]
[INFO] ** type:[0:99.99955%,1:0.00045%]
[INFO] ** unixtime:1220 (0.2718%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/448859
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3012 - tp: 65610.0000 - fp: 7334.0000 - tn: 312666.0000 - fn: 14390.0000 - accuracy: 0.9457 - precision: 0.8995 - recall: 0.8201 - auc: 0.9881 - val_loss: 0.0322 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/448859
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2334 - tp: 71448.0000 - fp: 7199.0000 - tn: 312801.0000 - fn: 8552.0000 - accuracy: 0.9606 - precision: 0.9085 - recall: 0.8931 - auc: 0.9915 - val_loss: 0.0165 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/448859
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1913 - tp: 72878.0000 - fp: 7122.0000 - tn: 312878.0000 - fn: 7122.0000 - accuracy: 0.9644 - precision: 0.9110 - recall: 0.9110 - auc: 0.9950 - val_loss: 0.0099 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/448859
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1594 - tp: 72916.0000 - fp: 7084.0000 - tn: 312916.0000 - fn: 7084.0000 - accuracy: 0.9646 - precision: 0.9115 - recall: 0.9115 - auc: 0.9968 - val_loss: 0.0065 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/448859
[33m[INFO] loading file 28-28/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (382775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (382775, 17)

[INFO] analyzing data
[INFO] 382775 rows
[INFO] ** appi_name:[21:99.99216%,30:0.00183%,17:0.00131%,22:0.00105%,7:0.00105%,31:0.00078%,26:0.00078%,28:0.00026%,27:0.00026%,8:0.00026%,0:0.00026%]
[INFO] ** classification:[normal:64.3088%,Single Stage Single Point:35.6912%]
[INFO] ** dst:[21:43.28235%,10:21.01835%,8:18.2073%,9:17.48364%,6:0.00209%,16:0.00183%,18:0.00131%,15:0.00078%,22:0.00052%,17:0.00052%,2:0.00052%,25:0.00026%,7:0.00026%,0:0.00026%]
[INFO] ** i/f_dir:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name:[2:99.99922%,3:0.00078%]
[INFO] ** modbus_function_code:[0.02961:99.99216%,-33.760870000000004:0.00784%]
[INFO] ** modbus_function_description:[11:49.99621%,7:49.99595%,0:0.00784%]
[INFO] ** modbus_transaction_id:65536 (17.12129%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9953%,2:0.00392%,1:0.00078%]
[INFO] ** proxy_src_ip:[18:38.3361%,20:25.9646%,13:18.20756%,6:17.4839%,1:0.00209%,17:0.00183%,14:0.00157%,7:0.00131%,21:0.00078%,0:0.00026%]
[INFO] ** s_port:[1.45442:25.96434%,-0.32151:21.01835%,-1.27613:18.2073%,-0.23351:17.48338%,-0.33484:17.31775%,-71.14798:0.00105%,-71.14931:0.00105%,-71.33197:0.00078%,-0.08551:0.00052%,-0.24151:0.00052%,7.66617:0.00026%,-58.035180000000004:0.00026%,-1.2708:0.00026%,-64.19493:0.00026%,-5.1466400000000005:0.00026%,13.431270000000001:0.00026%,11.57001:0.00026%,14.4699:0.00026%,1.47576:0.00026%,14.191239999999999:0.00026%,-5.08665:0.00026%,10.192739999999999:0.00026%,-3.3787199999999995:0.00026%,6.1115699999999995:0.00026%,2.05573:0.00026%,-43.76509:0.00026%,2.52505:0.00026%,11.862:0.00026%,-58.032509999999995:0.00026%]
[INFO] ** scada_tag:[3:25.96408%,1:21.01835%,5:18.2073%,4:17.48312%,2:17.31775%,0:0.00941%]
[INFO] ** service:[0.0048200000000000005:99.99216%,-205.44247:0.00131%,-186.43601999999998:0.00131%,-211.09762999999998:0.00105%,-211.08346:0.00105%,-211.08818:0.00105%,-211.73542999999998:0.00078%,-186.44547:0.00026%,-183.8612:0.00026%,-185.9872:0.00026%,-211.35747999999998:0.00026%,-202.75898:0.00026%]
[INFO] ** src:[22:38.3361%,9:25.9646%,7:18.20756%,1:17.4839%,3:0.00235%,2:0.00157%,21:0.00131%,4:0.00105%,14:0.00078%,8:0.00052%,17:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1040 (0.2717%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/382775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1331 - tp: 72817.0000 - fp: 7183.0000 - tn: 312817.0000 - fn: 7183.0000 - accuracy: 0.9641 - precision: 0.9102 - recall: 0.9102 - auc: 0.9969 - val_loss: 0.0050 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/382775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1193 - tp: 72800.0000 - fp: 7200.0000 - tn: 312800.0000 - fn: 7200.0000 - accuracy: 0.9640 - precision: 0.9100 - recall: 0.9100 - auc: 0.9969 - val_loss: 0.0033 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/382775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1089 - tp: 71121.0000 - fp: 3637.0000 - tn: 316363.0000 - fn: 8879.0000 - accuracy: 0.9687 - precision: 0.9513 - recall: 0.8890 - auc: 0.9970 - val_loss: 0.0025 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/382775
[33m[INFO] loading file 29-29/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582775, 17)

[INFO] analyzing data
[INFO] 582775 rows
[INFO] ** appi_name:[21:99.9988%,30:0.00051%,31:0.00017%,26:0.00017%,9:0.00017%,3:0.00017%]
[INFO] ** classification:[normal:64.38746%,Single Stage Single Point:35.61254%]
[INFO] ** dst:[21:43.32427%,10:21.06182%,8:18.14422%,9:17.46798%,22:0.00051%,15:0.00051%,24:0.00017%,18:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99949%,3:0.00051%]
[INFO] ** modbus_function_code:[0.02961:99.9988%,-33.760870000000004:0.0012%]
[INFO] ** modbus_function_description:[7:49.99974%,11:49.99906%,0:0.0012%]
[INFO] ** modbus_transaction_id:65536 (11.24551%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99914%,1:0.00051%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.43542%,20:25.95084%,13:18.14457%,6:17.4678%,17:0.00051%,21:0.00017%,16:0.00017%,7:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95032%,-0.32151:21.06164%,-1.27613:18.14422%,-0.23351:17.4678%,-0.33484:17.37377%,-71.33197:0.00051%,1.45709:0.00034%,-71.14798:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,6.1115699999999995:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:25.94998%,1:21.06147%,5:18.14422%,4:17.46746%,2:17.37377%,0:0.00309%]
[INFO] ** service:[0.0048200000000000005:99.99897%,-211.73542999999998:0.00051%,-183.8612:0.00017%,-211.08346:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.43542%,9:25.95084%,7:18.14457%,1:17.4678%,14:0.00051%,21:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1583 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1035 - tp: 69550.0000 - fp: 210.0000 - tn: 319790.0000 - fn: 10450.0000 - accuracy: 0.9733 - precision: 0.9970 - recall: 0.8694 - auc: 0.9983 - val_loss: 0.0020 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0966 - tp: 76810.0000 - fp: 3190.0000 - tn: 316810.0000 - fn: 3190.0000 - accuracy: 0.9840 - precision: 0.9601 - recall: 0.9601 - auc: 0.9986 - val_loss: 0.0016 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0941 - tp: 76740.0000 - fp: 3260.0000 - tn: 316740.0000 - fn: 3260.0000 - accuracy: 0.9837 - precision: 0.9592 - recall: 0.9592 - auc: 0.9986 - val_loss: 0.0013 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0919 - tp: 76768.0000 - fp: 3232.0000 - tn: 316768.0000 - fn: 3232.0000 - accuracy: 0.9838 - precision: 0.9596 - recall: 0.9596 - auc: 0.9986 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0891 - tp: 76813.0000 - fp: 3187.0000 - tn: 316813.0000 - fn: 3187.0000 - accuracy: 0.9841 - precision: 0.9602 - recall: 0.9602 - auc: 0.9986 - val_loss: 0.0015 - val_tp: 19998.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/582775
[33m[INFO] loading file 30-30/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582775, 17)

[INFO] analyzing data
[INFO] 582775 rows
[INFO] ** appi_name:[21:99.9976%,30:0.00172%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.37459%,Single Stage Single Point:35.62541%]
[INFO] ** dst:[21:43.34143%,10:21.03024%,8:18.14525%,9:17.47982%,15:0.00172%,22:0.00069%,24:0.00034%,25:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99846%,0:0.00154%]
[INFO] ** i/f_name:[2:99.99828%,3:0.00172%]
[INFO] ** modbus_function_code:[0.02961:99.9976%,-33.760870000000004:0.0024%]
[INFO] ** modbus_function_description:[7:49.99957%,11:49.99803%,0:0.0024%]
[INFO] ** modbus_transaction_id:65536 (11.24551%)
[INFO] ** orig:[0:99.99914%,2:0.00051%,1:0.00034%]
[INFO] ** proto:[0:99.99794%,1:0.00172%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.37673%,20:25.99477%,13:18.1456%,6:17.48033%,17:0.00172%,7:0.00034%,16:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.99459%,-0.32151:21.03007%,-1.27613:18.14508%,-0.23351:17.47964%,-0.33484:17.34666%,-71.33197:0.00172%,-0.24151:0.00051%,-1.27347:0.00034%,-71.14798:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:25.99425%,1:21.03007%,5:18.14491%,4:17.47947%,2:17.34649%,0:0.0048%]
[INFO] ** service:[0.0048200000000000005:99.99777%,-211.73542999999998:0.00172%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.37673%,9:25.99477%,7:18.1456%,1:17.48033%,14:0.0012%,21:0.00086%,16:0.00017%,15:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99914%,1:0.00086%]
[INFO] ** unixtime:1584 (0.2718%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0880 - tp: 76839.0000 - fp: 3161.0000 - tn: 316839.0000 - fn: 3161.0000 - accuracy: 0.9842 - precision: 0.9605 - recall: 0.9605 - auc: 0.9986 - val_loss: 8.3755e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0863 - tp: 76867.0000 - fp: 3133.0000 - tn: 316867.0000 - fn: 3133.0000 - accuracy: 0.9843 - precision: 0.9608 - recall: 0.9608 - auc: 0.9987 - val_loss: 7.2792e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0864 - tp: 76811.0000 - fp: 3189.0000 - tn: 316811.0000 - fn: 3189.0000 - accuracy: 0.9841 - precision: 0.9601 - recall: 0.9601 - auc: 0.9986 - val_loss: 9.8848e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0857 - tp: 76772.0000 - fp: 3228.0000 - tn: 316772.0000 - fn: 3228.0000 - accuracy: 0.9839 - precision: 0.9596 - recall: 0.9596 - auc: 0.9986 - val_loss: 5.9488e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0844 - tp: 76859.0000 - fp: 3141.0000 - tn: 316859.0000 - fn: 3141.0000 - accuracy: 0.9843 - precision: 0.9607 - recall: 0.9607 - auc: 0.9987 - val_loss: 5.3099e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/582775
[33m[INFO] loading file 31-31/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582775, 17)

[INFO] analyzing data
[INFO] 582775 rows
[INFO] ** appi_name:[21:99.99966%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.3775%,Single Stage Single Point:35.6225%]
[INFO] ** dst:[21:43.32513%,10:21.05083%,8:18.12072%,9:17.50161%,22:0.00103%,24:0.00034%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99966%,-33.760870000000004:0.00034%]
[INFO] ** modbus_function_description:[7:50.00026%,11:49.9994%,0:0.00034%]
[INFO] ** modbus_transaction_id:65536 (11.24551%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.39835%,20:25.97829%,13:18.12089%,6:17.50161%,16:0.00051%,7:0.00034%]
[INFO] ** s_port:[1.45442:25.97761%,-0.32151:21.05083%,-1.27613:18.12054%,-0.23351:17.50144%,-0.33484:17.34752%,-1.02014:0.00051%,-1.27347:0.00034%,1.45709:0.00034%,-71.14798:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.97726%,1:21.05066%,5:18.12037%,4:17.50109%,2:17.34735%,0:0.00326%]
[INFO] ** service:[0.0048200000000000005:99.99966%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.39835%,9:25.97829%,7:18.12089%,1:17.50161%,15:0.00051%,21:0.00034%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1583 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0864 - tp: 76714.0000 - fp: 3286.0000 - tn: 316714.0000 - fn: 3286.0000 - accuracy: 0.9836 - precision: 0.9589 - recall: 0.9589 - auc: 0.9986 - val_loss: 4.8177e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0797 - tp: 76785.0000 - fp: 3215.0000 - tn: 316785.0000 - fn: 3215.0000 - accuracy: 0.9839 - precision: 0.9598 - recall: 0.9598 - auc: 0.9989 - val_loss: 2.0510e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0654 - tp: 76767.0000 - fp: 3233.0000 - tn: 316767.0000 - fn: 3233.0000 - accuracy: 0.9838 - precision: 0.9596 - recall: 0.9596 - auc: 0.9991 - val_loss: 5.9621e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0628 - tp: 76769.0000 - fp: 3231.0000 - tn: 316769.0000 - fn: 3231.0000 - accuracy: 0.9838 - precision: 0.9596 - recall: 0.9596 - auc: 0.9991 - val_loss: 4.3913e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0606 - tp: 76806.0000 - fp: 3194.0000 - tn: 316806.0000 - fn: 3194.0000 - accuracy: 0.9840 - precision: 0.9601 - recall: 0.9601 - auc: 0.9991 - val_loss: 3.5015e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/582775
[33m[INFO] loading file 32-32/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582775, 17)

[INFO] analyzing data
[INFO] 582775 rows
[INFO] ** appi_name:[21:99.99657%,30:0.00292%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.38214%,Single Stage Single Point:35.61786%]
[INFO] ** dst:[21:43.32187%,10:21.05581%,8:18.15349%,9:17.46437%,15:0.00292%,22:0.00086%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99743%,0:0.00257%]
[INFO] ** i/f_name:[2:99.99708%,3:0.00292%]
[INFO] ** modbus_function_code:[0.02961:99.99657%,-33.760870000000004:0.00343%]
[INFO] ** modbus_function_description:[7:49.99923%,11:49.99734%,0:0.00343%]
[INFO] ** modbus_transaction_id:65536 (11.24551%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99657%,1:0.00292%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.42306%,20:25.95496%,13:18.15349%,6:17.46489%,17:0.00292%,14:0.00051%,16:0.00017%]
[INFO] ** s_port:[1.45442:25.95444%,-0.32151:21.05581%,-1.27613:18.15315%,-0.23351:17.4642%,-0.33484:17.36725%,-71.33197:0.00292%,-0.24151:0.00051%,-1.2708:0.00017%,-1.02014:0.00017%,13.431270000000001:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.9541%,1:21.05564%,5:18.15315%,4:17.46386%,2:17.36725%,0:0.00601%]
[INFO] ** service:[0.0048200000000000005:99.99657%,-211.73542999999998:0.00292%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.42306%,9:25.95496%,7:18.15349%,1:17.46489%,14:0.00292%,2:0.00051%,15:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1581 (0.27129%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0614 - tp: 76801.0000 - fp: 3199.0000 - tn: 316801.0000 - fn: 3199.0000 - accuracy: 0.9840 - precision: 0.9600 - recall: 0.9600 - auc: 0.9991 - val_loss: 0.0325 - val_tp: 19685.0000 - val_fp: 308.0000 - val_tn: 79692.0000 - val_fn: 315.0000 - val_accuracy: 0.9938 - val_precision: 0.9846 - val_recall: 0.9843 - val_auc: 0.9998
[INFO] saving weights to checkpoints/lstm-epoch-1-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0619 - tp: 76768.0000 - fp: 3232.0000 - tn: 316768.0000 - fn: 3232.0000 - accuracy: 0.9838 - precision: 0.9596 - recall: 0.9596 - auc: 0.9991 - val_loss: 6.0403e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0604 - tp: 76743.0000 - fp: 3257.0000 - tn: 316743.0000 - fn: 3257.0000 - accuracy: 0.9837 - precision: 0.9593 - recall: 0.9593 - auc: 0.9991 - val_loss: 2.1216e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0609 - tp: 76707.0000 - fp: 3293.0000 - tn: 316707.0000 - fn: 3293.0000 - accuracy: 0.9835 - precision: 0.9588 - recall: 0.9588 - auc: 0.9991 - val_loss: 2.8739e-04 - val_tp: 19997.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9999 - val_recall: 0.9998 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0606 - tp: 76761.0000 - fp: 3239.0000 - tn: 316761.0000 - fn: 3239.0000 - accuracy: 0.9838 - precision: 0.9595 - recall: 0.9595 - auc: 0.9991 - val_loss: 1.5317e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/582775
[33m[INFO] loading file 33-33/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582775, 17)

[INFO] analyzing data
[INFO] 582775 rows
[INFO] ** appi_name:[21:99.99708%,30:0.00103%,17:0.00069%,22:0.00051%,31:0.00017%,28:0.00017%,26:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.39552%,Single Stage Single Point:35.60448%]
[INFO] ** dst:[21:43.32736%,10:21.06353%,8:18.1226%,9:17.48188%,22:0.00137%,15:0.00103%,16:0.00069%,6:0.00069%,24:0.00034%,17:0.00034%,18:0.00017%]
[INFO] ** i/f_dir:[1:99.99897%,0:0.00103%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99708%,-33.760870000000004:0.00292%]
[INFO] ** modbus_function_description:[7:49.99974%,11:49.99734%,0:0.00292%]
[INFO] ** modbus_transaction_id:65536 (11.24551%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99811%,1:0.00103%,2:0.00086%]
[INFO] ** proxy_src_ip:[18:38.42375%,20:25.968%,13:18.1226%,6:17.48205%,17:0.00103%,16:0.00069%,1:0.00069%,21:0.00034%,14:0.00034%,7:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.96714%,-0.32151:21.06353%,-1.27613:18.12226%,-0.23351:17.4817%,-0.33484:17.36022%,-71.33197:0.00103%,-1.02014:0.00069%,1.45709:0.00051%,-71.14931:0.00051%,-1.27347:0.00034%,-5.08665:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,-71.14798:0.00017%,-58.032509999999995:0.00017%,-58.035180000000004:0.00017%,-0.24151:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.9668%,1:21.06353%,5:18.12209%,4:17.48153%,2:17.36022%,0:0.00583%]
[INFO] ** service:[0.0048200000000000005:99.99708%,-211.73542999999998:0.00103%,-205.44247:0.00069%,-211.08818:0.00051%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.42375%,9:25.968%,7:18.1226%,1:17.48205%,14:0.00103%,15:0.00069%,3:0.00069%,21:0.00034%,4:0.00034%,2:0.00034%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1585 (0.27197%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0604 - tp: 76752.0000 - fp: 3248.0000 - tn: 316752.0000 - fn: 3248.0000 - accuracy: 0.9838 - precision: 0.9594 - recall: 0.9594 - auc: 0.9991 - val_loss: 5.1209e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0605 - tp: 76718.0000 - fp: 3282.0000 - tn: 316718.0000 - fn: 3282.0000 - accuracy: 0.9836 - precision: 0.9590 - recall: 0.9590 - auc: 0.9991 - val_loss: 1.1048e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0595 - tp: 76765.0000 - fp: 3235.0000 - tn: 316765.0000 - fn: 3235.0000 - accuracy: 0.9838 - precision: 0.9596 - recall: 0.9596 - auc: 0.9991 - val_loss: 9.3313e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0602 - tp: 76735.0000 - fp: 3265.0000 - tn: 316735.0000 - fn: 3265.0000 - accuracy: 0.9837 - precision: 0.9592 - recall: 0.9592 - auc: 0.9991 - val_loss: 7.7849e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0601 - tp: 76703.0000 - fp: 3297.0000 - tn: 316703.0000 - fn: 3297.0000 - accuracy: 0.9835 - precision: 0.9588 - recall: 0.9588 - auc: 0.9991 - val_loss: 6.6674e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/582775
[33m[INFO] loading file 34-34/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (424208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (424208, 17)

[INFO] analyzing data
[INFO] 424208 rows
[INFO] ** appi_name:[21:99.99764%,30:0.00071%,7:0.00071%,31:0.00024%,22:0.00024%,8:0.00024%,6:0.00024%]
[INFO] ** classification:[normal:64.34509%,Single Stage Single Point:35.65491%]
[INFO] ** dst:[21:43.28513%,10:21.05689%,8:18.18825%,9:17.4669%,22:0.00071%,15:0.00071%,16:0.00047%,2:0.00047%,18:0.00024%,6:0.00024%]
[INFO] ** i/f_dir:[1:99.99929%,0:0.00071%]
[INFO] ** i/f_name:[2:99.99929%,3:0.00071%]
[INFO] ** modbus_function_code:[0.02961:99.99764%,-33.760870000000004:0.00236%]
[INFO] ** modbus_function_description:[7:49.99929%,11:49.99835%,0:0.00236%]
[INFO] ** modbus_transaction_id:65536 (15.44903%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99882%,1:0.00071%,2:0.00047%]
[INFO] ** proxy_src_ip:[18:38.39343%,20:25.94883%,13:18.18801%,6:17.46737%,17:0.00071%,1:0.00071%,21:0.00047%,14:0.00024%,7:0.00024%]
[INFO] ** s_port:[1.45442:25.94836%,-0.32151:21.05665%,-1.27613:18.18801%,-0.23351:17.46667%,-0.33484:17.33678%,-0.24151:0.00071%,-71.33197:0.00071%,-3.0613900000000003:0.00024%,-3.3787199999999995:0.00024%,14.191239999999999:0.00024%,1.46509:0.00024%,1.47576:0.00024%,11.57001:0.00024%,-49.275529999999996:0.00024%,-71.14931:0.00024%,7.66617:0.00024%]
[INFO] ** scada_tag:[3:25.94812%,1:21.05642%,5:18.18778%,4:17.4662%,2:17.33678%,0:0.00471%]
[INFO] ** service:[0.0048200000000000005:99.99788%,-211.09762999999998:0.00071%,-211.73542999999998:0.00071%,-186.43601999999998:0.00024%,-211.35747999999998:0.00024%,-211.08818:0.00024%]
[INFO] ** src:[22:38.39343%,9:25.94883%,7:18.18801%,1:17.46737%,14:0.00071%,3:0.00071%,4:0.00047%,21:0.00024%,2:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1152 (0.27156%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/424208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0597 - tp: 76748.0000 - fp: 3252.0000 - tn: 316748.0000 - fn: 3252.0000 - accuracy: 0.9837 - precision: 0.9593 - recall: 0.9593 - auc: 0.9991 - val_loss: 5.7728e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/424208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0592 - tp: 76785.0000 - fp: 3215.0000 - tn: 316785.0000 - fn: 3215.0000 - accuracy: 0.9839 - precision: 0.9598 - recall: 0.9598 - auc: 0.9991 - val_loss: 4.8447e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/424208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0604 - tp: 76657.0000 - fp: 3343.0000 - tn: 316657.0000 - fn: 3343.0000 - accuracy: 0.9833 - precision: 0.9582 - recall: 0.9582 - auc: 0.9991 - val_loss: 4.4123e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/424208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0593 - tp: 76794.0000 - fp: 3206.0000 - tn: 316794.0000 - fn: 3206.0000 - accuracy: 0.9840 - precision: 0.9599 - recall: 0.9599 - auc: 0.9991 - val_loss: 3.6802e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-33-34-batch-300000-400000
[INFO] processing batch 400000-500000/424208
[33m[INFO] loading file 35-35/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:99.99886%,30:0.00114%]
[INFO] ** classification:[normal:64.37769%,Single Stage Single Point:35.62231%]
[INFO] ** dst:[21:43.33566%,10:21.03936%,8:18.14413%,9:17.47856%,22:0.00114%,15:0.00114%]
[INFO] ** i/f_dir:[1:99.99905%,0:0.00095%]
[INFO] ** i/f_name:[2:99.99886%,3:0.00114%]
[INFO] ** modbus_function_code:[0.02961:99.99886%,-33.760870000000004:0.00114%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99886%,0:0.00114%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99886%,1:0.00114%]
[INFO] ** proxy_src_ip:[18:38.40346%,20:25.97213%,13:18.14375%,6:17.47875%,17:0.00114%,16:0.00076%]
[INFO] ** s_port:[1.45442:25.97156%,-0.32151:21.03936%,-1.27613:18.14375%,-0.23351:17.47837%,-0.33484:17.3641%,-71.33197:0.00114%,-1.02014:0.00076%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.97118%,1:21.03936%,5:18.14356%,4:17.47799%,2:17.3641%,0:0.00382%]
[INFO] ** service:[0.0048200000000000005:99.99886%,-211.73542999999998:0.00114%]
[INFO] ** src:[22:38.40346%,9:25.97213%,7:18.14375%,1:17.47875%,14:0.00114%,15:0.00076%]
[INFO] ** type:[0:99.99905%,1:0.00095%]
[INFO] ** unixtime:1423 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0588 - tp: 76879.0000 - fp: 3121.0000 - tn: 316879.0000 - fn: 3121.0000 - accuracy: 0.9844 - precision: 0.9610 - recall: 0.9610 - auc: 0.9992 - val_loss: 3.1282e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0583 - tp: 76841.0000 - fp: 3159.0000 - tn: 316841.0000 - fn: 3159.0000 - accuracy: 0.9842 - precision: 0.9605 - recall: 0.9605 - auc: 0.9992 - val_loss: 6.8922e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0589 - tp: 76777.0000 - fp: 3223.0000 - tn: 316777.0000 - fn: 3223.0000 - accuracy: 0.9839 - precision: 0.9597 - recall: 0.9597 - auc: 0.9991 - val_loss: 2.3200e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0599 - tp: 76740.0000 - fp: 3260.0000 - tn: 316740.0000 - fn: 3260.0000 - accuracy: 0.9837 - precision: 0.9592 - recall: 0.9592 - auc: 0.9991 - val_loss: 1.9326e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0611 - tp: 76672.0000 - fp: 3328.0000 - tn: 316672.0000 - fn: 3328.0000 - accuracy: 0.9834 - precision: 0.9584 - recall: 0.9584 - auc: 0.9991 - val_loss: 1.6857e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 36-36/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:99.99866%,30:0.00057%,31:0.00038%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.35156%,Single Stage Single Point:35.64844%]
[INFO] ** dst:[21:43.33032%,10:21.01914%,8:18.1613%,9:17.48695%,22:0.00076%,15:0.00057%,24:0.00038%,18:0.00038%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99943%,0:0.00057%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99866%,-33.760870000000004:0.00134%]
[INFO] ** modbus_function_description:[7:50.00038%,11:49.99828%,0:0.00134%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99886%,2:0.00057%,1:0.00057%]
[INFO] ** proxy_src_ip:[18:38.36836%,20:25.98129%,13:18.16149%,6:17.48752%,17:0.00057%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98072%,-0.32151:21.01895%,-1.27613:18.16092%,-0.23351:17.48676%,-0.33484:17.34941%,-0.24151:0.00057%,-71.33197:0.00057%,-1.27347:0.00038%,-0.08551:0.00038%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-49.275529999999996:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.98034%,1:21.01876%,5:18.16073%,4:17.48657%,2:17.34922%,0:0.00439%]
[INFO] ** service:[0.0048200000000000005:99.99886%,-211.73542999999998:0.00057%,-186.43601999999998:0.00038%,-186.44547:0.00019%]
[INFO] ** src:[22:38.36836%,9:25.98129%,7:18.16149%,1:17.48752%,14:0.00057%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1424 (0.27165%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0596 - tp: 76711.0000 - fp: 3289.0000 - tn: 316711.0000 - fn: 3289.0000 - accuracy: 0.9836 - precision: 0.9589 - recall: 0.9589 - auc: 0.9991 - val_loss: 1.4469e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0591 - tp: 76829.0000 - fp: 3171.0000 - tn: 316829.0000 - fn: 3171.0000 - accuracy: 0.9841 - precision: 0.9604 - recall: 0.9604 - auc: 0.9991 - val_loss: 8.0711e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0587 - tp: 76864.0000 - fp: 3136.0000 - tn: 316864.0000 - fn: 3136.0000 - accuracy: 0.9843 - precision: 0.9608 - recall: 0.9608 - auc: 0.9991 - val_loss: 1.1054e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0581 - tp: 76800.0000 - fp: 3200.0000 - tn: 316800.0000 - fn: 3200.0000 - accuracy: 0.9840 - precision: 0.9600 - recall: 0.9600 - auc: 0.9991 - val_loss: 1.0272e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0592 - tp: 76737.0000 - fp: 3263.0000 - tn: 316737.0000 - fn: 3263.0000 - accuracy: 0.9837 - precision: 0.9592 - recall: 0.9592 - auc: 0.9991 - val_loss: 8.7946e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 37-37/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:99.99886%,30:0.00076%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.38627%,Single Stage Single Point:35.61373%]
[INFO] ** dst:[21:43.33814%,10:21.04623%,8:18.13383%,9:17.4797%,22:0.00076%,15:0.00076%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99924%,3:0.00076%]
[INFO] ** modbus_function_code:[0.02961:99.99886%,-33.760870000000004:0.00114%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99866%,0:0.00114%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99905%,1:0.00076%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.39545%,20:25.9893%,13:18.13402%,6:17.4797%,17:0.00076%,16:0.00038%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.98873%,-0.32151:21.04623%,-1.27613:18.13364%,-0.23351:17.47951%,-0.33484:17.34922%,-71.33197:0.00076%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.98854%,1:21.04623%,5:18.13345%,4:17.47932%,2:17.34903%,0:0.00343%]
[INFO] ** service:[0.0048200000000000005:99.99886%,-211.73542999999998:0.00076%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.39545%,9:25.9893%,7:18.13402%,1:17.4797%,14:0.00076%,15:0.00038%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1424 (0.27165%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0582 - tp: 76835.0000 - fp: 3165.0000 - tn: 316835.0000 - fn: 3165.0000 - accuracy: 0.9842 - precision: 0.9604 - recall: 0.9604 - auc: 0.9992 - val_loss: 7.7590e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0578 - tp: 76807.0000 - fp: 3193.0000 - tn: 316807.0000 - fn: 3193.0000 - accuracy: 0.9840 - precision: 0.9601 - recall: 0.9601 - auc: 0.9992 - val_loss: 6.9003e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0585 - tp: 76760.0000 - fp: 3240.0000 - tn: 316760.0000 - fn: 3240.0000 - accuracy: 0.9838 - precision: 0.9595 - recall: 0.9595 - auc: 0.9991 - val_loss: 6.2467e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0581 - tp: 76848.0000 - fp: 3152.0000 - tn: 316848.0000 - fn: 3152.0000 - accuracy: 0.9842 - precision: 0.9606 - recall: 0.9606 - auc: 0.9992 - val_loss: 8.0643e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0582 - tp: 76823.0000 - fp: 3177.0000 - tn: 316823.0000 - fn: 3177.0000 - accuracy: 0.9841 - precision: 0.9603 - recall: 0.9603 - auc: 0.9992 - val_loss: 4.5143e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 38-38/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:99.99905%,30:0.00019%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.41126%,Single Stage Single Point:35.58874%]
[INFO] ** dst:[21:43.32212%,10:21.08705%,8:18.09625%,9:17.49267%,22:0.00095%,25:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99905%,-33.760870000000004:0.00095%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99943%,0:0.00095%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99943%,2:0.00038%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.45439%,20:25.95535%,13:18.09606%,6:17.49306%,7:0.00038%,17:0.00019%,16:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95458%,-0.32151:21.08686%,-1.27613:18.09587%,-0.23351:17.49248%,-0.33484:17.36753%,1.45709:0.00038%,-0.24151:0.00038%,-71.14798:0.00019%,-64.19493:0.00019%,-1.02014:0.00019%,-61.95768:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,10.192739999999999:0.00019%,-0.24950999999999998:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.9542%,1:21.08686%,5:18.09587%,4:17.49229%,2:17.36753%,0:0.00324%]
[INFO] ** service:[0.0048200000000000005:99.99924%,-186.44547:0.00019%,-211.08346:0.00019%,-211.73542999999998:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.45439%,9:25.95535%,7:18.09606%,1:17.49306%,21:0.00038%,16:0.00019%,15:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1425 (0.27184%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0602 - tp: 76671.0000 - fp: 3329.0000 - tn: 316671.0000 - fn: 3329.0000 - accuracy: 0.9834 - precision: 0.9584 - recall: 0.9584 - auc: 0.9991 - val_loss: 3.8687e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0590 - tp: 76715.0000 - fp: 3285.0000 - tn: 316715.0000 - fn: 3285.0000 - accuracy: 0.9836 - precision: 0.9589 - recall: 0.9589 - auc: 0.9991 - val_loss: 7.4249e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0585 - tp: 76812.0000 - fp: 3188.0000 - tn: 316812.0000 - fn: 3188.0000 - accuracy: 0.9841 - precision: 0.9602 - recall: 0.9602 - auc: 0.9992 - val_loss: 3.0382e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0589 - tp: 76839.0000 - fp: 3161.0000 - tn: 316839.0000 - fn: 3161.0000 - accuracy: 0.9842 - precision: 0.9605 - recall: 0.9605 - auc: 0.9992 - val_loss: 2.8539e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0598 - tp: 76793.0000 - fp: 3207.0000 - tn: 316793.0000 - fn: 3207.0000 - accuracy: 0.9840 - precision: 0.9599 - recall: 0.9599 - auc: 0.9991 - val_loss: 8.0616e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 39-39/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.41145%,Single Stage Single Point:35.58855%]
[INFO] ** dst:[21:43.32269%,10:21.088%,8:18.13002%,9:17.45815%,22:0.00095%,24:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00057%,11:49.99943%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.46164%,20:25.94924%,13:18.1304%,6:17.45815%,16:0.00057%]
[INFO] ** s_port:[1.45442:25.94886%,-0.32151:21.088%,-1.27613:18.13002%,-0.23351:17.45796%,-0.33484:17.37364%,-1.02014:0.00057%,-1.27347:0.00019%,1.45709:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.94848%,1:21.08781%,5:18.12983%,4:17.45796%,2:17.37345%,0:0.00248%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.46164%,9:25.94924%,7:18.1304%,1:17.45815%,15:0.00057%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1423 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0603 - tp: 76755.0000 - fp: 3245.0000 - tn: 316755.0000 - fn: 3245.0000 - accuracy: 0.9838 - precision: 0.9594 - recall: 0.9594 - auc: 0.9991 - val_loss: 2.4578e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0598 - tp: 76661.0000 - fp: 3339.0000 - tn: 316661.0000 - fn: 3339.0000 - accuracy: 0.9833 - precision: 0.9583 - recall: 0.9583 - auc: 0.9991 - val_loss: 2.2619e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0594 - tp: 76710.0000 - fp: 3290.0000 - tn: 316710.0000 - fn: 3290.0000 - accuracy: 0.9836 - precision: 0.9589 - recall: 0.9589 - auc: 0.9991 - val_loss: 2.0979e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0574 - tp: 76913.0000 - fp: 3087.0000 - tn: 316913.0000 - fn: 3087.0000 - accuracy: 0.9846 - precision: 0.9614 - recall: 0.9614 - auc: 0.9992 - val_loss: 1.8591e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0590 - tp: 76712.0000 - fp: 3288.0000 - tn: 316712.0000 - fn: 3288.0000 - accuracy: 0.9836 - precision: 0.9589 - recall: 0.9589 - auc: 0.9991 - val_loss: 1.5544e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 40-40/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:99.99618%,30:0.00324%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.33782%,Single Stage Single Point:35.66218%]
[INFO] ** dst:[21:43.29541%,10:21.03726%,8:18.19087%,9:17.4715%,15:0.00324%,22:0.00095%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99695%,0:0.00305%]
[INFO] ** i/f_name:[2:99.99676%,3:0.00324%]
[INFO] ** modbus_function_code:[0.02961:99.99618%,-33.760870000000004:0.00382%]
[INFO] ** modbus_function_description:[7:49.99924%,11:49.99695%,0:0.00382%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99618%,1:0.00324%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.35271%,20:25.98091%,13:18.19068%,6:17.47188%,17:0.00324%,14:0.00057%]
[INFO] ** s_port:[1.45442:25.97995%,-0.32151:21.03726%,-1.27613:18.19049%,-0.23351:17.47131%,-0.33484:17.31545%,-71.33197:0.00324%,1.45709:0.00057%,-0.24151:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,13.431270000000001:0.00019%]
[INFO] ** scada_tag:[3:25.97957%,1:21.03707%,5:18.1903%,4:17.47093%,2:17.31526%,0:0.00687%]
[INFO] ** service:[0.0048200000000000005:99.99618%,-211.73542999999998:0.00324%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.35271%,9:25.98091%,7:18.19068%,1:17.47188%,14:0.00324%,2:0.00057%]
[INFO] ** type:[0:99.99905%,1:0.00095%]
[INFO] ** unixtime:1426 (0.27203%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0593 - tp: 76738.0000 - fp: 3262.0000 - tn: 316738.0000 - fn: 3262.0000 - accuracy: 0.9837 - precision: 0.9592 - recall: 0.9592 - auc: 0.9991 - val_loss: 1.5095e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0587 - tp: 76741.0000 - fp: 3259.0000 - tn: 316741.0000 - fn: 3259.0000 - accuracy: 0.9837 - precision: 0.9593 - recall: 0.9593 - auc: 0.9991 - val_loss: 1.4478e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0589 - tp: 76805.0000 - fp: 3195.0000 - tn: 316805.0000 - fn: 3195.0000 - accuracy: 0.9840 - precision: 0.9601 - recall: 0.9601 - auc: 0.9991 - val_loss: 1.4930e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0594 - tp: 76728.0000 - fp: 3272.0000 - tn: 316728.0000 - fn: 3272.0000 - accuracy: 0.9836 - precision: 0.9591 - recall: 0.9591 - auc: 0.9991 - val_loss: 1.3618e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0590 - tp: 76746.0000 - fp: 3254.0000 - tn: 316746.0000 - fn: 3254.0000 - accuracy: 0.9837 - precision: 0.9593 - recall: 0.9593 - auc: 0.9991 - val_loss: 1.3616e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 41-41/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (464366, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (464366, 17)

[INFO] analyzing data
[INFO] 464366 rows
[INFO] ** appi_name:[21:99.99634%,30:0.00108%,22:0.00086%,17:0.00086%,32:0.00022%,28:0.00022%,26:0.00022%,7:0.00022%]
[INFO] ** classification:[normal:64.39231%,Single Stage Single Point:35.60769%]
[INFO] ** dst:[21:43.32208%,10:21.06571%,8:18.13699%,9:17.47049%,16:0.00108%,15:0.00108%,6:0.00108%,22:0.00065%,24:0.00043%,17:0.00043%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99634%,-33.760870000000004:0.00366%]
[INFO] ** modbus_function_description:[7:49.99892%,11:49.99742%,0:0.00366%]
[INFO] ** modbus_transaction_id:65536 (14.11301%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99763%,2:0.00129%,1:0.00108%]
[INFO] ** proxy_src_ip:[18:38.43994%,20:25.94807%,13:18.1372%,6:17.4707%,17:0.00108%,1:0.00086%,21:0.00043%,16:0.00043%,14:0.00043%,0:0.00043%,7:0.00022%,2:0.00022%]
[INFO] ** s_port:[1.45442:25.94764%,-0.32151:21.06571%,-1.27613:18.13656%,-0.23351:17.47027%,-0.33484:17.37423%,-71.33197:0.00108%,-71.14931:0.00086%,-1.02014:0.00043%,-1.27347:0.00043%,-71.14798:0.00022%,-0.24151:0.00022%,-58.035180000000004:0.00022%,-1.2708:0.00022%,-5.1466400000000005:0.00022%,1.47576:0.00022%,1.46509:0.00022%,-64.19226:0.00022%,-5.08665:0.00022%,-0.24950999999999998:0.00022%,2.05573:0.00022%,-43.76509:0.00022%,-58.032509999999995:0.00022%]
[INFO] ** scada_tag:[3:25.94742%,1:21.06571%,5:18.13656%,4:17.47006%,2:17.37423%,0:0.00603%]
[INFO] ** service:[0.0048200000000000005:99.99634%,-211.73542999999998:0.00108%,-205.44247:0.00086%,-211.08818:0.00086%,89.64175:0.00022%,-211.09762999999998:0.00022%,-211.08346:0.00022%,-185.9872:0.00022%]
[INFO] ** src:[22:38.43994%,9:25.94807%,7:18.1372%,1:17.4707%,14:0.00108%,3:0.00086%,15:0.00043%,8:0.00043%,4:0.00043%,2:0.00043%,21:0.00022%,17:0.00022%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1260 (0.27134%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/464366
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0579 - tp: 76829.0000 - fp: 3171.0000 - tn: 316829.0000 - fn: 3171.0000 - accuracy: 0.9841 - precision: 0.9604 - recall: 0.9604 - auc: 0.9992 - val_loss: 7.5544e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/464366
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0582 - tp: 76838.0000 - fp: 3162.0000 - tn: 316838.0000 - fn: 3162.0000 - accuracy: 0.9842 - precision: 0.9605 - recall: 0.9605 - auc: 0.9992 - val_loss: 1.3034e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/464366
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0588 - tp: 76746.0000 - fp: 3254.0000 - tn: 316746.0000 - fn: 3254.0000 - accuracy: 0.9837 - precision: 0.9593 - recall: 0.9593 - auc: 0.9991 - val_loss: 1.2760e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/464366
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0584 - tp: 76815.0000 - fp: 3185.0000 - tn: 316815.0000 - fn: 3185.0000 - accuracy: 0.9841 - precision: 0.9602 - recall: 0.9602 - auc: 0.9992 - val_loss: 1.2780e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/464366
[33m[INFO] loading file 42-42/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (407880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (407880, 17)

[INFO] analyzing data
[INFO] 407880 rows
[INFO] ** appi_name:[21:99.99166%,30:0.00221%,17:0.00123%,31:0.00098%,26:0.00098%,7:0.00098%,22:0.00074%,28:0.00025%,27:0.00025%,9:0.00025%,8:0.00025%,0:0.00025%]
[INFO] ** classification:[normal:64.37947%,Single Stage Single Point:35.62053%]
[INFO] ** dst:[21:43.31691%,10:21.05374%,8:18.17741%,9:17.44263%,16:0.00221%,6:0.00196%,18:0.00123%,2:0.00098%,22:0.00074%,15:0.00074%,17:0.00049%,25:0.00025%,24:0.00025%,7:0.00025%,0:0.00025%]
[INFO] ** i/f_dir:[1:99.99926%,0:0.00074%]
[INFO] ** i/f_name:[2:99.99926%,3:0.00074%]
[INFO] ** modbus_function_code:[0.02961:99.99166%,-33.760870000000004:0.00834%]
[INFO] ** modbus_function_description:[7:49.99657%,11:49.9951%,0:0.00834%]
[INFO] ** modbus_transaction_id:65536 (16.06747%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99559%,2:0.00368%,1:0.00074%]
[INFO] ** proxy_src_ip:[18:38.4135%,20:25.95739%,13:18.1779%,6:17.44263%,17:0.00221%,1:0.00221%,14:0.00147%,21:0.00098%,7:0.00074%,0:0.00049%,16:0.00025%,2:0.00025%]
[INFO] ** s_port:[1.45442:25.9569%,-0.32151:21.05374%,-1.27613:18.17741%,-0.23351:17.44239%,-0.33484:17.35976%,-71.14931:0.00098%,-71.14798:0.00098%,-71.33197:0.00074%,11.57001:0.00049%,-0.08551:0.00049%,-3.3787199999999995:0.00049%,-0.24151:0.00025%,13.431270000000001:0.00025%,-5.1466400000000005:0.00025%,0.31847:0.00025%,-1.02014:0.00025%,-1.2708:0.00025%,-58.035180000000004:0.00025%,7.66617:0.00025%,-64.19493:0.00025%,1.47576:0.00025%,14.4699:0.00025%,15.912510000000001:0.00025%,14.191239999999999:0.00025%,7.9608300000000005:0.00025%,-5.08665:0.00025%,10.192739999999999:0.00025%,-3.0613900000000003:0.00025%,1.45709:0.00025%,2.05573:0.00025%,-43.76509:0.00025%,11.862:0.00025%,-1.27347:0.00025%,-58.032509999999995:0.00025%]
[INFO] ** scada_tag:[3:25.95641%,1:21.05374%,5:18.17716%,4:17.44239%,2:17.35952%,0:0.01079%]
[INFO] ** service:[0.0048200000000000005:99.99166%,-211.09762999999998:0.00172%,-205.44247:0.00123%,-186.43601999999998:0.00123%,-211.08346:0.00098%,-211.08818:0.00098%,-211.73542999999998:0.00074%,-211.35747999999998:0.00049%,-186.44547:0.00025%,-183.8612:0.00025%,-185.9872:0.00025%,-202.75898:0.00025%]
[INFO] ** src:[22:38.4135%,9:25.95739%,7:18.1779%,1:17.44263%,3:0.00294%,2:0.00172%,4:0.00123%,21:0.00098%,14:0.00074%,8:0.00049%,17:0.00025%,15:0.00025%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1107 (0.2714%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/407880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0591 - tp: 76713.0000 - fp: 3287.0000 - tn: 316713.0000 - fn: 3287.0000 - accuracy: 0.9836 - precision: 0.9589 - recall: 0.9589 - auc: 0.9991 - val_loss: 1.2833e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/407880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0586 - tp: 76738.0000 - fp: 3262.0000 - tn: 316738.0000 - fn: 3262.0000 - accuracy: 0.9837 - precision: 0.9592 - recall: 0.9592 - auc: 0.9991 - val_loss: 1.2769e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/407880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0599 - tp: 76705.0000 - fp: 3295.0000 - tn: 316705.0000 - fn: 3295.0000 - accuracy: 0.9835 - precision: 0.9588 - recall: 0.9588 - auc: 0.9991 - val_loss: 1.2724e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/407880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0593 - tp: 76761.0000 - fp: 3239.0000 - tn: 316761.0000 - fn: 3239.0000 - accuracy: 0.9838 - precision: 0.9595 - recall: 0.9595 - auc: 0.9991 - val_loss: 1.2751e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-41-42-batch-300000-400000
[INFO] processing batch 400000-500000/407880
[33m[INFO] loading file 43-43/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99921%,30:0.00059%,26:0.0002%]
[INFO] ** classification:[normal:64.40124%,Single Stage Single Point:35.59876%]
[INFO] ** dst:[21:43.3313%,10:21.06817%,8:18.12653%,9:17.47204%,22:0.00098%,15:0.00059%,24:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name:[2:99.99941%,3:0.00059%]
[INFO] ** modbus_function_code:[0.02961:99.99921%,-33.760870000000004:0.00079%]
[INFO] ** modbus_function_description:[7:50.0002%,11:49.99902%,0:0.00079%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99921%,1:0.00059%,2:0.0002%]
[INFO] ** proxy_src_ip:[18:38.42227%,20:25.97759%,13:18.12672%,6:17.47224%,17:0.00059%,16:0.00039%,1:0.0002%]
[INFO] ** s_port:[1.45442:25.977%,-0.32151:21.06817%,-1.27613:18.12633%,-0.23351:17.47184%,-0.33484:17.3541%,-71.33197:0.00059%,1.45709:0.00039%,-1.02014:0.00039%,-71.14798:0.0002%,-1.27347:0.0002%,-0.24950999999999998:0.0002%,1.47576:0.0002%,-0.24151:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.97661%,1:21.06817%,5:18.12613%,4:17.47145%,2:17.3539%,0:0.00374%]
[INFO] ** service:[0.0048200000000000005:99.99921%,-211.73542999999998:0.00059%,-211.08346:0.0002%]
[INFO] ** src:[22:38.42227%,9:25.97759%,7:18.12672%,1:17.47224%,14:0.00059%,15:0.00039%,3:0.0002%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1381 (0.27191%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0622 - tp: 76765.0000 - fp: 3235.0000 - tn: 316765.0000 - fn: 3235.0000 - accuracy: 0.9838 - precision: 0.9596 - recall: 0.9596 - auc: 0.9990 - val_loss: 1.2769e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0585 - tp: 76841.0000 - fp: 3159.0000 - tn: 316841.0000 - fn: 3159.0000 - accuracy: 0.9842 - precision: 0.9605 - recall: 0.9605 - auc: 0.9991 - val_loss: 1.2766e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0577 - tp: 76866.0000 - fp: 3134.0000 - tn: 316866.0000 - fn: 3134.0000 - accuracy: 0.9843 - precision: 0.9608 - recall: 0.9608 - auc: 0.9992 - val_loss: 1.2740e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0595 - tp: 76746.0000 - fp: 3254.0000 - tn: 316746.0000 - fn: 3254.0000 - accuracy: 0.9837 - precision: 0.9593 - recall: 0.9593 - auc: 0.9991 - val_loss: 1.2749e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0587 - tp: 76751.0000 - fp: 3249.0000 - tn: 316751.0000 - fn: 3249.0000 - accuracy: 0.9838 - precision: 0.9594 - recall: 0.9594 - auc: 0.9991 - val_loss: 1.2557e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 44-44/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99803%,30:0.00079%,31:0.00059%,0:0.00039%,22:0.0002%]
[INFO] ** classification:[normal:64.36501%,Single Stage Single Point:35.63499%]
[INFO] ** dst:[21:43.32185%,10:21.04001%,8:18.16965%,9:17.46515%,22:0.00098%,15:0.00079%,18:0.00059%,25:0.00039%,24:0.00039%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99921%,0:0.00079%]
[INFO] ** i/f_name:[2:99.99921%,3:0.00079%]
[INFO] ** modbus_function_code:[0.02961:99.99803%,-33.760870000000004:0.00197%]
[INFO] ** modbus_function_description:[7:50.0002%,11:49.99783%,0:0.00197%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99803%,2:0.00118%,1:0.00079%]
[INFO] ** proxy_src_ip:[18:38.40947%,20:25.95278%,13:18.16984%,6:17.46574%,17:0.00079%,7:0.00039%,16:0.0002%,5:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.95219%,-0.32151:21.04001%,-1.27613:18.16925%,-0.23351:17.46495%,-0.33484:17.36946%,-71.33197:0.00079%,-0.24151:0.00059%,-64.19493:0.00039%,-0.08551:0.00039%,-1.27347:0.00039%,1.46509:0.0002%,1.47576:0.0002%,-0.24950999999999998:0.0002%,1.45709:0.0002%,4.42897:0.0002%,-71.14931:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.9518%,1:21.04001%,5:18.16925%,4:17.46456%,2:17.36926%,0:0.00512%]
[INFO] ** service:[0.0048200000000000005:99.99803%,-211.73542999999998:0.00079%,-186.43601999999998:0.00059%,-186.44547:0.00039%,-211.08818:0.0002%]
[INFO] ** src:[22:38.40947%,9:25.95278%,7:18.16984%,1:17.46574%,14:0.00079%,21:0.00039%,17:0.0002%,16:0.0002%,15:0.0002%,8:0.0002%,3:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1378 (0.27132%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0587 - tp: 76790.0000 - fp: 3210.0000 - tn: 316790.0000 - fn: 3210.0000 - accuracy: 0.9840 - precision: 0.9599 - recall: 0.9599 - auc: 0.9991 - val_loss: 1.2629e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0574 - tp: 76872.0000 - fp: 3128.0000 - tn: 316872.0000 - fn: 3128.0000 - accuracy: 0.9844 - precision: 0.9609 - recall: 0.9609 - auc: 0.9992 - val_loss: 1.2568e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0595 - tp: 76782.0000 - fp: 3218.0000 - tn: 316782.0000 - fn: 3218.0000 - accuracy: 0.9839 - precision: 0.9598 - recall: 0.9598 - auc: 0.9991 - val_loss: 1.2335e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0593 - tp: 76795.0000 - fp: 3205.0000 - tn: 316795.0000 - fn: 3205.0000 - accuracy: 0.9840 - precision: 0.9599 - recall: 0.9599 - auc: 0.9991 - val_loss: 1.2371e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0576 - tp: 76858.0000 - fp: 3142.0000 - tn: 316858.0000 - fn: 3142.0000 - accuracy: 0.9843 - precision: 0.9607 - recall: 0.9607 - auc: 0.9992 - val_loss: 8.0603e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 45-45/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99902%,30:0.00059%,26:0.0002%,9:0.0002%]
[INFO] ** classification:[normal:64.41797%,Single Stage Single Point:35.58203%]
[INFO] ** dst:[21:43.32441%,10:21.0914%,8:18.12003%,9:17.462%,22:0.00118%,15:0.00059%,6:0.0002%,0:0.0002%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99941%,3:0.00059%]
[INFO] ** modbus_function_code:[0.02961:99.99902%,-33.760870000000004:0.00098%]
[INFO] ** modbus_function_description:[7:50.00039%,11:49.99862%,0:0.00098%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99921%,1:0.00059%,2:0.0002%]
[INFO] ** proxy_src_ip:[18:38.48527%,20:25.93113%,13:18.12003%,6:17.4622%,17:0.00059%,16:0.00039%,21:0.0002%,1:0.0002%]
[INFO] ** s_port:[1.45442:25.93053%,-0.32151:21.0914%,-1.27613:18.12003%,-0.23351:17.462%,-0.33484:17.39387%,1.45709:0.00059%,-71.33197:0.00059%,-1.02014:0.00039%,-71.14798:0.0002%,14.4699:0.0002%,-0.24151:0.0002%]
[INFO] ** scada_tag:[3:25.93014%,1:21.0912%,5:18.12003%,4:17.462%,2:17.39368%,0:0.00295%]
[INFO] ** service:[0.0048200000000000005:99.99902%,-211.73542999999998:0.00059%,-183.8612:0.0002%,-211.08346:0.0002%]
[INFO] ** src:[22:38.48527%,9:25.93113%,7:18.12003%,1:17.4622%,14:0.00059%,15:0.00039%,4:0.0002%,3:0.0002%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** unixtime:1379 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0581 - tp: 76820.0000 - fp: 3180.0000 - tn: 316820.0000 - fn: 3180.0000 - accuracy: 0.9841 - precision: 0.9603 - recall: 0.9603 - auc: 0.9992 - val_loss: 1.2361e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0593 - tp: 76728.0000 - fp: 3272.0000 - tn: 316728.0000 - fn: 3272.0000 - accuracy: 0.9836 - precision: 0.9591 - recall: 0.9591 - auc: 0.9991 - val_loss: 1.2351e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0597 - tp: 76743.0000 - fp: 3257.0000 - tn: 316743.0000 - fn: 3257.0000 - accuracy: 0.9837 - precision: 0.9593 - recall: 0.9593 - auc: 0.9991 - val_loss: 1.2348e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0586 - tp: 76795.0000 - fp: 3205.0000 - tn: 316795.0000 - fn: 3205.0000 - accuracy: 0.9840 - precision: 0.9599 - recall: 0.9599 - auc: 0.9991 - val_loss: 1.2375e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0577 - tp: 76908.0000 - fp: 3092.0000 - tn: 316908.0000 - fn: 3092.0000 - accuracy: 0.9845 - precision: 0.9614 - recall: 0.9614 - auc: 0.9992 - val_loss: 1.2134e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 46-46/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99823%,30:0.00098%,26:0.0002%,17:0.0002%,12:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:64.42093%,Single Stage Single Point:35.57907%]
[INFO] ** dst:[21:43.35%,10:21.06836%,8:18.10979%,9:17.46928%,22:0.00098%,15:0.00098%,25:0.0002%,16:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99902%,0:0.00098%]
[INFO] ** i/f_name:[2:99.99902%,3:0.00098%]
[INFO] ** modbus_function_code:[0.02961:99.99823%,-33.760870000000004:0.00177%]
[INFO] ** modbus_function_description:[11:49.99921%,7:49.99902%,0:0.00177%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.99862%,1:0.00098%,2:0.00039%]
[INFO] ** proxy_src_ip:[18:38.44097%,20:25.9772%,13:18.10979%,6:17.46987%,17:0.00098%,16:0.00039%,7:0.00039%,5:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.977%,-0.32151:21.06817%,-1.27613:18.10959%,-0.23351:17.46909%,-0.33484:17.3728%,-71.33197:0.00098%,-0.24151:0.00059%,-1.02014:0.00039%,-71.14798:0.0002%,-0.24950999999999998:0.0002%,10.192739999999999:0.0002%,1.47576:0.0002%,-61.95768:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.97681%,1:21.06797%,5:18.1094%,4:17.46869%,2:17.3728%,0:0.00433%]
[INFO] ** service:[0.0048200000000000005:99.99842%,-211.73542999999998:0.00098%,-186.44547:0.0002%,-211.08346:0.0002%,-205.44247:0.0002%]
[INFO] ** src:[22:38.44097%,9:25.9772%,7:18.10979%,1:17.46987%,14:0.00098%,21:0.00039%,15:0.00039%,16:0.0002%,8:0.0002%]
[INFO] ** type:[0:99.99921%,1:0.00079%]
[INFO] ** unixtime:1381 (0.27191%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0592 - tp: 76736.0000 - fp: 3264.0000 - tn: 316736.0000 - fn: 3264.0000 - accuracy: 0.9837 - precision: 0.9592 - recall: 0.9592 - auc: 0.9991 - val_loss: 1.2135e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0588 - tp: 76815.0000 - fp: 3185.0000 - tn: 316815.0000 - fn: 3185.0000 - accuracy: 0.9841 - precision: 0.9602 - recall: 0.9602 - auc: 0.9991 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0583 - tp: 76833.0000 - fp: 3167.0000 - tn: 316833.0000 - fn: 3167.0000 - accuracy: 0.9842 - precision: 0.9604 - recall: 0.9604 - auc: 0.9992 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0588 - tp: 76720.0000 - fp: 3280.0000 - tn: 316720.0000 - fn: 3280.0000 - accuracy: 0.9836 - precision: 0.9590 - recall: 0.9590 - auc: 0.9991 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0588 - tp: 76820.0000 - fp: 3180.0000 - tn: 316820.0000 - fn: 3180.0000 - accuracy: 0.9841 - precision: 0.9603 - recall: 0.9603 - auc: 0.9992 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 47-47/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.9998%,33:0.0002%]
[INFO] ** classification:[normal:64.39257%,Single Stage Single Point:35.60743%]
[INFO] ** dst:[21:43.30058%,10:21.09022%,8:18.12849%,9:17.47854%,22:0.00177%,24:0.00039%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.9998%,-33.760870000000004:0.0002%]
[INFO] ** modbus_function_description:[7:50.00138%,11:49.99842%,0:0.0002%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.46086%,20:25.93073%,13:18.12889%,6:17.47893%,16:0.00039%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.92975%,-0.32151:21.09022%,-1.27613:18.1283%,-0.23351:17.47834%,-0.33484:17.37064%,1.45709:0.00059%,-0.24151:0.00059%,-1.27347:0.00039%,-1.02014:0.00039%,-61.95635:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.92916%,1:21.09002%,5:18.1281%,4:17.47814%,2:17.37044%,0:0.00413%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.46086%,9:25.93073%,7:18.12889%,1:17.47893%,15:0.00039%,8:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1379 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0589 - tp: 76775.0000 - fp: 3225.0000 - tn: 316775.0000 - fn: 3225.0000 - accuracy: 0.9839 - precision: 0.9597 - recall: 0.9597 - auc: 0.9991 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0585 - tp: 76779.0000 - fp: 3221.0000 - tn: 316779.0000 - fn: 3221.0000 - accuracy: 0.9839 - precision: 0.9597 - recall: 0.9597 - auc: 0.9991 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0573 - tp: 76791.0000 - fp: 3209.0000 - tn: 316791.0000 - fn: 3209.0000 - accuracy: 0.9840 - precision: 0.9599 - recall: 0.9599 - auc: 0.9992 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0595 - tp: 76765.0000 - fp: 3235.0000 - tn: 316765.0000 - fn: 3235.0000 - accuracy: 0.9838 - precision: 0.9596 - recall: 0.9596 - auc: 0.9991 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0596 - tp: 76660.0000 - fp: 3340.0000 - tn: 316660.0000 - fn: 3340.0000 - accuracy: 0.9833 - precision: 0.9582 - recall: 0.9582 - auc: 0.9991 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 48-48/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99665%,30:0.00276%,31:0.0002%,27:0.0002%,26:0.0002%]
[INFO] ** classification:[normal:64.41719%,Single Stage Single Point:35.58281%]
[INFO] ** dst:[21:43.33169%,10:21.08155%,8:18.11432%,9:17.4681%,15:0.00276%,22:0.00079%,24:0.0002%,18:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99764%,0:0.00236%]
[INFO] ** i/f_name:[2:99.99724%,3:0.00276%]
[INFO] ** modbus_function_code:[0.02961:99.99665%,-33.760870000000004:0.00335%]
[INFO] ** modbus_function_description:[7:49.99921%,11:49.99744%,0:0.00335%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99665%,1:0.00276%,2:0.00059%]
[INFO] ** proxy_src_ip:[18:38.45515%,20:25.9583%,13:18.11471%,6:17.4681%,17:0.00276%,14:0.00059%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.9579%,-0.32151:21.08155%,-1.27613:18.11432%,-0.23351:17.46791%,-0.33484:17.37359%,-71.33197:0.00276%,-1.02014:0.00039%,-71.14798:0.0002%,-1.27347:0.0002%,11.862:0.0002%,1.45709:0.0002%,1.47576:0.0002%,-0.24151:0.0002%,13.431270000000001:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.95751%,1:21.08155%,5:18.11432%,4:17.46791%,2:17.3734%,0:0.00532%]
[INFO] ** service:[0.0048200000000000005:99.99665%,-211.73542999999998:0.00276%,-211.08346:0.0002%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.45515%,9:25.9583%,7:18.11471%,1:17.4681%,14:0.00276%,2:0.00059%,15:0.00039%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1378 (0.27132%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0573 - tp: 76853.0000 - fp: 3147.0000 - tn: 316853.0000 - fn: 3147.0000 - accuracy: 0.9843 - precision: 0.9607 - recall: 0.9607 - auc: 0.9992 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0600 - tp: 76709.0000 - fp: 3291.0000 - tn: 316709.0000 - fn: 3291.0000 - accuracy: 0.9835 - precision: 0.9589 - recall: 0.9589 - auc: 0.9991 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0586 - tp: 76722.0000 - fp: 3278.0000 - tn: 316722.0000 - fn: 3278.0000 - accuracy: 0.9836 - precision: 0.9590 - recall: 0.9590 - auc: 0.9991 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0588 - tp: 76759.0000 - fp: 3241.0000 - tn: 316759.0000 - fn: 3241.0000 - accuracy: 0.9838 - precision: 0.9595 - recall: 0.9595 - auc: 0.9991 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0583 - tp: 76850.0000 - fp: 3150.0000 - tn: 316850.0000 - fn: 3150.0000 - accuracy: 0.9843 - precision: 0.9606 - recall: 0.9606 - auc: 0.9992 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 49-49/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99724%,30:0.00098%,17:0.00079%,22:0.00039%,28:0.0002%,26:0.0002%,7:0.0002%]
[INFO] ** classification:[normal:64.37151%,Single Stage Single Point:35.62849%]
[INFO] ** dst:[21:43.29901%,10:21.06797%,8:18.14149%,9:17.4872%,22:0.00138%,15:0.00098%,16:0.00079%,6:0.00059%,17:0.00039%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.99902%,0:0.00098%]
[INFO] ** i/f_name:[2:99.99902%,3:0.00098%]
[INFO] ** modbus_function_code:[0.02961:99.99724%,-33.760870000000004:0.00276%]
[INFO] ** modbus_function_description:[7:49.99941%,11:49.99783%,0:0.00276%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99842%,1:0.00098%,2:0.00059%]
[INFO] ** proxy_src_ip:[18:38.42798%,20:25.93979%,13:18.14129%,6:17.48779%,17:0.00098%,1:0.00079%,21:0.00039%,16:0.00039%,14:0.00039%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.939%,-0.32151:21.06797%,-1.27613:18.1411%,-0.23351:17.487%,-0.33484:17.36001%,-71.33197:0.00098%,-0.24151:0.00059%,1.45709:0.00039%,-1.02014:0.00039%,-71.14931:0.00039%,-71.14798:0.0002%,-58.035180000000004:0.0002%,-5.1466400000000005:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,-5.08665:0.0002%,-0.24950999999999998:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:25.93861%,1:21.06777%,5:18.1409%,4:17.48661%,2:17.36001%,0:0.0061%]
[INFO] ** service:[0.0048200000000000005:99.99724%,-211.73542999999998:0.00098%,-205.44247:0.00079%,-211.08818:0.00039%,-211.09762999999998:0.0002%,-211.08346:0.0002%,-185.9872:0.0002%]
[INFO] ** src:[22:38.42798%,9:25.93979%,7:18.14129%,1:17.48779%,14:0.00098%,3:0.00079%,15:0.00039%,4:0.00039%,2:0.00039%,8:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1379 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0603 - tp: 76725.0000 - fp: 3275.0000 - tn: 316725.0000 - fn: 3275.0000 - accuracy: 0.9836 - precision: 0.9591 - recall: 0.9591 - auc: 0.9991 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0589 - tp: 76771.0000 - fp: 3229.0000 - tn: 316771.0000 - fn: 3229.0000 - accuracy: 0.9839 - precision: 0.9596 - recall: 0.9596 - auc: 0.9991 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0597 - tp: 76678.0000 - fp: 3322.0000 - tn: 316678.0000 - fn: 3322.0000 - accuracy: 0.9834 - precision: 0.9585 - recall: 0.9585 - auc: 0.9991 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0589 - tp: 76715.0000 - fp: 3285.0000 - tn: 316715.0000 - fn: 3285.0000 - accuracy: 0.9836 - precision: 0.9589 - recall: 0.9589 - auc: 0.9991 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0579 - tp: 76824.0000 - fp: 3176.0000 - tn: 316824.0000 - fn: 3176.0000 - accuracy: 0.9841 - precision: 0.9603 - recall: 0.9603 - auc: 0.9992 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 50-50/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (357862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (357862, 17)

[INFO] analyzing data
[INFO] 357862 rows
[INFO] ** appi_name:[21:99.99749%,30:0.00084%,7:0.00084%,31:0.00028%,22:0.00028%,8:0.00028%]
[INFO] ** classification:[normal:64.2949%,Single Stage Single Point:35.7051%]
[INFO] ** dst:[21:43.25019%,10:21.04163%,8:18.2263%,9:17.47853%,15:0.00084%,22:0.00056%,16:0.00056%,2:0.00056%,24:0.00028%,18:0.00028%,6:0.00028%]
[INFO] ** i/f_dir:[1:99.99916%,0:0.00084%]
[INFO] ** i/f_name:[2:99.99916%,3:0.00084%]
[INFO] ** modbus_function_code:[0.02961:99.99749%,-33.760870000000004:0.00251%]
[INFO] ** modbus_function_description:[7:49.99916%,11:49.99832%,0:0.00251%]
[INFO] ** modbus_transaction_id:65535 (18.31293%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9986%,1:0.00084%,2:0.00056%]
[INFO] ** proxy_src_ip:[18:38.36339%,20:25.92871%,13:18.22658%,6:17.47853%,17:0.00084%,1:0.00084%,21:0.00028%,16:0.00028%,14:0.00028%,7:0.00028%]
[INFO] ** s_port:[1.45442:25.92815%,-0.32151:21.04163%,-1.27613:18.22602%,-0.23351:17.47853%,-0.33484:17.32176%,-71.33197:0.00084%,-3.3787199999999995:0.00028%,4.33564:0.00028%,15.912510000000001:0.00028%,7.9608300000000005:0.00028%,1.46509:0.00028%,1.45709:0.00028%,-1.27347:0.00028%,-71.14931:0.00028%,-1.02014:0.00028%,-1.2708:0.00028%,0.31847:0.00028%]
[INFO] ** scada_tag:[3:25.92787%,1:21.04135%,5:18.22574%,4:17.47853%,2:17.32148%,0:0.00503%]
[INFO] ** service:[0.0048200000000000005:99.99749%,-211.09762999999998:0.00084%,-211.73542999999998:0.00084%,-186.43601999999998:0.00028%,-211.35747999999998:0.00028%,-211.08818:0.00028%]
[INFO] ** src:[22:38.36339%,9:25.92871%,7:18.22658%,1:17.47853%,14:0.00084%,3:0.00084%,21:0.00028%,15:0.00028%,4:0.00028%,2:0.00028%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:973 (0.27189%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/357862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0592 - tp: 76782.0000 - fp: 3218.0000 - tn: 316782.0000 - fn: 3218.0000 - accuracy: 0.9839 - precision: 0.9598 - recall: 0.9598 - auc: 0.9991 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/357862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0579 - tp: 76772.0000 - fp: 3228.0000 - tn: 316772.0000 - fn: 3228.0000 - accuracy: 0.9839 - precision: 0.9596 - recall: 0.9596 - auc: 0.9991 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/357862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0591 - tp: 76838.0000 - fp: 3162.0000 - tn: 316838.0000 - fn: 3162.0000 - accuracy: 0.9842 - precision: 0.9605 - recall: 0.9605 - auc: 0.9991 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/357862
[33m[INFO] epoch 2/10[0m
[33m[INFO] loading file 1-1/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99355%,30:0.00108%,22:0.0009%,17:0.00072%,31:0.00054%,26:0.00054%,7:0.00054%,23:0.00036%,18:0.00036%,0:0.00036%,28:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:77.7375%,Single Stage Single Point:22.2625%]
[INFO] ** dst:[21:43.26823%,10:21.03423%,8:18.17026%,9:17.52028%,6:0.00143%,22:0.00108%,16:0.00108%,15:0.00108%,18:0.00054%,26:0.00036%,25:0.00036%,19:0.00036%,17:0.00036%,24:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99355%,-33.760870000000004:0.00627%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99767%,11:49.99588%,0:0.00627%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99641%,2:0.00251%,1:0.00108%]
[INFO] ** proxy_src_ip:[18:38.39605%,20:25.90605%,13:18.17044%,6:17.52064%,11:0.00125%,10:0.00125%,17:0.00108%,14:0.0009%,1:0.0009%,7:0.00054%,21:0.00036%,16:0.00036%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.90551%,-0.32151:21.03352%,-1.27613:18.17009%,-0.23351:17.5201%,-0.33484:17.36254%,-71.33197:0.00108%,-71.14931:0.0009%,-2.1481:0.00072%,-0.24151:0.00054%,-71.14798:0.00054%,-1.02014:0.00036%,-64.19493:0.00036%,-2.42942:0.00036%,4.44364:0.00036%,-43.76509:0.00018%,10.67005:0.00018%,4.29964:0.00018%,-5.08665:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,1.47576:0.00018%,1.46509:0.00018%,4.076980000000001:0.00018%,-58.032509999999995:0.00018%,-58.035180000000004:0.00018%,-1.2708:0.00018%,-1.27347:0.00018%,-5.1466400000000005:0.00018%,-68.79874000000001:0.00018%,14.253910000000001:0.00018%,1.45709:0.00018%]
[INFO] ** scada_tag:[3:25.90533%,1:21.03334%,5:18.16973%,4:17.51992%,2:17.36236%,0:0.00932%]
[INFO] ** service:[0.0048200000000000005:99.99426%,-211.73542999999998:0.00108%,-211.08818:0.0009%,-205.44247:0.00072%,-211.07873999999998:0.00072%,-211.09762999999998:0.00054%,-211.08346:0.00054%,-186.43601999999998:0.00054%,-186.44547:0.00036%,-185.9872:0.00018%,-202.75898:0.00018%]
[INFO] ** src:[22:38.39605%,9:25.90605%,7:18.17044%,1:17.52064%,11:0.00125%,10:0.00125%,14:0.00108%,3:0.0009%,2:0.0009%,21:0.00054%,15:0.00036%,4:0.00036%,8:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1514 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2681 - tp: 75497.0000 - fp: 4503.0000 - tn: 315497.0000 - fn: 4503.0000 - accuracy: 0.9775 - precision: 0.9437 - recall: 0.9437 - auc: 0.9889 - val_loss: 7.1786e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0402 - tp: 79727.0000 - fp: 273.0000 - tn: 319727.0000 - fn: 273.0000 - accuracy: 0.9986 - precision: 0.9966 - recall: 0.9966 - auc: 0.9990 - val_loss: 4.0329e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0171 - tp: 79892.0000 - fp: 108.0000 - tn: 319892.0000 - fn: 108.0000 - accuracy: 0.9995 - precision: 0.9987 - recall: 0.9987 - auc: 1.0000 - val_loss: 6.8262e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.6174 - tp: 59070.0000 - fp: 20930.0000 - tn: 299070.0000 - fn: 20930.0000 - accuracy: 0.8954 - precision: 0.7384 - recall: 0.7384 - auc: 0.8797 - val_loss: 0.7059 - val_tp: 10669.0000 - val_fp: 9331.0000 - val_tn: 70669.0000 - val_fn: 9331.0000 - val_accuracy: 0.8134 - val_precision: 0.5335 - val_recall: 0.5335 - val_auc: 0.9261
[INFO] saving weights to checkpoints/lstm-epoch-2-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4437 - tp: 56332.0000 - fp: 23668.0000 - tn: 296332.0000 - fn: 23668.0000 - accuracy: 0.8817 - precision: 0.7042 - recall: 0.7042 - auc: 0.9575 - val_loss: 0.3049 - val_tp: 16461.0000 - val_fp: 3539.0000 - val_tn: 76461.0000 - val_fn: 3539.0000 - val_accuracy: 0.9292 - val_precision: 0.8231 - val_recall: 0.8231 - val_auc: 0.9833
[INFO] saving weights to checkpoints/lstm-epoch-2-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 2-2/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99875%,7:0.00054%,30:0.00036%,31:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:70.74223%,Single Stage Single Point:29.25777%]
[INFO] ** dst:[21:43.30838%,10:21.03047%,8:18.14571%,9:17.51311%,22:0.0009%,16:0.00036%,15:0.00036%,2:0.00036%,24:0.00018%,18:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99964%,3:0.00036%]
[INFO] ** modbus_function_code:[0.02961:99.99875%,-33.760870000000004:0.00125%]
[INFO] ** modbus_function_description:[7:49.99982%,11:49.99892%,0:0.00125%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99946%,1:0.00036%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.38064%,20:25.95875%,13:18.14571%,6:17.51347%,1:0.00054%,17:0.00036%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.95803%,-0.32151:21.03047%,-1.27613:18.14535%,-0.23351:17.51293%,-0.33484:17.35017%,-0.24151:0.00036%,-71.33197:0.00036%,1.45709:0.00036%,1.47576:0.00018%,12.60597:0.00018%,10.67005:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,4.076980000000001:0.00018%,-3.3787199999999995:0.00018%,4.29964:0.00018%,-1.27347:0.00018%]
[INFO] ** scada_tag:[3:25.95767%,1:21.03047%,5:18.14535%,4:17.51257%,2:17.34999%,0:0.00394%]
[INFO] ** service:[0.0048200000000000005:99.99875%,-211.09762999999998:0.00054%,-211.73542999999998:0.00036%,-211.35747999999998:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.38064%,9:25.95875%,7:18.14571%,1:17.51347%,3:0.00054%,14:0.00036%,21:0.00018%,15:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1517 (0.27193%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3842 - tp: 64986.0000 - fp: 15013.0000 - tn: 304987.0000 - fn: 15014.0000 - accuracy: 0.9249 - precision: 0.8123 - recall: 0.8123 - auc: 0.9748 - val_loss: 0.1281 - val_tp: 19445.0000 - val_fp: 555.0000 - val_tn: 79445.0000 - val_fn: 555.0000 - val_accuracy: 0.9889 - val_precision: 0.9722 - val_recall: 0.9722 - val_auc: 0.9994
[INFO] saving weights to checkpoints/lstm-epoch-2-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2231 - tp: 73137.0000 - fp: 6863.0000 - tn: 313137.0000 - fn: 6863.0000 - accuracy: 0.9657 - precision: 0.9142 - recall: 0.9142 - auc: 0.9915 - val_loss: 1.2217 - val_tp: 12609.0000 - val_fp: 7391.0000 - val_tn: 72609.0000 - val_fn: 7391.0000 - val_accuracy: 0.8522 - val_precision: 0.6305 - val_recall: 0.6305 - val_auc: 0.9349
[INFO] saving weights to checkpoints/lstm-epoch-2-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1950 - tp: 67056.0000 - fp: 12944.0000 - tn: 307056.0000 - fn: 12944.0000 - accuracy: 0.9353 - precision: 0.8382 - recall: 0.8382 - auc: 0.9901 - val_loss: 9.1281e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5976 - tp: 53328.0000 - fp: 26671.0000 - tn: 293329.0000 - fn: 26672.0000 - accuracy: 0.8666 - precision: 0.6666 - recall: 0.6666 - auc: 0.9394 - val_loss: 0.4385 - val_tp: 13968.0000 - val_fp: 6031.0000 - val_tn: 73969.0000 - val_fn: 6032.0000 - val_accuracy: 0.8794 - val_precision: 0.6984 - val_recall: 0.6984 - val_auc: 0.9557
[INFO] saving weights to checkpoints/lstm-epoch-2-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3965 - tp: 61880.0000 - fp: 18120.0000 - tn: 301880.0000 - fn: 18120.0000 - accuracy: 0.9094 - precision: 0.7735 - recall: 0.7735 - auc: 0.9684 - val_loss: 0.7292 - val_tp: 10130.0000 - val_fp: 9870.0000 - val_tn: 70130.0000 - val_fn: 9870.0000 - val_accuracy: 0.8026 - val_precision: 0.5065 - val_recall: 0.5065 - val_auc: 0.9179
[INFO] saving weights to checkpoints/lstm-epoch-2-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 3-3/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99175%,30:0.00215%,22:0.00108%,31:0.0009%,26:0.0009%,17:0.0009%,7:0.00072%,27:0.00036%,0:0.00036%,28:0.00018%,23:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:88.08989%,Single Stage Single Point:11.91011%]
[INFO] ** dst:[21:43.31053%,10:21.08066%,8:18.1561%,9:17.44356%,6:0.00215%,15:0.00143%,18:0.00125%,16:0.00125%,22:0.0009%,2:0.00036%,7:0.00036%,25:0.00036%,17:0.00036%,12:0.00018%,24:0.00018%,19:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99857%,0:0.00143%]
[INFO] ** i/f_name:[2:99.99857%,3:0.00143%]
[INFO] ** modbus_function_code:[0.02961:99.99175%,-33.760870000000004:0.00807%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99641%,11:49.99534%,0:0.00807%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99892%,2:0.00108%]
[INFO] ** proto:[0:99.99426%,2:0.0043%,1:0.00143%]
[INFO] ** proxy_src_ip:[18:38.40502%,20:25.98653%,13:18.15628%,6:17.44392%,17:0.00215%,1:0.00143%,14:0.00125%,7:0.0009%,11:0.00072%,10:0.00072%,21:0.00054%,16:0.00018%,15:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98582%,-0.32151:21.08048%,-1.27613:18.15574%,-0.23351:17.44338%,-0.33484:17.32454%,-71.33197:0.00143%,-71.14931:0.00108%,-71.14798:0.00108%,-64.19493:0.00036%,-0.08551:0.00036%,1.45709:0.00036%,-0.24151:0.00036%,14.4699:0.00018%,4.29964:0.00018%,4.90362:0.00018%,10.192739999999999:0.00018%,-3.3787199999999995:0.00018%,13.86459:0.00018%,4.44364:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,-43.76509:0.00018%,-5.08665:0.00018%,-58.035180000000004:0.00018%,4.076980000000001:0.00018%,-58.032509999999995:0.00018%,-1.27347:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-5.1466400000000005:0.00018%,13.431270000000001:0.00018%,12.60597:0.00018%,1.47576:0.00018%,1.46509:0.00018%,14.253910000000001:0.00018%,-68.79874000000001:0.00018%,-0.24950999999999998:0.00018%,-2.1481:0.00018%,10.67005:0.00018%,-68.36943000000001:0.00018%]
[INFO] ** scada_tag:[3:25.98546%,1:21.0803%,5:18.15557%,4:17.4432%,2:17.32436%,0:0.01111%]
[INFO] ** service:[0.0048200000000000005:99.99193%,-211.73542999999998:0.00143%,-186.43601999999998:0.00125%,-211.08346:0.00108%,-211.08818:0.00108%,-205.44247:0.0009%,-211.09762999999998:0.00072%,-202.75898:0.00036%,-186.44547:0.00036%,-183.8612:0.00018%,-185.9872:0.00018%,-201.23771000000002:0.00018%,-211.35747999999998:0.00018%,-211.07873999999998:0.00018%]
[INFO] ** src:[22:38.40502%,9:25.98653%,7:18.15628%,1:17.44392%,21:0.00197%,3:0.00161%,2:0.00125%,11:0.00072%,10:0.00072%,4:0.00072%,14:0.00036%,8:0.00036%,17:0.00018%,15:0.00018%,13:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1515 (0.27157%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3372 - tp: 66926.0000 - fp: 13074.0000 - tn: 306926.0000 - fn: 13074.0000 - accuracy: 0.9346 - precision: 0.8366 - recall: 0.8366 - auc: 0.9821 - val_loss: 0.6603 - val_tp: 12952.0000 - val_fp: 7048.0000 - val_tn: 72952.0000 - val_fn: 7048.0000 - val_accuracy: 0.8590 - val_precision: 0.6476 - val_recall: 0.6476 - val_auc: 0.9419
[INFO] saving weights to checkpoints/lstm-epoch-2-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4054 - tp: 57563.0000 - fp: 22437.0000 - tn: 297563.0000 - fn: 22437.0000 - accuracy: 0.8878 - precision: 0.7195 - recall: 0.7195 - auc: 0.9611 - val_loss: 0.2366 - val_tp: 16959.0000 - val_fp: 3041.0000 - val_tn: 76959.0000 - val_fn: 3041.0000 - val_accuracy: 0.9392 - val_precision: 0.8479 - val_recall: 0.8479 - val_auc: 0.9904
[INFO] saving weights to checkpoints/lstm-epoch-2-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2494 - tp: 74949.0000 - fp: 5051.0000 - tn: 314949.0000 - fn: 5051.0000 - accuracy: 0.9747 - precision: 0.9369 - recall: 0.9369 - auc: 0.9916 - val_loss: 0.0395 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0540 - tp: 79980.0000 - fp: 20.0000 - tn: 319980.0000 - fn: 20.0000 - accuracy: 0.9999 - precision: 0.9998 - recall: 0.9998 - auc: 1.0000 - val_loss: 0.0015 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0314 - tp: 79995.0000 - fp: 5.0000 - tn: 319995.0000 - fn: 5.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 3.4283e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 4-4/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99767%,30:0.00125%,31:0.00036%,33:0.00018%,26:0.00018%,23:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:92.15218%,Single Stage Single Point:7.84782%]
[INFO] ** dst:[21:43.35086%,10:20.9464%,8:18.17636%,9:17.52297%,15:0.00125%,22:0.00108%,18:0.00036%,24:0.00018%,19:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99875%,3:0.00125%]
[INFO] ** modbus_function_code:[0.02961:99.99767%,-33.760870000000004:0.00233%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99803%,0:0.00233%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99892%,2:0.00108%]
[INFO] ** proto:[0:99.99821%,1:0.00125%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.25785%,20:26.03977%,13:18.17636%,6:17.52333%,17:0.00125%,21:0.00036%,16:0.00036%,14:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.03906%,-0.32151:20.94622%,-1.27613:18.176%,-0.23351:17.52279%,-0.33484:17.31163%,-71.33197:0.00125%,1.45709:0.00036%,-0.08551:0.00036%,-0.24151:0.00036%,-1.02014:0.00036%,-1.2708:0.00018%,14.4699:0.00018%,4.44364:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:26.03888%,1:20.94604%,5:18.176%,4:17.52243%,2:17.31145%,0:0.0052%]
[INFO] ** service:[0.0048200000000000005:99.99785%,-211.73542999999998:0.00125%,-186.43601999999998:0.00036%,-183.8612:0.00018%,-211.08346:0.00018%,-211.07873999999998:0.00018%]
[INFO] ** src:[22:38.25785%,9:26.03977%,7:18.17636%,1:17.52333%,21:0.00108%,15:0.00036%,4:0.00036%,17:0.00018%,14:0.00018%,8:0.00018%,3:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1525 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0296 - tp: 79952.0000 - fp: 48.0000 - tn: 319952.0000 - fn: 48.0000 - accuracy: 0.9998 - precision: 0.9994 - recall: 0.9994 - auc: 0.9998 - val_loss: 1.4524e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0216 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.3311e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0187 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0958e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0169 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1389e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.1969 - tp: 47761.0000 - fp: 32239.0000 - tn: 287761.0000 - fn: 32239.0000 - accuracy: 0.8388 - precision: 0.5970 - recall: 0.5970 - auc: 0.8864 - val_loss: 0.5564 - val_tp: 12886.0000 - val_fp: 7114.0000 - val_tn: 72886.0000 - val_fn: 7114.0000 - val_accuracy: 0.8577 - val_precision: 0.6443 - val_recall: 0.6443 - val_auc: 0.9417
[INFO] saving weights to checkpoints/lstm-epoch-2-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 5-5/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99641%,30:0.00251%,37:0.00018%,26:0.00018%,12:0.00018%,9:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:89.89983%,Single Stage Single Point:10.10017%]
[INFO] ** dst:[21:43.36556%,10:20.76929%,8:18.23641%,9:17.62443%,15:0.00251%,22:0.0009%,25:0.00018%,24:0.00018%,6:0.00018%,2:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99785%,0:0.00215%]
[INFO] ** i/f_name:[2:99.99749%,3:0.00251%]
[INFO] ** modbus_function_code:[0.02961:99.99641%,-33.760870000000004:0.00359%]
[INFO] ** modbus_function_description:[7:49.99875%,11:49.99767%,0:0.00359%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99803%,2:0.00197%]
[INFO] ** proto:[0:99.99713%,1:0.00251%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.00689%,20:26.12815%,13:18.23659%,6:17.62461%,17:0.00251%,1:0.00036%,21:0.00018%,16:0.00018%,7:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.12761%,-0.32151:20.76894%,-1.27613:18.23641%,-0.23351:17.62425%,-0.33484:17.23795%,-71.33197:0.00251%,-0.24151:0.00036%,1.45709:0.00036%,1.47576:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,2.22906:0.00018%,14.4699:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.12725%,1:20.76876%,5:18.23623%,4:17.62425%,2:17.23795%,0:0.00556%]
[INFO] ** service:[0.0048200000000000005:99.99677%,-211.73542999999998:0.00251%,-183.8612:0.00018%,-211.08346:0.00018%,-211.35747999999998:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.00689%,9:26.12815%,7:18.23659%,1:17.62461%,21:0.00215%,14:0.00054%,3:0.00036%,16:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1526 (0.27354%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1112 - tp: 79041.0000 - fp: 959.0000 - tn: 319041.0000 - fn: 959.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9995 - val_loss: 1.0651 - val_tp: 16070.0000 - val_fp: 3930.0000 - val_tn: 76070.0000 - val_fn: 3930.0000 - val_accuracy: 0.9214 - val_precision: 0.8035 - val_recall: 0.8035 - val_auc: 0.9001
[INFO] saving weights to checkpoints/lstm-epoch-2-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3838 - tp: 66182.0000 - fp: 13818.0000 - tn: 306182.0000 - fn: 13818.0000 - accuracy: 0.9309 - precision: 0.8273 - recall: 0.8273 - auc: 0.9778 - val_loss: 0.0350 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3473 - tp: 65300.0000 - fp: 14700.0000 - tn: 305300.0000 - fn: 14700.0000 - accuracy: 0.9265 - precision: 0.8163 - recall: 0.8163 - auc: 0.9792 - val_loss: 0.2395 - val_tp: 18338.0000 - val_fp: 1661.0000 - val_tn: 78339.0000 - val_fn: 1662.0000 - val_accuracy: 0.9668 - val_precision: 0.9169 - val_recall: 0.9169 - val_auc: 0.9945
[INFO] saving weights to checkpoints/lstm-epoch-2-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0624 - tp: 79692.0000 - fp: 308.0000 - tn: 319692.0000 - fn: 308.0000 - accuracy: 0.9985 - precision: 0.9962 - recall: 0.9962 - auc: 1.0000 - val_loss: 0.0058 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0274 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0024 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 6-6/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99588%,30:0.00323%,31:0.00018%,27:0.00018%,26:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:92.75717%,Single Stage Single Point:7.24283%]
[INFO] ** dst:[21:43.37471%,10:20.73129%,8:18.27871%,9:17.61045%,15:0.00323%,22:0.00054%,25:0.00018%,24:0.00018%,18:0.00018%,12:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99695%,0:0.00305%]
[INFO] ** i/f_name:[2:99.99677%,3:0.00323%]
[INFO] ** modbus_function_code:[0.02961:99.99588%,-33.760870000000004:0.00412%]
[INFO] ** modbus_function_description:[7:49.99857%,11:49.99731%,0:0.00412%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99964%,1:0.00036%]
[INFO] ** proto:[0:99.99588%,1:0.00323%,2:0.0009%]
[INFO] ** proxy_src_ip:[18:37.94057%,20:26.16561%,13:18.27889%,6:17.61063%,17:0.00323%,14:0.00054%,16:0.00036%,11:0.00018%]
[INFO] ** s_port:[1.45442:26.16525%,-0.32151:20.73129%,-1.27613:18.27836%,-0.23351:17.61027%,-0.33484:17.20927%,-71.33197:0.00323%,-1.02014:0.00036%,-71.14798:0.00018%,-64.19493:0.00018%,4.90362:0.00018%,-1.2708:0.00018%,-0.24151:0.00018%,13.431270000000001:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-68.36943000000001:0.00018%]
[INFO] ** scada_tag:[3:26.16507%,1:20.73093%,5:18.27818%,4:17.60991%,2:17.20909%,0:0.00681%]
[INFO] ** service:[0.0048200000000000005:99.99588%,-211.73542999999998:0.00323%,-211.08346:0.00018%,-201.23771000000002:0.00018%,-202.75898:0.00018%,-186.44547:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:37.94057%,9:26.16561%,7:18.27889%,1:17.61063%,14:0.00323%,2:0.00054%,15:0.00036%,10:0.00018%]
[INFO] ** type:[0:99.9991%,1:0.0009%]
[INFO] ** unixtime:1527 (0.27372%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0216 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0012 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0174 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.9443e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0151 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0809e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0126 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5917e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3697 - tp: 66966.0000 - fp: 13034.0000 - tn: 306966.0000 - fn: 13034.0000 - accuracy: 0.9348 - precision: 0.8371 - recall: 0.8371 - auc: 0.9789 - val_loss: 0.3979 - val_tp: 12788.0000 - val_fp: 7212.0000 - val_tn: 72788.0000 - val_fn: 7212.0000 - val_accuracy: 0.8558 - val_precision: 0.6394 - val_recall: 0.6394 - val_auc: 0.9675
[INFO] saving weights to checkpoints/lstm-epoch-2-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 7-7/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99534%,30:0.00161%,22:0.0009%,17:0.00072%,26:0.00054%,31:0.00036%,28:0.00018%,27:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:80.77535%,Single Stage Single Point:19.22465%]
[INFO] ** dst:[21:43.36037%,10:20.74438%,8:18.25021%,9:17.63859%,15:0.00161%,22:0.00143%,6:0.00143%,16:0.00072%,24:0.00036%,18:0.00036%,17:0.00036%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99839%,0:0.00161%]
[INFO] ** i/f_name:[2:99.99839%,3:0.00161%]
[INFO] ** modbus_function_code:[0.02961:99.99534%,-33.760870000000004:0.00466%]
[INFO] ** modbus_function_description:[7:49.99839%,11:49.99695%,0:0.00466%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99641%,2:0.00197%,1:0.00161%]
[INFO] ** proxy_src_ip:[18:37.96817%,20:26.13729%,13:18.25057%,6:17.63877%,17:0.00161%,11:0.00072%,1:0.00072%,21:0.00054%,16:0.00054%,14:0.00036%,7:0.00036%,10:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13639%,-0.32151:20.74438%,-1.27613:18.25003%,-0.23351:17.63841%,-0.33484:17.22379%,-71.33197:0.00161%,-71.14931:0.0009%,-1.02014:0.00054%,-71.14798:0.00054%,1.45709:0.00054%,-0.24151:0.00036%,-1.27347:0.00036%,1.47576:0.00018%,1.46509:0.00018%,14.253910000000001:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,-68.79874000000001:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,6.1115699999999995:0.00018%,-5.08665:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:26.13603%,1:20.74438%,5:18.24985%,4:17.63823%,2:17.22379%,0:0.00771%]
[INFO] ** service:[0.0048200000000000005:99.99534%,-211.73542999999998:0.00161%,-211.08818:0.0009%,-205.44247:0.00072%,-211.08346:0.00054%,-186.43601999999998:0.00036%,-211.09762999999998:0.00018%,-185.9872:0.00018%,-202.75898:0.00018%]
[INFO] ** src:[22:37.96817%,9:26.13729%,7:18.25057%,1:17.63877%,14:0.00161%,10:0.00072%,3:0.00072%,15:0.00054%,4:0.00054%,21:0.00036%,2:0.00036%,11:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1524 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1717 - tp: 71799.0000 - fp: 8201.0000 - tn: 311799.0000 - fn: 8201.0000 - accuracy: 0.9590 - precision: 0.8975 - recall: 0.8975 - auc: 0.9955 - val_loss: 0.0045 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1035 - tp: 74174.0000 - fp: 5826.0000 - tn: 314174.0000 - fn: 5826.0000 - accuracy: 0.9709 - precision: 0.9272 - recall: 0.9272 - auc: 0.9977 - val_loss: 5.6889e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0688 - tp: 76408.0000 - fp: 3592.0000 - tn: 316408.0000 - fn: 3592.0000 - accuracy: 0.9820 - precision: 0.9551 - recall: 0.9551 - auc: 0.9989 - val_loss: 0.1921 - val_tp: 19583.0000 - val_fp: 417.0000 - val_tn: 79583.0000 - val_fn: 417.0000 - val_accuracy: 0.9917 - val_precision: 0.9791 - val_recall: 0.9791 - val_auc: 0.9870
[INFO] saving weights to checkpoints/lstm-epoch-2-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1696 - tp: 78589.0000 - fp: 1411.0000 - tn: 318589.0000 - fn: 1411.0000 - accuracy: 0.9929 - precision: 0.9824 - recall: 0.9824 - auc: 0.9919 - val_loss: 0.0018 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0261 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.3989e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 8-8/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99713%,30:0.00108%,0:0.00054%,24:0.00018%,23:0.00018%,22:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.87723%,Single Stage Single Point:5.12277%]
[INFO] ** dst:[21:43.42095%,10:20.80335%,8:18.19034%,9:17.58177%,22:0.00125%,15:0.00108%,25:0.00054%,19:0.00036%,26:0.00018%,24:0.00018%]
[INFO] ** i/f_dir:[1:99.99928%,0:0.00072%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99713%,-33.760870000000004:0.00269%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99749%,0:0.00269%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99964%,2:0.00036%]
[INFO] ** proto:[0:99.99821%,1:0.00108%,2:0.00072%]
[INFO] ** proxy_src_ip:[18:38.08863%,20:26.13621%,13:18.18962%,6:17.58213%,17:0.00108%,10:0.00108%,16:0.00054%,14:0.00036%,11:0.00018%,5:0.00018%]
[INFO] ** s_port:[1.45442:26.13568%,-0.32151:20.80335%,-1.27613:18.18944%,-0.23351:17.58159%,-0.33484:17.28528%,-71.33197:0.00108%,-15.039579999999999:0.00072%,-1.02014:0.00054%,-64.19493:0.00054%,1.45709:0.00036%,-0.24151:0.00036%,4.66896:0.00036%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.13514%,1:20.80317%,5:18.18944%,4:17.58141%,2:17.2851%,0:0.00574%]
[INFO] ** service:[0.0048200000000000005:99.99785%,-211.73542999999998:0.00108%,-186.44547:0.00054%,-211.07873999999998:0.00036%,-211.08818:0.00018%]
[INFO] ** src:[22:38.08863%,9:26.13621%,7:18.18962%,1:17.58213%,11:0.00108%,14:0.00072%,15:0.00054%,21:0.00036%,2:0.00036%,16:0.00018%,10:0.00018%]
[INFO] ** type:[0:99.99946%,1:0.00036%,2:0.00018%]
[INFO] ** unixtime:1528 (0.2739%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8072e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0172 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2171e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0144 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4525e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0123 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.6173e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3168 - tp: 70802.0000 - fp: 9198.0000 - tn: 310802.0000 - fn: 9198.0000 - accuracy: 0.9540 - precision: 0.8850 - recall: 0.8850 - auc: 0.9849 - val_loss: 0.0100 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 9-9/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99821%,30:0.00108%,31:0.00036%,26:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:94.62824%,Single Stage Single Point:5.37176%]
[INFO] ** dst:[21:43.37327%,10:20.77055%,8:18.27979%,9:17.57352%,15:0.00108%,22:0.0009%,18:0.00036%,25:0.00018%,24:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99821%,-33.760870000000004:0.00179%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99821%,0:0.00179%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99964%,2:0.00036%]
[INFO] ** proto:[0:99.99821%,1:0.00108%,2:0.00072%]
[INFO] ** proxy_src_ip:[18:38.00653%,20:26.13783%,13:18.27979%,6:17.57388%,17:0.00108%,21:0.00018%,16:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13711%,-0.32151:20.77055%,-1.27613:18.27943%,-0.23351:17.57334%,-0.33484:17.23598%,-71.33197:0.00108%,-0.24151:0.00036%,1.45709:0.00036%,-0.08551:0.00036%,1.46509:0.00018%,1.47576:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.13675%,1:20.77037%,5:18.27943%,4:17.57316%,2:17.2358%,0:0.00448%]
[INFO] ** service:[0.0048200000000000005:99.99821%,-211.73542999999998:0.00108%,-186.43601999999998:0.00036%,-211.08346:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.00653%,9:26.13783%,7:18.27979%,1:17.57388%,14:0.00072%,21:0.00036%,17:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1528 (0.2739%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0573 - tp: 78230.0000 - fp: 1770.0000 - tn: 318230.0000 - fn: 1770.0000 - accuracy: 0.9911 - precision: 0.9779 - recall: 0.9779 - auc: 0.9995 - val_loss: 6.9912e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1599 - tp: 75287.0000 - fp: 4713.0000 - tn: 315287.0000 - fn: 4713.0000 - accuracy: 0.9764 - precision: 0.9411 - recall: 0.9411 - auc: 0.9954 - val_loss: 0.2828 - val_tp: 16373.0000 - val_fp: 3627.0000 - val_tn: 76373.0000 - val_fn: 3627.0000 - val_accuracy: 0.9275 - val_precision: 0.8187 - val_recall: 0.8187 - val_auc: 0.9918
[INFO] saving weights to checkpoints/lstm-epoch-2-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0309 - tp: 79760.0000 - fp: 240.0000 - tn: 319760.0000 - fn: 240.0000 - accuracy: 0.9988 - precision: 0.9970 - recall: 0.9970 - auc: 0.9999 - val_loss: 8.5849e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0159 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2368e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0124 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7196e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 10-10/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99624%,30:0.00179%,31:0.00036%,26:0.00018%,24:0.00018%,23:0.00018%,22:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:94.52391%,Single Stage Single Point:5.47609%]
[INFO] ** dst:[21:43.41181%,10:20.80586%,8:18.22565%,9:17.55273%,15:0.00179%,22:0.00054%,24:0.00036%,19:0.00036%,18:0.00036%,26:0.00018%,25:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99839%,0:0.00161%]
[INFO] ** i/f_name:[2:99.99821%,3:0.00179%]
[INFO] ** modbus_function_code:[0.02961:99.99624%,-33.760870000000004:0.00359%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99892%,11:49.99731%,0:0.00359%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99928%,1:0.00072%]
[INFO] ** proto:[0:99.99731%,1:0.00179%,2:0.0009%]
[INFO] ** proxy_src_ip:[18:38.08325%,20:26.13496%,13:18.22583%,6:17.55201%,17:0.00179%,10:0.0009%,14:0.00036%,21:0.00018%,16:0.00018%,5:0.00018%,2:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13424%,-0.32151:20.80586%,-1.27613:18.2253%,-0.23351:17.55165%,-0.33484:17.27739%,-71.33197:0.00179%,-10.51843:0.00072%,-0.08551:0.00036%,-1.27347:0.00036%,5.71692:0.00036%,1.47576:0.00036%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-71.14931:0.00018%,-64.19493:0.00018%,1.45709:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.13388%,1:20.80568%,5:18.2253%,4:17.55147%,2:17.27721%,0:0.00645%]
[INFO] ** service:[0.0048200000000000005:99.99695%,-211.73542999999998:0.00179%,-211.07873999999998:0.00036%,-186.43601999999998:0.00036%,-211.08346:0.00018%,-186.44547:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.08325%,9:26.13496%,7:18.22583%,1:17.55201%,14:0.00179%,11:0.0009%,2:0.00036%,17:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%]
[INFO] ** type:[0:99.99857%,1:0.00125%,2:0.00018%]
[INFO] ** unixtime:1524 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0098 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.9994e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0087 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.6570e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4061 - tp: 65297.0000 - fp: 14703.0000 - tn: 305297.0000 - fn: 14703.0000 - accuracy: 0.9265 - precision: 0.8162 - recall: 0.8162 - auc: 0.9766 - val_loss: 0.2852 - val_tp: 13270.0000 - val_fp: 6730.0000 - val_tn: 73270.0000 - val_fn: 6730.0000 - val_accuracy: 0.8654 - val_precision: 0.6635 - val_recall: 0.6635 - val_auc: 0.9704
[INFO] saving weights to checkpoints/lstm-epoch-2-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2315 - tp: 71455.0000 - fp: 8545.0000 - tn: 311455.0000 - fn: 8545.0000 - accuracy: 0.9573 - precision: 0.8932 - recall: 0.8932 - auc: 0.9906 - val_loss: 0.1083 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0434 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0054 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 11-11/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99892%,31:0.00036%,30:0.00036%,26:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.38833%,10:20.87559%,8:18.19787%,9:17.53588%,22:0.00125%,18:0.00036%,15:0.00036%,25:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99964%,3:0.00036%]
[INFO] ** modbus_function_code:[0.02961:99.99892%,-33.760870000000004:0.00108%]
[INFO] ** modbus_function_description:[7:50.00054%,11:49.99839%,0:0.00108%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99892%,2:0.00072%,1:0.00036%]
[INFO] ** proxy_src_ip:[18:38.14689%,20:26.11739%,13:18.19787%,6:17.53624%,16:0.00054%,17:0.00036%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.11685%,-0.32151:20.87559%,-1.27613:18.19769%,-0.23351:17.5357%,-0.33484:17.2713%,-0.24151:0.00054%,-1.02014:0.00054%,-0.08551:0.00036%,-71.33197:0.00036%,-71.14798:0.00018%,1.45709:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:26.11649%,1:20.87559%,5:18.19751%,4:17.53534%,2:17.27112%,0:0.00394%]
[INFO] ** service:[0.0048200000000000005:99.99892%,-211.73542999999998:0.00036%,-186.43601999999998:0.00036%,-211.08346:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.14689%,9:26.11739%,7:18.19787%,1:17.53624%,15:0.00054%,14:0.00036%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1525 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0102 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.1508e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0081 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1172e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0070 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1085e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0061 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3814e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0053 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8821e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 12-12/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99785%,30:0.00197%,9:0.00018%]
[INFO] ** classification:[normal:93.51255%,Single Stage Single Point:6.48745%]
[INFO] ** dst:[21:43.40159%,10:20.88312%,8:18.18066%,9:17.53158%,15:0.00197%,22:0.00054%,24:0.00036%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99839%,0:0.00161%]
[INFO] ** i/f_name:[2:99.99803%,3:0.00197%]
[INFO] ** modbus_function_code:[0.02961:99.99785%,-33.760870000000004:0.00215%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99821%,0:0.00215%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99839%,2:0.00161%]
[INFO] ** proto:[0:99.99803%,1:0.00197%]
[INFO] ** proxy_src_ip:[18:38.15496%,20:26.13012%,13:18.18084%,6:17.53176%,17:0.00197%,16:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:26.12958%,-0.32151:20.88312%,-1.27613:18.1803%,-0.23351:17.5314%,-0.33484:17.27183%,-71.33197:0.00197%,-1.27347:0.00036%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:26.12922%,1:20.88312%,5:18.1803%,4:17.53104%,2:17.27183%,0:0.00448%]
[INFO] ** service:[0.0048200000000000005:99.99785%,-211.73542999999998:0.00197%,-183.8612:0.00018%]
[INFO] ** src:[22:38.15496%,9:26.13012%,7:18.18084%,1:17.53176%,21:0.00161%,14:0.00036%,15:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1525 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0048 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5806e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0042 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7071e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3576 - tp: 68307.0000 - fp: 11693.0000 - tn: 308307.0000 - fn: 11693.0000 - accuracy: 0.9415 - precision: 0.8538 - recall: 0.8538 - auc: 0.9822 - val_loss: 0.4188 - val_tp: 12822.0000 - val_fp: 7178.0000 - val_tn: 72822.0000 - val_fn: 7178.0000 - val_accuracy: 0.8564 - val_precision: 0.6411 - val_recall: 0.6411 - val_auc: 0.9678
[INFO] saving weights to checkpoints/lstm-epoch-2-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2904 - tp: 65837.0000 - fp: 14163.0000 - tn: 305837.0000 - fn: 14163.0000 - accuracy: 0.9292 - precision: 0.8230 - recall: 0.8230 - auc: 0.9841 - val_loss: 0.2406 - val_tp: 18043.0000 - val_fp: 1957.0000 - val_tn: 78043.0000 - val_fn: 1957.0000 - val_accuracy: 0.9609 - val_precision: 0.9021 - val_recall: 0.9021 - val_auc: 0.9915
[INFO] saving weights to checkpoints/lstm-epoch-2-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0500 - tp: 79428.0000 - fp: 572.0000 - tn: 319428.0000 - fn: 572.0000 - accuracy: 0.9971 - precision: 0.9929 - recall: 0.9929 - auc: 0.9999 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 13-13/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99659%,31:0.00072%,26:0.00054%,0:0.00054%,30:0.00036%,22:0.00036%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:86.2846%,Single Stage Single Point:13.7154%]
[INFO] ** dst:[21:43.35535%,10:20.80622%,8:18.28033%,9:17.55416%,22:0.00108%,6:0.0009%,18:0.00072%,25:0.00054%,15:0.00036%,24:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99964%,3:0.00036%]
[INFO] ** modbus_function_code:[0.02961:99.99659%,-33.760870000000004:0.00323%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99892%,11:49.99767%,0:0.00323%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99731%,2:0.00233%,1:0.00036%]
[INFO] ** proxy_src_ip:[18:38.05403%,20:26.10789%,13:18.28051%,6:17.55362%,10:0.00108%,11:0.0009%,16:0.00054%,17:0.00036%,7:0.00036%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.10735%,-0.32151:20.80622%,-1.27613:18.28015%,-0.23351:17.55327%,-0.33484:17.24781%,-9.78512:0.00072%,-64.19493:0.00054%,-1.02014:0.00054%,-71.14798:0.00054%,-0.24151:0.00036%,-71.14931:0.00036%,-0.08551:0.00036%,-71.33197:0.00036%,1.47576:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,-68.79874000000001:0.00018%,6.1115699999999995:0.00018%,14.540560000000001:0.00018%,1.45709:0.00018%]
[INFO] ** scada_tag:[3:26.10699%,1:20.80604%,5:18.28015%,4:17.55327%,2:17.24763%,0:0.00592%]
[INFO] ** service:[0.0048200000000000005:99.99731%,-186.43601999999998:0.00072%,-211.08346:0.00054%,-186.44547:0.00054%,-211.73542999999998:0.00036%,-211.08818:0.00036%,-202.75898:0.00018%]
[INFO] ** src:[22:38.05403%,9:26.10789%,7:18.28051%,1:17.55362%,11:0.00108%,10:0.0009%,15:0.00054%,21:0.00036%,14:0.00036%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1525 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0086 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8306e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0076 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0827e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0053 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1694e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3896 - tp: 66804.0000 - fp: 13196.0000 - tn: 306804.0000 - fn: 13196.0000 - accuracy: 0.9340 - precision: 0.8350 - recall: 0.8350 - auc: 0.9797 - val_loss: 0.4195 - val_tp: 12833.0000 - val_fp: 7167.0000 - val_tn: 72833.0000 - val_fn: 7167.0000 - val_accuracy: 0.8567 - val_precision: 0.6417 - val_recall: 0.6417 - val_auc: 0.9679
[INFO] saving weights to checkpoints/lstm-epoch-2-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1419 - tp: 73966.0000 - fp: 6034.0000 - tn: 313966.0000 - fn: 6034.0000 - accuracy: 0.9698 - precision: 0.9246 - recall: 0.9246 - auc: 0.9969 - val_loss: 0.0024 - val_tp: 19996.0000 - val_fp: 4.0000 - val_tn: 79996.0000 - val_fn: 4.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-2-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 14-14/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99964%,30:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:93.16856%,Single Stage Single Point:6.83144%]
[INFO] ** dst:[21:43.35086%,10:20.81303%,8:18.26151%,9:17.57316%,22:0.00072%,24:0.00036%,15:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.99982%,3:0.00018%]
[INFO] ** modbus_function_code:[0.02961:99.99964%,-33.760870000000004:0.00036%]
[INFO] ** modbus_function_description:[7:50.00054%,11:49.9991%,0:0.00036%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,1:0.00018%]
[INFO] ** proxy_src_ip:[18:38.05296%,20:26.11148%,13:18.26168%,6:17.57334%,17:0.00018%,16:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:26.11076%,-0.32151:20.81303%,-1.27613:18.26115%,-0.23351:17.57298%,-0.33484:17.23993%,-1.27347:0.00036%,1.45709:0.00036%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%,-71.33197:0.00018%]
[INFO] ** scada_tag:[3:26.1104%,1:20.81303%,5:18.26097%,4:17.57263%,2:17.23975%,0:0.00323%]
[INFO] ** service:[0.0048200000000000005:99.99964%,-183.8612:0.00018%,-211.73542999999998:0.00018%]
[INFO] ** src:[22:38.05296%,9:26.11148%,7:18.26168%,1:17.57334%,15:0.00018%,14:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1524 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0795 - tp: 76321.0000 - fp: 3679.0000 - tn: 316321.0000 - fn: 3679.0000 - accuracy: 0.9816 - precision: 0.9540 - recall: 0.9540 - auc: 0.9988 - val_loss: 7.1657e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2290 - tp: 76019.0000 - fp: 3981.0000 - tn: 316019.0000 - fn: 3981.0000 - accuracy: 0.9801 - precision: 0.9502 - recall: 0.9502 - auc: 0.9902 - val_loss: 0.0492 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0375 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0072 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0169 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.5783e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0102 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.9226e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 15-15/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99624%,30:0.00305%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:90.0997%,Single Stage Multi Point:9.89958%,Single Stage Single Point:0.00072%]
[INFO] ** dst:[21:43.30229%,10:20.77682%,8:18.31528%,9:17.60023%,15:0.00305%,22:0.00161%,25:0.00018%,24:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99713%,0:0.00287%]
[INFO] ** i/f_name:[2:99.99695%,3:0.00305%]
[INFO] ** modbus_function_code:[0.02961:99.99624%,-33.760870000000004:0.00376%]
[INFO] ** modbus_function_description:[7:49.9991%,11:49.99713%,0:0.00376%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99731%,2:0.00269%]
[INFO] ** proto:[0:99.99659%,1:0.00305%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.01012%,20:26.06971%,13:18.31492%,6:17.60077%,17:0.00305%,16:0.00072%,7:0.00036%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.06881%,-0.32151:20.77664%,-1.27613:18.31474%,-0.23351:17.60005%,-0.33484:17.23347%,-71.33197:0.00305%,-1.02014:0.00072%,-0.24151:0.00054%,1.46509:0.00036%,1.45709:0.00036%,1.47576:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-61.95768:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.06845%,1:20.77646%,5:18.31474%,4:17.59969%,2:17.23329%,0:0.00735%]
[INFO] ** service:[0.0048200000000000005:99.99641%,-211.73542999999998:0.00305%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.01012%,9:26.06971%,7:18.31492%,1:17.60077%,21:0.00305%,15:0.00072%,14:0.00036%,16:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1533 (0.2748%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0075 - tp: 79997.0000 - fp: 3.0000 - tn: 319997.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4832e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0065 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0934e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0058 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1674e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0045 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0032e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.7872 - tp: 61215.0000 - fp: 18785.0000 - tn: 301215.0000 - fn: 18785.0000 - accuracy: 0.9061 - precision: 0.7652 - recall: 0.7652 - auc: 0.8520 - val_loss: 7.5199 - val_tp: 10669.0000 - val_fp: 9331.0000 - val_tn: 70669.0000 - val_fn: 9331.0000 - val_accuracy: 0.8134 - val_precision: 0.5335 - val_recall: 0.5335 - val_auc: 0.7084
[INFO] saving weights to checkpoints/lstm-epoch-2-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 16-16/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (497552, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (497552, 17)

[INFO] analyzing data
[INFO] 497552 rows
[INFO] ** appi_name:[21:99.99819%,30:0.00161%,33:0.0002%]
[INFO] ** classification:[normal:80.78191%,Single Stage Multi Point:19.21809%]
[INFO] ** dst:[21:43.35004%,10:20.79541%,8:18.25819%,9:17.59334%,15:0.00161%,22:0.00121%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.99839%,0:0.00161%]
[INFO] ** i/f_name:[2:99.99839%,3:0.00161%]
[INFO] ** modbus_function_code:[0.02961:99.99819%,-33.760870000000004:0.00181%]
[INFO] ** modbus_function_description:[7:50.0004%,11:49.99779%,0:0.00181%]
[INFO] ** modbus_transaction_id:65536 (13.17169%)
[INFO] ** orig:[0:99.99839%,2:0.00161%]
[INFO] ** proto:[0:99.99839%,1:0.00161%]
[INFO] ** proxy_src_ip:[18:38.04205%,20:26.1036%,13:18.25859%,6:17.59354%,17:0.00161%,16:0.0004%,21:0.0002%]
[INFO] ** s_port:[1.45442:26.103%,-0.32151:20.79521%,-1.27613:18.25819%,-0.23351:17.59314%,-0.33484:17.24684%,-71.33197:0.00161%,1.45709:0.0004%,-0.24151:0.0004%,-1.02014:0.0004%,-1.27347:0.0002%,1.47576:0.0002%,-49.275529999999996:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:26.1026%,1:20.79501%,5:18.25799%,4:17.59273%,2:17.24664%,0:0.00502%]
[INFO] ** service:[0.0048200000000000005:99.99839%,-211.73542999999998:0.00161%]
[INFO] ** src:[22:38.04205%,9:26.1036%,7:18.25859%,1:17.59354%,21:0.00161%,15:0.0004%,4:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1362 (0.27374%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/497552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5653 - tp: 42459.0000 - fp: 37541.0000 - tn: 282459.0000 - fn: 37541.0000 - accuracy: 0.8123 - precision: 0.5307 - recall: 0.5307 - auc: 0.7043 - val_loss: 7.5368 - val_tp: 10648.0000 - val_fp: 9352.0000 - val_tn: 70648.0000 - val_fn: 9352.0000 - val_accuracy: 0.8130 - val_precision: 0.5324 - val_recall: 0.5324 - val_auc: 0.7078
[INFO] saving weights to checkpoints/lstm-epoch-2-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/497552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5489 - tp: 42540.0000 - fp: 37460.0000 - tn: 282540.0000 - fn: 37460.0000 - accuracy: 0.8127 - precision: 0.5318 - recall: 0.5318 - auc: 0.7050 - val_loss: 7.5803 - val_tp: 10594.0000 - val_fp: 9406.0000 - val_tn: 70594.0000 - val_fn: 9406.0000 - val_accuracy: 0.8119 - val_precision: 0.5297 - val_recall: 0.5297 - val_auc: 0.7061
[INFO] saving weights to checkpoints/lstm-epoch-2-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/497552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3778 - tp: 78139.0000 - fp: 1861.0000 - tn: 318139.0000 - fn: 1861.0000 - accuracy: 0.9907 - precision: 0.9767 - recall: 0.9767 - auc: 0.9854 - val_loss: 1.3514e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/497552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0026 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2771e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/497552
[33m[INFO] loading file 17-17/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597552, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597552, 17)

[INFO] analyzing data
[INFO] 597552 rows
[INFO] ** appi_name:[21:99.99732%,7:0.0005%,26:0.00033%,0:0.00033%,33:0.00017%,31:0.00017%,27:0.00017%,24:0.00017%,22:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:94.83727%,Multi Stage Multi Point:5.16273%]
[INFO] ** dst:[21:43.35255%,10:20.83651%,8:18.2098%,9:17.5983%,22:0.00084%,6:0.0005%,25:0.00033%,16:0.00033%,2:0.00033%,24:0.00017%,18:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99732%,-33.760870000000004:0.00251%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99967%,11:49.99766%,0:0.00251%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (10.96741%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,2:0.00117%]
[INFO] ** proxy_src_ip:[18:38.07736%,20:26.11237%,13:18.20929%,6:17.59813%,10:0.001%,11:0.00084%,1:0.00033%,21:0.00017%,16:0.00017%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:26.11137%,-0.32151:20.83635%,-1.27613:18.20896%,-0.23351:17.59797%,-0.33484:17.24101%,6.0369:0.00067%,1.45709:0.0005%,1.47576:0.00033%,-71.14798:0.00033%,-64.19493:0.00033%,1.46509:0.00017%,-49.275529999999996:0.00017%,-1.27347:0.00017%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,-68.79874000000001:0.00017%,6.15557:0.00017%,6.06224:0.00017%,8.55414:0.00017%,-3.3787199999999995:0.00017%,-4.3880099999999995:0.00017%,-71.14931:0.00017%]
[INFO] ** scada_tag:[3:26.1112%,1:20.83618%,5:18.20879%,4:17.59746%,2:17.24101%,0:0.00536%]
[INFO] ** service:[0.0048200000000000005:99.99816%,-211.09762999999998:0.0005%,-211.08346:0.00033%,-186.44547:0.00033%,-211.35747999999998:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.07736%,9:26.11237%,7:18.20929%,1:17.59813%,11:0.001%,10:0.00084%,3:0.00033%,21:0.00017%,15:0.00017%,4:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1632 (0.27311%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0024 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0022 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0019 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1657 - tp: 79186.0000 - fp: 814.0000 - tn: 319186.0000 - fn: 814.0000 - accuracy: 0.9959 - precision: 0.9898 - recall: 0.9898 - auc: 0.9936 - val_loss: 2.9778 - val_tp: 16305.0000 - val_fp: 3695.0000 - val_tn: 76305.0000 - val_fn: 3695.0000 - val_accuracy: 0.9261 - val_precision: 0.8152 - val_recall: 0.8152 - val_auc: 0.8845
[INFO] saving weights to checkpoints/lstm-epoch-2-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9250 - tp: 65489.0000 - fp: 14511.0000 - tn: 305489.0000 - fn: 14511.0000 - accuracy: 0.9274 - precision: 0.8186 - recall: 0.8186 - auc: 0.8857 - val_loss: 2.8988 - val_tp: 16403.0000 - val_fp: 3597.0000 - val_tn: 76403.0000 - val_fn: 3597.0000 - val_accuracy: 0.9281 - val_precision: 0.8202 - val_recall: 0.8202 - val_auc: 0.8876
[INFO] saving weights to checkpoints/lstm-epoch-2-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/597552
[33m[INFO] loading file 18-18/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597552, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597552, 17)

[INFO] analyzing data
[INFO] 597552 rows
[INFO] ** appi_name:[21:99.99833%,30:0.0005%,7:0.0005%,31:0.00017%,27:0.00017%,22:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:82.38965%,Multi Stage Multi Point:17.61035%]
[INFO] ** dst:[21:43.34234%,10:20.83233%,8:18.25314%,9:17.56952%,22:0.00067%,15:0.0005%,24:0.00033%,16:0.00033%,2:0.00033%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.9995%,0:0.0005%]
[INFO] ** i/f_name:[2:99.9995%,3:0.0005%]
[INFO] ** modbus_function_code:[0.02961:99.99833%,-33.760870000000004:0.00167%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99833%,0:0.00167%]
[INFO] ** modbus_transaction_id:65536 (10.96741%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.999%,2:0.0005%,1:0.0005%]
[INFO] ** proxy_src_ip:[18:38.0797%,20:26.09547%,13:18.25347%,6:17.56968%,17:0.0005%,11:0.0005%,1:0.00033%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:26.0948%,-0.32151:20.83233%,-1.27613:18.25297%,-0.23351:17.56935%,-0.33484:17.24737%,-71.33197:0.0005%,-1.27347:0.00033%,1.45709:0.00033%,-0.24151:0.00033%,1.47576:0.00017%,1.46509:0.00017%,3.6236699999999997:0.00017%,-1.2708:0.00017%,-2.48275:0.00017%,6.06224:0.00017%,-3.3787199999999995:0.00017%,8.10082:0.00017%,6.45955:0.00017%,-71.14931:0.00017%]
[INFO] ** scada_tag:[3:26.09447%,1:20.83216%,5:18.2528%,4:17.56918%,2:17.2472%,0:0.00418%]
[INFO] ** service:[0.0048200000000000005:99.99833%,-211.09762999999998:0.0005%,-211.73542999999998:0.0005%,-211.35747999999998:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.0797%,9:26.09547%,7:18.25347%,1:17.56968%,14:0.0005%,10:0.0005%,3:0.00033%,21:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1632 (0.27311%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.6600 - tp: 71767.0000 - fp: 8233.0000 - tn: 311767.0000 - fn: 8233.0000 - accuracy: 0.9588 - precision: 0.8971 - recall: 0.8971 - auc: 0.9353 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.8120 - tp: 56121.0000 - fp: 23879.0000 - tn: 296121.0000 - fn: 23879.0000 - accuracy: 0.8806 - precision: 0.7015 - recall: 0.7015 - auc: 0.8122 - val_loss: 6.1080 - val_tp: 12421.0000 - val_fp: 7579.0000 - val_tn: 72421.0000 - val_fn: 7579.0000 - val_accuracy: 0.8484 - val_precision: 0.6211 - val_recall: 0.6211 - val_auc: 0.7632
[INFO] saving weights to checkpoints/lstm-epoch-2-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1392 - tp: 49533.0000 - fp: 30467.0000 - tn: 289533.0000 - fn: 30467.0000 - accuracy: 0.8477 - precision: 0.6192 - recall: 0.6192 - auc: 0.7603 - val_loss: 6.1329 - val_tp: 12390.0000 - val_fp: 7610.0000 - val_tn: 72390.0000 - val_fn: 7610.0000 - val_accuracy: 0.8478 - val_precision: 0.6195 - val_recall: 0.6195 - val_auc: 0.7622
[INFO] saving weights to checkpoints/lstm-epoch-2-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.5339 - tp: 52537.0000 - fp: 27463.0000 - tn: 292537.0000 - fn: 27463.0000 - accuracy: 0.8627 - precision: 0.6567 - recall: 0.6567 - auc: 0.7840 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0011 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/597552
[33m[INFO] loading file 19-19/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597552, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597552, 17)

[INFO] analyzing data
[INFO] 597552 rows
[INFO] ** appi_name:[21:99.99816%,26:0.00033%,0:0.00033%,31:0.00017%,27:0.00017%,24:0.00017%,22:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:88.02447%,Single Stage Multi Point:11.97553%]
[INFO] ** dst:[21:43.39037%,10:20.83233%,8:18.20411%,9:17.57069%,22:0.00117%,6:0.0005%,25:0.00033%,24:0.00017%,18:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99816%,-33.760870000000004:0.00167%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99816%,0:0.00167%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (10.96741%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,2:0.00117%]
[INFO] ** proxy_src_ip:[18:38.1217%,20:26.10116%,13:18.20411%,6:17.57069%,10:0.001%,11:0.00084%,16:0.0005%]
[INFO] ** s_port:[1.45442:26.10016%,-0.32151:20.83233%,-1.27613:18.20377%,-0.23351:17.57052%,-0.33484:17.28937%,-5.20264:0.00067%,1.45709:0.0005%,-1.02014:0.0005%,-64.19493:0.00033%,-71.14798:0.00033%,1.46509:0.00033%,-1.27347:0.00017%,-0.24151:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-71.14931:0.00017%,-68.79874000000001:0.00017%,0.75578:0.00017%]
[INFO] ** scada_tag:[3:26.09982%,1:20.83216%,5:18.2036%,4:17.57035%,2:17.28921%,0:0.00485%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.08346:0.00033%,-186.44547:0.00033%,-202.75898:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.1217%,9:26.10116%,7:18.20411%,1:17.57069%,11:0.001%,10:0.00084%,15:0.0005%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1634 (0.27345%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.7095e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.6842e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.6120e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.6802e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.3224 - tp: 43658.0000 - fp: 36342.0000 - tn: 283658.0000 - fn: 36342.0000 - accuracy: 0.8183 - precision: 0.5457 - recall: 0.5457 - auc: 0.7141 - val_loss: 9.8232 - val_tp: 7811.0000 - val_fp: 12189.0000 - val_tn: 67811.0000 - val_fn: 12189.0000 - val_accuracy: 0.7562 - val_precision: 0.3905 - val_recall: 0.3905 - val_auc: 0.6191
[INFO] saving weights to checkpoints/lstm-epoch-2-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/597552
[33m[INFO] loading file 20-20/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597552, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597552, 17)

[INFO] analyzing data
[INFO] 597552 rows
[INFO] ** appi_name:[21:99.99682%,30:0.00268%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:89.2883%,Single Stage Multi Point:10.7117%]
[INFO] ** dst:[21:43.42735%,10:20.8345%,8:18.15407%,9:17.57939%,15:0.00268%,22:0.00117%,24:0.00033%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99766%,0:0.00234%]
[INFO] ** i/f_name:[2:99.99732%,3:0.00268%]
[INFO] ** modbus_function_code:[0.02961:99.99682%,-33.760870000000004:0.00318%]
[INFO] ** modbus_function_description:[7:49.99967%,11:49.99716%,0:0.00318%]
[INFO] ** modbus_transaction_id:65536 (10.96741%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99682%,1:0.00268%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.11233%,20:26.15019%,13:18.15424%,6:17.57989%,17:0.00268%,14:0.0005%,16:0.00017%]
[INFO] ** s_port:[1.45442:26.14936%,-0.32151:20.8345%,-1.27613:18.15373%,-0.23351:17.57922%,-0.33484:17.27783%,-71.33197:0.00268%,1.45709:0.0005%,-0.24151:0.0005%,-1.27347:0.00033%,13.431270000000001:0.00017%,-1.2708:0.00017%,-1.02014:0.00017%,-71.14798:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:26.14885%,1:20.83434%,5:18.15373%,4:17.57889%,2:17.27766%,0:0.00653%]
[INFO] ** service:[0.0048200000000000005:99.99682%,-211.73542999999998:0.00268%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.11233%,9:26.15019%,7:18.15424%,1:17.57989%,14:0.00268%,2:0.0005%,15:0.00017%]
[INFO] ** type:[0:99.99967%,1:0.00033%]
[INFO] ** unixtime:1634 (0.27345%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.6402 - tp: 56971.0000 - fp: 23029.0000 - tn: 296971.0000 - fn: 23029.0000 - accuracy: 0.8849 - precision: 0.7121 - recall: 0.7121 - auc: 0.8188 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.9083 - tp: 75494.0000 - fp: 4506.0000 - tn: 315494.0000 - fn: 4506.0000 - accuracy: 0.9775 - precision: 0.9437 - recall: 0.9437 - auc: 0.9646 - val_loss: 2.9681 - val_tp: 16317.0000 - val_fp: 3683.0000 - val_tn: 76317.0000 - val_fn: 3683.0000 - val_accuracy: 0.9263 - val_precision: 0.8159 - val_recall: 0.8159 - val_auc: 0.8849
[INFO] saving weights to checkpoints/lstm-epoch-2-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9411 - tp: 65404.0000 - fp: 14596.0000 - tn: 305404.0000 - fn: 14596.0000 - accuracy: 0.9270 - precision: 0.8176 - recall: 0.8176 - auc: 0.8853 - val_loss: 2.9690 - val_tp: 16316.0000 - val_fp: 3684.0000 - val_tn: 76316.0000 - val_fn: 3684.0000 - val_accuracy: 0.9263 - val_precision: 0.8158 - val_recall: 0.8158 - val_auc: 0.8849
[INFO] saving weights to checkpoints/lstm-epoch-2-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9237 - tp: 65490.0000 - fp: 14510.0000 - tn: 305490.0000 - fn: 14510.0000 - accuracy: 0.9275 - precision: 0.8186 - recall: 0.8186 - auc: 0.8860 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.5495e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/597552
[33m[INFO] loading file 21-21/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597550, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597550, 17)

[INFO] analyzing data
[INFO] 597550 rows
[INFO] ** appi_name:[21:99.99632%,30:0.001%,7:0.0005%,26:0.00033%,22:0.00033%,0:0.00033%,31:0.00017%,27:0.00017%,24:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:98.97866%,Multi Stage Single Point:1.02134%]
[INFO] ** dst:[21:43.32809%,10:20.9723%,8:18.16199%,9:17.53309%,15:0.001%,22:0.00084%,24:0.00067%,6:0.00067%,25:0.00033%,16:0.00033%,2:0.00033%,18:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.999%,0:0.001%]
[INFO] ** i/f_name:[2:99.999%,3:0.001%]
[INFO] ** modbus_function_code:[0.02961:99.99632%,-33.760870000000004:0.00351%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99916%,11:49.99716%,0:0.00351%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (10.96745%)
[INFO] ** orig:[0:99.99933%,2:0.00067%]
[INFO] ** proto:[0:99.99766%,2:0.00134%,1:0.001%]
[INFO] ** proxy_src_ip:[18:38.30223%,20:25.99799%,13:18.16266%,6:17.53293%,17:0.001%,10:0.001%,11:0.00084%,16:0.0005%,1:0.00033%,21:0.00017%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.99732%,-0.32151:20.97163%,-1.27613:18.16183%,-0.23351:17.53276%,-0.33484:17.3306%,-71.33197:0.001%,-1.27347:0.00067%,-6.64392:0.00067%,-1.02014:0.0005%,-64.19493:0.00033%,-71.14931:0.00033%,-71.14798:0.00033%,1.47576:0.00033%,1.46509:0.00017%,-1.2708:0.00017%,6.62488:0.00017%,10.15141:0.00017%,-68.79874000000001:0.00017%,7.060860000000001:0.00017%,-3.3787199999999995:0.00017%,-2.2440900000000004:0.00017%,1.45709:0.00017%,-0.24151:0.00017%]
[INFO] ** scada_tag:[3:25.99682%,1:20.9713%,5:18.16166%,4:17.53242%,2:17.3306%,0:0.0072%]
[INFO] ** service:[0.0048200000000000005:99.99699%,-211.73542999999998:0.001%,-211.09762999999998:0.0005%,-211.08346:0.00033%,-186.44547:0.00033%,-211.08818:0.00033%,-211.35747999999998:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.30223%,9:25.99799%,7:18.16266%,1:17.53293%,11:0.001%,21:0.00084%,10:0.00084%,15:0.0005%,14:0.00033%,3:0.00033%,4:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1628 (0.27245%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597550
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.0121e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/597550
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.6379e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/597550
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.3967e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/597550
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.0213e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/597550
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.8746e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/597550
[33m[INFO] loading file 22-22/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (366591, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (366591, 17)

[INFO] analyzing data
[INFO] 366591 rows
[INFO] ** appi_name:[21:99.99291%,30:0.00627%,23:0.00027%,22:0.00027%,18:0.00027%]
[INFO] ** classification:[normal:63.84199%,Multi Stage Single Point:36.15801%]
[INFO] ** dst:[21:43.31912%,10:21.00679%,8:18.1011%,9:17.56481%,15:0.00627%,22:0.00109%,19:0.00055%,26:0.00027%]
[INFO] ** i/f_dir:[1:99.994%,0:0.006%]
[INFO] ** i/f_name:[2:99.99373%,3:0.006%,0:0.00027%]
[INFO] ** modbus_function_code:[0.02961:99.99291%,-33.760870000000004:0.00709%]
[INFO] ** modbus_function_description:[7:49.99714%,11:49.99577%,0:0.00709%]
[INFO] ** modbus_transaction_id:65534 (17.8766%)
[INFO] ** orig:[0:99.99509%,2:0.00436%,1:0.00055%]
[INFO] ** proto:[0:99.99345%,1:0.00627%,2:0.00027%]
[INFO] ** proxy_src_ip:[18:38.33018%,20:25.99655%,13:18.10055%,6:17.56562%,17:0.00627%,14:0.00055%,10:0.00027%]
[INFO] ** s_port:[1.45442:25.99573%,-0.32151:21.00679%,-1.27613:18.10055%,-0.23351:17.56481%,-0.33484:17.32339%,-71.33197:0.00627%,1.45709:0.00055%,-0.24151:0.00055%,7.228860000000001:0.00055%,-0.24950999999999998:0.00027%,1.46509:0.00027%,-71.14931:0.00027%]
[INFO] ** scada_tag:[3:25.99546%,1:21.00679%,5:18.10055%,4:17.56453%,2:17.32339%,0:0.00927%]
[INFO] ** service:[0.0048200000000000005:99.99291%,-211.73542999999998:0.00627%,-211.07873999999998:0.00055%,-211.08818:0.00027%]
[INFO] ** src:[22:38.33018%,9:25.99655%,7:18.10055%,1:17.56562%,21:0.00436%,14:0.00191%,2:0.00055%,11:0.00027%]
[INFO] ** type:[0:99.99836%,1:0.00164%]
[INFO] ** unixtime:1012 (0.27606%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/366591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.6693e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.8380 - val_tp: 12756.0000 - val_fp: 7244.0000 - val_tn: 72756.0000 - val_fn: 7244.0000 - val_accuracy: 0.8551 - val_precision: 0.6378 - val_recall: 0.6378 - val_auc: 0.7736
[INFO] saving weights to checkpoints/lstm-epoch-2-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/366591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5675 - tp: 42440.0000 - fp: 37560.0000 - tn: 282440.0000 - fn: 37560.0000 - accuracy: 0.8122 - precision: 0.5305 - recall: 0.5305 - auc: 0.7066 - val_loss: 7.5763 - val_tp: 10599.0000 - val_fp: 9401.0000 - val_tn: 70599.0000 - val_fn: 9401.0000 - val_accuracy: 0.8120 - val_precision: 0.5300 - val_recall: 0.5300 - val_auc: 0.7062
[INFO] saving weights to checkpoints/lstm-epoch-2-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/366591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5917 - tp: 42320.0000 - fp: 37680.0000 - tn: 282320.0000 - fn: 37680.0000 - accuracy: 0.8116 - precision: 0.5290 - recall: 0.5290 - auc: 0.7056 - val_loss: 7.5763 - val_tp: 10599.0000 - val_fp: 9401.0000 - val_tn: 70599.0000 - val_fn: 9401.0000 - val_accuracy: 0.8120 - val_precision: 0.5300 - val_recall: 0.5300 - val_auc: 0.7062
[INFO] saving weights to checkpoints/lstm-epoch-2-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/366591
[33m[INFO] loading file 23-23/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (566591, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (566591, 17)

[INFO] analyzing data
[INFO] 566591 rows
[INFO] ** appi_name:[21:99.99859%,30:0.00071%,31:0.00035%,33:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:92.88711%,Multi Stage Single Point:7.11289%]
[INFO] ** dst:[21:43.31978%,10:21.00104%,8:18.14342%,9:17.53311%,22:0.00106%,15:0.00071%,24:0.00035%,18:0.00035%,25:0.00018%]
[INFO] ** i/f_dir:[1:99.99929%,0:0.00071%]
[INFO] ** i/f_name:[2:99.99929%,3:0.00071%]
[INFO] ** modbus_function_code:[0.02961:99.99859%,-33.760870000000004:0.00141%]
[INFO] ** modbus_function_description:[7:50.00026%,11:49.99832%,0:0.00141%]
[INFO] ** modbus_transaction_id:65536 (11.56672%)
[INFO] ** orig:[0:99.99947%,2:0.00053%]
[INFO] ** proto:[0:99.99876%,1:0.00071%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.33541%,20:25.98594%,13:18.14342%,6:17.53328%,17:0.00071%,16:0.00053%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98506%,-0.32151:21.00086%,-1.27613:18.14289%,-0.23351:17.53293%,-0.33484:17.33455%,-71.33197:0.00071%,-1.02014:0.00053%,-0.08551:0.00035%,-1.27347:0.00035%,1.45709:0.00035%,1.46509:0.00035%,-0.24151:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:25.98471%,1:21.00086%,5:18.14272%,4:17.53275%,2:17.33437%,0:0.00459%]
[INFO] ** service:[0.0048200000000000005:99.99876%,-211.73542999999998:0.00071%,-186.43601999999998:0.00035%,-186.44547:0.00018%]
[INFO] ** src:[22:38.33541%,9:25.98594%,7:18.14342%,1:17.53328%,21:0.00053%,15:0.00053%,17:0.00018%,14:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1543 (0.27233%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5685 - tp: 42435.0000 - fp: 37565.0000 - tn: 282435.0000 - fn: 37565.0000 - accuracy: 0.8122 - precision: 0.5304 - recall: 0.5304 - auc: 0.7065 - val_loss: 2.2050 - val_tp: 17264.0000 - val_fp: 2736.0000 - val_tn: 77264.0000 - val_fn: 2736.0000 - val_accuracy: 0.9453 - val_precision: 0.8632 - val_recall: 0.8632 - val_auc: 0.9145
[INFO] saving weights to checkpoints/lstm-epoch-2-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.1502e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0275e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.8227e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.7783e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/566591
[33m[INFO] loading file 24-24/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (566591, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (566591, 17)

[INFO] analyzing data
[INFO] 566591 rows
[INFO] ** appi_name:[21:99.99347%,30:0.00318%,26:0.00053%,31:0.00035%,27:0.00035%,22:0.00035%,0:0.00035%,24:0.00018%,23:0.00018%,19:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,11:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:95.50293%,Multi Stage Single Point:4.49707%]
[INFO] ** dst:[21:43.37079%,10:21.01781%,8:18.09648%,9:17.50804%,15:0.00318%,22:0.00106%,6:0.00071%,25:0.00035%,24:0.00035%,19:0.00035%,18:0.00035%,7:0.00035%,26:0.00018%]
[INFO] ** i/f_dir:[1:99.997%,0:0.003%]
[INFO] ** i/f_name:[2:99.99682%,3:0.00318%]
[INFO] ** modbus_function_code:[0.02961:99.99347%,-33.760870000000004:0.006%,-0.415:0.00018%,0.9188299999999999:0.00018%,0.47422:0.00018%]
[INFO] ** modbus_function_description:[7:49.99779%,11:49.99568%,0:0.006%,15:0.00018%,10:0.00018%,2:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.56672%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.99488%,1:0.00318%,2:0.00194%]
[INFO] ** proxy_src_ip:[18:38.40319%,20:25.98629%,13:18.0963%,6:17.50734%,17:0.00318%,10:0.00124%,14:0.00088%,11:0.00088%,21:0.00035%,16:0.00035%]
[INFO] ** s_port:[1.45442:25.98541%,-0.32151:21.01781%,-1.27613:18.09595%,-0.23351:17.50663%,-0.33484:17.38538%,-71.33197:0.00318%,-9.58113:0.00071%,-71.14798:0.00053%,-0.24950999999999998:0.00035%,-1.27347:0.00035%,1.45709:0.00035%,-0.24151:0.00035%,-1.02014:0.00035%,-31.55091:0.00035%,7.6315100000000005:0.00035%,-71.14931:0.00035%,-64.19493:0.00035%,1.47576:0.00035%,-68.79874000000001:0.00018%,1.46509:0.00018%,7.4901800000000005:0.00018%,13.431270000000001:0.00018%,11.862:0.00018%]
[INFO] ** scada_tag:[3:25.98523%,1:21.01781%,5:18.09577%,4:17.50628%,2:17.3852%,0:0.00971%]
[INFO] ** service:[0.0048200000000000005:99.99453%,-211.73542999999998:0.00318%,-211.08346:0.00053%,-211.07873999999998:0.00035%,-202.75898:0.00035%,-186.44547:0.00035%,-186.43601999999998:0.00035%,-211.08818:0.00035%]
[INFO] ** src:[22:38.40319%,9:25.98629%,7:18.0963%,1:17.50734%,14:0.00318%,11:0.00124%,10:0.00088%,2:0.00088%,15:0.00035%,4:0.00035%]
[INFO] ** type:[0:99.99876%,1:0.00088%,2:0.00035%]
[INFO] ** unixtime:1539 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.7727e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.2739e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.3704e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.6651e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.1778e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4716 - val_tp: 18174.0000 - val_fp: 1826.0000 - val_tn: 78174.0000 - val_fn: 1826.0000 - val_accuracy: 0.9635 - val_precision: 0.9087 - val_recall: 0.9087 - val_auc: 0.9429
[INFO] saving weights to checkpoints/lstm-epoch-2-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/566591
[33m[INFO] loading file 25-25/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (566591, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (566591, 17)

[INFO] analyzing data
[INFO] 566591 rows
[INFO] ** appi_name:[21:99.99647%,30:0.00106%,17:0.00071%,22:0.00053%,31:0.00035%,28:0.00018%,26:0.00018%,12:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** classification:[normal:64.35118%,Multi Stage Single Point:35.64882%]
[INFO] ** dst:[21:43.32102%,10:21.02593%,8:18.13389%,9:17.51493%,15:0.00106%,22:0.00088%,16:0.00071%,6:0.00071%,18:0.00035%,17:0.00035%,24:0.00018%]
[INFO] ** i/f_dir:[1:99.99894%,0:0.00106%]
[INFO] ** i/f_name:[2:99.99894%,3:0.00106%]
[INFO] ** modbus_function_code:[0.02961:99.99647%,-33.760870000000004:0.00353%]
[INFO] ** modbus_function_description:[7:49.99903%,11:49.99744%,0:0.00353%]
[INFO] ** modbus_transaction_id:65536 (11.56672%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99788%,2:0.00106%,1:0.00106%]
[INFO] ** proxy_src_ip:[18:38.38924%,20:25.95752%,13:18.13389%,6:17.51546%,17:0.00106%,1:0.00088%,21:0.00071%,16:0.00035%,14:0.00035%,7:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95717%,-0.32151:21.02557%,-1.27613:18.13354%,-0.23351:17.51493%,-0.33484:17.36367%,-71.33197:0.00106%,-71.14931:0.00053%,-0.24151:0.00035%,-1.02014:0.00035%,-49.275529999999996:0.00035%,1.46509:0.00018%,-5.1466400000000005:0.00018%,-1.27347:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,-0.24950999999999998:0.00018%,2.52505:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,6.1115699999999995:0.00018%,-5.08665:0.00018%,1.45709:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:25.95682%,1:21.0254%,5:18.13336%,4:17.51475%,2:17.3635%,0:0.00618%]
[INFO] ** service:[0.0048200000000000005:99.99682%,-211.73542999999998:0.00106%,-205.44247:0.00071%,-211.08818:0.00053%,-186.43601999999998:0.00035%,-211.09762999999998:0.00018%,-211.08346:0.00018%,-185.9872:0.00018%]
[INFO] ** src:[22:38.38924%,9:25.95752%,7:18.13389%,1:17.51546%,14:0.00106%,3:0.00088%,4:0.00071%,21:0.00035%,15:0.00035%,2:0.00035%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1539 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7330 - tp: 51545.0000 - fp: 28455.0000 - tn: 291545.0000 - fn: 28455.0000 - accuracy: 0.8577 - precision: 0.6443 - recall: 0.6443 - auc: 0.7777 - val_loss: 5.7429 - val_tp: 12874.0000 - val_fp: 7126.0000 - val_tn: 72874.0000 - val_fn: 7126.0000 - val_accuracy: 0.8575 - val_precision: 0.6437 - val_recall: 0.6437 - val_auc: 0.7773
[INFO] saving weights to checkpoints/lstm-epoch-2-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7552 - tp: 51435.0000 - fp: 28565.0000 - tn: 291435.0000 - fn: 28565.0000 - accuracy: 0.8572 - precision: 0.6429 - recall: 0.6429 - auc: 0.7768 - val_loss: 5.7566 - val_tp: 12857.0000 - val_fp: 7143.0000 - val_tn: 72857.0000 - val_fn: 7143.0000 - val_accuracy: 0.8571 - val_precision: 0.6428 - val_recall: 0.6428 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-2-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7463 - tp: 51479.0000 - fp: 28521.0000 - tn: 291479.0000 - fn: 28521.0000 - accuracy: 0.8574 - precision: 0.6435 - recall: 0.6435 - auc: 0.7772 - val_loss: 5.7276 - val_tp: 12893.0000 - val_fp: 7107.0000 - val_tn: 72893.0000 - val_fn: 7107.0000 - val_accuracy: 0.8579 - val_precision: 0.6446 - val_recall: 0.6446 - val_auc: 0.7779
[INFO] saving weights to checkpoints/lstm-epoch-2-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7497 - tp: 51462.0000 - fp: 28538.0000 - tn: 291462.0000 - fn: 28538.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.7770 - val_loss: 5.7324 - val_tp: 12887.0000 - val_fp: 7113.0000 - val_tn: 72887.0000 - val_fn: 7113.0000 - val_accuracy: 0.8577 - val_precision: 0.6443 - val_recall: 0.6443 - val_auc: 0.7777
[INFO] saving weights to checkpoints/lstm-epoch-2-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7594 - tp: 51414.0000 - fp: 28586.0000 - tn: 291414.0000 - fn: 28586.0000 - accuracy: 0.8571 - precision: 0.6427 - recall: 0.6427 - auc: 0.7767 - val_loss: 5.7195 - val_tp: 12903.0000 - val_fp: 7097.0000 - val_tn: 72903.0000 - val_fn: 7097.0000 - val_accuracy: 0.8581 - val_precision: 0.6452 - val_recall: 0.6452 - val_auc: 0.7782
[INFO] saving weights to checkpoints/lstm-epoch-2-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/566591
[33m[INFO] loading file 26-26/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (566591, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (566591, 17)

[INFO] analyzing data
[INFO] 566591 rows
[INFO] ** appi_name:[21:99.99824%,30:0.00053%,7:0.00053%,31:0.00018%,22:0.00018%,12:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:64.39707%,Single Stage Single Point:28.18823%,Multi Stage Single Point:7.4147%]
[INFO] ** dst:[21:43.30884%,10:21.08593%,8:18.12189%,9:17.48069%,22:0.00071%,15:0.00053%,24:0.00035%,16:0.00035%,2:0.00035%,18:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99947%,0:0.00053%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99824%,-33.760870000000004:0.00176%]
[INFO] ** modbus_function_description:[7:49.99974%,11:49.9985%,0:0.00176%]
[INFO] ** modbus_transaction_id:65536 (11.56672%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99912%,1:0.00053%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.46337%,20:25.93158%,13:18.12224%,6:17.48069%,17:0.00053%,1:0.00053%,21:0.00035%,16:0.00035%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.93105%,-0.32151:21.08576%,-1.27613:18.12171%,-0.23351:17.48051%,-0.33484:17.37761%,-71.33197:0.00053%,-1.02014:0.00035%,-1.27347:0.00035%,-49.275529999999996:0.00018%,1.47576:0.00018%,1.45709:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,14.191239999999999:0.00018%,2.52505:0.00018%,-3.3787199999999995:0.00018%,11.57001:0.00018%,-71.14931:0.00018%,7.66617:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.9307%,1:21.08576%,5:18.12154%,4:17.48033%,2:17.37761%,0:0.00406%]
[INFO] ** service:[0.0048200000000000005:99.99841%,-211.09762999999998:0.00053%,-211.73542999999998:0.00053%,-211.35747999999998:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.46337%,9:25.93158%,7:18.12224%,1:17.48069%,14:0.00053%,3:0.00053%,15:0.00035%,4:0.00035%,21:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1538 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7425 - tp: 51498.0000 - fp: 28502.0000 - tn: 291498.0000 - fn: 28502.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.7773 - val_loss: 5.7550 - val_tp: 12859.0000 - val_fp: 7141.0000 - val_tn: 72859.0000 - val_fn: 7141.0000 - val_accuracy: 0.8572 - val_precision: 0.6429 - val_recall: 0.6429 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-2-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.3602 - tp: 60050.0000 - fp: 19950.0000 - tn: 300050.0000 - fn: 19950.0000 - accuracy: 0.9003 - precision: 0.7506 - recall: 0.7506 - auc: 0.8788 - val_loss: 0.0115 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2533 - tp: 76201.0000 - fp: 3799.0000 - tn: 316201.0000 - fn: 3799.0000 - accuracy: 0.9810 - precision: 0.9525 - recall: 0.9525 - auc: 0.9763 - val_loss: 0.0019 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1290 - tp: 77772.0000 - fp: 2228.0000 - tn: 317772.0000 - fn: 2228.0000 - accuracy: 0.9889 - precision: 0.9722 - recall: 0.9722 - auc: 0.9978 - val_loss: 1.3213e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0789 - tp: 78729.0000 - fp: 1271.0000 - tn: 318729.0000 - fn: 1271.0000 - accuracy: 0.9936 - precision: 0.9841 - recall: 0.9841 - auc: 0.9993 - val_loss: 4.9459e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/566591
[33m[INFO] loading file 27-27/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (506721, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (506721, 17)

[INFO] analyzing data
[INFO] 506721 rows
[INFO] ** appi_name:[21:99.99941%,30:0.00059%]
[INFO] ** classification:[normal:64.35849%,Single Stage Single Point:35.64151%]
[INFO] ** dst:[21:43.28773%,10:21.06899%,8:18.17154%,9:17.47017%,22:0.00079%,15:0.00059%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name:[2:99.99941%,3:0.00059%]
[INFO] ** modbus_function_code:[0.02961:99.99941%,-33.760870000000004:0.00059%]
[INFO] ** modbus_function_description:[7:50.0003%,11:49.99911%,0:0.00059%]
[INFO] ** modbus_transaction_id:65536 (12.93335%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99941%,1:0.00059%]
[INFO] ** proxy_src_ip:[18:38.42627%,20:25.93104%,13:18.17134%,6:17.47036%,17:0.00059%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.93044%,-0.32151:21.06899%,-1.27613:18.17114%,-0.23351:17.46997%,-0.33484:17.35728%,-71.33197:0.00059%,-1.02014:0.00039%,-1.27347:0.0002%,1.45709:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-0.24151:0.0002%]
[INFO] ** scada_tag:[3:25.93005%,1:21.06879%,5:18.17095%,4:17.46977%,2:17.35709%,0:0.00335%]
[INFO] ** service:[0.0048200000000000005:99.99941%,-211.73542999999998:0.00059%]
[INFO] ** src:[22:38.42627%,9:25.93104%,7:18.17134%,1:17.47036%,14:0.00059%,15:0.00039%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1376 (0.27155%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/506721
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0667 - tp: 78817.0000 - fp: 1183.0000 - tn: 318817.0000 - fn: 1183.0000 - accuracy: 0.9941 - precision: 0.9852 - recall: 0.9852 - auc: 0.9995 - val_loss: 8.2105e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/506721
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0585 - tp: 78928.0000 - fp: 1072.0000 - tn: 318928.0000 - fn: 1072.0000 - accuracy: 0.9946 - precision: 0.9866 - recall: 0.9866 - auc: 0.9996 - val_loss: 3.9102e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/506721
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0505 - tp: 79007.0000 - fp: 993.0000 - tn: 319007.0000 - fn: 993.0000 - accuracy: 0.9950 - precision: 0.9876 - recall: 0.9876 - auc: 0.9998 - val_loss: 2.5525e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/506721
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0458 - tp: 79080.0000 - fp: 920.0000 - tn: 319080.0000 - fn: 920.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9998 - val_loss: 1.5623e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/506721
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0410 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.3451e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-26-27-batch-400000-500000
[INFO] processing batch 500000-600000/506721
[33m[INFO] loading file 28-28/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (340637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (340637, 17)

[INFO] analyzing data
[INFO] 340637 rows
[INFO] ** appi_name:[21:99.99149%,30:0.00176%,17:0.00147%,22:0.00117%,7:0.00117%,31:0.00088%,26:0.00088%,28:0.00029%,27:0.00029%,8:0.00029%,0:0.00029%]
[INFO] ** classification:[normal:64.31421%,Single Stage Single Point:35.68579%]
[INFO] ** dst:[21:43.28714%,10:21.01856%,8:18.19796%,9:17.48753%,6:0.00235%,16:0.00205%,18:0.00147%,17:0.00059%,15:0.00059%,2:0.00059%,25:0.00029%,22:0.00029%,7:0.00029%,0:0.00029%]
[INFO] ** i/f_dir:[1:99.99941%,0:0.00059%]
[INFO] ** i/f_name:[2:99.99941%,3:0.00059%]
[INFO] ** modbus_function_code:[0.02961:99.99149%,-33.760870000000004:0.00851%]
[INFO] ** modbus_function_description:[11:49.99604%,7:49.99545%,0:0.00851%]
[INFO] ** modbus_transaction_id:65535 (19.23896%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99501%,2:0.0044%,1:0.00059%]
[INFO] ** proxy_src_ip:[18:38.33935%,20:25.96635%,13:18.19826%,6:17.48753%,1:0.00235%,17:0.00176%,14:0.00176%,7:0.00147%,21:0.00088%,0:0.00029%]
[INFO] ** s_port:[1.45442:25.96606%,-0.32151:21.01856%,-1.27613:18.19796%,-0.23351:17.48724%,-0.33484:17.32078%,-71.14798:0.00117%,-71.14931:0.00117%,-71.33197:0.00059%,-0.08551:0.00059%,7.66617:0.00029%,-58.035180000000004:0.00029%,-1.2708:0.00029%,-64.19493:0.00029%,-5.1466400000000005:0.00029%,13.431270000000001:0.00029%,-0.24151:0.00029%,11.57001:0.00029%,14.4699:0.00029%,1.47576:0.00029%,14.191239999999999:0.00029%,-5.08665:0.00029%,10.192739999999999:0.00029%,-3.3787199999999995:0.00029%,6.1115699999999995:0.00029%,2.05573:0.00029%,-43.76509:0.00029%,2.52505:0.00029%,11.862:0.00029%,-58.032509999999995:0.00029%]
[INFO] ** scada_tag:[3:25.96606%,1:21.01856%,5:18.19796%,4:17.48694%,2:17.32078%,0:0.00969%]
[INFO] ** service:[0.0048200000000000005:99.99149%,-205.44247:0.00147%,-186.43601999999998:0.00147%,-211.09762999999998:0.00117%,-211.08346:0.00117%,-211.08818:0.00117%,-211.73542999999998:0.00059%,-186.44547:0.00029%,-183.8612:0.00029%,-185.9872:0.00029%,-211.35747999999998:0.00029%,-202.75898:0.00029%]
[INFO] ** src:[22:38.33935%,9:25.96635%,7:18.19826%,1:17.48753%,3:0.00264%,2:0.00176%,21:0.00147%,4:0.00117%,14:0.00059%,8:0.00059%,17:0.00029%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:926 (0.27184%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/340637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0387 - tp: 79145.0000 - fp: 855.0000 - tn: 319145.0000 - fn: 855.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9998 - val_loss: 8.0603e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/340637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0384 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9998 - val_loss: 0.0019 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-2-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/340637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0356 - tp: 79089.0000 - fp: 911.0000 - tn: 319089.0000 - fn: 911.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 5.1136e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/340637
[33m[INFO] loading file 29-29/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540637, 17)

[INFO] analyzing data
[INFO] 540637 rows
[INFO] ** appi_name:[21:99.99889%,30:0.00055%,26:0.00018%,9:0.00018%,3:0.00018%]
[INFO] ** classification:[normal:64.39219%,Single Stage Single Point:35.60781%]
[INFO] ** dst:[21:43.32704%,10:21.06386%,8:18.14341%,9:17.46403%,22:0.00055%,15:0.00055%,24:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99945%,3:0.00055%]
[INFO] ** modbus_function_code:[0.02961:99.99889%,-33.760870000000004:0.00111%]
[INFO] ** modbus_function_description:[7:49.99972%,11:49.99917%,0:0.00111%]
[INFO] ** modbus_transaction_id:65536 (12.122%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99926%,1:0.00055%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.44058%,20:25.9505%,13:18.14378%,6:17.46384%,17:0.00055%,21:0.00018%,16:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.94994%,-0.32151:21.06367%,-1.27613:18.14341%,-0.23351:17.46384%,-0.33484:17.37691%,-71.33197:0.00055%,1.45709:0.00037%,-71.14798:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.94957%,1:21.06349%,5:18.14341%,4:17.46347%,2:17.37691%,0:0.00314%]
[INFO] ** service:[0.0048200000000000005:99.99908%,-211.73542999999998:0.00055%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.44058%,9:25.9505%,7:18.14378%,1:17.46384%,14:0.00055%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1468 (0.27153%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0301 - tp: 79169.0000 - fp: 831.0000 - tn: 319169.0000 - fn: 831.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 1.1964e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0306 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1930e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0297 - tp: 79065.0000 - fp: 935.0000 - tn: 319065.0000 - fn: 935.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1925e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0269 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.2036e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0263 - tp: 79073.0000 - fp: 927.0000 - tn: 319073.0000 - fn: 927.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/540637
[33m[INFO] loading file 30-30/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540637, 17)

[INFO] analyzing data
[INFO] 540637 rows
[INFO] ** appi_name:[21:99.9976%,30:0.00166%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.36925%,Single Stage Single Point:35.63075%]
[INFO] ** dst:[21:43.33684%,10:21.02945%,8:18.14489%,9:17.48548%,15:0.00166%,22:0.00074%,24:0.00037%,25:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99834%,0:0.00166%]
[INFO] ** i/f_name:[2:99.99834%,3:0.00166%]
[INFO] ** modbus_function_code:[0.02961:99.9976%,-33.760870000000004:0.0024%]
[INFO] ** modbus_function_description:[7:49.99972%,11:49.99787%,0:0.0024%]
[INFO] ** modbus_transaction_id:65536 (12.122%)
[INFO] ** orig:[0:99.99908%,2:0.00055%,1:0.00037%]
[INFO] ** proto:[0:99.99797%,1:0.00166%,2:0.00037%]
[INFO] ** proxy_src_ip:[18:38.36955%,20:25.99656%,13:18.14526%,6:17.48604%,17:0.00166%,7:0.00037%,16:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.99637%,-0.32151:21.02927%,-1.27613:18.14471%,-0.23351:17.4853%,-0.33484:17.34029%,-71.33197:0.00166%,-0.24151:0.00055%,-1.27347:0.00037%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.996%,1:21.02927%,5:18.14452%,4:17.48511%,2:17.3401%,0:0.00499%]
[INFO] ** service:[0.0048200000000000005:99.99778%,-211.73542999999998:0.00166%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.36955%,9:25.99656%,7:18.14526%,1:17.48604%,14:0.00111%,21:0.00092%,16:0.00018%,15:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99926%,1:0.00074%]
[INFO] ** unixtime:1470 (0.2719%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0238 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0229 - tp: 79157.0000 - fp: 843.0000 - tn: 319157.0000 - fn: 843.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0222 - tp: 79085.0000 - fp: 915.0000 - tn: 319085.0000 - fn: 915.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79141.0000 - fp: 859.0000 - tn: 319141.0000 - fn: 859.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 5.0171e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.6761e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/540637
[33m[INFO] loading file 31-31/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540637, 17)

[INFO] analyzing data
[INFO] 540637 rows
[INFO] ** appi_name:[21:99.99982%,26:0.00018%]
[INFO] ** classification:[normal:64.37869%,Single Stage Single Point:35.62131%]
[INFO] ** dst:[21:43.32093%,10:21.05646%,8:18.12492%,9:17.49621%,22:0.00092%,24:0.00037%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99982%,-33.760870000000004:0.00018%]
[INFO] ** modbus_function_description:[11:49.99991%,7:49.99991%,0:0.00018%]
[INFO] ** modbus_transaction_id:65536 (12.122%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.40081%,20:25.97732%,13:18.1251%,6:17.49621%,16:0.00037%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.97658%,-0.32151:21.05646%,-1.27613:18.12473%,-0.23351:17.49603%,-0.33484:17.34435%,-1.27347:0.00037%,1.45709:0.00037%,-1.02014:0.00037%,-71.14798:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.97621%,1:21.05627%,5:18.12455%,4:17.49584%,2:17.34417%,0:0.00296%]
[INFO] ** service:[0.0048200000000000005:99.99982%,-211.08346:0.00018%]
[INFO] ** src:[22:38.40081%,9:25.97732%,7:18.1251%,1:17.49621%,15:0.00037%,21:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1469 (0.27172%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79132.0000 - fp: 868.0000 - tn: 319132.0000 - fn: 868.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79076.0000 - fp: 924.0000 - tn: 319076.0000 - fn: 924.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79143.0000 - fp: 857.0000 - tn: 319143.0000 - fn: 857.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/540637
[33m[INFO] loading file 32-32/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540637, 17)

[INFO] analyzing data
[INFO] 540637 rows
[INFO] ** appi_name:[21:99.9963%,30:0.00314%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.37554%,Single Stage Single Point:35.62446%]
[INFO] ** dst:[21:43.31964%,10:21.05109%,8:18.16024%,9:17.46421%,15:0.00314%,22:0.00092%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99723%,0:0.00277%]
[INFO] ** i/f_name:[2:99.99686%,3:0.00314%]
[INFO] ** modbus_function_code:[0.02961:99.9963%,-33.760870000000004:0.0037%]
[INFO] ** modbus_function_description:[7:49.99917%,11:49.99713%,0:0.0037%]
[INFO] ** modbus_transaction_id:65536 (12.122%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9963%,1:0.00314%,2:0.00055%]
[INFO] ** proxy_src_ip:[18:38.41376%,20:25.95734%,13:18.16024%,6:17.46477%,17:0.00314%,14:0.00055%,16:0.00018%]
[INFO] ** s_port:[1.45442:25.95679%,-0.32151:21.05109%,-1.27613:18.15987%,-0.23351:17.46403%,-0.33484:17.36267%,-71.33197:0.00314%,-0.24151:0.00055%,-1.2708:0.00018%,-1.02014:0.00018%,13.431270000000001:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,1.45709:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:25.95642%,1:21.05091%,5:18.15987%,4:17.46366%,2:17.36267%,0:0.00647%]
[INFO] ** service:[0.0048200000000000005:99.9963%,-211.73542999999998:0.00314%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.41376%,9:25.95734%,7:18.16024%,1:17.46477%,14:0.00314%,2:0.00055%,15:0.00018%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1467 (0.27135%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79077.0000 - fp: 923.0000 - tn: 319077.0000 - fn: 923.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79068.0000 - fp: 932.0000 - tn: 319068.0000 - fn: 932.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0218 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9998 - val_loss: 0.0015 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-2-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79060.0000 - fp: 940.0000 - tn: 319060.0000 - fn: 940.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/540637
[33m[INFO] loading file 33-33/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540637, 17)

[INFO] analyzing data
[INFO] 540637 rows
[INFO] ** appi_name:[21:99.99686%,30:0.00111%,17:0.00074%,22:0.00055%,31:0.00018%,28:0.00018%,26:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.39811%,Single Stage Single Point:35.60189%]
[INFO] ** dst:[21:43.33185%,10:21.06127%,8:18.11474%,9:17.48715%,22:0.00148%,15:0.00111%,16:0.00074%,6:0.00074%,24:0.00037%,17:0.00037%,18:0.00018%]
[INFO] ** i/f_dir:[1:99.99889%,0:0.00111%]
[INFO] ** i/f_name:[2:99.99889%,3:0.00111%]
[INFO] ** modbus_function_code:[0.02961:99.99686%,-33.760870000000004:0.00314%]
[INFO] ** modbus_function_description:[7:49.99954%,11:49.99732%,0:0.00314%]
[INFO] ** modbus_transaction_id:65536 (12.122%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99797%,1:0.00111%,2:0.00092%]
[INFO] ** proxy_src_ip:[18:38.42449%,20:25.96955%,13:18.11474%,6:17.48733%,17:0.00111%,16:0.00074%,1:0.00074%,21:0.00037%,14:0.00037%,7:0.00037%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.96863%,-0.32151:21.06127%,-1.27613:18.11437%,-0.23351:17.48696%,-0.33484:17.36322%,-71.33197:0.00111%,-1.02014:0.00074%,1.45709:0.00055%,-71.14931:0.00055%,-1.27347:0.00037%,-5.08665:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,-43.76509:0.00018%,-71.14798:0.00018%,-58.032509999999995:0.00018%,-58.035180000000004:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:25.96826%,1:21.06127%,5:18.11419%,4:17.48678%,2:17.36322%,0:0.00629%]
[INFO] ** service:[0.0048200000000000005:99.99686%,-211.73542999999998:0.00111%,-205.44247:0.00074%,-211.08818:0.00055%,-211.09762999999998:0.00018%,-211.08346:0.00018%,-185.9872:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.42449%,9:25.96955%,7:18.11474%,1:17.48733%,14:0.00111%,15:0.00074%,3:0.00074%,21:0.00037%,4:0.00037%,2:0.00037%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1470 (0.2719%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79130.0000 - fp: 870.0000 - tn: 319130.0000 - fn: 870.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0214 - tp: 79072.0000 - fp: 928.0000 - tn: 319072.0000 - fn: 928.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 5.7111e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/540637
[33m[INFO] loading file 34-34/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (382070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (382070, 17)

[INFO] analyzing data
[INFO] 382070 rows
[INFO] ** appi_name:[21:99.99738%,30:0.00079%,7:0.00079%,31:0.00026%,22:0.00026%,8:0.00026%,6:0.00026%]
[INFO] ** classification:[normal:64.34109%,Single Stage Single Point:35.65891%]
[INFO] ** dst:[21:43.28107%,10:21.05687%,8:18.19954%,9:17.45937%,22:0.00079%,15:0.00079%,16:0.00052%,2:0.00052%,18:0.00026%,6:0.00026%]
[INFO] ** i/f_dir:[1:99.99921%,0:0.00079%]
[INFO] ** i/f_name:[2:99.99921%,3:0.00079%]
[INFO] ** modbus_function_code:[0.02961:99.99738%,-33.760870000000004:0.00262%]
[INFO] ** modbus_function_description:[7:49.99921%,11:49.99817%,0:0.00262%]
[INFO] ** modbus_transaction_id:65536 (17.15288%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99869%,1:0.00079%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.38852%,20:25.94943%,13:18.19954%,6:17.45989%,17:0.00079%,1:0.00079%,21:0.00052%,14:0.00026%,7:0.00026%]
[INFO] ** s_port:[1.45442:25.94917%,-0.32151:21.05661%,-1.27613:18.19954%,-0.23351:17.4591%,-0.33484:17.3319%,-0.24151:0.00079%,-71.33197:0.00079%,-3.0613900000000003:0.00026%,-3.3787199999999995:0.00026%,14.191239999999999:0.00026%,1.47576:0.00026%,11.57001:0.00026%,-49.275529999999996:0.00026%,-71.14931:0.00026%,7.66617:0.00026%]
[INFO] ** scada_tag:[3:25.94891%,1:21.05635%,5:18.19928%,4:17.45858%,2:17.3319%,0:0.00497%]
[INFO] ** service:[0.0048200000000000005:99.99764%,-211.09762999999998:0.00079%,-211.73542999999998:0.00079%,-186.43601999999998:0.00026%,-211.35747999999998:0.00026%,-211.08818:0.00026%]
[INFO] ** src:[22:38.38852%,9:25.94943%,7:18.19954%,1:17.45989%,14:0.00079%,3:0.00079%,4:0.00052%,21:0.00026%,2:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1038 (0.27168%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/382070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79139.0000 - fp: 861.0000 - tn: 319139.0000 - fn: 861.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/382070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/382070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 2.5336e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/382070
[33m[INFO] loading file 35-35/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.99897%,30:0.00103%]
[INFO] ** classification:[normal:64.36356%,Single Stage Single Point:35.63644%]
[INFO] ** dst:[21:43.32297%,10:21.03802%,8:18.16208%,9:17.4747%,22:0.0012%,15:0.00103%]
[INFO] ** i/f_dir:[1:99.99914%,0:0.00086%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99897%,-33.760870000000004:0.00103%]
[INFO] ** modbus_function_description:[7:50.00034%,11:49.99863%,0:0.00103%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99897%,1:0.00103%]
[INFO] ** proxy_src_ip:[18:38.39384%,20:25.96767%,13:18.16173%,6:17.47505%,17:0.00103%,16:0.00069%]
[INFO] ** s_port:[1.45442:25.96715%,-0.32151:21.03802%,-1.27613:18.16173%,-0.23351:17.47453%,-0.33484:17.35582%,-71.33197:0.00103%,-1.02014:0.00069%,-0.24151:0.00034%,1.45709:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.96681%,1:21.03802%,5:18.16156%,4:17.47419%,2:17.35582%,0:0.00361%]
[INFO] ** service:[0.0048200000000000005:99.99897%,-211.73542999999998:0.00103%]
[INFO] ** src:[22:38.39384%,9:25.96767%,7:18.16173%,1:17.47505%,14:0.00103%,15:0.00069%]
[INFO] ** type:[0:99.99914%,1:0.00086%]
[INFO] ** unixtime:1580 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.1734e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79083.0000 - fp: 917.0000 - tn: 319083.0000 - fn: 917.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79084.0000 - fp: 916.0000 - tn: 319084.0000 - fn: 916.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1922e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0196 - tp: 79170.0000 - fp: 830.0000 - tn: 319170.0000 - fn: 830.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 36-36/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.99863%,30:0.00069%,31:0.00034%,33:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.36391%,Single Stage Single Point:35.63609%]
[INFO] ** dst:[21:43.33121%,10:21.03046%,8:18.15039%,9:17.48553%,22:0.00086%,15:0.00069%,24:0.00034%,18:0.00034%,25:0.00017%]
[INFO] ** i/f_dir:[1:99.99931%,0:0.00069%]
[INFO] ** i/f_name:[2:99.99931%,3:0.00069%]
[INFO] ** modbus_function_code:[0.02961:99.99863%,-33.760870000000004:0.00137%]
[INFO] ** modbus_function_description:[7:50.00034%,11:49.99828%,0:0.00137%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9988%,1:0.00069%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.38284%,20:25.97901%,13:18.15057%,6:17.48604%,17:0.00069%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.97849%,-0.32151:21.03029%,-1.27613:18.15005%,-0.23351:17.48535%,-0.33484:17.35255%,-71.33197:0.00069%,-0.24151:0.00052%,-0.08551:0.00034%,-1.27347:0.00034%,1.45709:0.00017%,1.47576:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,-64.19493:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.97815%,1:21.03012%,5:18.14988%,4:17.48518%,2:17.35238%,0:0.0043%]
[INFO] ** service:[0.0048200000000000005:99.9988%,-211.73542999999998:0.00069%,-186.43601999999998:0.00034%,-186.44547:0.00017%]
[INFO] ** src:[22:38.38284%,9:25.97901%,7:18.15057%,1:17.48604%,14:0.00069%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1581 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0216 - tp: 79066.0000 - fp: 934.0000 - tn: 319066.0000 - fn: 934.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0214 - tp: 79085.0000 - fp: 915.0000 - tn: 319085.0000 - fn: 915.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-2-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79083.0000 - fp: 917.0000 - tn: 319083.0000 - fn: 917.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 6.0262e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 37-37/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.9988%,30:0.00069%,33:0.00017%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:64.37937%,Single Stage Single Point:35.62063%]
[INFO] ** dst:[21:43.33963%,10:21.03785%,8:18.13596%,9:17.48467%,22:0.00069%,15:0.00069%,24:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99931%,3:0.00069%]
[INFO] ** modbus_function_code:[0.02961:99.9988%,-33.760870000000004:0.0012%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99863%,0:0.0012%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99914%,1:0.00069%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.38559%,20:25.99206%,13:18.13596%,6:17.48484%,17:0.00069%,21:0.00034%,16:0.00034%,1:0.00017%]
[INFO] ** s_port:[1.45442:25.99155%,-0.32151:21.03768%,-1.27613:18.13562%,-0.23351:17.48449%,-0.33484:17.34791%,-71.33197:0.00069%,-1.02014:0.00034%,1.46509:0.00017%,1.47576:0.00017%,-1.27347:0.00017%,-49.275529999999996:0.00017%,-0.24950999999999998:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,1.45709:0.00017%,14.4699:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:25.99138%,1:21.03768%,5:18.13545%,4:17.48432%,2:17.34774%,0:0.00344%]
[INFO] ** service:[0.0048200000000000005:99.99897%,-211.73542999999998:0.00069%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.38559%,9:25.99206%,7:18.13596%,1:17.48484%,14:0.00069%,15:0.00034%,4:0.00034%,3:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1581 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79147.0000 - fp: 853.0000 - tn: 319147.0000 - fn: 853.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79123.0000 - fp: 877.0000 - tn: 319123.0000 - fn: 877.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 9.0311e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79132.0000 - fp: 868.0000 - tn: 319132.0000 - fn: 868.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 38-38/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.99897%,30:0.00034%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.4072%,Single Stage Single Point:35.5928%]
[INFO] ** dst:[21:43.32211%,10:21.08303%,8:18.09851%,9:17.49446%,22:0.00086%,15:0.00034%,25:0.00017%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.99966%,3:0.00034%]
[INFO] ** modbus_function_code:[0.02961:99.99897%,-33.760870000000004:0.00103%]
[INFO] ** modbus_function_description:[11:49.99948%,7:49.99948%,0:0.00103%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99931%,2:0.00034%,1:0.00034%]
[INFO] ** proxy_src_ip:[18:38.44469%,20:25.96097%,13:18.09834%,6:17.4948%,17:0.00034%,7:0.00034%,16:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.96028%,-0.32151:21.08286%,-1.27613:18.09817%,-0.23351:17.49429%,-0.33484:17.36183%,-0.24151:0.00034%,-71.33197:0.00034%,1.45709:0.00034%,1.47576:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-61.95768:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:25.95994%,1:21.08286%,5:18.09817%,4:17.49412%,2:17.36183%,0:0.00309%]
[INFO] ** service:[0.0048200000000000005:99.99914%,-211.73542999999998:0.00034%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.44469%,9:25.96097%,7:18.09834%,1:17.4948%,21:0.00034%,14:0.00034%,16:0.00017%,15:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1582 (0.27179%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79064.0000 - fp: 936.0000 - tn: 319064.0000 - fn: 936.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79156.0000 - fp: 844.0000 - tn: 319156.0000 - fn: 844.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 39-39/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.99966%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.39672%,Single Stage Single Point:35.60328%]
[INFO] ** dst:[21:43.31558%,10:21.07994%,8:18.13871%,9:17.46439%,22:0.00086%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99966%,-33.760870000000004:0.00034%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99966%,0:0.00034%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.44125%,20:25.95461%,13:18.13888%,6:17.46439%,16:0.00052%,7:0.00034%]
[INFO] ** s_port:[1.45442:25.95409%,-0.32151:21.07994%,-1.27613:18.13854%,-0.23351:17.46422%,-0.33484:17.36131%,-1.02014:0.00052%,-71.14798:0.00017%,-1.27347:0.00017%,1.45709:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.95375%,1:21.07977%,5:18.13837%,4:17.46422%,2:17.36114%,0:0.00275%]
[INFO] ** service:[0.0048200000000000005:99.99966%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.44125%,9:25.95461%,7:18.13888%,1:17.46439%,15:0.00052%,21:0.00034%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1580 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79089.0000 - fp: 911.0000 - tn: 319089.0000 - fn: 911.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79123.0000 - fp: 877.0000 - tn: 319123.0000 - fn: 877.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 40-40/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.99656%,30:0.00292%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.33539%,Single Stage Single Point:35.66461%]
[INFO] ** dst:[21:43.29101%,10:21.03974%,8:18.19661%,9:17.46817%,15:0.00292%,22:0.00086%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99725%,0:0.00275%]
[INFO] ** i/f_name:[2:99.99708%,3:0.00292%]
[INFO] ** modbus_function_code:[0.02961:99.99656%,-33.760870000000004:0.00344%]
[INFO] ** modbus_function_description:[7:49.99931%,11:49.99725%,0:0.00344%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99656%,1:0.00292%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.35707%,20:25.97454%,13:18.19644%,6:17.46852%,17:0.00292%,14:0.00052%]
[INFO] ** s_port:[1.45442:25.97368%,-0.32151:21.03974%,-1.27613:18.19627%,-0.23351:17.468%,-0.33484:17.31733%,-71.33197:0.00292%,1.45709:0.00052%,-0.24151:0.00034%,-71.14798:0.00017%,-1.27347:0.00017%,11.862:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%,13.431270000000001:0.00017%]
[INFO] ** scada_tag:[3:25.97334%,1:21.03957%,5:18.19609%,4:17.46766%,2:17.31716%,0:0.00618%]
[INFO] ** service:[0.0048200000000000005:99.99656%,-211.73542999999998:0.00292%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.35707%,9:25.97454%,7:18.19644%,1:17.46852%,14:0.00292%,2:0.00052%]
[INFO] ** type:[0:99.99914%,1:0.00086%]
[INFO] ** unixtime:1583 (0.27196%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79055.0000 - fp: 945.0000 - tn: 319055.0000 - fn: 945.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0216 - tp: 79047.0000 - fp: 953.0000 - tn: 319047.0000 - fn: 953.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9999 - val_loss: 7.4360e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79071.0000 - fp: 929.0000 - tn: 319071.0000 - fn: 929.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 41-41/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (522228, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (522228, 17)

[INFO] analyzing data
[INFO] 522228 rows
[INFO] ** appi_name:[21:99.99674%,30:0.00096%,22:0.00077%,17:0.00077%,32:0.00019%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.38778%,Single Stage Single Point:35.61222%]
[INFO] ** dst:[21:43.32724%,10:21.05651%,8:18.14284%,9:17.46919%,16:0.00096%,15:0.00096%,6:0.00096%,22:0.00057%,24:0.00038%,17:0.00038%]
[INFO] ** i/f_dir:[1:99.99904%,0:0.00096%]
[INFO] ** i/f_name:[2:99.99904%,3:0.00096%]
[INFO] ** modbus_function_code:[0.02961:99.99674%,-33.760870000000004:0.00326%]
[INFO] ** modbus_function_description:[7:49.99923%,11:49.99751%,0:0.00326%]
[INFO] ** modbus_transaction_id:65536 (12.54931%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99789%,2:0.00115%,1:0.00096%]
[INFO] ** proxy_src_ip:[18:38.42843%,20:25.95552%,13:18.14303%,6:17.46938%,17:0.00096%,1:0.00077%,21:0.00038%,16:0.00038%,14:0.00038%,0:0.00038%,7:0.00019%,2:0.00019%]
[INFO] ** s_port:[1.45442:25.95514%,-0.32151:21.05651%,-1.27613:18.14246%,-0.23351:17.469%,-0.33484:17.37191%,-71.33197:0.00096%,-71.14931:0.00077%,-1.02014:0.00038%,-1.27347:0.00038%,-71.14798:0.00019%,-0.24151:0.00019%,-58.035180000000004:0.00019%,-1.2708:0.00019%,-5.1466400000000005:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-64.19226:0.00019%,-5.08665:0.00019%,-0.24950999999999998:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.95495%,1:21.05651%,5:18.14246%,4:17.46881%,2:17.37172%,0:0.00555%]
[INFO] ** service:[0.0048200000000000005:99.99674%,-211.73542999999998:0.00096%,-205.44247:0.00077%,-211.08818:0.00077%,89.64175:0.00019%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.42843%,9:25.95552%,7:18.14303%,1:17.46938%,14:0.00096%,3:0.00077%,15:0.00038%,8:0.00038%,4:0.00038%,2:0.00038%,21:0.00019%,17:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1417 (0.27134%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/522228
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 2.6967e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/522228
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/522228
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/522228
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 8.5198e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/522228
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-40-41-batch-400000-500000
[INFO] processing batch 500000-600000/522228
[33m[INFO] loading file 42-42/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (365742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (365742, 17)

[INFO] analyzing data
[INFO] 365742 rows
[INFO] ** appi_name:[21:99.9907%,30:0.00246%,17:0.00137%,31:0.00109%,26:0.00109%,7:0.00109%,22:0.00082%,28:0.00027%,27:0.00027%,9:0.00027%,8:0.00027%,0:0.00027%]
[INFO] ** classification:[normal:64.34809%,Single Stage Single Point:35.65191%]
[INFO] ** dst:[21:43.30102%,10:21.03723%,8:18.19643%,9:17.4552%,16:0.00246%,6:0.00219%,18:0.00137%,2:0.00109%,22:0.00082%,15:0.00082%,17:0.00055%,25:0.00027%,7:0.00027%,0:0.00027%]
[INFO] ** i/f_dir:[1:99.99918%,0:0.00082%]
[INFO] ** i/f_name:[2:99.99918%,3:0.00082%]
[INFO] ** modbus_function_code:[0.02961:99.9907%,-33.760870000000004:0.0093%]
[INFO] ** modbus_function_description:[7:49.9959%,11:49.99481%,0:0.0093%]
[INFO] ** modbus_transaction_id:65536 (17.91864%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99508%,2:0.0041%,1:0.00082%]
[INFO] ** proxy_src_ip:[18:38.38881%,20:25.94971%,13:18.19671%,6:17.4552%,17:0.00246%,1:0.00246%,14:0.00164%,21:0.00109%,7:0.00082%,0:0.00055%,16:0.00027%,2:0.00027%]
[INFO] ** s_port:[1.45442:25.94917%,-0.32151:21.03723%,-1.27613:18.19643%,-0.23351:17.45493%,-0.33484:17.35158%,-71.14931:0.00109%,-71.14798:0.00109%,-71.33197:0.00082%,-3.3787199999999995:0.00055%,-0.08551:0.00055%,11.57001:0.00055%,13.431270000000001:0.00027%,-5.1466400000000005:0.00027%,0.31847:0.00027%,-1.02014:0.00027%,-64.19493:0.00027%,-1.2708:0.00027%,-58.035180000000004:0.00027%,7.66617:0.00027%,-0.24151:0.00027%,1.47576:0.00027%,14.4699:0.00027%,15.912510000000001:0.00027%,14.191239999999999:0.00027%,7.9608300000000005:0.00027%,-5.08665:0.00027%,10.192739999999999:0.00027%,-3.0613900000000003:0.00027%,1.45709:0.00027%,2.05573:0.00027%,-43.76509:0.00027%,11.862:0.00027%,-58.032509999999995:0.00027%]
[INFO] ** scada_tag:[3:25.94889%,1:21.03723%,5:18.19616%,4:17.45493%,2:17.3513%,0:0.01148%]
[INFO] ** service:[0.0048200000000000005:99.9907%,-211.09762999999998:0.00191%,-205.44247:0.00137%,-186.43601999999998:0.00137%,-211.08346:0.00109%,-211.08818:0.00109%,-211.73542999999998:0.00082%,-211.35747999999998:0.00055%,-186.44547:0.00027%,-183.8612:0.00027%,-185.9872:0.00027%,-202.75898:0.00027%]
[INFO] ** src:[22:38.38881%,9:25.94971%,7:18.19671%,1:17.4552%,3:0.00328%,2:0.00191%,4:0.00137%,21:0.00109%,14:0.00082%,8:0.00055%,17:0.00027%,15:0.00027%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:993 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/365742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79153.0000 - fp: 847.0000 - tn: 319153.0000 - fn: 847.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.0081e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/365742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79083.0000 - fp: 917.0000 - tn: 319083.0000 - fn: 917.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.3680e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/365742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 9.1617e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/365742
[33m[INFO] loading file 43-43/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99894%,30:0.00053%,26:0.00018%,8:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.39844%,Single Stage Single Point:35.60156%]
[INFO] ** dst:[21:43.32646%,10:21.06985%,8:18.13123%,9:17.47015%,22:0.00106%,15:0.00053%,2:0.00035%,24:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99982%,0:0.00018%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99894%,-33.760870000000004:0.00106%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99894%,0:0.00106%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99929%,1:0.00053%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.41804%,20:25.9788%,13:18.13141%,6:17.47033%,17:0.00053%,1:0.00053%,16:0.00035%]
[INFO] ** s_port:[1.45442:25.9781%,-0.32151:21.06985%,-1.27613:18.13106%,-0.23351:17.4698%,-0.33484:17.34819%,-71.33197:0.00053%,1.45709:0.00035%,1.47576:0.00035%,-0.24151:0.00035%,-1.02014:0.00035%,0.31847:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-1.2708:0.00018%,-3.3787199999999995:0.00018%]
[INFO] ** scada_tag:[3:25.97774%,1:21.06985%,5:18.13088%,4:17.46945%,2:17.34801%,0:0.00407%]
[INFO] ** service:[0.0048200000000000005:99.99894%,-211.73542999999998:0.00053%,-211.09762999999998:0.00018%,-211.08346:0.00018%,-211.35747999999998:0.00018%]
[INFO] ** src:[22:38.41804%,9:25.9788%,7:18.13141%,1:17.47033%,14:0.00053%,3:0.00053%,15:0.00035%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1538 (0.27186%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79084.0000 - fp: 916.0000 - tn: 319084.0000 - fn: 916.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79132.0000 - fp: 868.0000 - tn: 319132.0000 - fn: 868.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 44-44/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99823%,30:0.00071%,31:0.00053%,0:0.00035%,22:0.00018%]
[INFO] ** classification:[normal:64.3926%,Single Stage Single Point:35.6074%]
[INFO] ** dst:[21:43.33619%,10:21.05341%,8:18.15121%,9:17.45601%,22:0.00106%,15:0.00071%,18:0.00053%,25:0.00035%,24:0.00035%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99929%,0:0.00071%]
[INFO] ** i/f_name:[2:99.99929%,3:0.00071%]
[INFO] ** modbus_function_code:[0.02961:99.99823%,-33.760870000000004:0.00177%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99806%,0:0.00177%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99823%,2:0.00106%,1:0.00071%]
[INFO] ** proxy_src_ip:[18:38.43554%,20:25.95459%,13:18.15138%,6:17.45654%,17:0.00071%,7:0.00035%,16:0.00018%,5:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95388%,-0.32151:21.05341%,-1.27613:18.15085%,-0.23351:17.45584%,-0.33484:17.38213%,-71.33197:0.00071%,-0.24151:0.00053%,-0.08551:0.00035%,-64.19493:0.00035%,-1.27347:0.00035%,1.45709:0.00035%,-1.02014:0.00018%,-1.2708:0.00018%,1.47576:0.00018%,-71.14931:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,4.42897:0.00018%]
[INFO] ** scada_tag:[3:25.95335%,1:21.05341%,5:18.15085%,4:17.45548%,2:17.38195%,0:0.00495%]
[INFO] ** service:[0.0048200000000000005:99.99823%,-211.73542999999998:0.00071%,-186.43601999999998:0.00053%,-186.44547:0.00035%,-211.08818:0.00018%]
[INFO] ** src:[22:38.43554%,9:25.95459%,7:18.15138%,1:17.45654%,14:0.00071%,21:0.00035%,17:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1535 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.2233e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79064.0000 - fp: 936.0000 - tn: 319064.0000 - fn: 936.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79077.0000 - fp: 923.0000 - tn: 319077.0000 - fn: 923.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79089.0000 - fp: 911.0000 - tn: 319089.0000 - fn: 911.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 45-45/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99876%,30:0.00053%,31:0.00035%,26:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:64.41912%,Single Stage Single Point:35.58088%]
[INFO] ** dst:[21:43.32646%,10:21.08983%,8:18.12505%,9:17.45601%,22:0.00141%,15:0.00053%,18:0.00035%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99965%,0:0.00035%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99876%,-33.760870000000004:0.00124%]
[INFO] ** modbus_function_description:[7:50.00035%,11:49.99841%,0:0.00124%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99894%,2:0.00053%,1:0.00053%]
[INFO] ** proxy_src_ip:[18:38.48645%,20:25.93055%,13:18.12487%,6:17.45654%,17:0.00053%,16:0.00035%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.92984%,-0.32151:21.08983%,-1.27613:18.12487%,-0.23351:17.45584%,-0.33484:17.39662%,1.45709:0.00053%,-0.24151:0.00053%,-71.33197:0.00053%,-1.02014:0.00035%,-0.08551:0.00035%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.92931%,1:21.08965%,5:18.12487%,4:17.45584%,2:17.39645%,0:0.00389%]
[INFO] ** service:[0.0048200000000000005:99.99876%,-211.73542999999998:0.00053%,-186.43601999999998:0.00035%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.48645%,9:25.93055%,7:18.12487%,1:17.45654%,14:0.00053%,15:0.00035%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1535 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79137.0000 - fp: 863.0000 - tn: 319137.0000 - fn: 863.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79088.0000 - fp: 912.0000 - tn: 319088.0000 - fn: 912.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 46-46/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99823%,30:0.00106%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.42336%,Single Stage Single Point:35.57664%]
[INFO] ** dst:[21:43.34538%,10:21.07533%,8:18.10348%,9:17.47316%,22:0.00106%,15:0.00106%,25:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99912%,0:0.00088%]
[INFO] ** i/f_name:[2:99.99894%,3:0.00106%]
[INFO] ** modbus_function_code:[0.02961:99.99823%,-33.760870000000004:0.00177%]
[INFO] ** modbus_function_description:[11:49.99929%,7:49.99894%,0:0.00177%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.99859%,1:0.00106%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.44668%,20:25.97403%,13:18.10348%,6:17.47369%,17:0.00106%,16:0.00035%,7:0.00035%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.97368%,-0.32151:21.07515%,-1.27613:18.10331%,-0.23351:17.47298%,-0.33484:17.37152%,-71.33197:0.00106%,-0.24151:0.00053%,-1.02014:0.00035%,-71.14798:0.00018%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.97332%,1:21.07498%,5:18.10313%,4:17.47263%,2:17.37152%,0:0.00442%]
[INFO] ** service:[0.0048200000000000005:99.99841%,-211.73542999999998:0.00106%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.44668%,9:25.97403%,7:18.10348%,1:17.47369%,14:0.00106%,21:0.00035%,15:0.00035%,16:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99912%,1:0.00088%]
[INFO] ** unixtime:1538 (0.27186%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79149.0000 - fp: 851.0000 - tn: 319149.0000 - fn: 851.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1945e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79139.0000 - fp: 861.0000 - tn: 319139.0000 - fn: 861.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.2199e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79144.0000 - fp: 856.0000 - tn: 319144.0000 - fn: 856.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79109.0000 - fp: 891.0000 - tn: 319109.0000 - fn: 891.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 47-47/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99947%,33:0.00018%,26:0.00018%,17:0.00018%]
[INFO] ** classification:[normal:64.39649%,Single Stage Single Point:35.60351%]
[INFO] ** dst:[21:43.31179%,10:21.08276%,8:18.12876%,9:17.4744%,22:0.00159%,24:0.00035%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99947%,-33.760870000000004:0.00053%]
[INFO] ** modbus_function_description:[7:50.00106%,11:49.99841%,0:0.00053%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.45392%,20:25.94133%,13:18.12911%,6:17.47475%,16:0.00035%,7:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.94045%,-0.32151:21.08276%,-1.27613:18.12858%,-0.23351:17.47422%,-0.33484:17.37117%,1.45709:0.00053%,-0.24151:0.00053%,-1.27347:0.00035%,-1.02014:0.00035%,-71.14798:0.00018%,-61.95635:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%]
[INFO] ** scada_tag:[3:25.93992%,1:21.08258%,5:18.1284%,4:17.47404%,2:17.37099%,0:0.00407%]
[INFO] ** service:[0.0048200000000000005:99.99965%,-211.08346:0.00018%,-205.44247:0.00018%]
[INFO] ** src:[22:38.45392%,9:25.94133%,7:18.12911%,1:17.47475%,21:0.00035%,15:0.00035%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1536 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79144.0000 - fp: 856.0000 - tn: 319144.0000 - fn: 856.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79137.0000 - fp: 863.0000 - tn: 319137.0000 - fn: 863.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79137.0000 - fp: 863.0000 - tn: 319137.0000 - fn: 863.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 48-48/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99682%,30:0.00247%,33:0.00018%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.43114%,Single Stage Single Point:35.56886%]
[INFO] ** dst:[21:43.3353%,10:21.09195%,8:18.09995%,9:17.46874%,15:0.00247%,22:0.00088%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99788%,0:0.00212%]
[INFO] ** i/f_name:[2:99.99753%,3:0.00247%]
[INFO] ** modbus_function_code:[0.02961:99.99682%,-33.760870000000004:0.00318%]
[INFO] ** modbus_function_description:[7:49.99912%,11:49.9977%,0:0.00318%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.997%,1:0.00247%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.46736%,20:25.96024%,13:18.10012%,6:17.46874%,17:0.00247%,14:0.00053%,16:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95971%,-0.32151:21.09195%,-1.27613:18.09977%,-0.23351:17.46856%,-0.33484:17.37541%,-71.33197:0.00247%,-1.02014:0.00035%,-1.2708:0.00018%,13.431270000000001:0.00018%,-0.24151:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-61.95635:0.00018%,1.45709:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:25.95936%,1:21.09177%,5:18.09977%,4:17.46856%,2:17.37523%,0:0.0053%]
[INFO] ** service:[0.0048200000000000005:99.997%,-211.73542999999998:0.00247%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.46736%,9:25.96024%,7:18.10012%,1:17.46874%,14:0.00247%,2:0.00053%,15:0.00035%,8:0.00018%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1535 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79136.0000 - fp: 864.0000 - tn: 319136.0000 - fn: 864.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0194 - tp: 79156.0000 - fp: 844.0000 - tn: 319156.0000 - fn: 844.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.8310e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79128.0000 - fp: 872.0000 - tn: 319128.0000 - fn: 872.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 49-49/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99735%,30:0.00088%,17:0.00071%,26:0.00035%,22:0.00035%,28:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.37493%,Single Stage Single Point:35.62507%]
[INFO] ** dst:[21:43.31338%,10:21.0573%,8:18.13441%,9:17.49048%,22:0.00141%,15:0.00088%,16:0.00071%,6:0.00071%,24:0.00035%,17:0.00035%]
[INFO] ** i/f_dir:[1:99.99912%,0:0.00088%]
[INFO] ** i/f_name:[2:99.99912%,3:0.00088%]
[INFO] ** modbus_function_code:[0.02961:99.99735%,-33.760870000000004:0.00265%]
[INFO] ** modbus_function_description:[7:49.99965%,11:49.9977%,0:0.00265%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99841%,1:0.00088%,2:0.00071%]
[INFO] ** proxy_src_ip:[18:38.42246%,20:25.94893%,13:18.13459%,6:17.49101%,17:0.00088%,1:0.00071%,14:0.00053%,21:0.00035%,16:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.94805%,-0.32151:21.0573%,-1.27613:18.13406%,-0.23351:17.4903%,-0.33484:17.36516%,-71.33197:0.00088%,1.45709:0.00053%,-0.24151:0.00053%,-1.27347:0.00035%,-71.14931:0.00035%,-1.02014:0.00035%,-71.14798:0.00035%,1.47576:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,1.46509:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,-5.08665:0.00018%,-0.24950999999999998:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:25.94769%,1:21.05712%,5:18.13388%,4:17.48995%,2:17.36516%,0:0.00619%]
[INFO] ** service:[0.0048200000000000005:99.99735%,-211.73542999999998:0.00088%,-205.44247:0.00071%,-211.08346:0.00035%,-211.08818:0.00035%,-211.09762999999998:0.00018%,-185.9872:0.00018%]
[INFO] ** src:[22:38.42246%,9:25.94893%,7:18.13459%,1:17.49101%,14:0.00088%,3:0.00071%,2:0.00053%,15:0.00035%,4:0.00035%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1536 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79142.0000 - fp: 858.0000 - tn: 319142.0000 - fn: 858.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79138.0000 - fp: 862.0000 - tn: 319138.0000 - fn: 862.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1925e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79166.0000 - fp: 834.0000 - tn: 319166.0000 - fn: 834.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 50-50/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (415724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (415724, 17)

[INFO] analyzing data
[INFO] 415724 rows
[INFO] ** appi_name:[21:99.99759%,30:0.00096%,7:0.00072%,31:0.00024%,22:0.00024%,8:0.00024%]
[INFO] ** classification:[normal:64.30733%,Single Stage Single Point:35.69267%]
[INFO] ** dst:[21:43.26139%,10:21.04281%,8:18.21834%,9:17.47409%,15:0.00096%,22:0.00072%,16:0.00048%,2:0.00048%,24:0.00024%,18:0.00024%,6:0.00024%]
[INFO] ** i/f_dir:[1:99.99904%,0:0.00096%]
[INFO] ** i/f_name:[2:99.99904%,3:0.00096%]
[INFO] ** modbus_function_code:[0.02961:99.99759%,-33.760870000000004:0.00241%]
[INFO] ** modbus_function_description:[11:49.9988%,7:49.9988%,0:0.00241%]
[INFO] ** modbus_transaction_id:65536 (15.76431%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99856%,1:0.00096%,2:0.00048%]
[INFO] ** proxy_src_ip:[18:38.3656%,20:25.93884%,13:18.21858%,6:17.47409%,17:0.00096%,1:0.00072%,16:0.00048%,21:0.00024%,14:0.00024%,7:0.00024%]
[INFO] ** s_port:[1.45442:25.93836%,-0.32151:21.04281%,-1.27613:18.2181%,-0.23351:17.47409%,-0.33484:17.32279%,-71.33197:0.00096%,-1.02014:0.00048%,-3.3787199999999995:0.00024%,4.33564:0.00024%,15.912510000000001:0.00024%,7.9608300000000005:0.00024%,1.46509:0.00024%,1.45709:0.00024%,-1.27347:0.00024%,-71.14931:0.00024%,-1.2708:0.00024%,0.31847:0.00024%]
[INFO] ** scada_tag:[3:25.93812%,1:21.04257%,5:18.21786%,4:17.47409%,2:17.32255%,0:0.00481%]
[INFO] ** service:[0.0048200000000000005:99.99759%,-211.73542999999998:0.00096%,-211.09762999999998:0.00072%,-186.43601999999998:0.00024%,-211.35747999999998:0.00024%,-211.08818:0.00024%]
[INFO] ** src:[22:38.3656%,9:25.93884%,7:18.21858%,1:17.47409%,14:0.00096%,3:0.00072%,15:0.00048%,21:0.00024%,4:0.00024%,2:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1130 (0.27181%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/415724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0214 - tp: 79066.0000 - fp: 934.0000 - tn: 319066.0000 - fn: 934.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 2.2928e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/415724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79091.0000 - fp: 909.0000 - tn: 319091.0000 - fn: 909.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/415724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79077.0000 - fp: 923.0000 - tn: 319077.0000 - fn: 923.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/415724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-49-50-batch-300000-400000
[INFO] processing batch 400000-500000/415724
[33m[INFO] epoch 3/10[0m
[33m[INFO] loading file 1-1/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99302%,30:0.00116%,22:0.00097%,17:0.00078%,31:0.00058%,26:0.00058%,7:0.00058%,23:0.00039%,18:0.00039%,0:0.00039%,28:0.00019%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:78.84217%,Single Stage Single Point:21.15783%]
[INFO] ** dst:[21:43.26578%,10:21.04381%,8:18.16766%,9:17.51538%,6:0.00155%,16:0.00116%,15:0.00116%,22:0.00097%,18:0.00058%,26:0.00039%,25:0.00039%,19:0.00039%,17:0.00039%,24:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99884%,0:0.00116%]
[INFO] ** i/f_name:[2:99.99884%,3:0.00116%]
[INFO] ** modbus_function_code:[0.02961:99.99302%,-33.760870000000004:0.00679%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99748%,11:49.99554%,0:0.00679%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99612%,2:0.00271%,1:0.00116%]
[INFO] ** proxy_src_ip:[18:38.40523%,20:25.90378%,13:18.16786%,6:17.51576%,11:0.00136%,10:0.00136%,17:0.00116%,14:0.00097%,1:0.00097%,7:0.00058%,21:0.00039%,16:0.00039%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.90339%,-0.32151:21.04304%,-1.27613:18.16747%,-0.23351:17.51518%,-0.33484:17.36219%,-71.33197:0.00116%,-71.14931:0.00097%,-2.1481:0.00078%,-0.24151:0.00058%,-71.14798:0.00058%,-2.42942:0.00039%,4.44364:0.00039%,-1.02014:0.00039%,-64.19493:0.00039%,-5.1466400000000005:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,4.076980000000001:0.00019%,-5.08665:0.00019%,1.47576:0.00019%,1.46509:0.00019%,4.29964:0.00019%,14.253910000000001:0.00019%,-68.79874000000001:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,10.67005:0.00019%,-1.27347:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.9032%,1:21.04284%,5:18.16708%,4:17.51499%,2:17.362%,0:0.00989%]
[INFO] ** service:[0.0048200000000000005:99.9938%,-211.73542999999998:0.00116%,-211.08818:0.00097%,-205.44247:0.00078%,-211.07873999999998:0.00078%,-211.09762999999998:0.00058%,-211.08346:0.00058%,-186.43601999999998:0.00058%,-186.44547:0.00039%,-185.9872:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.40523%,9:25.90378%,7:18.16786%,1:17.51576%,11:0.00136%,10:0.00136%,14:0.00116%,3:0.00097%,2:0.00097%,21:0.00058%,15:0.00039%,4:0.00039%,8:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1400 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8581 - tp: 73683.0000 - fp: 6317.0000 - tn: 313683.0000 - fn: 6317.0000 - accuracy: 0.9684 - precision: 0.9210 - recall: 0.9210 - auc: 0.9625 - val_loss: 5.7165e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0162 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5117e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0099 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7700 - val_tp: 17757.0000 - val_fp: 2243.0000 - val_tn: 77757.0000 - val_fn: 2243.0000 - val_accuracy: 0.9551 - val_precision: 0.8878 - val_recall: 0.8878 - val_auc: 0.9299
[INFO] saving weights to checkpoints/lstm-epoch-3-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4470 - tp: 42056.0000 - fp: 37944.0000 - tn: 282056.0000 - fn: 37944.0000 - accuracy: 0.8103 - precision: 0.5257 - recall: 0.5257 - auc: 0.8610 - val_loss: 0.6713 - val_tp: 10662.0000 - val_fp: 9338.0000 - val_tn: 70662.0000 - val_fn: 9338.0000 - val_accuracy: 0.8132 - val_precision: 0.5331 - val_recall: 0.5331 - val_auc: 0.8831
[INFO] saving weights to checkpoints/lstm-epoch-3-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6767 - tp: 43337.0000 - fp: 36663.0000 - tn: 283337.0000 - fn: 36663.0000 - accuracy: 0.8167 - precision: 0.5417 - recall: 0.5417 - auc: 0.8895 - val_loss: 0.6653 - val_tp: 11248.0000 - val_fp: 8752.0000 - val_tn: 71248.0000 - val_fn: 8752.0000 - val_accuracy: 0.8250 - val_precision: 0.5624 - val_recall: 0.5624 - val_auc: 0.8968
[INFO] saving weights to checkpoints/lstm-epoch-3-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 2-2/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99864%,7:0.00058%,30:0.00039%,31:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:72.18764%,Single Stage Single Point:27.81236%]
[INFO] ** dst:[21:43.31348%,10:21.03199%,8:18.13606%,9:17.51615%,22:0.00078%,16:0.00039%,15:0.00039%,2:0.00039%,24:0.00019%,18:0.00019%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99961%,3:0.00039%]
[INFO] ** modbus_function_code:[0.02961:99.99864%,-33.760870000000004:0.00136%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99884%,0:0.00136%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99942%,1:0.00039%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.38545%,20:25.96059%,13:18.13606%,6:17.51635%,1:0.00058%,17:0.00039%,16:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.95982%,-0.32151:21.03199%,-1.27613:18.13567%,-0.23351:17.51596%,-0.33484:17.35347%,-71.33197:0.00039%,1.45709:0.00039%,12.60597:0.00019%,-1.2708:0.00019%,-1.02014:0.00019%,-0.24151:0.00019%,4.076980000000001:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-1.27347:0.00019%,-3.3787199999999995:0.00019%,-0.24950999999999998:0.00019%,10.67005:0.00019%,4.29964:0.00019%]
[INFO] ** scada_tag:[3:25.95943%,1:21.03199%,5:18.13567%,4:17.51576%,2:17.35327%,0:0.00388%]
[INFO] ** service:[0.0048200000000000005:99.99864%,-211.09762999999998:0.00058%,-211.73542999999998:0.00039%,-186.43601999999998:0.00019%,-211.35747999999998:0.00019%]
[INFO] ** src:[22:38.38545%,9:25.96059%,7:18.13606%,1:17.51635%,3:0.00058%,14:0.00039%,21:0.00019%,15:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1403 (0.27204%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6712 - tp: 43595.0000 - fp: 36405.0000 - tn: 283595.0000 - fn: 36405.0000 - accuracy: 0.8180 - precision: 0.5449 - recall: 0.5449 - auc: 0.8895 - val_loss: 0.6624 - val_tp: 11204.0000 - val_fp: 8796.0000 - val_tn: 71204.0000 - val_fn: 8796.0000 - val_accuracy: 0.8241 - val_precision: 0.5602 - val_recall: 0.5602 - val_auc: 0.8971
[INFO] saving weights to checkpoints/lstm-epoch-3-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5782 - tp: 59999.0000 - fp: 20001.0000 - tn: 299999.0000 - fn: 20001.0000 - accuracy: 0.9000 - precision: 0.7500 - recall: 0.7500 - auc: 0.9401 - val_loss: 0.3318 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2069 - tp: 79803.0000 - fp: 197.0000 - tn: 319803.0000 - fn: 197.0000 - accuracy: 0.9990 - precision: 0.9975 - recall: 0.9975 - auc: 0.9994 - val_loss: 1.3511 - val_tp: 10613.0000 - val_fp: 9387.0000 - val_tn: 70613.0000 - val_fn: 9387.0000 - val_accuracy: 0.8123 - val_precision: 0.5307 - val_recall: 0.5307 - val_auc: 0.8737
[INFO] saving weights to checkpoints/lstm-epoch-3-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8577 - tp: 42849.0000 - fp: 37151.0000 - tn: 282849.0000 - fn: 37151.0000 - accuracy: 0.8142 - precision: 0.5356 - recall: 0.5356 - auc: 0.8871 - val_loss: 0.6853 - val_tp: 11179.0000 - val_fp: 8821.0000 - val_tn: 71179.0000 - val_fn: 8821.0000 - val_accuracy: 0.8236 - val_precision: 0.5590 - val_recall: 0.5590 - val_auc: 0.8908
[INFO] saving weights to checkpoints/lstm-epoch-3-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5569 - tp: 59719.0000 - fp: 20281.0000 - tn: 299719.0000 - fn: 20281.0000 - accuracy: 0.8986 - precision: 0.7465 - recall: 0.7465 - auc: 0.9407 - val_loss: 0.3041 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 3-3/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99108%,30:0.00233%,22:0.00116%,31:0.00097%,26:0.00097%,17:0.00097%,7:0.00078%,27:0.00039%,0:0.00039%,28:0.00019%,23:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:87.11675%,Single Stage Single Point:12.88325%]
[INFO] ** dst:[21:43.30611%,10:21.08861%,8:18.1539%,9:17.4415%,6:0.00233%,15:0.00155%,18:0.00136%,16:0.00136%,22:0.00097%,2:0.00039%,7:0.00039%,25:0.00039%,17:0.00039%,12:0.00019%,24:0.00019%,19:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99845%,0:0.00155%]
[INFO] ** i/f_name:[2:99.99845%,3:0.00155%]
[INFO] ** modbus_function_code:[0.02961:99.99108%,-33.760870000000004:0.00873%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99632%,11:49.99476%,0:0.00873%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99884%,2:0.00116%]
[INFO] ** proto:[0:99.9938%,2:0.00465%,1:0.00155%]
[INFO] ** proxy_src_ip:[18:38.42036%,20:25.97475%,13:18.15409%,6:17.44189%,17:0.00233%,1:0.00155%,14:0.00136%,7:0.00097%,11:0.00078%,10:0.00078%,21:0.00058%,16:0.00019%,15:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97397%,-0.32151:21.08841%,-1.27613:18.15351%,-0.23351:17.44131%,-0.33484:17.33194%,-71.33197:0.00155%,-71.14798:0.00116%,-71.14931:0.00116%,-64.19493:0.00039%,-0.08551:0.00039%,1.45709:0.00039%,-0.24151:0.00039%,13.431270000000001:0.00019%,14.4699:0.00019%,4.076980000000001:0.00019%,-5.1466400000000005:0.00019%,-1.02014:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,12.60597:0.00019%,-5.08665:0.00019%,1.46509:0.00019%,-2.1481:0.00019%,-1.27347:0.00019%,10.67005:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,6.1115699999999995:0.00019%,4.44364:0.00019%,13.86459:0.00019%,4.29964:0.00019%,-0.24950999999999998:0.00019%,-3.3787199999999995:0.00019%,10.192739999999999:0.00019%,-68.79874000000001:0.00019%,14.253910000000001:0.00019%,4.90362:0.00019%,-68.36943000000001:0.00019%]
[INFO] ** scada_tag:[3:25.97358%,1:21.08822%,5:18.15331%,4:17.44111%,2:17.33175%,0:0.01202%]
[INFO] ** service:[0.0048200000000000005:99.99127%,-211.73542999999998:0.00155%,-186.43601999999998:0.00136%,-211.08346:0.00116%,-211.08818:0.00116%,-205.44247:0.00097%,-211.09762999999998:0.00078%,-186.44547:0.00039%,-202.75898:0.00039%,-183.8612:0.00019%,-185.9872:0.00019%,-201.23771000000002:0.00019%,-211.35747999999998:0.00019%,-211.07873999999998:0.00019%]
[INFO] ** src:[22:38.42036%,9:25.97475%,7:18.15409%,1:17.44189%,21:0.00213%,3:0.00175%,2:0.00136%,11:0.00078%,10:0.00078%,4:0.00078%,14:0.00039%,8:0.00039%,17:0.00019%,15:0.00019%,13:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1400 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6058 - tp: 52898.0000 - fp: 27102.0000 - tn: 292898.0000 - fn: 27102.0000 - accuracy: 0.8645 - precision: 0.6612 - recall: 0.6612 - auc: 0.9294 - val_loss: 0.5070 - val_tp: 10564.0000 - val_fp: 9436.0000 - val_tn: 70564.0000 - val_fn: 9436.0000 - val_accuracy: 0.8113 - val_precision: 0.5282 - val_recall: 0.5282 - val_auc: 0.9261
[INFO] saving weights to checkpoints/lstm-epoch-3-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4959 - tp: 53908.0000 - fp: 26092.0000 - tn: 293908.0000 - fn: 26092.0000 - accuracy: 0.8695 - precision: 0.6738 - recall: 0.6738 - auc: 0.9458 - val_loss: 0.4128 - val_tp: 16468.0000 - val_fp: 3532.0000 - val_tn: 76468.0000 - val_fn: 3532.0000 - val_accuracy: 0.9294 - val_precision: 0.8234 - val_recall: 0.8234 - val_auc: 0.9824
[INFO] saving weights to checkpoints/lstm-epoch-3-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1337 - tp: 79505.0000 - fp: 495.0000 - tn: 319505.0000 - fn: 495.0000 - accuracy: 0.9975 - precision: 0.9938 - recall: 0.9938 - auc: 0.9999 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0186 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7687e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0148 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4476e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 4-4/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99767%,30:0.00136%,31:0.00039%,33:0.00019%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:91.51096%,Single Stage Single Point:8.48904%]
[INFO] ** dst:[21:43.35517%,10:20.94143%,8:18.17174%,9:17.52817%,15:0.00136%,22:0.00116%,18:0.00039%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99884%,0:0.00116%]
[INFO] ** i/f_name:[2:99.99864%,3:0.00136%]
[INFO] ** modbus_function_code:[0.02961:99.99767%,-33.760870000000004:0.00233%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99787%,0:0.00233%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99884%,2:0.00116%]
[INFO] ** proto:[0:99.99806%,1:0.00136%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.25884%,20:26.03815%,13:18.17174%,6:17.52856%,17:0.00136%,21:0.00039%,16:0.00039%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.03738%,-0.32151:20.94124%,-1.27613:18.17135%,-0.23351:17.52798%,-0.33484:17.3176%,-71.33197:0.00136%,1.45709:0.00039%,-0.24151:0.00039%,-1.02014:0.00039%,-0.08551:0.00039%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,14.4699:0.00019%,-49.275529999999996:0.00019%,-1.2708:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:26.03718%,1:20.94105%,5:18.17135%,4:17.52759%,2:17.3174%,0:0.00543%]
[INFO] ** service:[0.0048200000000000005:99.99787%,-211.73542999999998:0.00136%,-186.43601999999998:0.00039%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.25884%,9:26.03815%,7:18.17174%,1:17.52856%,21:0.00116%,15:0.00039%,4:0.00039%,17:0.00019%,14:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1411 (0.2736%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0116 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2985e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0098 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7381e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0087 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9212e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0079 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.9927 - val_tp: 8906.0000 - val_fp: 11094.0000 - val_tn: 68906.0000 - val_fn: 11094.0000 - val_accuracy: 0.7781 - val_precision: 0.4453 - val_recall: 0.4453 - val_auc: 0.6533
[INFO] saving weights to checkpoints/lstm-epoch-3-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0278 - tp: 48883.0000 - fp: 31117.0000 - tn: 288883.0000 - fn: 31117.0000 - accuracy: 0.8444 - precision: 0.6110 - recall: 0.6110 - auc: 0.8918 - val_loss: 0.5392 - val_tp: 18103.0000 - val_fp: 1897.0000 - val_tn: 78103.0000 - val_fn: 1897.0000 - val_accuracy: 0.9621 - val_precision: 0.9051 - val_recall: 0.9051 - val_auc: 0.9924
[INFO] saving weights to checkpoints/lstm-epoch-3-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 5-5/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.9967%,30:0.00233%,37:0.00019%,26:0.00019%,12:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:89.07458%,Single Stage Single Point:10.92542%]
[INFO] ** dst:[21:43.36641%,10:20.76285%,8:18.24813%,9:17.61873%,15:0.00233%,22:0.00078%,25:0.00019%,24:0.00019%,6:0.00019%,2:0.00019%]
[INFO] ** i/f_dir:[1:99.99806%,0:0.00194%]
[INFO] ** i/f_name:[2:99.99767%,3:0.00233%]
[INFO] ** modbus_function_code:[0.02961:99.9967%,-33.760870000000004:0.0033%]
[INFO] ** modbus_function_description:[7:49.99884%,11:49.99787%,0:0.0033%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99825%,2:0.00175%]
[INFO] ** proto:[0:99.99729%,1:0.00233%,2:0.00039%]
[INFO] ** proxy_src_ip:[18:37.99416%,20:26.13491%,13:18.24833%,6:17.61911%,17:0.00233%,21:0.00019%,16:0.00019%,7:0.00019%,5:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.13472%,-0.32151:20.76246%,-1.27613:18.24813%,-0.23351:17.61873%,-0.33484:17.2317%,-71.33197:0.00233%,-0.24151:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,1.45709:0.00019%,2.22906:0.00019%,-49.275529999999996:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:26.13433%,1:20.76227%,5:18.24794%,4:17.61873%,2:17.2317%,0:0.00504%]
[INFO] ** service:[0.0048200000000000005:99.99709%,-211.73542999999998:0.00233%,-186.44547:0.00019%,-211.08346:0.00019%,-211.35747999999998:0.00019%]
[INFO] ** src:[22:37.99416%,9:26.13491%,7:18.24833%,1:17.61911%,21:0.00194%,14:0.00058%,16:0.00019%,15:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1409 (0.27321%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4072 - tp: 67767.0000 - fp: 12233.0000 - tn: 307767.0000 - fn: 12233.0000 - accuracy: 0.9388 - precision: 0.8471 - recall: 0.8471 - auc: 0.9712 - val_loss: 0.6363 - val_tp: 13150.0000 - val_fp: 6850.0000 - val_tn: 73150.0000 - val_fn: 6850.0000 - val_accuracy: 0.8630 - val_precision: 0.6575 - val_recall: 0.6575 - val_auc: 0.9386
[INFO] saving weights to checkpoints/lstm-epoch-3-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3270 - tp: 68407.0000 - fp: 11593.0000 - tn: 308407.0000 - fn: 11593.0000 - accuracy: 0.9420 - precision: 0.8551 - recall: 0.8551 - auc: 0.9839 - val_loss: 0.0297 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-3-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1680 - tp: 77658.0000 - fp: 2342.0000 - tn: 317658.0000 - fn: 2342.0000 - accuracy: 0.9883 - precision: 0.9707 - recall: 0.9707 - auc: 0.9910 - val_loss: 0.0149 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0125 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3354e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 6-6/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99554%,30:0.00349%,31:0.00019%,27:0.00019%,26:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:92.16538%,Single Stage Single Point:7.83462%]
[INFO] ** dst:[21:43.37708%,10:20.7295%,8:18.28517%,9:17.60321%,15:0.00349%,22:0.00039%,25:0.00019%,24:0.00019%,18:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.9967%,0:0.0033%]
[INFO] ** i/f_name:[2:99.99651%,3:0.00349%]
[INFO] ** modbus_function_code:[0.02961:99.99554%,-33.760870000000004:0.00446%]
[INFO] ** modbus_function_description:[7:49.99845%,11:49.99709%,0:0.00446%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.99554%,1:0.00349%,2:0.00097%]
[INFO] ** proxy_src_ip:[18:37.94665%,20:26.16012%,13:18.28536%,6:17.60341%,17:0.00349%,14:0.00058%,16:0.00019%,11:0.00019%]
[INFO] ** s_port:[1.45442:26.15973%,-0.32151:20.7295%,-1.27613:18.28478%,-0.23351:17.60302%,-0.33484:17.21715%,-71.33197:0.00349%,-0.24151:0.00019%,-1.2708:0.00019%,-64.19493:0.00019%,-1.02014:0.00019%,13.431270000000001:0.00019%,4.90362:0.00019%,-71.14798:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-1.27347:0.00019%,-68.36943000000001:0.00019%]
[INFO] ** scada_tag:[3:26.15953%,1:20.7293%,5:18.28459%,4:17.60263%,2:17.21696%,0:0.00698%]
[INFO] ** service:[0.0048200000000000005:99.99554%,-211.73542999999998:0.00349%,-186.44547:0.00019%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-201.23771000000002:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:37.94665%,9:26.16012%,7:18.28536%,1:17.60341%,14:0.00349%,2:0.00058%,15:0.00019%,10:0.00019%]
[INFO] ** type:[0:99.99903%,1:0.00097%]
[INFO] ** unixtime:1412 (0.27379%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0095 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1546e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0081 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1478e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0068 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.9905e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0059 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8533e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5768 - tp: 64252.0000 - fp: 15748.0000 - tn: 304252.0000 - fn: 15748.0000 - accuracy: 0.9213 - precision: 0.8031 - recall: 0.8031 - auc: 0.9618 - val_loss: 0.1160 - val_tp: 19988.0000 - val_fp: 12.0000 - val_tn: 79988.0000 - val_fn: 12.0000 - val_accuracy: 0.9998 - val_precision: 0.9994 - val_recall: 0.9994 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 7-7/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99535%,30:0.00136%,22:0.00097%,17:0.00078%,26:0.00058%,31:0.00039%,28:0.00019%,27:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:82.14064%,Single Stage Single Point:17.85936%]
[INFO] ** dst:[21:43.36157%,10:20.74695%,8:18.24794%,9:17.63715%,6:0.00155%,22:0.00136%,15:0.00136%,16:0.00078%,24:0.00039%,18:0.00039%,17:0.00039%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99864%,0:0.00136%]
[INFO] ** i/f_name:[2:99.99864%,3:0.00136%]
[INFO] ** modbus_function_code:[0.02961:99.99535%,-33.760870000000004:0.00465%]
[INFO] ** modbus_function_description:[7:49.99845%,11:49.9969%,0:0.00465%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99651%,2:0.00213%,1:0.00136%]
[INFO] ** proxy_src_ip:[18:37.97147%,20:26.13782%,13:18.24833%,6:17.63734%,17:0.00136%,11:0.00078%,1:0.00078%,21:0.00058%,16:0.00039%,14:0.00039%,7:0.00039%,10:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.13685%,-0.32151:20.74695%,-1.27613:18.24774%,-0.23351:17.63695%,-0.33484:17.22452%,-71.33197:0.00136%,-71.14931:0.00097%,-71.14798:0.00058%,1.45709:0.00058%,-1.02014:0.00039%,-1.27347:0.00039%,-0.24151:0.00039%,-58.035180000000004:0.00019%,-1.2708:0.00019%,-5.1466400000000005:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-5.08665:0.00019%,14.253910000000001:0.00019%,-68.79874000000001:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:26.13646%,1:20.74695%,5:18.24774%,4:17.63676%,2:17.22452%,0:0.00756%]
[INFO] ** service:[0.0048200000000000005:99.99535%,-211.73542999999998:0.00136%,-211.08818:0.00097%,-205.44247:0.00078%,-211.08346:0.00058%,-186.43601999999998:0.00039%,-211.09762999999998:0.00019%,-185.9872:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:37.97147%,9:26.13782%,7:18.24833%,1:17.63734%,14:0.00136%,10:0.00078%,3:0.00078%,4:0.00058%,21:0.00039%,15:0.00039%,2:0.00039%,11:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1409 (0.27321%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1431 - tp: 74039.0000 - fp: 5961.0000 - tn: 314039.0000 - fn: 5961.0000 - accuracy: 0.9702 - precision: 0.9255 - recall: 0.9255 - auc: 0.9975 - val_loss: 0.0128 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0492 - tp: 78260.0000 - fp: 1740.0000 - tn: 318260.0000 - fn: 1740.0000 - accuracy: 0.9913 - precision: 0.9783 - recall: 0.9783 - auc: 0.9997 - val_loss: 0.0022 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3898 - tp: 66923.0000 - fp: 13077.0000 - tn: 306923.0000 - fn: 13077.0000 - accuracy: 0.9346 - precision: 0.8365 - recall: 0.8365 - auc: 0.9790 - val_loss: 0.3299 - val_tp: 13997.0000 - val_fp: 6003.0000 - val_tn: 73997.0000 - val_fn: 6003.0000 - val_accuracy: 0.8799 - val_precision: 0.6999 - val_recall: 0.6999 - val_auc: 0.9704
[INFO] saving weights to checkpoints/lstm-epoch-3-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1116 - tp: 78454.0000 - fp: 1546.0000 - tn: 318454.0000 - fn: 1546.0000 - accuracy: 0.9923 - precision: 0.9807 - recall: 0.9807 - auc: 0.9993 - val_loss: 0.0206 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0298 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0042 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 8-8/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99709%,30:0.00097%,0:0.00058%,24:0.00019%,23:0.00019%,22:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:94.45866%,Single Stage Single Point:5.54134%]
[INFO] ** dst:[21:43.43312%,10:20.81133%,8:18.1727%,9:17.57917%,22:0.00136%,15:0.00097%,25:0.00058%,19:0.00039%,26:0.00019%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99942%,0:0.00058%]
[INFO] ** i/f_name:[2:99.99903%,3:0.00097%]
[INFO] ** modbus_function_code:[0.02961:99.99709%,-33.760870000000004:0.00271%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99961%,11:49.99748%,0:0.00271%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99961%,2:0.00039%]
[INFO] ** proto:[0:99.99825%,1:0.00097%,2:0.00078%]
[INFO] ** proxy_src_ip:[18:38.10003%,20:26.14499%,13:18.17193%,6:17.57956%,10:0.00116%,17:0.00097%,16:0.00058%,14:0.00039%,11:0.00019%,5:0.00019%]
[INFO] ** s_port:[1.45442:26.14441%,-0.32151:20.81133%,-1.27613:18.17174%,-0.23351:17.57898%,-0.33484:17.2887%,-71.33197:0.00097%,-15.039579999999999:0.00078%,-1.02014:0.00058%,-64.19493:0.00058%,1.45709:0.00039%,-0.24151:0.00039%,4.66896:0.00039%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-71.14931:0.00019%]
[INFO] ** scada_tag:[3:26.14402%,1:20.81113%,5:18.17174%,4:17.57878%,2:17.28851%,0:0.00582%]
[INFO] ** service:[0.0048200000000000005:99.99787%,-211.73542999999998:0.00097%,-186.44547:0.00058%,-211.07873999999998:0.00039%,-211.08818:0.00019%]
[INFO] ** src:[22:38.10003%,9:26.14499%,7:18.17193%,1:17.57956%,11:0.00116%,15:0.00058%,14:0.00058%,21:0.00039%,2:0.00039%,16:0.00019%,10:0.00019%]
[INFO] ** type:[0:99.99942%,1:0.00039%,2:0.00019%]
[INFO] ** unixtime:1413 (0.27398%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0178 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0012 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0099 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5324e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0082 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1114e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2047 - tp: 75811.0000 - fp: 4189.0000 - tn: 315811.0000 - fn: 4189.0000 - accuracy: 0.9791 - precision: 0.9476 - recall: 0.9476 - auc: 0.9917 - val_loss: 0.4051 - val_tp: 16360.0000 - val_fp: 3640.0000 - val_tn: 76360.0000 - val_fn: 3640.0000 - val_accuracy: 0.9272 - val_precision: 0.8180 - val_recall: 0.8180 - val_auc: 0.9872
[INFO] saving weights to checkpoints/lstm-epoch-3-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2301 - tp: 71370.0000 - fp: 8630.0000 - tn: 311370.0000 - fn: 8630.0000 - accuracy: 0.9568 - precision: 0.8921 - recall: 0.8921 - auc: 0.9918 - val_loss: 0.0555 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 9-9/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99825%,30:0.00097%,31:0.00039%,26:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:95.67327%,Single Stage Single Point:4.32673%]
[INFO] ** dst:[21:43.3606%,10:20.77351%,8:18.28963%,9:17.57355%,15:0.00097%,22:0.00078%,18:0.00039%,25:0.00019%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99903%,0:0.00097%]
[INFO] ** i/f_name:[2:99.99903%,3:0.00097%]
[INFO] ** modbus_function_code:[0.02961:99.99825%,-33.760870000000004:0.00175%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99825%,0:0.00175%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99981%,2:0.00019%]
[INFO] ** proto:[0:99.99825%,1:0.00097%,2:0.00078%]
[INFO] ** proxy_src_ip:[18:38.00579%,20:26.1289%,13:18.28982%,6:17.57374%,17:0.00097%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.12812%,-0.32151:20.77351%,-1.27613:18.28943%,-0.23351:17.57335%,-0.33484:17.23228%,-71.33197:0.00097%,1.45709:0.00039%,-0.24151:0.00039%,-0.08551:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.12773%,1:20.77332%,5:18.28943%,4:17.57316%,2:17.23228%,0:0.00407%]
[INFO] ** service:[0.0048200000000000005:99.99825%,-211.73542999999998:0.00097%,-186.43601999999998:0.00039%,-186.44547:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.00579%,9:26.1289%,7:18.28982%,1:17.57374%,14:0.00078%,21:0.00019%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1411 (0.2736%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1055 - tp: 76401.0000 - fp: 3599.0000 - tn: 316401.0000 - fn: 3599.0000 - accuracy: 0.9820 - precision: 0.9550 - recall: 0.9550 - auc: 0.9983 - val_loss: 0.0089 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1645 - tp: 75688.0000 - fp: 4312.0000 - tn: 315688.0000 - fn: 4312.0000 - accuracy: 0.9784 - precision: 0.9461 - recall: 0.9461 - auc: 0.9948 - val_loss: 0.0471 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0256 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0017 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0135 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3123e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0094 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7156e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 10-10/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99651%,30:0.00194%,24:0.00019%,23:0.00019%,22:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:94.07648%,Single Stage Single Point:5.92352%]
[INFO] ** dst:[21:43.41489%,10:20.81288%,8:18.22002%,9:17.54853%,15:0.00194%,22:0.00058%,24:0.00039%,19:0.00039%,26:0.00019%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99825%,0:0.00175%]
[INFO] ** i/f_name:[2:99.99806%,3:0.00194%]
[INFO] ** modbus_function_code:[0.02961:99.99651%,-33.760870000000004:0.0033%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99884%,11:49.99767%,0:0.0033%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99922%,1:0.00078%]
[INFO] ** proto:[0:99.99767%,1:0.00194%,2:0.00039%]
[INFO] ** proxy_src_ip:[18:38.09906%,20:26.12909%,13:18.22021%,6:17.54795%,17:0.00194%,10:0.00097%,14:0.00039%,16:0.00019%,5:0.00019%]
[INFO] ** s_port:[1.45442:26.12851%,-0.32151:20.81288%,-1.27613:18.21963%,-0.23351:17.54756%,-0.33484:17.28618%,-71.33197:0.00194%,-10.51843:0.00078%,5.71692:0.00039%,-1.27347:0.00039%,1.46509:0.00019%,1.47576:0.00019%,-0.24950999999999998:0.00019%,1.45709:0.00019%,-0.24151:0.00019%,-71.14931:0.00019%,-1.02014:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.12812%,1:20.81268%,5:18.21963%,4:17.54737%,2:17.28599%,0:0.0062%]
[INFO] ** service:[0.0048200000000000005:99.99729%,-211.73542999999998:0.00194%,-211.07873999999998:0.00039%,-186.44547:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.09906%,9:26.12909%,7:18.22021%,1:17.54795%,14:0.00194%,11:0.00097%,2:0.00039%,16:0.00019%,15:0.00019%]
[INFO] ** type:[0:99.99845%,1:0.00136%,2:0.00019%]
[INFO] ** unixtime:1409 (0.27321%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0071 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.4803e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0052 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.8773 - val_tp: 18412.0000 - val_fp: 1588.0000 - val_tn: 78412.0000 - val_fn: 1588.0000 - val_accuracy: 0.9682 - val_precision: 0.9206 - val_recall: 0.9206 - val_auc: 0.9504
[INFO] saving weights to checkpoints/lstm-epoch-3-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3687 - tp: 70571.0000 - fp: 9429.0000 - tn: 310571.0000 - fn: 9429.0000 - accuracy: 0.9529 - precision: 0.8821 - recall: 0.8821 - auc: 0.9839 - val_loss: 3.0439 - val_tp: 13135.0000 - val_fp: 6865.0000 - val_tn: 73135.0000 - val_fn: 6865.0000 - val_accuracy: 0.8627 - val_precision: 0.6568 - val_recall: 0.6568 - val_auc: 0.8077
[INFO] saving weights to checkpoints/lstm-epoch-3-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1836 - tp: 78111.0000 - fp: 1889.0000 - tn: 318111.0000 - fn: 1889.0000 - accuracy: 0.9906 - precision: 0.9764 - recall: 0.9764 - auc: 0.9906 - val_loss: 1.1044e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0078 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.0638e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 11-11/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99884%,31:0.00039%,30:0.00039%,26:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.38483%,10:20.88055%,8:18.19791%,9:17.53418%,22:0.00136%,18:0.00039%,15:0.00039%,25:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99961%,3:0.00039%]
[INFO] ** modbus_function_code:[0.02961:99.99884%,-33.760870000000004:0.00116%]
[INFO] ** modbus_function_description:[7:50.00058%,11:49.99825%,0:0.00116%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99884%,2:0.00078%,1:0.00039%]
[INFO] ** proxy_src_ip:[18:38.1487%,20:26.11707%,13:18.19791%,6:17.53457%,16:0.00058%,17:0.00039%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.11649%,-0.32151:20.88055%,-1.27613:18.19772%,-0.23351:17.53399%,-0.33484:17.26815%,-0.24151:0.00058%,-1.02014:0.00058%,-0.08551:0.00039%,-71.33197:0.00039%,-71.14798:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.1161%,1:20.88055%,5:18.19752%,4:17.5336%,2:17.26796%,0:0.00427%]
[INFO] ** service:[0.0048200000000000005:99.99884%,-211.73542999999998:0.00039%,-186.43601999999998:0.00039%,-186.44547:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.1487%,9:26.11707%,7:18.19791%,1:17.53457%,15:0.00058%,14:0.00039%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1410 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0067 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.2349e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0061 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7351e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0057 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8278e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0050 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1157e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0048 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6092e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 12-12/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99767%,30:0.00213%,9:0.00019%]
[INFO] ** classification:[normal:92.98249%,Single Stage Single Point:7.01751%]
[INFO] ** dst:[21:43.3922%,10:20.87221%,8:18.1919%,9:17.54039%,15:0.00213%,22:0.00058%,24:0.00039%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99825%,0:0.00175%]
[INFO] ** i/f_name:[2:99.99787%,3:0.00213%]
[INFO] ** modbus_function_code:[0.02961:99.99767%,-33.760870000000004:0.00233%]
[INFO] ** modbus_function_description:[7:49.99961%,11:49.99806%,0:0.00233%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99825%,2:0.00175%]
[INFO] ** proto:[0:99.99787%,1:0.00213%]
[INFO] ** proxy_src_ip:[18:38.139%,20:26.1258%,13:18.19209%,6:17.54058%,17:0.00213%,16:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:26.12521%,-0.32151:20.87221%,-1.27613:18.19151%,-0.23351:17.5402%,-0.33484:17.26679%,-71.33197:0.00213%,-1.27347:0.00039%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.12483%,1:20.87221%,5:18.19151%,4:17.53981%,2:17.26679%,0:0.00485%]
[INFO] ** service:[0.0048200000000000005:99.99767%,-211.73542999999998:0.00213%,-183.8612:0.00019%]
[INFO] ** src:[22:38.139%,9:26.1258%,7:18.19209%,1:17.54058%,21:0.00175%,14:0.00039%,15:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1410 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0044 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2053e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0042 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.2095e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5077 - tp: 69150.0000 - fp: 10850.0000 - tn: 309150.0000 - fn: 10850.0000 - accuracy: 0.9457 - precision: 0.8644 - recall: 0.8644 - auc: 0.9759 - val_loss: 0.0475 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1682 - tp: 75758.0000 - fp: 4242.0000 - tn: 315758.0000 - fn: 4242.0000 - accuracy: 0.9788 - precision: 0.9470 - recall: 0.9470 - auc: 0.9950 - val_loss: 0.0491 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0366 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0118 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 13-13/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99632%,31:0.00078%,26:0.00058%,0:0.00058%,30:0.00039%,22:0.00039%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:85.16396%,Single Stage Single Point:14.83604%]
[INFO] ** dst:[21:43.35439%,10:20.80008%,8:18.27935%,9:17.56191%,22:0.00116%,6:0.00097%,18:0.00078%,25:0.00058%,15:0.00039%,24:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99961%,3:0.00039%]
[INFO] ** modbus_function_code:[0.02961:99.99632%,-33.760870000000004:0.00349%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99884%,11:49.99748%,0:0.00349%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99709%,2:0.00252%,1:0.00039%]
[INFO] ** proxy_src_ip:[18:38.05214%,20:26.10272%,13:18.27954%,6:17.56133%,10:0.00116%,11:0.00097%,16:0.00058%,17:0.00039%,7:0.00039%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.10214%,-0.32151:20.80008%,-1.27613:18.27916%,-0.23351:17.56094%,-0.33484:17.25206%,-9.78512:0.00078%,-71.14798:0.00058%,-64.19493:0.00058%,-1.02014:0.00058%,-0.08551:0.00039%,-71.14931:0.00039%,-0.24151:0.00039%,-71.33197:0.00039%,-1.27347:0.00019%,1.46509:0.00019%,-68.79874000000001:0.00019%,14.540560000000001:0.00019%,1.45709:0.00019%,-1.2708:0.00019%,6.1115699999999995:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:26.10175%,1:20.79989%,5:18.27916%,4:17.56094%,2:17.25186%,0:0.0064%]
[INFO] ** service:[0.0048200000000000005:99.99709%,-186.43601999999998:0.00078%,-186.44547:0.00058%,-211.08346:0.00058%,-211.73542999999998:0.00039%,-211.08818:0.00039%,-202.75898:0.00019%]
[INFO] ** src:[22:38.05214%,9:26.10272%,7:18.27954%,1:17.56133%,11:0.00116%,10:0.00097%,15:0.00058%,21:0.00039%,14:0.00039%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1410 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0174 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0039 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0111 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0015 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0084 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.4235e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4488 - tp: 65674.0000 - fp: 14326.0000 - tn: 305674.0000 - fn: 14326.0000 - accuracy: 0.9284 - precision: 0.8209 - recall: 0.8209 - auc: 0.9790 - val_loss: 0.0141 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0847 - tp: 76151.0000 - fp: 3849.0000 - tn: 316151.0000 - fn: 3849.0000 - accuracy: 0.9808 - precision: 0.9519 - recall: 0.9519 - auc: 0.9990 - val_loss: 2.9560e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 14-14/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99961%,30:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:95.53308%,Single Stage Single Point:4.46692%]
[INFO] ** dst:[21:43.34722%,10:20.81133%,8:18.26772%,9:17.57219%,22:0.00078%,24:0.00039%,15:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99961%,-33.760870000000004:0.00039%]
[INFO] ** modbus_function_description:[7:50.00097%,11:49.99864%,0:0.00039%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99981%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.05%,20:26.10912%,13:18.26791%,6:17.57238%,17:0.00019%,16:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:26.10834%,-0.32151:20.81133%,-1.27613:18.26733%,-0.23351:17.572%,-0.33484:17.23868%,-1.27347:0.00039%,1.45709:0.00039%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:26.10796%,1:20.81133%,5:18.26714%,4:17.57161%,2:17.23848%,0:0.00349%]
[INFO] ** service:[0.0048200000000000005:99.99961%,-183.8612:0.00019%,-211.73542999999998:0.00019%]
[INFO] ** src:[22:38.05%,9:26.10912%,7:18.26791%,1:17.57238%,15:0.00019%,14:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1409 (0.27321%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2918 - tp: 70719.0000 - fp: 9281.0000 - tn: 310719.0000 - fn: 9281.0000 - accuracy: 0.9536 - precision: 0.8840 - recall: 0.8840 - auc: 0.9869 - val_loss: 0.4741 - val_tp: 12807.0000 - val_fp: 7193.0000 - val_tn: 72807.0000 - val_fn: 7193.0000 - val_accuracy: 0.8561 - val_precision: 0.6403 - val_recall: 0.6403 - val_auc: 0.9677
[INFO] saving weights to checkpoints/lstm-epoch-3-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0874 - tp: 78547.0000 - fp: 1453.0000 - tn: 318547.0000 - fn: 1453.0000 - accuracy: 0.9927 - precision: 0.9818 - recall: 0.9818 - auc: 0.9993 - val_loss: 0.0176 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0246 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0045 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0145 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0016 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0105 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.8555e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 15-15/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99612%,30:0.0031%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:89.29078%,Single Stage Multi Point:10.70844%,Single Stage Single Point:0.00078%]
[INFO] ** dst:[21:43.29467%,10:20.77507%,8:18.316%,9:17.60884%,15:0.0031%,22:0.00155%,25:0.00019%,24:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.9969%,0:0.0031%]
[INFO] ** i/f_name:[2:99.9969%,3:0.0031%]
[INFO] ** modbus_function_code:[0.02961:99.99612%,-33.760870000000004:0.00388%]
[INFO] ** modbus_function_description:[7:49.99903%,11:49.99709%,0:0.00388%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99709%,2:0.00291%]
[INFO] ** proto:[0:99.99651%,1:0.0031%,2:0.00039%]
[INFO] ** proxy_src_ip:[18:38.00424%,20:26.06607%,13:18.3158%,6:17.60942%,17:0.0031%,16:0.00058%,7:0.00039%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.0653%,-0.32151:20.77487%,-1.27613:18.31561%,-0.23351:17.60864%,-0.33484:17.22937%,-71.33197:0.0031%,-1.02014:0.00058%,-0.24151:0.00058%,1.45709:0.00039%,-64.19493:0.00019%,-61.95768:0.00019%,-71.14798:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,10.192739999999999:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%]
[INFO] ** scada_tag:[3:26.06491%,1:20.77468%,5:18.31561%,4:17.60826%,2:17.22918%,0:0.00737%]
[INFO] ** service:[0.0048200000000000005:99.99632%,-211.73542999999998:0.0031%,-186.44547:0.00019%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.00424%,9:26.06607%,7:18.3158%,1:17.60942%,21:0.0033%,15:0.00058%,16:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1418 (0.27495%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0084 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6490e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0071 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.1464e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0062 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2770e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0052 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.8930 - val_tp: 18892.0000 - val_fp: 1108.0000 - val_tn: 78892.0000 - val_fn: 1108.0000 - val_accuracy: 0.9778 - val_precision: 0.9446 - val_recall: 0.9446 - val_auc: 0.9654
[INFO] saving weights to checkpoints/lstm-epoch-3-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5326 - tp: 42627.0000 - fp: 37373.0000 - tn: 282627.0000 - fn: 37373.0000 - accuracy: 0.8131 - precision: 0.5328 - recall: 0.5328 - auc: 0.7024 - val_loss: 7.5474 - val_tp: 10635.0000 - val_fp: 9365.0000 - val_tn: 70635.0000 - val_fn: 9365.0000 - val_accuracy: 0.8127 - val_precision: 0.5318 - val_recall: 0.5318 - val_auc: 0.7073
[INFO] saving weights to checkpoints/lstm-epoch-3-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 16-16/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (455414, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (455414, 17)

[INFO] analyzing data
[INFO] 455414 rows
[INFO] ** appi_name:[21:99.99846%,30:0.00132%,33:0.00022%]
[INFO] ** classification:[normal:83.33626%,Single Stage Multi Point:16.66374%]
[INFO] ** dst:[21:43.35659%,10:20.79844%,8:18.2524%,9:17.58971%,22:0.00132%,15:0.00132%,24:0.00022%]
[INFO] ** i/f_dir:[1:99.99868%,0:0.00132%]
[INFO] ** i/f_name:[2:99.99868%,3:0.00132%]
[INFO] ** modbus_function_code:[0.02961:99.99846%,-33.760870000000004:0.00154%]
[INFO] ** modbus_function_description:[7:50.00066%,11:49.9978%,0:0.00154%]
[INFO] ** modbus_transaction_id:65536 (14.39042%)
[INFO] ** orig:[0:99.99868%,2:0.00132%]
[INFO] ** proto:[0:99.99868%,1:0.00132%]
[INFO] ** proxy_src_ip:[18:38.0478%,20:26.10745%,13:18.25284%,6:17.58993%,17:0.00132%,16:0.00044%,21:0.00022%]
[INFO] ** s_port:[1.45442:26.1068%,-0.32151:20.79822%,-1.27613:18.2524%,-0.23351:17.58949%,-0.33484:17.24958%,-71.33197:0.00132%,1.45709:0.00044%,-0.24151:0.00044%,-1.02014:0.00044%,-1.27347:0.00022%,1.47576:0.00022%,-49.275529999999996:0.00022%,-1.2708:0.00022%]
[INFO] ** scada_tag:[3:26.10636%,1:20.79822%,5:18.25218%,4:17.58905%,2:17.24936%,0:0.00483%]
[INFO] ** service:[0.0048200000000000005:99.99868%,-211.73542999999998:0.00132%]
[INFO] ** src:[22:38.0478%,9:26.10745%,7:18.25284%,1:17.58993%,21:0.00132%,15:0.00044%,4:0.00022%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1246 (0.2736%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/455414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5591 - tp: 42494.0000 - fp: 37506.0000 - tn: 282494.0000 - fn: 37506.0000 - accuracy: 0.8125 - precision: 0.5312 - recall: 0.5312 - auc: 0.7019 - val_loss: 7.5562 - val_tp: 10624.0000 - val_fp: 9376.0000 - val_tn: 70624.0000 - val_fn: 9376.0000 - val_accuracy: 0.8125 - val_precision: 0.5312 - val_recall: 0.5312 - val_auc: 0.7070
[INFO] saving weights to checkpoints/lstm-epoch-3-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/455414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.8469 - tp: 50993.0000 - fp: 29007.0000 - tn: 290993.0000 - fn: 29007.0000 - accuracy: 0.8550 - precision: 0.6374 - recall: 0.6374 - auc: 0.7699 - val_loss: 2.7612e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/455414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0036 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9139e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/455414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0032 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5002e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/455414
[33m[INFO] loading file 17-17/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555414, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555414, 17)

[INFO] analyzing data
[INFO] 555414 rows
[INFO] ** appi_name:[21:99.99712%,7:0.00054%,26:0.00036%,0:0.00036%,33:0.00018%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.44558%,Multi Stage Multi Point:5.55442%]
[INFO] ** dst:[21:43.3464%,10:20.84661%,8:18.20444%,9:17.59966%,22:0.00072%,6:0.00054%,25:0.00036%,16:0.00036%,2:0.00036%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99712%,-33.760870000000004:0.0027%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99946%,11:49.99766%,0:0.0027%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.79949%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99874%,2:0.00126%]
[INFO] ** proxy_src_ip:[18:38.07718%,20:26.11637%,13:18.2039%,6:17.59948%,10:0.00108%,11:0.0009%,1:0.00036%,21:0.00018%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.11547%,-0.32151:20.84643%,-1.27613:18.20354%,-0.23351:17.5993%,-0.33484:17.23075%,6.0369:0.00072%,1.47576:0.00036%,-71.14798:0.00036%,1.45709:0.00036%,-64.19493:0.00036%,1.46509:0.00018%,-68.79874000000001:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,6.15557:0.00018%,6.06224:0.00018%,8.55414:0.00018%,-3.3787199999999995:0.00018%,-4.3880099999999995:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.11529%,1:20.84625%,5:18.20336%,4:17.59894%,2:17.23075%,0:0.0054%]
[INFO] ** service:[0.0048200000000000005:99.99802%,-211.09762999999998:0.00054%,-211.08346:0.00036%,-186.44547:0.00036%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.07718%,9:26.11637%,7:18.2039%,1:17.59948%,11:0.00108%,10:0.0009%,3:0.00036%,21:0.00018%,15:0.00018%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1517 (0.27313%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0030 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0369e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0027 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.6409e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0025 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.5494e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.7182 - tp: 71482.0000 - fp: 8518.0000 - tn: 311482.0000 - fn: 8518.0000 - accuracy: 0.9574 - precision: 0.8935 - recall: 0.8935 - auc: 0.9330 - val_loss: 2.9456 - val_tp: 16345.0000 - val_fp: 3655.0000 - val_tn: 76345.0000 - val_fn: 3655.0000 - val_accuracy: 0.9269 - val_precision: 0.8173 - val_recall: 0.8173 - val_auc: 0.8858
[INFO] saving weights to checkpoints/lstm-epoch-3-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9170 - tp: 65530.0000 - fp: 14470.0000 - tn: 305530.0000 - fn: 14470.0000 - accuracy: 0.9277 - precision: 0.8191 - recall: 0.8191 - auc: 0.8864 - val_loss: 2.9238 - val_tp: 16372.0000 - val_fp: 3628.0000 - val_tn: 76372.0000 - val_fn: 3628.0000 - val_accuracy: 0.9274 - val_precision: 0.8186 - val_recall: 0.8186 - val_auc: 0.8866
[INFO] saving weights to checkpoints/lstm-epoch-3-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/555414
[33m[INFO] loading file 18-18/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555414, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555414, 17)

[INFO] analyzing data
[INFO] 555414 rows
[INFO] ** appi_name:[21:99.9982%,30:0.00054%,7:0.00054%,31:0.00018%,27:0.00018%,22:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:82.43166%,Multi Stage Multi Point:17.56834%]
[INFO] ** dst:[21:43.34154%,10:20.83311%,8:18.25989%,9:17.56257%,22:0.00072%,15:0.00054%,24:0.00036%,16:0.00036%,2:0.00036%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99946%,0:0.00054%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.9982%,-33.760870000000004:0.0018%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.9982%,0:0.0018%]
[INFO] ** modbus_transaction_id:65536 (11.79949%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99892%,2:0.00054%,1:0.00054%]
[INFO] ** proxy_src_ip:[18:38.07754%,20:26.09765%,13:18.26025%,6:17.56275%,17:0.00054%,11:0.00054%,1:0.00036%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.09693%,-0.32151:20.83311%,-1.27613:18.25971%,-0.23351:17.56239%,-0.33484:17.24443%,-71.33197:0.00054%,-1.27347:0.00036%,1.45709:0.00036%,-0.24151:0.00036%,1.47576:0.00018%,1.46509:0.00018%,3.6236699999999997:0.00018%,-1.2708:0.00018%,-2.48275:0.00018%,6.06224:0.00018%,-3.3787199999999995:0.00018%,8.10082:0.00018%,6.45955:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.09657%,1:20.83293%,5:18.25953%,4:17.56221%,2:17.24425%,0:0.0045%]
[INFO] ** service:[0.0048200000000000005:99.9982%,-211.09762999999998:0.00054%,-211.73542999999998:0.00054%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.07754%,9:26.09765%,7:18.26025%,1:17.56275%,14:0.00054%,10:0.00054%,3:0.00036%,21:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1518 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5003 - tp: 77526.0000 - fp: 2474.0000 - tn: 317526.0000 - fn: 2474.0000 - accuracy: 0.9876 - precision: 0.9691 - recall: 0.9691 - auc: 0.9805 - val_loss: 6.1305 - val_tp: 12393.0000 - val_fp: 7607.0000 - val_tn: 72393.0000 - val_fn: 7607.0000 - val_accuracy: 0.8479 - val_precision: 0.6197 - val_recall: 0.6197 - val_auc: 0.7623
[INFO] saving weights to checkpoints/lstm-epoch-3-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1316 - tp: 49572.0000 - fp: 30428.0000 - tn: 289572.0000 - fn: 30428.0000 - accuracy: 0.8479 - precision: 0.6197 - recall: 0.6197 - auc: 0.7605 - val_loss: 6.0395 - val_tp: 12506.0000 - val_fp: 7494.0000 - val_tn: 72506.0000 - val_fn: 7494.0000 - val_accuracy: 0.8501 - val_precision: 0.6253 - val_recall: 0.6253 - val_auc: 0.7658
[INFO] saving weights to checkpoints/lstm-epoch-3-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1454 - tp: 49503.0000 - fp: 30497.0000 - tn: 289503.0000 - fn: 30497.0000 - accuracy: 0.8475 - precision: 0.6188 - recall: 0.6188 - auc: 0.7600 - val_loss: 6.1474 - val_tp: 12372.0000 - val_fp: 7628.0000 - val_tn: 72372.0000 - val_fn: 7628.0000 - val_accuracy: 0.8474 - val_precision: 0.6186 - val_recall: 0.6186 - val_auc: 0.7616
[INFO] saving weights to checkpoints/lstm-epoch-3-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.3080 - tp: 68551.0000 - fp: 11449.0000 - tn: 308551.0000 - fn: 11449.0000 - accuracy: 0.9428 - precision: 0.8569 - recall: 0.8569 - auc: 0.9098 - val_loss: 1.3358e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0013 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0545e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/555414
[33m[INFO] loading file 19-19/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555414, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555414, 17)

[INFO] analyzing data
[INFO] 555414 rows
[INFO] ** appi_name:[21:99.99802%,26:0.00036%,0:0.00036%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:87.11592%,Single Stage Multi Point:12.88408%]
[INFO] ** dst:[21:43.38601%,10:20.82591%,8:18.21236%,9:17.57302%,22:0.00126%,6:0.00054%,25:0.00036%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99802%,-33.760870000000004:0.0018%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99802%,0:0.0018%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.79949%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99874%,2:0.00126%]
[INFO] ** proxy_src_ip:[18:38.11337%,20:26.09873%,13:18.21236%,6:17.57302%,10:0.00108%,11:0.0009%,16:0.00054%]
[INFO] ** s_port:[1.45442:26.09765%,-0.32151:20.82591%,-1.27613:18.212%,-0.23351:17.57284%,-0.33484:17.28746%,-5.20264:0.00072%,1.45709:0.00054%,-1.02014:0.00054%,-64.19493:0.00036%,-71.14798:0.00036%,1.46509:0.00036%,-1.27347:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-71.14931:0.00018%,-68.79874000000001:0.00018%,0.75578:0.00018%]
[INFO] ** scada_tag:[3:26.09729%,1:20.82573%,5:18.21182%,4:17.57266%,2:17.28728%,0:0.00522%]
[INFO] ** service:[0.0048200000000000005:99.99874%,-211.08346:0.00036%,-186.44547:0.00036%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.11337%,9:26.09873%,7:18.21236%,1:17.57302%,11:0.00108%,10:0.0009%,15:0.00054%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1519 (0.27349%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0012 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.2088e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0011 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.8242e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.3450e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3996e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2230 - tp: 78897.0000 - fp: 1103.0000 - tn: 318897.0000 - fn: 1103.0000 - accuracy: 0.9945 - precision: 0.9862 - recall: 0.9862 - auc: 0.9913 - val_loss: 9.7974 - val_tp: 7843.0000 - val_fp: 12157.0000 - val_tn: 67843.0000 - val_fn: 12157.0000 - val_accuracy: 0.7569 - val_precision: 0.3922 - val_recall: 0.3922 - val_auc: 0.6201
[INFO] saving weights to checkpoints/lstm-epoch-3-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.8378 - tp: 31173.0000 - fp: 48827.0000 - tn: 271173.0000 - fn: 48827.0000 - accuracy: 0.7559 - precision: 0.3897 - recall: 0.3897 - auc: 0.6161 - val_loss: 7.6343 - val_tp: 10527.0000 - val_fp: 9473.0000 - val_tn: 70527.0000 - val_fn: 9473.0000 - val_accuracy: 0.8105 - val_precision: 0.5264 - val_recall: 0.5264 - val_auc: 0.7040
[INFO] saving weights to checkpoints/lstm-epoch-3-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/555414
[33m[INFO] loading file 20-20/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555414, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555414, 17)

[INFO] analyzing data
[INFO] 555414 rows
[INFO] ** appi_name:[21:99.99658%,30:0.00288%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:92.6219%,Single Stage Multi Point:7.3781%]
[INFO] ** dst:[21:43.42508%,10:20.83671%,8:18.16087%,9:17.57248%,15:0.00288%,22:0.00108%,24:0.00036%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99748%,0:0.00252%]
[INFO] ** i/f_name:[2:99.99712%,3:0.00288%]
[INFO] ** modbus_function_code:[0.02961:99.99658%,-33.760870000000004:0.00342%]
[INFO] ** modbus_function_description:[7:49.99946%,11:49.99712%,0:0.00342%]
[INFO] ** modbus_transaction_id:65536 (11.79949%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99658%,1:0.00288%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.11499%,20:26.14734%,13:18.16105%,6:17.57302%,17:0.00288%,14:0.00054%,16:0.00018%]
[INFO] ** s_port:[1.45442:26.14662%,-0.32151:20.83671%,-1.27613:18.16051%,-0.23351:17.5723%,-0.33484:17.27828%,-71.33197:0.00288%,-0.24151:0.00054%,1.45709:0.00036%,-1.27347:0.00036%,13.431270000000001:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-71.14798:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:26.14608%,1:20.83653%,5:18.16051%,4:17.57194%,2:17.2781%,0:0.00684%]
[INFO] ** service:[0.0048200000000000005:99.99658%,-211.73542999999998:0.00288%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.11499%,9:26.14734%,7:18.16105%,1:17.57302%,14:0.00288%,2:0.00054%,15:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1518 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.9558e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3845e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.4608 - tp: 67789.0000 - fp: 12211.0000 - tn: 307789.0000 - fn: 12211.0000 - accuracy: 0.9389 - precision: 0.8474 - recall: 0.8474 - auc: 0.9040 - val_loss: 2.9625 - val_tp: 16324.0000 - val_fp: 3676.0000 - val_tn: 76324.0000 - val_fn: 3676.0000 - val_accuracy: 0.9265 - val_precision: 0.8162 - val_recall: 0.8162 - val_auc: 0.8851
[INFO] saving weights to checkpoints/lstm-epoch-3-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9438 - tp: 65391.0000 - fp: 14609.0000 - tn: 305391.0000 - fn: 14609.0000 - accuracy: 0.9270 - precision: 0.8174 - recall: 0.8174 - auc: 0.8851 - val_loss: 2.9424 - val_tp: 16349.0000 - val_fp: 3651.0000 - val_tn: 76349.0000 - val_fn: 3651.0000 - val_accuracy: 0.9270 - val_precision: 0.8174 - val_recall: 0.8174 - val_auc: 0.8859
[INFO] saving weights to checkpoints/lstm-epoch-3-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3770 - tp: 73168.0000 - fp: 6832.0000 - tn: 313168.0000 - fn: 6832.0000 - accuracy: 0.9658 - precision: 0.9146 - recall: 0.9146 - auc: 0.9463 - val_loss: 2.3662e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.4238e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1236e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/555414
[33m[INFO] loading file 21-21/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555412, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555412, 17)

[INFO] analyzing data
[INFO] 555412 rows
[INFO] ** appi_name:[21:99.99604%,30:0.00108%,7:0.00054%,26:0.00036%,22:0.00036%,0:0.00036%,31:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:98.90118%,Multi Stage Single Point:1.09882%]
[INFO] ** dst:[21:43.31001%,10:20.98352%,8:18.16795%,9:17.53365%,15:0.00108%,22:0.0009%,24:0.00072%,6:0.00072%,25:0.00036%,16:0.00036%,2:0.00036%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99604%,-33.760870000000004:0.00378%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99892%,11:49.99712%,0:0.00378%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.79953%)
[INFO] ** orig:[0:99.99928%,2:0.00072%]
[INFO] ** proto:[0:99.99748%,2:0.00144%,1:0.00108%]
[INFO] ** proxy_src_ip:[18:38.30868%,20:25.98449%,13:18.16867%,6:17.53365%,17:0.00108%,10:0.00108%,11:0.0009%,16:0.00054%,1:0.00036%,21:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.98395%,-0.32151:20.9828%,-1.27613:18.16777%,-0.23351:17.53347%,-0.33484:17.32588%,-71.33197:0.00108%,-1.27347:0.00072%,-6.64392:0.00072%,-1.02014:0.00054%,-64.19493:0.00036%,-71.14931:0.00036%,-71.14798:0.00036%,1.47576:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,6.62488:0.00018%,10.15141:0.00018%,-68.79874000000001:0.00018%,7.060860000000001:0.00018%,-3.3787199999999995:0.00018%,-2.2440900000000004:0.00018%,1.45709:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.98341%,1:20.98262%,5:18.16759%,4:17.53311%,2:17.32588%,0:0.00738%]
[INFO] ** service:[0.0048200000000000005:99.99676%,-211.73542999999998:0.00108%,-211.09762999999998:0.00054%,-211.08346:0.00036%,-186.44547:0.00036%,-211.08818:0.00036%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.30868%,9:25.98449%,7:18.16867%,1:17.53365%,11:0.00108%,21:0.0009%,10:0.0009%,15:0.00054%,14:0.00036%,3:0.00036%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1513 (0.27241%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555412
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.9085e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8954e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/555412
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.3378e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7369e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/555412
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.0210e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5879e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/555412
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.5837e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5018e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/555412
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.4331e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4240e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/555412
[33m[INFO] loading file 22-22/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (324453, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (324453, 17)

[INFO] analyzing data
[INFO] 324453 rows
[INFO] ** appi_name:[21:99.9926%,30:0.00647%,23:0.00031%,22:0.00031%,18:0.00031%]
[INFO] ** classification:[normal:59.14601%,Multi Stage Single Point:40.85399%]
[INFO] ** dst:[21:43.30365%,10:21.00427%,8:18.10956%,9:17.57389%,15:0.00647%,22:0.00123%,19:0.00062%,26:0.00031%]
[INFO] ** i/f_dir:[1:99.99384%,0:0.00616%]
[INFO] ** i/f_name:[2:99.99353%,3:0.00616%,0:0.00031%]
[INFO] ** modbus_function_code:[0.02961:99.9926%,-33.760870000000004:0.0074%]
[INFO] ** modbus_function_description:[7:49.99707%,11:49.99553%,0:0.0074%]
[INFO] ** modbus_transaction_id:65534 (20.1983%)
[INFO] ** orig:[0:99.99507%,2:0.00431%,1:0.00062%]
[INFO] ** proto:[0:99.99322%,1:0.00647%,2:0.00031%]
[INFO] ** proxy_src_ip:[18:38.32943%,20:25.97942%,13:18.10894%,6:17.57481%,17:0.00647%,14:0.00062%,10:0.00031%]
[INFO] ** s_port:[1.45442:25.97849%,-0.32151:21.00427%,-1.27613:18.10894%,-0.23351:17.57389%,-0.33484:17.32516%,-71.33197:0.00647%,1.45709:0.00062%,-0.24151:0.00062%,7.228860000000001:0.00062%,-0.24950999999999998:0.00031%,1.46509:0.00031%,-71.14931:0.00031%]
[INFO] ** scada_tag:[3:25.97818%,1:21.00427%,5:18.10894%,4:17.57358%,2:17.32516%,0:0.00986%]
[INFO] ** service:[0.0048200000000000005:99.9926%,-211.73542999999998:0.00647%,-211.07873999999998:0.00062%,-211.08818:0.00031%]
[INFO] ** src:[22:38.32943%,9:25.97942%,7:18.10894%,1:17.57481%,21:0.00431%,14:0.00216%,2:0.00062%,11:0.00031%]
[INFO] ** type:[0:99.99815%,1:0.00185%]
[INFO] ** unixtime:895 (0.27585%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/324453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.5532 - tp: 62365.0000 - fp: 17635.0000 - tn: 302365.0000 - fn: 17635.0000 - accuracy: 0.9118 - precision: 0.7796 - recall: 0.7796 - auc: 0.8614 - val_loss: 7.5626 - val_tp: 10616.0000 - val_fp: 9384.0000 - val_tn: 70616.0000 - val_fn: 9384.0000 - val_accuracy: 0.8123 - val_precision: 0.5308 - val_recall: 0.5308 - val_auc: 0.7068
[INFO] saving weights to checkpoints/lstm-epoch-3-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/324453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5700 - tp: 42428.0000 - fp: 37572.0000 - tn: 282428.0000 - fn: 37572.0000 - accuracy: 0.8121 - precision: 0.5304 - recall: 0.5304 - auc: 0.7047 - val_loss: 7.5900 - val_tp: 10582.0000 - val_fp: 9418.0000 - val_tn: 70582.0000 - val_fn: 9418.0000 - val_accuracy: 0.8116 - val_precision: 0.5291 - val_recall: 0.5291 - val_auc: 0.7057
[INFO] saving weights to checkpoints/lstm-epoch-3-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/324453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5857 - tp: 42350.0000 - fp: 37650.0000 - tn: 282350.0000 - fn: 37650.0000 - accuracy: 0.8118 - precision: 0.5294 - recall: 0.5294 - auc: 0.7040 - val_loss: 7.6077 - val_tp: 10560.0000 - val_fp: 9440.0000 - val_tn: 70560.0000 - val_fn: 9440.0000 - val_accuracy: 0.8112 - val_precision: 0.5280 - val_recall: 0.5280 - val_auc: 0.7050
[INFO] saving weights to checkpoints/lstm-epoch-3-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/324453
[33m[INFO] loading file 23-23/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524453, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524453, 17)

[INFO] analyzing data
[INFO] 524453 rows
[INFO] ** appi_name:[21:99.99886%,31:0.00038%,30:0.00038%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:96.09345%,Multi Stage Single Point:3.90655%]
[INFO] ** dst:[21:43.32743%,10:21.00303%,8:18.13985%,9:17.5274%,22:0.00095%,24:0.00038%,18:0.00038%,15:0.00038%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99886%,-33.760870000000004:0.00114%]
[INFO] ** modbus_function_description:[7:50.00029%,11:49.99857%,0:0.00114%]
[INFO] ** modbus_transaction_id:65536 (12.49607%)
[INFO] ** orig:[0:99.99981%,2:0.00019%]
[INFO] ** proto:[0:99.99905%,2:0.00057%,1:0.00038%]
[INFO] ** proxy_src_ip:[18:38.34929%,20:25.98136%,13:18.14004%,6:17.5276%,16:0.00057%,17:0.00038%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98078%,-0.32151:21.00284%,-1.27613:18.13947%,-0.23351:17.52721%,-0.33484:17.34645%,-1.02014:0.00057%,-1.27347:0.00038%,-0.08551:0.00038%,-71.33197:0.00038%,1.45709:0.00019%,-0.24151:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,1.46509:0.00019%,-64.19493:0.00019%,-0.24950999999999998:0.00019%,-49.275529999999996:0.00019%]
[INFO] ** scada_tag:[3:25.9804%,1:21.00284%,5:18.13928%,4:17.52702%,2:17.34626%,0:0.00419%]
[INFO] ** service:[0.0048200000000000005:99.99905%,-211.73542999999998:0.00038%,-186.43601999999998:0.00038%,-186.44547:0.00019%]
[INFO] ** src:[22:38.34929%,9:25.98136%,7:18.14004%,1:17.5276%,15:0.00057%,21:0.00019%,17:0.00019%,14:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1426 (0.2719%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.1280 - tp: 59512.0000 - fp: 20488.0000 - tn: 299512.0000 - fn: 20488.0000 - accuracy: 0.8976 - precision: 0.7439 - recall: 0.7439 - auc: 0.8390 - val_loss: 1.2753e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4860e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2564e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2798e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2362e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.1360e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2167e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.9279e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/524453
[33m[INFO] loading file 24-24/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524453, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524453, 17)

[INFO] analyzing data
[INFO] 524453 rows
[INFO] ** appi_name:[21:99.99295%,30:0.00343%,26:0.00057%,31:0.00038%,27:0.00038%,22:0.00038%,0:0.00038%,24:0.00019%,23:0.00019%,19:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,11:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:95.1416%,Multi Stage Single Point:4.8584%]
[INFO] ** dst:[21:43.35851%,10:21.02324%,8:18.1021%,9:17.50891%,15:0.00343%,22:0.00114%,6:0.00076%,25:0.00038%,19:0.00038%,18:0.00038%,7:0.00038%,26:0.00019%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99676%,0:0.00324%]
[INFO] ** i/f_name:[2:99.99657%,3:0.00343%]
[INFO] ** modbus_function_code:[0.02961:99.99295%,-33.760870000000004:0.00648%,-0.415:0.00019%,0.9188299999999999:0.00019%,0.47422:0.00019%]
[INFO] ** modbus_function_description:[7:49.99743%,11:49.99552%,0:0.00648%,15:0.00019%,10:0.00019%,2:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.49607%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99447%,1:0.00343%,2:0.0021%]
[INFO] ** proxy_src_ip:[18:38.4023%,20:25.98021%,13:18.10191%,6:17.50815%,17:0.00343%,10:0.00133%,14:0.00095%,11:0.00095%,21:0.00038%,16:0.00038%]
[INFO] ** s_port:[1.45442:25.97945%,-0.32151:21.02324%,-1.27613:18.10172%,-0.23351:17.50757%,-0.33484:17.37906%,-71.33197:0.00343%,-9.58113:0.00076%,-71.14798:0.00057%,1.45709:0.00038%,-0.24151:0.00038%,-1.02014:0.00038%,-31.55091:0.00038%,7.6315100000000005:0.00038%,-71.14931:0.00038%,-64.19493:0.00038%,-68.79874000000001:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,-1.27347:0.00019%,7.4901800000000005:0.00019%,13.431270000000001:0.00019%,11.862:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:25.97926%,1:21.02324%,5:18.10153%,4:17.50719%,2:17.37887%,0:0.00992%]
[INFO] ** service:[0.0048200000000000005:99.99409%,-211.73542999999998:0.00343%,-211.08346:0.00057%,-211.07873999999998:0.00038%,-202.75898:0.00038%,-186.44547:0.00038%,-186.43601999999998:0.00038%,-211.08818:0.00038%]
[INFO] ** src:[22:38.4023%,9:25.98021%,7:18.10191%,1:17.50815%,14:0.00343%,11:0.00133%,10:0.00095%,2:0.00095%,15:0.00038%,4:0.00038%]
[INFO] ** type:[0:99.99867%,1:0.00095%,2:0.00038%]
[INFO] ** unixtime:1425 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.5244e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.7670e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.5511e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.0843e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.9515 - tp: 70314.0000 - fp: 9686.0000 - tn: 310314.0000 - fn: 9686.0000 - accuracy: 0.9516 - precision: 0.8789 - recall: 0.8789 - auc: 0.9243 - val_loss: 5.7340 - val_tp: 12885.0000 - val_fp: 7115.0000 - val_tn: 72885.0000 - val_fn: 7115.0000 - val_accuracy: 0.8577 - val_precision: 0.6442 - val_recall: 0.6442 - val_auc: 0.7777
[INFO] saving weights to checkpoints/lstm-epoch-3-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/524453
[33m[INFO] loading file 25-25/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524453, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524453, 17)

[INFO] analyzing data
[INFO] 524453 rows
[INFO] ** appi_name:[21:99.99619%,30:0.00114%,17:0.00076%,22:0.00057%,31:0.00038%,28:0.00019%,26:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** classification:[normal:64.34228%,Multi Stage Single Point:35.65772%]
[INFO] ** dst:[21:43.31523%,10:21.02247%,8:18.14843%,9:17.50929%,15:0.00114%,22:0.00095%,16:0.00076%,6:0.00076%,18:0.00038%,17:0.00038%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99886%,0:0.00114%]
[INFO] ** i/f_name:[2:99.99886%,3:0.00114%]
[INFO] ** modbus_function_code:[0.02961:99.99619%,-33.760870000000004:0.00381%]
[INFO] ** modbus_function_description:[7:49.99895%,11:49.99724%,0:0.00381%]
[INFO] ** modbus_transaction_id:65536 (12.49607%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99771%,2:0.00114%,1:0.00114%]
[INFO] ** proxy_src_ip:[18:38.38533%,20:25.95218%,13:18.14843%,6:17.50986%,17:0.00114%,1:0.00095%,21:0.00076%,16:0.00038%,14:0.00038%,7:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.9518%,-0.32151:21.02209%,-1.27613:18.14805%,-0.23351:17.50929%,-0.33484:17.36323%,-71.33197:0.00114%,-71.14931:0.00057%,-0.24151:0.00038%,-1.02014:0.00038%,-49.275529999999996:0.00038%,1.46509:0.00019%,-5.1466400000000005:0.00019%,-1.27347:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,-0.24950999999999998:0.00019%,2.52505:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,6.1115699999999995:0.00019%,-5.08665:0.00019%,1.45709:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:25.95142%,1:21.0219%,5:18.14786%,4:17.5091%,2:17.36304%,0:0.00667%]
[INFO] ** service:[0.0048200000000000005:99.99657%,-211.73542999999998:0.00114%,-205.44247:0.00076%,-211.08818:0.00057%,-186.43601999999998:0.00038%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.38533%,9:25.95218%,7:18.14843%,1:17.50986%,14:0.00114%,3:0.00095%,4:0.00076%,21:0.00038%,15:0.00038%,2:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1425 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7500 - tp: 51461.0000 - fp: 28539.0000 - tn: 291461.0000 - fn: 28539.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.7770 - val_loss: 5.7421 - val_tp: 12875.0000 - val_fp: 7125.0000 - val_tn: 72875.0000 - val_fn: 7125.0000 - val_accuracy: 0.8575 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.7773
[INFO] saving weights to checkpoints/lstm-epoch-3-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7445 - tp: 51488.0000 - fp: 28512.0000 - tn: 291488.0000 - fn: 28512.0000 - accuracy: 0.8574 - precision: 0.6436 - recall: 0.6436 - auc: 0.7772 - val_loss: 5.7453 - val_tp: 12871.0000 - val_fp: 7129.0000 - val_tn: 72871.0000 - val_fn: 7129.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.7772
[INFO] saving weights to checkpoints/lstm-epoch-3-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7512 - tp: 51455.0000 - fp: 28545.0000 - tn: 291455.0000 - fn: 28545.0000 - accuracy: 0.8573 - precision: 0.6432 - recall: 0.6432 - auc: 0.7770 - val_loss: 5.7558 - val_tp: 12858.0000 - val_fp: 7142.0000 - val_tn: 72858.0000 - val_fn: 7142.0000 - val_accuracy: 0.8572 - val_precision: 0.6429 - val_recall: 0.6429 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-3-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7415 - tp: 51503.0000 - fp: 28497.0000 - tn: 291503.0000 - fn: 28497.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7774 - val_loss: 5.7759 - val_tp: 12833.0000 - val_fp: 7167.0000 - val_tn: 72833.0000 - val_fn: 7167.0000 - val_accuracy: 0.8567 - val_precision: 0.6417 - val_recall: 0.6417 - val_auc: 0.7760
[INFO] saving weights to checkpoints/lstm-epoch-3-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7405 - tp: 51508.0000 - fp: 28492.0000 - tn: 291508.0000 - fn: 28492.0000 - accuracy: 0.8575 - precision: 0.6439 - recall: 0.6439 - auc: 0.7774 - val_loss: 5.7590 - val_tp: 12854.0000 - val_fp: 7146.0000 - val_tn: 72854.0000 - val_fn: 7146.0000 - val_accuracy: 0.8571 - val_precision: 0.6427 - val_recall: 0.6427 - val_auc: 0.7767
[INFO] saving weights to checkpoints/lstm-epoch-3-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/524453
[33m[INFO] loading file 26-26/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524453, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524453, 17)

[INFO] analyzing data
[INFO] 524453 rows
[INFO] ** appi_name:[21:99.99847%,7:0.00057%,31:0.00019%,30:0.00019%,22:0.00019%,12:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:64.40005%,Single Stage Single Point:30.45306%,Multi Stage Single Point:5.14689%]
[INFO] ** dst:[21:43.31027%,10:21.08769%,8:18.11907%,9:17.4805%,22:0.00076%,24:0.00038%,16:0.00038%,2:0.00038%,18:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99847%,-33.760870000000004:0.00153%]
[INFO] ** modbus_function_description:[7:49.9999%,11:49.99857%,0:0.00153%]
[INFO] ** modbus_transaction_id:65536 (12.49607%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99943%,2:0.00038%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.47094%,20:25.9272%,13:18.11945%,6:17.4805%,1:0.00057%,21:0.00038%,16:0.00038%,17:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.92663%,-0.32151:21.08749%,-1.27613:18.11888%,-0.23351:17.48031%,-0.33484:17.38345%,-1.27347:0.00038%,-1.02014:0.00038%,7.66617:0.00019%,-71.14931:0.00019%,11.57001:0.00019%,-3.3787199999999995:0.00019%,2.52505:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%,1.45709:0.00019%,-49.275529999999996:0.00019%,1.47576:0.00019%,1.46509:0.00019%,14.191239999999999:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.92625%,1:21.08749%,5:18.11888%,4:17.48012%,2:17.38345%,0:0.00381%]
[INFO] ** service:[0.0048200000000000005:99.99867%,-211.09762999999998:0.00057%,-211.35747999999998:0.00019%,-211.73542999999998:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.47094%,9:25.9272%,7:18.11945%,1:17.4805%,3:0.00057%,15:0.00038%,4:0.00038%,21:0.00019%,14:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1423 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.5123 - tp: 52203.0000 - fp: 27797.0000 - tn: 292203.0000 - fn: 27797.0000 - accuracy: 0.8610 - precision: 0.6525 - recall: 0.6525 - auc: 0.7886 - val_loss: 0.0149 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2338 - tp: 76277.0000 - fp: 3723.0000 - tn: 316277.0000 - fn: 3723.0000 - accuracy: 0.9814 - precision: 0.9535 - recall: 0.9535 - auc: 0.9906 - val_loss: 3.7553e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1701 - tp: 76636.0000 - fp: 3364.0000 - tn: 316636.0000 - fn: 3364.0000 - accuracy: 0.9832 - precision: 0.9579 - recall: 0.9579 - auc: 0.9988 - val_loss: 1.4892e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1312 - tp: 76909.0000 - fp: 3091.0000 - tn: 316909.0000 - fn: 3091.0000 - accuracy: 0.9845 - precision: 0.9614 - recall: 0.9614 - auc: 0.9994 - val_loss: 6.7742e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0759 - tp: 77933.0000 - fp: 2067.0000 - tn: 317933.0000 - fn: 2067.0000 - accuracy: 0.9897 - precision: 0.9742 - recall: 0.9742 - auc: 0.9997 - val_loss: 2.8499e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/524453
[33m[INFO] loading file 27-27/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (464583, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (464583, 17)

[INFO] analyzing data
[INFO] 464583 rows
[INFO] ** appi_name:[21:99.99935%,30:0.00065%]
[INFO] ** classification:[normal:64.3377%,Single Stage Single Point:35.6623%]
[INFO] ** dst:[21:43.27192%,10:21.06384%,8:18.18965%,9:17.47287%,22:0.00086%,15:0.00065%,24:0.00022%]
[INFO] ** i/f_dir:[1:99.99978%,0:0.00022%]
[INFO] ** i/f_name:[2:99.99935%,3:0.00065%]
[INFO] ** modbus_function_code:[0.02961:99.99935%,-33.760870000000004:0.00065%]
[INFO] ** modbus_function_description:[7:50.00054%,11:49.99882%,0:0.00065%]
[INFO] ** modbus_transaction_id:65536 (14.10641%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99935%,1:0.00065%]
[INFO] ** proxy_src_ip:[18:38.40433%,20:25.93207%,13:18.18943%,6:17.47309%,17:0.00065%,16:0.00043%]
[INFO] ** s_port:[1.45442:25.93143%,-0.32151:21.06384%,-1.27613:18.18921%,-0.23351:17.47266%,-0.33484:17.3405%,-71.33197:0.00065%,-1.02014:0.00043%,-1.27347:0.00022%,1.45709:0.00022%,-0.24950999999999998:0.00022%,1.46509:0.00022%,1.47576:0.00022%,-0.24151:0.00022%]
[INFO] ** scada_tag:[3:25.931%,1:21.06362%,5:18.189%,4:17.47244%,2:17.34028%,0:0.00366%]
[INFO] ** service:[0.0048200000000000005:99.99935%,-211.73542999999998:0.00065%]
[INFO] ** src:[22:38.40433%,9:25.93207%,7:18.18943%,1:17.47309%,14:0.00065%,15:0.00043%]
[INFO] ** type:[0:99.99957%,1:0.00043%]
[INFO] ** unixtime:1262 (0.27164%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/464583
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0589 - tp: 78241.0000 - fp: 1759.0000 - tn: 318241.0000 - fn: 1759.0000 - accuracy: 0.9912 - precision: 0.9780 - recall: 0.9780 - auc: 0.9998 - val_loss: 4.4881e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/464583
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0546 - tp: 78162.0000 - fp: 1838.0000 - tn: 318162.0000 - fn: 1838.0000 - accuracy: 0.9908 - precision: 0.9770 - recall: 0.9770 - auc: 0.9997 - val_loss: 1.6549e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/464583
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0327 - tp: 78807.0000 - fp: 1193.0000 - tn: 318807.0000 - fn: 1193.0000 - accuracy: 0.9940 - precision: 0.9851 - recall: 0.9851 - auc: 0.9999 - val_loss: 1.6148e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/464583
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0250 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.2150e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/464583
[33m[INFO] loading file 28-28/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (398499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (398499, 17)

[INFO] analyzing data
[INFO] 398499 rows
[INFO] ** appi_name:[21:99.99247%,30:0.00176%,17:0.00125%,22:0.001%,7:0.001%,31:0.00075%,26:0.00075%,28:0.00025%,27:0.00025%,8:0.00025%,0:0.00025%]
[INFO] ** classification:[normal:64.31283%,Single Stage Single Point:35.68717%]
[INFO] ** dst:[21:43.28543%,10:21.01963%,8:18.2023%,9:17.48461%,6:0.00201%,16:0.00176%,18:0.00125%,15:0.00075%,22:0.0005%,17:0.0005%,2:0.0005%,25:0.00025%,7:0.00025%,0:0.00025%]
[INFO] ** i/f_dir:[1:99.99925%,0:0.00075%]
[INFO] ** i/f_name:[2:99.99925%,3:0.00075%]
[INFO] ** modbus_function_code:[0.02961:99.99247%,-33.760870000000004:0.00753%]
[INFO] ** modbus_function_description:[7:49.99636%,11:49.99611%,0:0.00753%]
[INFO] ** modbus_transaction_id:65536 (16.44571%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99548%,2:0.00376%,1:0.00075%]
[INFO] ** proxy_src_ip:[18:38.34263%,20:25.96242%,13:18.20256%,6:17.48486%,1:0.00201%,17:0.00176%,14:0.00151%,7:0.00125%,21:0.00075%,0:0.00025%]
[INFO] ** s_port:[1.45442:25.96217%,-0.32151:21.01963%,-1.27613:18.2023%,-0.23351:17.48436%,-0.33484:17.323%,-71.14798:0.001%,-71.14931:0.001%,-71.33197:0.00075%,-0.08551:0.0005%,-0.24151:0.0005%,7.66617:0.00025%,-58.035180000000004:0.00025%,-1.2708:0.00025%,-64.19493:0.00025%,-5.1466400000000005:0.00025%,13.431270000000001:0.00025%,11.57001:0.00025%,14.4699:0.00025%,1.47576:0.00025%,14.191239999999999:0.00025%,-5.08665:0.00025%,10.192739999999999:0.00025%,-3.3787199999999995:0.00025%,6.1115699999999995:0.00025%,2.05573:0.00025%,-43.76509:0.00025%,2.52505:0.00025%,11.862:0.00025%,-58.032509999999995:0.00025%]
[INFO] ** scada_tag:[3:25.96192%,1:21.01963%,5:18.2023%,4:17.48411%,2:17.323%,0:0.00903%]
[INFO] ** service:[0.0048200000000000005:99.99247%,-205.44247:0.00125%,-186.43601999999998:0.00125%,-211.09762999999998:0.001%,-211.08346:0.001%,-211.08818:0.001%,-211.73542999999998:0.00075%,-186.44547:0.00025%,-183.8612:0.00025%,-185.9872:0.00025%,-211.35747999999998:0.00025%,-202.75898:0.00025%]
[INFO] ** src:[22:38.34263%,9:25.96242%,7:18.20256%,1:17.48486%,3:0.00226%,2:0.00151%,21:0.00125%,4:0.001%,14:0.00075%,8:0.0005%,17:0.00025%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1083 (0.27177%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/398499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0247 - tp: 79075.0000 - fp: 925.0000 - tn: 319075.0000 - fn: 925.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 0.0032 - val_tp: 19996.0000 - val_fp: 4.0000 - val_tn: 79996.0000 - val_fn: 4.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-3-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/398499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0238 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 0.0027 - val_tp: 19996.0000 - val_fp: 4.0000 - val_tn: 79996.0000 - val_fn: 4.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-3-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/398499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0244 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/398499
[33m[INFO] loading file 29-29/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598499, 17)

[INFO] analyzing data
[INFO] 598499 rows
[INFO] ** appi_name:[21:99.99883%,30:0.0005%,31:0.00017%,26:0.00017%,9:0.00017%,3:0.00017%]
[INFO] ** classification:[normal:64.38123%,Single Stage Single Point:35.61877%]
[INFO] ** dst:[21:43.31536%,10:21.06453%,8:18.14874%,9:17.4697%,22:0.0005%,15:0.0005%,24:0.00017%,18:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99967%,0:0.00033%]
[INFO] ** i/f_name:[2:99.9995%,3:0.0005%]
[INFO] ** modbus_function_code:[0.02961:99.99883%,-33.760870000000004:0.00117%]
[INFO] ** modbus_function_description:[7:49.99975%,11:49.99908%,0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (10.95006%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99916%,1:0.0005%,2:0.00033%]
[INFO] ** proxy_src_ip:[18:38.43214%,20:25.94808%,13:18.14907%,6:17.46937%,17:0.0005%,21:0.00017%,16:0.00017%,7:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.94741%,-0.32151:21.06436%,-1.27613:18.14874%,-0.23351:17.46937%,-0.33484:17.36778%,-71.33197:0.0005%,1.45709:0.00033%,1.47576:0.00033%,-71.14798:0.00017%,-1.27347:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,6.1115699999999995:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:25.94708%,1:21.0642%,5:18.14874%,4:17.46904%,2:17.36778%,0:0.00317%]
[INFO] ** service:[0.0048200000000000005:99.999%,-211.73542999999998:0.0005%,-183.8612:0.00017%,-211.08346:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.43214%,9:25.94808%,7:18.14907%,1:17.46937%,14:0.0005%,21:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1625 (0.27151%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0215 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79173.0000 - fp: 827.0000 - tn: 319173.0000 - fn: 827.0000 - accuracy: 0.9959 - precision: 0.9897 - recall: 0.9897 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-3-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79143.0000 - fp: 857.0000 - tn: 319143.0000 - fn: 857.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.6392e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/598499
[33m[INFO] loading file 30-30/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598499, 17)

[INFO] analyzing data
[INFO] 598499 rows
[INFO] ** appi_name:[21:99.99749%,30:0.00167%,26:0.00017%,17:0.00017%,12:0.00017%,3:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.37287%,Single Stage Single Point:35.62713%]
[INFO] ** dst:[21:43.34143%,10:21.02861%,8:18.14506%,9:17.48173%,15:0.00167%,22:0.00067%,24:0.00033%,25:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.9985%,0:0.0015%]
[INFO] ** i/f_name:[2:99.99833%,3:0.00167%]
[INFO] ** modbus_function_code:[0.02961:99.99749%,-33.760870000000004:0.00251%]
[INFO] ** modbus_function_description:[7:49.99958%,11:49.99791%,0:0.00251%]
[INFO] ** modbus_transaction_id:65536 (10.95006%)
[INFO] ** orig:[0:99.99916%,2:0.0005%,1:0.00033%]
[INFO] ** proto:[0:99.99799%,1:0.00167%,2:0.00033%]
[INFO] ** proxy_src_ip:[18:38.3755%,20:25.9942%,13:18.14539%,6:17.48223%,17:0.00167%,7:0.00033%,0:0.00033%,16:0.00017%,5:0.00017%]
[INFO] ** s_port:[1.45442:25.99403%,-0.32151:21.02827%,-1.27613:18.14489%,-0.23351:17.48157%,-0.33484:17.34723%,-71.33197:0.00167%,-0.24151:0.0005%,-1.27347:0.00033%,-61.95768:0.00033%,-71.14798:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:25.99369%,1:21.02827%,5:18.14473%,4:17.4814%,2:17.34706%,0:0.00485%]
[INFO] ** service:[0.0048200000000000005:99.99783%,-211.73542999999998:0.00167%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.3755%,9:25.9942%,7:18.14539%,1:17.48223%,14:0.00117%,21:0.00084%,8:0.00033%,16:0.00017%,15:0.00017%]
[INFO] ** type:[0:99.99916%,1:0.00084%]
[INFO] ** unixtime:1627 (0.27185%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79153.0000 - fp: 847.0000 - tn: 319153.0000 - fn: 847.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 0.0015 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-3-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79123.0000 - fp: 877.0000 - tn: 319123.0000 - fn: 877.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/598499
[33m[INFO] loading file 31-31/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598499, 17)

[INFO] analyzing data
[INFO] 598499 rows
[INFO] ** appi_name:[21:99.99967%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.37939%,Single Stage Single Point:35.62061%]
[INFO] ** dst:[21:43.32956%,10:21.04849%,8:18.12133%,9:17.49894%,22:0.001%,24:0.00033%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99967%,-33.760870000000004:0.00033%]
[INFO] ** modbus_function_description:[7:50.00008%,11:49.99958%,0:0.00033%]
[INFO] ** modbus_transaction_id:65536 (10.95006%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.3999%,20:25.97882%,13:18.12167%,6:17.49878%,16:0.0005%,7:0.00033%]
[INFO] ** s_port:[1.45442:25.97799%,-0.32151:21.04849%,-1.27613:18.12117%,-0.23351:17.49861%,-0.33484:17.35141%,-1.02014:0.0005%,-1.27347:0.00033%,1.45709:0.00033%,1.47576:0.00033%,-71.14798:0.00017%,1.46509:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.97765%,1:21.04832%,5:18.121%,4:17.49827%,2:17.35124%,0:0.00351%]
[INFO] ** service:[0.0048200000000000005:99.99967%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.3999%,9:25.97882%,7:18.12167%,1:17.49878%,15:0.0005%,21:0.00033%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1626 (0.27168%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1924e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/598499
[33m[INFO] loading file 32-32/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598499, 17)

[INFO] analyzing data
[INFO] 598499 rows
[INFO] ** appi_name:[21:99.99666%,30:0.00284%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.38507%,Single Stage Single Point:35.61493%]
[INFO] ** dst:[21:43.32071%,10:21.06002%,8:18.14907%,9:17.46586%,15:0.00284%,22:0.00084%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99749%,0:0.00251%]
[INFO] ** i/f_name:[2:99.99716%,3:0.00284%]
[INFO] ** modbus_function_code:[0.02961:99.99666%,-33.760870000000004:0.00334%]
[INFO] ** modbus_function_description:[7:49.99908%,11:49.99758%,0:0.00334%]
[INFO] ** modbus_transaction_id:65536 (10.95006%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99666%,1:0.00284%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.4278%,20:25.95326%,13:18.14907%,6:17.46636%,17:0.00284%,14:0.0005%,16:0.00017%]
[INFO] ** s_port:[1.45442:25.95276%,-0.32151:21.06002%,-1.27613:18.14874%,-0.23351:17.46569%,-0.33484:17.36778%,-71.33197:0.00284%,-0.24151:0.0005%,-1.2708:0.00017%,-1.02014:0.00017%,13.431270000000001:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.95242%,1:21.05985%,5:18.14874%,4:17.46536%,2:17.36778%,0:0.00585%]
[INFO] ** service:[0.0048200000000000005:99.99666%,-211.73542999999998:0.00284%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.4278%,9:25.95326%,7:18.14907%,1:17.46636%,14:0.00284%,2:0.0005%,15:0.00017%]
[INFO] ** type:[0:99.99967%,1:0.00033%]
[INFO] ** unixtime:1624 (0.27135%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79070.0000 - fp: 930.0000 - tn: 319070.0000 - fn: 930.0000 - accuracy: 0.9953 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79088.0000 - fp: 912.0000 - tn: 319088.0000 - fn: 912.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79152.0000 - fp: 848.0000 - tn: 319152.0000 - fn: 848.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 0.0101 - val_tp: 19984.0000 - val_fp: 16.0000 - val_tn: 79984.0000 - val_fn: 16.0000 - val_accuracy: 0.9997 - val_precision: 0.9992 - val_recall: 0.9992 - val_auc: 0.9995
[INFO] saving weights to checkpoints/lstm-epoch-3-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/598499
[33m[INFO] loading file 33-33/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598499, 17)

[INFO] analyzing data
[INFO] 598499 rows
[INFO] ** appi_name:[21:99.99716%,30:0.001%,17:0.00067%,22:0.0005%,31:0.00017%,28:0.00017%,26:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.39259%,Single Stage Single Point:35.60741%]
[INFO] ** dst:[21:43.32656%,10:21.06152%,8:18.12183%,9:17.48558%,22:0.00134%,15:0.001%,16:0.00067%,6:0.00067%,24:0.00033%,17:0.00033%,18:0.00017%]
[INFO] ** i/f_dir:[1:99.999%,0:0.001%]
[INFO] ** i/f_name:[2:99.999%,3:0.001%]
[INFO] ** modbus_function_code:[0.02961:99.99716%,-33.760870000000004:0.00284%]
[INFO] ** modbus_function_description:[7:49.99942%,11:49.99774%,0:0.00284%]
[INFO] ** modbus_transaction_id:65536 (10.95006%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99816%,1:0.001%,2:0.00084%]
[INFO] ** proxy_src_ip:[18:38.41928%,20:25.96963%,13:18.12183%,6:17.48574%,17:0.001%,16:0.00067%,1:0.00067%,21:0.00033%,14:0.00033%,7:0.00033%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.9688%,-0.32151:21.06152%,-1.27613:18.1215%,-0.23351:17.48541%,-0.33484:17.35776%,-71.33197:0.001%,-1.02014:0.00067%,1.45709:0.0005%,-71.14931:0.0005%,-1.27347:0.00033%,-5.08665:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,-71.14798:0.00017%,-58.032509999999995:0.00017%,-58.035180000000004:0.00017%,-0.24151:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.96846%,1:21.06136%,5:18.12133%,4:17.48524%,2:17.35776%,0:0.00585%]
[INFO] ** service:[0.0048200000000000005:99.99716%,-211.73542999999998:0.001%,-205.44247:0.00067%,-211.08818:0.0005%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.41928%,9:25.96963%,7:18.12183%,1:17.48574%,14:0.001%,15:0.00067%,3:0.00067%,21:0.00033%,4:0.00033%,2:0.00033%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1627 (0.27185%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79150.0000 - fp: 850.0000 - tn: 319150.0000 - fn: 850.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79083.0000 - fp: 917.0000 - tn: 319083.0000 - fn: 917.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-3-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/598499
[33m[INFO] loading file 34-34/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (439932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (439932, 17)

[INFO] analyzing data
[INFO] 439932 rows
[INFO] ** appi_name:[21:99.99773%,30:0.00068%,7:0.00068%,31:0.00023%,22:0.00023%,8:0.00023%,6:0.00023%]
[INFO] ** classification:[normal:64.35745%,Single Stage Single Point:35.64255%]
[INFO] ** dst:[21:43.29737%,10:21.05712%,8:18.18372%,9:17.45906%,22:0.00068%,15:0.00068%,16:0.00045%,2:0.00045%,18:0.00023%,6:0.00023%]
[INFO] ** i/f_dir:[1:99.99932%,0:0.00068%]
[INFO] ** i/f_name:[2:99.99932%,3:0.00068%]
[INFO] ** modbus_function_code:[0.02961:99.99773%,-33.760870000000004:0.00227%]
[INFO] ** modbus_function_description:[7:49.99932%,11:49.99841%,0:0.00227%]
[INFO] ** modbus_transaction_id:65536 (14.89685%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99886%,1:0.00068%,2:0.00045%]
[INFO] ** proxy_src_ip:[18:38.40139%,20:25.95333%,13:18.18349%,6:17.45952%,17:0.00068%,1:0.00068%,21:0.00045%,14:0.00023%,7:0.00023%]
[INFO] ** s_port:[1.45442:25.95287%,-0.32151:21.05689%,-1.27613:18.18349%,-0.23351:17.45883%,-0.33484:17.3445%,-0.24151:0.00068%,-71.33197:0.00068%,-3.0613900000000003:0.00023%,-3.3787199999999995:0.00023%,14.191239999999999:0.00023%,1.46509:0.00023%,1.47576:0.00023%,11.57001:0.00023%,-49.275529999999996:0.00023%,-71.14931:0.00023%,7.66617:0.00023%]
[INFO] ** scada_tag:[3:25.95265%,1:21.05666%,5:18.18326%,4:17.45838%,2:17.3445%,0:0.00455%]
[INFO] ** service:[0.0048200000000000005:99.99795%,-211.09762999999998:0.00068%,-211.73542999999998:0.00068%,-186.43601999999998:0.00023%,-211.35747999999998:0.00023%,-211.08818:0.00023%]
[INFO] ** src:[22:38.40139%,9:25.95333%,7:18.18349%,1:17.45952%,14:0.00068%,3:0.00068%,4:0.00045%,21:0.00023%,2:0.00023%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1195 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/439932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79080.0000 - fp: 920.0000 - tn: 319080.0000 - fn: 920.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/439932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79130.0000 - fp: 870.0000 - tn: 319130.0000 - fn: 870.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/439932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79156.0000 - fp: 844.0000 - tn: 319156.0000 - fn: 844.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 0.0013 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-3-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/439932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-33-34-batch-300000-400000
[INFO] processing batch 400000-500000/439932
[33m[INFO] loading file 35-35/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:99.99889%,30:0.00111%]
[INFO] ** classification:[normal:64.36866%,Single Stage Single Point:35.63134%]
[INFO] ** dst:[21:43.33305%,10:21.03302%,8:18.15377%,9:17.47794%,22:0.00111%,15:0.00111%]
[INFO] ** i/f_dir:[1:99.99907%,0:0.00093%]
[INFO] ** i/f_name:[2:99.99889%,3:0.00111%]
[INFO] ** modbus_function_code:[0.02961:99.99889%,-33.760870000000004:0.00111%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.9987%,0:0.00111%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.99889%,1:0.00111%]
[INFO] ** proxy_src_ip:[18:38.39669%,20:25.96994%,13:18.1534%,6:17.47813%,17:0.00111%,16:0.00074%]
[INFO] ** s_port:[1.45442:25.96938%,-0.32151:21.03302%,-1.27613:18.1534%,-0.23351:17.47776%,-0.33484:17.36367%,-71.33197:0.00111%,-1.02014:0.00074%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.96901%,1:21.03302%,5:18.15321%,4:17.47739%,2:17.36367%,0:0.0037%]
[INFO] ** service:[0.0048200000000000005:99.99889%,-211.73542999999998:0.00111%]
[INFO] ** src:[22:38.39669%,9:25.96994%,7:18.1534%,1:17.47813%,14:0.00111%,15:0.00074%]
[INFO] ** type:[0:99.99907%,1:0.00093%]
[INFO] ** unixtime:1465 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79077.0000 - fp: 923.0000 - tn: 319077.0000 - fn: 923.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0216 - tp: 79022.0000 - fp: 978.0000 - tn: 319022.0000 - fn: 978.0000 - accuracy: 0.9951 - precision: 0.9878 - recall: 0.9878 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79109.0000 - fp: 891.0000 - tn: 319109.0000 - fn: 891.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79151.0000 - fp: 849.0000 - tn: 319151.0000 - fn: 849.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 5.6946e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 36-36/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:99.9987%,30:0.00056%,31:0.00037%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.35496%,Single Stage Single Point:35.64504%]
[INFO] ** dst:[21:43.33138%,10:21.02154%,8:18.15673%,9:17.48813%,22:0.00074%,15:0.00056%,24:0.00037%,18:0.00037%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99944%,0:0.00056%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.9987%,-33.760870000000004:0.0013%]
[INFO] ** modbus_function_description:[7:50.00037%,11:49.99833%,0:0.0013%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99889%,2:0.00056%,1:0.00056%]
[INFO] ** proxy_src_ip:[18:38.3702%,20:25.9829%,13:18.15692%,6:17.48868%,17:0.00056%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98235%,-0.32151:21.02135%,-1.27613:18.15636%,-0.23351:17.48794%,-0.33484:17.34885%,-0.24151:0.00056%,-71.33197:0.00056%,-1.27347:0.00037%,-0.08551:0.00037%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-49.275529999999996:0.00019%,-1.2708:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:25.98198%,1:21.02117%,5:18.15618%,4:17.48776%,2:17.34867%,0:0.00426%]
[INFO] ** service:[0.0048200000000000005:99.99889%,-211.73542999999998:0.00056%,-186.43601999999998:0.00037%,-186.44547:0.00019%]
[INFO] ** src:[22:38.3702%,9:25.9829%,7:18.15692%,1:17.48868%,14:0.00056%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1467 (0.2717%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79139.0000 - fp: 861.0000 - tn: 319139.0000 - fn: 861.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 5.5933e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0216 - tp: 79053.0000 - fp: 947.0000 - tn: 319053.0000 - fn: 947.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 7.0268e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79149.0000 - fp: 851.0000 - tn: 319149.0000 - fn: 851.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 37-37/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:99.99889%,30:0.00074%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.38033%,Single Stage Single Point:35.61967%]
[INFO] ** dst:[21:43.33675%,10:21.04172%,8:18.13691%,9:17.48257%,22:0.00074%,15:0.00074%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99926%,3:0.00074%]
[INFO] ** modbus_function_code:[0.02961:99.99889%,-33.760870000000004:0.00111%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99889%,0:0.00111%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99907%,1:0.00074%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.39317%,20:25.98568%,13:18.1371%,6:17.48257%,17:0.00074%,16:0.00037%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.98512%,-0.32151:21.04172%,-1.27613:18.13673%,-0.23351:17.48239%,-0.33484:17.35144%,-71.33197:0.00074%,-1.02014:0.00037%,-71.14798:0.00019%,-1.27347:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%,14.4699:0.00019%]
[INFO] ** scada_tag:[3:25.98494%,1:21.04172%,5:18.13654%,4:17.4822%,2:17.35126%,0:0.00333%]
[INFO] ** service:[0.0048200000000000005:99.99889%,-211.73542999999998:0.00074%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.39317%,9:25.98568%,7:18.1371%,1:17.48257%,14:0.00074%,15:0.00037%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1467 (0.2717%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79066.0000 - fp: 934.0000 - tn: 319066.0000 - fn: 934.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 38-38/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:99.99907%,30:0.00019%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.40793%,Single Stage Single Point:35.59207%]
[INFO] ** dst:[21:43.32138%,10:21.08451%,8:18.09858%,9:17.49368%,22:0.00093%,25:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99907%,-33.760870000000004:0.00093%]
[INFO] ** modbus_function_description:[7:49.99963%,11:49.99944%,0:0.00093%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99944%,2:0.00037%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.45373%,20:25.95271%,13:18.09839%,6:17.49405%,7:0.00037%,17:0.00019%,16:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95197%,-0.32151:21.08432%,-1.27613:18.0982%,-0.23351:17.4935%,-0.33484:17.36941%,-0.24151:0.00037%,1.45709:0.00037%,-64.19493:0.00019%,10.192739999999999:0.00019%,-1.02014:0.00019%,-71.14798:0.00019%,-61.95768:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.9516%,1:21.08432%,5:18.0982%,4:17.49331%,2:17.36941%,0:0.00315%]
[INFO] ** service:[0.0048200000000000005:99.99926%,-211.08346:0.00019%,-205.44247:0.00019%,-186.44547:0.00019%,-211.73542999999998:0.00019%]
[INFO] ** src:[22:38.45373%,9:25.95271%,7:18.09839%,1:17.49405%,21:0.00037%,16:0.00019%,15:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1468 (0.27189%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79160.0000 - fp: 840.0000 - tn: 319160.0000 - fn: 840.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79074.0000 - fp: 926.0000 - tn: 319074.0000 - fn: 926.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 39-39/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.41089%,Single Stage Single Point:35.58911%]
[INFO] ** dst:[21:43.32453%,10:21.08543%,8:18.1271%,9:17.46183%,22:0.00093%,24:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99981%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.45595%,20:25.95438%,13:18.12728%,6:17.46183%,16:0.00056%]
[INFO] ** s_port:[1.45442:25.95382%,-0.32151:21.08543%,-1.27613:18.12691%,-0.23351:17.46164%,-0.33484:17.37052%,-1.02014:0.00056%,-1.27347:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95345%,1:21.08525%,5:18.12673%,4:17.46164%,2:17.37034%,0:0.00259%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.45595%,9:25.95438%,7:18.12728%,1:17.46183%,15:0.00056%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1465 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79091.0000 - fp: 909.0000 - tn: 319091.0000 - fn: 909.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79130.0000 - fp: 870.0000 - tn: 319130.0000 - fn: 870.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 40-40/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:99.9963%,30:0.00315%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.33847%,Single Stage Single Point:35.66153%]
[INFO] ** dst:[21:43.29453%,10:21.03895%,8:18.19377%,9:17.46794%,15:0.00315%,22:0.00093%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99704%,0:0.00296%]
[INFO] ** i/f_name:[2:99.99685%,3:0.00315%]
[INFO] ** modbus_function_code:[0.02961:99.9963%,-33.760870000000004:0.0037%]
[INFO] ** modbus_function_description:[7:49.99907%,11:49.99722%,0:0.0037%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.9963%,1:0.00315%,2:0.00056%]
[INFO] ** proxy_src_ip:[18:38.35668%,20:25.97772%,13:18.19359%,6:17.46831%,17:0.00315%,14:0.00056%]
[INFO] ** s_port:[1.45442:25.97679%,-0.32151:21.03895%,-1.27613:18.1934%,-0.23351:17.46776%,-0.33484:17.31774%,-71.33197:0.00315%,1.45709:0.00056%,-0.24151:0.00037%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,13.431270000000001:0.00019%]
[INFO] ** scada_tag:[3:25.97642%,1:21.03876%,5:18.19322%,4:17.46738%,2:17.31755%,0:0.00667%]
[INFO] ** service:[0.0048200000000000005:99.9963%,-211.73542999999998:0.00315%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.35668%,9:25.97772%,7:18.19359%,1:17.46831%,14:0.00315%,2:0.00056%]
[INFO] ** type:[0:99.99907%,1:0.00093%]
[INFO] ** unixtime:1468 (0.27189%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79076.0000 - fp: 924.0000 - tn: 319076.0000 - fn: 924.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79119.0000 - fp: 881.0000 - tn: 319119.0000 - fn: 881.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79063.0000 - fp: 937.0000 - tn: 319063.0000 - fn: 937.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0230 - tp: 79057.0000 - fp: 943.0000 - tn: 319057.0000 - fn: 943.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9998 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79085.0000 - fp: 915.0000 - tn: 319085.0000 - fn: 915.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 41-41/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (480090, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (480090, 17)

[INFO] analyzing data
[INFO] 480090 rows
[INFO] ** appi_name:[21:99.99646%,30:0.00104%,22:0.00083%,17:0.00083%,32:0.00021%,28:0.00021%,26:0.00021%,7:0.00021%]
[INFO] ** classification:[normal:64.39084%,Single Stage Single Point:35.60916%]
[INFO] ** dst:[21:43.3225%,10:21.06397%,8:18.13535%,9:17.4736%,16:0.00104%,15:0.00104%,6:0.00104%,22:0.00062%,24:0.00042%,17:0.00042%]
[INFO] ** i/f_dir:[1:99.99896%,0:0.00104%]
[INFO] ** i/f_name:[2:99.99896%,3:0.00104%]
[INFO] ** modbus_function_code:[0.02961:99.99646%,-33.760870000000004:0.00354%]
[INFO] ** modbus_function_description:[7:49.99896%,11:49.9975%,0:0.00354%]
[INFO] ** modbus_transaction_id:65536 (13.65077%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99771%,2:0.00125%,1:0.00104%]
[INFO] ** proxy_src_ip:[18:38.43779%,20:25.94888%,13:18.13556%,6:17.47381%,17:0.00104%,1:0.00083%,21:0.00042%,16:0.00042%,14:0.00042%,0:0.00042%,7:0.00021%,2:0.00021%]
[INFO] ** s_port:[1.45442:25.94847%,-0.32151:21.06397%,-1.27613:18.13493%,-0.23351:17.47339%,-0.33484:17.37383%,-71.33197:0.00104%,-71.14931:0.00083%,-1.02014:0.00042%,-1.27347:0.00042%,-71.14798:0.00021%,-0.24151:0.00021%,-58.035180000000004:0.00021%,-1.2708:0.00021%,-5.1466400000000005:0.00021%,1.47576:0.00021%,1.46509:0.00021%,-64.19226:0.00021%,-5.08665:0.00021%,-0.24950999999999998:0.00021%,2.05573:0.00021%,-43.76509:0.00021%,-58.032509999999995:0.00021%]
[INFO] ** scada_tag:[3:25.94826%,1:21.06397%,5:18.13493%,4:17.47318%,2:17.37383%,0:0.00583%]
[INFO] ** service:[0.0048200000000000005:99.99646%,-211.73542999999998:0.00104%,-205.44247:0.00083%,-211.08818:0.00083%,89.64175:0.00021%,-211.09762999999998:0.00021%,-211.08346:0.00021%,-185.9872:0.00021%]
[INFO] ** src:[22:38.43779%,9:25.94888%,7:18.13556%,1:17.47381%,14:0.00104%,3:0.00083%,15:0.00042%,8:0.00042%,4:0.00042%,2:0.00042%,21:0.00021%,17:0.00021%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1302 (0.2712%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/480090
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79078.0000 - fp: 922.0000 - tn: 319078.0000 - fn: 922.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-3-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/480090
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 8.0680e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/480090
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/480090
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0221 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9998 - val_loss: 1.1955e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/480090
[33m[INFO] loading file 42-42/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (423604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (423604, 17)

[INFO] analyzing data
[INFO] 423604 rows
[INFO] ** appi_name:[21:99.99197%,30:0.00212%,17:0.00118%,31:0.00094%,26:0.00094%,7:0.00094%,22:0.00071%,28:0.00024%,27:0.00024%,9:0.00024%,8:0.00024%,0:0.00024%]
[INFO] ** classification:[normal:64.39104%,Single Stage Single Point:35.60896%]
[INFO] ** dst:[21:43.32702%,10:21.05528%,8:18.16413%,9:17.44436%,16:0.00212%,6:0.00189%,18:0.00118%,22:0.00094%,2:0.00094%,15:0.00071%,17:0.00047%,25:0.00024%,24:0.00024%,7:0.00024%,0:0.00024%]
[INFO] ** i/f_dir:[1:99.99929%,0:0.00071%]
[INFO] ** i/f_name:[2:99.99929%,3:0.00071%]
[INFO] ** modbus_function_code:[0.02961:99.99197%,-33.760870000000004:0.00803%]
[INFO] ** modbus_function_description:[7:49.99693%,11:49.99504%,0:0.00803%]
[INFO] ** modbus_transaction_id:65536 (15.47105%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99575%,2:0.00354%,1:0.00071%]
[INFO] ** proxy_src_ip:[18:38.42079%,20:25.96175%,13:18.16461%,6:17.44436%,17:0.00212%,1:0.00212%,14:0.00142%,21:0.00094%,7:0.00071%,16:0.00047%,0:0.00047%,2:0.00024%]
[INFO] ** s_port:[1.45442:25.96128%,-0.32151:21.05528%,-1.27613:18.16413%,-0.23351:17.44412%,-0.33484:17.36551%,-71.14798:0.00094%,-71.14931:0.00094%,-71.33197:0.00071%,11.57001:0.00047%,-0.08551:0.00047%,-3.3787199999999995:0.00047%,-1.02014:0.00047%,-5.1466400000000005:0.00024%,-0.24151:0.00024%,13.431270000000001:0.00024%,0.31847:0.00024%,-1.2708:0.00024%,-58.035180000000004:0.00024%,7.66617:0.00024%,-64.19493:0.00024%,1.47576:0.00024%,14.4699:0.00024%,15.912510000000001:0.00024%,14.191239999999999:0.00024%,7.9608300000000005:0.00024%,-5.08665:0.00024%,10.192739999999999:0.00024%,-3.0613900000000003:0.00024%,1.45709:0.00024%,2.05573:0.00024%,-43.76509:0.00024%,11.862:0.00024%,-1.27347:0.00024%,-58.032509999999995:0.00024%]
[INFO] ** scada_tag:[3:25.9608%,1:21.05528%,5:18.1639%,4:17.44412%,2:17.36528%,0:0.01062%]
[INFO] ** service:[0.0048200000000000005:99.99197%,-211.09762999999998:0.00165%,-205.44247:0.00118%,-186.43601999999998:0.00118%,-211.08346:0.00094%,-211.08818:0.00094%,-211.73542999999998:0.00071%,-211.35747999999998:0.00047%,-186.44547:0.00024%,-183.8612:0.00024%,-185.9872:0.00024%,-202.75898:0.00024%]
[INFO] ** src:[22:38.42079%,9:25.96175%,7:18.16461%,1:17.44436%,3:0.00283%,2:0.00165%,4:0.00118%,21:0.00094%,14:0.00071%,15:0.00047%,8:0.00047%,17:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1150 (0.27148%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/423604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 0.0014 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-3-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/423604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0224 - tp: 79067.0000 - fp: 933.0000 - tn: 319067.0000 - fn: 933.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9998 - val_loss: 0.0024 - val_tp: 19996.0000 - val_fp: 4.0000 - val_tn: 79996.0000 - val_fn: 4.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-3-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/423604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/423604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 0.0017 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-3-files-41-42-batch-300000-400000
[INFO] processing batch 400000-500000/423604
[33m[INFO] loading file 43-43/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99924%,30:0.00057%,26:0.00019%]
[INFO] ** classification:[normal:64.39867%,Single Stage Single Point:35.60133%]
[INFO] ** dst:[21:43.3316%,10:21.06535%,8:18.13088%,9:17.47026%,22:0.00095%,15:0.00057%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99924%,-33.760870000000004:0.00076%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99924%,0:0.00076%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99924%,1:0.00057%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.41816%,20:25.97918%,13:18.13107%,6:17.47045%,17:0.00057%,16:0.00038%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.9786%,-0.32151:21.06535%,-1.27613:18.13069%,-0.23351:17.47007%,-0.33484:17.35281%,-71.33197:0.00057%,1.45709:0.00038%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.97822%,1:21.06535%,5:18.1305%,4:17.46969%,2:17.35262%,0:0.00363%]
[INFO] ** service:[0.0048200000000000005:99.99924%,-211.73542999999998:0.00057%,-211.08346:0.00019%]
[INFO] ** src:[22:38.41816%,9:25.97918%,7:18.13107%,1:17.47045%,14:0.00057%,15:0.00038%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1424 (0.27196%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.3180e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79062.0000 - fp: 938.0000 - tn: 319062.0000 - fn: 938.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79067.0000 - fp: 933.0000 - tn: 319067.0000 - fn: 933.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 44-44/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99809%,30:0.00076%,31:0.00057%,0:0.00038%,22:0.00019%]
[INFO] ** classification:[normal:64.36868%,Single Stage Single Point:35.63132%]
[INFO] ** dst:[21:43.32282%,10:21.04262%,8:18.16506%,9:17.46606%,22:0.00115%,15:0.00076%,18:0.00057%,25:0.00038%,24:0.00038%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99924%,0:0.00076%]
[INFO] ** i/f_name:[2:99.99924%,3:0.00076%]
[INFO] ** modbus_function_code:[0.02961:99.99809%,-33.760870000000004:0.00191%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.9979%,0:0.00191%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99809%,2:0.00115%,1:0.00076%]
[INFO] ** proxy_src_ip:[18:38.41395%,20:25.95206%,13:18.16525%,6:17.46664%,17:0.00076%,7:0.00038%,16:0.00019%,5:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95129%,-0.32151:21.04262%,-1.27613:18.16468%,-0.23351:17.46587%,-0.33484:17.37133%,-71.33197:0.00076%,-0.24151:0.00057%,1.45709:0.00038%,-64.19493:0.00038%,-0.08551:0.00038%,-1.27347:0.00038%,1.46509:0.00019%,1.47576:0.00019%,-0.24950999999999998:0.00019%,4.42897:0.00019%,-71.14931:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95072%,1:21.04262%,5:18.16468%,4:17.46549%,2:17.37114%,0:0.00535%]
[INFO] ** service:[0.0048200000000000005:99.99809%,-211.73542999999998:0.00076%,-186.43601999999998:0.00057%,-186.44547:0.00038%,-211.08818:0.00019%]
[INFO] ** src:[22:38.41395%,9:25.95206%,7:18.16525%,1:17.46664%,14:0.00076%,21:0.00038%,17:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1421 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79124.0000 - fp: 876.0000 - tn: 319124.0000 - fn: 876.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 45-45/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99905%,30:0.00057%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.41681%,Single Stage Single Point:35.58319%]
[INFO] ** dst:[21:43.32301%,10:21.09151%,8:18.12152%,9:17.46186%,22:0.00115%,15:0.00057%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99905%,-33.760870000000004:0.00095%]
[INFO] ** modbus_function_description:[7:50.00038%,11:49.99866%,0:0.00095%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99924%,1:0.00057%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.48596%,20:25.92933%,13:18.12133%,6:17.46205%,17:0.00057%,16:0.00038%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.92856%,-0.32151:21.09151%,-1.27613:18.12133%,-0.23351:17.46167%,-0.33484:17.39444%,1.45709:0.00057%,-71.33197:0.00057%,-1.02014:0.00038%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.92799%,1:21.09132%,5:18.12133%,4:17.46167%,2:17.39425%,0:0.00344%]
[INFO] ** service:[0.0048200000000000005:99.99905%,-211.73542999999998:0.00057%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.48596%,9:25.92933%,7:18.12133%,1:17.46205%,14:0.00057%,15:0.00038%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1421 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79119.0000 - fp: 881.0000 - tn: 319119.0000 - fn: 881.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79085.0000 - fp: 915.0000 - tn: 319085.0000 - fn: 915.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 46-46/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99809%,30:0.00115%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.42139%,Single Stage Single Point:35.57861%]
[INFO] ** dst:[21:43.34745%,10:21.07127%,8:18.10624%,9:17.47236%,15:0.00115%,22:0.00095%,25:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99905%,0:0.00095%]
[INFO] ** i/f_name:[2:99.99885%,3:0.00115%]
[INFO] ** modbus_function_code:[0.02961:99.99809%,-33.760870000000004:0.00191%]
[INFO] ** modbus_function_description:[11:49.99924%,7:49.99885%,0:0.00191%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99847%,1:0.00115%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.44298%,20:25.97555%,13:18.10624%,6:17.47294%,17:0.00115%,16:0.00038%,7:0.00038%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97536%,-0.32151:21.07108%,-1.27613:18.10605%,-0.23351:17.47217%,-0.33484:17.37191%,-71.33197:0.00115%,-0.24151:0.00057%,-1.02014:0.00038%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,10.192739999999999:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.97497%,1:21.07089%,5:18.10586%,4:17.47179%,2:17.37191%,0:0.00458%]
[INFO] ** service:[0.0048200000000000005:99.99828%,-211.73542999999998:0.00115%,-186.44547:0.00019%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.44298%,9:25.97555%,7:18.10624%,1:17.47294%,14:0.00115%,21:0.00038%,15:0.00038%,16:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99905%,1:0.00095%]
[INFO] ** unixtime:1423 (0.27177%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79155.0000 - fp: 845.0000 - tn: 319155.0000 - fn: 845.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 47-47/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99943%,33:0.00019%,26:0.00019%,17:0.00019%]
[INFO] ** classification:[normal:64.3958%,Single Stage Single Point:35.6042%]
[INFO] ** dst:[21:43.30486%,10:21.08884%,8:18.12725%,9:17.47657%,22:0.00172%,24:0.00038%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99943%,-33.760870000000004:0.00057%]
[INFO] ** modbus_function_description:[7:50.00095%,11:49.99847%,0:0.00057%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99981%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.46036%,20:25.9341%,13:18.12763%,6:17.47695%,16:0.00038%,7:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.93315%,-0.32151:21.08884%,-1.27613:18.12706%,-0.23351:17.47638%,-0.33484:17.37153%,1.45709:0.00057%,-0.24151:0.00057%,-1.27347:0.00038%,-1.02014:0.00038%,-71.14798:0.00019%,-61.95635:0.00019%,10.192739999999999:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.93257%,1:21.08865%,5:18.12687%,4:17.47618%,2:17.37133%,0:0.00439%]
[INFO] ** service:[0.0048200000000000005:99.99962%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.46036%,9:25.9341%,7:18.12763%,1:17.47695%,21:0.00038%,15:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1421 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0196 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 48-48/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99656%,30:0.00267%,33:0.00019%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.41758%,Single Stage Single Point:35.58242%]
[INFO] ** dst:[21:43.33046%,10:21.08311%,8:18.11254%,9:17.4695%,15:0.00267%,22:0.00095%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99771%,0:0.00229%]
[INFO] ** i/f_name:[2:99.99733%,3:0.00267%]
[INFO] ** modbus_function_code:[0.02961:99.99656%,-33.760870000000004:0.00344%]
[INFO] ** modbus_function_description:[7:49.99885%,11:49.99771%,0:0.00344%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99675%,1:0.00267%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.45444%,20:25.95931%,13:18.11293%,6:17.4695%,17:0.00267%,14:0.00057%,16:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95893%,-0.32151:21.08311%,-1.27613:18.11254%,-0.23351:17.46931%,-0.33484:17.37133%,-71.33197:0.00267%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,1.45709:0.00019%,-61.95635:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,13.431270000000001:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95855%,1:21.08311%,5:18.11254%,4:17.46931%,2:17.37114%,0:0.00535%]
[INFO] ** service:[0.0048200000000000005:99.99675%,-211.73542999999998:0.00267%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.45444%,9:25.95931%,7:18.11293%,1:17.4695%,14:0.00267%,2:0.00057%,15:0.00038%,8:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1421 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79137.0000 - fp: 863.0000 - tn: 319137.0000 - fn: 863.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 2.7401e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79066.0000 - fp: 934.0000 - tn: 319066.0000 - fn: 934.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 49-49/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99733%,30:0.00095%,17:0.00076%,22:0.00038%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.36601%,Single Stage Single Point:35.63399%]
[INFO] ** dst:[21:43.30219%,10:21.05943%,8:18.14367%,9:17.49032%,22:0.00134%,15:0.00095%,16:0.00076%,6:0.00057%,24:0.00038%,17:0.00038%]
[INFO] ** i/f_dir:[1:99.99905%,0:0.00095%]
[INFO] ** i/f_name:[2:99.99905%,3:0.00095%]
[INFO] ** modbus_function_code:[0.02961:99.99733%,-33.760870000000004:0.00267%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99771%,0:0.00267%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99847%,1:0.00095%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.4193%,20:25.94308%,13:18.14367%,6:17.49089%,17:0.00095%,1:0.00076%,21:0.00038%,16:0.00038%,14:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.94232%,-0.32151:21.05943%,-1.27613:18.14329%,-0.23351:17.49013%,-0.33484:17.35988%,-71.33197:0.00095%,-0.24151:0.00057%,1.45709:0.00038%,-1.02014:0.00038%,-71.14931:0.00038%,-1.27347:0.00038%,-71.14798:0.00019%,-58.035180000000004:0.00019%,-5.1466400000000005:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-5.08665:0.00019%,-0.24950999999999998:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.94193%,1:21.05924%,5:18.1431%,4:17.48974%,2:17.35988%,0:0.00611%]
[INFO] ** service:[0.0048200000000000005:99.99733%,-211.73542999999998:0.00095%,-205.44247:0.00076%,-211.08818:0.00038%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.4193%,9:25.94308%,7:18.14367%,1:17.49089%,14:0.00095%,3:0.00076%,15:0.00038%,4:0.00038%,2:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1422 (0.27158%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79147.0000 - fp: 853.0000 - tn: 319147.0000 - fn: 853.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79062.0000 - fp: 938.0000 - tn: 319062.0000 - fn: 938.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0218 - tp: 79024.0000 - fp: 976.0000 - tn: 319024.0000 - fn: 976.0000 - accuracy: 0.9951 - precision: 0.9878 - recall: 0.9878 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0215 - tp: 79042.0000 - fp: 958.0000 - tn: 319042.0000 - fn: 958.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9999 - val_loss: 8.0859e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79131.0000 - fp: 869.0000 - tn: 319131.0000 - fn: 869.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 50-50/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (373586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (373586, 17)

[INFO] analyzing data
[INFO] 373586 rows
[INFO] ** appi_name:[21:99.99732%,30:0.00107%,7:0.0008%,31:0.00027%,22:0.00027%,8:0.00027%]
[INFO] ** classification:[normal:64.29631%,Single Stage Single Point:35.70369%]
[INFO] ** dst:[21:43.25216%,10:21.04094%,8:18.22713%,9:17.4763%,15:0.00107%,22:0.00054%,16:0.00054%,2:0.00054%,24:0.00027%,18:0.00027%,6:0.00027%]
[INFO] ** i/f_dir:[1:99.99893%,0:0.00107%]
[INFO] ** i/f_name:[2:99.99893%,3:0.00107%]
[INFO] ** modbus_function_code:[0.02961:99.99732%,-33.760870000000004:0.00268%]
[INFO] ** modbus_function_description:[11:49.99893%,7:49.99839%,0:0.00268%]
[INFO] ** modbus_transaction_id:65535 (17.54215%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99839%,1:0.00107%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.36145%,20:25.93191%,13:18.2274%,6:17.4763%,17:0.00107%,1:0.0008%,21:0.00027%,16:0.00027%,14:0.00027%,7:0.00027%]
[INFO] ** s_port:[1.45442:25.93138%,-0.32151:21.04094%,-1.27613:18.22686%,-0.23351:17.4763%,-0.33484:17.32051%,-71.33197:0.00107%,-3.3787199999999995:0.00027%,4.33564:0.00027%,15.912510000000001:0.00027%,7.9608300000000005:0.00027%,1.46509:0.00027%,1.45709:0.00027%,-1.27347:0.00027%,-71.14931:0.00027%,-1.02014:0.00027%,-1.2708:0.00027%,0.31847:0.00027%]
[INFO] ** scada_tag:[3:25.93111%,1:21.04067%,5:18.22659%,4:17.4763%,2:17.32024%,0:0.00509%]
[INFO] ** service:[0.0048200000000000005:99.99732%,-211.73542999999998:0.00107%,-211.09762999999998:0.0008%,-186.43601999999998:0.00027%,-211.35747999999998:0.00027%,-211.08818:0.00027%]
[INFO] ** src:[22:38.36145%,9:25.93191%,7:18.2274%,1:17.4763%,14:0.00107%,3:0.0008%,21:0.00027%,15:0.00027%,4:0.00027%,2:0.00027%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1015 (0.27169%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/373586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79033.0000 - fp: 967.0000 - tn: 319033.0000 - fn: 967.0000 - accuracy: 0.9952 - precision: 0.9879 - recall: 0.9879 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/373586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79157.0000 - fp: 843.0000 - tn: 319157.0000 - fn: 843.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/373586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.3248e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/373586
[33m[INFO] epoch 4/10[0m
[33m[INFO] loading file 1-1/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99355%,30:0.00105%,22:0.00087%,17:0.0007%,7:0.0007%,31:0.00052%,26:0.00052%,23:0.00035%,18:0.00035%,0:0.00035%,28:0.00017%,27:0.00017%,24:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:77.37096%,Single Stage Single Point:22.62904%]
[INFO] ** dst:[21:43.26762%,10:21.03643%,8:18.17129%,9:17.51769%,6:0.00139%,22:0.00105%,16:0.00105%,15:0.00105%,18:0.00052%,26:0.00035%,25:0.00035%,19:0.00035%,17:0.00035%,24:0.00017%,7:0.00017%,2:0.00017%]
[INFO] ** i/f_dir:[1:99.99895%,0:0.00105%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99355%,-33.760870000000004:0.00628%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99756%,11:49.99599%,0:0.00628%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99651%,2:0.00244%,1:0.00105%]
[INFO] ** proxy_src_ip:[18:38.39581%,20:25.90788%,13:18.17147%,6:17.51804%,11:0.00122%,10:0.00122%,17:0.00105%,1:0.00105%,14:0.00087%,7:0.00052%,21:0.00035%,16:0.00035%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.90736%,-0.32151:21.03573%,-1.27613:18.17112%,-0.23351:17.51751%,-0.33484:17.36008%,-71.33197:0.00105%,-71.14931:0.00087%,-2.1481:0.0007%,-71.14798:0.00052%,-0.24151:0.00052%,-64.19493:0.00035%,-2.42942:0.00035%,4.44364:0.00035%,-1.02014:0.00035%,1.47576:0.00017%,-5.1466400000000005:0.00017%,-1.27347:0.00017%,10.67005:0.00017%,4.29964:0.00017%,-5.08665:0.00017%,1.45709:0.00017%,-68.79874000000001:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,14.253910000000001:0.00017%,4.076980000000001:0.00017%,-58.032509999999995:0.00017%,-58.035180000000004:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,0.31847:0.00017%]
[INFO] ** scada_tag:[3:25.90719%,1:21.03556%,5:18.17077%,4:17.51734%,2:17.35991%,0:0.00924%]
[INFO] ** service:[0.0048200000000000005:99.99425%,-211.73542999999998:0.00105%,-211.08818:0.00087%,-211.09762999999998:0.0007%,-205.44247:0.0007%,-211.07873999999998:0.0007%,-211.08346:0.00052%,-186.43601999999998:0.00052%,-186.44547:0.00035%,-185.9872:0.00017%,-202.75898:0.00017%]
[INFO] ** src:[22:38.39581%,9:25.90788%,7:18.17147%,1:17.51804%,11:0.00122%,10:0.00122%,14:0.00105%,3:0.00105%,2:0.00087%,21:0.00052%,15:0.00035%,4:0.00035%,8:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1557 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1120 - tp: 78081.0000 - fp: 1919.0000 - tn: 318081.0000 - fn: 1919.0000 - accuracy: 0.9904 - precision: 0.9760 - recall: 0.9760 - auc: 0.9957 - val_loss: 0.2445 - val_tp: 19031.0000 - val_fp: 969.0000 - val_tn: 79031.0000 - val_fn: 969.0000 - val_accuracy: 0.9806 - val_precision: 0.9516 - val_recall: 0.9516 - val_auc: 0.9911
[INFO] saving weights to checkpoints/lstm-epoch-4-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0193 - tp: 79819.0000 - fp: 181.0000 - tn: 319819.0000 - fn: 181.0000 - accuracy: 0.9991 - precision: 0.9977 - recall: 0.9977 - auc: 0.9997 - val_loss: 2.8342e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0069 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1579e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4259 - tp: 67355.0000 - fp: 12645.0000 - tn: 307355.0000 - fn: 12645.0000 - accuracy: 0.9368 - precision: 0.8419 - recall: 0.8419 - auc: 0.9289 - val_loss: 1.0908 - val_tp: 10612.0000 - val_fp: 9388.0000 - val_tn: 70612.0000 - val_fn: 9388.0000 - val_accuracy: 0.8122 - val_precision: 0.5306 - val_recall: 0.5306 - val_auc: 0.8722
[INFO] saving weights to checkpoints/lstm-epoch-4-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7529 - tp: 41823.0000 - fp: 38177.0000 - tn: 281823.0000 - fn: 38177.0000 - accuracy: 0.8091 - precision: 0.5228 - recall: 0.5228 - auc: 0.8827 - val_loss: 0.5922 - val_tp: 10615.0000 - val_fp: 9385.0000 - val_tn: 70615.0000 - val_fn: 9385.0000 - val_accuracy: 0.8123 - val_precision: 0.5307 - val_recall: 0.5307 - val_auc: 0.9162
[INFO] saving weights to checkpoints/lstm-epoch-4-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 2-2/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99861%,30:0.00052%,7:0.00052%,31:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:70.25834%,Single Stage Single Point:29.74166%]
[INFO] ** dst:[21:43.31417%,10:21.02475%,8:18.13677%,9:17.52187%,22:0.00087%,15:0.00052%,16:0.00035%,2:0.00035%,24:0.00017%,18:0.00017%]
[INFO] ** i/f_dir:[1:99.99948%,0:0.00052%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.99861%,-33.760870000000004:0.00139%]
[INFO] ** modbus_function_description:[7:49.99983%,11:49.99878%,0:0.00139%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9993%,1:0.00052%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.37716%,20:25.96228%,13:18.13677%,6:17.52222%,17:0.00052%,1:0.00052%,16:0.00017%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.96158%,-0.32151:21.02475%,-1.27613:18.13643%,-0.23351:17.5217%,-0.33484:17.35241%,-71.33197:0.00052%,-0.24151:0.00035%,1.45709:0.00035%,1.46509:0.00017%,1.47576:0.00017%,12.60597:0.00017%,10.67005:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,4.076980000000001:0.00017%,-3.3787199999999995:0.00017%,4.29964:0.00017%,-1.27347:0.00017%]
[INFO] ** scada_tag:[3:25.96123%,1:21.02475%,5:18.13643%,4:17.52135%,2:17.35224%,0:0.00401%]
[INFO] ** service:[0.0048200000000000005:99.99861%,-211.09762999999998:0.00052%,-211.73542999999998:0.00052%,-211.35747999999998:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.37716%,9:25.96228%,7:18.13677%,1:17.52222%,14:0.00052%,3:0.00052%,21:0.00017%,15:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1560 (0.27197%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4949 - tp: 59365.0000 - fp: 20635.0000 - tn: 299365.0000 - fn: 20635.0000 - accuracy: 0.8968 - precision: 0.7421 - recall: 0.7421 - auc: 0.9556 - val_loss: 0.4114 - val_tp: 16514.0000 - val_fp: 3486.0000 - val_tn: 76514.0000 - val_fn: 3486.0000 - val_accuracy: 0.9303 - val_precision: 0.8257 - val_recall: 0.8257 - val_auc: 0.9659
[INFO] saving weights to checkpoints/lstm-epoch-4-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4258 - tp: 64296.0000 - fp: 15704.0000 - tn: 304296.0000 - fn: 15704.0000 - accuracy: 0.9215 - precision: 0.8037 - recall: 0.8037 - auc: 0.9661 - val_loss: 0.3820 - val_tp: 16522.0000 - val_fp: 3478.0000 - val_tn: 76522.0000 - val_fn: 3478.0000 - val_accuracy: 0.9304 - val_precision: 0.8261 - val_recall: 0.8261 - val_auc: 0.9695
[INFO] saving weights to checkpoints/lstm-epoch-4-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1292 - tp: 71388.0000 - fp: 8612.0000 - tn: 311388.0000 - fn: 8612.0000 - accuracy: 0.9569 - precision: 0.8924 - recall: 0.8924 - auc: 0.9960 - val_loss: 3.9035e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8389 - tp: 57460.0000 - fp: 22540.0000 - tn: 297460.0000 - fn: 22540.0000 - accuracy: 0.8873 - precision: 0.7182 - recall: 0.7182 - auc: 0.9272 - val_loss: 0.7000 - val_tp: 10602.0000 - val_fp: 9398.0000 - val_tn: 70602.0000 - val_fn: 9398.0000 - val_accuracy: 0.8120 - val_precision: 0.5301 - val_recall: 0.5301 - val_auc: 0.9058
[INFO] saving weights to checkpoints/lstm-epoch-4-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1683 - tp: 73748.0000 - fp: 6252.0000 - tn: 313748.0000 - fn: 6252.0000 - accuracy: 0.9687 - precision: 0.9219 - recall: 0.9219 - auc: 0.9961 - val_loss: 0.0077 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 3-3/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99198%,30:0.00209%,22:0.00105%,31:0.00087%,26:0.00087%,17:0.00087%,7:0.0007%,27:0.00035%,0:0.00035%,28:0.00017%,23:0.00017%,15:0.00017%,8:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:88.37716%,Single Stage Single Point:11.62284%]
[INFO] ** dst:[21:43.30719%,10:21.08054%,8:18.15874%,9:17.44464%,6:0.00209%,15:0.00139%,18:0.00122%,16:0.00122%,22:0.00087%,2:0.00035%,7:0.00035%,25:0.00035%,17:0.00035%,12:0.00017%,24:0.00017%,19:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99861%,0:0.00139%]
[INFO] ** i/f_name:[2:99.99861%,3:0.00139%]
[INFO] ** modbus_function_code:[0.02961:99.99198%,-33.760870000000004:0.00785%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99669%,11:49.99529%,0:0.00785%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99895%,2:0.00105%]
[INFO] ** proto:[0:99.99442%,2:0.00418%,1:0.00139%]
[INFO] ** proxy_src_ip:[18:38.40523%,20:25.98268%,13:18.15909%,6:17.44499%,17:0.00209%,1:0.00139%,14:0.00122%,7:0.00087%,11:0.0007%,10:0.0007%,21:0.00052%,16:0.00017%,15:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.98198%,-0.32151:21.08036%,-1.27613:18.15839%,-0.23351:17.44446%,-0.33484:17.32486%,-71.33197:0.00139%,-71.14931:0.00105%,-71.14798:0.00105%,-64.19493:0.00035%,-1.2708:0.00035%,-0.08551:0.00035%,1.45709:0.00035%,-0.24151:0.00035%,13.86459:0.00017%,2.05573:0.00017%,6.1115699999999995:0.00017%,4.44364:0.00017%,-5.08665:0.00017%,-3.3787199999999995:0.00017%,10.192739999999999:0.00017%,4.29964:0.00017%,14.4699:0.00017%,-43.76509:0.00017%,-58.035180000000004:0.00017%,4.90362:0.00017%,4.076980000000001:0.00017%,-58.032509999999995:0.00017%,-1.27347:0.00017%,-1.02014:0.00017%,-5.1466400000000005:0.00017%,13.431270000000001:0.00017%,12.60597:0.00017%,1.47576:0.00017%,1.46509:0.00017%,14.253910000000001:0.00017%,-68.79874000000001:0.00017%,-0.24950999999999998:0.00017%,-2.1481:0.00017%,10.67005:0.00017%,-68.36943000000001:0.00017%]
[INFO] ** scada_tag:[3:25.98163%,1:21.08019%,5:18.15822%,4:17.44429%,2:17.32469%,0:0.01098%]
[INFO] ** service:[0.0048200000000000005:99.99215%,-211.73542999999998:0.00139%,-186.43601999999998:0.00122%,-211.08346:0.00105%,-211.08818:0.00105%,-205.44247:0.00087%,-211.09762999999998:0.0007%,-202.75898:0.00035%,-186.44547:0.00035%,-183.8612:0.00017%,-185.9872:0.00017%,-201.23771000000002:0.00017%,-211.35747999999998:0.00017%,-211.07873999999998:0.00017%]
[INFO] ** src:[22:38.40523%,9:25.98268%,7:18.15909%,1:17.44499%,21:0.00192%,3:0.00157%,2:0.00122%,11:0.0007%,10:0.0007%,4:0.0007%,14:0.00035%,8:0.00035%,17:0.00017%,15:0.00017%,13:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1558 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2248 - tp: 78275.0000 - fp: 1725.0000 - tn: 318275.0000 - fn: 1725.0000 - accuracy: 0.9914 - precision: 0.9784 - recall: 0.9784 - auc: 0.9899 - val_loss: 1.7842 - val_tp: 10572.0000 - val_fp: 9428.0000 - val_tn: 70572.0000 - val_fn: 9428.0000 - val_accuracy: 0.8114 - val_precision: 0.5286 - val_recall: 0.5286 - val_auc: 0.8988
[INFO] saving weights to checkpoints/lstm-epoch-4-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5341 - tp: 53411.0000 - fp: 26589.0000 - tn: 293411.0000 - fn: 26589.0000 - accuracy: 0.8671 - precision: 0.6676 - recall: 0.6676 - auc: 0.9396 - val_loss: 0.4184 - val_tp: 16539.0000 - val_fp: 3461.0000 - val_tn: 76539.0000 - val_fn: 3461.0000 - val_accuracy: 0.9308 - val_precision: 0.8270 - val_recall: 0.8270 - val_auc: 0.9715
[INFO] saving weights to checkpoints/lstm-epoch-4-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4122 - tp: 61600.0000 - fp: 18400.0000 - tn: 301600.0000 - fn: 18400.0000 - accuracy: 0.9080 - precision: 0.7700 - recall: 0.7700 - auc: 0.9701 - val_loss: 0.1768 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0760 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0051 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0255 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0014 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 4-4/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99773%,30:0.00122%,31:0.00035%,33:0.00017%,26:0.00017%,23:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:92.36732%,Single Stage Single Point:7.63268%]
[INFO] ** dst:[21:43.34938%,10:20.951%,8:18.17565%,9:17.5203%,22:0.00122%,15:0.00122%,24:0.00035%,18:0.00035%,19:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99895%,0:0.00105%]
[INFO] ** i/f_name:[2:99.99878%,3:0.00122%]
[INFO] ** modbus_function_code:[0.02961:99.99773%,-33.760870000000004:0.00227%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99773%,0:0.00227%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99895%,2:0.00105%]
[INFO] ** proto:[0:99.99826%,1:0.00122%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.26227%,20:26.03847%,13:18.17583%,6:17.52065%,17:0.00122%,16:0.00052%,21:0.00035%,14:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.03777%,-0.32151:20.95083%,-1.27613:18.1753%,-0.23351:17.52013%,-0.33484:17.31144%,-71.33197:0.00122%,-1.02014:0.00052%,1.45709:0.00035%,-0.08551:0.00035%,-1.27347:0.00035%,-0.24151:0.00035%,14.4699:0.00017%,4.44364:0.00017%,-71.14798:0.00017%,-1.2708:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:26.03742%,1:20.95065%,5:18.1753%,4:17.51978%,2:17.31127%,0:0.00558%]
[INFO] ** service:[0.0048200000000000005:99.99791%,-211.73542999999998:0.00122%,-186.43601999999998:0.00035%,-183.8612:0.00017%,-211.08346:0.00017%,-211.07873999999998:0.00017%]
[INFO] ** src:[22:38.26227%,9:26.03847%,7:18.17583%,1:17.52065%,21:0.00105%,15:0.00052%,4:0.00035%,17:0.00017%,14:0.00017%,8:0.00017%,3:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1568 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0188 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.8283e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0158 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1140e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0140 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7907e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0127 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0593e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.9688 - tp: 55385.0000 - fp: 24615.0000 - tn: 295385.0000 - fn: 24615.0000 - accuracy: 0.8769 - precision: 0.6923 - recall: 0.6923 - auc: 0.9128 - val_loss: 0.8495 - val_tp: 7842.0000 - val_fp: 12158.0000 - val_tn: 67842.0000 - val_fn: 12158.0000 - val_accuracy: 0.7568 - val_precision: 0.3921 - val_recall: 0.3921 - val_auc: 0.8616
[INFO] saving weights to checkpoints/lstm-epoch-4-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 5-5/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99616%,30:0.00279%,37:0.00017%,26:0.00017%,12:0.00017%,9:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:88.95144%,Single Stage Single Point:11.04856%]
[INFO] ** dst:[21:43.36473%,10:20.77108%,8:18.23737%,9:17.62229%,15:0.00279%,22:0.00087%,25:0.00017%,24:0.00017%,6:0.00017%,2:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99756%,0:0.00244%]
[INFO] ** i/f_name:[2:99.99721%,3:0.00279%]
[INFO] ** modbus_function_code:[0.02961:99.99616%,-33.760870000000004:0.00384%]
[INFO] ** modbus_function_description:[7:49.99861%,11:49.99756%,0:0.00384%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99773%,2:0.00227%]
[INFO] ** proto:[0:99.99686%,1:0.00279%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.00895%,20:26.12721%,13:18.23737%,6:17.62247%,17:0.00279%,1:0.00035%,21:0.00017%,16:0.00017%,7:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.12651%,-0.32151:20.77073%,-1.27613:18.2372%,-0.23351:17.62212%,-0.33484:17.23822%,-71.33197:0.00279%,-0.24151:0.00035%,1.45709:0.00035%,1.47576:0.00017%,1.46509:0.00017%,-49.275529999999996:0.00017%,-1.27347:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,2.22906:0.00017%,14.4699:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.12616%,1:20.77056%,5:18.23702%,4:17.62212%,2:17.23822%,0:0.00593%]
[INFO] ** service:[0.0048200000000000005:99.99651%,-211.73542999999998:0.00279%,-183.8612:0.00017%,-211.08346:0.00017%,-211.35747999999998:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.00895%,9:26.12721%,7:18.23737%,1:17.62247%,21:0.00244%,14:0.00052%,3:0.00035%,16:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1571 (0.27389%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3511 - tp: 72968.0000 - fp: 7032.0000 - tn: 312968.0000 - fn: 7032.0000 - accuracy: 0.9648 - precision: 0.9121 - recall: 0.9121 - auc: 0.9789 - val_loss: 0.1154 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5783 - tp: 54913.0000 - fp: 25087.0000 - tn: 294913.0000 - fn: 25087.0000 - accuracy: 0.8746 - precision: 0.6864 - recall: 0.6864 - auc: 0.9511 - val_loss: 0.4186 - val_tp: 13849.0000 - val_fp: 6151.0000 - val_tn: 73849.0000 - val_fn: 6151.0000 - val_accuracy: 0.8770 - val_precision: 0.6924 - val_recall: 0.6924 - val_auc: 0.9760
[INFO] saving weights to checkpoints/lstm-epoch-4-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3610 - tp: 62572.0000 - fp: 17428.0000 - tn: 302572.0000 - fn: 17428.0000 - accuracy: 0.9129 - precision: 0.7821 - recall: 0.7821 - auc: 0.9780 - val_loss: 0.4718 - val_tp: 12830.0000 - val_fp: 7170.0000 - val_tn: 72830.0000 - val_fn: 7170.0000 - val_accuracy: 0.8566 - val_precision: 0.6415 - val_recall: 0.6415 - val_auc: 0.9665
[INFO] saving weights to checkpoints/lstm-epoch-4-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0803 - tp: 78622.0000 - fp: 1378.0000 - tn: 318622.0000 - fn: 1378.0000 - accuracy: 0.9931 - precision: 0.9828 - recall: 0.9828 - auc: 0.9992 - val_loss: 0.0023 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0405e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 6-6/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99599%,30:0.00314%,31:0.00017%,27:0.00017%,26:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:92.95572%,Single Stage Single Point:7.04428%]
[INFO] ** dst:[21:43.37606%,10:20.73046%,8:18.27869%,9:17.61009%,15:0.00314%,22:0.00052%,25:0.00017%,24:0.00017%,18:0.00017%,12:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99704%,0:0.00296%]
[INFO] ** i/f_name:[2:99.99686%,3:0.00314%]
[INFO] ** modbus_function_code:[0.02961:99.99599%,-33.760870000000004:0.00401%]
[INFO] ** modbus_function_description:[7:49.99878%,11:49.99721%,0:0.00401%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.99599%,1:0.00314%,2:0.00087%]
[INFO] ** proxy_src_ip:[18:37.94061%,20:26.16608%,13:18.27886%,6:17.61026%,17:0.00314%,14:0.00052%,16:0.00035%,11:0.00017%]
[INFO] ** s_port:[1.45442:26.16574%,-0.32151:20.73046%,-1.27613:18.27834%,-0.23351:17.60991%,-0.33484:17.21015%,-71.33197:0.00314%,-1.02014:0.00035%,-71.14798:0.00017%,-64.19493:0.00017%,4.90362:0.00017%,-1.2708:0.00017%,-0.24151:0.00017%,13.431270000000001:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-68.36943000000001:0.00017%]
[INFO] ** scada_tag:[3:26.16556%,1:20.73011%,5:18.27817%,4:17.60957%,2:17.20997%,0:0.00662%]
[INFO] ** service:[0.0048200000000000005:99.99599%,-211.73542999999998:0.00314%,-211.08346:0.00017%,-201.23771000000002:0.00017%,-202.75898:0.00017%,-186.44547:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:37.94061%,9:26.16608%,7:18.27886%,1:17.61026%,14:0.00314%,2:0.00052%,15:0.00035%,10:0.00017%]
[INFO] ** type:[0:99.99913%,1:0.00087%]
[INFO] ** unixtime:1570 (0.27372%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0148 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9707e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0129 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.9174e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0114 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7888e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0102 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6958e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2776 - tp: 73340.0000 - fp: 6660.0000 - tn: 313340.0000 - fn: 6660.0000 - accuracy: 0.9667 - precision: 0.9168 - recall: 0.9168 - auc: 0.9868 - val_loss: 0.5606 - val_tp: 12742.0000 - val_fp: 7258.0000 - val_tn: 72742.0000 - val_fn: 7258.0000 - val_accuracy: 0.8548 - val_precision: 0.6371 - val_recall: 0.6371 - val_auc: 0.9671
[INFO] saving weights to checkpoints/lstm-epoch-4-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 7-7/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99547%,30:0.00157%,22:0.00087%,17:0.0007%,26:0.00052%,31:0.00035%,28:0.00017%,27:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:80.31577%,Single Stage Single Point:19.68423%]
[INFO] ** dst:[21:43.36368%,10:20.73848%,8:18.25149%,9:17.64007%,15:0.00157%,22:0.00139%,6:0.00139%,16:0.0007%,24:0.00035%,18:0.00035%,17:0.00035%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.99843%,0:0.00157%]
[INFO] ** i/f_name:[2:99.99843%,3:0.00157%]
[INFO] ** modbus_function_code:[0.02961:99.99547%,-33.760870000000004:0.00453%]
[INFO] ** modbus_function_description:[7:49.99843%,11:49.99704%,0:0.00453%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99651%,2:0.00192%,1:0.00157%]
[INFO] ** proxy_src_ip:[18:37.96031%,20:26.14255%,13:18.25184%,6:17.64025%,17:0.00157%,11:0.0007%,1:0.0007%,21:0.00052%,16:0.00052%,14:0.00035%,7:0.00035%,10:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.14168%,-0.32151:20.73848%,-1.27613:18.25132%,-0.23351:17.6399%,-0.33484:17.22183%,-71.33197:0.00157%,-71.14931:0.00087%,-1.02014:0.00052%,-71.14798:0.00052%,1.45709:0.00052%,-0.24151:0.00035%,-1.27347:0.00035%,1.47576:0.00017%,1.46509:0.00017%,14.253910000000001:0.00017%,-1.2708:0.00017%,-58.035180000000004:0.00017%,-58.032509999999995:0.00017%,-68.79874000000001:0.00017%,-43.76509:0.00017%,2.05573:0.00017%,6.1115699999999995:0.00017%,-5.08665:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:26.14133%,1:20.73848%,5:18.25114%,4:17.63973%,2:17.22165%,0:0.00767%]
[INFO] ** service:[0.0048200000000000005:99.99547%,-211.73542999999998:0.00157%,-211.08818:0.00087%,-205.44247:0.0007%,-211.08346:0.00052%,-186.43601999999998:0.00035%,-211.09762999999998:0.00017%,-185.9872:0.00017%,-202.75898:0.00017%]
[INFO] ** src:[22:37.96031%,9:26.14255%,7:18.25184%,1:17.64025%,14:0.00157%,10:0.0007%,3:0.0007%,15:0.00052%,4:0.00052%,21:0.00035%,2:0.00035%,11:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1567 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1352 - tp: 73244.0000 - fp: 6756.0000 - tn: 313244.0000 - fn: 6756.0000 - accuracy: 0.9662 - precision: 0.9155 - recall: 0.9155 - auc: 0.9967 - val_loss: 3.7484e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0272 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 7.6263e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0242 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 3.4438e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3174 - tp: 73445.0000 - fp: 6555.0000 - tn: 313445.0000 - fn: 6555.0000 - accuracy: 0.9672 - precision: 0.9181 - recall: 0.9181 - auc: 0.9848 - val_loss: 0.0823 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0273 - tp: 79992.0000 - fp: 8.0000 - tn: 319992.0000 - fn: 8.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 0.0015 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 8-8/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99721%,30:0.00105%,0:0.00052%,24:0.00017%,23:0.00017%,22:0.00017%,18:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:95.01766%,Single Stage Single Point:4.98234%]
[INFO] ** dst:[21:43.4179%,10:20.80176%,8:18.19483%,9:17.58202%,22:0.00122%,15:0.00105%,25:0.00052%,19:0.00035%,26:0.00017%,24:0.00017%]
[INFO] ** i/f_dir:[1:99.9993%,0:0.0007%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99721%,-33.760870000000004:0.00262%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99965%,11:49.99756%,0:0.00262%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99965%,2:0.00035%]
[INFO] ** proto:[0:99.99826%,1:0.00105%,2:0.0007%]
[INFO] ** proxy_src_ip:[18:38.08461%,20:26.13558%,13:18.19413%,6:17.58237%,17:0.00105%,10:0.00105%,16:0.00052%,14:0.00035%,11:0.00017%,5:0.00017%]
[INFO] ** s_port:[1.45442:26.13505%,-0.32151:20.80176%,-1.27613:18.19396%,-0.23351:17.58184%,-0.33484:17.28285%,-71.33197:0.00105%,-15.039579999999999:0.0007%,-1.02014:0.00052%,-64.19493:0.00052%,1.45709:0.00035%,-0.24151:0.00035%,4.66896:0.00035%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,-71.14931:0.00017%]
[INFO] ** scada_tag:[3:26.13453%,1:20.80159%,5:18.19396%,4:17.58167%,2:17.28267%,0:0.00558%]
[INFO] ** service:[0.0048200000000000005:99.99791%,-211.73542999999998:0.00105%,-186.44547:0.00052%,-211.07873999999998:0.00035%,-211.08818:0.00017%]
[INFO] ** src:[22:38.08461%,9:26.13558%,7:18.19413%,1:17.58237%,11:0.00105%,14:0.0007%,15:0.00052%,21:0.00035%,2:0.00035%,16:0.00017%,10:0.00017%]
[INFO] ** type:[0:99.99948%,1:0.00035%,2:0.00017%]
[INFO] ** unixtime:1570 (0.27372%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0120 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.1631e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0104 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0691e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0086 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8160e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0075 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.0411e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4230 - tp: 67989.0000 - fp: 12011.0000 - tn: 307989.0000 - fn: 12011.0000 - accuracy: 0.9399 - precision: 0.8499 - recall: 0.8499 - auc: 0.9769 - val_loss: 0.2651 - val_tp: 16386.0000 - val_fp: 3614.0000 - val_tn: 76386.0000 - val_fn: 3614.0000 - val_accuracy: 0.9277 - val_precision: 0.8193 - val_recall: 0.8193 - val_auc: 0.9842
[INFO] saving weights to checkpoints/lstm-epoch-4-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 9-9/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99826%,30:0.00105%,31:0.00035%,26:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:94.27636%,Single Stage Single Point:5.72364%]
[INFO] ** dst:[21:43.37362%,10:20.77387%,8:18.27782%,9:17.57191%,15:0.00105%,22:0.00087%,18:0.00035%,25:0.00017%,24:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99895%,0:0.00105%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99826%,-33.760870000000004:0.00174%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99826%,0:0.00174%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99965%,2:0.00035%]
[INFO] ** proto:[0:99.99826%,1:0.00105%,2:0.0007%]
[INFO] ** proxy_src_ip:[18:38.01069%,20:26.13732%,13:18.27782%,6:17.57226%,17:0.00105%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.13662%,-0.32151:20.77387%,-1.27613:18.27747%,-0.23351:17.57173%,-0.33484:17.23682%,-71.33197:0.00105%,-0.24151:0.00035%,1.45709:0.00035%,-0.08551:0.00035%,1.46509:0.00017%,1.47576:0.00017%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.13627%,1:20.77369%,5:18.27747%,4:17.57156%,2:17.23665%,0:0.00436%]
[INFO] ** service:[0.0048200000000000005:99.99826%,-211.73542999999998:0.00105%,-186.43601999999998:0.00035%,-211.08346:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.01069%,9:26.13732%,7:18.27782%,1:17.57226%,14:0.0007%,21:0.00035%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1570 (0.27372%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2773 - tp: 65522.0000 - fp: 14478.0000 - tn: 305522.0000 - fn: 14478.0000 - accuracy: 0.9276 - precision: 0.8190 - recall: 0.8190 - auc: 0.9835 - val_loss: 0.2531 - val_tp: 16391.0000 - val_fp: 3609.0000 - val_tn: 76391.0000 - val_fn: 3609.0000 - val_accuracy: 0.9278 - val_precision: 0.8195 - val_recall: 0.8195 - val_auc: 0.9840
[INFO] saving weights to checkpoints/lstm-epoch-4-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2709 - tp: 65756.0000 - fp: 14244.0000 - tn: 305756.0000 - fn: 14244.0000 - accuracy: 0.9288 - precision: 0.8220 - recall: 0.8220 - auc: 0.9839 - val_loss: 0.2230 - val_tp: 19686.0000 - val_fp: 314.0000 - val_tn: 79686.0000 - val_fn: 314.0000 - val_accuracy: 0.9937 - val_precision: 0.9843 - val_recall: 0.9843 - val_auc: 0.9995
[INFO] saving weights to checkpoints/lstm-epoch-4-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0474 - tp: 79778.0000 - fp: 222.0000 - tn: 319778.0000 - fn: 222.0000 - accuracy: 0.9989 - precision: 0.9972 - recall: 0.9972 - auc: 1.0000 - val_loss: 0.0040 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0133 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.1670e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0089 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4077e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 10-10/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99634%,30:0.00174%,31:0.00035%,26:0.00017%,24:0.00017%,23:0.00017%,22:0.00017%,18:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:94.67403%,Single Stage Single Point:5.32597%]
[INFO] ** dst:[21:43.4118%,10:20.80769%,8:18.2222%,9:17.55447%,15:0.00174%,22:0.00052%,24:0.00035%,19:0.00035%,18:0.00035%,26:0.00017%,25:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99843%,0:0.00157%]
[INFO] ** i/f_name:[2:99.99826%,3:0.00174%]
[INFO] ** modbus_function_code:[0.02961:99.99634%,-33.760870000000004:0.00349%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99895%,11:49.99738%,0:0.00349%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.9993%,1:0.0007%]
[INFO] ** proto:[0:99.99738%,1:0.00174%,2:0.00087%]
[INFO] ** proxy_src_ip:[18:38.08426%,20:26.13575%,13:18.22238%,6:17.55378%,17:0.00174%,10:0.00087%,14:0.00035%,21:0.00017%,16:0.00017%,5:0.00017%,2:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.13505%,-0.32151:20.80769%,-1.27613:18.22185%,-0.23351:17.55343%,-0.33484:17.27657%,-71.33197:0.00174%,-10.51843:0.0007%,-0.08551:0.00035%,-1.27347:0.00035%,5.71692:0.00035%,1.47576:0.00035%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-71.14931:0.00017%,-64.19493:0.00017%,1.45709:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.1347%,1:20.80752%,5:18.22185%,4:17.55325%,2:17.2764%,0:0.00628%]
[INFO] ** service:[0.0048200000000000005:99.99704%,-211.73542999999998:0.00174%,-211.07873999999998:0.00035%,-186.43601999999998:0.00035%,-211.08346:0.00017%,-186.44547:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.08426%,9:26.13575%,7:18.22238%,1:17.55378%,14:0.00174%,11:0.00087%,2:0.00035%,17:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%]
[INFO] ** type:[0:99.99861%,1:0.00122%,2:0.00017%]
[INFO] ** unixtime:1567 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0068 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1712e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0058 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3206e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3072 - tp: 70340.0000 - fp: 9660.0000 - tn: 310340.0000 - fn: 9660.0000 - accuracy: 0.9517 - precision: 0.8792 - recall: 0.8792 - auc: 0.9849 - val_loss: 0.4337 - val_tp: 12813.0000 - val_fp: 7187.0000 - val_tn: 72813.0000 - val_fn: 7187.0000 - val_accuracy: 0.8563 - val_precision: 0.6406 - val_recall: 0.6406 - val_auc: 0.9677
[INFO] saving weights to checkpoints/lstm-epoch-4-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2722 - tp: 65931.0000 - fp: 14069.0000 - tn: 305931.0000 - fn: 14069.0000 - accuracy: 0.9297 - precision: 0.8241 - recall: 0.8241 - auc: 0.9843 - val_loss: 0.1880 - val_tp: 19962.0000 - val_fp: 38.0000 - val_tn: 79962.0000 - val_fn: 38.0000 - val_accuracy: 0.9992 - val_precision: 0.9981 - val_recall: 0.9981 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0436 - tp: 79848.0000 - fp: 152.0000 - tn: 319848.0000 - fn: 152.0000 - accuracy: 0.9992 - precision: 0.9981 - recall: 0.9981 - auc: 1.0000 - val_loss: 0.0060 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 11-11/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99895%,31:0.00035%,30:0.00035%,26:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.39314%,10:20.87411%,8:18.19344%,9:17.53704%,22:0.00122%,18:0.00035%,15:0.00035%,25:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99965%,0:0.00035%]
[INFO] ** i/f_name:[2:99.99965%,3:0.00035%]
[INFO] ** modbus_function_code:[0.02961:99.99895%,-33.760870000000004:0.00105%]
[INFO] ** modbus_function_description:[7:50.00052%,11:49.99843%,0:0.00105%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99895%,2:0.0007%,1:0.00035%]
[INFO] ** proxy_src_ip:[18:38.15069%,20:26.11692%,13:18.19344%,6:17.53739%,16:0.00052%,17:0.00035%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.1164%,-0.32151:20.87411%,-1.27613:18.19326%,-0.23351:17.53686%,-0.33484:17.27657%,-0.24151:0.00052%,-1.02014:0.00052%,-0.08551:0.00035%,-71.33197:0.00035%,-71.14798:0.00017%,1.45709:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:26.11605%,1:20.87394%,5:18.19309%,4:17.53652%,2:17.2764%,0:0.00401%]
[INFO] ** service:[0.0048200000000000005:99.99895%,-211.73542999999998:0.00035%,-186.43601999999998:0.00035%,-211.08346:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.15069%,9:26.11692%,7:18.19344%,1:17.53739%,15:0.00052%,14:0.00035%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1568 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0107 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0071 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2384e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0049 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4688e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0044 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.0806e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0042 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3246e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 12-12/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99791%,30:0.00192%,9:0.00017%]
[INFO] ** classification:[normal:93.6904%,Single Stage Single Point:6.3096%]
[INFO] ** dst:[21:43.40657%,10:20.8851%,8:18.17635%,9:17.52902%,15:0.00192%,22:0.00052%,24:0.00035%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99843%,0:0.00157%]
[INFO] ** i/f_name:[2:99.99808%,3:0.00192%]
[INFO] ** modbus_function_code:[0.02961:99.99791%,-33.760870000000004:0.00209%]
[INFO] ** modbus_function_description:[7:49.99965%,11:49.99826%,0:0.00209%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99843%,2:0.00157%]
[INFO] ** proto:[0:99.99808%,1:0.00192%]
[INFO] ** proxy_src_ip:[18:38.15871%,20:26.13331%,13:18.17652%,6:17.52919%,17:0.00192%,16:0.00017%,1:0.00017%]
[INFO] ** s_port:[1.45442:26.13279%,-0.32151:20.8851%,-1.27613:18.176%,-0.23351:17.52884%,-0.33484:17.27361%,-71.33197:0.00192%,-1.27347:0.00035%,1.45709:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:26.13244%,1:20.8851%,5:18.176%,4:17.5285%,2:17.27361%,0:0.00436%]
[INFO] ** service:[0.0048200000000000005:99.99791%,-211.73542999999998:0.00192%,-183.8612:0.00017%]
[INFO] ** src:[22:38.15871%,9:26.13331%,7:18.17652%,1:17.52919%,21:0.00157%,14:0.00035%,15:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1568 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0037 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9762e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0034 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0602e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2381 - tp: 74395.0000 - fp: 5605.0000 - tn: 314395.0000 - fn: 5605.0000 - accuracy: 0.9720 - precision: 0.9299 - recall: 0.9299 - auc: 0.9903 - val_loss: 0.6473 - val_tp: 12841.0000 - val_fp: 7159.0000 - val_tn: 72841.0000 - val_fn: 7159.0000 - val_accuracy: 0.8568 - val_precision: 0.6421 - val_recall: 0.6421 - val_auc: 0.9680
[INFO] saving weights to checkpoints/lstm-epoch-4-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2570 - tp: 69480.0000 - fp: 10520.0000 - tn: 309480.0000 - fn: 10520.0000 - accuracy: 0.9474 - precision: 0.8685 - recall: 0.8685 - auc: 0.9896 - val_loss: 0.5127 - val_tp: 12854.0000 - val_fp: 7146.0000 - val_tn: 72854.0000 - val_fn: 7146.0000 - val_accuracy: 0.8571 - val_precision: 0.6427 - val_recall: 0.6427 - val_auc: 0.9681
[INFO] saving weights to checkpoints/lstm-epoch-4-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0643 - tp: 78841.0000 - fp: 1159.0000 - tn: 318841.0000 - fn: 1159.0000 - accuracy: 0.9942 - precision: 0.9855 - recall: 0.9855 - auc: 0.9996 - val_loss: 0.0081 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 13-13/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99651%,31:0.0007%,30:0.00052%,26:0.00052%,0:0.00052%,22:0.00035%,27:0.00017%,24:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:86.66059%,Single Stage Single Point:13.33941%]
[INFO] ** dst:[21:43.35653%,10:20.80368%,8:18.27695%,9:17.55883%,22:0.00105%,6:0.00087%,18:0.0007%,25:0.00052%,15:0.00052%,24:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.99965%,0:0.00035%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.99651%,-33.760870000000004:0.00331%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99878%,11:49.99773%,0:0.00331%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99721%,2:0.00227%,1:0.00052%]
[INFO] ** proxy_src_ip:[18:38.05027%,20:26.1103%,13:18.27712%,6:17.55831%,10:0.00105%,11:0.00087%,17:0.00052%,16:0.00052%,7:0.00035%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.10977%,-0.32151:20.80368%,-1.27613:18.27677%,-0.23351:17.55796%,-0.33484:17.24659%,-9.78512:0.0007%,-64.19493:0.00052%,-1.02014:0.00052%,-71.14798:0.00052%,-71.33197:0.00052%,-0.24151:0.00035%,-71.14931:0.00035%,-0.08551:0.00035%,1.47576:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-1.2708:0.00017%,-68.79874000000001:0.00017%,6.1115699999999995:0.00017%,14.540560000000001:0.00017%,1.45709:0.00017%]
[INFO] ** scada_tag:[3:26.10942%,1:20.80351%,5:18.27677%,4:17.55796%,2:17.24641%,0:0.00593%]
[INFO] ** service:[0.0048200000000000005:99.99721%,-186.43601999999998:0.0007%,-211.08346:0.00052%,-186.44547:0.00052%,-211.73542999999998:0.00052%,-211.08818:0.00035%,-202.75898:0.00017%]
[INFO] ** src:[22:38.05027%,9:26.1103%,7:18.27712%,1:17.55831%,11:0.00105%,10:0.00087%,15:0.00052%,14:0.00052%,21:0.00035%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99965%,2:0.00017%,1:0.00017%]
[INFO] ** unixtime:1567 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0093 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0024 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0076 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3374e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0050 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4600e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2694 - tp: 72770.0000 - fp: 7230.0000 - tn: 312770.0000 - fn: 7230.0000 - accuracy: 0.9639 - precision: 0.9096 - recall: 0.9096 - auc: 0.9883 - val_loss: 0.5437 - val_tp: 12841.0000 - val_fp: 7159.0000 - val_tn: 72841.0000 - val_fn: 7159.0000 - val_accuracy: 0.8568 - val_precision: 0.6421 - val_recall: 0.6421 - val_auc: 0.9680
[INFO] saving weights to checkpoints/lstm-epoch-4-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1016 - tp: 75183.0000 - fp: 4817.0000 - tn: 315183.0000 - fn: 4817.0000 - accuracy: 0.9759 - precision: 0.9398 - recall: 0.9398 - auc: 0.9983 - val_loss: 2.7612e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 14-14/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99895%,31:0.00035%,30:0.00035%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:92.37272%,Single Stage Single Point:7.62728%]
[INFO] ** dst:[21:43.35392%,10:20.80856%,8:18.26474%,9:17.57069%,22:0.0007%,24:0.00035%,18:0.00035%,15:0.00035%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.99965%,3:0.00035%]
[INFO] ** modbus_function_code:[0.02961:99.99895%,-33.760870000000004:0.00105%]
[INFO] ** modbus_function_description:[7:50.00035%,11:49.99861%,0:0.00105%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99913%,2:0.00052%,1:0.00035%]
[INFO] ** proxy_src_ip:[18:38.05253%,20:26.11047%,13:18.26492%,6:17.57086%,17:0.00035%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.10977%,-0.32151:20.80856%,-1.27613:18.26439%,-0.23351:17.57051%,-0.33484:17.24397%,-1.27347:0.00035%,-0.08551:0.00035%,-71.33197:0.00035%,1.45709:0.00035%,1.47576:0.00017%,1.46509:0.00017%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,-0.24950999999999998:0.00017%,14.4699:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.10942%,1:20.80856%,5:18.26422%,4:17.57016%,2:17.2438%,0:0.00384%]
[INFO] ** service:[0.0048200000000000005:99.99895%,-211.73542999999998:0.00035%,-186.43601999999998:0.00035%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.05253%,9:26.11047%,7:18.26492%,1:17.57086%,14:0.00035%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1567 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0271 - tp: 79069.0000 - fp: 931.0000 - tn: 319069.0000 - fn: 931.0000 - accuracy: 0.9953 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 8.1992e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3374 - tp: 70640.0000 - fp: 9360.0000 - tn: 310640.0000 - fn: 9360.0000 - accuracy: 0.9532 - precision: 0.8830 - recall: 0.8830 - auc: 0.9835 - val_loss: 0.1083 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0240 - tp: 79984.0000 - fp: 16.0000 - tn: 319984.0000 - fn: 16.0000 - accuracy: 0.9999 - precision: 0.9998 - recall: 0.9998 - auc: 1.0000 - val_loss: 0.0017 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0094 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.6476e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0075 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7358e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 15-15/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99634%,30:0.00296%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:90.3711%,Single Stage Multi Point:9.6282%,Single Stage Single Point:0.0007%]
[INFO] ** dst:[21:43.30528%,10:20.77666%,8:18.31112%,9:17.60172%,15:0.00296%,22:0.00157%,25:0.00017%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99721%,0:0.00279%]
[INFO] ** i/f_name:[2:99.99704%,3:0.00296%]
[INFO] ** modbus_function_code:[0.02961:99.99634%,-33.760870000000004:0.00366%]
[INFO] ** modbus_function_description:[7:49.99913%,11:49.99721%,0:0.00366%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99738%,2:0.00262%]
[INFO] ** proto:[0:99.99669%,1:0.00296%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.00999%,20:26.07264%,13:18.31077%,6:17.60224%,17:0.00296%,16:0.0007%,7:0.00035%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.07177%,-0.32151:20.77648%,-1.27613:18.31059%,-0.23351:17.60155%,-0.33484:17.23351%,-71.33197:0.00296%,-1.02014:0.0007%,-0.24151:0.00052%,1.46509:0.00035%,1.45709:0.00035%,1.47576:0.00017%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,-61.95768:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.07142%,1:20.77631%,5:18.31059%,4:17.6012%,2:17.23316%,0:0.00732%]
[INFO] ** service:[0.0048200000000000005:99.99651%,-211.73542999999998:0.00296%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.00999%,9:26.07264%,7:18.31077%,1:17.60224%,21:0.00296%,15:0.0007%,14:0.00035%,16:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1576 (0.27476%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0063 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4538e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0062 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6123e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0055 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.5603e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0048 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.5905e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.3050 - tp: 68578.0000 - fp: 11422.0000 - tn: 308578.0000 - fn: 11422.0000 - accuracy: 0.9429 - precision: 0.8572 - recall: 0.8572 - auc: 0.9096 - val_loss: 7.5377 - val_tp: 10647.0000 - val_fp: 9353.0000 - val_tn: 70647.0000 - val_fn: 9353.0000 - val_accuracy: 0.8129 - val_precision: 0.5324 - val_recall: 0.5324 - val_auc: 0.7077
[INFO] saving weights to checkpoints/lstm-epoch-4-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 16-16/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513276, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513276, 17)

[INFO] analyzing data
[INFO] 513276 rows
[INFO] ** appi_name:[21:99.99805%,30:0.00175%,33:0.00019%]
[INFO] ** classification:[normal:79.94062%,Single Stage Multi Point:20.05938%]
[INFO] ** dst:[21:43.34276%,10:20.79486%,8:18.26152%,9:17.59774%,15:0.00175%,22:0.00117%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99825%,0:0.00175%]
[INFO] ** i/f_name:[2:99.99825%,3:0.00175%]
[INFO] ** modbus_function_code:[0.02961:99.99805%,-33.760870000000004:0.00195%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99805%,0:0.00195%]
[INFO] ** modbus_transaction_id:65536 (12.76818%)
[INFO] ** orig:[0:99.99825%,2:0.00175%]
[INFO] ** proto:[0:99.99825%,1:0.00175%]
[INFO] ** proxy_src_ip:[18:38.04035%,20:26.09746%,13:18.26191%,6:17.59794%,17:0.00175%,16:0.00039%,21:0.00019%]
[INFO] ** s_port:[1.45442:26.09688%,-0.32151:20.79466%,-1.27613:18.26152%,-0.23351:17.59755%,-0.33484:17.24569%,-71.33197:0.00175%,1.45709:0.00039%,-0.24151:0.00039%,-1.02014:0.00039%,-1.27347:0.00019%,1.47576:0.00019%,-49.275529999999996:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.09649%,1:20.79447%,5:18.26133%,4:17.59716%,2:17.2455%,0:0.00507%]
[INFO] ** service:[0.0048200000000000005:99.99825%,-211.73542999999998:0.00175%]
[INFO] ** src:[22:38.04035%,9:26.09746%,7:18.26191%,1:17.59794%,21:0.00175%,15:0.00039%,4:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1406 (0.27393%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5522 - tp: 42526.0000 - fp: 37474.0000 - tn: 282526.0000 - fn: 37474.0000 - accuracy: 0.8126 - precision: 0.5316 - recall: 0.5316 - auc: 0.7046 - val_loss: 7.5812 - val_tp: 10593.0000 - val_fp: 9407.0000 - val_tn: 70593.0000 - val_fn: 9407.0000 - val_accuracy: 0.8119 - val_precision: 0.5296 - val_recall: 0.5296 - val_auc: 0.7060
[INFO] saving weights to checkpoints/lstm-epoch-4-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5483 - tp: 42546.0000 - fp: 37454.0000 - tn: 282546.0000 - fn: 37454.0000 - accuracy: 0.8127 - precision: 0.5318 - recall: 0.5318 - auc: 0.7041 - val_loss: 7.5465 - val_tp: 10636.0000 - val_fp: 9364.0000 - val_tn: 70636.0000 - val_fn: 9364.0000 - val_accuracy: 0.8127 - val_precision: 0.5318 - val_recall: 0.5318 - val_auc: 0.7074
[INFO] saving weights to checkpoints/lstm-epoch-4-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.8688 - tp: 70739.0000 - fp: 9261.0000 - tn: 310739.0000 - fn: 9261.0000 - accuracy: 0.9537 - precision: 0.8842 - recall: 0.8842 - auc: 0.9270 - val_loss: 2.1188e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0030 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4326e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0027 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.9815e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-15-16-batch-400000-500000
[INFO] processing batch 500000-600000/513276
[33m[INFO] loading file 17-17/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513276, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513276, 17)

[INFO] analyzing data
[INFO] 513276 rows
[INFO] ** appi_name:[21:99.99708%,7:0.00058%,26:0.00039%,0:0.00039%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:93.98959%,Multi Stage Multi Point:6.01041%]
[INFO] ** dst:[21:43.34802%,10:20.85038%,8:18.2019%,9:17.59658%,22:0.00078%,6:0.00058%,25:0.00039%,16:0.00039%,2:0.00039%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99708%,-33.760870000000004:0.00273%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99961%,11:49.99747%,0:0.00273%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.76818%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99864%,2:0.00136%]
[INFO] ** proxy_src_ip:[18:38.08633%,20:26.11285%,13:18.20132%,6:17.59638%,10:0.00117%,11:0.00097%,1:0.00039%,16:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.11188%,-0.32151:20.85038%,-1.27613:18.20093%,-0.23351:17.59619%,-0.33484:17.23595%,6.0369:0.00078%,-64.19493:0.00039%,1.47576:0.00039%,-71.14798:0.00039%,1.45709:0.00039%,-3.3787199999999995:0.00019%,-68.79874000000001:0.00019%,-1.27347:0.00019%,1.46509:0.00019%,8.55414:0.00019%,6.06224:0.00019%,-4.3880099999999995:0.00019%,-0.24151:0.00019%,-71.14931:0.00019%,-1.02014:0.00019%,6.15557:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.11168%,1:20.85019%,5:18.20073%,4:17.5958%,2:17.23595%,0:0.00565%]
[INFO] ** service:[0.0048200000000000005:99.99786%,-211.09762999999998:0.00058%,-186.44547:0.00039%,-211.08346:0.00039%,-186.43601999999998:0.00019%,-211.35747999999998:0.00019%,-211.08818:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.08633%,9:26.11285%,7:18.20132%,1:17.59638%,11:0.00117%,10:0.00097%,3:0.00039%,21:0.00019%,15:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1403 (0.27334%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0024 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4501e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0021 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7635e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0019 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2975 - val_tp: 18390.0000 - val_fp: 1610.0000 - val_tn: 78390.0000 - val_fn: 1610.0000 - val_accuracy: 0.9678 - val_precision: 0.9195 - val_recall: 0.9195 - val_auc: 0.9497
[INFO] saving weights to checkpoints/lstm-epoch-4-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9381 - tp: 65424.0000 - fp: 14576.0000 - tn: 305424.0000 - fn: 14576.0000 - accuracy: 0.9271 - precision: 0.8178 - recall: 0.8178 - auc: 0.8854 - val_loss: 2.8996 - val_tp: 16402.0000 - val_fp: 3598.0000 - val_tn: 76402.0000 - val_fn: 3598.0000 - val_accuracy: 0.9280 - val_precision: 0.8201 - val_recall: 0.8201 - val_auc: 0.8876
[INFO] saving weights to checkpoints/lstm-epoch-4-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.2308 - tp: 68934.0000 - fp: 11066.0000 - tn: 308934.0000 - fn: 11066.0000 - accuracy: 0.9447 - precision: 0.8617 - recall: 0.8617 - auc: 0.9130 - val_loss: 1.3893e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/513276
[33m[INFO] loading file 18-18/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513276, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513276, 17)

[INFO] analyzing data
[INFO] 513276 rows
[INFO] ** appi_name:[21:99.99805%,30:0.00058%,7:0.00058%,31:0.00019%,27:0.00019%,22:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:81.10218%,Multi Stage Multi Point:18.89782%]
[INFO] ** dst:[21:43.34413%,10:20.82661%,8:18.26678%,9:17.55936%,22:0.00078%,15:0.00058%,24:0.00039%,16:0.00039%,2:0.00039%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99942%,0:0.00058%]
[INFO] ** i/f_name:[2:99.99942%,3:0.00058%]
[INFO] ** modbus_function_code:[0.02961:99.99805%,-33.760870000000004:0.00195%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99786%,0:0.00195%]
[INFO] ** modbus_transaction_id:65536 (12.76818%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,2:0.00058%,1:0.00058%]
[INFO] ** proxy_src_ip:[18:38.0686%,20:26.10272%,13:18.26717%,6:17.55956%,17:0.00058%,11:0.00058%,1:0.00039%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.10194%,-0.32151:20.82661%,-1.27613:18.26659%,-0.23351:17.55917%,-0.33484:17.24199%,-71.33197:0.00058%,1.45709:0.00039%,-0.24151:0.00039%,-1.27347:0.00039%,-1.2708:0.00019%,-71.14931:0.00019%,6.45955:0.00019%,-2.48275:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-3.3787199999999995:0.00019%,3.6236699999999997:0.00019%,6.06224:0.00019%,8.10082:0.00019%]
[INFO] ** scada_tag:[3:26.10155%,1:20.82642%,5:18.26639%,4:17.55897%,2:17.2418%,0:0.00487%]
[INFO] ** service:[0.0048200000000000005:99.99805%,-211.09762999999998:0.00058%,-211.73542999999998:0.00058%,-186.43601999999998:0.00019%,-211.35747999999998:0.00019%,-211.08818:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.0686%,9:26.10272%,7:18.26717%,1:17.55956%,14:0.00058%,10:0.00058%,3:0.00039%,21:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1403 (0.27334%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.6156 - tp: 62060.0000 - fp: 17940.0000 - tn: 302060.0000 - fn: 17940.0000 - accuracy: 0.9103 - precision: 0.7757 - recall: 0.7757 - auc: 0.8589 - val_loss: 6.1023 - val_tp: 12428.0000 - val_fp: 7572.0000 - val_tn: 72428.0000 - val_fn: 7572.0000 - val_accuracy: 0.8486 - val_precision: 0.6214 - val_recall: 0.6214 - val_auc: 0.7634
[INFO] saving weights to checkpoints/lstm-epoch-4-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1242 - tp: 49607.0000 - fp: 30393.0000 - tn: 289607.0000 - fn: 30393.0000 - accuracy: 0.8480 - precision: 0.6201 - recall: 0.6201 - auc: 0.7611 - val_loss: 6.1587 - val_tp: 12358.0000 - val_fp: 7642.0000 - val_tn: 72358.0000 - val_fn: 7642.0000 - val_accuracy: 0.8472 - val_precision: 0.6179 - val_recall: 0.6179 - val_auc: 0.7612
[INFO] saving weights to checkpoints/lstm-epoch-4-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1268 - tp: 49594.0000 - fp: 30406.0000 - tn: 289594.0000 - fn: 30406.0000 - accuracy: 0.8480 - precision: 0.6199 - recall: 0.6199 - auc: 0.7610 - val_loss: 2.4540 - val_tp: 16955.0000 - val_fp: 3045.0000 - val_tn: 76955.0000 - val_fn: 3045.0000 - val_accuracy: 0.9391 - val_precision: 0.8478 - val_recall: 0.8478 - val_auc: 0.9048
[INFO] saving weights to checkpoints/lstm-epoch-4-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0010 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.4185e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.9207e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7024e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/513276
[33m[INFO] loading file 19-19/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513276, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513276, 17)

[INFO] analyzing data
[INFO] 513276 rows
[INFO] ** appi_name:[21:99.99786%,26:0.00039%,0:0.00039%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:86.05818%,Single Stage Multi Point:13.94182%]
[INFO] ** dst:[21:43.38075%,10:20.82895%,8:18.21437%,9:17.573%,22:0.00136%,6:0.00058%,25:0.00039%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99786%,-33.760870000000004:0.00195%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99786%,0:0.00195%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.76818%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99864%,2:0.00136%]
[INFO] ** proxy_src_ip:[18:38.11828%,20:26.09142%,13:18.21457%,6:17.573%,10:0.00117%,11:0.00097%,16:0.00058%]
[INFO] ** s_port:[1.45442:26.09045%,-0.32151:20.82895%,-1.27613:18.21418%,-0.23351:17.57281%,-0.33484:17.28933%,-5.20264:0.00078%,1.45709:0.00058%,-1.02014:0.00058%,-64.19493:0.00039%,-71.14798:0.00039%,-1.27347:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-71.14931:0.00019%,1.46509:0.00019%,-68.79874000000001:0.00019%,-1.2708:0.00019%,0.75578:0.00019%]
[INFO] ** scada_tag:[3:26.09006%,1:20.82875%,5:18.21398%,4:17.57261%,2:17.28933%,0:0.00526%]
[INFO] ** service:[0.0048200000000000005:99.99864%,-186.44547:0.00039%,-211.08346:0.00039%,-186.43601999999998:0.00019%,-211.08818:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.11828%,9:26.09142%,7:18.21457%,1:17.573%,11:0.00117%,10:0.00097%,15:0.00058%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1404 (0.27354%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.0632e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9751e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.8282e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7054e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.3256e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1317e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.3828 - tp: 53285.0000 - fp: 26715.0000 - tn: 293285.0000 - fn: 26715.0000 - accuracy: 0.8664 - precision: 0.6661 - recall: 0.6661 - auc: 0.7899 - val_loss: 9.8530 - val_tp: 7774.0000 - val_fp: 12226.0000 - val_tn: 67774.0000 - val_fn: 12226.0000 - val_accuracy: 0.7555 - val_precision: 0.3887 - val_recall: 0.3887 - val_auc: 0.6179
[INFO] saving weights to checkpoints/lstm-epoch-4-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.5723 - tp: 47381.0000 - fp: 32619.0000 - tn: 287381.0000 - fn: 32619.0000 - accuracy: 0.8369 - precision: 0.5923 - recall: 0.5923 - auc: 0.7436 - val_loss: 1.8426e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/513276
[33m[INFO] loading file 20-20/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513276, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513276, 17)

[INFO] analyzing data
[INFO] 513276 rows
[INFO] ** appi_name:[21:99.9963%,30:0.00312%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:92.01619%,Single Stage Multi Point:7.98381%]
[INFO] ** dst:[21:43.42245%,10:20.8385%,8:18.16528%,9:17.56852%,15:0.00312%,22:0.00117%,24:0.00039%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99727%,0:0.00273%]
[INFO] ** i/f_name:[2:99.99688%,3:0.00312%]
[INFO] ** modbus_function_code:[0.02961:99.9963%,-33.760870000000004:0.0037%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99649%,0:0.0037%]
[INFO] ** modbus_transaction_id:65536 (12.76818%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9963%,1:0.00312%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.1175%,20:26.14402%,13:18.16547%,6:17.56911%,17:0.00312%,14:0.00058%,16:0.00019%]
[INFO] ** s_port:[1.45442:26.14324%,-0.32151:20.8385%,-1.27613:18.16489%,-0.23351:17.56833%,-0.33484:17.27901%,-71.33197:0.00312%,-0.24151:0.00058%,1.45709:0.00039%,-1.27347:0.00039%,-1.2708:0.00019%,-1.02014:0.00019%,13.431270000000001:0.00019%,-71.14798:0.00019%,1.47576:0.00019%,-0.24950999999999998:0.00019%,11.862:0.00019%,1.46509:0.00019%]
[INFO] ** scada_tag:[3:26.14285%,1:20.8383%,5:18.16489%,4:17.56794%,2:17.27881%,0:0.00721%]
[INFO] ** service:[0.0048200000000000005:99.9963%,-211.73542999999998:0.00312%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.1175%,9:26.14402%,7:18.16547%,1:17.56911%,14:0.00312%,2:0.00058%,15:0.00019%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1403 (0.27334%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3359 - tp: 78335.0000 - fp: 1665.0000 - tn: 318335.0000 - fn: 1665.0000 - accuracy: 0.9917 - precision: 0.9792 - recall: 0.9792 - auc: 0.9869 - val_loss: 2.9262 - val_tp: 16369.0000 - val_fp: 3631.0000 - val_tn: 76369.0000 - val_fn: 3631.0000 - val_accuracy: 0.9274 - val_precision: 0.8184 - val_recall: 0.8184 - val_auc: 0.8865
[INFO] saving weights to checkpoints/lstm-epoch-4-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9427 - tp: 65396.0000 - fp: 14604.0000 - tn: 305396.0000 - fn: 14604.0000 - accuracy: 0.9270 - precision: 0.8174 - recall: 0.8174 - auc: 0.8852 - val_loss: 2.9609 - val_tp: 16326.0000 - val_fp: 3674.0000 - val_tn: 76326.0000 - val_fn: 3674.0000 - val_accuracy: 0.9265 - val_precision: 0.8163 - val_recall: 0.8163 - val_auc: 0.8852
[INFO] saving weights to checkpoints/lstm-epoch-4-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9427 - tp: 65396.0000 - fp: 14604.0000 - tn: 305396.0000 - fn: 14604.0000 - accuracy: 0.9270 - precision: 0.8174 - recall: 0.8174 - auc: 0.8852 - val_loss: 2.2573 - val_tp: 17199.0000 - val_fp: 2801.0000 - val_tn: 77199.0000 - val_fn: 2801.0000 - val_accuracy: 0.9440 - val_precision: 0.8600 - val_recall: 0.8600 - val_auc: 0.9125
[INFO] saving weights to checkpoints/lstm-epoch-4-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.1796e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3962e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.8194e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3523e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/513276
[33m[INFO] loading file 21-21/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513274, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513274, 17)

[INFO] analyzing data
[INFO] 513274 rows
[INFO] ** appi_name:[21:99.9961%,30:0.00078%,7:0.00058%,26:0.00039%,22:0.00039%,0:0.00039%,31:0.00019%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:98.81097%,Multi Stage Single Point:1.18903%]
[INFO] ** dst:[21:43.30767%,10:20.99892%,8:18.16301%,9:17.52592%,22:0.00097%,15:0.00078%,6:0.00078%,25:0.00039%,24:0.00039%,16:0.00039%,2:0.00039%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name:[2:99.99922%,3:0.00078%]
[INFO] ** modbus_function_code:[0.02961:99.9961%,-33.760870000000004:0.0037%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99883%,11:49.99727%,0:0.0037%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.76823%)
[INFO] ** orig:[0:99.99922%,2:0.00078%]
[INFO] ** proto:[0:99.99766%,2:0.00156%,1:0.00078%]
[INFO] ** proxy_src_ip:[18:38.33352%,20:25.97287%,13:18.1632%,6:17.52592%,10:0.00117%,11:0.00097%,17:0.00078%,16:0.00058%,1:0.00039%,21:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.97229%,-0.32151:20.99814%,-1.27613:18.16281%,-0.23351:17.52573%,-0.33484:17.33538%,-6.64392:0.00078%,-71.33197:0.00078%,-1.02014:0.00058%,-1.27347:0.00039%,-71.14931:0.00039%,-71.14798:0.00039%,-64.19493:0.00039%,1.45709:0.00019%,-2.2440900000000004:0.00019%,-3.3787199999999995:0.00019%,-68.79874000000001:0.00019%,10.15141:0.00019%,1.46509:0.00019%,1.47576:0.00019%,7.060860000000001:0.00019%,-0.24151:0.00019%,6.62488:0.00019%]
[INFO] ** scada_tag:[3:25.9719%,1:20.99795%,5:18.16262%,4:17.52553%,2:17.33538%,0:0.00662%]
[INFO] ** service:[0.0048200000000000005:99.99688%,-211.73542999999998:0.00078%,-211.09762999999998:0.00058%,-186.44547:0.00039%,-211.08346:0.00039%,-211.08818:0.00039%,-186.43601999999998:0.00019%,-211.35747999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.33352%,9:25.97287%,7:18.1632%,1:17.52592%,11:0.00117%,21:0.00097%,10:0.00097%,15:0.00058%,3:0.00039%,4:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1398 (0.27237%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513274
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.4326e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2929e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/513274
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.1600e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2662e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/513274
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.9829e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2569e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/513274
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.6272e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2358e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/513274
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4562e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2194e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/513274
[33m[INFO] loading file 22-22/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (282315, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (282315, 17)

[INFO] analyzing data
[INFO] 282315 rows
[INFO] ** appi_name:[21:99.99221%,30:0.00673%,23:0.00035%,22:0.00035%,18:0.00035%]
[INFO] ** classification:[normal:53.04819%,Multi Stage Single Point:46.95181%]
[INFO] ** dst:[21:43.30907%,10:21.00703%,8:18.10177%,9:17.57292%,15:0.00673%,22:0.00142%,19:0.00071%,26:0.00035%]
[INFO] ** i/f_dir:[1:99.99362%,0:0.00638%]
[INFO] ** i/f_name:[2:99.99327%,3:0.00638%,0:0.00035%]
[INFO] ** modbus_function_code:[0.02961:99.99221%,-33.760870000000004:0.00779%]
[INFO] ** modbus_function_description:[7:49.99699%,11:49.99522%,0:0.00779%]
[INFO] ** modbus_transaction_id:65534 (23.21308%)
[INFO] ** orig:[0:99.99504%,2:0.00425%,1:0.00071%]
[INFO] ** proto:[0:99.99292%,1:0.00673%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.33023%,20:25.98693%,13:18.10106%,6:17.57399%,17:0.00673%,14:0.00071%,10:0.00035%]
[INFO] ** s_port:[1.45442:25.98587%,-0.32151:21.00703%,-1.27613:18.10106%,-0.23351:17.57292%,-0.33484:17.3232%,-71.33197:0.00673%,1.45709:0.00071%,-0.24151:0.00071%,7.228860000000001:0.00071%,-0.24950999999999998:0.00035%,1.46509:0.00035%,-71.14931:0.00035%]
[INFO] ** scada_tag:[3:25.98551%,1:21.00703%,5:18.10106%,4:17.57257%,2:17.3232%,0:0.01063%]
[INFO] ** service:[0.0048200000000000005:99.99221%,-211.73542999999998:0.00673%,-211.07873999999998:0.00071%,-211.08818:0.00035%]
[INFO] ** src:[22:38.33023%,9:25.98693%,7:18.10106%,1:17.57399%,21:0.00425%,14:0.00248%,2:0.00071%,11:0.00035%]
[INFO] ** type:[0:99.99787%,1:0.00213%]
[INFO] ** unixtime:779 (0.27593%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/282315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5355 - tp: 42599.0000 - fp: 37401.0000 - tn: 282599.0000 - fn: 37401.0000 - accuracy: 0.8130 - precision: 0.5325 - recall: 0.5325 - auc: 0.7078 - val_loss: 7.5763 - val_tp: 10599.0000 - val_fp: 9401.0000 - val_tn: 70599.0000 - val_fn: 9401.0000 - val_accuracy: 0.8120 - val_precision: 0.5300 - val_recall: 0.5300 - val_auc: 0.7062
[INFO] saving weights to checkpoints/lstm-epoch-4-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/282315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5911 - tp: 42323.0000 - fp: 37677.0000 - tn: 282323.0000 - fn: 37677.0000 - accuracy: 0.8116 - precision: 0.5290 - recall: 0.5290 - auc: 0.7056 - val_loss: 7.5997 - val_tp: 10570.0000 - val_fp: 9430.0000 - val_tn: 70570.0000 - val_fn: 9430.0000 - val_accuracy: 0.8114 - val_precision: 0.5285 - val_recall: 0.5285 - val_auc: 0.7053
[INFO] saving weights to checkpoints/lstm-epoch-4-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/282315
[33m[INFO] loading file 23-23/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582315, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582315, 17)

[INFO] analyzing data
[INFO] 582315 rows
[INFO] ** appi_name:[21:99.99828%,30:0.00103%,31:0.00034%,33:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:91.81234%,Multi Stage Single Point:8.18766%]
[INFO] ** dst:[21:43.32397%,10:20.99809%,8:18.14053%,9:17.5345%,22:0.00103%,15:0.00103%,24:0.00034%,18:0.00034%,25:0.00017%]
[INFO] ** i/f_dir:[1:99.99897%,0:0.00103%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99828%,-33.760870000000004:0.00172%]
[INFO] ** modbus_function_description:[7:50.00009%,11:49.9982%,0:0.00172%]
[INFO] ** modbus_transaction_id:65536 (11.25439%)
[INFO] ** orig:[0:99.99948%,2:0.00052%]
[INFO] ** proto:[0:99.99845%,1:0.00103%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.33561%,20:25.98697%,13:18.14053%,6:17.53467%,17:0.00103%,16:0.00052%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.98611%,-0.32151:20.99791%,-1.27613:18.14001%,-0.23351:17.53432%,-0.33484:17.3377%,-71.33197:0.00103%,-1.02014:0.00052%,-0.08551:0.00034%,-1.27347:0.00034%,1.45709:0.00034%,1.46509:0.00034%,-0.24151:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.98576%,1:20.99791%,5:18.13984%,4:17.53415%,2:17.33752%,0:0.00481%]
[INFO] ** service:[0.0048200000000000005:99.99845%,-211.73542999999998:0.00103%,-186.43601999999998:0.00034%,-186.44547:0.00017%]
[INFO] ** src:[22:38.33561%,9:25.98697%,7:18.14053%,1:17.53467%,21:0.00052%,15:0.00052%,14:0.00052%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1586 (0.27236%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5671 - tp: 42442.0000 - fp: 37558.0000 - tn: 282442.0000 - fn: 37558.0000 - accuracy: 0.8122 - precision: 0.5305 - recall: 0.5305 - auc: 0.7066 - val_loss: 7.5747 - val_tp: 10601.0000 - val_fp: 9399.0000 - val_tn: 70601.0000 - val_fn: 9399.0000 - val_accuracy: 0.8120 - val_precision: 0.5300 - val_recall: 0.5300 - val_auc: 0.7063
[INFO] saving weights to checkpoints/lstm-epoch-4-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1454 - tp: 79279.0000 - fp: 721.0000 - tn: 319279.0000 - fn: 721.0000 - accuracy: 0.9964 - precision: 0.9910 - recall: 0.9910 - auc: 0.9944 - val_loss: 1.2137e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.7203e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2075e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.8957e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2013e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.7965e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2061e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/582315
[33m[INFO] loading file 24-24/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582315, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582315, 17)

[INFO] analyzing data
[INFO] 582315 rows
[INFO] ** appi_name:[21:99.99365%,30:0.00309%,26:0.00052%,31:0.00034%,27:0.00034%,22:0.00034%,0:0.00034%,24:0.00017%,23:0.00017%,19:0.00017%,18:0.00017%,16:0.00017%,15:0.00017%,11:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:95.62436%,Multi Stage Single Point:4.37564%]
[INFO] ** dst:[21:43.36897%,10:21.0089%,8:18.1%,9:17.51526%,15:0.00309%,22:0.0012%,6:0.00069%,25:0.00034%,24:0.00034%,19:0.00034%,18:0.00034%,7:0.00034%,26:0.00017%]
[INFO] ** i/f_dir:[1:99.99708%,0:0.00292%]
[INFO] ** i/f_name:[2:99.99691%,3:0.00309%]
[INFO] ** modbus_function_code:[0.02961:99.99365%,-33.760870000000004:0.00584%,-0.415:0.00017%,0.9188299999999999:0.00017%,0.47422:0.00017%]
[INFO] ** modbus_function_description:[7:49.9982%,11:49.99545%,0:0.00584%,15:0.00017%,10:0.00017%,2:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.25439%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99502%,1:0.00309%,2:0.00189%]
[INFO] ** proxy_src_ip:[18:38.38575%,20:25.99315%,13:18.09983%,6:17.51458%,17:0.00309%,10:0.0012%,14:0.00086%,11:0.00086%,21:0.00034%,16:0.00034%]
[INFO] ** s_port:[1.45442:25.99212%,-0.32151:21.0089%,-1.27613:18.09948%,-0.23351:17.51389%,-0.33484:17.37685%,-71.33197:0.00309%,-9.58113:0.00069%,-71.14798:0.00052%,1.45709:0.00052%,-0.24950999999999998:0.00034%,-1.27347:0.00034%,-0.24151:0.00034%,-1.02014:0.00034%,-31.55091:0.00034%,7.6315100000000005:0.00034%,-71.14931:0.00034%,-64.19493:0.00034%,1.47576:0.00034%,-68.79874000000001:0.00017%,1.46509:0.00017%,7.4901800000000005:0.00017%,13.431270000000001:0.00017%,11.862:0.00017%]
[INFO] ** scada_tag:[3:25.99195%,1:21.0089%,5:18.09931%,4:17.51355%,2:17.37668%,0:0.00962%]
[INFO] ** service:[0.0048200000000000005:99.99468%,-211.73542999999998:0.00309%,-211.08346:0.00052%,-211.07873999999998:0.00034%,-202.75898:0.00034%,-186.44547:0.00034%,-186.43601999999998:0.00034%,-211.08818:0.00034%]
[INFO] ** src:[22:38.38575%,9:25.99315%,7:18.09983%,1:17.51458%,14:0.00309%,11:0.0012%,10:0.00086%,2:0.00086%,15:0.00034%,4:0.00034%]
[INFO] ** type:[0:99.9988%,1:0.00086%,2:0.00034%]
[INFO] ** unixtime:1582 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.8629e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1934e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.2701e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.5704e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.9833e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.5759e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/582315
[33m[INFO] loading file 25-25/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582315, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582315, 17)

[INFO] analyzing data
[INFO] 582315 rows
[INFO] ** appi_name:[21:99.99657%,30:0.00103%,17:0.00069%,22:0.00052%,31:0.00034%,28:0.00017%,26:0.00017%,12:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** classification:[normal:65.00021%,Multi Stage Single Point:34.99979%]
[INFO] ** dst:[21:43.32535%,10:21.02968%,8:18.12696%,9:17.51389%,15:0.00103%,22:0.00086%,16:0.00069%,6:0.00069%,18:0.00034%,17:0.00034%,24:0.00017%]
[INFO] ** i/f_dir:[1:99.99897%,0:0.00103%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99657%,-33.760870000000004:0.00343%]
[INFO] ** modbus_function_description:[7:49.99906%,11:49.99751%,0:0.00343%]
[INFO] ** modbus_transaction_id:65536 (11.25439%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99794%,2:0.00103%,1:0.00103%]
[INFO] ** proxy_src_ip:[18:38.39674%,20:25.95829%,13:18.12696%,6:17.51423%,17:0.00103%,1:0.00086%,21:0.00069%,16:0.00034%,14:0.00034%,7:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95777%,-0.32151:21.02934%,-1.27613:18.12662%,-0.23351:17.51372%,-0.33484:17.3674%,-71.33197:0.00103%,-71.14931:0.00052%,-49.275529999999996:0.00034%,-0.24151:0.00034%,-1.02014:0.00034%,-58.032509999999995:0.00017%,-5.08665:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,2.52505:0.00017%,-71.14798:0.00017%,-58.035180000000004:0.00017%,-1.2708:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.95743%,1:21.02917%,5:18.12644%,4:17.51355%,2:17.36723%,0:0.00618%]
[INFO] ** service:[0.0048200000000000005:99.99691%,-211.73542999999998:0.00103%,-205.44247:0.00069%,-211.08818:0.00052%,-186.43601999999998:0.00034%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%]
[INFO] ** src:[22:38.39674%,9:25.95829%,7:18.12696%,1:17.51423%,14:0.00103%,3:0.00086%,4:0.00069%,21:0.00034%,15:0.00034%,2:0.00034%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1582 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.9696 - tp: 55334.0000 - fp: 24666.0000 - tn: 295334.0000 - fn: 24666.0000 - accuracy: 0.8767 - precision: 0.6917 - recall: 0.6917 - auc: 0.8073 - val_loss: 5.7582 - val_tp: 12855.0000 - val_fp: 7145.0000 - val_tn: 72855.0000 - val_fn: 7145.0000 - val_accuracy: 0.8571 - val_precision: 0.6428 - val_recall: 0.6428 - val_auc: 0.7767
[INFO] saving weights to checkpoints/lstm-epoch-4-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7524 - tp: 51449.0000 - fp: 28551.0000 - tn: 291449.0000 - fn: 28551.0000 - accuracy: 0.8572 - precision: 0.6431 - recall: 0.6431 - auc: 0.7769 - val_loss: 5.7445 - val_tp: 12872.0000 - val_fp: 7128.0000 - val_tn: 72872.0000 - val_fn: 7128.0000 - val_accuracy: 0.8574 - val_precision: 0.6436 - val_recall: 0.6436 - val_auc: 0.7772
[INFO] saving weights to checkpoints/lstm-epoch-4-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7491 - tp: 51465.0000 - fp: 28535.0000 - tn: 291465.0000 - fn: 28535.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.7771 - val_loss: 5.7453 - val_tp: 12871.0000 - val_fp: 7129.0000 - val_tn: 72871.0000 - val_fn: 7129.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.7772
[INFO] saving weights to checkpoints/lstm-epoch-4-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7463 - tp: 51479.0000 - fp: 28521.0000 - tn: 291479.0000 - fn: 28521.0000 - accuracy: 0.8574 - precision: 0.6435 - recall: 0.6435 - auc: 0.7772 - val_loss: 5.7276 - val_tp: 12893.0000 - val_fp: 7107.0000 - val_tn: 72893.0000 - val_fn: 7107.0000 - val_accuracy: 0.8579 - val_precision: 0.6446 - val_recall: 0.6446 - val_auc: 0.7779
[INFO] saving weights to checkpoints/lstm-epoch-4-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7570 - tp: 51426.0000 - fp: 28574.0000 - tn: 291426.0000 - fn: 28574.0000 - accuracy: 0.8571 - precision: 0.6428 - recall: 0.6428 - auc: 0.7768 - val_loss: 5.7630 - val_tp: 12849.0000 - val_fp: 7151.0000 - val_tn: 72849.0000 - val_fn: 7151.0000 - val_accuracy: 0.8570 - val_precision: 0.6424 - val_recall: 0.6424 - val_auc: 0.7765
[INFO] saving weights to checkpoints/lstm-epoch-4-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/582315
[33m[INFO] loading file 26-26/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582315, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582315, 17)

[INFO] analyzing data
[INFO] 582315 rows
[INFO] ** appi_name:[21:99.99828%,30:0.00052%,7:0.00052%,31:0.00017%,22:0.00017%,12:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:64.40191%,Single Stage Single Point:27.42708%,Multi Stage Single Point:8.17101%]
[INFO] ** dst:[21:43.30938%,10:21.09013%,8:18.11923%,9:17.47851%,22:0.00086%,15:0.00052%,24:0.00034%,16:0.00034%,2:0.00034%,18:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99948%,0:0.00052%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.99828%,-33.760870000000004:0.00172%]
[INFO] ** modbus_function_description:[7:49.99974%,11:49.99854%,0:0.00172%]
[INFO] ** modbus_transaction_id:65536 (11.25439%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99914%,1:0.00052%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.4699%,20:25.92978%,13:18.11957%,6:17.47868%,17:0.00052%,1:0.00052%,21:0.00034%,16:0.00034%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.92927%,-0.32151:21.08996%,-1.27613:18.11906%,-0.23351:17.47834%,-0.33484:17.37994%,-71.33197:0.00052%,-1.02014:0.00034%,-1.27347:0.00034%,-0.24151:0.00034%,-49.275529999999996:0.00017%,1.47576:0.00017%,1.45709:0.00017%,1.46509:0.00017%,-1.2708:0.00017%,14.191239999999999:0.00017%,2.52505:0.00017%,-3.3787199999999995:0.00017%,11.57001:0.00017%,-71.14931:0.00017%,7.66617:0.00017%]
[INFO] ** scada_tag:[3:25.92892%,1:21.08996%,5:18.11889%,4:17.47817%,2:17.37994%,0:0.00412%]
[INFO] ** service:[0.0048200000000000005:99.99845%,-211.09762999999998:0.00052%,-211.73542999999998:0.00052%,-211.35747999999998:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.4699%,9:25.92978%,7:18.11957%,1:17.47868%,14:0.00052%,3:0.00052%,15:0.00034%,4:0.00034%,21:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1581 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7379 - tp: 51521.0000 - fp: 28479.0000 - tn: 291521.0000 - fn: 28479.0000 - accuracy: 0.8576 - precision: 0.6440 - recall: 0.6440 - auc: 0.7775 - val_loss: 5.7356 - val_tp: 12883.0000 - val_fp: 7117.0000 - val_tn: 72883.0000 - val_fn: 7117.0000 - val_accuracy: 0.8577 - val_precision: 0.6442 - val_recall: 0.6442 - val_auc: 0.7776
[INFO] saving weights to checkpoints/lstm-epoch-4-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.0131 - tp: 61985.0000 - fp: 18015.0000 - tn: 301985.0000 - fn: 18015.0000 - accuracy: 0.9099 - precision: 0.7748 - recall: 0.7748 - auc: 0.8699 - val_loss: 0.0013 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0917 - tp: 78512.0000 - fp: 1488.0000 - tn: 318512.0000 - fn: 1488.0000 - accuracy: 0.9926 - precision: 0.9814 - recall: 0.9814 - auc: 0.9923 - val_loss: 1.9928e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0758 - tp: 78855.0000 - fp: 1145.0000 - tn: 318855.0000 - fn: 1145.0000 - accuracy: 0.9943 - precision: 0.9857 - recall: 0.9857 - auc: 0.9927 - val_loss: 2.4323e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0681 - tp: 79056.0000 - fp: 944.0000 - tn: 319056.0000 - fn: 944.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9929 - val_loss: 1.2519e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/582315
[33m[INFO] loading file 27-27/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (522445, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (522445, 17)

[INFO] analyzing data
[INFO] 522445 rows
[INFO] ** appi_name:[21:99.99943%,30:0.00057%]
[INFO] ** classification:[normal:64.35816%,Single Stage Single Point:35.64184%]
[INFO] ** dst:[21:43.28838%,10:21.06806%,8:18.1711%,9:17.47093%,22:0.00077%,15:0.00057%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99943%,-33.760870000000004:0.00057%]
[INFO] ** modbus_function_description:[7:50.00048%,11:49.99895%,0:0.00057%]
[INFO] ** modbus_transaction_id:65536 (12.5441%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99943%,1:0.00057%]
[INFO] ** proxy_src_ip:[18:38.42089%,20:25.93613%,13:18.17091%,6:17.47112%,17:0.00057%,16:0.00038%]
[INFO] ** s_port:[1.45442:25.93555%,-0.32151:21.06806%,-1.27613:18.17072%,-0.23351:17.47074%,-0.33484:17.35283%,-71.33197:0.00057%,-1.02014:0.00038%,-1.27347:0.00019%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.93517%,1:21.06786%,5:18.17053%,4:17.47055%,2:17.35264%,0:0.00325%]
[INFO] ** service:[0.0048200000000000005:99.99943%,-211.73542999999998:0.00057%]
[INFO] ** src:[22:38.42089%,9:25.93613%,7:18.17091%,1:17.47112%,14:0.00057%,15:0.00038%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1419 (0.27161%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/522445
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0658 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9927 - val_loss: 7.9341e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/522445
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0612 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9948 - val_loss: 4.8897e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/522445
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0575 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9997 - val_loss: 3.6760e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/522445
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0534 - tp: 79145.0000 - fp: 855.0000 - tn: 319145.0000 - fn: 855.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9997 - val_loss: 1.6134e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/522445
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0536 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9998 - val_loss: 1.8065e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-26-27-batch-400000-500000
[INFO] processing batch 500000-600000/522445
[33m[INFO] loading file 28-28/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (356361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (356361, 17)

[INFO] analyzing data
[INFO] 356361 rows
[INFO] ** appi_name:[21:99.99186%,30:0.00168%,17:0.0014%,22:0.00112%,7:0.00112%,31:0.00084%,26:0.00084%,28:0.00028%,27:0.00028%,8:0.00028%,0:0.00028%]
[INFO] ** classification:[normal:64.2994%,Single Stage Single Point:35.7006%]
[INFO] ** dst:[21:43.27718%,10:21.0138%,8:18.21383%,9:17.48648%,6:0.00224%,16:0.00196%,18:0.0014%,22:0.00056%,17:0.00056%,15:0.00056%,2:0.00056%,25:0.00028%,7:0.00028%,0:0.00028%]
[INFO] ** i/f_dir:[1:99.99944%,0:0.00056%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99186%,-33.760870000000004:0.00814%]
[INFO] ** modbus_function_description:[11:49.99593%,7:49.99593%,0:0.00814%]
[INFO] ** modbus_transaction_id:65535 (18.39006%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99523%,2:0.00421%,1:0.00056%]
[INFO] ** proxy_src_ip:[18:38.32967%,20:25.96131%,13:18.21411%,6:17.48676%,1:0.00224%,17:0.00168%,14:0.00168%,7:0.0014%,21:0.00084%,0:0.00028%]
[INFO] ** s_port:[1.45442:25.96103%,-0.32151:21.0138%,-1.27613:18.21383%,-0.23351:17.4862%,-0.33484:17.31587%,-71.14798:0.00112%,-71.14931:0.00112%,-71.33197:0.00056%,-0.08551:0.00056%,-0.24151:0.00056%,7.66617:0.00028%,-58.035180000000004:0.00028%,-1.2708:0.00028%,-64.19493:0.00028%,-5.1466400000000005:0.00028%,13.431270000000001:0.00028%,11.57001:0.00028%,14.4699:0.00028%,1.47576:0.00028%,14.191239999999999:0.00028%,-5.08665:0.00028%,10.192739999999999:0.00028%,-3.3787199999999995:0.00028%,6.1115699999999995:0.00028%,2.05573:0.00028%,-43.76509:0.00028%,2.52505:0.00028%,11.862:0.00028%,-58.032509999999995:0.00028%]
[INFO] ** scada_tag:[3:25.96103%,1:21.0138%,5:18.21383%,4:17.48592%,2:17.31587%,0:0.00954%]
[INFO] ** service:[0.0048200000000000005:99.99186%,-205.44247:0.0014%,-186.43601999999998:0.0014%,-211.09762999999998:0.00112%,-211.08346:0.00112%,-211.08818:0.00112%,-211.73542999999998:0.00056%,-186.44547:0.00028%,-183.8612:0.00028%,-185.9872:0.00028%,-211.35747999999998:0.00028%,-202.75898:0.00028%]
[INFO] ** src:[22:38.32967%,9:25.96131%,7:18.21411%,1:17.48676%,3:0.00253%,2:0.00168%,21:0.0014%,4:0.00112%,14:0.00056%,8:0.00056%,17:0.00028%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:969 (0.27192%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/356361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0496 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9998 - val_loss: 1.3814e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/356361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0474 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9998 - val_loss: 4.4471e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/356361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0440 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 7.5490e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/356361
[33m[INFO] loading file 29-29/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (556361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (556361, 17)

[INFO] analyzing data
[INFO] 556361 rows
[INFO] ** appi_name:[21:99.99874%,30:0.00054%,31:0.00018%,26:0.00018%,9:0.00018%,3:0.00018%]
[INFO] ** classification:[normal:64.39668%,Single Stage Single Point:35.60332%]
[INFO] ** dst:[21:43.33356%,10:21.06168%,8:18.13786%,9:17.4651%,22:0.00054%,15:0.00054%,24:0.00018%,18:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.99874%,-33.760870000000004:0.00126%]
[INFO] ** modbus_function_description:[7:49.99973%,11:49.99901%,0:0.00126%]
[INFO] ** modbus_transaction_id:65536 (11.7794%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9991%,1:0.00054%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.44303%,20:25.95239%,13:18.13822%,6:17.46492%,17:0.00054%,21:0.00018%,16:0.00018%,7:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95186%,-0.32151:21.06151%,-1.27613:18.13786%,-0.23351:17.46492%,-0.33484:17.38152%,-71.33197:0.00054%,1.45709:0.00036%,-71.14798:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,6.1115699999999995:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.9515%,1:21.06133%,5:18.13786%,4:17.46456%,2:17.38152%,0:0.00324%]
[INFO] ** service:[0.0048200000000000005:99.99892%,-211.73542999999998:0.00054%,-183.8612:0.00018%,-211.08346:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.44303%,9:25.95239%,7:18.13822%,1:17.46492%,14:0.00054%,21:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1511 (0.27159%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0412 - tp: 79073.0000 - fp: 927.0000 - tn: 319073.0000 - fn: 927.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 7.1172e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0385 - tp: 79049.0000 - fp: 951.0000 - tn: 319049.0000 - fn: 951.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9999 - val_loss: 6.1949e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0331 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 6.2015e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0317 - tp: 79055.0000 - fp: 945.0000 - tn: 319055.0000 - fn: 945.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 8.0635e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0277 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 2.8713e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/556361
[33m[INFO] loading file 30-30/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (556361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (556361, 17)

[INFO] analyzing data
[INFO] 556361 rows
[INFO] ** appi_name:[21:99.99748%,30:0.0018%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.36864%,Single Stage Single Point:35.63136%]
[INFO] ** dst:[21:43.33769%,10:21.02789%,8:18.14829%,9:17.48271%,15:0.0018%,22:0.00072%,24:0.00036%,25:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99838%,0:0.00162%]
[INFO] ** i/f_name:[2:99.9982%,3:0.0018%]
[INFO] ** modbus_function_code:[0.02961:99.99748%,-33.760870000000004:0.00252%]
[INFO] ** modbus_function_description:[7:49.99973%,11:49.99775%,0:0.00252%]
[INFO] ** modbus_transaction_id:65536 (11.7794%)
[INFO] ** orig:[0:99.9991%,2:0.00054%,1:0.00036%]
[INFO] ** proto:[0:99.99784%,1:0.0018%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.36825%,20:25.99715%,13:18.14865%,6:17.48325%,17:0.0018%,7:0.00036%,16:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.99697%,-0.32151:21.02771%,-1.27613:18.14811%,-0.23351:17.48253%,-0.33484:17.34054%,-71.33197:0.0018%,-0.24151:0.00054%,-1.27347:0.00036%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.99661%,1:21.02771%,5:18.14793%,4:17.48235%,2:17.34036%,0:0.00503%]
[INFO] ** service:[0.0048200000000000005:99.99766%,-211.73542999999998:0.0018%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.36825%,9:25.99715%,7:18.14865%,1:17.48325%,14:0.00126%,21:0.0009%,16:0.00018%,15:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.9991%,1:0.0009%]
[INFO] ** unixtime:1513 (0.27195%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0266 - tp: 79062.0000 - fp: 938.0000 - tn: 319062.0000 - fn: 938.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 2.3161e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0245 - tp: 79081.0000 - fp: 919.0000 - tn: 319081.0000 - fn: 919.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 2.1003e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0224 - tp: 79136.0000 - fp: 864.0000 - tn: 319136.0000 - fn: 864.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 2.2444e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0217 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0608e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0219 - tp: 79062.0000 - fp: 938.0000 - tn: 319062.0000 - fn: 938.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.4336e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/556361
[33m[INFO] loading file 31-31/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (556361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (556361, 17)

[INFO] analyzing data
[INFO] 556361 rows
[INFO] ** appi_name:[21:99.99964%,26:0.00018%,17:0.00018%]
[INFO] ** classification:[normal:64.37547%,Single Stage Single Point:35.62453%]
[INFO] ** dst:[21:43.32115%,10:21.0527%,8:18.12528%,9:17.49907%,22:0.00108%,24:0.00036%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99964%,-33.760870000000004:0.00036%]
[INFO] ** modbus_function_description:[7:50.00009%,11:49.99955%,0:0.00036%]
[INFO] ** modbus_transaction_id:65536 (11.7794%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.39557%,20:25.979%,13:18.12546%,6:17.49907%,16:0.00054%,7:0.00036%]
[INFO] ** s_port:[1.45442:25.97828%,-0.32151:21.0527%,-1.27613:18.1251%,-0.23351:17.49889%,-0.33484:17.34288%,-1.02014:0.00054%,-1.27347:0.00036%,1.45709:0.00036%,-71.14798:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,10.192739999999999:0.00018%]
[INFO] ** scada_tag:[3:25.97792%,1:21.05252%,5:18.12492%,4:17.49853%,2:17.3427%,0:0.00342%]
[INFO] ** service:[0.0048200000000000005:99.99964%,-211.08346:0.00018%,-205.44247:0.00018%]
[INFO] ** src:[22:38.39557%,9:25.979%,7:18.12546%,1:17.49907%,15:0.00054%,21:0.00036%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1512 (0.27177%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.2903e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.2421e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79130.0000 - fp: 870.0000 - tn: 319130.0000 - fn: 870.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.2158e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79084.0000 - fp: 916.0000 - tn: 319084.0000 - fn: 916.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1994e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1927e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/556361
[33m[INFO] loading file 32-32/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (556361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (556361, 17)

[INFO] analyzing data
[INFO] 556361 rows
[INFO] ** appi_name:[21:99.99641%,30:0.00306%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.37583%,Single Stage Single Point:35.62417%]
[INFO] ** dst:[21:43.32331%,10:21.04784%,8:18.15907%,9:17.4651%,15:0.00306%,22:0.0009%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9973%,0:0.0027%]
[INFO] ** i/f_name:[2:99.99694%,3:0.00306%]
[INFO] ** modbus_function_code:[0.02961:99.99641%,-33.760870000000004:0.00359%]
[INFO] ** modbus_function_description:[7:49.99919%,11:49.99721%,0:0.00359%]
[INFO] ** modbus_transaction_id:65536 (11.7794%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99641%,1:0.00306%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.41373%,20:25.95779%,13:18.15907%,6:17.46564%,17:0.00306%,14:0.00054%,16:0.00018%]
[INFO] ** s_port:[1.45442:25.95725%,-0.32151:21.04784%,-1.27613:18.15871%,-0.23351:17.46492%,-0.33484:17.36588%,-71.33197:0.00306%,-0.24151:0.00054%,-1.2708:0.00018%,-1.02014:0.00018%,13.431270000000001:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,1.45709:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:25.95689%,1:21.04767%,5:18.15871%,4:17.46456%,2:17.36588%,0:0.00629%]
[INFO] ** service:[0.0048200000000000005:99.99641%,-211.73542999999998:0.00306%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.41373%,9:25.95779%,7:18.15907%,1:17.46564%,14:0.00306%,2:0.00054%,15:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1510 (0.27141%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79065.0000 - fp: 935.0000 - tn: 319065.0000 - fn: 935.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79130.0000 - fp: 870.0000 - tn: 319130.0000 - fn: 870.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79057.0000 - fp: 943.0000 - tn: 319057.0000 - fn: 943.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 8.0603e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0214 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.2132e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79175.0000 - fp: 825.0000 - tn: 319175.0000 - fn: 825.0000 - accuracy: 0.9959 - precision: 0.9897 - recall: 0.9897 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/556361
[33m[INFO] loading file 33-33/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (556361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (556361, 17)

[INFO] analyzing data
[INFO] 556361 rows
[INFO] ** appi_name:[21:99.99694%,30:0.00108%,17:0.00072%,22:0.00054%,31:0.00018%,28:0.00018%,26:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.39218%,Single Stage Single Point:35.60782%]
[INFO] ** dst:[21:43.32421%,10:21.06312%,8:18.12151%,9:17.48631%,22:0.00144%,15:0.00108%,16:0.00072%,6:0.00072%,24:0.00036%,17:0.00036%,18:0.00018%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99694%,-33.760870000000004:0.00306%]
[INFO] ** modbus_function_description:[7:49.99955%,11:49.99739%,0:0.00306%]
[INFO] ** modbus_transaction_id:65536 (11.7794%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99802%,1:0.00108%,2:0.0009%]
[INFO] ** proxy_src_ip:[18:38.42146%,20:25.96677%,13:18.12151%,6:17.48649%,17:0.00108%,16:0.00072%,1:0.00072%,21:0.00036%,14:0.00036%,7:0.00036%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.96587%,-0.32151:21.06312%,-1.27613:18.12115%,-0.23351:17.48613%,-0.33484:17.35833%,-71.33197:0.00108%,-1.02014:0.00072%,1.45709:0.00054%,-71.14931:0.00054%,-1.27347:0.00036%,-5.08665:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,-43.76509:0.00018%,-71.14798:0.00018%,-58.032509999999995:0.00018%,-58.035180000000004:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:25.96552%,1:21.06312%,5:18.12097%,4:17.48595%,2:17.35833%,0:0.00611%]
[INFO] ** service:[0.0048200000000000005:99.99694%,-211.73542999999998:0.00108%,-205.44247:0.00072%,-211.08818:0.00054%,-211.09762999999998:0.00018%,-211.08346:0.00018%,-185.9872:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.42146%,9:25.96677%,7:18.12151%,1:17.48649%,14:0.00108%,15:0.00072%,3:0.00072%,21:0.00036%,4:0.00036%,2:0.00036%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1513 (0.27195%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79070.0000 - fp: 930.0000 - tn: 319070.0000 - fn: 930.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 4.5731e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0214 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79154.0000 - fp: 846.0000 - tn: 319154.0000 - fn: 846.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/556361
[33m[INFO] loading file 34-34/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (397794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (397794, 17)

[INFO] analyzing data
[INFO] 397794 rows
[INFO] ** appi_name:[21:99.99749%,30:0.00075%,7:0.00075%,31:0.00025%,22:0.00025%,8:0.00025%,6:0.00025%]
[INFO] ** classification:[normal:64.33858%,Single Stage Single Point:35.66142%]
[INFO] ** dst:[21:43.27592%,10:21.05939%,8:18.19535%,9:17.46633%,22:0.00075%,15:0.00075%,16:0.0005%,2:0.0005%,18:0.00025%,6:0.00025%]
[INFO] ** i/f_dir:[1:99.99925%,0:0.00075%]
[INFO] ** i/f_name:[2:99.99925%,3:0.00075%]
[INFO] ** modbus_function_code:[0.02961:99.99749%,-33.760870000000004:0.00251%]
[INFO] ** modbus_function_description:[7:49.99925%,11:49.99824%,0:0.00251%]
[INFO] ** modbus_transaction_id:65536 (16.47486%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99874%,1:0.00075%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.38997%,20:25.94559%,13:18.1951%,6:17.46683%,17:0.00075%,1:0.00075%,21:0.0005%,14:0.00025%,7:0.00025%]
[INFO] ** s_port:[1.45442:25.94509%,-0.32151:21.05914%,-1.27613:18.1951%,-0.23351:17.46608%,-0.33484:17.33083%,-0.24151:0.00075%,-71.33197:0.00075%,-3.0613900000000003:0.00025%,-3.3787199999999995:0.00025%,14.191239999999999:0.00025%,1.46509:0.00025%,1.47576:0.00025%,11.57001:0.00025%,-49.275529999999996:0.00025%,-71.14931:0.00025%,7.66617:0.00025%]
[INFO] ** scada_tag:[3:25.94484%,1:21.05889%,5:18.19484%,4:17.46557%,2:17.33083%,0:0.00503%]
[INFO] ** service:[0.0048200000000000005:99.99774%,-211.09762999999998:0.00075%,-211.73542999999998:0.00075%,-186.43601999999998:0.00025%,-211.35747999999998:0.00025%,-211.08818:0.00025%]
[INFO] ** src:[22:38.38997%,9:25.94559%,7:18.1951%,1:17.46683%,14:0.00075%,3:0.00075%,4:0.0005%,21:0.00025%,2:0.00025%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1080 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/397794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79152.0000 - fp: 848.0000 - tn: 319152.0000 - fn: 848.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1922e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/397794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/397794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1925e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/397794
[33m[INFO] loading file 35-35/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.999%,30:0.001%]
[INFO] ** classification:[normal:64.35745%,Single Stage Single Point:35.64255%]
[INFO] ** dst:[21:43.31994%,10:21.03501%,8:18.16863%,9:17.47425%,22:0.00117%,15:0.001%]
[INFO] ** i/f_dir:[1:99.99916%,0:0.00084%]
[INFO] ** i/f_name:[2:99.999%,3:0.001%]
[INFO] ** modbus_function_code:[0.02961:99.999%,-33.760870000000004:0.001%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99883%,0:0.001%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:99.99967%,1:0.00033%]
[INFO] ** proto:[0:99.999%,1:0.001%]
[INFO] ** proxy_src_ip:[18:38.3868%,20:25.96864%,13:18.1683%,6:17.47458%,17:0.001%,16:0.00067%]
[INFO] ** s_port:[1.45442:25.96814%,-0.32151:21.03501%,-1.27613:18.1683%,-0.23351:17.47408%,-0.33484:17.3518%,-71.33197:0.001%,-1.02014:0.00067%,-0.24151:0.00033%,1.45709:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.96781%,1:21.03501%,5:18.16813%,4:17.47375%,2:17.3518%,0:0.00351%]
[INFO] ** service:[0.0048200000000000005:99.999%,-211.73542999999998:0.001%]
[INFO] ** src:[22:38.3868%,9:25.96864%,7:18.1683%,1:17.47458%,14:0.001%,15:0.00067%]
[INFO] ** type:[0:99.99916%,1:0.00084%]
[INFO] ** unixtime:1623 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79058.0000 - fp: 942.0000 - tn: 319058.0000 - fn: 942.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 36-36/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.99866%,30:0.00067%,31:0.00033%,33:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.36448%,Single Stage Single Point:35.63552%]
[INFO] ** dst:[21:43.33031%,10:21.03199%,8:18.14973%,9:17.48562%,22:0.00084%,15:0.00067%,24:0.00033%,18:0.00033%,25:0.00017%]
[INFO] ** i/f_dir:[1:99.99933%,0:0.00067%]
[INFO] ** i/f_name:[2:99.99933%,3:0.00067%]
[INFO] ** modbus_function_code:[0.02961:99.99866%,-33.760870000000004:0.00134%]
[INFO] ** modbus_function_description:[7:50.00033%,11:49.99833%,0:0.00134%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,1:0.00067%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.3853%,20:25.97718%,13:18.1499%,6:17.48612%,17:0.00067%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.97667%,-0.32151:21.03183%,-1.27613:18.1494%,-0.23351:17.48545%,-0.33484:17.35347%,-71.33197:0.00067%,-0.24151:0.0005%,-0.08551:0.00033%,-1.27347:0.00033%,1.45709:0.00017%,1.47576:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,-64.19493:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.97634%,1:21.03166%,5:18.14923%,4:17.48529%,2:17.3533%,0:0.00418%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.73542999999998:0.00067%,-186.43601999999998:0.00033%,-186.44547:0.00017%]
[INFO] ** src:[22:38.3853%,9:25.97718%,7:18.1499%,1:17.48612%,14:0.00067%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1623 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79132.0000 - fp: 868.0000 - tn: 319132.0000 - fn: 868.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79124.0000 - fp: 876.0000 - tn: 319124.0000 - fn: 876.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79088.0000 - fp: 912.0000 - tn: 319088.0000 - fn: 912.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79139.0000 - fp: 861.0000 - tn: 319139.0000 - fn: 861.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79141.0000 - fp: 859.0000 - tn: 319141.0000 - fn: 859.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 37-37/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.99849%,30:0.00067%,31:0.00033%,33:0.00017%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:64.37686%,Single Stage Single Point:35.62314%]
[INFO] ** dst:[21:43.33767%,10:21.03701%,8:18.14036%,9:17.48278%,22:0.00067%,15:0.00067%,18:0.00033%,24:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99967%,0:0.00033%]
[INFO] ** i/f_name:[2:99.99933%,3:0.00067%]
[INFO] ** modbus_function_code:[0.02961:99.99849%,-33.760870000000004:0.00151%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99849%,0:0.00151%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,1:0.00067%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.38346%,20:25.9914%,13:18.14036%,6:17.48295%,17:0.00067%,21:0.00033%,16:0.00033%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.99089%,-0.32151:21.03685%,-1.27613:18.14003%,-0.23351:17.48261%,-0.33484:17.34661%,-71.33197:0.00067%,-0.08551:0.00033%,-1.02014:0.00033%,-0.24151:0.00017%,14.4699:0.00017%,-1.2708:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.99056%,1:21.03685%,5:18.13986%,4:17.48244%,2:17.34644%,0:0.00385%]
[INFO] ** service:[0.0048200000000000005:99.99866%,-211.73542999999998:0.00067%,-186.43601999999998:0.00033%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.38346%,9:25.9914%,7:18.14036%,1:17.48295%,14:0.00067%,15:0.00033%,4:0.00033%,17:0.00017%,8:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99967%,1:0.00033%]
[INFO] ** unixtime:1624 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79078.0000 - fp: 922.0000 - tn: 319078.0000 - fn: 922.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79075.0000 - fp: 925.0000 - tn: 319075.0000 - fn: 925.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 38-38/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.999%,30:0.00033%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.41048%,Single Stage Single Point:35.58952%]
[INFO] ** dst:[21:43.32379%,10:21.08469%,8:18.09486%,9:17.49482%,22:0.00084%,15:0.00033%,25:0.00017%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.99967%,3:0.00033%]
[INFO] ** modbus_function_code:[0.02961:99.999%,-33.760870000000004:0.001%]
[INFO] ** modbus_function_description:[7:49.99967%,11:49.99933%,0:0.001%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99933%,2:0.00033%,1:0.00033%]
[INFO] ** proxy_src_ip:[18:38.44669%,20:25.96246%,13:18.09469%,6:17.49499%,17:0.00033%,7:0.00033%,16:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.96162%,-0.32151:21.08452%,-1.27613:18.09453%,-0.23351:17.49449%,-0.33484:17.36217%,1.47576:0.00033%,-0.24151:0.00033%,-71.33197:0.00033%,1.45709:0.00033%,-1.27347:0.00017%,1.46509:0.00017%,-61.95768:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:25.96128%,1:21.08452%,5:18.09453%,4:17.49432%,2:17.362%,0:0.00335%]
[INFO] ** service:[0.0048200000000000005:99.99916%,-211.73542999999998:0.00033%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.44669%,9:25.96246%,7:18.09469%,1:17.49499%,21:0.00033%,14:0.00033%,16:0.00017%,15:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1624 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79146.0000 - fp: 854.0000 - tn: 319146.0000 - fn: 854.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79077.0000 - fp: 923.0000 - tn: 319077.0000 - fn: 923.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0220 - tp: 79073.0000 - fp: 927.0000 - tn: 319073.0000 - fn: 927.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 39-39/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.99967%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.39593%,Single Stage Single Point:35.60407%]
[INFO] ** dst:[21:43.31158%,10:21.08302%,8:18.13668%,9:17.46722%,22:0.001%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99967%,-33.760870000000004:0.00033%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.9995%,0:0.00033%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.44451%,20:25.95058%,13:18.13685%,6:17.46722%,16:0.0005%,7:0.00033%]
[INFO] ** s_port:[1.45442:25.94991%,-0.32151:21.08302%,-1.27613:18.13652%,-0.23351:17.46705%,-0.33484:17.3615%,-1.02014:0.0005%,1.45709:0.00033%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.94957%,1:21.08285%,5:18.13635%,4:17.46705%,2:17.36133%,0:0.00284%]
[INFO] ** service:[0.0048200000000000005:99.99967%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.44451%,9:25.95058%,7:18.13685%,1:17.46722%,15:0.0005%,21:0.00033%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1622 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79078.0000 - fp: 922.0000 - tn: 319078.0000 - fn: 922.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79077.0000 - fp: 923.0000 - tn: 319077.0000 - fn: 923.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 40-40/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.99665%,30:0.00284%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.33253%,Single Stage Single Point:35.66747%]
[INFO] ** dst:[21:43.291%,10:21.03701%,8:18.20192%,9:17.46572%,15:0.00284%,22:0.00084%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99732%,0:0.00268%]
[INFO] ** i/f_name:[2:99.99716%,3:0.00284%]
[INFO] ** modbus_function_code:[0.02961:99.99665%,-33.760870000000004:0.00335%]
[INFO] ** modbus_function_description:[7:49.99933%,11:49.99732%,0:0.00335%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:99.99967%,1:0.00033%]
[INFO] ** proto:[0:99.99665%,1:0.00284%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.35652%,20:25.97232%,13:18.20176%,6:17.46605%,17:0.00284%,14:0.0005%]
[INFO] ** s_port:[1.45442:25.97149%,-0.32151:21.03701%,-1.27613:18.20159%,-0.23351:17.46555%,-0.33484:17.31951%,-71.33197:0.00284%,1.45709:0.0005%,-0.24151:0.00033%,-71.14798:0.00017%,-1.27347:0.00017%,11.862:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%,13.431270000000001:0.00017%]
[INFO] ** scada_tag:[3:25.97115%,1:21.03685%,5:18.20142%,4:17.46521%,2:17.31934%,0:0.00602%]
[INFO] ** service:[0.0048200000000000005:99.99665%,-211.73542999999998:0.00284%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.35652%,9:25.97232%,7:18.20176%,1:17.46605%,14:0.00284%,2:0.0005%]
[INFO] ** type:[0:99.99916%,1:0.00084%]
[INFO] ** unixtime:1625 (0.27183%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79077.0000 - fp: 923.0000 - tn: 319077.0000 - fn: 923.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79137.0000 - fp: 863.0000 - tn: 319137.0000 - fn: 863.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0215 - tp: 79061.0000 - fp: 939.0000 - tn: 319061.0000 - fn: 939.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 41-41/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (537952, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (537952, 17)

[INFO] analyzing data
[INFO] 537952 rows
[INFO] ** appi_name:[21:99.99684%,30:0.00093%,22:0.00074%,17:0.00074%,32:0.00019%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.38511%,Single Stage Single Point:35.61489%]
[INFO] ** dst:[21:43.32654%,10:21.05467%,8:18.14418%,9:17.47052%,16:0.00093%,15:0.00093%,6:0.00093%,22:0.00056%,24:0.00037%,17:0.00037%]
[INFO] ** i/f_dir:[1:99.99907%,0:0.00093%]
[INFO] ** i/f_name:[2:99.99907%,3:0.00093%]
[INFO] ** modbus_function_code:[0.02961:99.99684%,-33.760870000000004:0.00316%]
[INFO] ** modbus_function_description:[7:49.99907%,11:49.99777%,0:0.00316%]
[INFO] ** modbus_transaction_id:65536 (12.1825%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99796%,2:0.00112%,1:0.00093%]
[INFO] ** proxy_src_ip:[18:38.42425%,20:25.95715%,13:18.14437%,6:17.4707%,17:0.00093%,1:0.00074%,21:0.00037%,16:0.00037%,14:0.00037%,0:0.00037%,7:0.00019%,2:0.00019%]
[INFO] ** s_port:[1.45442:25.95678%,-0.32151:21.05467%,-1.27613:18.14381%,-0.23351:17.47033%,-0.33484:17.36958%,-71.33197:0.00093%,-71.14931:0.00074%,-1.27347:0.00037%,-1.02014:0.00037%,-0.24151:0.00019%,-5.1466400000000005:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,1.46509:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,-5.08665:0.00019%,-64.19226:0.00019%,-0.24950999999999998:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:25.95641%,1:21.05467%,5:18.14381%,4:17.47015%,2:17.36939%,0:0.00558%]
[INFO] ** service:[0.0048200000000000005:99.99684%,-211.73542999999998:0.00093%,-205.44247:0.00074%,-211.08818:0.00074%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%,89.64175:0.00019%]
[INFO] ** src:[22:38.42425%,9:25.95715%,7:18.14437%,1:17.4707%,14:0.00093%,3:0.00074%,15:0.00037%,8:0.00037%,4:0.00037%,2:0.00037%,21:0.00019%,17:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1459 (0.27121%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/537952
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/537952
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79124.0000 - fp: 876.0000 - tn: 319124.0000 - fn: 876.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/537952
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/537952
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79068.0000 - fp: 932.0000 - tn: 319068.0000 - fn: 932.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1923e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/537952
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-40-41-batch-400000-500000
[INFO] processing batch 500000-600000/537952
[33m[INFO] loading file 42-42/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (381466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (381466, 17)

[INFO] analyzing data
[INFO] 381466 rows
[INFO] ** appi_name:[21:99.99109%,30:0.00236%,17:0.00131%,31:0.00105%,26:0.00105%,7:0.00105%,22:0.00079%,28:0.00026%,27:0.00026%,9:0.00026%,8:0.00026%,0:0.00026%]
[INFO] ** classification:[normal:64.36563%,Single Stage Single Point:35.63437%]
[INFO] ** dst:[21:43.31159%,10:21.0446%,8:18.18511%,9:17.449%,16:0.00236%,6:0.0021%,18:0.00131%,2:0.00105%,22:0.00079%,15:0.00079%,17:0.00052%,25:0.00026%,7:0.00026%,0:0.00026%]
[INFO] ** i/f_dir:[1:99.99921%,0:0.00079%]
[INFO] ** i/f_name:[2:99.99921%,3:0.00079%]
[INFO] ** modbus_function_code:[0.02961:99.99109%,-33.760870000000004:0.00891%]
[INFO] ** modbus_function_description:[7:49.99633%,11:49.99476%,0:0.00891%]
[INFO] ** modbus_transaction_id:65536 (17.18004%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99528%,2:0.00393%,1:0.00079%]
[INFO] ** proxy_src_ip:[18:38.40395%,20:25.95251%,13:18.18537%,6:17.449%,17:0.00236%,1:0.00236%,14:0.00157%,21:0.00105%,7:0.00079%,0:0.00052%,16:0.00026%,2:0.00026%]
[INFO] ** s_port:[1.45442:25.95199%,-0.32151:21.0446%,-1.27613:18.18511%,-0.23351:17.44874%,-0.33484:17.35935%,-71.14931:0.00105%,-71.14798:0.00105%,-71.33197:0.00079%,-3.3787199999999995:0.00052%,-0.08551:0.00052%,11.57001:0.00052%,13.431270000000001:0.00026%,-5.1466400000000005:0.00026%,0.31847:0.00026%,-1.02014:0.00026%,-64.19493:0.00026%,-1.2708:0.00026%,-58.035180000000004:0.00026%,7.66617:0.00026%,-0.24151:0.00026%,1.47576:0.00026%,14.4699:0.00026%,15.912510000000001:0.00026%,14.191239999999999:0.00026%,7.9608300000000005:0.00026%,-5.08665:0.00026%,10.192739999999999:0.00026%,-3.0613900000000003:0.00026%,1.45709:0.00026%,2.05573:0.00026%,-43.76509:0.00026%,11.862:0.00026%,-58.032509999999995:0.00026%]
[INFO] ** scada_tag:[3:25.95146%,1:21.0446%,5:18.18484%,4:17.44874%,2:17.35908%,0:0.01127%]
[INFO] ** service:[0.0048200000000000005:99.99109%,-211.09762999999998:0.00184%,-205.44247:0.00131%,-186.43601999999998:0.00131%,-211.08346:0.00105%,-211.08818:0.00105%,-211.73542999999998:0.00079%,-211.35747999999998:0.00052%,-186.44547:0.00026%,-183.8612:0.00026%,-185.9872:0.00026%,-202.75898:0.00026%]
[INFO] ** src:[22:38.40395%,9:25.95251%,7:18.18537%,1:17.449%,3:0.00315%,2:0.00184%,4:0.00131%,21:0.00105%,14:0.00079%,8:0.00052%,17:0.00026%,15:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1035 (0.27132%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/381466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79091.0000 - fp: 909.0000 - tn: 319091.0000 - fn: 909.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/381466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/381466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/381466
[33m[INFO] loading file 43-43/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.9988%,30:0.00052%,26:0.00034%,8:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.39276%,Single Stage Single Point:35.60724%]
[INFO] ** dst:[21:43.32085%,10:21.06968%,8:18.13623%,9:17.47084%,22:0.00103%,15:0.00052%,6:0.00034%,2:0.00034%,24:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.9988%,-33.760870000000004:0.0012%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.9988%,0:0.0012%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99914%,1:0.00052%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.4179%,20:25.97314%,13:18.1364%,6:17.47101%,17:0.00052%,1:0.00052%,16:0.00034%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.97246%,-0.32151:21.06968%,-1.27613:18.13606%,-0.23351:17.4705%,-0.33484:17.34822%,-71.33197:0.00052%,-71.14798:0.00034%,1.45709:0.00034%,1.47576:0.00034%,-0.24151:0.00034%,-1.02014:0.00034%,0.31847:0.00017%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,-1.2708:0.00017%,-3.3787199999999995:0.00017%]
[INFO] ** scada_tag:[3:25.97211%,1:21.06968%,5:18.13588%,4:17.47015%,2:17.34805%,0:0.00413%]
[INFO] ** service:[0.0048200000000000005:99.9988%,-211.73542999999998:0.00052%,-211.08346:0.00034%,-211.09762999999998:0.00017%,-211.35747999999998:0.00017%]
[INFO] ** src:[22:38.4179%,9:25.97314%,7:18.1364%,1:17.47101%,14:0.00052%,3:0.00052%,15:0.00034%,21:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1581 (0.2719%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0195 - tp: 79161.0000 - fp: 839.0000 - tn: 319161.0000 - fn: 839.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79073.0000 - fp: 927.0000 - tn: 319073.0000 - fn: 927.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 44-44/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.99828%,30:0.00069%,31:0.00052%,0:0.00034%,22:0.00017%]
[INFO] ** classification:[normal:64.39345%,Single Stage Single Point:35.60655%]
[INFO] ** dst:[21:43.33512%,10:21.0554%,8:18.14981%,9:17.45657%,22:0.00103%,15:0.00069%,18:0.00052%,25:0.00034%,24:0.00034%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99931%,0:0.00069%]
[INFO] ** i/f_name:[2:99.99931%,3:0.00069%]
[INFO] ** modbus_function_code:[0.02961:99.99828%,-33.760870000000004:0.00172%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99811%,0:0.00172%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99828%,2:0.00103%,1:0.00069%]
[INFO] ** proxy_src_ip:[18:38.4375%,20:25.95354%,13:18.14999%,6:17.45708%,17:0.00069%,7:0.00034%,16:0.00017%,5:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95285%,-0.32151:21.0554%,-1.27613:18.14947%,-0.23351:17.45639%,-0.33484:17.3821%,-71.33197:0.00069%,-0.24151:0.00052%,-0.08551:0.00034%,-64.19493:0.00034%,-1.27347:0.00034%,1.45709:0.00034%,-1.02014:0.00017%,-1.2708:0.00017%,1.47576:0.00017%,-71.14931:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,4.42897:0.00017%]
[INFO] ** scada_tag:[3:25.95233%,1:21.0554%,5:18.14947%,4:17.45605%,2:17.38193%,0:0.00482%]
[INFO] ** service:[0.0048200000000000005:99.99828%,-211.73542999999998:0.00069%,-186.43601999999998:0.00052%,-186.44547:0.00034%,-211.08818:0.00017%]
[INFO] ** src:[22:38.4375%,9:25.95354%,7:18.14999%,1:17.45708%,14:0.00069%,21:0.00034%,17:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1578 (0.27138%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79072.0000 - fp: 928.0000 - tn: 319072.0000 - fn: 928.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79142.0000 - fp: 858.0000 - tn: 319142.0000 - fn: 858.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79082.0000 - fp: 918.0000 - tn: 319082.0000 - fn: 918.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 45-45/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.9988%,30:0.00052%,31:0.00034%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:64.41649%,Single Stage Single Point:35.58351%]
[INFO] ** dst:[21:43.32308%,10:21.09066%,8:18.12832%,9:17.45536%,22:0.00138%,15:0.00052%,18:0.00034%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.9988%,-33.760870000000004:0.0012%]
[INFO] ** modbus_function_description:[7:50.00052%,11:49.99828%,0:0.0012%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99897%,2:0.00052%,1:0.00052%]
[INFO] ** proxy_src_ip:[18:38.48342%,20:25.93101%,13:18.12815%,6:17.45588%,17:0.00052%,16:0.00034%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.93032%,-0.32151:21.09066%,-1.27613:18.12815%,-0.23351:17.45519%,-0.33484:17.39276%,1.45709:0.00052%,-0.24151:0.00052%,-71.33197:0.00052%,-1.02014:0.00034%,-0.08551:0.00034%,-71.14798:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:25.92981%,1:21.09049%,5:18.12815%,4:17.45519%,2:17.39259%,0:0.00378%]
[INFO] ** service:[0.0048200000000000005:99.9988%,-211.73542999999998:0.00052%,-186.43601999999998:0.00034%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.48342%,9:25.93101%,7:18.12815%,1:17.45588%,14:0.00052%,15:0.00034%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1578 (0.27138%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79065.0000 - fp: 935.0000 - tn: 319065.0000 - fn: 935.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0195 - tp: 79157.0000 - fp: 843.0000 - tn: 319157.0000 - fn: 843.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 46-46/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.99828%,30:0.00103%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.41924%,Single Stage Single Point:35.58076%]
[INFO] ** dst:[21:43.34578%,10:21.07088%,8:18.1082%,9:17.47256%,22:0.00103%,15:0.00103%,25:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99914%,0:0.00086%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99828%,-33.760870000000004:0.00172%]
[INFO] ** modbus_function_description:[11:49.99931%,7:49.99897%,0:0.00172%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99862%,1:0.00103%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.44163%,20:25.97504%,13:18.1082%,6:17.47308%,17:0.00103%,16:0.00034%,7:0.00034%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.97469%,-0.32151:21.07071%,-1.27613:18.10802%,-0.23351:17.47239%,-0.33484:17.37092%,-71.33197:0.00103%,-0.24151:0.00052%,-1.02014:0.00034%,-71.14798:0.00017%,1.45709:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,-61.95768:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:25.97435%,1:21.07054%,5:18.10785%,4:17.47204%,2:17.37092%,0:0.0043%]
[INFO] ** service:[0.0048200000000000005:99.99845%,-211.73542999999998:0.00103%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.44163%,9:25.97504%,7:18.1082%,1:17.47308%,14:0.00103%,21:0.00034%,15:0.00034%,16:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99914%,1:0.00086%]
[INFO] ** unixtime:1581 (0.2719%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79085.0000 - fp: 915.0000 - tn: 319085.0000 - fn: 915.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79109.0000 - fp: 891.0000 - tn: 319109.0000 - fn: 891.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79068.0000 - fp: 932.0000 - tn: 319068.0000 - fn: 932.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 47-47/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.99948%,33:0.00017%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.39603%,Single Stage Single Point:35.60397%]
[INFO] ** dst:[21:43.31018%,10:21.08395%,8:18.1278%,9:17.47583%,22:0.00155%,24:0.00034%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99948%,-33.760870000000004:0.00052%]
[INFO] ** modbus_function_description:[7:50.00103%,11:49.99845%,0:0.00052%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.45401%,20:25.94081%,13:18.12815%,6:17.47617%,16:0.00034%,7:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.93995%,-0.32151:21.08395%,-1.27613:18.12763%,-0.23351:17.47566%,-0.33484:17.37006%,1.45709:0.00052%,-0.24151:0.00052%,-1.27347:0.00034%,-1.02014:0.00034%,-71.14798:0.00017%,-61.95635:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.93944%,1:21.08378%,5:18.12746%,4:17.47548%,2:17.36989%,0:0.00396%]
[INFO] ** service:[0.0048200000000000005:99.99966%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.45401%,9:25.94081%,7:18.12815%,1:17.47617%,21:0.00034%,15:0.00034%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1579 (0.27156%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79123.0000 - fp: 877.0000 - tn: 319123.0000 - fn: 877.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79078.0000 - fp: 922.0000 - tn: 319078.0000 - fn: 922.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79119.0000 - fp: 881.0000 - tn: 319119.0000 - fn: 881.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0214 - tp: 79076.0000 - fp: 924.0000 - tn: 319076.0000 - fn: 924.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 48-48/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.9969%,30:0.00241%,33:0.00017%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.42973%,Single Stage Single Point:35.57027%]
[INFO] ** dst:[21:43.33031%,10:21.09564%,8:18.10407%,9:17.46603%,15:0.00241%,22:0.00086%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99794%,0:0.00206%]
[INFO] ** i/f_name:[2:99.99759%,3:0.00241%]
[INFO] ** modbus_function_code:[0.02961:99.9969%,-33.760870000000004:0.0031%]
[INFO] ** modbus_function_description:[7:49.99897%,11:49.99794%,0:0.0031%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99708%,1:0.00241%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.47207%,20:25.95423%,13:18.10424%,6:17.46603%,17:0.00241%,14:0.00052%,16:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95371%,-0.32151:21.09564%,-1.27613:18.1039%,-0.23351:17.46585%,-0.33484:17.37642%,-71.33197:0.00241%,-1.02014:0.00034%,-1.2708:0.00017%,13.431270000000001:0.00017%,-0.24151:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-61.95635:0.00017%,1.45709:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.95337%,1:21.09547%,5:18.1039%,4:17.46585%,2:17.37625%,0:0.00516%]
[INFO] ** service:[0.0048200000000000005:99.99708%,-211.73542999999998:0.00241%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.47207%,9:25.95423%,7:18.10424%,1:17.46603%,14:0.00241%,2:0.00052%,15:0.00034%,8:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1578 (0.27138%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79148.0000 - fp: 852.0000 - tn: 319148.0000 - fn: 852.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79124.0000 - fp: 876.0000 - tn: 319124.0000 - fn: 876.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79165.0000 - fp: 835.0000 - tn: 319165.0000 - fn: 835.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 49-49/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.99742%,30:0.00086%,17:0.00069%,26:0.00034%,22:0.00034%,28:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.38124%,Single Stage Single Point:35.61876%]
[INFO] ** dst:[21:43.31878%,10:21.05815%,8:18.12866%,9:17.48993%,22:0.00155%,15:0.00086%,16:0.00069%,6:0.00069%,24:0.00034%,17:0.00034%]
[INFO] ** i/f_dir:[1:99.99914%,0:0.00086%]
[INFO] ** i/f_name:[2:99.99914%,3:0.00086%]
[INFO] ** modbus_function_code:[0.02961:99.99742%,-33.760870000000004:0.00258%]
[INFO] ** modbus_function_description:[7:49.99983%,11:49.99759%,0:0.00258%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99845%,1:0.00086%,2:0.00069%]
[INFO] ** proxy_src_ip:[18:38.4234%,20:25.95423%,13:18.12883%,6:17.49062%,17:0.00086%,1:0.00069%,14:0.00052%,21:0.00034%,16:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95337%,-0.32151:21.05815%,-1.27613:18.12832%,-0.23351:17.48976%,-0.33484:17.36525%,-71.33197:0.00086%,-0.24151:0.00069%,1.45709:0.00052%,-1.27347:0.00034%,-71.14931:0.00034%,-1.02014:0.00034%,-71.14798:0.00034%,1.47576:0.00017%,-1.2708:0.00017%,-58.035180000000004:0.00017%,-58.032509999999995:0.00017%,1.46509:0.00017%,-43.76509:0.00017%,2.05573:0.00017%,-5.08665:0.00017%,-0.24950999999999998:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.95302%,1:21.05798%,5:18.12815%,4:17.48941%,2:17.36525%,0:0.00619%]
[INFO] ** service:[0.0048200000000000005:99.99742%,-211.73542999999998:0.00086%,-205.44247:0.00069%,-211.08346:0.00034%,-211.08818:0.00034%,-211.09762999999998:0.00017%,-185.9872:0.00017%]
[INFO] ** src:[22:38.4234%,9:25.95423%,7:18.12883%,1:17.49062%,14:0.00086%,3:0.00069%,2:0.00052%,15:0.00034%,4:0.00034%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1579 (0.27156%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0214 - tp: 79080.0000 - fp: 920.0000 - tn: 319080.0000 - fn: 920.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79160.0000 - fp: 840.0000 - tn: 319160.0000 - fn: 840.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 50-50/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (431448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (431448, 17)

[INFO] analyzing data
[INFO] 431448 rows
[INFO] ** appi_name:[21:99.99745%,30:0.00116%,7:0.0007%,31:0.00023%,22:0.00023%,8:0.00023%]
[INFO] ** classification:[normal:64.3132%,Single Stage Single Point:35.6868%]
[INFO] ** dst:[21:43.26593%,10:21.04402%,8:18.21425%,9:17.47233%,15:0.00116%,22:0.0007%,16:0.00046%,2:0.00046%,24:0.00023%,18:0.00023%,6:0.00023%]
[INFO] ** i/f_dir:[1:99.99884%,0:0.00116%]
[INFO] ** i/f_name:[2:99.99884%,3:0.00116%]
[INFO] ** modbus_function_code:[0.02961:99.99745%,-33.760870000000004:0.00255%]
[INFO] ** modbus_function_description:[7:49.99884%,11:49.99861%,0:0.00255%]
[INFO] ** modbus_transaction_id:65536 (15.18978%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99838%,1:0.00116%,2:0.00046%]
[INFO] ** proxy_src_ip:[18:38.3694%,20:25.94079%,13:18.21448%,6:17.47233%,17:0.00116%,1:0.0007%,16:0.00046%,21:0.00023%,14:0.00023%,7:0.00023%]
[INFO] ** s_port:[1.45442:25.94032%,-0.32151:21.04402%,-1.27613:18.21401%,-0.23351:17.47233%,-0.33484:17.32538%,-71.33197:0.00116%,-1.02014:0.00046%,-3.3787199999999995:0.00023%,4.33564:0.00023%,15.912510000000001:0.00023%,7.9608300000000005:0.00023%,1.46509:0.00023%,1.45709:0.00023%,-1.27347:0.00023%,-71.14931:0.00023%,-1.2708:0.00023%,0.31847:0.00023%]
[INFO] ** scada_tag:[3:25.94009%,1:21.04379%,5:18.21378%,4:17.47233%,2:17.32515%,0:0.00487%]
[INFO] ** service:[0.0048200000000000005:99.99745%,-211.73542999999998:0.00116%,-211.09762999999998:0.0007%,-186.43601999999998:0.00023%,-211.35747999999998:0.00023%,-211.08818:0.00023%]
[INFO] ** src:[22:38.3694%,9:25.94079%,7:18.21448%,1:17.47233%,14:0.00116%,3:0.0007%,15:0.00046%,21:0.00023%,4:0.00023%,2:0.00023%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1172 (0.27164%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/431448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79086.0000 - fp: 914.0000 - tn: 319086.0000 - fn: 914.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/431448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/431448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79059.0000 - fp: 941.0000 - tn: 319059.0000 - fn: 941.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/431448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-49-50-batch-300000-400000
[INFO] processing batch 400000-500000/431448
[33m[INFO] epoch 5/10[0m
[33m[INFO] loading file 1-1/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99323%,30:0.00113%,22:0.00094%,17:0.00075%,31:0.00056%,26:0.00056%,7:0.00056%,23:0.00038%,18:0.00038%,0:0.00038%,28:0.00019%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:78.41614%,Single Stage Single Point:21.58386%]
[INFO] ** dst:[21:43.27272%,10:21.04063%,8:18.16321%,9:17.51611%,6:0.00151%,22:0.00113%,16:0.00113%,15:0.00113%,18:0.00056%,26:0.00038%,25:0.00038%,19:0.00038%,17:0.00038%,24:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99887%,0:0.00113%]
[INFO] ** i/f_name:[2:99.99887%,3:0.00113%]
[INFO] ** modbus_function_code:[0.02961:99.99323%,-33.760870000000004:0.00659%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99755%,11:49.99567%,0:0.00659%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99624%,2:0.00263%,1:0.00113%]
[INFO] ** proxy_src_ip:[18:38.40413%,20:25.90884%,13:18.1634%,6:17.51648%,11:0.00132%,10:0.00132%,17:0.00113%,14:0.00094%,1:0.00094%,7:0.00056%,21:0.00038%,16:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.90827%,-0.32151:21.03988%,-1.27613:18.16302%,-0.23351:17.51592%,-0.33484:17.36426%,-71.33197:0.00113%,-71.14931:0.00094%,-2.1481:0.00075%,-0.24151:0.00056%,-71.14798:0.00056%,-1.02014:0.00038%,-64.19493:0.00038%,-2.42942:0.00038%,4.44364:0.00038%,-43.76509:0.00019%,10.67005:0.00019%,4.29964:0.00019%,-5.08665:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,1.47576:0.00019%,1.46509:0.00019%,4.076980000000001:0.00019%,-58.032509999999995:0.00019%,-58.035180000000004:0.00019%,-1.2708:0.00019%,-1.27347:0.00019%,-5.1466400000000005:0.00019%,-68.79874000000001:0.00019%,14.253910000000001:0.00019%,1.45709:0.00019%]
[INFO] ** scada_tag:[3:25.90809%,1:21.03969%,5:18.16264%,4:17.51573%,2:17.36407%,0:0.00978%]
[INFO] ** service:[0.0048200000000000005:99.99398%,-211.73542999999998:0.00113%,-211.08818:0.00094%,-205.44247:0.00075%,-211.07873999999998:0.00075%,-211.09762999999998:0.00056%,-211.08346:0.00056%,-186.43601999999998:0.00056%,-186.44547:0.00038%,-185.9872:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.40413%,9:25.90884%,7:18.1634%,1:17.51648%,11:0.00132%,10:0.00132%,14:0.00113%,3:0.00094%,2:0.00094%,21:0.00056%,15:0.00038%,4:0.00038%,8:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1442 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5257 - tp: 74102.0000 - fp: 5898.0000 - tn: 314102.0000 - fn: 5898.0000 - accuracy: 0.9705 - precision: 0.9263 - recall: 0.9263 - auc: 0.9769 - val_loss: 0.0305 - val_tp: 19530.0000 - val_fp: 470.0000 - val_tn: 79530.0000 - val_fn: 470.0000 - val_accuracy: 0.9906 - val_precision: 0.9765 - val_recall: 0.9765 - val_auc: 0.9998
[INFO] saving weights to checkpoints/lstm-epoch-5-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0102 - tp: 79979.0000 - fp: 21.0000 - tn: 319979.0000 - fn: 21.0000 - accuracy: 0.9999 - precision: 0.9997 - recall: 0.9997 - auc: 1.0000 - val_loss: 7.8964e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0066 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9403e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.7096 - tp: 49981.0000 - fp: 30019.0000 - tn: 289981.0000 - fn: 30019.0000 - accuracy: 0.8499 - precision: 0.6248 - recall: 0.6248 - auc: 0.8830 - val_loss: 0.5185 - val_tp: 14366.0000 - val_fp: 5634.0000 - val_tn: 74366.0000 - val_fn: 5634.0000 - val_accuracy: 0.8873 - val_precision: 0.7183 - val_recall: 0.7183 - val_auc: 0.9494
[INFO] saving weights to checkpoints/lstm-epoch-5-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4917 - tp: 54411.0000 - fp: 25589.0000 - tn: 294411.0000 - fn: 25589.0000 - accuracy: 0.8721 - precision: 0.6801 - recall: 0.6801 - auc: 0.9501 - val_loss: 0.4031 - val_tp: 15918.0000 - val_fp: 4082.0000 - val_tn: 75918.0000 - val_fn: 4082.0000 - val_accuracy: 0.9184 - val_precision: 0.7959 - val_recall: 0.7959 - val_auc: 0.9705
[INFO] saving weights to checkpoints/lstm-epoch-5-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 2-2/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99868%,7:0.00056%,30:0.00038%,31:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:71.62432%,Single Stage Single Point:28.37568%]
[INFO] ** dst:[21:43.31186%,10:21.0267%,8:18.14759%,9:17.51159%,22:0.00075%,16:0.00038%,15:0.00038%,2:0.00038%,24:0.00019%,18:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99868%,-33.760870000000004:0.00132%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99868%,0:0.00132%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99944%,1:0.00038%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.37741%,20:25.96171%,13:18.14759%,6:17.51178%,1:0.00056%,17:0.00038%,16:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.96096%,-0.32151:21.0267%,-1.27613:18.14721%,-0.23351:17.5114%,-0.33484:17.35071%,-71.33197:0.00038%,1.45709:0.00038%,1.46509:0.00019%,1.47576:0.00019%,12.60597:0.00019%,10.67005:0.00019%,-0.24950999999999998:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,4.076980000000001:0.00019%,-3.3787199999999995:0.00019%,4.29964:0.00019%,-1.27347:0.00019%]
[INFO] ** scada_tag:[3:25.96058%,1:21.0267%,5:18.14721%,4:17.51121%,2:17.35052%,0:0.00376%]
[INFO] ** service:[0.0048200000000000005:99.99868%,-211.09762999999998:0.00056%,-211.73542999999998:0.00038%,-211.35747999999998:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.37741%,9:25.96171%,7:18.14759%,1:17.51178%,3:0.00056%,14:0.00038%,21:0.00019%,15:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1446 (0.27209%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4430 - tp: 62351.0000 - fp: 17649.0000 - tn: 302351.0000 - fn: 17649.0000 - accuracy: 0.9118 - precision: 0.7794 - recall: 0.7794 - auc: 0.9644 - val_loss: 0.3852 - val_tp: 16531.0000 - val_fp: 3469.0000 - val_tn: 76531.0000 - val_fn: 3469.0000 - val_accuracy: 0.9306 - val_precision: 0.8266 - val_recall: 0.8266 - val_auc: 0.9721
[INFO] saving weights to checkpoints/lstm-epoch-5-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4725 - tp: 53524.0000 - fp: 26476.0000 - tn: 293524.0000 - fn: 26476.0000 - accuracy: 0.8676 - precision: 0.6690 - recall: 0.6690 - auc: 0.9442 - val_loss: 0.4749 - val_tp: 9891.0000 - val_fp: 10109.0000 - val_tn: 69891.0000 - val_fn: 10109.0000 - val_accuracy: 0.7978 - val_precision: 0.4945 - val_recall: 0.4945 - val_auc: 0.9049
[INFO] saving weights to checkpoints/lstm-epoch-5-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1032 - tp: 77438.0000 - fp: 2562.0000 - tn: 317438.0000 - fn: 2562.0000 - accuracy: 0.9872 - precision: 0.9680 - recall: 0.9680 - auc: 0.9993 - val_loss: 1.2620 - val_tp: 17800.0000 - val_fp: 2200.0000 - val_tn: 77800.0000 - val_fn: 2200.0000 - val_accuracy: 0.9560 - val_precision: 0.8900 - val_recall: 0.8900 - val_auc: 0.9382
[INFO] saving weights to checkpoints/lstm-epoch-5-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7316 - tp: 57515.0000 - fp: 22485.0000 - tn: 297515.0000 - fn: 22485.0000 - accuracy: 0.8876 - precision: 0.7189 - recall: 0.7189 - auc: 0.9396 - val_loss: 0.3929 - val_tp: 16522.0000 - val_fp: 3478.0000 - val_tn: 76522.0000 - val_fn: 3478.0000 - val_accuracy: 0.9304 - val_precision: 0.8261 - val_recall: 0.8261 - val_auc: 0.9700
[INFO] saving weights to checkpoints/lstm-epoch-5-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4733 - tp: 53952.0000 - fp: 26048.0000 - tn: 293952.0000 - fn: 26048.0000 - accuracy: 0.8698 - precision: 0.6744 - recall: 0.6744 - auc: 0.9452 - val_loss: 0.4908 - val_tp: 8518.0000 - val_fp: 11482.0000 - val_tn: 68518.0000 - val_fn: 11482.0000 - val_accuracy: 0.7704 - val_precision: 0.4259 - val_recall: 0.4259 - val_auc: 0.9024
[INFO] saving weights to checkpoints/lstm-epoch-5-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 3-3/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99134%,30:0.00226%,22:0.00113%,31:0.00094%,26:0.00094%,17:0.00094%,7:0.00075%,27:0.00038%,0:0.00038%,28:0.00019%,23:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:87.49793%,Single Stage Single Point:12.50207%]
[INFO] ** dst:[21:43.3049%,10:21.08899%,8:18.15493%,9:17.44159%,6:0.00226%,15:0.00151%,18:0.00132%,16:0.00132%,22:0.00094%,2:0.00038%,7:0.00038%,25:0.00038%,17:0.00038%,12:0.00019%,24:0.00019%,19:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99849%,0:0.00151%]
[INFO] ** i/f_name:[2:99.99849%,3:0.00151%]
[INFO] ** modbus_function_code:[0.02961:99.99134%,-33.760870000000004:0.00847%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99642%,11:49.99492%,0:0.00847%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99887%,2:0.00113%]
[INFO] ** proto:[0:99.99398%,2:0.00452%,1:0.00151%]
[INFO] ** proxy_src_ip:[18:38.41731%,20:25.97695%,13:18.15512%,6:17.44197%,17:0.00226%,1:0.00151%,14:0.00132%,7:0.00094%,11:0.00075%,10:0.00075%,21:0.00056%,16:0.00019%,15:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.9762%,-0.32151:21.0888%,-1.27613:18.15455%,-0.23351:17.44141%,-0.33484:17.32851%,-71.33197:0.00151%,-71.14931:0.00113%,-71.14798:0.00113%,-64.19493:0.00038%,-0.08551:0.00038%,1.45709:0.00038%,-0.24151:0.00038%,14.4699:0.00019%,4.29964:0.00019%,4.90362:0.00019%,10.192739999999999:0.00019%,-3.3787199999999995:0.00019%,13.86459:0.00019%,4.44364:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-5.08665:0.00019%,-58.035180000000004:0.00019%,4.076980000000001:0.00019%,-58.032509999999995:0.00019%,-1.27347:0.00019%,-1.2708:0.00019%,-1.02014:0.00019%,-5.1466400000000005:0.00019%,13.431270000000001:0.00019%,12.60597:0.00019%,1.47576:0.00019%,1.46509:0.00019%,14.253910000000001:0.00019%,-68.79874000000001:0.00019%,-0.24950999999999998:0.00019%,-2.1481:0.00019%,10.67005:0.00019%,-68.36943000000001:0.00019%]
[INFO] ** scada_tag:[3:25.97582%,1:21.08861%,5:18.15436%,4:17.44122%,2:17.32832%,0:0.01167%]
[INFO] ** service:[0.0048200000000000005:99.99153%,-211.73542999999998:0.00151%,-186.43601999999998:0.00132%,-211.08346:0.00113%,-211.08818:0.00113%,-205.44247:0.00094%,-211.09762999999998:0.00075%,-202.75898:0.00038%,-186.44547:0.00038%,-183.8612:0.00019%,-185.9872:0.00019%,-201.23771000000002:0.00019%,-211.35747999999998:0.00019%,-211.07873999999998:0.00019%]
[INFO] ** src:[22:38.41731%,9:25.97695%,7:18.15512%,1:17.44197%,21:0.00207%,3:0.00169%,2:0.00132%,11:0.00075%,10:0.00075%,4:0.00075%,14:0.00038%,8:0.00038%,17:0.00019%,15:0.00019%,13:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1443 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3150 - tp: 63926.0000 - fp: 16074.0000 - tn: 303926.0000 - fn: 16074.0000 - accuracy: 0.9196 - precision: 0.7991 - recall: 0.7991 - auc: 0.9777 - val_loss: 0.3839 - val_tp: 16870.0000 - val_fp: 3130.0000 - val_tn: 76870.0000 - val_fn: 3130.0000 - val_accuracy: 0.9374 - val_precision: 0.8435 - val_recall: 0.8435 - val_auc: 0.9820
[INFO] saving weights to checkpoints/lstm-epoch-5-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2339 - tp: 75859.0000 - fp: 4141.0000 - tn: 315859.0000 - fn: 4141.0000 - accuracy: 0.9793 - precision: 0.9482 - recall: 0.9482 - auc: 0.9958 - val_loss: 1.0043 - val_tp: 10582.0000 - val_fp: 9418.0000 - val_tn: 70582.0000 - val_fn: 9418.0000 - val_accuracy: 0.8116 - val_precision: 0.5291 - val_recall: 0.5291 - val_auc: 0.9446
[INFO] saving weights to checkpoints/lstm-epoch-5-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0617 - tp: 76560.0000 - fp: 3440.0000 - tn: 316560.0000 - fn: 3440.0000 - accuracy: 0.9828 - precision: 0.9570 - recall: 0.9570 - auc: 0.9995 - val_loss: 1.1095e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0339 - tp: 77516.0000 - fp: 2484.0000 - tn: 317516.0000 - fn: 2484.0000 - accuracy: 0.9876 - precision: 0.9689 - recall: 0.9689 - auc: 0.9998 - val_loss: 5.0458e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0295 - tp: 77618.0000 - fp: 2382.0000 - tn: 317618.0000 - fn: 2382.0000 - accuracy: 0.9881 - precision: 0.9702 - recall: 0.9702 - auc: 0.9998 - val_loss: 2.6534e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 4-4/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99774%,30:0.00132%,31:0.00038%,33:0.00019%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:91.76213%,Single Stage Single Point:8.23787%]
[INFO] ** dst:[21:43.35118%,10:20.9409%,8:18.17694%,9:17.52759%,15:0.00132%,22:0.00113%,18:0.00038%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99887%,0:0.00113%]
[INFO] ** i/f_name:[2:99.99868%,3:0.00132%]
[INFO] ** modbus_function_code:[0.02961:99.99774%,-33.760870000000004:0.00226%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99812%,0:0.00226%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99887%,2:0.00113%]
[INFO] ** proto:[0:99.99812%,1:0.00132%,2:0.00056%]
[INFO] ** proxy_src_ip:[18:38.25398%,20:26.03848%,13:18.17694%,6:17.52796%,17:0.00132%,21:0.00038%,16:0.00038%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.03773%,-0.32151:20.94071%,-1.27613:18.17657%,-0.23351:17.5274%,-0.33484:17.31326%,-71.33197:0.00132%,-1.02014:0.00038%,1.45709:0.00038%,-0.08551:0.00038%,-0.24151:0.00038%,14.4699:0.00019%,-1.2708:0.00019%,-71.14798:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-49.275529999999996:0.00019%]
[INFO] ** scada_tag:[3:26.03754%,1:20.94052%,5:18.17657%,4:17.52702%,2:17.31308%,0:0.00527%]
[INFO] ** service:[0.0048200000000000005:99.99793%,-211.73542999999998:0.00132%,-186.43601999999998:0.00038%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.25398%,9:26.03848%,7:18.17694%,1:17.52796%,21:0.00113%,15:0.00038%,4:0.00038%,17:0.00019%,14:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1453 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0281 - tp: 77478.0000 - fp: 2522.0000 - tn: 317478.0000 - fn: 2522.0000 - accuracy: 0.9874 - precision: 0.9685 - recall: 0.9685 - auc: 0.9998 - val_loss: 1.6006e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0248 - tp: 77524.0000 - fp: 2476.0000 - tn: 317524.0000 - fn: 2476.0000 - accuracy: 0.9876 - precision: 0.9690 - recall: 0.9690 - auc: 0.9998 - val_loss: 1.0207e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0222 - tp: 78681.0000 - fp: 1319.0000 - tn: 318681.0000 - fn: 1319.0000 - accuracy: 0.9934 - precision: 0.9835 - recall: 0.9835 - auc: 0.9999 - val_loss: 7.0047e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1579 - val_tp: 18508.0000 - val_fp: 1492.0000 - val_tn: 78508.0000 - val_fn: 1492.0000 - val_accuracy: 0.9702 - val_precision: 0.9254 - val_recall: 0.9254 - val_auc: 0.9534
[INFO] saving weights to checkpoints/lstm-epoch-5-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2168 - tp: 47699.0000 - fp: 32301.0000 - tn: 287699.0000 - fn: 32301.0000 - accuracy: 0.8385 - precision: 0.5962 - recall: 0.5962 - auc: 0.8799 - val_loss: 0.7064 - val_tp: 11561.0000 - val_fp: 8439.0000 - val_tn: 71561.0000 - val_fn: 8439.0000 - val_accuracy: 0.8312 - val_precision: 0.5781 - val_recall: 0.5781 - val_auc: 0.8755
[INFO] saving weights to checkpoints/lstm-epoch-5-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 5-5/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99642%,30:0.00245%,37:0.00019%,26:0.00019%,12:0.00019%,9:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:89.39783%,Single Stage Single Point:10.60217%]
[INFO] ** dst:[21:43.36229%,10:20.76779%,8:18.24261%,9:17.62317%,15:0.00245%,22:0.00075%,25:0.00019%,24:0.00019%,6:0.00019%,2:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99793%,0:0.00207%]
[INFO] ** i/f_name:[2:99.99755%,3:0.00245%]
[INFO] ** modbus_function_code:[0.02961:99.99642%,-33.760870000000004:0.00358%]
[INFO] ** modbus_function_description:[7:49.99868%,11:49.99774%,0:0.00358%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99812%,2:0.00188%]
[INFO] ** proto:[0:99.99718%,1:0.00245%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.00108%,20:26.12899%,13:18.2428%,6:17.62336%,17:0.00245%,1:0.00038%,21:0.00019%,16:0.00019%,7:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.12861%,-0.32151:20.76741%,-1.27613:18.24261%,-0.23351:17.62298%,-0.33484:17.23367%,-71.33197:0.00245%,-0.24151:0.00038%,1.47576:0.00019%,-49.275529999999996:0.00019%,-1.27347:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,1.45709:0.00019%,2.22906:0.00019%,14.4699:0.00019%,-64.19493:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:26.12824%,1:20.76722%,5:18.24242%,4:17.62298%,2:17.23367%,0:0.00546%]
[INFO] ** service:[0.0048200000000000005:99.9968%,-211.73542999999998:0.00245%,-183.8612:0.00019%,-211.08346:0.00019%,-211.35747999999998:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.00108%,9:26.12899%,7:18.2428%,1:17.62336%,21:0.00207%,14:0.00056%,3:0.00038%,16:0.00019%,15:0.00019%,8:0.00019%,4:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1453 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2793 - tp: 70336.0000 - fp: 9664.0000 - tn: 310336.0000 - fn: 9664.0000 - accuracy: 0.9517 - precision: 0.8792 - recall: 0.8792 - auc: 0.9879 - val_loss: 0.5406 - val_tp: 12817.0000 - val_fp: 7183.0000 - val_tn: 72817.0000 - val_fn: 7183.0000 - val_accuracy: 0.8563 - val_precision: 0.6409 - val_recall: 0.6409 - val_auc: 0.9678
[INFO] saving weights to checkpoints/lstm-epoch-5-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2312 - tp: 72203.0000 - fp: 7797.0000 - tn: 312203.0000 - fn: 7797.0000 - accuracy: 0.9610 - precision: 0.9025 - recall: 0.9025 - auc: 0.9922 - val_loss: 0.0609 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2916 - tp: 64269.0000 - fp: 15731.0000 - tn: 304269.0000 - fn: 15731.0000 - accuracy: 0.9213 - precision: 0.8034 - recall: 0.8034 - auc: 0.9822 - val_loss: 0.1521 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0417 - tp: 79497.0000 - fp: 503.0000 - tn: 319497.0000 - fn: 503.0000 - accuracy: 0.9975 - precision: 0.9937 - recall: 0.9937 - auc: 1.0000 - val_loss: 1.8147e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3843e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 6-6/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99567%,30:0.00339%,31:0.00019%,27:0.00019%,26:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:92.39719%,Single Stage Single Point:7.60281%]
[INFO] ** dst:[21:43.37903%,10:20.72846%,8:18.28288%,9:17.60473%,15:0.00339%,22:0.00038%,25:0.00019%,24:0.00019%,18:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.9968%,0:0.0032%]
[INFO] ** i/f_name:[2:99.99661%,3:0.00339%]
[INFO] ** modbus_function_code:[0.02961:99.99567%,-33.760870000000004:0.00433%]
[INFO] ** modbus_function_description:[7:49.99831%,11:49.99737%,0:0.00433%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99567%,1:0.00339%,2:0.00094%]
[INFO] ** proxy_src_ip:[18:37.94219%,20:26.1655%,13:18.28307%,6:17.60492%,17:0.00339%,14:0.00056%,16:0.00019%,11:0.00019%]
[INFO] ** s_port:[1.45442:26.16512%,-0.32151:20.72846%,-1.27613:18.2825%,-0.23351:17.60454%,-0.33484:17.21373%,-71.33197:0.00339%,-71.14798:0.00019%,-1.02014:0.00019%,-64.19493:0.00019%,4.90362:0.00019%,-1.2708:0.00019%,-0.24151:0.00019%,13.431270000000001:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-68.36943000000001:0.00019%]
[INFO] ** scada_tag:[3:26.16493%,1:20.72827%,5:18.28232%,4:17.60417%,2:17.21354%,0:0.00677%]
[INFO] ** service:[0.0048200000000000005:99.99567%,-211.73542999999998:0.00339%,-211.08346:0.00019%,-201.23771000000002:0.00019%,-202.75898:0.00019%,-186.44547:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:37.94219%,9:26.1655%,7:18.28307%,1:17.60492%,14:0.00339%,2:0.00056%,15:0.00019%,10:0.00019%]
[INFO] ** type:[0:99.99906%,1:0.00094%]
[INFO] ** unixtime:1455 (0.27378%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0195 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4234e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0176 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9504e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0162 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1657e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0146 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.8464e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4871 - tp: 62927.0000 - fp: 17073.0000 - tn: 302927.0000 - fn: 17073.0000 - accuracy: 0.9146 - precision: 0.7866 - recall: 0.7866 - auc: 0.9697 - val_loss: 0.1768 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 7-7/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99511%,30:0.00169%,22:0.00094%,17:0.00075%,26:0.00056%,31:0.00038%,28:0.00019%,27:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:81.6046%,Single Stage Single Point:18.3954%]
[INFO] ** dst:[21:43.36134%,10:20.74408%,8:18.25353%,9:17.63427%,15:0.00169%,22:0.00151%,6:0.00151%,16:0.00075%,24:0.00038%,18:0.00038%,17:0.00038%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99831%,0:0.00169%]
[INFO] ** i/f_name:[2:99.99831%,3:0.00169%]
[INFO] ** modbus_function_code:[0.02961:99.99511%,-33.760870000000004:0.00489%]
[INFO] ** modbus_function_description:[7:49.99831%,11:49.9968%,0:0.00489%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99624%,2:0.00207%,1:0.00169%]
[INFO] ** proxy_src_ip:[18:37.96853%,20:26.13765%,13:18.2539%,6:17.63446%,17:0.00169%,11:0.00075%,1:0.00075%,21:0.00056%,16:0.00056%,14:0.00038%,7:0.00038%,10:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.13671%,-0.32151:20.74408%,-1.27613:18.25334%,-0.23351:17.63409%,-0.33484:17.22445%,-71.33197:0.00169%,-71.14931:0.00094%,-1.02014:0.00056%,-71.14798:0.00056%,1.45709:0.00056%,-0.24151:0.00038%,-1.27347:0.00038%,1.47576:0.00019%,1.46509:0.00019%,14.253910000000001:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,-68.79874000000001:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,6.1115699999999995:0.00019%,-5.08665:0.00019%,-5.1466400000000005:0.00019%]
[INFO] ** scada_tag:[3:26.13633%,1:20.74408%,5:18.25315%,4:17.6339%,2:17.22445%,0:0.00809%]
[INFO] ** service:[0.0048200000000000005:99.99511%,-211.73542999999998:0.00169%,-211.08818:0.00094%,-205.44247:0.00075%,-211.08346:0.00056%,-186.43601999999998:0.00038%,-211.09762999999998:0.00019%,-185.9872:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:37.96853%,9:26.13765%,7:18.2539%,1:17.63446%,14:0.00169%,10:0.00075%,3:0.00075%,15:0.00056%,4:0.00056%,21:0.00038%,2:0.00038%,11:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1452 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1508 - tp: 77559.0000 - fp: 2441.0000 - tn: 317559.0000 - fn: 2441.0000 - accuracy: 0.9878 - precision: 0.9695 - recall: 0.9695 - auc: 0.9982 - val_loss: 0.0283 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0997 - tp: 78419.0000 - fp: 1581.0000 - tn: 318419.0000 - fn: 1581.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9991 - val_loss: 0.0130 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1657 - tp: 75769.0000 - fp: 4231.0000 - tn: 315769.0000 - fn: 4231.0000 - accuracy: 0.9788 - precision: 0.9471 - recall: 0.9471 - auc: 0.9950 - val_loss: 0.6816 - val_tp: 12857.0000 - val_fp: 7143.0000 - val_tn: 72857.0000 - val_fn: 7143.0000 - val_accuracy: 0.8571 - val_precision: 0.6428 - val_recall: 0.6428 - val_auc: 0.9681
[INFO] saving weights to checkpoints/lstm-epoch-5-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1498 - tp: 71184.0000 - fp: 8816.0000 - tn: 311184.0000 - fn: 8816.0000 - accuracy: 0.9559 - precision: 0.8898 - recall: 0.8898 - auc: 0.9958 - val_loss: 0.0014 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0319 - tp: 77469.0000 - fp: 2531.0000 - tn: 317469.0000 - fn: 2531.0000 - accuracy: 0.9873 - precision: 0.9684 - recall: 0.9684 - auc: 0.9997 - val_loss: 1.8999e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 8-8/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99699%,30:0.00113%,0:0.00056%,24:0.00019%,23:0.00019%,22:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:94.62262%,Single Stage Single Point:5.37738%]
[INFO] ** dst:[21:43.4272%,10:20.80975%,8:18.17901%,9:17.58027%,22:0.00132%,15:0.00113%,25:0.00056%,19:0.00038%,26:0.00019%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99925%,0:0.00075%]
[INFO] ** i/f_name:[2:99.99887%,3:0.00113%]
[INFO] ** modbus_function_code:[0.02961:99.99699%,-33.760870000000004:0.00282%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99737%,0:0.00282%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99962%,2:0.00038%]
[INFO] ** proto:[0:99.99812%,1:0.00113%,2:0.00075%]
[INFO] ** proxy_src_ip:[18:38.09686%,20:26.14066%,13:18.17826%,6:17.58065%,17:0.00113%,10:0.00113%,16:0.00056%,14:0.00038%,11:0.00019%,5:0.00019%]
[INFO] ** s_port:[1.45442:26.14009%,-0.32151:20.80975%,-1.27613:18.17807%,-0.23351:17.58008%,-0.33484:17.28711%,-71.33197:0.00113%,-15.039579999999999:0.00075%,-1.02014:0.00056%,-64.19493:0.00056%,1.45709:0.00038%,-0.24151:0.00038%,4.66896:0.00038%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-71.14931:0.00019%]
[INFO] ** scada_tag:[3:26.13972%,1:20.80956%,5:18.17807%,4:17.57989%,2:17.28692%,0:0.00583%]
[INFO] ** service:[0.0048200000000000005:99.99774%,-211.73542999999998:0.00113%,-186.44547:0.00056%,-211.07873999999998:0.00038%,-211.08818:0.00019%]
[INFO] ** src:[22:38.09686%,9:26.14066%,7:18.17826%,1:17.58065%,11:0.00113%,14:0.00075%,15:0.00056%,21:0.00038%,2:0.00038%,16:0.00019%,10:0.00019%]
[INFO] ** type:[0:99.99944%,1:0.00038%,2:0.00019%]
[INFO] ** unixtime:1456 (0.27397%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0256 - tp: 77477.0000 - fp: 2523.0000 - tn: 317477.0000 - fn: 2523.0000 - accuracy: 0.9874 - precision: 0.9685 - recall: 0.9685 - auc: 0.9997 - val_loss: 6.1762e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0215 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6491e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0189 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2701e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1054 - tp: 78864.0000 - fp: 1136.0000 - tn: 318864.0000 - fn: 1136.0000 - accuracy: 0.9943 - precision: 0.9858 - recall: 0.9858 - auc: 0.9959 - val_loss: 0.5247 - val_tp: 16406.0000 - val_fp: 3594.0000 - val_tn: 76406.0000 - val_fn: 3594.0000 - val_accuracy: 0.9281 - val_precision: 0.8203 - val_recall: 0.8203 - val_auc: 0.9917
[INFO] saving weights to checkpoints/lstm-epoch-5-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1470 - tp: 72614.0000 - fp: 7386.0000 - tn: 312614.0000 - fn: 7386.0000 - accuracy: 0.9631 - precision: 0.9077 - recall: 0.9077 - auc: 0.9957 - val_loss: 0.0173 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-5-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 9-9/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99831%,30:0.00094%,31:0.00038%,26:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:95.26332%,Single Stage Single Point:4.73668%]
[INFO] ** dst:[21:43.36341%,10:20.77776%,8:18.28646%,9:17.56973%,15:0.00094%,22:0.00075%,18:0.00038%,25:0.00019%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99906%,0:0.00094%]
[INFO] ** i/f_name:[2:99.99906%,3:0.00094%]
[INFO] ** modbus_function_code:[0.02961:99.99831%,-33.760870000000004:0.00169%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99849%,0:0.00169%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99981%,2:0.00019%]
[INFO] ** proto:[0:99.99831%,1:0.00094%,2:0.00075%]
[INFO] ** proxy_src_ip:[18:38.01407%,20:26.12767%,13:18.28664%,6:17.56992%,17:0.00094%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.12692%,-0.32151:20.77776%,-1.27613:18.28627%,-0.23351:17.56955%,-0.33484:17.23631%,-71.33197:0.00094%,1.45709:0.00038%,-0.24151:0.00038%,-0.08551:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:26.12654%,1:20.77757%,5:18.28627%,4:17.56936%,2:17.23631%,0:0.00395%]
[INFO] ** service:[0.0048200000000000005:99.99831%,-211.73542999999998:0.00094%,-186.43601999999998:0.00038%,-211.08346:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.01407%,9:26.12767%,7:18.28664%,1:17.56992%,14:0.00075%,21:0.00019%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1454 (0.27359%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0811 - tp: 77158.0000 - fp: 2842.0000 - tn: 317158.0000 - fn: 2842.0000 - accuracy: 0.9858 - precision: 0.9645 - recall: 0.9645 - auc: 0.9987 - val_loss: 0.0038 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1645 - tp: 70565.0000 - fp: 9435.0000 - tn: 310565.0000 - fn: 9435.0000 - accuracy: 0.9528 - precision: 0.8821 - recall: 0.8821 - auc: 0.9932 - val_loss: 0.1240 - val_tp: 18817.0000 - val_fp: 1183.0000 - val_tn: 78817.0000 - val_fn: 1183.0000 - val_accuracy: 0.9763 - val_precision: 0.9409 - val_recall: 0.9409 - val_auc: 0.9978
[INFO] saving weights to checkpoints/lstm-epoch-5-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0265 - tp: 79834.0000 - fp: 166.0000 - tn: 319834.0000 - fn: 166.0000 - accuracy: 0.9992 - precision: 0.9979 - recall: 0.9979 - auc: 1.0000 - val_loss: 1.2380e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0163 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.7068e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0156 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3128e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 10-10/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99605%,30:0.00188%,31:0.00038%,26:0.00019%,24:0.00019%,23:0.00019%,22:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:94.25174%,Single Stage Single Point:5.74826%]
[INFO] ** dst:[21:43.4097%,10:20.81107%,8:18.22605%,9:17.54904%,15:0.00188%,22:0.00056%,24:0.00038%,19:0.00038%,18:0.00038%,26:0.00019%,25:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99831%,0:0.00169%]
[INFO] ** i/f_name:[2:99.99812%,3:0.00188%]
[INFO] ** modbus_function_code:[0.02961:99.99605%,-33.760870000000004:0.00376%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99868%,11:49.99737%,0:0.00376%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99925%,1:0.00075%]
[INFO] ** proto:[0:99.99718%,1:0.00188%,2:0.00094%]
[INFO] ** proxy_src_ip:[18:38.09234%,20:26.1288%,13:18.22624%,6:17.54847%,17:0.00188%,10:0.00094%,14:0.00038%,21:0.00019%,16:0.00019%,5:0.00019%,2:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.12824%,-0.32151:20.81107%,-1.27613:18.22568%,-0.23351:17.5481%,-0.33484:17.28128%,-71.33197:0.00188%,-10.51843:0.00075%,-0.08551:0.00038%,-1.27347:0.00038%,5.71692:0.00038%,1.47576:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-71.14931:0.00019%,-64.19493:0.00019%,1.45709:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:26.12786%,1:20.81088%,5:18.22568%,4:17.54791%,2:17.28109%,0:0.00659%]
[INFO] ** service:[0.0048200000000000005:99.9968%,-211.73542999999998:0.00188%,-211.07873999999998:0.00038%,-186.43601999999998:0.00038%,-211.08346:0.00019%,-186.44547:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.09234%,9:26.1288%,7:18.22624%,1:17.54847%,14:0.00188%,11:0.00094%,2:0.00038%,17:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,4:0.00019%]
[INFO] ** type:[0:99.99849%,1:0.00132%,2:0.00019%]
[INFO] ** unixtime:1452 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0136 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0946e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0105 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4395e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5434 - tp: 66282.0000 - fp: 13718.0000 - tn: 306282.0000 - fn: 13718.0000 - accuracy: 0.9314 - precision: 0.8285 - recall: 0.8285 - auc: 0.9719 - val_loss: 0.1745 - val_tp: 18766.0000 - val_fp: 1234.0000 - val_tn: 78766.0000 - val_fn: 1234.0000 - val_accuracy: 0.9753 - val_precision: 0.9383 - val_recall: 0.9383 - val_auc: 0.9946
[INFO] saving weights to checkpoints/lstm-epoch-5-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1525 - tp: 77660.0000 - fp: 2340.0000 - tn: 317660.0000 - fn: 2340.0000 - accuracy: 0.9883 - precision: 0.9707 - recall: 0.9707 - auc: 0.9979 - val_loss: 0.0396 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0313 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0040 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 11-11/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99887%,31:0.00038%,30:0.00038%,26:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.38298%,10:20.87617%,8:18.20178%,9:17.53662%,22:0.00132%,18:0.00038%,15:0.00038%,25:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99887%,-33.760870000000004:0.00113%]
[INFO] ** modbus_function_description:[7:50.00056%,11:49.99831%,0:0.00113%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99887%,2:0.00075%,1:0.00038%]
[INFO] ** proxy_src_ip:[18:38.14371%,20:26.11582%,13:18.20178%,6:17.53699%,16:0.00056%,17:0.00038%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.11525%,-0.32151:20.87617%,-1.27613:18.20159%,-0.23351:17.53643%,-0.33484:17.26754%,-0.24151:0.00056%,-1.02014:0.00056%,-0.08551:0.00038%,-71.33197:0.00038%,-71.14798:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:26.11488%,1:20.87617%,5:18.2014%,4:17.53605%,2:17.26735%,0:0.00414%]
[INFO] ** service:[0.0048200000000000005:99.99887%,-211.73542999999998:0.00038%,-186.43601999999998:0.00038%,-211.08346:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.14371%,9:26.11582%,7:18.20178%,1:17.53699%,15:0.00056%,14:0.00038%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1453 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0160 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.2749e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0098 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1716e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0077 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.9751e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0068 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4462e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0065 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2449e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 12-12/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99774%,30:0.00207%,9:0.00019%]
[INFO] ** classification:[normal:93.19011%,Single Stage Single Point:6.80989%]
[INFO] ** dst:[21:43.39672%,10:20.87542%,8:18.19011%,9:17.53455%,15:0.00207%,22:0.00056%,24:0.00038%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99831%,0:0.00169%]
[INFO] ** i/f_name:[2:99.99793%,3:0.00207%]
[INFO] ** modbus_function_code:[0.02961:99.99774%,-33.760870000000004:0.00226%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99812%,0:0.00226%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99831%,2:0.00169%]
[INFO] ** proto:[0:99.99793%,1:0.00207%]
[INFO] ** proxy_src_ip:[18:38.14729%,20:26.12523%,13:18.1903%,6:17.53474%,17:0.00207%,16:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:26.12466%,-0.32151:20.87542%,-1.27613:18.18974%,-0.23351:17.53436%,-0.33484:17.27187%,-71.33197:0.00207%,-1.27347:0.00038%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,14.4699:0.00019%]
[INFO] ** scada_tag:[3:26.12429%,1:20.87542%,5:18.18974%,4:17.53398%,2:17.27187%,0:0.0047%]
[INFO] ** service:[0.0048200000000000005:99.99774%,-211.73542999999998:0.00207%,-183.8612:0.00019%]
[INFO] ** src:[22:38.14729%,9:26.12523%,7:18.1903%,1:17.53474%,21:0.00169%,14:0.00038%,15:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1453 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0059 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2222e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0057 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3663e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5338 - tp: 63055.0000 - fp: 16945.0000 - tn: 303055.0000 - fn: 16945.0000 - accuracy: 0.9153 - precision: 0.7882 - recall: 0.7882 - auc: 0.9699 - val_loss: 0.1960 - val_tp: 19534.0000 - val_fp: 466.0000 - val_tn: 79534.0000 - val_fn: 466.0000 - val_accuracy: 0.9907 - val_precision: 0.9767 - val_recall: 0.9767 - val_auc: 0.9996
[INFO] saving weights to checkpoints/lstm-epoch-5-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2334 - tp: 71056.0000 - fp: 8944.0000 - tn: 311056.0000 - fn: 8944.0000 - accuracy: 0.9553 - precision: 0.8882 - recall: 0.8882 - auc: 0.9898 - val_loss: 0.1262 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0636 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0093 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 13-13/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99642%,31:0.00075%,26:0.00056%,0:0.00056%,30:0.00038%,22:0.00038%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:85.60292%,Single Stage Single Point:14.39708%]
[INFO] ** dst:[21:43.35457%,10:20.79921%,8:18.28025%,9:17.56183%,22:0.00113%,6:0.00094%,18:0.00075%,25:0.00056%,15:0.00038%,24:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99642%,-33.760870000000004:0.00339%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99868%,11:49.99774%,0:0.00339%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99718%,2:0.00245%,1:0.00038%]
[INFO] ** proxy_src_ip:[18:38.05114%,20:26.10302%,13:18.28043%,6:17.56127%,10:0.00113%,11:0.00094%,16:0.00056%,17:0.00038%,7:0.00038%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.10246%,-0.32151:20.79921%,-1.27613:18.28006%,-0.23351:17.56089%,-0.33484:17.25192%,-9.78512:0.00075%,-64.19493:0.00056%,-1.02014:0.00056%,-71.14798:0.00056%,-0.24151:0.00038%,-71.14931:0.00038%,-0.08551:0.00038%,-71.33197:0.00038%,1.47576:0.00019%,-1.27347:0.00019%,1.46509:0.00019%,-1.2708:0.00019%,-68.79874000000001:0.00019%,6.1115699999999995:0.00019%,14.540560000000001:0.00019%,1.45709:0.00019%]
[INFO] ** scada_tag:[3:26.10208%,1:20.79902%,5:18.28006%,4:17.56089%,2:17.25173%,0:0.00621%]
[INFO] ** service:[0.0048200000000000005:99.99718%,-186.43601999999998:0.00075%,-211.08346:0.00056%,-186.44547:0.00056%,-211.73542999999998:0.00038%,-211.08818:0.00038%,-202.75898:0.00019%]
[INFO] ** src:[22:38.05114%,9:26.10302%,7:18.28043%,1:17.56127%,11:0.00113%,10:0.00094%,15:0.00056%,21:0.00038%,14:0.00038%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1452 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0147 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0017 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0106 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2389e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0079 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.0297e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4191 - tp: 63701.0000 - fp: 16299.0000 - tn: 303701.0000 - fn: 16299.0000 - accuracy: 0.9185 - precision: 0.7963 - recall: 0.7963 - auc: 0.9759 - val_loss: 0.1478 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0662 - tp: 77289.0000 - fp: 2711.0000 - tn: 317289.0000 - fn: 2711.0000 - accuracy: 0.9864 - precision: 0.9661 - recall: 0.9661 - auc: 0.9994 - val_loss: 5.8075e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 14-14/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99962%,30:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:94.60248%,Single Stage Single Point:5.39752%]
[INFO] ** dst:[21:43.34629%,10:20.80994%,8:18.26651%,9:17.57576%,22:0.00075%,24:0.00038%,15:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99962%,-33.760870000000004:0.00038%]
[INFO] ** modbus_function_description:[7:50.00075%,11:49.99887%,0:0.00038%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99981%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.04775%,20:26.10905%,13:18.2667%,6:17.57594%,17:0.00019%,16:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:26.10829%,-0.32151:20.80994%,-1.27613:18.26613%,-0.23351:17.57557%,-0.33484:17.23781%,-1.27347:0.00038%,1.45709:0.00038%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,14.4699:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:26.10792%,1:20.80994%,5:18.26595%,4:17.57519%,2:17.23762%,0:0.00339%]
[INFO] ** service:[0.0048200000000000005:99.99962%,-183.8612:0.00019%,-211.73542999999998:0.00019%]
[INFO] ** src:[22:38.04775%,9:26.10905%,7:18.2667%,1:17.57594%,15:0.00019%,14:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1452 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0324 - tp: 78737.0000 - fp: 1263.0000 - tn: 318737.0000 - fn: 1263.0000 - accuracy: 0.9937 - precision: 0.9842 - recall: 0.9842 - auc: 0.9998 - val_loss: 3.9586 - val_tp: 12830.0000 - val_fp: 7170.0000 - val_tn: 72830.0000 - val_fn: 7170.0000 - val_accuracy: 0.8566 - val_precision: 0.6415 - val_recall: 0.6415 - val_auc: 0.7759
[INFO] saving weights to checkpoints/lstm-epoch-5-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2336 - tp: 76781.0000 - fp: 3219.0000 - tn: 316781.0000 - fn: 3219.0000 - accuracy: 0.9839 - precision: 0.9598 - recall: 0.9598 - auc: 0.9895 - val_loss: 0.0085 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0184 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0015 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0125 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.7699e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0101 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0723e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 15-15/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99624%,30:0.00301%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:89.60764%,Single Stage Multi Point:10.39161%,Single Stage Single Point:0.00075%]
[INFO] ** dst:[21:43.29963%,10:20.774%,8:18.31355%,9:17.60756%,15:0.00301%,22:0.00151%,25:0.00019%,24:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99699%,0:0.00301%]
[INFO] ** i/f_name:[2:99.99699%,3:0.00301%]
[INFO] ** modbus_function_code:[0.02961:99.99624%,-33.760870000000004:0.00376%]
[INFO] ** modbus_function_description:[7:49.99906%,11:49.99718%,0:0.00376%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99718%,2:0.00282%]
[INFO] ** proto:[0:99.99661%,1:0.00301%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.00579%,20:26.0684%,13:18.31336%,6:17.60812%,17:0.00301%,16:0.00056%,7:0.00038%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.06765%,-0.32151:20.77381%,-1.27613:18.31317%,-0.23351:17.60737%,-0.33484:17.23198%,-71.33197:0.00301%,-0.24151:0.00056%,-1.02014:0.00056%,1.45709:0.00038%,1.46509:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,-61.95768:0.00019%,10.192739999999999:0.00019%,-64.19493:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:26.06727%,1:20.77362%,5:18.31317%,4:17.60699%,2:17.23179%,0:0.00715%]
[INFO] ** service:[0.0048200000000000005:99.99642%,-211.73542999999998:0.00301%,-211.08346:0.00019%,-205.44247:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.00579%,9:26.0684%,7:18.31336%,1:17.60812%,21:0.0032%,15:0.00056%,16:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1461 (0.27491%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0089 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2701e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0071 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.2554e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0068 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8935e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0059 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3403e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.2694 - tp: 48900.0000 - fp: 31100.0000 - tn: 288900.0000 - fn: 31100.0000 - accuracy: 0.8445 - precision: 0.6112 - recall: 0.6112 - auc: 0.7530 - val_loss: 7.5514 - val_tp: 10630.0000 - val_fp: 9370.0000 - val_tn: 70630.0000 - val_fn: 9370.0000 - val_accuracy: 0.8126 - val_precision: 0.5315 - val_recall: 0.5315 - val_auc: 0.7072
[INFO] saving weights to checkpoints/lstm-epoch-5-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 16-16/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (471138, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (471138, 17)

[INFO] analyzing data
[INFO] 471138 rows
[INFO] ** appi_name:[21:99.9983%,30:0.00149%,33:0.00021%]
[INFO] ** classification:[normal:82.32683%,Single Stage Multi Point:17.67317%]
[INFO] ** dst:[21:43.35312%,10:20.80049%,8:18.2507%,9:17.59272%,15:0.00149%,22:0.00127%,24:0.00021%]
[INFO] ** i/f_dir:[1:99.99851%,0:0.00149%]
[INFO] ** i/f_name:[2:99.99851%,3:0.00149%]
[INFO] ** modbus_function_code:[0.02961:99.9983%,-33.760870000000004:0.0017%]
[INFO] ** modbus_function_description:[7:50.00042%,11:49.99788%,0:0.0017%]
[INFO] ** modbus_transaction_id:65536 (13.91015%)
[INFO] ** orig:[0:99.99851%,2:0.00149%]
[INFO] ** proto:[0:99.99851%,1:0.00149%]
[INFO] ** proxy_src_ip:[18:38.0483%,20:26.10551%,13:18.25113%,6:17.59293%,17:0.00149%,16:0.00042%,21:0.00021%]
[INFO] ** s_port:[1.45442:26.10488%,-0.32151:20.80028%,-1.27613:18.2507%,-0.23351:17.59251%,-0.33484:17.24802%,-71.33197:0.00149%,1.45709:0.00042%,-0.24151:0.00042%,-1.02014:0.00042%,-1.27347:0.00021%,1.47576:0.00021%,-49.275529999999996:0.00021%,-1.2708:0.00021%]
[INFO] ** scada_tag:[3:26.10445%,1:20.80028%,5:18.25049%,4:17.59209%,2:17.24781%,0:0.00488%]
[INFO] ** service:[0.0048200000000000005:99.99851%,-211.73542999999998:0.00149%]
[INFO] ** src:[22:38.0483%,9:26.10551%,7:18.25113%,1:17.59293%,21:0.00149%,15:0.00042%,4:0.00021%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1289 (0.27359%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/471138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5644 - tp: 42469.0000 - fp: 37531.0000 - tn: 282469.0000 - fn: 37531.0000 - accuracy: 0.8123 - precision: 0.5309 - recall: 0.5309 - auc: 0.7025 - val_loss: 7.5425 - val_tp: 10641.0000 - val_fp: 9359.0000 - val_tn: 70641.0000 - val_fn: 9359.0000 - val_accuracy: 0.8128 - val_precision: 0.5321 - val_recall: 0.5321 - val_auc: 0.7075
[INFO] saving weights to checkpoints/lstm-epoch-5-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/471138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.3314 - tp: 43625.0000 - fp: 36375.0000 - tn: 283625.0000 - fn: 36375.0000 - accuracy: 0.8181 - precision: 0.5453 - recall: 0.5453 - auc: 0.7121 - val_loss: 1.2105e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/471138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0043 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.9976e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/471138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0039 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.5514e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/471138
[33m[INFO] loading file 17-17/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571138, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571138, 17)

[INFO] analyzing data
[INFO] 571138 rows
[INFO] ** appi_name:[21:99.9972%,7:0.00053%,26:0.00035%,0:0.00035%,33:0.00018%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.5985%,Multi Stage Multi Point:5.4015%]
[INFO] ** dst:[21:43.35257%,10:20.84172%,8:18.20348%,9:17.59942%,22:0.0007%,6:0.00053%,25:0.00035%,16:0.00035%,2:0.00035%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.9972%,-33.760870000000004:0.00263%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99965%,11:49.99755%,0:0.00263%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.47463%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99877%,2:0.00123%]
[INFO] ** proxy_src_ip:[18:38.07871%,20:26.11611%,13:18.20296%,6:17.59925%,10:0.00105%,11:0.00088%,1:0.00035%,21:0.00018%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.11523%,-0.32151:20.84155%,-1.27613:18.20261%,-0.23351:17.59907%,-0.33484:17.23717%,6.0369:0.0007%,1.47576:0.00035%,-71.14798:0.00035%,1.45709:0.00035%,-64.19493:0.00035%,1.46509:0.00018%,-68.79874000000001:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,6.15557:0.00018%,6.06224:0.00018%,8.55414:0.00018%,-3.3787199999999995:0.00018%,-4.3880099999999995:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.11505%,1:20.84137%,5:18.20243%,4:17.59855%,2:17.23717%,0:0.00543%]
[INFO] ** service:[0.0048200000000000005:99.99807%,-211.09762999999998:0.00053%,-211.08346:0.00035%,-186.44547:0.00035%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.07871%,9:26.11611%,7:18.20296%,1:17.59925%,11:0.00105%,10:0.00088%,3:0.00035%,21:0.00018%,15:0.00018%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1560 (0.27314%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0035 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3391e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0032 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3500e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0028 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3774e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.1423 - tp: 74342.0000 - fp: 5658.0000 - tn: 314342.0000 - fn: 5658.0000 - accuracy: 0.9717 - precision: 0.9293 - recall: 0.9293 - auc: 0.9556 - val_loss: 2.9367 - val_tp: 16356.0000 - val_fp: 3644.0000 - val_tn: 76356.0000 - val_fn: 3644.0000 - val_accuracy: 0.9271 - val_precision: 0.8178 - val_recall: 0.8178 - val_auc: 0.8861
[INFO] saving weights to checkpoints/lstm-epoch-5-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9189 - tp: 65522.0000 - fp: 14478.0000 - tn: 305522.0000 - fn: 14478.0000 - accuracy: 0.9276 - precision: 0.8190 - recall: 0.8190 - auc: 0.8862 - val_loss: 2.9222 - val_tp: 16374.0000 - val_fp: 3626.0000 - val_tn: 76374.0000 - val_fn: 3626.0000 - val_accuracy: 0.9275 - val_precision: 0.8187 - val_recall: 0.8187 - val_auc: 0.8867
[INFO] saving weights to checkpoints/lstm-epoch-5-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/571138
[33m[INFO] loading file 18-18/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571138, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571138, 17)

[INFO] analyzing data
[INFO] 571138 rows
[INFO] ** appi_name:[21:99.99825%,30:0.00053%,7:0.00053%,31:0.00018%,27:0.00018%,22:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:82.41371%,Multi Stage Multi Point:17.58629%]
[INFO] ** dst:[21:43.34224%,10:20.83279%,8:18.25881%,9:17.56336%,22:0.0007%,15:0.00053%,24:0.00035%,16:0.00035%,2:0.00035%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99947%,0:0.00053%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99825%,-33.760870000000004:0.00175%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99825%,0:0.00175%]
[INFO] ** modbus_transaction_id:65536 (11.47463%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99895%,2:0.00053%,1:0.00053%]
[INFO] ** proxy_src_ip:[18:38.08029%,20:26.09527%,13:18.25916%,6:17.56353%,17:0.00053%,11:0.00053%,1:0.00035%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.09457%,-0.32151:20.83279%,-1.27613:18.25863%,-0.23351:17.56318%,-0.33484:17.2475%,-71.33197:0.00053%,-1.27347:0.00035%,1.45709:0.00035%,-0.24151:0.00035%,1.47576:0.00018%,1.46509:0.00018%,3.6236699999999997:0.00018%,-1.2708:0.00018%,-2.48275:0.00018%,6.06224:0.00018%,-3.3787199999999995:0.00018%,8.10082:0.00018%,6.45955:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.09422%,1:20.83262%,5:18.25846%,4:17.56301%,2:17.24732%,0:0.00438%]
[INFO] ** service:[0.0048200000000000005:99.99825%,-211.09762999999998:0.00053%,-211.73542999999998:0.00053%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.08029%,9:26.09527%,7:18.25916%,1:17.56353%,14:0.00053%,10:0.00053%,3:0.00035%,21:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1561 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6959 - tp: 76556.0000 - fp: 3444.0000 - tn: 316556.0000 - fn: 3444.0000 - accuracy: 0.9828 - precision: 0.9570 - recall: 0.9570 - auc: 0.9729 - val_loss: 2.8328 - val_tp: 16485.0000 - val_fp: 3515.0000 - val_tn: 76485.0000 - val_fn: 3515.0000 - val_accuracy: 0.9297 - val_precision: 0.8242 - val_recall: 0.8242 - val_auc: 0.8902
[INFO] saving weights to checkpoints/lstm-epoch-5-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1202 - tp: 49629.0000 - fp: 30371.0000 - tn: 289629.0000 - fn: 30371.0000 - accuracy: 0.8481 - precision: 0.6204 - recall: 0.6204 - auc: 0.7611 - val_loss: 6.1619 - val_tp: 12354.0000 - val_fp: 7646.0000 - val_tn: 72354.0000 - val_fn: 7646.0000 - val_accuracy: 0.8471 - val_precision: 0.6177 - val_recall: 0.6177 - val_auc: 0.7611
[INFO] saving weights to checkpoints/lstm-epoch-5-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1328 - tp: 49566.0000 - fp: 30434.0000 - tn: 289566.0000 - fn: 30434.0000 - accuracy: 0.8478 - precision: 0.6196 - recall: 0.6196 - auc: 0.7606 - val_loss: 6.0983 - val_tp: 12433.0000 - val_fp: 7567.0000 - val_tn: 72433.0000 - val_fn: 7567.0000 - val_accuracy: 0.8487 - val_precision: 0.6216 - val_recall: 0.6216 - val_auc: 0.7635
[INFO] saving weights to checkpoints/lstm-epoch-5-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.5201 - tp: 62535.0000 - fp: 17465.0000 - tn: 302535.0000 - fn: 17465.0000 - accuracy: 0.9127 - precision: 0.7817 - recall: 0.7817 - auc: 0.8626 - val_loss: 5.6583e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0015 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.7710e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/571138
[33m[INFO] loading file 19-19/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571138, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571138, 17)

[INFO] analyzing data
[INFO] 571138 rows
[INFO] ** appi_name:[21:99.99807%,26:0.00035%,0:0.00035%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:87.47063%,Single Stage Multi Point:12.52937%]
[INFO] ** dst:[21:43.39161%,10:20.82439%,8:18.20803%,9:17.57334%,22:0.00123%,6:0.00053%,25:0.00035%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99807%,-33.760870000000004:0.00175%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99807%,0:0.00175%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.47463%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99877%,2:0.00123%]
[INFO] ** proxy_src_ip:[18:38.1118%,20:26.10437%,13:18.20803%,6:17.57334%,10:0.00105%,11:0.00088%,16:0.00053%]
[INFO] ** s_port:[1.45442:26.10332%,-0.32151:20.82439%,-1.27613:18.20768%,-0.23351:17.57316%,-0.33484:17.28742%,-5.20264:0.0007%,1.45709:0.00053%,-1.02014:0.00053%,-64.19493:0.00035%,-71.14798:0.00035%,1.46509:0.00035%,-1.27347:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-71.14931:0.00018%,-68.79874000000001:0.00018%,0.75578:0.00018%]
[INFO] ** scada_tag:[3:26.10297%,1:20.82421%,5:18.20751%,4:17.57299%,2:17.28724%,0:0.00508%]
[INFO] ** service:[0.0048200000000000005:99.99877%,-211.08346:0.00035%,-186.44547:0.00035%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.1118%,9:26.10437%,7:18.20803%,1:17.57334%,11:0.00105%,10:0.00088%,15:0.00053%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1562 (0.27349%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0013 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0158e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0012 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2548e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.5668e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7423e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.7669e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9818 - val_tp: 16300.0000 - val_fp: 3700.0000 - val_tn: 76300.0000 - val_fn: 3700.0000 - val_accuracy: 0.9260 - val_precision: 0.8150 - val_recall: 0.8150 - val_auc: 0.8844
[INFO] saving weights to checkpoints/lstm-epoch-5-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.8235 - tp: 31244.0000 - fp: 48756.0000 - tn: 271244.0000 - fn: 48756.0000 - accuracy: 0.7562 - precision: 0.3905 - recall: 0.3905 - auc: 0.6167 - val_loss: 9.8667 - val_tp: 7757.0000 - val_fp: 12243.0000 - val_tn: 67757.0000 - val_fn: 12243.0000 - val_accuracy: 0.7551 - val_precision: 0.3878 - val_recall: 0.3878 - val_auc: 0.6174
[INFO] saving weights to checkpoints/lstm-epoch-5-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/571138
[33m[INFO] loading file 20-20/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571138, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571138, 17)

[INFO] analyzing data
[INFO] 571138 rows
[INFO] ** appi_name:[21:99.99667%,30:0.0028%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:91.62374%,Single Stage Multi Point:8.37626%]
[INFO] ** dst:[21:43.42313%,10:20.8377%,8:18.16006%,9:17.57421%,15:0.0028%,22:0.00123%,24:0.00035%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99755%,0:0.00245%]
[INFO] ** i/f_name:[2:99.9972%,3:0.0028%]
[INFO] ** modbus_function_code:[0.02961:99.99667%,-33.760870000000004:0.00333%]
[INFO] ** modbus_function_description:[7:49.99982%,11:49.99685%,0:0.00333%]
[INFO] ** modbus_transaction_id:65536 (11.47463%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99667%,1:0.0028%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.11303%,20:26.1485%,13:18.16023%,6:17.57474%,17:0.0028%,14:0.00053%,16:0.00018%]
[INFO] ** s_port:[1.45442:26.14762%,-0.32151:20.8377%,-1.27613:18.15971%,-0.23351:17.57404%,-0.33484:17.27533%,-71.33197:0.0028%,1.45709:0.00053%,-0.24151:0.00053%,-1.27347:0.00035%,13.431270000000001:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-71.14798:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:26.1471%,1:20.83752%,5:18.15971%,4:17.57369%,2:17.27516%,0:0.00683%]
[INFO] ** service:[0.0048200000000000005:99.99667%,-211.73542999999998:0.0028%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.11303%,9:26.1485%,7:18.16023%,1:17.57474%,14:0.0028%,2:0.00053%,15:0.00018%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1561 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3830 - tp: 73139.0000 - fp: 6861.0000 - tn: 313139.0000 - fn: 6861.0000 - accuracy: 0.9657 - precision: 0.9142 - recall: 0.9142 - auc: 0.9460 - val_loss: 2.0089e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.8866 - tp: 70639.0000 - fp: 9361.0000 - tn: 310639.0000 - fn: 9361.0000 - accuracy: 0.9532 - precision: 0.8830 - recall: 0.8830 - auc: 0.9264 - val_loss: 2.9222 - val_tp: 16374.0000 - val_fp: 3626.0000 - val_tn: 76374.0000 - val_fn: 3626.0000 - val_accuracy: 0.9275 - val_precision: 0.8187 - val_recall: 0.8187 - val_auc: 0.8867
[INFO] saving weights to checkpoints/lstm-epoch-5-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9574 - tp: 65324.0000 - fp: 14676.0000 - tn: 305324.0000 - fn: 14676.0000 - accuracy: 0.9266 - precision: 0.8166 - recall: 0.8166 - auc: 0.8846 - val_loss: 2.9077 - val_tp: 16392.0000 - val_fp: 3608.0000 - val_tn: 76392.0000 - val_fn: 3608.0000 - val_accuracy: 0.9278 - val_precision: 0.8196 - val_recall: 0.8196 - val_auc: 0.8873
[INFO] saving weights to checkpoints/lstm-epoch-5-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.9564 - tp: 70292.0000 - fp: 9708.0000 - tn: 310292.0000 - fn: 9708.0000 - accuracy: 0.9515 - precision: 0.8787 - recall: 0.8787 - auc: 0.9237 - val_loss: 1.6330e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.4422e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5153e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/571138
[33m[INFO] loading file 21-21/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571136, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571136, 17)

[INFO] analyzing data
[INFO] 571136 rows
[INFO] ** appi_name:[21:99.99615%,30:0.00105%,7:0.00053%,26:0.00035%,22:0.00035%,0:0.00035%,31:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:98.93143%,Multi Stage Single Point:1.06857%]
[INFO] ** dst:[21:43.31718%,10:20.98029%,8:18.16275%,9:17.53505%,15:0.00105%,22:0.00088%,24:0.0007%,6:0.0007%,25:0.00035%,16:0.00035%,2:0.00035%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99895%,0:0.00105%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99615%,-33.760870000000004:0.00368%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99912%,11:49.99702%,0:0.00368%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.47468%)
[INFO] ** orig:[0:99.9993%,2:0.0007%]
[INFO] ** proto:[0:99.99755%,2:0.0014%,1:0.00105%]
[INFO] ** proxy_src_ip:[18:38.30594%,20:25.99136%,13:18.16345%,6:17.53488%,17:0.00105%,10:0.00105%,11:0.00088%,16:0.00053%,1:0.00035%,21:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.99066%,-0.32151:20.97959%,-1.27613:18.16257%,-0.23351:17.5347%,-0.33484:17.32635%,-71.33197:0.00105%,-1.27347:0.0007%,-6.64392:0.0007%,-1.02014:0.00053%,-64.19493:0.00035%,-71.14931:0.00035%,-71.14798:0.00035%,1.47576:0.00035%,1.46509:0.00018%,-1.2708:0.00018%,6.62488:0.00018%,10.15141:0.00018%,-68.79874000000001:0.00018%,7.060860000000001:0.00018%,-3.3787199999999995:0.00018%,-2.2440900000000004:0.00018%,1.45709:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.99013%,1:20.97942%,5:18.1624%,4:17.53435%,2:17.32635%,0:0.00735%]
[INFO] ** service:[0.0048200000000000005:99.99685%,-211.73542999999998:0.00105%,-211.09762999999998:0.00053%,-211.08346:0.00035%,-186.44547:0.00035%,-211.08818:0.00035%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.30594%,9:25.99136%,7:18.16345%,1:17.53488%,11:0.00105%,21:0.00088%,10:0.00088%,15:0.00053%,14:0.00035%,3:0.00035%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1556 (0.27244%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571136
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.1990e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4406e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/571136
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.4258e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3915e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/571136
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.0651e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3297e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/571136
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.7204e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2855e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/571136
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.3759e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3551e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/571136
[33m[INFO] loading file 22-22/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (340177, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (340177, 17)

[INFO] analyzing data
[INFO] 340177 rows
[INFO] ** appi_name:[21:99.99265%,30:0.00647%,23:0.00029%,22:0.00029%,18:0.00029%]
[INFO] ** classification:[normal:61.0344%,Multi Stage Single Point:38.9656%]
[INFO] ** dst:[21:43.31392%,10:21.00171%,8:18.09911%,9:17.57673%,15:0.00647%,22:0.00118%,19:0.00059%,26:0.00029%]
[INFO] ** i/f_dir:[1:99.99383%,0:0.00617%]
[INFO] ** i/f_name:[2:99.99353%,3:0.00617%,0:0.00029%]
[INFO] ** modbus_function_code:[0.02961:99.99265%,-33.760870000000004:0.00735%]
[INFO] ** modbus_function_description:[7:49.99721%,11:49.99544%,0:0.00735%]
[INFO] ** modbus_transaction_id:65534 (19.26468%)
[INFO] ** orig:[0:99.995%,2:0.00441%,1:0.00059%]
[INFO] ** proto:[0:99.99324%,1:0.00647%,2:0.00029%]
[INFO] ** proxy_src_ip:[18:38.32622%,20:25.99029%,13:18.09852%,6:17.57761%,17:0.00647%,14:0.00059%,10:0.00029%]
[INFO] ** s_port:[1.45442:25.98941%,-0.32151:21.00171%,-1.27613:18.09852%,-0.23351:17.57673%,-0.33484:17.32451%,-71.33197:0.00647%,1.45709:0.00059%,-0.24151:0.00059%,7.228860000000001:0.00059%,-0.24950999999999998:0.00029%,1.46509:0.00029%,-71.14931:0.00029%]
[INFO] ** scada_tag:[3:25.98912%,1:21.00171%,5:18.09852%,4:17.57644%,2:17.32451%,0:0.0097%]
[INFO] ** service:[0.0048200000000000005:99.99265%,-211.73542999999998:0.00647%,-211.07873999999998:0.00059%,-211.08818:0.00029%]
[INFO] ** src:[22:38.32622%,9:25.99029%,7:18.09852%,1:17.57761%,21:0.00441%,14:0.00206%,2:0.00059%,11:0.00029%]
[INFO] ** type:[0:99.99824%,1:0.00176%]
[INFO] ** unixtime:939 (0.27603%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/340177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.0651 - tp: 69751.0000 - fp: 10249.0000 - tn: 309751.0000 - fn: 10249.0000 - accuracy: 0.9488 - precision: 0.8719 - recall: 0.8719 - auc: 0.9195 - val_loss: 7.5594 - val_tp: 10620.0000 - val_fp: 9380.0000 - val_tn: 70620.0000 - val_fn: 9380.0000 - val_accuracy: 0.8124 - val_precision: 0.5310 - val_recall: 0.5310 - val_auc: 0.7069
[INFO] saving weights to checkpoints/lstm-epoch-5-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/340177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5722 - tp: 42417.0000 - fp: 37583.0000 - tn: 282417.0000 - fn: 37583.0000 - accuracy: 0.8121 - precision: 0.5302 - recall: 0.5302 - auc: 0.7045 - val_loss: 7.5666 - val_tp: 10611.0000 - val_fp: 9389.0000 - val_tn: 70611.0000 - val_fn: 9389.0000 - val_accuracy: 0.8122 - val_precision: 0.5306 - val_recall: 0.5306 - val_auc: 0.7066
[INFO] saving weights to checkpoints/lstm-epoch-5-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/340177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5960 - tp: 42299.0000 - fp: 37701.0000 - tn: 282299.0000 - fn: 37701.0000 - accuracy: 0.8115 - precision: 0.5287 - recall: 0.5287 - auc: 0.7036 - val_loss: 7.5546 - val_tp: 10626.0000 - val_fp: 9374.0000 - val_tn: 70626.0000 - val_fn: 9374.0000 - val_accuracy: 0.8125 - val_precision: 0.5313 - val_recall: 0.5313 - val_auc: 0.7071
[INFO] saving weights to checkpoints/lstm-epoch-5-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/340177
[33m[INFO] loading file 23-23/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540177, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540177, 17)

[INFO] analyzing data
[INFO] 540177 rows
[INFO] ** appi_name:[21:99.99889%,31:0.00037%,30:0.00037%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:94.83299%,Multi Stage Single Point:5.16701%]
[INFO] ** dst:[21:43.33098%,10:21.00793%,8:18.13369%,9:17.52518%,22:0.00093%,24:0.00037%,18:0.00037%,15:0.00037%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99963%,3:0.00037%]
[INFO] ** modbus_function_code:[0.02961:99.99889%,-33.760870000000004:0.00111%]
[INFO] ** modbus_function_description:[7:50.00028%,11:49.99861%,0:0.00111%]
[INFO] ** modbus_transaction_id:65536 (12.13232%)
[INFO] ** orig:[0:99.99981%,2:0.00019%]
[INFO] ** proto:[0:99.99907%,2:0.00056%,1:0.00037%]
[INFO] ** proxy_src_ip:[18:38.35613%,20:25.98296%,13:18.13387%,6:17.52537%,16:0.00056%,17:0.00037%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98241%,-0.32151:21.00774%,-1.27613:18.13332%,-0.23351:17.525%,-0.33484:17.34839%,-1.02014:0.00056%,-1.27347:0.00037%,-0.08551:0.00037%,-71.33197:0.00037%,1.45709:0.00019%,-0.24151:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,1.46509:0.00019%,-64.19493:0.00019%,-0.24950999999999998:0.00019%,-49.275529999999996:0.00019%]
[INFO] ** scada_tag:[3:25.98204%,1:21.00774%,5:18.13313%,4:17.52481%,2:17.3482%,0:0.00407%]
[INFO] ** service:[0.0048200000000000005:99.99907%,-211.73542999999998:0.00037%,-186.43601999999998:0.00037%,-186.44547:0.00019%]
[INFO] ** src:[22:38.35613%,9:25.98296%,7:18.13387%,1:17.52537%,15:0.00056%,21:0.00019%,17:0.00019%,14:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1469 (0.27195%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.6235 - tp: 52089.0000 - fp: 27911.0000 - tn: 292089.0000 - fn: 27911.0000 - accuracy: 0.8604 - precision: 0.6511 - recall: 0.6511 - auc: 0.7806 - val_loss: 1.2025e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.5127e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3266e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.1655e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0171e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/540177
[33m[INFO] loading file 24-24/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540177, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540177, 17)

[INFO] analyzing data
[INFO] 540177 rows
[INFO] ** appi_name:[21:99.99315%,30:0.00333%,26:0.00056%,31:0.00037%,27:0.00037%,22:0.00037%,0:0.00037%,24:0.00019%,23:0.00019%,19:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,11:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:95.28303%,Multi Stage Single Point:4.71697%]
[INFO] ** dst:[21:43.35671%,10:21.02403%,8:18.10481%,9:17.50722%,15:0.00333%,22:0.00111%,6:0.00074%,25:0.00037%,24:0.00037%,19:0.00037%,18:0.00037%,7:0.00037%,26:0.00019%]
[INFO] ** i/f_dir:[1:99.99685%,0:0.00315%]
[INFO] ** i/f_name:[2:99.99667%,3:0.00333%]
[INFO] ** modbus_function_code:[0.02961:99.99315%,-33.760870000000004:0.00629%,-0.415:0.00019%,0.9188299999999999:0.00019%,0.47422:0.00019%]
[INFO] ** modbus_function_description:[7:49.9975%,11:49.99565%,0:0.00629%,15:0.00019%,10:0.00019%,2:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.13232%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.99463%,1:0.00333%,2:0.00204%]
[INFO] ** proxy_src_ip:[18:38.40223%,20:25.97926%,13:18.10481%,6:17.50648%,17:0.00333%,10:0.0013%,14:0.00093%,11:0.00093%,21:0.00037%,16:0.00037%]
[INFO] ** s_port:[1.45442:25.97852%,-0.32151:21.02403%,-1.27613:18.10444%,-0.23351:17.50593%,-0.33484:17.37819%,-71.33197:0.00333%,-9.58113:0.00074%,-71.14798:0.00056%,-1.27347:0.00037%,1.45709:0.00037%,-0.24151:0.00037%,-1.02014:0.00037%,-31.55091:0.00037%,7.6315100000000005:0.00037%,-71.14931:0.00037%,-64.19493:0.00037%,-68.79874000000001:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,7.4901800000000005:0.00019%,13.431270000000001:0.00019%,11.862:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:25.97834%,1:21.02403%,5:18.10425%,4:17.50556%,2:17.37801%,0:0.00981%]
[INFO] ** service:[0.0048200000000000005:99.99426%,-211.73542999999998:0.00333%,-211.08346:0.00056%,-211.07873999999998:0.00037%,-202.75898:0.00037%,-186.44547:0.00037%,-186.43601999999998:0.00037%,-211.08818:0.00037%]
[INFO] ** src:[22:38.40223%,9:25.97926%,7:18.10481%,1:17.50648%,14:0.00333%,11:0.0013%,10:0.00093%,2:0.00093%,15:0.00037%,4:0.00037%]
[INFO] ** type:[0:99.9987%,1:0.00093%,2:0.00037%]
[INFO] ** unixtime:1467 (0.27158%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.5757e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.9148e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.6457e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1956e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.0385e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8325 - tp: 75868.0000 - fp: 4132.0000 - tn: 315868.0000 - fn: 4132.0000 - accuracy: 0.9793 - precision: 0.9484 - recall: 0.9484 - auc: 0.9677 - val_loss: 5.7106 - val_tp: 12914.0000 - val_fp: 7086.0000 - val_tn: 72914.0000 - val_fn: 7086.0000 - val_accuracy: 0.8583 - val_precision: 0.6457 - val_recall: 0.6457 - val_auc: 0.7786
[INFO] saving weights to checkpoints/lstm-epoch-5-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/540177
[33m[INFO] loading file 25-25/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540177, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540177, 17)

[INFO] analyzing data
[INFO] 540177 rows
[INFO] ** appi_name:[21:99.9963%,30:0.00111%,17:0.00074%,22:0.00056%,31:0.00037%,28:0.00019%,26:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** classification:[normal:64.34669%,Multi Stage Single Point:35.65331%]
[INFO] ** dst:[21:43.31932%,10:21.02292%,8:18.14424%,9:17.50908%,15:0.00111%,22:0.00093%,16:0.00074%,6:0.00074%,18:0.00037%,17:0.00037%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99889%,0:0.00111%]
[INFO] ** i/f_name:[2:99.99889%,3:0.00111%]
[INFO] ** modbus_function_code:[0.02961:99.9963%,-33.760870000000004:0.0037%]
[INFO] ** modbus_function_description:[7:49.99898%,11:49.99732%,0:0.0037%]
[INFO] ** modbus_transaction_id:65536 (12.13232%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99778%,2:0.00111%,1:0.00111%]
[INFO] ** proxy_src_ip:[18:38.38631%,20:25.95575%,13:18.14424%,6:17.50963%,17:0.00111%,1:0.00093%,21:0.00074%,16:0.00037%,14:0.00037%,7:0.00037%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95538%,-0.32151:21.02255%,-1.27613:18.14387%,-0.23351:17.50908%,-0.33484:17.36375%,-71.33197:0.00111%,-71.14931:0.00056%,-0.24151:0.00037%,-1.02014:0.00037%,-49.275529999999996:0.00037%,1.46509:0.00019%,-5.1466400000000005:0.00019%,-1.27347:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,-0.24950999999999998:0.00019%,2.52505:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,6.1115699999999995:0.00019%,-5.08665:0.00019%,1.45709:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:25.95501%,1:21.02237%,5:18.14368%,4:17.50889%,2:17.36357%,0:0.00648%]
[INFO] ** service:[0.0048200000000000005:99.99667%,-211.73542999999998:0.00111%,-205.44247:0.00074%,-211.08818:0.00056%,-186.43601999999998:0.00037%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.38631%,9:25.95575%,7:18.14424%,1:17.50963%,14:0.00111%,3:0.00093%,4:0.00074%,21:0.00037%,15:0.00037%,2:0.00037%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1468 (0.27176%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7421 - tp: 51500.0000 - fp: 28500.0000 - tn: 291500.0000 - fn: 28500.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7773 - val_loss: 5.7614 - val_tp: 12851.0000 - val_fp: 7149.0000 - val_tn: 72851.0000 - val_fn: 7149.0000 - val_accuracy: 0.8570 - val_precision: 0.6425 - val_recall: 0.6425 - val_auc: 0.7766
[INFO] saving weights to checkpoints/lstm-epoch-5-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7487 - tp: 51467.0000 - fp: 28533.0000 - tn: 291467.0000 - fn: 28533.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.7771 - val_loss: 5.7219 - val_tp: 12900.0000 - val_fp: 7100.0000 - val_tn: 72900.0000 - val_fn: 7100.0000 - val_accuracy: 0.8580 - val_precision: 0.6450 - val_recall: 0.6450 - val_auc: 0.7781
[INFO] saving weights to checkpoints/lstm-epoch-5-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7473 - tp: 51474.0000 - fp: 28526.0000 - tn: 291474.0000 - fn: 28526.0000 - accuracy: 0.8574 - precision: 0.6434 - recall: 0.6434 - auc: 0.7771 - val_loss: 5.7671 - val_tp: 12844.0000 - val_fp: 7156.0000 - val_tn: 72844.0000 - val_fn: 7156.0000 - val_accuracy: 0.8569 - val_precision: 0.6422 - val_recall: 0.6422 - val_auc: 0.7764
[INFO] saving weights to checkpoints/lstm-epoch-5-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7415 - tp: 51503.0000 - fp: 28497.0000 - tn: 291503.0000 - fn: 28497.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7774 - val_loss: 5.7646 - val_tp: 12847.0000 - val_fp: 7153.0000 - val_tn: 72847.0000 - val_fn: 7153.0000 - val_accuracy: 0.8569 - val_precision: 0.6424 - val_recall: 0.6424 - val_auc: 0.7765
[INFO] saving weights to checkpoints/lstm-epoch-5-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7498 - tp: 51462.0000 - fp: 28538.0000 - tn: 291462.0000 - fn: 28538.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.7770 - val_loss: 5.7421 - val_tp: 12875.0000 - val_fp: 7125.0000 - val_tn: 72875.0000 - val_fn: 7125.0000 - val_accuracy: 0.8575 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.7773
[INFO] saving weights to checkpoints/lstm-epoch-5-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/540177
[33m[INFO] loading file 26-26/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540177, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540177, 17)

[INFO] analyzing data
[INFO] 540177 rows
[INFO] ** appi_name:[21:99.99852%,7:0.00056%,31:0.00019%,30:0.00019%,22:0.00019%,12:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:64.39963%,Single Stage Single Point:29.56661%,Multi Stage Single Point:6.03376%]
[INFO] ** dst:[21:43.31173%,10:21.08587%,8:18.11647%,9:17.48353%,22:0.00074%,24:0.00037%,16:0.00037%,2:0.00037%,18:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99852%,-33.760870000000004:0.00148%]
[INFO] ** modbus_function_description:[7:49.99991%,11:49.99861%,0:0.00148%]
[INFO] ** modbus_transaction_id:65536 (12.13232%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99944%,2:0.00037%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.46721%,20:25.93057%,13:18.11684%,6:17.48353%,1:0.00056%,21:0.00037%,16:0.00037%,17:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.93002%,-0.32151:21.08568%,-1.27613:18.11628%,-0.23351:17.48334%,-0.33484:17.38152%,-1.27347:0.00037%,-1.02014:0.00037%,7.66617:0.00019%,-71.14931:0.00019%,11.57001:0.00019%,-3.3787199999999995:0.00019%,2.52505:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%,1.45709:0.00019%,-49.275529999999996:0.00019%,1.47576:0.00019%,1.46509:0.00019%,14.191239999999999:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.92965%,1:21.08568%,5:18.11628%,4:17.48316%,2:17.38152%,0:0.0037%]
[INFO] ** service:[0.0048200000000000005:99.9987%,-211.09762999999998:0.00056%,-211.35747999999998:0.00019%,-211.73542999999998:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.46721%,9:25.93057%,7:18.11684%,1:17.48353%,3:0.00056%,15:0.00037%,4:0.00037%,21:0.00019%,14:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1466 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7383 - tp: 51519.0000 - fp: 28481.0000 - tn: 291519.0000 - fn: 28481.0000 - accuracy: 0.8576 - precision: 0.6440 - recall: 0.6440 - auc: 0.7775 - val_loss: 5.7429 - val_tp: 12874.0000 - val_fp: 7126.0000 - val_tn: 72874.0000 - val_fn: 7126.0000 - val_accuracy: 0.8575 - val_precision: 0.6437 - val_recall: 0.6437 - val_auc: 0.7773
[INFO] saving weights to checkpoints/lstm-epoch-5-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0874 - tp: 68445.0000 - fp: 11555.0000 - tn: 308445.0000 - fn: 11555.0000 - accuracy: 0.9422 - precision: 0.8556 - recall: 0.8556 - auc: 0.9294 - val_loss: 2.0049e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0721 - tp: 78896.0000 - fp: 1104.0000 - tn: 318896.0000 - fn: 1104.0000 - accuracy: 0.9945 - precision: 0.9862 - recall: 0.9862 - auc: 0.9928 - val_loss: 7.7339e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0704 - tp: 79018.0000 - fp: 982.0000 - tn: 319018.0000 - fn: 982.0000 - accuracy: 0.9951 - precision: 0.9877 - recall: 0.9877 - auc: 0.9925 - val_loss: 4.6494e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0635 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9931 - val_loss: 3.6277e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/540177
[33m[INFO] loading file 27-27/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (480307, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (480307, 17)

[INFO] analyzing data
[INFO] 480307 rows
[INFO] ** appi_name:[21:99.99938%,30:0.00062%]
[INFO] ** classification:[normal:64.33802%,Single Stage Single Point:35.66198%]
[INFO] ** dst:[21:43.27149%,10:21.06465%,8:18.18733%,9:17.47487%,22:0.00083%,15:0.00062%,24:0.00021%]
[INFO] ** i/f_dir:[1:99.99979%,0:0.00021%]
[INFO] ** i/f_name:[2:99.99938%,3:0.00062%]
[INFO] ** modbus_function_code:[0.02961:99.99938%,-33.760870000000004:0.00062%]
[INFO] ** modbus_function_description:[7:50.00031%,11:49.99906%,0:0.00062%]
[INFO] ** modbus_transaction_id:65536 (13.64461%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99938%,1:0.00062%]
[INFO] ** proxy_src_ip:[18:38.40585%,20:25.93092%,13:18.18712%,6:17.47507%,17:0.00062%,16:0.00042%]
[INFO] ** s_port:[1.45442:25.93029%,-0.32151:21.06465%,-1.27613:18.18691%,-0.23351:17.47466%,-0.33484:17.3412%,-71.33197:0.00062%,-1.02014:0.00042%,-1.27347:0.00021%,1.45709:0.00021%,-0.24950999999999998:0.00021%,1.46509:0.00021%,1.47576:0.00021%,-0.24151:0.00021%]
[INFO] ** scada_tag:[3:25.92987%,1:21.06444%,5:18.1867%,4:17.47445%,2:17.34099%,0:0.00354%]
[INFO] ** service:[0.0048200000000000005:99.99938%,-211.73542999999998:0.00062%]
[INFO] ** src:[22:38.40585%,9:25.93092%,7:18.18712%,1:17.47507%,14:0.00062%,15:0.00042%]
[INFO] ** type:[0:99.99958%,1:0.00042%]
[INFO] ** unixtime:1305 (0.2717%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/480307
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0658 - tp: 79040.0000 - fp: 960.0000 - tn: 319040.0000 - fn: 960.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9927 - val_loss: 2.3654e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/480307
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0607 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9930 - val_loss: 1.6065e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/480307
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0585 - tp: 79123.0000 - fp: 877.0000 - tn: 319123.0000 - fn: 877.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9993 - val_loss: 8.0718e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/480307
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0609 - tp: 79059.0000 - fp: 941.0000 - tn: 319059.0000 - fn: 941.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9997 - val_loss: 1.0928e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/480307
[33m[INFO] loading file 28-28/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (414223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (414223, 17)

[INFO] analyzing data
[INFO] 414223 rows
[INFO] ** appi_name:[21:99.99276%,30:0.00169%,17:0.00121%,22:0.00097%,7:0.00097%,31:0.00072%,26:0.00072%,28:0.00024%,27:0.00024%,8:0.00024%,0:0.00024%]
[INFO] ** classification:[normal:64.31922%,Single Stage Single Point:35.68078%]
[INFO] ** dst:[21:43.28272%,10:21.02901%,8:18.20203%,9:17.47851%,6:0.00193%,16:0.00169%,18:0.00121%,15:0.00072%,22:0.00048%,17:0.00048%,2:0.00048%,25:0.00024%,7:0.00024%,0:0.00024%]
[INFO] ** i/f_dir:[1:99.99928%,0:0.00072%]
[INFO] ** i/f_name:[2:99.99928%,3:0.00072%]
[INFO] ** modbus_function_code:[0.02961:99.99276%,-33.760870000000004:0.00724%]
[INFO] ** modbus_function_description:[7:49.9965%,11:49.99626%,0:0.00724%]
[INFO] ** modbus_transaction_id:65536 (15.82143%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99565%,2:0.00362%,1:0.00072%]
[INFO] ** proxy_src_ip:[18:38.35132%,20:25.96041%,13:18.20227%,6:17.47875%,1:0.00193%,17:0.00169%,14:0.00145%,7:0.00121%,21:0.00072%,0:0.00024%]
[INFO] ** s_port:[1.45442:25.96017%,-0.32151:21.02901%,-1.27613:18.20203%,-0.23351:17.47827%,-0.33484:17.32231%,-71.14798:0.00097%,-71.14931:0.00097%,-71.33197:0.00072%,-0.08551:0.00048%,-0.24151:0.00048%,7.66617:0.00024%,-58.035180000000004:0.00024%,-1.2708:0.00024%,-64.19493:0.00024%,-5.1466400000000005:0.00024%,13.431270000000001:0.00024%,11.57001:0.00024%,14.4699:0.00024%,1.47576:0.00024%,14.191239999999999:0.00024%,-5.08665:0.00024%,10.192739999999999:0.00024%,-3.3787199999999995:0.00024%,6.1115699999999995:0.00024%,2.05573:0.00024%,-43.76509:0.00024%,2.52505:0.00024%,11.862:0.00024%,-58.032509999999995:0.00024%]
[INFO] ** scada_tag:[3:25.95993%,1:21.02877%,5:18.20203%,4:17.47778%,2:17.32231%,0:0.00917%]
[INFO] ** service:[0.0048200000000000005:99.99276%,-205.44247:0.00121%,-186.43601999999998:0.00121%,-211.09762999999998:0.00097%,-211.08346:0.00097%,-211.08818:0.00097%,-211.73542999999998:0.00072%,-186.44547:0.00024%,-183.8612:0.00024%,-185.9872:0.00024%,-211.35747999999998:0.00024%,-202.75898:0.00024%]
[INFO] ** src:[22:38.35132%,9:25.96041%,7:18.20227%,1:17.47875%,3:0.00217%,2:0.00145%,21:0.00121%,4:0.00097%,14:0.00072%,8:0.00048%,17:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1126 (0.27183%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/414223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0580 - tp: 79076.0000 - fp: 924.0000 - tn: 319076.0000 - fn: 924.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9997 - val_loss: 6.4329e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/414223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0537 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9997 - val_loss: 3.7148e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/414223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0508 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9998 - val_loss: 7.0911e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/414223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0485 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 5.5397e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-27-28-batch-300000-400000
[INFO] processing batch 400000-500000/414223
[33m[INFO] loading file 29-29/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (514223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (514223, 17)

[INFO] analyzing data
[INFO] 514223 rows
[INFO] ** appi_name:[21:99.99883%,30:0.00058%,26:0.00019%,9:0.00019%,3:0.00019%]
[INFO] ** classification:[normal:64.38666%,Single Stage Single Point:35.61334%]
[INFO] ** dst:[21:43.32809%,10:21.05721%,8:18.14602%,9:17.46694%,22:0.00058%,15:0.00058%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99942%,3:0.00058%]
[INFO] ** modbus_function_code:[0.02961:99.99883%,-33.760870000000004:0.00117%]
[INFO] ** modbus_function_description:[7:49.9999%,11:49.99893%,0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (12.74467%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99922%,1:0.00058%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.43955%,20:25.94594%,13:18.14641%,6:17.46674%,17:0.00058%,21:0.00019%,16:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.94536%,-0.32151:21.05701%,-1.27613:18.14602%,-0.23351:17.46674%,-0.33484:17.38254%,-71.33197:0.00058%,1.45709:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.94497%,1:21.05682%,5:18.14602%,4:17.46635%,2:17.38254%,0:0.00331%]
[INFO] ** service:[0.0048200000000000005:99.99903%,-211.73542999999998:0.00058%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.43955%,9:25.94594%,7:18.14641%,1:17.46674%,14:0.00058%,15:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1397 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0443 - tp: 79148.0000 - fp: 852.0000 - tn: 319148.0000 - fn: 852.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.0382e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0437 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 7.9681e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0408 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 7.3565e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0383 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 6.6085e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0362 - tp: 79078.0000 - fp: 922.0000 - tn: 319078.0000 - fn: 922.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 5.2650e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/514223
[33m[INFO] loading file 30-30/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (514223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (514223, 17)

[INFO] analyzing data
[INFO] 514223 rows
[INFO] ** appi_name:[21:99.99747%,30:0.00175%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.36779%,Single Stage Single Point:35.63221%]
[INFO] ** dst:[21:43.34034%,10:21.02434%,8:18.14407%,9:17.48774%,15:0.00175%,22:0.00078%,24:0.00039%,25:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99825%,0:0.00175%]
[INFO] ** i/f_name:[2:99.99825%,3:0.00175%]
[INFO] ** modbus_function_code:[0.02961:99.99747%,-33.760870000000004:0.00253%]
[INFO] ** modbus_function_description:[7:49.9999%,11:49.99757%,0:0.00253%]
[INFO] ** modbus_transaction_id:65536 (12.74467%)
[INFO] ** orig:[0:99.99903%,2:0.00058%,1:0.00039%]
[INFO] ** proto:[0:99.99786%,1:0.00175%,2:0.00039%]
[INFO] ** proxy_src_ip:[18:38.36487%,20:25.99961%,13:18.14446%,6:17.48833%,17:0.00175%,7:0.00039%,16:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.99942%,-0.32151:21.02415%,-1.27613:18.14388%,-0.23351:17.48755%,-0.33484:17.34073%,-71.33197:0.00175%,-0.24151:0.00058%,-1.27347:0.00039%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,10.192739999999999:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.99903%,1:21.02415%,5:18.14368%,4:17.48735%,2:17.34053%,0:0.00525%]
[INFO] ** service:[0.0048200000000000005:99.99767%,-211.73542999999998:0.00175%,-186.44547:0.00019%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.36487%,9:25.99961%,7:18.14446%,1:17.48833%,14:0.00117%,21:0.00097%,16:0.00019%,15:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99922%,1:0.00078%]
[INFO] ** unixtime:1398 (0.27187%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0311 - tp: 79139.0000 - fp: 861.0000 - tn: 319139.0000 - fn: 861.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 4.4558e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0277 - tp: 79166.0000 - fp: 834.0000 - tn: 319166.0000 - fn: 834.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 3.1007e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0285 - tp: 79057.0000 - fp: 943.0000 - tn: 319057.0000 - fn: 943.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 8.0612e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0253 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.6969e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0234 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.4350e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/514223
[33m[INFO] loading file 31-31/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (514223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (514223, 17)

[INFO] analyzing data
[INFO] 514223 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.37674%,Single Stage Single Point:35.62326%]
[INFO] ** dst:[21:43.31642%,10:21.05915%,8:18.12521%,9:17.49786%,22:0.00097%,24:0.00039%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.0001%,11:49.9999%]
[INFO] ** modbus_transaction_id:65536 (12.74467%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.40688%,20:25.96947%,13:18.1254%,6:17.49786%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.96869%,-0.32151:21.05915%,-1.27613:18.12502%,-0.23351:17.49766%,-0.33484:17.34773%,-1.27347:0.00039%,1.45709:0.00039%,-1.02014:0.00039%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.96831%,1:21.05896%,5:18.12482%,4:17.49747%,2:17.34753%,0:0.00292%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.40688%,9:25.96947%,7:18.1254%,1:17.49786%,15:0.00039%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1397 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0226 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.2668e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0217 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.2010e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0214 - tp: 79080.0000 - fp: 920.0000 - tn: 319080.0000 - fn: 920.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1923e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79109.0000 - fp: 891.0000 - tn: 319109.0000 - fn: 891.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79138.0000 - fp: 862.0000 - tn: 319138.0000 - fn: 862.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1922e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/514223
[33m[INFO] loading file 32-32/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (514223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (514223, 17)

[INFO] analyzing data
[INFO] 514223 rows
[INFO] ** appi_name:[21:99.99611%,30:0.00331%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.37674%,Single Stage Single Point:35.62326%]
[INFO] ** dst:[21:43.3205%,10:21.05118%,8:18.16002%,9:17.46344%,15:0.00331%,22:0.00097%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99708%,0:0.00292%]
[INFO] ** i/f_name:[2:99.99669%,3:0.00331%]
[INFO] ** modbus_function_code:[0.02961:99.99611%,-33.760870000000004:0.00389%]
[INFO] ** modbus_function_description:[7:49.99893%,11:49.99718%,0:0.00389%]
[INFO] ** modbus_transaction_id:65536 (12.74467%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99611%,1:0.00331%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.40999%,20:25.96208%,13:18.15983%,6:17.46402%,17:0.00331%,14:0.00058%,16:0.00019%]
[INFO] ** s_port:[1.45442:25.9615%,-0.32151:21.05118%,-1.27613:18.15963%,-0.23351:17.46324%,-0.33484:17.35881%,-71.33197:0.00331%,-0.24151:0.00058%,-71.14798:0.00019%,11.862:0.00019%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,13.431270000000001:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.96111%,1:21.05098%,5:18.15963%,4:17.46285%,2:17.35881%,0:0.00661%]
[INFO] ** service:[0.0048200000000000005:99.99611%,-211.73542999999998:0.00331%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.40999%,9:25.96208%,7:18.15983%,1:17.46402%,14:0.00331%,2:0.00058%,15:0.00019%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1396 (0.27148%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79052.0000 - fp: 948.0000 - tn: 319052.0000 - fn: 948.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79166.0000 - fp: 834.0000 - tn: 319166.0000 - fn: 834.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79136.0000 - fp: 864.0000 - tn: 319136.0000 - fn: 864.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79131.0000 - fp: 869.0000 - tn: 319131.0000 - fn: 869.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/514223
[33m[INFO] loading file 33-33/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (514223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (514223, 17)

[INFO] analyzing data
[INFO] 514223 rows
[INFO] ** appi_name:[21:99.99669%,30:0.00117%,17:0.00078%,22:0.00058%,31:0.00019%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.40008%,Single Stage Single Point:35.59992%]
[INFO] ** dst:[21:43.33587%,10:21.05915%,8:18.10985%,9:17.49008%,22:0.00136%,15:0.00117%,16:0.00078%,6:0.00078%,24:0.00039%,17:0.00039%,18:0.00019%]
[INFO] ** i/f_dir:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name:[2:99.99883%,3:0.00117%]
[INFO] ** modbus_function_code:[0.02961:99.99669%,-33.760870000000004:0.00331%]
[INFO] ** modbus_function_description:[7:49.99951%,11:49.99718%,0:0.00331%]
[INFO] ** modbus_transaction_id:65536 (12.74467%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99786%,1:0.00117%,2:0.00097%]
[INFO] ** proxy_src_ip:[18:38.42516%,20:25.97064%,13:18.10985%,6:17.49027%,17:0.00117%,16:0.00078%,1:0.00078%,21:0.00039%,14:0.00039%,7:0.00039%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.96986%,-0.32151:21.05915%,-1.27613:18.10946%,-0.23351:17.48988%,-0.33484:17.36601%,-71.33197:0.00117%,-1.02014:0.00078%,-71.14931:0.00058%,1.45709:0.00039%,-1.27347:0.00039%,-71.14798:0.00019%,-58.035180000000004:0.00019%,-5.1466400000000005:0.00019%,-0.24151:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-5.08665:0.00019%,-0.24950999999999998:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.96947%,1:21.05915%,5:18.10926%,4:17.48969%,2:17.36601%,0:0.00642%]
[INFO] ** service:[0.0048200000000000005:99.99669%,-211.73542999999998:0.00117%,-205.44247:0.00078%,-211.08818:0.00058%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.42516%,9:25.97064%,7:18.10985%,1:17.49027%,14:0.00117%,15:0.00078%,3:0.00078%,21:0.00039%,4:0.00039%,2:0.00039%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1399 (0.27206%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79066.0000 - fp: 934.0000 - tn: 319066.0000 - fn: 934.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1926e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79085.0000 - fp: 915.0000 - tn: 319085.0000 - fn: 915.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/514223
[33m[INFO] loading file 34-34/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (355656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (355656, 17)

[INFO] analyzing data
[INFO] 355656 rows
[INFO] ** appi_name:[21:99.99747%,7:0.00084%,30:0.00056%,31:0.00028%,22:0.00028%,8:0.00028%,6:0.00028%]
[INFO] ** classification:[normal:64.33014%,Single Stage Single Point:35.66986%]
[INFO] ** dst:[21:43.26934%,10:21.05771%,8:18.21564%,9:17.45423%,22:0.00084%,16:0.00056%,15:0.00056%,2:0.00056%,18:0.00028%,6:0.00028%]
[INFO] ** i/f_dir:[1:99.99944%,0:0.00056%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99747%,-33.760870000000004:0.00253%]
[INFO] ** modbus_function_description:[7:49.99916%,11:49.99831%,0:0.00253%]
[INFO] ** modbus_transaction_id:65536 (18.42679%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99888%,2:0.00056%,1:0.00056%]
[INFO] ** proxy_src_ip:[18:38.3795%,20:25.94754%,13:18.21564%,6:17.45479%,1:0.00084%,21:0.00056%,17:0.00056%,14:0.00028%,7:0.00028%]
[INFO] ** s_port:[1.45442:25.94726%,-0.32151:21.05743%,-1.27613:18.21564%,-0.23351:17.45394%,-0.33484:17.32208%,-0.24151:0.00084%,-71.33197:0.00056%,-3.0613900000000003:0.00028%,-3.3787199999999995:0.00028%,14.191239999999999:0.00028%,1.47576:0.00028%,11.57001:0.00028%,-49.275529999999996:0.00028%,-71.14931:0.00028%,7.66617:0.00028%]
[INFO] ** scada_tag:[3:25.94698%,1:21.05715%,5:18.21535%,4:17.45366%,2:17.32208%,0:0.00478%]
[INFO] ** service:[0.0048200000000000005:99.99775%,-211.09762999999998:0.00084%,-211.73542999999998:0.00056%,-186.43601999999998:0.00028%,-211.35747999999998:0.00028%,-211.08818:0.00028%]
[INFO] ** src:[22:38.3795%,9:25.94754%,7:18.21564%,1:17.45479%,3:0.00084%,14:0.00056%,4:0.00056%,21:0.00028%,2:0.00028%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:966 (0.27161%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/355656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79128.0000 - fp: 872.0000 - tn: 319128.0000 - fn: 872.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/355656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79089.0000 - fp: 911.0000 - tn: 319089.0000 - fn: 911.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/355656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79131.0000 - fp: 869.0000 - tn: 319131.0000 - fn: 869.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/355656
[33m[INFO] loading file 35-35/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:99.99892%,30:0.00108%]
[INFO] ** classification:[normal:64.36716%,Single Stage Single Point:35.63284%]
[INFO] ** dst:[21:43.32771%,10:21.03694%,8:18.15782%,9:17.47538%,22:0.00108%,15:0.00108%]
[INFO] ** i/f_dir:[1:99.9991%,0:0.0009%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99892%,-33.760870000000004:0.00108%]
[INFO] ** modbus_function_description:[7:50.00036%,11:49.99856%,0:0.00108%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:99.99964%,1:0.00036%]
[INFO] ** proto:[0:99.99892%,1:0.00108%]
[INFO] ** proxy_src_ip:[18:38.39714%,20:25.96804%,13:18.15746%,6:17.47556%,17:0.00108%,16:0.00072%]
[INFO] ** s_port:[1.45442:25.96751%,-0.32151:21.03694%,-1.27613:18.15746%,-0.23351:17.4752%,-0.33484:17.3602%,-71.33197:0.00108%,-1.02014:0.00072%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.96715%,1:21.03694%,5:18.15728%,4:17.47484%,2:17.3602%,0:0.0036%]
[INFO] ** service:[0.0048200000000000005:99.99892%,-211.73542999999998:0.00108%]
[INFO] ** src:[22:38.39714%,9:25.96804%,7:18.15746%,1:17.47556%,14:0.00108%,15:0.00072%]
[INFO] ** type:[0:99.9991%,1:0.0009%]
[INFO] ** unixtime:1508 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79141.0000 - fp: 859.0000 - tn: 319141.0000 - fn: 859.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79084.0000 - fp: 916.0000 - tn: 319084.0000 - fn: 916.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 36-36/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:99.99856%,30:0.00072%,31:0.00036%,33:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.36158%,Single Stage Single Point:35.63842%]
[INFO] ** dst:[21:43.33149%,10:21.02776%,8:18.14828%,9:17.48996%,22:0.0009%,15:0.00072%,24:0.00036%,18:0.00036%,25:0.00018%]
[INFO] ** i/f_dir:[1:99.99928%,0:0.00072%]
[INFO] ** i/f_name:[2:99.99928%,3:0.00072%]
[INFO] ** modbus_function_code:[0.02961:99.99856%,-33.760870000000004:0.00144%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99838%,0:0.00144%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99874%,1:0.00072%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.37734%,20:25.98208%,13:18.14846%,6:17.4905%,17:0.00072%,21:0.00018%,16:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98154%,-0.32151:21.02758%,-1.27613:18.14792%,-0.23351:17.48978%,-0.33484:17.34976%,-71.33197:0.00072%,-0.24151:0.00054%,-0.08551:0.00036%,-1.27347:0.00036%,1.45709:0.00018%,1.47576:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,1.46509:0.00018%,-64.19493:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:25.98118%,1:21.0274%,5:18.14774%,4:17.4896%,2:17.34958%,0:0.0045%]
[INFO] ** service:[0.0048200000000000005:99.99874%,-211.73542999999998:0.00072%,-186.43601999999998:0.00036%,-186.44547:0.00018%]
[INFO] ** src:[22:38.37734%,9:25.98208%,7:18.14846%,1:17.4905%,14:0.00072%,17:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1509 (0.27157%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79145.0000 - fp: 855.0000 - tn: 319145.0000 - fn: 855.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0215 - tp: 79034.0000 - fp: 966.0000 - tn: 319034.0000 - fn: 966.0000 - accuracy: 0.9952 - precision: 0.9879 - recall: 0.9879 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79083.0000 - fp: 917.0000 - tn: 319083.0000 - fn: 917.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79081.0000 - fp: 919.0000 - tn: 319081.0000 - fn: 919.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 37-37/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:99.99892%,30:0.00072%,26:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:64.37436%,Single Stage Single Point:35.62564%]
[INFO] ** dst:[21:43.33311%,10:21.03928%,8:18.13856%,9:17.48708%,22:0.00072%,15:0.00072%,24:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99928%,3:0.00072%]
[INFO] ** modbus_function_code:[0.02961:99.99892%,-33.760870000000004:0.00108%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99874%,0:0.00108%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9991%,1:0.00072%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.38634%,20:25.9864%,13:18.13856%,6:17.48726%,17:0.00072%,16:0.00036%,21:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:25.98586%,-0.32151:21.03928%,-1.27613:18.1382%,-0.23351:17.4869%,-0.33484:17.34706%,-71.33197:0.00072%,-1.02014:0.00036%,-71.14798:0.00018%,-1.27347:0.00018%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.2708:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.98568%,1:21.03928%,5:18.13802%,4:17.48672%,2:17.34688%,0:0.00342%]
[INFO] ** service:[0.0048200000000000005:99.99892%,-211.73542999999998:0.00072%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.38634%,9:25.9864%,7:18.13856%,1:17.48726%,14:0.00072%,15:0.00036%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1509 (0.27157%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 38-38/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:99.9991%,30:0.00018%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.40981%,Single Stage Single Point:35.59019%]
[INFO] ** dst:[21:43.31889%,10:21.08895%,8:18.09681%,9:17.49356%,22:0.0009%,25:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99982%,0:0.00018%]
[INFO] ** i/f_name:[2:99.99982%,3:0.00018%]
[INFO] ** modbus_function_code:[0.02961:99.9991%,-33.760870000000004:0.0009%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99946%,0:0.0009%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99946%,2:0.00036%,1:0.00018%]
[INFO] ** proxy_src_ip:[18:38.45689%,20:25.95149%,13:18.09663%,6:17.49392%,7:0.00036%,17:0.00018%,16:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95077%,-0.32151:21.08877%,-1.27613:18.09645%,-0.23351:17.49338%,-0.33484:17.36812%,-0.24151:0.00036%,1.45709:0.00036%,-64.19493:0.00018%,10.192739999999999:0.00018%,-1.02014:0.00018%,-71.14798:0.00018%,-61.95768:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-71.33197:0.00018%]
[INFO] ** scada_tag:[3:25.95041%,1:21.08877%,5:18.09645%,4:17.4932%,2:17.36812%,0:0.00306%]
[INFO] ** service:[0.0048200000000000005:99.99928%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%,-211.73542999999998:0.00018%]
[INFO] ** src:[22:38.45689%,9:25.95149%,7:18.09663%,1:17.49392%,21:0.00036%,16:0.00018%,15:0.00018%,14:0.00018%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1510 (0.27175%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79158.0000 - fp: 842.0000 - tn: 319158.0000 - fn: 842.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79072.0000 - fp: 928.0000 - tn: 319072.0000 - fn: 928.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79130.0000 - fp: 870.0000 - tn: 319130.0000 - fn: 870.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79086.0000 - fp: 914.0000 - tn: 319086.0000 - fn: 914.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.8686e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 39-39/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.40208%,Single Stage Single Point:35.59792%]
[INFO] ** dst:[21:43.32177%,10:21.07941%,8:18.13316%,9:17.46458%,22:0.0009%,24:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99982%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.44807%,20:25.95347%,13:18.13334%,6:17.46458%,16:0.00054%]
[INFO] ** s_port:[1.45442:25.95293%,-0.32151:21.07941%,-1.27613:18.13298%,-0.23351:17.4644%,-0.33484:17.36866%,-1.02014:0.00054%,-1.27347:0.00018%,1.45709:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.2708:0.00018%]
[INFO] ** scada_tag:[3:25.95257%,1:21.07923%,5:18.1328%,4:17.4644%,2:17.36848%,0:0.00252%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.44807%,9:25.95347%,7:18.13334%,1:17.46458%,15:0.00054%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1508 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79143.0000 - fp: 857.0000 - tn: 319143.0000 - fn: 857.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79072.0000 - fp: 928.0000 - tn: 319072.0000 - fn: 928.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0195 - tp: 79159.0000 - fp: 841.0000 - tn: 319159.0000 - fn: 841.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 40-40/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:99.9964%,30:0.00306%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.33801%,Single Stage Single Point:35.66199%]
[INFO] ** dst:[21:43.29621%,10:21.03694%,8:18.19615%,9:17.46602%,15:0.00306%,22:0.0009%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99712%,0:0.00288%]
[INFO] ** i/f_name:[2:99.99694%,3:0.00306%]
[INFO] ** modbus_function_code:[0.02961:99.9964%,-33.760870000000004:0.0036%]
[INFO] ** modbus_function_description:[7:49.99928%,11:49.99712%,0:0.0036%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:99.99964%,1:0.00036%]
[INFO] ** proto:[0:99.9964%,1:0.00306%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.35665%,20:25.9774%,13:18.19597%,6:17.46638%,17:0.00306%,14:0.00054%]
[INFO] ** s_port:[1.45442:25.9765%,-0.32151:21.03694%,-1.27613:18.19579%,-0.23351:17.46584%,-0.33484:17.31971%,-71.33197:0.00306%,1.45709:0.00054%,-0.24151:0.00036%,-71.14798:0.00018%,-1.27347:0.00018%,11.862:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,13.431270000000001:0.00018%]
[INFO] ** scada_tag:[3:25.97614%,1:21.03676%,5:18.19561%,4:17.46548%,2:17.31953%,0:0.00648%]
[INFO] ** service:[0.0048200000000000005:99.9964%,-211.73542999999998:0.00306%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.35665%,9:25.9774%,7:18.19597%,1:17.46638%,14:0.00306%,2:0.00054%]
[INFO] ** type:[0:99.9991%,1:0.0009%]
[INFO] ** unixtime:1511 (0.27193%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79161.0000 - fp: 839.0000 - tn: 319161.0000 - fn: 839.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79147.0000 - fp: 853.0000 - tn: 319147.0000 - fn: 853.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 41-41/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (495814, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (495814, 17)

[INFO] analyzing data
[INFO] 495814 rows
[INFO] ** appi_name:[21:99.99657%,30:0.00101%,22:0.00081%,17:0.00081%,32:0.0002%,28:0.0002%,26:0.0002%,7:0.0002%]
[INFO] ** classification:[normal:64.38786%,Single Stage Single Point:35.61214%]
[INFO] ** dst:[21:43.32008%,10:21.06354%,8:18.14108%,9:17.47087%,16:0.00101%,15:0.00101%,6:0.00101%,22:0.00061%,24:0.0004%,17:0.0004%]
[INFO] ** i/f_dir:[1:99.99899%,0:0.00101%]
[INFO] ** i/f_name:[2:99.99899%,3:0.00101%]
[INFO] ** modbus_function_code:[0.02961:99.99657%,-33.760870000000004:0.00343%]
[INFO] ** modbus_function_description:[7:49.99899%,11:49.99758%,0:0.00343%]
[INFO] ** modbus_transaction_id:65536 (13.21786%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99778%,2:0.00121%,1:0.00101%]
[INFO] ** proxy_src_ip:[18:38.43256%,20:25.95126%,13:18.14128%,6:17.47107%,17:0.00101%,1:0.00081%,21:0.0004%,16:0.0004%,14:0.0004%,0:0.0004%,7:0.0002%,2:0.0002%]
[INFO] ** s_port:[1.45442:25.95086%,-0.32151:21.06354%,-1.27613:18.14067%,-0.23351:17.47066%,-0.33484:17.36901%,-71.33197:0.00101%,-71.14931:0.00081%,-1.02014:0.0004%,-1.27347:0.0004%,-71.14798:0.0002%,-0.24151:0.0002%,-58.035180000000004:0.0002%,-1.2708:0.0002%,-5.1466400000000005:0.0002%,1.47576:0.0002%,1.46509:0.0002%,-64.19226:0.0002%,-5.08665:0.0002%,-0.24950999999999998:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:25.95066%,1:21.06354%,5:18.14067%,4:17.47046%,2:17.36901%,0:0.00565%]
[INFO] ** service:[0.0048200000000000005:99.99657%,-211.73542999999998:0.00101%,-205.44247:0.00081%,-211.08818:0.00081%,89.64175:0.0002%,-211.09762999999998:0.0002%,-211.08346:0.0002%,-185.9872:0.0002%]
[INFO] ** src:[22:38.43256%,9:25.95126%,7:18.14128%,1:17.47107%,14:0.00101%,3:0.00081%,15:0.0004%,8:0.0004%,4:0.0004%,2:0.0004%,21:0.0002%,17:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1345 (0.27127%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/495814
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/495814
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79075.0000 - fp: 925.0000 - tn: 319075.0000 - fn: 925.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/495814
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/495814
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79079.0000 - fp: 921.0000 - tn: 319079.0000 - fn: 921.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 8.0717e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/495814
[33m[INFO] loading file 42-42/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (439328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (439328, 17)

[INFO] analyzing data
[INFO] 439328 rows
[INFO] ** appi_name:[21:99.99203%,30:0.00228%,17:0.00114%,31:0.00091%,26:0.00091%,7:0.00091%,22:0.00068%,28:0.00023%,27:0.00023%,9:0.00023%,8:0.00023%,0:0.00023%]
[INFO] ** classification:[normal:64.38037%,Single Stage Single Point:35.61963%]
[INFO] ** dst:[21:43.31843%,10:21.05329%,8:18.17139%,9:17.44778%,16:0.00205%,6:0.00182%,18:0.00114%,22:0.00091%,15:0.00091%,2:0.00091%,17:0.00046%,25:0.00023%,24:0.00023%,7:0.00023%,0:0.00023%]
[INFO] ** i/f_dir:[1:99.99909%,0:0.00091%]
[INFO] ** i/f_name:[2:99.99909%,3:0.00091%]
[INFO] ** modbus_function_code:[0.02961:99.99203%,-33.760870000000004:0.00797%]
[INFO] ** modbus_function_description:[7:49.99704%,11:49.99499%,0:0.00797%]
[INFO] ** modbus_transaction_id:65536 (14.91733%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99568%,2:0.00341%,1:0.00091%]
[INFO] ** proxy_src_ip:[18:38.41003%,20:25.96192%,13:18.17184%,6:17.44778%,17:0.00228%,1:0.00205%,14:0.00137%,21:0.00091%,7:0.00068%,16:0.00046%,0:0.00046%,2:0.00023%]
[INFO] ** s_port:[1.45442:25.96147%,-0.32151:21.05329%,-1.27613:18.17139%,-0.23351:17.44756%,-0.33484:17.35674%,-71.14798:0.00091%,-71.33197:0.00091%,-71.14931:0.00091%,11.57001:0.00046%,-0.08551:0.00046%,-3.3787199999999995:0.00046%,-1.02014:0.00046%,-5.1466400000000005:0.00023%,-0.24151:0.00023%,13.431270000000001:0.00023%,0.31847:0.00023%,-1.2708:0.00023%,-58.035180000000004:0.00023%,7.66617:0.00023%,-64.19493:0.00023%,1.47576:0.00023%,14.4699:0.00023%,15.912510000000001:0.00023%,14.191239999999999:0.00023%,7.9608300000000005:0.00023%,-5.08665:0.00023%,10.192739999999999:0.00023%,-3.0613900000000003:0.00023%,1.45709:0.00023%,2.05573:0.00023%,-43.76509:0.00023%,11.862:0.00023%,-1.27347:0.00023%,-58.032509999999995:0.00023%]
[INFO] ** scada_tag:[3:25.96101%,1:21.05329%,5:18.17116%,4:17.44756%,2:17.35651%,0:0.01047%]
[INFO] ** service:[0.0048200000000000005:99.99203%,-211.09762999999998:0.00159%,-205.44247:0.00114%,-186.43601999999998:0.00114%,-211.08346:0.00091%,-211.73542999999998:0.00091%,-211.08818:0.00091%,-211.35747999999998:0.00046%,-186.44547:0.00023%,-183.8612:0.00023%,-185.9872:0.00023%,-202.75898:0.00023%]
[INFO] ** src:[22:38.41003%,9:25.96192%,7:18.17184%,1:17.44778%,3:0.00273%,2:0.00159%,4:0.00114%,21:0.00091%,14:0.00091%,15:0.00046%,8:0.00046%,17:0.00023%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1192 (0.27132%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/439328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 0.2834 - val_tp: 19531.0000 - val_fp: 469.0000 - val_tn: 79531.0000 - val_fn: 469.0000 - val_accuracy: 0.9906 - val_precision: 0.9765 - val_recall: 0.9765 - val_auc: 0.9875
[INFO] saving weights to checkpoints/lstm-epoch-5-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/439328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0264 - tp: 79077.0000 - fp: 923.0000 - tn: 319077.0000 - fn: 923.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9996 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/439328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/439328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 8.0643e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-41-42-batch-300000-400000
[INFO] processing batch 400000-500000/439328
[33m[INFO] loading file 43-43/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99926%,30:0.00056%,26:0.00019%]
[INFO] ** classification:[normal:64.39569%,Single Stage Single Point:35.60431%]
[INFO] ** dst:[21:43.32688%,10:21.06714%,8:18.13182%,9:17.4723%,22:0.00093%,15:0.00056%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99926%,-33.760870000000004:0.00074%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99907%,0:0.00074%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99926%,1:0.00056%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.41577%,20:25.97881%,13:18.13201%,6:17.4723%,17:0.00056%,16:0.00037%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.97807%,-0.32151:21.06714%,-1.27613:18.13164%,-0.23351:17.47193%,-0.33484:17.34863%,-71.33197:0.00056%,1.45709:0.00037%,1.47576:0.00037%,-1.02014:0.00037%,-71.14798:0.00019%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.9777%,1:21.06714%,5:18.13145%,4:17.47156%,2:17.34844%,0:0.00371%]
[INFO] ** service:[0.0048200000000000005:99.99926%,-211.73542999999998:0.00056%,-211.08346:0.00019%]
[INFO] ** src:[22:38.41577%,9:25.97881%,7:18.13201%,1:17.4723%,14:0.00056%,15:0.00037%,3:0.00019%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1467 (0.27201%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79071.0000 - fp: 929.0000 - tn: 319071.0000 - fn: 929.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79082.0000 - fp: 918.0000 - tn: 319082.0000 - fn: 918.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79042.0000 - fp: 958.0000 - tn: 319042.0000 - fn: 958.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 44-44/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99815%,30:0.00074%,31:0.00056%,0:0.00037%,22:0.00019%]
[INFO] ** classification:[normal:64.38123%,Single Stage Single Point:35.61877%]
[INFO] ** dst:[21:43.33411%,10:21.04397%,8:18.15611%,9:17.46247%,22:0.00111%,15:0.00074%,18:0.00056%,25:0.00037%,24:0.00037%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99926%,0:0.00074%]
[INFO] ** i/f_name:[2:99.99926%,3:0.00074%]
[INFO] ** modbus_function_code:[0.02961:99.99815%,-33.760870000000004:0.00185%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99796%,0:0.00185%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99815%,2:0.00111%,1:0.00074%]
[INFO] ** proxy_src_ip:[18:38.42226%,20:25.95638%,13:18.1563%,6:17.46303%,17:0.00074%,7:0.00037%,16:0.00019%,5:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95563%,-0.32151:21.04397%,-1.27613:18.15574%,-0.23351:17.46229%,-0.33484:17.37829%,-71.33197:0.00074%,-0.24151:0.00056%,-0.08551:0.00037%,-64.19493:0.00037%,-1.27347:0.00037%,1.45709:0.00037%,-1.02014:0.00019%,-1.2708:0.00019%,1.47576:0.00019%,-71.14931:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,4.42897:0.00019%]
[INFO] ** scada_tag:[3:25.95508%,1:21.04397%,5:18.15574%,4:17.46192%,2:17.37811%,0:0.00519%]
[INFO] ** service:[0.0048200000000000005:99.99815%,-211.73542999999998:0.00074%,-186.43601999999998:0.00056%,-186.44547:0.00037%,-211.08818:0.00019%]
[INFO] ** src:[22:38.42226%,9:25.95638%,7:18.1563%,1:17.46303%,14:0.00074%,21:0.00037%,17:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1463 (0.27126%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79078.0000 - fp: 922.0000 - tn: 319078.0000 - fn: 922.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79153.0000 - fp: 847.0000 - tn: 319153.0000 - fn: 847.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79056.0000 - fp: 944.0000 - tn: 319056.0000 - fn: 944.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 45-45/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99907%,30:0.00056%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.41813%,Single Stage Single Point:35.58187%]
[INFO] ** dst:[21:43.3254%,10:21.09032%,8:18.11884%,9:17.46321%,22:0.0013%,15:0.00056%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99907%,-33.760870000000004:0.00093%]
[INFO] ** modbus_function_description:[7:50.00074%,11:49.99833%,0:0.00093%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99926%,1:0.00056%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.49012%,20:25.92634%,13:18.11866%,6:17.46358%,17:0.00056%,16:0.00037%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.9256%,-0.32151:21.09032%,-1.27613:18.11866%,-0.23351:17.46303%,-0.33484:17.3998%,1.45709:0.00056%,-71.33197:0.00056%,-0.24151:0.00037%,-1.02014:0.00037%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,14.4699:0.00019%]
[INFO] ** scada_tag:[3:25.92504%,1:21.09013%,5:18.11866%,4:17.46303%,2:17.39962%,0:0.00352%]
[INFO] ** service:[0.0048200000000000005:99.99907%,-211.73542999999998:0.00056%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.49012%,9:25.92634%,7:18.11866%,1:17.46358%,14:0.00056%,15:0.00037%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1463 (0.27126%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79124.0000 - fp: 876.0000 - tn: 319124.0000 - fn: 876.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79144.0000 - fp: 856.0000 - tn: 319144.0000 - fn: 856.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79109.0000 - fp: 891.0000 - tn: 319109.0000 - fn: 891.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 46-46/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99815%,30:0.00111%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.42925%,Single Stage Single Point:35.57075%]
[INFO] ** dst:[21:43.35136%,10:21.07512%,8:18.09808%,9:17.47267%,22:0.00111%,15:0.00111%,25:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99907%,0:0.00093%]
[INFO] ** i/f_name:[2:99.99889%,3:0.00111%]
[INFO] ** modbus_function_code:[0.02961:99.99815%,-33.760870000000004:0.00185%]
[INFO] ** modbus_function_description:[11:49.99907%,7:49.99907%,0:0.00185%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.99852%,1:0.00111%,2:0.00037%]
[INFO] ** proxy_src_ip:[18:38.45452%,20:25.97195%,13:18.09808%,6:17.47323%,17:0.00111%,16:0.00037%,7:0.00037%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97158%,-0.32151:21.07493%,-1.27613:18.09789%,-0.23351:17.47248%,-0.33484:17.37959%,-71.33197:0.00111%,-0.24151:0.00056%,-1.02014:0.00037%,-71.14798:0.00019%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-1.2708:0.00019%,10.192739999999999:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:25.97121%,1:21.07474%,5:18.09771%,4:17.47211%,2:17.37959%,0:0.00464%]
[INFO] ** service:[0.0048200000000000005:99.99833%,-211.73542999999998:0.00111%,-211.08346:0.00019%,-205.44247:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.45452%,9:25.97195%,7:18.09808%,1:17.47323%,14:0.00111%,21:0.00037%,15:0.00037%,16:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99907%,1:0.00093%]
[INFO] ** unixtime:1466 (0.27182%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79055.0000 - fp: 945.0000 - tn: 319055.0000 - fn: 945.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0215 - tp: 79062.0000 - fp: 938.0000 - tn: 319062.0000 - fn: 938.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 47-47/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99944%,33:0.00019%,26:0.00019%,17:0.00019%]
[INFO] ** classification:[normal:64.39458%,Single Stage Single Point:35.60542%]
[INFO] ** dst:[21:43.30704%,10:21.0855%,8:18.12719%,9:17.47786%,22:0.00167%,24:0.00037%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99944%,-33.760870000000004:0.00056%]
[INFO] ** modbus_function_description:[7:50.00111%,11:49.99833%,0:0.00056%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99981%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.45712%,20:25.93617%,13:18.12756%,6:17.47823%,16:0.00037%,7:0.00037%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.93524%,-0.32151:21.0855%,-1.27613:18.127%,-0.23351:17.47768%,-0.33484:17.37162%,1.45709:0.00056%,-0.24151:0.00056%,-1.27347:0.00037%,-1.02014:0.00037%,-71.14798:0.00019%,-61.95635:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,10.192739999999999:0.00019%]
[INFO] ** scada_tag:[3:25.93468%,1:21.08531%,5:18.12682%,4:17.47749%,2:17.37143%,0:0.00426%]
[INFO] ** service:[0.0048200000000000005:99.99963%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.45712%,9:25.93617%,7:18.12756%,1:17.47823%,21:0.00037%,15:0.00037%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1464 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0191 - tp: 79157.0000 - fp: 843.0000 - tn: 319157.0000 - fn: 843.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0196 - tp: 79137.0000 - fp: 863.0000 - tn: 319137.0000 - fn: 863.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 48-48/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99666%,30:0.0026%,33:0.00019%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.42313%,Single Stage Single Point:35.57687%]
[INFO] ** dst:[21:43.33485%,10:21.08439%,8:18.11106%,9:17.46544%,15:0.0026%,22:0.00093%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99778%,0:0.00222%]
[INFO] ** i/f_name:[2:99.9974%,3:0.0026%]
[INFO] ** modbus_function_code:[0.02961:99.99666%,-33.760870000000004:0.00334%]
[INFO] ** modbus_function_description:[7:49.99889%,11:49.99778%,0:0.00334%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99685%,1:0.0026%,2:0.00056%]
[INFO] ** proxy_src_ip:[18:38.4586%,20:25.96083%,13:18.11143%,6:17.46544%,17:0.0026%,14:0.00056%,16:0.00037%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.96045%,-0.32151:21.08439%,-1.27613:18.11106%,-0.23351:17.46525%,-0.33484:17.37421%,-71.33197:0.0026%,-1.02014:0.00037%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,1.45709:0.00019%,-61.95635:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,13.431270000000001:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.96008%,1:21.08439%,5:18.11106%,4:17.46525%,2:17.37403%,0:0.00519%]
[INFO] ** service:[0.0048200000000000005:99.99685%,-211.73542999999998:0.0026%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.4586%,9:25.96083%,7:18.11143%,1:17.46544%,14:0.0026%,2:0.00056%,15:0.00037%,8:0.00019%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1463 (0.27126%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79074.0000 - fp: 926.0000 - tn: 319074.0000 - fn: 926.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79078.0000 - fp: 922.0000 - tn: 319078.0000 - fn: 922.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.2122e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 49-49/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99722%,30:0.00093%,17:0.00074%,26:0.00037%,22:0.00037%,28:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.37048%,Single Stage Single Point:35.62952%]
[INFO] ** dst:[21:43.30964%,10:21.05639%,8:18.13813%,9:17.4914%,22:0.0013%,15:0.00093%,16:0.00074%,6:0.00074%,24:0.00037%,17:0.00037%]
[INFO] ** i/f_dir:[1:99.99907%,0:0.00093%]
[INFO] ** i/f_name:[2:99.99907%,3:0.00093%]
[INFO] ** modbus_function_code:[0.02961:99.99722%,-33.760870000000004:0.00278%]
[INFO] ** modbus_function_description:[7:49.99944%,11:49.99778%,0:0.00278%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99833%,1:0.00093%,2:0.00074%]
[INFO] ** proxy_src_ip:[18:38.41762%,20:25.94914%,13:18.13813%,6:17.49195%,17:0.00093%,1:0.00074%,14:0.00056%,21:0.00037%,16:0.00037%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.9484%,-0.32151:21.05639%,-1.27613:18.13776%,-0.23351:17.49121%,-0.33484:17.36123%,-71.33197:0.00093%,-0.24151:0.00056%,-1.27347:0.00037%,-1.02014:0.00037%,1.45709:0.00037%,-71.14931:0.00037%,-71.14798:0.00037%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-5.1466400000000005:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,-5.08665:0.00019%]
[INFO] ** scada_tag:[3:25.94803%,1:21.0562%,5:18.13757%,4:17.49084%,2:17.36123%,0:0.00612%]
[INFO] ** service:[0.0048200000000000005:99.99722%,-211.73542999999998:0.00093%,-205.44247:0.00074%,-211.08346:0.00037%,-211.08818:0.00037%,-211.09762999999998:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.41762%,9:25.94914%,7:18.13813%,1:17.49195%,14:0.00093%,3:0.00074%,2:0.00056%,15:0.00037%,4:0.00037%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1465 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1961e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79060.0000 - fp: 940.0000 - tn: 319060.0000 - fn: 940.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 50-50/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (389310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (389310, 17)

[INFO] analyzing data
[INFO] 389310 rows
[INFO] ** appi_name:[21:99.99743%,30:0.00103%,7:0.00077%,31:0.00026%,22:0.00026%,8:0.00026%]
[INFO] ** classification:[normal:64.30197%,Single Stage Single Point:35.69803%]
[INFO] ** dst:[21:43.25884%,10:21.04005%,8:18.22301%,9:17.47476%,15:0.00103%,22:0.00051%,16:0.00051%,2:0.00051%,24:0.00026%,18:0.00026%,6:0.00026%]
[INFO] ** i/f_dir:[1:99.99897%,0:0.00103%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99743%,-33.760870000000004:0.00257%]
[INFO] ** modbus_function_description:[11:49.99872%,7:49.99872%,0:0.00257%]
[INFO] ** modbus_transaction_id:65536 (16.83389%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99846%,1:0.00103%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.36583%,20:25.93332%,13:18.22327%,6:17.47476%,17:0.00103%,1:0.00077%,21:0.00026%,16:0.00026%,14:0.00026%,7:0.00026%]
[INFO] ** s_port:[1.45442:25.9328%,-0.32151:21.04005%,-1.27613:18.22275%,-0.23351:17.47476%,-0.33484:17.32578%,-71.33197:0.00103%,-3.3787199999999995:0.00026%,4.33564:0.00026%,15.912510000000001:0.00026%,7.9608300000000005:0.00026%,1.46509:0.00026%,1.45709:0.00026%,-1.27347:0.00026%,-71.14931:0.00026%,-1.02014:0.00026%,-1.2708:0.00026%,0.31847:0.00026%]
[INFO] ** scada_tag:[3:25.93255%,1:21.03979%,5:18.2225%,4:17.47476%,2:17.32552%,0:0.00488%]
[INFO] ** service:[0.0048200000000000005:99.99743%,-211.73542999999998:0.00103%,-211.09762999999998:0.00077%,-186.43601999999998:0.00026%,-211.35747999999998:0.00026%,-211.08818:0.00026%]
[INFO] ** src:[22:38.36583%,9:25.93332%,7:18.22327%,1:17.47476%,14:0.00103%,3:0.00077%,21:0.00026%,15:0.00026%,4:0.00026%,2:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1058 (0.27176%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/389310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/389310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79132.0000 - fp: 868.0000 - tn: 319132.0000 - fn: 868.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/389310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1994e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/389310
[33m[INFO] epoch 6/10[0m
[33m[INFO] loading file 1-1/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99338%,22:0.00102%,30:0.00102%,7:0.00068%,17:0.00068%,31:0.00051%,26:0.00051%,23:0.00034%,18:0.00034%,0:0.00034%,24:0.00017%,27:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,28:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:77.01872%,Single Stage Single Point:22.98128%]
[INFO] ** dst:[21:43.27043%,10:21.02968%,8:18.17481%,9:17.51794%,6:0.00153%,22:0.00102%,16:0.00102%,15:0.00102%,18:0.00051%,26:0.00034%,25:0.00034%,19:0.00034%,17:0.00034%,2:0.00034%,24:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.99898%,0:0.00102%]
[INFO] ** i/f_name:[2:99.99898%,3:0.00102%]
[INFO] ** modbus_function_code:[0.02961:99.99338%,-33.760870000000004:0.00645%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99762%,11:49.99576%,0:0.00645%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99644%,2:0.00255%,1:0.00102%]
[INFO] ** proxy_src_ip:[18:38.38896%,20:25.91081%,13:18.17498%,6:17.51828%,11:0.00119%,10:0.00119%,1:0.00119%,17:0.00102%,14:0.00085%,21:0.00051%,7:0.00051%,16:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.9103%,-0.32151:21.029%,-1.27613:18.17464%,-0.23351:17.51778%,-0.33484:17.35996%,-71.33197:0.00102%,-71.14931:0.00102%,-2.1481:0.00068%,-71.14798:0.00051%,-0.24151:0.00051%,-64.19493:0.00034%,-2.42942:0.00034%,4.44364:0.00034%,-1.02014:0.00034%,1.47576:0.00017%,6.1115699999999995:0.00017%,-1.27347:0.00017%,10.67005:0.00017%,4.29964:0.00017%,-5.08665:0.00017%,-3.3787199999999995:0.00017%,1.45709:0.00017%,-68.79874000000001:0.00017%,2.05573:0.00017%,-5.1466400000000005:0.00017%,-43.76509:0.00017%,14.253910000000001:0.00017%,4.076980000000001:0.00017%,-58.032509999999995:0.00017%,-58.035180000000004:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,0.31847:0.00017%]
[INFO] ** scada_tag:[3:25.91013%,1:21.02883%,5:18.17431%,4:17.51761%,2:17.35979%,0:0.00933%]
[INFO] ** service:[0.0048200000000000005:99.99406%,-211.73542999999998:0.00102%,-211.08818:0.00102%,-211.09762999999998:0.00068%,-205.44247:0.00068%,-211.07873999999998:0.00068%,-211.08346:0.00051%,-186.43601999999998:0.00051%,-186.44547:0.00034%,-185.9872:0.00017%,-211.35747999999998:0.00017%,-202.75898:0.00017%]
[INFO] ** src:[22:38.38896%,9:25.91081%,7:18.17498%,1:17.51828%,11:0.00119%,10:0.00119%,3:0.00119%,14:0.00102%,2:0.00085%,21:0.00051%,4:0.00051%,15:0.00034%,8:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1599 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 3.0479 - val_tp: 16218.0000 - val_fp: 3782.0000 - val_tn: 76218.0000 - val_fn: 3782.0000 - val_accuracy: 0.9244 - val_precision: 0.8109 - val_recall: 0.8109 - val_auc: 0.8818
[INFO] saving weights to checkpoints/lstm-epoch-6-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3326 - tp: 78035.0000 - fp: 1965.0000 - tn: 318035.0000 - fn: 1965.0000 - accuracy: 0.9902 - precision: 0.9754 - recall: 0.9754 - auc: 0.9859 - val_loss: 3.6545e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0066 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2586e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3869 - tp: 74753.0000 - fp: 5247.0000 - tn: 314753.0000 - fn: 5247.0000 - accuracy: 0.9738 - precision: 0.9344 - recall: 0.9344 - auc: 0.9824 - val_loss: 1.0273 - val_tp: 10573.0000 - val_fp: 9427.0000 - val_tn: 70573.0000 - val_fn: 9427.0000 - val_accuracy: 0.8115 - val_precision: 0.5286 - val_recall: 0.5286 - val_auc: 0.9445
[INFO] saving weights to checkpoints/lstm-epoch-6-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4217 - tp: 58026.0000 - fp: 21974.0000 - tn: 298026.0000 - fn: 21974.0000 - accuracy: 0.8901 - precision: 0.7253 - recall: 0.7253 - auc: 0.9762 - val_loss: 0.0087 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 2-2/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99864%,30:0.00051%,7:0.00051%,31:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:69.79943%,Single Stage Single Point:30.20057%]
[INFO] ** dst:[21:43.30895%,10:21.02985%,8:18.13579%,9:17.52304%,22:0.00085%,15:0.00051%,16:0.00034%,2:0.00034%,24:0.00017%,18:0.00017%]
[INFO] ** i/f_dir:[1:99.99949%,0:0.00051%]
[INFO] ** i/f_name:[2:99.99949%,3:0.00051%]
[INFO] ** modbus_function_code:[0.02961:99.99864%,-33.760870000000004:0.00136%]
[INFO] ** modbus_function_description:[7:49.99983%,11:49.99881%,0:0.00136%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99932%,1:0.00051%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.38336%,20:25.95595%,13:18.13579%,6:17.52337%,17:0.00051%,1:0.00051%,16:0.00017%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.95527%,-0.32151:21.02985%,-1.27613:18.13545%,-0.23351:17.52287%,-0.33484:17.35352%,-71.33197:0.00051%,-0.24151:0.00034%,1.45709:0.00034%,1.46509:0.00017%,1.47576:0.00017%,12.60597:0.00017%,10.67005:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,4.076980000000001:0.00017%,-3.3787199999999995:0.00017%,4.29964:0.00017%,-1.27347:0.00017%]
[INFO] ** scada_tag:[3:25.95493%,1:21.02985%,5:18.13545%,4:17.52253%,2:17.35335%,0:0.0039%]
[INFO] ** service:[0.0048200000000000005:99.99864%,-211.09762999999998:0.00051%,-211.73542999999998:0.00051%,-211.35747999999998:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.38336%,9:25.95595%,7:18.13579%,1:17.52337%,14:0.00051%,3:0.00051%,21:0.00017%,15:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1602 (0.27184%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1274 - tp: 70513.0000 - fp: 9487.0000 - tn: 310513.0000 - fn: 9487.0000 - accuracy: 0.9526 - precision: 0.8814 - recall: 0.8814 - auc: 0.9960 - val_loss: 0.0019 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1029 - tp: 70708.0000 - fp: 9292.0000 - tn: 310708.0000 - fn: 9292.0000 - accuracy: 0.9535 - precision: 0.8838 - recall: 0.8838 - auc: 0.9961 - val_loss: 0.0013 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4036 - tp: 71012.0000 - fp: 8988.0000 - tn: 311012.0000 - fn: 8988.0000 - accuracy: 0.9551 - precision: 0.8877 - recall: 0.8877 - auc: 0.9783 - val_loss: 0.1288 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3192 - tp: 67210.0000 - fp: 12790.0000 - tn: 307210.0000 - fn: 12790.0000 - accuracy: 0.9360 - precision: 0.8401 - recall: 0.8401 - auc: 0.9804 - val_loss: 0.5074 - val_tp: 10613.0000 - val_fp: 9387.0000 - val_tn: 70613.0000 - val_fn: 9387.0000 - val_accuracy: 0.8123 - val_precision: 0.5307 - val_recall: 0.5307 - val_auc: 0.9448
[INFO] saving weights to checkpoints/lstm-epoch-6-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1658 - tp: 70311.0000 - fp: 9689.0000 - tn: 310311.0000 - fn: 9689.0000 - accuracy: 0.9516 - precision: 0.8789 - recall: 0.8789 - auc: 0.9938 - val_loss: 0.0087 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 3-3/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99219%,30:0.00204%,22:0.00102%,31:0.00085%,26:0.00085%,17:0.00085%,7:0.00068%,27:0.00034%,0:0.00034%,28:0.00017%,23:0.00017%,15:0.00017%,8:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:87.43514%,Single Stage Single Point:12.56486%]
[INFO] ** dst:[21:43.30794%,10:21.07804%,8:18.15971%,9:17.44566%,6:0.00204%,15:0.00136%,18:0.00119%,16:0.00119%,22:0.00085%,2:0.00034%,7:0.00034%,25:0.00034%,17:0.00034%,12:0.00017%,24:0.00017%,19:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99864%,0:0.00136%]
[INFO] ** i/f_name:[2:99.99864%,3:0.00136%]
[INFO] ** modbus_function_code:[0.02961:99.99219%,-33.760870000000004:0.00764%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99695%,11:49.99525%,0:0.00764%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99898%,2:0.00102%]
[INFO] ** proto:[0:99.99457%,2:0.00407%,1:0.00136%]
[INFO] ** proxy_src_ip:[18:38.40457%,20:25.98157%,13:18.16005%,6:17.446%,17:0.00204%,1:0.00136%,14:0.00119%,7:0.00085%,11:0.00068%,10:0.00068%,21:0.00051%,16:0.00017%,15:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.98089%,-0.32151:21.07787%,-1.27613:18.15937%,-0.23351:17.44549%,-0.33484:17.3267%,-71.33197:0.00136%,-71.14931:0.00102%,-71.14798:0.00102%,-64.19493:0.00034%,-1.2708:0.00034%,-0.08551:0.00034%,1.45709:0.00034%,-0.24151:0.00034%,13.86459:0.00017%,2.05573:0.00017%,6.1115699999999995:0.00017%,4.44364:0.00017%,-5.08665:0.00017%,-3.3787199999999995:0.00017%,10.192739999999999:0.00017%,4.29964:0.00017%,14.4699:0.00017%,-43.76509:0.00017%,-58.035180000000004:0.00017%,4.90362:0.00017%,4.076980000000001:0.00017%,-58.032509999999995:0.00017%,-1.27347:0.00017%,-1.02014:0.00017%,-5.1466400000000005:0.00017%,13.431270000000001:0.00017%,12.60597:0.00017%,1.47576:0.00017%,1.46509:0.00017%,14.253910000000001:0.00017%,-68.79874000000001:0.00017%,-0.24950999999999998:0.00017%,-2.1481:0.00017%,10.67005:0.00017%,-68.36943000000001:0.00017%]
[INFO] ** scada_tag:[3:25.98055%,1:21.0777%,5:18.1592%,4:17.44532%,2:17.32653%,0:0.01069%]
[INFO] ** service:[0.0048200000000000005:99.99236%,-211.73542999999998:0.00136%,-186.43601999999998:0.00119%,-211.08346:0.00102%,-211.08818:0.00102%,-205.44247:0.00085%,-211.09762999999998:0.00068%,-202.75898:0.00034%,-186.44547:0.00034%,-183.8612:0.00017%,-185.9872:0.00017%,-201.23771000000002:0.00017%,-211.35747999999998:0.00017%,-211.07873999999998:0.00017%]
[INFO] ** src:[22:38.40457%,9:25.98157%,7:18.16005%,1:17.446%,21:0.00187%,3:0.00153%,2:0.00119%,11:0.00068%,10:0.00068%,4:0.00068%,14:0.00034%,8:0.00034%,17:0.00017%,15:0.00017%,13:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1601 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3495 - tp: 68307.0000 - fp: 11693.0000 - tn: 308307.0000 - fn: 11693.0000 - accuracy: 0.9415 - precision: 0.8538 - recall: 0.8538 - auc: 0.9809 - val_loss: 0.2528 - val_tp: 17863.0000 - val_fp: 2137.0000 - val_tn: 77863.0000 - val_fn: 2137.0000 - val_accuracy: 0.9573 - val_precision: 0.8931 - val_recall: 0.8931 - val_auc: 0.9910
[INFO] saving weights to checkpoints/lstm-epoch-6-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1633 - tp: 69655.0000 - fp: 10345.0000 - tn: 309655.0000 - fn: 10345.0000 - accuracy: 0.9483 - precision: 0.8707 - recall: 0.8707 - auc: 0.9937 - val_loss: 0.0134 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3971 - tp: 61477.0000 - fp: 18523.0000 - tn: 301477.0000 - fn: 18523.0000 - accuracy: 0.9074 - precision: 0.7685 - recall: 0.7685 - auc: 0.9687 - val_loss: 0.2902 - val_tp: 19270.0000 - val_fp: 730.0000 - val_tn: 79270.0000 - val_fn: 730.0000 - val_accuracy: 0.9854 - val_precision: 0.9635 - val_recall: 0.9635 - val_auc: 0.9984
[INFO] saving weights to checkpoints/lstm-epoch-6-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0932 - tp: 79836.0000 - fp: 164.0000 - tn: 319836.0000 - fn: 164.0000 - accuracy: 0.9992 - precision: 0.9980 - recall: 0.9980 - auc: 1.0000 - val_loss: 0.0069 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0240 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0040 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 4-4/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99779%,30:0.00119%,31:0.00034%,33:0.00017%,26:0.00017%,23:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:92.57097%,Single Stage Single Point:7.42903%]
[INFO] ** dst:[21:43.35019%,10:20.95026%,8:18.17651%,9:17.51947%,22:0.00119%,15:0.00119%,24:0.00034%,18:0.00034%,19:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99898%,0:0.00102%]
[INFO] ** i/f_name:[2:99.99881%,3:0.00119%]
[INFO] ** modbus_function_code:[0.02961:99.99779%,-33.760870000000004:0.00221%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99779%,0:0.00221%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99898%,2:0.00102%]
[INFO] ** proto:[0:99.9983%,1:0.00119%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.26034%,20:26.04045%,13:18.17668%,6:17.51981%,17:0.00119%,16:0.00051%,21:0.00034%,14:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.03978%,-0.32151:20.95009%,-1.27613:18.17617%,-0.23351:17.5193%,-0.33484:17.31024%,-71.33197:0.00119%,-1.02014:0.00051%,1.45709:0.00034%,-0.08551:0.00034%,-1.27347:0.00034%,-0.24151:0.00034%,14.4699:0.00017%,4.44364:0.00017%,-71.14798:0.00017%,-1.2708:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:26.03944%,1:20.94992%,5:18.17617%,4:17.51896%,2:17.31007%,0:0.00543%]
[INFO] ** service:[0.0048200000000000005:99.99796%,-211.73542999999998:0.00119%,-186.43601999999998:0.00034%,-183.8612:0.00017%,-211.08346:0.00017%,-211.07873999999998:0.00017%]
[INFO] ** src:[22:38.26034%,9:26.04045%,7:18.17668%,1:17.51981%,21:0.00102%,15:0.00051%,4:0.00034%,17:0.00017%,14:0.00017%,8:0.00017%,3:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1611 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0188 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0024 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0156 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0013 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0142 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3210e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0119 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2430e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8348 - tp: 64826.0000 - fp: 15174.0000 - tn: 304826.0000 - fn: 15174.0000 - accuracy: 0.9241 - precision: 0.8103 - recall: 0.8103 - auc: 0.9496 - val_loss: 0.8368 - val_tp: 7830.0000 - val_fp: 12170.0000 - val_tn: 67830.0000 - val_fn: 12170.0000 - val_accuracy: 0.7566 - val_precision: 0.3915 - val_recall: 0.3915 - val_auc: 0.9055
[INFO] saving weights to checkpoints/lstm-epoch-6-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 5-5/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99627%,30:0.00272%,37:0.00017%,26:0.00017%,12:0.00017%,9:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:87.62298%,Single Stage Single Point:12.37702%]
[INFO] ** dst:[21:43.36224%,10:20.77005%,8:18.24252%,9:17.62078%,15:0.00272%,22:0.00085%,25:0.00017%,24:0.00017%,6:0.00017%,2:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99762%,0:0.00238%]
[INFO] ** i/f_name:[2:99.99728%,3:0.00272%]
[INFO] ** modbus_function_code:[0.02961:99.99627%,-33.760870000000004:0.00373%]
[INFO] ** modbus_function_description:[7:49.99864%,11:49.99762%,0:0.00373%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99779%,2:0.00221%]
[INFO] ** proto:[0:99.99695%,1:0.00272%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.00682%,20:26.12581%,13:18.24252%,6:17.62095%,17:0.00272%,1:0.00034%,21:0.00017%,16:0.00017%,7:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.12513%,-0.32151:20.76971%,-1.27613:18.24235%,-0.23351:17.62061%,-0.33484:17.23711%,-71.33197:0.00272%,-0.24151:0.00034%,1.45709:0.00034%,1.47576:0.00017%,1.46509:0.00017%,-49.275529999999996:0.00017%,-1.27347:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,2.22906:0.00017%,14.4699:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.12479%,1:20.76954%,5:18.24218%,4:17.62061%,2:17.23694%,0:0.00594%]
[INFO] ** service:[0.0048200000000000005:99.99661%,-211.73542999999998:0.00272%,-183.8612:0.00017%,-211.08346:0.00017%,-211.35747999999998:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.00682%,9:26.12581%,7:18.24252%,1:17.62095%,21:0.00238%,14:0.00051%,3:0.00034%,16:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1614 (0.27388%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4326 - tp: 63145.0000 - fp: 16855.0000 - tn: 303145.0000 - fn: 16855.0000 - accuracy: 0.9157 - precision: 0.7893 - recall: 0.7893 - auc: 0.9663 - val_loss: 0.2722 - val_tp: 19981.0000 - val_fp: 19.0000 - val_tn: 79981.0000 - val_fn: 19.0000 - val_accuracy: 0.9996 - val_precision: 0.9991 - val_recall: 0.9991 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3206 - tp: 67543.0000 - fp: 12457.0000 - tn: 307543.0000 - fn: 12457.0000 - accuracy: 0.9377 - precision: 0.8443 - recall: 0.8443 - auc: 0.9822 - val_loss: 0.1641 - val_tp: 19524.0000 - val_fp: 476.0000 - val_tn: 79524.0000 - val_fn: 476.0000 - val_accuracy: 0.9905 - val_precision: 0.9762 - val_recall: 0.9762 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-6-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1342 - tp: 73039.0000 - fp: 6961.0000 - tn: 313039.0000 - fn: 6961.0000 - accuracy: 0.9652 - precision: 0.9130 - recall: 0.9130 - auc: 0.9959 - val_loss: 1.0737 - val_tp: 12817.0000 - val_fp: 7183.0000 - val_tn: 72817.0000 - val_fn: 7183.0000 - val_accuracy: 0.8563 - val_precision: 0.6409 - val_recall: 0.6409 - val_auc: 0.9678
[INFO] saving weights to checkpoints/lstm-epoch-6-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1332 - tp: 77683.0000 - fp: 2317.0000 - tn: 317683.0000 - fn: 2317.0000 - accuracy: 0.9884 - precision: 0.9710 - recall: 0.9710 - auc: 0.9972 - val_loss: 0.0017 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0157 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6954e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 6-6/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.9961%,30:0.00305%,31:0.00017%,27:0.00017%,26:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:93.14368%,Single Stage Single Point:6.85632%]
[INFO] ** dst:[21:43.37785%,10:20.73221%,8:18.27833%,9:17.60703%,15:0.00305%,22:0.00051%,25:0.00017%,24:0.00017%,18:0.00017%,12:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99712%,0:0.00288%]
[INFO] ** i/f_name:[2:99.99695%,3:0.00305%]
[INFO] ** modbus_function_code:[0.02961:99.9961%,-33.760870000000004:0.0039%]
[INFO] ** modbus_function_description:[7:49.99864%,11:49.99745%,0:0.0039%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.9961%,1:0.00305%,2:0.00085%]
[INFO] ** proxy_src_ip:[18:37.95031%,20:26.15992%,13:18.2785%,6:17.6072%,17:0.00305%,14:0.00051%,16:0.00034%,11:0.00017%]
[INFO] ** s_port:[1.45442:26.15958%,-0.32151:20.73221%,-1.27613:18.27799%,-0.23351:17.60686%,-0.33484:17.2181%,-71.33197:0.00305%,-1.02014:0.00034%,-71.14798:0.00017%,-64.19493:0.00017%,4.90362:0.00017%,-1.2708:0.00017%,-0.24151:0.00017%,13.431270000000001:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-68.36943000000001:0.00017%]
[INFO] ** scada_tag:[3:26.15941%,1:20.73187%,5:18.27782%,4:17.60652%,2:17.21793%,0:0.00645%]
[INFO] ** service:[0.0048200000000000005:99.9961%,-211.73542999999998:0.00305%,-211.08346:0.00017%,-201.23771000000002:0.00017%,-202.75898:0.00017%,-186.44547:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:37.95031%,9:26.15992%,7:18.2785%,1:17.6072%,14:0.00305%,2:0.00051%,15:0.00034%,10:0.00017%]
[INFO] ** type:[0:99.99915%,1:0.00085%]
[INFO] ** unixtime:1613 (0.27371%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0127 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7637e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0109 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.1242e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0098 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.2859e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0092 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2928e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0872 - tp: 78956.0000 - fp: 1044.0000 - tn: 318956.0000 - fn: 1044.0000 - accuracy: 0.9948 - precision: 0.9869 - recall: 0.9869 - auc: 0.9968 - val_loss: 1.1777 - val_tp: 12837.0000 - val_fp: 7163.0000 - val_tn: 72837.0000 - val_fn: 7163.0000 - val_accuracy: 0.8567 - val_precision: 0.6418 - val_recall: 0.6418 - val_auc: 0.9679
[INFO] saving weights to checkpoints/lstm-epoch-6-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 7-7/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99525%,30:0.00187%,22:0.00085%,17:0.00068%,26:0.00051%,31:0.00034%,28:0.00017%,27:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:79.87188%,Single Stage Single Point:20.12812%]
[INFO] ** dst:[21:43.36275%,10:20.7278%,8:18.2583%,9:17.6447%,15:0.00187%,22:0.00136%,6:0.00136%,16:0.00068%,24:0.00034%,18:0.00034%,17:0.00034%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.99813%,0:0.00187%]
[INFO] ** i/f_name:[2:99.99813%,3:0.00187%]
[INFO] ** modbus_function_code:[0.02961:99.99525%,-33.760870000000004:0.00475%]
[INFO] ** modbus_function_description:[7:49.9983%,11:49.99695%,0:0.00475%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99627%,2:0.00187%,1:0.00187%]
[INFO] ** proxy_src_ip:[18:37.94913%,20:26.1421%,13:18.25864%,6:17.64487%,17:0.00187%,11:0.00068%,1:0.00068%,21:0.00051%,16:0.00051%,14:0.00034%,7:0.00034%,10:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.14125%,-0.32151:20.7278%,-1.27613:18.25813%,-0.23351:17.64453%,-0.33484:17.22133%,-71.33197:0.00187%,-71.14931:0.00085%,-1.02014:0.00051%,-71.14798:0.00051%,1.45709:0.00051%,-0.24151:0.00034%,-1.27347:0.00034%,1.47576:0.00017%,1.46509:0.00017%,14.253910000000001:0.00017%,-1.2708:0.00017%,-58.035180000000004:0.00017%,-58.032509999999995:0.00017%,-68.79874000000001:0.00017%,-43.76509:0.00017%,2.05573:0.00017%,6.1115699999999995:0.00017%,-5.08665:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:26.14091%,1:20.7278%,5:18.25796%,4:17.64436%,2:17.22116%,0:0.00781%]
[INFO] ** service:[0.0048200000000000005:99.99525%,-211.73542999999998:0.00187%,-211.08818:0.00085%,-205.44247:0.00068%,-211.08346:0.00051%,-186.43601999999998:0.00034%,-211.09762999999998:0.00017%,-185.9872:0.00017%,-202.75898:0.00017%]
[INFO] ** src:[22:37.94913%,9:26.1421%,7:18.25864%,1:17.64487%,14:0.00187%,10:0.00068%,3:0.00068%,15:0.00051%,4:0.00051%,21:0.00034%,2:0.00034%,11:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99932%,1:0.00068%]
[INFO] ** unixtime:1611 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1908 - tp: 70223.0000 - fp: 9777.0000 - tn: 310223.0000 - fn: 9777.0000 - accuracy: 0.9511 - precision: 0.8778 - recall: 0.8778 - auc: 0.9943 - val_loss: 0.0062 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0962 - tp: 72741.0000 - fp: 7259.0000 - tn: 312741.0000 - fn: 7259.0000 - accuracy: 0.9637 - precision: 0.9093 - recall: 0.9093 - auc: 0.9975 - val_loss: 0.0015 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0791 - tp: 75607.0000 - fp: 4393.0000 - tn: 315607.0000 - fn: 4393.0000 - accuracy: 0.9780 - precision: 0.9451 - recall: 0.9451 - auc: 0.9985 - val_loss: 8.9060e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2990 - tp: 67884.0000 - fp: 12116.0000 - tn: 307884.0000 - fn: 12116.0000 - accuracy: 0.9394 - precision: 0.8486 - recall: 0.8486 - auc: 0.9833 - val_loss: 0.1602 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0373 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7016e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 8-8/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99678%,30:0.00102%,0:0.00051%,28:0.00017%,26:0.00017%,24:0.00017%,23:0.00017%,22:0.00017%,18:0.00017%,17:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:95.1506%,Single Stage Single Point:4.8494%]
[INFO] ** dst:[21:43.4162%,10:20.80179%,8:18.19535%,9:17.5826%,22:0.00136%,15:0.00102%,25:0.00051%,19:0.00034%,17:0.00034%,26:0.00017%,24:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99932%,0:0.00068%]
[INFO] ** i/f_name:[2:99.99898%,3:0.00102%]
[INFO] ** modbus_function_code:[0.02961:99.99678%,-33.760870000000004:0.00305%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99966%,11:49.99712%,0:0.00305%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99966%,2:0.00034%]
[INFO] ** proto:[0:99.99813%,1:0.00102%,2:0.00085%]
[INFO] ** proxy_src_ip:[18:38.08284%,20:26.13548%,13:18.19484%,6:17.58294%,17:0.00102%,10:0.00102%,16:0.00068%,1:0.00051%,14:0.00034%,11:0.00017%,5:0.00017%]
[INFO] ** s_port:[1.45442:26.13497%,-0.32151:20.80179%,-1.27613:18.1945%,-0.23351:17.58243%,-0.33484:17.28106%,-71.33197:0.00102%,-1.02014:0.00068%,-15.039579999999999:0.00068%,-64.19493:0.00051%,4.66896:0.00034%,-0.24151:0.00034%,1.45709:0.00034%,-5.1466400000000005:0.00017%,-1.27347:0.00017%,-1.2708:0.00017%,1.47576:0.00017%,-5.08665:0.00017%,-71.14931:0.00017%,-0.24950999999999998:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.13446%,1:20.80162%,5:18.1945%,4:17.58226%,2:17.28089%,0:0.00628%]
[INFO] ** service:[0.0048200000000000005:99.99745%,-211.73542999999998:0.00102%,-186.44547:0.00051%,-211.07873999999998:0.00034%,-211.08346:0.00017%,-185.9872:0.00017%,-205.44247:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.08284%,9:26.13548%,7:18.19484%,1:17.58294%,11:0.00102%,15:0.00068%,14:0.00068%,3:0.00051%,21:0.00034%,2:0.00034%,16:0.00017%,10:0.00017%]
[INFO] ** type:[0:99.99949%,1:0.00034%,2:0.00017%]
[INFO] ** unixtime:1613 (0.27371%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0151 - tp: 79995.0000 - fp: 5.0000 - tn: 319995.0000 - fn: 5.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 5.0870e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0138 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4491e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0119 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0158e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0107 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9291e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3159 - tp: 71155.0000 - fp: 8845.0000 - tn: 311155.0000 - fn: 8845.0000 - accuracy: 0.9558 - precision: 0.8894 - recall: 0.8894 - auc: 0.9856 - val_loss: 0.2813 - val_tp: 16394.0000 - val_fp: 3606.0000 - val_tn: 76394.0000 - val_fn: 3606.0000 - val_accuracy: 0.9279 - val_precision: 0.8197 - val_recall: 0.8197 - val_auc: 0.9842
[INFO] saving weights to checkpoints/lstm-epoch-6-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 9-9/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.9983%,30:0.00102%,31:0.00034%,26:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:93.94597%,Single Stage Single Point:6.05403%]
[INFO] ** dst:[21:43.38124%,10:20.77243%,8:18.27323%,9:17.57038%,15:0.00102%,22:0.00085%,18:0.00034%,25:0.00017%,24:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99898%,0:0.00102%]
[INFO] ** i/f_name:[2:99.99898%,3:0.00102%]
[INFO] ** modbus_function_code:[0.02961:99.9983%,-33.760870000000004:0.0017%]
[INFO] ** modbus_function_description:[7:49.99983%,11:49.99847%,0:0.0017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99966%,2:0.00034%]
[INFO] ** proto:[0:99.9983%,1:0.00102%,2:0.00068%]
[INFO] ** proxy_src_ip:[18:38.01225%,20:26.14193%,13:18.27323%,6:17.57072%,17:0.00102%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.14125%,-0.32151:20.77243%,-1.27613:18.2729%,-0.23351:17.57021%,-0.33484:17.23982%,-71.33197:0.00102%,-0.24151:0.00034%,1.45709:0.00034%,-0.08551:0.00034%,1.46509:0.00017%,1.47576:0.00017%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.14091%,1:20.77226%,5:18.2729%,4:17.57004%,2:17.23965%,0:0.00424%]
[INFO] ** service:[0.0048200000000000005:99.9983%,-211.73542999999998:0.00102%,-186.43601999999998:0.00034%,-211.08346:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.01225%,9:26.14193%,7:18.27323%,1:17.57072%,14:0.00068%,21:0.00034%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1614 (0.27388%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2680 - tp: 65697.0000 - fp: 14303.0000 - tn: 305697.0000 - fn: 14303.0000 - accuracy: 0.9285 - precision: 0.8212 - recall: 0.8212 - auc: 0.9837 - val_loss: 0.2523 - val_tp: 16404.0000 - val_fp: 3596.0000 - val_tn: 76404.0000 - val_fn: 3596.0000 - val_accuracy: 0.9281 - val_precision: 0.8202 - val_recall: 0.8202 - val_auc: 0.9845
[INFO] saving weights to checkpoints/lstm-epoch-6-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2643 - tp: 65521.0000 - fp: 14479.0000 - tn: 305521.0000 - fn: 14479.0000 - accuracy: 0.9276 - precision: 0.8190 - recall: 0.8190 - auc: 0.9835 - val_loss: 0.2445 - val_tp: 17148.0000 - val_fp: 2852.0000 - val_tn: 77148.0000 - val_fn: 2852.0000 - val_accuracy: 0.9430 - val_precision: 0.8574 - val_recall: 0.8574 - val_auc: 0.9877
[INFO] saving weights to checkpoints/lstm-epoch-6-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0565 - tp: 79810.0000 - fp: 190.0000 - tn: 319810.0000 - fn: 190.0000 - accuracy: 0.9991 - precision: 0.9976 - recall: 0.9976 - auc: 1.0000 - val_loss: 8.5650e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0105 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5285e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0088 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.9607e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 10-10/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99644%,30:0.0017%,31:0.00034%,26:0.00017%,24:0.00017%,23:0.00017%,22:0.00017%,18:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:94.81614%,Single Stage Single Point:5.18386%]
[INFO] ** dst:[21:43.40924%,10:20.80891%,8:18.22793%,9:17.55002%,15:0.0017%,24:0.00051%,22:0.00051%,19:0.00034%,18:0.00034%,26:0.00017%,25:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99847%,0:0.00153%]
[INFO] ** i/f_name:[2:99.9983%,3:0.0017%]
[INFO] ** modbus_function_code:[0.02961:99.99644%,-33.760870000000004:0.00339%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99915%,11:49.99728%,0:0.00339%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99932%,1:0.00068%]
[INFO] ** proto:[0:99.99745%,1:0.0017%,2:0.00085%]
[INFO] ** proxy_src_ip:[18:38.08165%,20:26.13701%,13:18.22827%,6:17.54934%,17:0.0017%,10:0.00085%,14:0.00034%,21:0.00017%,16:0.00017%,5:0.00017%,2:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.13633%,-0.32151:20.80891%,-1.27613:18.22759%,-0.23351:17.549%,-0.33484:17.27274%,-71.33197:0.0017%,-10.51843:0.00068%,-1.27347:0.00051%,-0.08551:0.00034%,5.71692:0.00034%,1.47576:0.00034%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-71.14931:0.00017%,-64.19493:0.00017%,1.45709:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.13599%,1:20.80874%,5:18.22759%,4:17.54883%,2:17.27257%,0:0.00628%]
[INFO] ** service:[0.0048200000000000005:99.99712%,-211.73542999999998:0.0017%,-211.07873999999998:0.00034%,-186.43601999999998:0.00034%,-211.08346:0.00017%,-186.44547:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.08165%,9:26.13701%,7:18.22827%,1:17.54934%,14:0.0017%,11:0.00085%,2:0.00034%,17:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%]
[INFO] ** type:[0:99.99864%,1:0.00119%,2:0.00017%]
[INFO] ** unixtime:1610 (0.2732%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0073 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5081e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0068 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2071e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1804 - tp: 76098.0000 - fp: 3902.0000 - tn: 316098.0000 - fn: 3902.0000 - accuracy: 0.9805 - precision: 0.9512 - recall: 0.9512 - auc: 0.9931 - val_loss: 0.7035 - val_tp: 12829.0000 - val_fp: 7171.0000 - val_tn: 72829.0000 - val_fn: 7171.0000 - val_accuracy: 0.8566 - val_precision: 0.6414 - val_recall: 0.6414 - val_auc: 0.9679
[INFO] saving weights to checkpoints/lstm-epoch-6-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3029 - tp: 65660.0000 - fp: 14340.0000 - tn: 305660.0000 - fn: 14340.0000 - accuracy: 0.9283 - precision: 0.8207 - recall: 0.8207 - auc: 0.9825 - val_loss: 0.3083 - val_tp: 12832.0000 - val_fp: 7168.0000 - val_tn: 72832.0000 - val_fn: 7168.0000 - val_accuracy: 0.8566 - val_precision: 0.6416 - val_recall: 0.6416 - val_auc: 0.9679
[INFO] saving weights to checkpoints/lstm-epoch-6-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0999 - tp: 79265.0000 - fp: 735.0000 - tn: 319265.0000 - fn: 735.0000 - accuracy: 0.9963 - precision: 0.9908 - recall: 0.9908 - auc: 0.9998 - val_loss: 0.0445 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 11-11/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99898%,31:0.00034%,30:0.00034%,26:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.39465%,10:20.86983%,8:18.19331%,9:17.54%,22:0.00119%,18:0.00034%,15:0.00034%,25:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99966%,3:0.00034%]
[INFO] ** modbus_function_code:[0.02961:99.99898%,-33.760870000000004:0.00102%]
[INFO] ** modbus_function_description:[7:50.00068%,11:49.9983%,0:0.00102%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99898%,2:0.00068%,1:0.00034%]
[INFO] ** proxy_src_ip:[18:38.14444%,20:26.12038%,13:18.19331%,6:17.54034%,16:0.00051%,17:0.00034%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.11987%,-0.32151:20.86983%,-1.27613:18.19314%,-0.23351:17.53983%,-0.33484:17.27461%,-0.24151:0.00051%,-1.02014:0.00051%,-0.08551:0.00034%,-71.33197:0.00034%,-71.14798:0.00017%,1.45709:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:26.11953%,1:20.86966%,5:18.19297%,4:17.5395%,2:17.27444%,0:0.0039%]
[INFO] ** service:[0.0048200000000000005:99.99898%,-211.73542999999998:0.00034%,-186.43601999999998:0.00034%,-211.08346:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.14444%,9:26.12038%,7:18.19331%,1:17.54034%,15:0.00051%,14:0.00034%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1610 (0.2732%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0076 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0130 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0077 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.7432e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0058 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9472e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0054 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9401e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0051 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6078e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 12-12/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99728%,30:0.00204%,31:0.00034%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:93.85875%,Single Stage Single Point:6.14125%]
[INFO] ** dst:[21:43.40602%,10:20.88205%,8:18.17923%,9:17.52914%,15:0.00204%,22:0.00051%,24:0.00034%,18:0.00034%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.9983%,0:0.0017%]
[INFO] ** i/f_name:[2:99.99796%,3:0.00204%]
[INFO] ** modbus_function_code:[0.02961:99.99728%,-33.760870000000004:0.00272%]
[INFO] ** modbus_function_description:[7:49.99932%,11:49.99796%,0:0.00272%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99847%,2:0.00153%]
[INFO] ** proto:[0:99.99745%,1:0.00204%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.15309%,20:26.13531%,13:18.1794%,6:17.52931%,17:0.00204%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.1348%,-0.32151:20.88205%,-1.27613:18.17889%,-0.23351:17.52897%,-0.33484:17.27105%,-71.33197:0.00204%,-1.27347:0.00034%,-0.08551:0.00034%,1.46509:0.00017%,1.47576:0.00017%,-0.24950999999999998:0.00017%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,1.45709:0.00017%,14.4699:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.13446%,1:20.88205%,5:18.17889%,4:17.52864%,2:17.27105%,0:0.00492%]
[INFO] ** service:[0.0048200000000000005:99.99728%,-211.73542999999998:0.00204%,-186.43601999999998:0.00034%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.15309%,9:26.13531%,7:18.1794%,1:17.52931%,21:0.00153%,14:0.00051%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1611 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0046 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3461e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0044 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3528e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0041 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7143 - val_tp: 12867.0000 - val_fp: 7133.0000 - val_tn: 72867.0000 - val_fn: 7133.0000 - val_accuracy: 0.8573 - val_precision: 0.6434 - val_recall: 0.6434 - val_auc: 0.7771
[INFO] saving weights to checkpoints/lstm-epoch-6-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4360 - tp: 67126.0000 - fp: 12874.0000 - tn: 307126.0000 - fn: 12874.0000 - accuracy: 0.9356 - precision: 0.8391 - recall: 0.8391 - auc: 0.9818 - val_loss: 1.9179 - val_tp: 13241.0000 - val_fp: 6759.0000 - val_tn: 73241.0000 - val_fn: 6759.0000 - val_accuracy: 0.8648 - val_precision: 0.6621 - val_recall: 0.6621 - val_auc: 0.8508
[INFO] saving weights to checkpoints/lstm-epoch-6-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1293 - tp: 77925.0000 - fp: 2075.0000 - tn: 317925.0000 - fn: 2075.0000 - accuracy: 0.9896 - precision: 0.9741 - recall: 0.9741 - auc: 0.9948 - val_loss: 0.0033 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 13-13/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99661%,31:0.00068%,30:0.00051%,26:0.00051%,0:0.00051%,22:0.00034%,27:0.00017%,24:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:87.01651%,Single Stage Single Point:12.98349%]
[INFO] ** dst:[21:43.35766%,10:20.80908%,8:18.2729%,9:17.55646%,22:0.00102%,6:0.00085%,18:0.00068%,25:0.00051%,15:0.00051%,24:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99949%,3:0.00051%]
[INFO] ** modbus_function_code:[0.02961:99.99661%,-33.760870000000004:0.00322%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99881%,11:49.99779%,0:0.00322%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99728%,2:0.00221%,1:0.00051%]
[INFO] ** proxy_src_ip:[18:38.05433%,20:26.11274%,13:18.27307%,6:17.55596%,10:0.00102%,11:0.00085%,17:0.00051%,16:0.00051%,7:0.00034%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.11223%,-0.32151:20.80908%,-1.27613:18.27273%,-0.23351:17.55562%,-0.33484:17.24525%,-9.78512:0.00068%,-64.19493:0.00051%,-1.02014:0.00051%,-71.14798:0.00051%,-71.33197:0.00051%,-0.24151:0.00034%,-71.14931:0.00034%,-0.08551:0.00034%,1.47576:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-1.2708:0.00017%,-68.79874000000001:0.00017%,6.1115699999999995:0.00017%,14.540560000000001:0.00017%,1.45709:0.00017%]
[INFO] ** scada_tag:[3:26.11189%,1:20.80891%,5:18.27273%,4:17.55562%,2:17.24508%,0:0.00577%]
[INFO] ** service:[0.0048200000000000005:99.99728%,-186.43601999999998:0.00068%,-211.08346:0.00051%,-186.44547:0.00051%,-211.73542999999998:0.00051%,-211.08818:0.00034%,-202.75898:0.00017%]
[INFO] ** src:[22:38.05433%,9:26.11274%,7:18.27307%,1:17.55596%,11:0.00102%,10:0.00085%,15:0.00051%,14:0.00051%,21:0.00034%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99966%,2:0.00017%,1:0.00017%]
[INFO] ** unixtime:1610 (0.2732%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0097 - tp: 79981.0000 - fp: 19.0000 - tn: 319981.0000 - fn: 19.0000 - accuracy: 0.9999 - precision: 0.9998 - recall: 0.9998 - auc: 1.0000 - val_loss: 8.3900e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0084 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3450e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0068 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1245e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1204 - tp: 78410.0000 - fp: 1590.0000 - tn: 318410.0000 - fn: 1590.0000 - accuracy: 0.9920 - precision: 0.9801 - recall: 0.9801 - auc: 0.9959 - val_loss: 0.9509 - val_tp: 12841.0000 - val_fp: 7159.0000 - val_tn: 72841.0000 - val_fn: 7159.0000 - val_accuracy: 0.8568 - val_precision: 0.6421 - val_recall: 0.6421 - val_auc: 0.9664
[INFO] saving weights to checkpoints/lstm-epoch-6-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2440 - tp: 68108.0000 - fp: 11892.0000 - tn: 308108.0000 - fn: 11892.0000 - accuracy: 0.9405 - precision: 0.8514 - recall: 0.8514 - auc: 0.9921 - val_loss: 0.0054 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 14-14/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99898%,31:0.00034%,30:0.00034%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:91.61613%,Single Stage Single Point:8.38387%]
[INFO] ** dst:[21:43.35341%,10:20.80518%,8:18.26848%,9:17.57089%,22:0.00068%,24:0.00034%,18:0.00034%,15:0.00034%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.99966%,3:0.00034%]
[INFO] ** modbus_function_code:[0.02961:99.99898%,-33.760870000000004:0.00102%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99881%,0:0.00102%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99915%,2:0.00051%,1:0.00034%]
[INFO] ** proxy_src_ip:[18:38.04297%,20:26.11614%,13:18.26865%,6:17.57106%,17:0.00034%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.11546%,-0.32151:20.80518%,-1.27613:18.26814%,-0.23351:17.57072%,-0.33484:17.23779%,-1.27347:0.00034%,-0.08551:0.00034%,-71.33197:0.00034%,1.45709:0.00034%,1.47576:0.00017%,1.46509:0.00017%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,-0.24950999999999998:0.00017%,14.4699:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.11512%,1:20.80518%,5:18.26797%,4:17.57038%,2:17.23762%,0:0.00373%]
[INFO] ** service:[0.0048200000000000005:99.99898%,-211.73542999999998:0.00034%,-186.43601999999998:0.00034%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.04297%,9:26.11614%,7:18.26865%,1:17.57106%,14:0.00034%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1610 (0.2732%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0309 - tp: 78764.0000 - fp: 1236.0000 - tn: 318764.0000 - fn: 1236.0000 - accuracy: 0.9938 - precision: 0.9845 - recall: 0.9845 - auc: 0.9998 - val_loss: 0.0013 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3127 - tp: 66013.0000 - fp: 13987.0000 - tn: 306013.0000 - fn: 13987.0000 - accuracy: 0.9301 - precision: 0.8252 - recall: 0.8252 - auc: 0.9818 - val_loss: 0.1906 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0951 - tp: 79778.0000 - fp: 222.0000 - tn: 319778.0000 - fn: 222.0000 - accuracy: 0.9989 - precision: 0.9972 - recall: 0.9972 - auc: 1.0000 - val_loss: 0.0443 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0191 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7012e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0075 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9216e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 15-15/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99644%,30:0.00288%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:90.62802%,Single Stage Multi Point:9.3713%,Single Stage Single Point:0.00068%]
[INFO] ** dst:[21:43.30285%,10:20.78363%,8:18.31023%,9:17.59821%,15:0.00288%,22:0.00153%,25:0.00017%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99728%,0:0.00272%]
[INFO] ** i/f_name:[2:99.99712%,3:0.00288%]
[INFO] ** modbus_function_code:[0.02961:99.99644%,-33.760870000000004:0.00356%]
[INFO] ** modbus_function_description:[7:49.99915%,11:49.99728%,0:0.00356%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99745%,2:0.00255%]
[INFO] ** proto:[0:99.99678%,1:0.00288%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.01972%,20:26.06743%,13:18.30989%,6:17.59872%,17:0.00288%,16:0.00068%,7:0.00034%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.06659%,-0.32151:20.78346%,-1.27613:18.30972%,-0.23351:17.59804%,-0.33484:17.23626%,-71.33197:0.00288%,-1.02014:0.00068%,-0.24151:0.00051%,1.46509:0.00034%,1.45709:0.00034%,1.47576:0.00017%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,-61.95768:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.06625%,1:20.78329%,5:18.30972%,4:17.5977%,2:17.23592%,0:0.00713%]
[INFO] ** service:[0.0048200000000000005:99.99661%,-211.73542999999998:0.00288%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.01972%,9:26.06743%,7:18.30989%,1:17.59872%,21:0.00288%,15:0.00068%,14:0.00034%,16:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1618 (0.27456%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0059 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.1236e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0058 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4774e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0055 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.6335e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0048 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1537e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8255 - tp: 75925.0000 - fp: 4075.0000 - tn: 315925.0000 - fn: 4075.0000 - accuracy: 0.9796 - precision: 0.9491 - recall: 0.9491 - auc: 0.9679 - val_loss: 7.5368 - val_tp: 10648.0000 - val_fp: 9352.0000 - val_tn: 70648.0000 - val_fn: 9352.0000 - val_accuracy: 0.8130 - val_precision: 0.5324 - val_recall: 0.5324 - val_auc: 0.7077
[INFO] saving weights to checkpoints/lstm-epoch-6-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 16-16/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529000, 17)

[INFO] analyzing data
[INFO] 529000 rows
[INFO] ** appi_name:[21:99.99792%,30:0.0017%,33:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:79.14783%,Single Stage Multi Point:20.85217%]
[INFO] ** dst:[21:43.33724%,10:20.79565%,8:18.26749%,9:17.59641%,15:0.0017%,22:0.00113%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.9983%,0:0.0017%]
[INFO] ** i/f_name:[2:99.9983%,3:0.0017%]
[INFO] ** modbus_function_code:[0.02961:99.99792%,-33.760870000000004:0.00208%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99792%,0:0.00208%]
[INFO] ** modbus_transaction_id:65536 (12.38866%)
[INFO] ** orig:[0:99.9983%,2:0.0017%]
[INFO] ** proto:[0:99.99811%,1:0.0017%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.04121%,20:26.09187%,13:18.26786%,6:17.5966%,17:0.0017%,16:0.00038%,21:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.0913%,-0.32151:20.79546%,-1.27613:18.26749%,-0.23351:17.59622%,-0.33484:17.24575%,-71.33197:0.0017%,1.45709:0.00038%,-0.24151:0.00038%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,-49.275529999999996:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.09093%,1:20.79527%,5:18.2673%,4:17.59584%,2:17.24556%,0:0.0051%]
[INFO] ** service:[0.0048200000000000005:99.99811%,-211.73542999999998:0.0017%,-211.08346:0.00019%]
[INFO] ** src:[22:38.04121%,9:26.09187%,7:18.26786%,1:17.5966%,21:0.00189%,15:0.00038%,4:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1449 (0.27391%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5418 - tp: 42579.0000 - fp: 37421.0000 - tn: 282579.0000 - fn: 37421.0000 - accuracy: 0.8129 - precision: 0.5322 - recall: 0.5322 - auc: 0.7057 - val_loss: 7.5884 - val_tp: 10584.0000 - val_fp: 9416.0000 - val_tn: 70584.0000 - val_fn: 9416.0000 - val_accuracy: 0.8117 - val_precision: 0.5292 - val_recall: 0.5292 - val_auc: 0.7058
[INFO] saving weights to checkpoints/lstm-epoch-6-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5508 - tp: 42534.0000 - fp: 37466.0000 - tn: 282534.0000 - fn: 37466.0000 - accuracy: 0.8127 - precision: 0.5317 - recall: 0.5317 - auc: 0.7053 - val_loss: 7.5586 - val_tp: 10621.0000 - val_fp: 9379.0000 - val_tn: 70621.0000 - val_fn: 9379.0000 - val_accuracy: 0.8124 - val_precision: 0.5311 - val_recall: 0.5311 - val_auc: 0.7069
[INFO] saving weights to checkpoints/lstm-epoch-6-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.3530 - tp: 63374.0000 - fp: 16626.0000 - tn: 303374.0000 - fn: 16626.0000 - accuracy: 0.9169 - precision: 0.7922 - recall: 0.7922 - auc: 0.8693 - val_loss: 1.5814e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0037 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4518e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0033 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0607e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-15-16-batch-400000-500000
[INFO] processing batch 500000-600000/529000
[33m[INFO] loading file 17-17/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529000, 17)

[INFO] analyzing data
[INFO] 529000 rows
[INFO] ** appi_name:[21:99.99716%,7:0.00057%,26:0.00038%,0:0.00038%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:94.16824%,Multi Stage Multi Point:5.83176%]
[INFO] ** dst:[21:43.34556%,10:20.84934%,8:18.20359%,9:17.59849%,22:0.00076%,6:0.00057%,25:0.00038%,16:0.00038%,2:0.00038%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99716%,-33.760870000000004:0.00265%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99754%,0:0.00265%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.38866%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99868%,2:0.00132%]
[INFO] ** proxy_src_ip:[18:38.08299%,20:26.11267%,13:18.20302%,6:17.5983%,10:0.00113%,11:0.00095%,1:0.00038%,16:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.11172%,-0.32151:20.84934%,-1.27613:18.20265%,-0.23351:17.59811%,-0.33484:17.23365%,6.0369:0.00076%,-71.14798:0.00038%,1.47576:0.00038%,-64.19493:0.00038%,1.45709:0.00038%,1.46509:0.00019%,-68.79874000000001:0.00019%,-1.27347:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,6.15557:0.00019%,6.06224:0.00019%,8.55414:0.00019%,-3.3787199999999995:0.00019%,-4.3880099999999995:0.00019%,-71.14931:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:26.11153%,1:20.84915%,5:18.20246%,4:17.59773%,2:17.23365%,0:0.00548%]
[INFO] ** service:[0.0048200000000000005:99.99792%,-211.09762999999998:0.00057%,-211.08346:0.00038%,-186.44547:0.00038%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.08299%,9:26.11267%,7:18.20302%,1:17.5983%,11:0.00113%,10:0.00095%,3:0.00038%,21:0.00019%,15:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1446 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0030 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2154e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0029 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2041e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0026 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1935e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.6928 - tp: 66644.0000 - fp: 13356.0000 - tn: 306644.0000 - fn: 13356.0000 - accuracy: 0.9332 - precision: 0.8331 - recall: 0.8331 - auc: 0.8950 - val_loss: 2.9005 - val_tp: 16401.0000 - val_fp: 3599.0000 - val_tn: 76401.0000 - val_fn: 3599.0000 - val_accuracy: 0.9280 - val_precision: 0.8201 - val_recall: 0.8201 - val_auc: 0.8875
[INFO] saving weights to checkpoints/lstm-epoch-6-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.8013 - tp: 66105.0000 - fp: 13895.0000 - tn: 306105.0000 - fn: 13895.0000 - accuracy: 0.9305 - precision: 0.8263 - recall: 0.8263 - auc: 0.8908 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/529000
[33m[INFO] loading file 18-18/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529000, 17)

[INFO] analyzing data
[INFO] 529000 rows
[INFO] ** appi_name:[21:99.99811%,30:0.00057%,7:0.00057%,31:0.00019%,27:0.00019%,22:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:81.66389%,Multi Stage Multi Point:18.33611%]
[INFO] ** dst:[21:43.33894%,10:20.83251%,8:18.26578%,9:17.55974%,22:0.00076%,15:0.00057%,24:0.00038%,16:0.00038%,2:0.00038%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99943%,0:0.00057%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99811%,-33.760870000000004:0.00189%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99811%,0:0.00189%]
[INFO] ** modbus_transaction_id:65536 (12.38866%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99887%,2:0.00057%,1:0.00057%]
[INFO] ** proxy_src_ip:[18:38.07524%,20:26.09679%,13:18.26616%,6:17.55992%,17:0.00057%,11:0.00057%,1:0.00038%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.09603%,-0.32151:20.83251%,-1.27613:18.2656%,-0.23351:17.55955%,-0.33484:17.24272%,-71.33197:0.00057%,-1.27347:0.00038%,1.45709:0.00038%,-0.24151:0.00038%,1.47576:0.00019%,1.46509:0.00019%,3.6236699999999997:0.00019%,-1.2708:0.00019%,-2.48275:0.00019%,6.06224:0.00019%,-3.3787199999999995:0.00019%,8.10082:0.00019%,6.45955:0.00019%,-71.14931:0.00019%]
[INFO] ** scada_tag:[3:26.09565%,1:20.83233%,5:18.26541%,4:17.55936%,2:17.24253%,0:0.00473%]
[INFO] ** service:[0.0048200000000000005:99.99811%,-211.09762999999998:0.00057%,-211.73542999999998:0.00057%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.07524%,9:26.09679%,7:18.26616%,1:17.55992%,14:0.00057%,10:0.00057%,3:0.00038%,21:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1446 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.4091 - tp: 68051.0000 - fp: 11949.0000 - tn: 308051.0000 - fn: 11949.0000 - accuracy: 0.9403 - precision: 0.8506 - recall: 0.8506 - auc: 0.9061 - val_loss: 6.1208 - val_tp: 12405.0000 - val_fp: 7595.0000 - val_tn: 72405.0000 - val_fn: 7595.0000 - val_accuracy: 0.8481 - val_precision: 0.6202 - val_recall: 0.6202 - val_auc: 0.7627
[INFO] saving weights to checkpoints/lstm-epoch-6-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1145 - tp: 49657.0000 - fp: 30343.0000 - tn: 289657.0000 - fn: 30343.0000 - accuracy: 0.8483 - precision: 0.6207 - recall: 0.6207 - auc: 0.7614 - val_loss: 6.1636 - val_tp: 12352.0000 - val_fp: 7648.0000 - val_tn: 72352.0000 - val_fn: 7648.0000 - val_accuracy: 0.8470 - val_precision: 0.6176 - val_recall: 0.6176 - val_auc: 0.7610
[INFO] saving weights to checkpoints/lstm-epoch-6-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1374 - tp: 49543.0000 - fp: 30457.0000 - tn: 289543.0000 - fn: 30457.0000 - accuracy: 0.8477 - precision: 0.6193 - recall: 0.6193 - auc: 0.7606 - val_loss: 6.1136 - val_tp: 12414.0000 - val_fp: 7586.0000 - val_tn: 72414.0000 - val_fn: 7586.0000 - val_accuracy: 0.8483 - val_precision: 0.6207 - val_recall: 0.6207 - val_auc: 0.7629
[INFO] saving weights to checkpoints/lstm-epoch-6-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2876 - tp: 78580.0000 - fp: 1420.0000 - tn: 318580.0000 - fn: 1420.0000 - accuracy: 0.9929 - precision: 0.9822 - recall: 0.9822 - auc: 0.9888 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0014 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/529000
[33m[INFO] loading file 19-19/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529000, 17)

[INFO] analyzing data
[INFO] 529000 rows
[INFO] ** appi_name:[21:99.99792%,26:0.00038%,0:0.00038%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:86.47259%,Single Stage Multi Point:13.52741%]
[INFO] ** dst:[21:43.3811%,10:20.8259%,8:18.21739%,9:17.57278%,22:0.00132%,6:0.00057%,25:0.00038%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99792%,-33.760870000000004:0.00189%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99773%,0:0.00189%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.38866%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99868%,2:0.00132%]
[INFO] ** proxy_src_ip:[18:38.11304%,20:26.09414%,13:18.21739%,6:17.57278%,10:0.00113%,11:0.00095%,16:0.00057%]
[INFO] ** s_port:[1.45442:26.09301%,-0.32151:20.8259%,-1.27613:18.21701%,-0.23351:17.57259%,-0.33484:17.28715%,-5.20264:0.00076%,1.45709:0.00057%,-1.02014:0.00057%,-64.19493:0.00038%,-71.14798:0.00038%,1.46509:0.00038%,-1.27347:0.00019%,-0.24151:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-71.14931:0.00019%,-68.79874000000001:0.00019%,0.75578:0.00019%]
[INFO] ** scada_tag:[3:26.09263%,1:20.82571%,5:18.21682%,4:17.5724%,2:17.28696%,0:0.00548%]
[INFO] ** service:[0.0048200000000000005:99.99868%,-211.08346:0.00038%,-186.44547:0.00038%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.11304%,9:26.09414%,7:18.21739%,1:17.57278%,11:0.00113%,10:0.00095%,15:0.00057%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1447 (0.27353%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0011 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0010 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.2246e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.4568 - tp: 62846.0000 - fp: 17154.0000 - tn: 302846.0000 - fn: 17154.0000 - accuracy: 0.9142 - precision: 0.7856 - recall: 0.7856 - auc: 0.8651 - val_loss: 9.8095 - val_tp: 7828.0000 - val_fp: 12172.0000 - val_tn: 67828.0000 - val_fn: 12172.0000 - val_accuracy: 0.7566 - val_precision: 0.3914 - val_recall: 0.3914 - val_auc: 0.6196
[INFO] saving weights to checkpoints/lstm-epoch-6-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.5095 - tp: 37766.0000 - fp: 42234.0000 - tn: 277766.0000 - fn: 42234.0000 - accuracy: 0.7888 - precision: 0.4721 - recall: 0.4721 - auc: 0.6680 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/529000
[33m[INFO] loading file 20-20/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529000, 17)

[INFO] analyzing data
[INFO] 529000 rows
[INFO] ** appi_name:[21:99.99641%,30:0.00302%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:92.2535%,Single Stage Multi Point:7.7465%]
[INFO] ** dst:[21:43.42476%,10:20.83913%,8:18.16616%,9:17.56484%,15:0.00302%,22:0.00113%,24:0.00038%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99735%,0:0.00265%]
[INFO] ** i/f_name:[2:99.99698%,3:0.00302%]
[INFO] ** modbus_function_code:[0.02961:99.99641%,-33.760870000000004:0.00359%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99679%,0:0.00359%]
[INFO] ** modbus_transaction_id:65536 (12.38866%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99641%,1:0.00302%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.11739%,20:26.14707%,13:18.16635%,6:17.56541%,17:0.00302%,14:0.00057%,16:0.00019%]
[INFO] ** s_port:[1.45442:26.14631%,-0.32151:20.83913%,-1.27613:18.16578%,-0.23351:17.56465%,-0.33484:17.27826%,-71.33197:0.00302%,-0.24151:0.00057%,1.45709:0.00038%,-1.27347:0.00038%,13.431270000000001:0.00019%,-1.2708:0.00019%,-1.02014:0.00019%,-71.14798:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,11.862:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:26.14594%,1:20.83894%,5:18.16578%,4:17.56427%,2:17.27807%,0:0.00699%]
[INFO] ** service:[0.0048200000000000005:99.99641%,-211.73542999999998:0.00302%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.11739%,9:26.14707%,7:18.16635%,1:17.56541%,14:0.00302%,2:0.00057%,15:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1446 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.8593e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9559 - val_tp: 17573.0000 - val_fp: 2427.0000 - val_tn: 77573.0000 - val_fn: 2427.0000 - val_accuracy: 0.9515 - val_precision: 0.8787 - val_recall: 0.8787 - val_auc: 0.9242
[INFO] saving weights to checkpoints/lstm-epoch-6-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9447 - tp: 65387.0000 - fp: 14613.0000 - tn: 305387.0000 - fn: 14613.0000 - accuracy: 0.9269 - precision: 0.8173 - recall: 0.8173 - auc: 0.8851 - val_loss: 2.9327 - val_tp: 16361.0000 - val_fp: 3639.0000 - val_tn: 76361.0000 - val_fn: 3639.0000 - val_accuracy: 0.9272 - val_precision: 0.8181 - val_recall: 0.8181 - val_auc: 0.8863
[INFO] saving weights to checkpoints/lstm-epoch-6-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9499 - tp: 65361.0000 - fp: 14639.0000 - tn: 305361.0000 - fn: 14639.0000 - accuracy: 0.9268 - precision: 0.8170 - recall: 0.8170 - auc: 0.8850 - val_loss: 2.9222 - val_tp: 16374.0000 - val_fp: 3626.0000 - val_tn: 76374.0000 - val_fn: 3626.0000 - val_accuracy: 0.9275 - val_precision: 0.8187 - val_recall: 0.8187 - val_auc: 0.8867
[INFO] saving weights to checkpoints/lstm-epoch-6-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4105 - tp: 77965.0000 - fp: 2035.0000 - tn: 317965.0000 - fn: 2035.0000 - accuracy: 0.9898 - precision: 0.9746 - recall: 0.9746 - auc: 0.9840 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.3479e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4143e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/529000
[33m[INFO] loading file 21-21/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528998, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528998, 17)

[INFO] analyzing data
[INFO] 528998 rows
[INFO] ** appi_name:[21:99.99622%,30:0.00076%,7:0.00057%,26:0.00038%,22:0.00038%,0:0.00038%,31:0.00019%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:98.84631%,Multi Stage Single Point:1.15369%]
[INFO] ** dst:[21:43.30489%,10:20.99403%,8:18.16963%,9:17.5271%,22:0.00095%,15:0.00076%,6:0.00076%,25:0.00038%,24:0.00038%,16:0.00038%,2:0.00038%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99924%,0:0.00076%]
[INFO] ** i/f_name:[2:99.99924%,3:0.00076%]
[INFO] ** modbus_function_code:[0.02961:99.99622%,-33.760870000000004:0.00359%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99868%,11:49.99754%,0:0.00359%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.3887%)
[INFO] ** orig:[0:99.99924%,2:0.00076%]
[INFO] ** proto:[0:99.99773%,2:0.00151%,1:0.00076%]
[INFO] ** proxy_src_ip:[18:38.32529%,20:25.97344%,13:18.16982%,6:17.5271%,10:0.00113%,11:0.00095%,17:0.00076%,16:0.00057%,1:0.00038%,21:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.97288%,-0.32151:20.99327%,-1.27613:18.16944%,-0.23351:17.52691%,-0.33484:17.33201%,-71.33197:0.00076%,-6.64392:0.00076%,-1.02014:0.00057%,-1.27347:0.00038%,-64.19493:0.00038%,-71.14931:0.00038%,-71.14798:0.00038%,1.47576:0.00019%,1.46509:0.00019%,6.62488:0.00019%,10.15141:0.00019%,-68.79874000000001:0.00019%,7.060860000000001:0.00019%,-3.3787199999999995:0.00019%,-2.2440900000000004:0.00019%,1.45709:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.9725%,1:20.99309%,5:18.16926%,4:17.52672%,2:17.33201%,0:0.00643%]
[INFO] ** service:[0.0048200000000000005:99.99698%,-211.73542999999998:0.00076%,-211.09762999999998:0.00057%,-211.08346:0.00038%,-186.44547:0.00038%,-211.08818:0.00038%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.32529%,9:25.97344%,7:18.16982%,1:17.5271%,11:0.00113%,21:0.00095%,10:0.00095%,15:0.00057%,3:0.00038%,4:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1440 (0.27221%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528998
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.7412e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/528998
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.2948e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8350e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/528998
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.8997e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/528998
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.6645e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/528998
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.2948e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2054e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/528998
[33m[INFO] loading file 22-22/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (298039, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (298039, 17)

[INFO] analyzing data
[INFO] 298039 rows
[INFO] ** appi_name:[21:99.99228%,30:0.00671%,23:0.00034%,22:0.00034%,18:0.00034%]
[INFO] ** classification:[normal:55.52528%,Multi Stage Single Point:44.47472%]
[INFO] ** dst:[21:43.3044%,10:21.00094%,8:18.11307%,9:17.57253%,15:0.00671%,22:0.00134%,19:0.00067%,26:0.00034%]
[INFO] ** i/f_dir:[1:99.99362%,0:0.00638%]
[INFO] ** i/f_name:[2:99.99329%,3:0.00638%,0:0.00034%]
[INFO] ** modbus_function_code:[0.02961:99.99228%,-33.760870000000004:0.00772%]
[INFO] ** modbus_function_description:[7:49.99715%,11:49.99513%,0:0.00772%]
[INFO] ** modbus_transaction_id:65534 (21.9884%)
[INFO] ** orig:[0:99.99497%,2:0.00436%,1:0.00067%]
[INFO] ** proto:[0:99.99295%,1:0.00671%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.32653%,20:25.97982%,13:18.11239%,6:17.57354%,17:0.00671%,14:0.00067%,10:0.00034%]
[INFO] ** s_port:[1.45442:25.97881%,-0.32151:21.00094%,-1.27613:18.11239%,-0.23351:17.57253%,-0.33484:17.32558%,-71.33197:0.00671%,1.45709:0.00067%,-0.24151:0.00067%,7.228860000000001:0.00067%,-0.24950999999999998:0.00034%,1.46509:0.00034%,-71.14931:0.00034%]
[INFO] ** scada_tag:[3:25.97848%,1:21.00094%,5:18.11239%,4:17.5722%,2:17.32558%,0:0.0104%]
[INFO] ** service:[0.0048200000000000005:99.99228%,-211.73542999999998:0.00671%,-211.07873999999998:0.00067%,-211.08818:0.00034%]
[INFO] ** src:[22:38.32653%,9:25.97982%,7:18.11239%,1:17.57354%,21:0.00436%,14:0.00235%,2:0.00067%,11:0.00034%]
[INFO] ** type:[0:99.99799%,1:0.00201%]
[INFO] ** unixtime:823 (0.27614%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/298039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.0515 - tp: 49965.0000 - fp: 30035.0000 - tn: 289965.0000 - fn: 30035.0000 - accuracy: 0.8498 - precision: 0.6246 - recall: 0.6246 - auc: 0.7639 - val_loss: 7.5473 - val_tp: 10635.0000 - val_fp: 9365.0000 - val_tn: 70635.0000 - val_fn: 9365.0000 - val_accuracy: 0.8127 - val_precision: 0.5318 - val_recall: 0.5318 - val_auc: 0.7073
[INFO] saving weights to checkpoints/lstm-epoch-6-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/298039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5861 - tp: 42348.0000 - fp: 37652.0000 - tn: 282348.0000 - fn: 37652.0000 - accuracy: 0.8117 - precision: 0.5293 - recall: 0.5293 - auc: 0.7040 - val_loss: 7.6061 - val_tp: 10562.0000 - val_fp: 9438.0000 - val_tn: 70562.0000 - val_fn: 9438.0000 - val_accuracy: 0.8112 - val_precision: 0.5281 - val_recall: 0.5281 - val_auc: 0.7051
[INFO] saving weights to checkpoints/lstm-epoch-6-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/298039
[33m[INFO] loading file 23-23/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598039, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598039, 17)

[INFO] analyzing data
[INFO] 598039 rows
[INFO] ** appi_name:[21:99.99816%,30:0.00117%,31:0.00033%,33:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:90.78706%,Multi Stage Single Point:9.21294%]
[INFO] ** dst:[21:43.32443%,10:21.00749%,8:18.1326%,9:17.53247%,15:0.00117%,22:0.001%,24:0.00033%,18:0.00033%,25:0.00017%]
[INFO] ** i/f_dir:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name:[2:99.99883%,3:0.00117%]
[INFO] ** modbus_function_code:[0.02961:99.99816%,-33.760870000000004:0.00184%]
[INFO] ** modbus_function_description:[7:50.00008%,11:49.99808%,0:0.00184%]
[INFO] ** modbus_transaction_id:65536 (10.95848%)
[INFO] ** orig:[0:99.99933%,2:0.00067%]
[INFO] ** proto:[0:99.99833%,1:0.00117%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.34967%,20:25.98275%,13:18.1326%,6:17.53264%,17:0.00117%,16:0.0005%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.98192%,-0.32151:21.00733%,-1.27613:18.1321%,-0.23351:17.5323%,-0.33484:17.34235%,-71.33197:0.00117%,-1.02014:0.0005%,-0.08551:0.00033%,-1.27347:0.00033%,1.45709:0.00033%,1.46509:0.00033%,-0.24151:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.98158%,1:21.00733%,5:18.13193%,4:17.53213%,2:17.34218%,0:0.00485%]
[INFO] ** service:[0.0048200000000000005:99.99833%,-211.73542999999998:0.00117%,-186.43601999999998:0.00033%,-186.44547:0.00017%]
[INFO] ** src:[22:38.34967%,9:25.98275%,7:18.1326%,1:17.53264%,21:0.00067%,15:0.0005%,14:0.0005%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99967%,1:0.00033%]
[INFO] ** unixtime:1629 (0.27239%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5804 - tp: 42376.0000 - fp: 37624.0000 - tn: 282376.0000 - fn: 37624.0000 - accuracy: 0.8119 - precision: 0.5297 - recall: 0.5297 - auc: 0.7043 - val_loss: 7.5400 - val_tp: 10644.0000 - val_fp: 9356.0000 - val_tn: 70644.0000 - val_fn: 9356.0000 - val_accuracy: 0.8129 - val_precision: 0.5322 - val_recall: 0.5322 - val_auc: 0.7076
[INFO] saving weights to checkpoints/lstm-epoch-6-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.6355 - tp: 71883.0000 - fp: 8117.0000 - tn: 311883.0000 - fn: 8117.0000 - accuracy: 0.9594 - precision: 0.8985 - recall: 0.8985 - auc: 0.9364 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4023e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2403e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2260e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0408e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/598039
[33m[INFO] loading file 24-24/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598039, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598039, 17)

[INFO] analyzing data
[INFO] 598039 rows
[INFO] ** appi_name:[21:99.99381%,30:0.00301%,26:0.0005%,31:0.00033%,27:0.00033%,22:0.00033%,0:0.00033%,24:0.00017%,23:0.00017%,19:0.00017%,18:0.00017%,16:0.00017%,15:0.00017%,11:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:95.73941%,Multi Stage Single Point:4.26059%]
[INFO] ** dst:[21:43.3669%,10:21.00749%,8:18.10267%,9:17.51625%,15:0.00301%,22:0.00117%,6:0.00067%,25:0.00033%,24:0.00033%,19:0.00033%,18:0.00033%,7:0.00033%,26:0.00017%]
[INFO] ** i/f_dir:[1:99.99716%,0:0.00284%]
[INFO] ** i/f_name:[2:99.99699%,3:0.00301%]
[INFO] ** modbus_function_code:[0.02961:99.99381%,-33.760870000000004:0.00569%,-0.415:0.00017%,0.9188299999999999:0.00017%,0.47422:0.00017%]
[INFO] ** modbus_function_description:[7:49.99808%,11:49.99574%,0:0.00569%,15:0.00017%,10:0.00017%,2:0.00017%]
[INFO] ** modbus_transaction_id:65536 (10.95848%)
[INFO] ** orig:[0:99.99967%,1:0.00033%]
[INFO] ** proto:[0:99.99515%,1:0.00301%,2:0.00184%]
[INFO] ** proxy_src_ip:[18:38.38111%,20:25.99429%,13:18.1025%,6:17.51558%,17:0.00301%,10:0.00117%,14:0.00084%,11:0.00084%,21:0.00033%,16:0.00033%]
[INFO] ** s_port:[1.45442:25.99329%,-0.32151:21.00749%,-1.27613:18.10216%,-0.23351:17.51491%,-0.33484:17.37362%,-71.33197:0.00301%,-9.58113:0.00067%,-71.14798:0.0005%,1.45709:0.0005%,-0.24950999999999998:0.00033%,-1.27347:0.00033%,-0.24151:0.00033%,-1.02014:0.00033%,-31.55091:0.00033%,7.6315100000000005:0.00033%,-71.14931:0.00033%,-64.19493:0.00033%,1.47576:0.00033%,-68.79874000000001:0.00017%,1.46509:0.00017%,7.4901800000000005:0.00017%,13.431270000000001:0.00017%,11.862:0.00017%]
[INFO] ** scada_tag:[3:25.99295%,1:21.00749%,5:18.102%,4:17.51441%,2:17.37345%,0:0.0097%]
[INFO] ** service:[0.0048200000000000005:99.99482%,-211.73542999999998:0.00301%,-211.08346:0.0005%,-211.07873999999998:0.00033%,-202.75898:0.00033%,-186.44547:0.00033%,-186.43601999999998:0.00033%,-211.08818:0.00033%]
[INFO] ** src:[22:38.38111%,9:25.99429%,7:18.1025%,1:17.51558%,14:0.00301%,11:0.00117%,10:0.00084%,2:0.00084%,15:0.00033%,4:0.00033%]
[INFO] ** type:[0:99.99883%,1:0.00084%,2:0.00033%]
[INFO] ** unixtime:1625 (0.27172%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.2400e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.3770e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.9924e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.2713e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5123e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.4257e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6265e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/598039
[33m[INFO] loading file 25-25/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598039, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598039, 17)

[INFO] analyzing data
[INFO] 598039 rows
[INFO] ** appi_name:[21:99.99666%,30:0.001%,17:0.00067%,22:0.0005%,31:0.00033%,28:0.00017%,26:0.00017%,12:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** classification:[normal:65.92045%,Multi Stage Single Point:34.07955%]
[INFO] ** dst:[21:43.32945%,10:21.03224%,8:18.12524%,9:17.50906%,15:0.001%,22:0.00084%,16:0.00067%,6:0.00067%,18:0.00033%,17:0.00033%,24:0.00017%]
[INFO] ** i/f_dir:[1:99.999%,0:0.001%]
[INFO] ** i/f_name:[2:99.999%,3:0.001%]
[INFO] ** modbus_function_code:[0.02961:99.99666%,-33.760870000000004:0.00334%]
[INFO] ** modbus_function_description:[7:49.99908%,11:49.99758%,0:0.00334%]
[INFO] ** modbus_transaction_id:65536 (10.95848%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99799%,2:0.001%,1:0.001%]
[INFO] ** proxy_src_ip:[18:38.39816%,20:25.96352%,13:18.12524%,6:17.50939%,17:0.001%,1:0.00084%,21:0.00067%,16:0.00033%,14:0.00033%,7:0.00033%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.96302%,-0.32151:21.03191%,-1.27613:18.1249%,-0.23351:17.50889%,-0.33484:17.36626%,-71.33197:0.001%,-71.14931:0.0005%,-49.275529999999996:0.00033%,-0.24151:0.00033%,-1.02014:0.00033%,-58.032509999999995:0.00017%,-5.08665:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,2.52505:0.00017%,-71.14798:0.00017%,-58.035180000000004:0.00017%,-1.2708:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.96269%,1:21.03174%,5:18.12474%,4:17.50872%,2:17.36609%,0:0.00602%]
[INFO] ** service:[0.0048200000000000005:99.99699%,-211.73542999999998:0.001%,-205.44247:0.00067%,-211.08818:0.0005%,-186.43601999999998:0.00033%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%]
[INFO] ** src:[22:38.39816%,9:25.96352%,7:18.12524%,1:17.50939%,14:0.001%,3:0.00084%,4:0.00067%,21:0.00033%,15:0.00033%,2:0.00033%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1625 (0.27172%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.8394 - tp: 60944.0000 - fp: 19056.0000 - tn: 300944.0000 - fn: 19056.0000 - accuracy: 0.9047 - precision: 0.7618 - recall: 0.7618 - auc: 0.8511 - val_loss: 5.7421 - val_tp: 12875.0000 - val_fp: 7125.0000 - val_tn: 72875.0000 - val_fn: 7125.0000 - val_accuracy: 0.8575 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.7773
[INFO] saving weights to checkpoints/lstm-epoch-6-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7560 - tp: 51431.0000 - fp: 28569.0000 - tn: 291431.0000 - fn: 28569.0000 - accuracy: 0.8572 - precision: 0.6429 - recall: 0.6429 - auc: 0.7768 - val_loss: 5.7614 - val_tp: 12851.0000 - val_fp: 7149.0000 - val_tn: 72851.0000 - val_fn: 7149.0000 - val_accuracy: 0.8570 - val_precision: 0.6425 - val_recall: 0.6425 - val_auc: 0.7766
[INFO] saving weights to checkpoints/lstm-epoch-6-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7407 - tp: 51507.0000 - fp: 28493.0000 - tn: 291507.0000 - fn: 28493.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7774 - val_loss: 5.7896 - val_tp: 12816.0000 - val_fp: 7184.0000 - val_tn: 72816.0000 - val_fn: 7184.0000 - val_accuracy: 0.8563 - val_precision: 0.6408 - val_recall: 0.6408 - val_auc: 0.7755
[INFO] saving weights to checkpoints/lstm-epoch-6-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7435 - tp: 51493.0000 - fp: 28507.0000 - tn: 291493.0000 - fn: 28507.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.7773 - val_loss: 5.7227 - val_tp: 12899.0000 - val_fp: 7101.0000 - val_tn: 72899.0000 - val_fn: 7101.0000 - val_accuracy: 0.8580 - val_precision: 0.6449 - val_recall: 0.6449 - val_auc: 0.7781
[INFO] saving weights to checkpoints/lstm-epoch-6-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7568 - tp: 51427.0000 - fp: 28573.0000 - tn: 291427.0000 - fn: 28573.0000 - accuracy: 0.8571 - precision: 0.6428 - recall: 0.6428 - auc: 0.7768 - val_loss: 5.7227 - val_tp: 12899.0000 - val_fp: 7101.0000 - val_tn: 72899.0000 - val_fn: 7101.0000 - val_accuracy: 0.8580 - val_precision: 0.6449 - val_recall: 0.6449 - val_auc: 0.7781
[INFO] saving weights to checkpoints/lstm-epoch-6-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/598039
[33m[INFO] loading file 26-26/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598039, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598039, 17)

[INFO] analyzing data
[INFO] 598039 rows
[INFO] ** appi_name:[21:99.99833%,30:0.0005%,7:0.0005%,31:0.00017%,22:0.00017%,12:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:64.39329%,Single Stage Single Point:26.70595%,Multi Stage Single Point:8.90076%]
[INFO] ** dst:[21:43.30654%,10:21.08441%,8:18.12691%,9:17.47946%,22:0.00084%,15:0.0005%,24:0.00033%,16:0.00033%,2:0.00033%,18:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.9995%,0:0.0005%]
[INFO] ** i/f_name:[2:99.9995%,3:0.0005%]
[INFO] ** modbus_function_code:[0.02961:99.99833%,-33.760870000000004:0.00167%]
[INFO] ** modbus_function_description:[7:49.99975%,11:49.99858%,0:0.00167%]
[INFO] ** modbus_transaction_id:65536 (10.95848%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99916%,1:0.0005%,2:0.00033%]
[INFO] ** proxy_src_ip:[18:38.46054%,20:25.93058%,13:18.12725%,6:17.47963%,17:0.0005%,1:0.0005%,21:0.00033%,16:0.00033%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.93008%,-0.32151:21.08424%,-1.27613:18.12674%,-0.23351:17.47929%,-0.33484:17.37629%,-71.33197:0.0005%,-1.02014:0.00033%,-1.27347:0.00033%,-0.24151:0.00033%,-49.275529999999996:0.00017%,1.47576:0.00017%,1.45709:0.00017%,1.46509:0.00017%,-1.2708:0.00017%,14.191239999999999:0.00017%,2.52505:0.00017%,-3.3787199999999995:0.00017%,11.57001:0.00017%,-71.14931:0.00017%,7.66617:0.00017%]
[INFO] ** scada_tag:[3:25.92975%,1:21.08424%,5:18.12658%,4:17.47913%,2:17.37629%,0:0.00401%]
[INFO] ** service:[0.0048200000000000005:99.9985%,-211.09762999999998:0.0005%,-211.73542999999998:0.0005%,-211.35747999999998:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.46054%,9:25.93058%,7:18.12725%,1:17.47963%,14:0.0005%,3:0.0005%,15:0.00033%,4:0.00033%,21:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1623 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7419 - tp: 51501.0000 - fp: 28499.0000 - tn: 291501.0000 - fn: 28499.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7774 - val_loss: 5.7638 - val_tp: 12848.0000 - val_fp: 7152.0000 - val_tn: 72848.0000 - val_fn: 7152.0000 - val_accuracy: 0.8570 - val_precision: 0.6424 - val_recall: 0.6424 - val_auc: 0.7765
[INFO] saving weights to checkpoints/lstm-epoch-6-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.9450 - tp: 57239.0000 - fp: 22761.0000 - tn: 297239.0000 - fn: 22761.0000 - accuracy: 0.8862 - precision: 0.7155 - recall: 0.7155 - auc: 0.8299 - val_loss: 0.0073 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1229 - tp: 77921.0000 - fp: 2079.0000 - tn: 317921.0000 - fn: 2079.0000 - accuracy: 0.9896 - precision: 0.9740 - recall: 0.9740 - auc: 0.9895 - val_loss: 2.6510e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0600 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9973 - val_loss: 5.9904e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0593 - tp: 79081.0000 - fp: 919.0000 - tn: 319081.0000 - fn: 919.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9998 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/598039
[33m[INFO] loading file 27-27/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (538169, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (538169, 17)

[INFO] analyzing data
[INFO] 538169 rows
[INFO] ** appi_name:[21:99.99944%,30:0.00056%]
[INFO] ** classification:[normal:64.35283%,Single Stage Single Point:35.64717%]
[INFO] ** dst:[21:43.28399%,10:21.06717%,8:18.16994%,9:17.47741%,22:0.00074%,15:0.00056%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99944%,-33.760870000000004:0.00056%]
[INFO] ** modbus_function_description:[7:50.00028%,11:49.99916%,0:0.00056%]
[INFO] ** modbus_transaction_id:65536 (12.17759%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99944%,1:0.00056%]
[INFO] ** proxy_src_ip:[18:38.41953%,20:25.93219%,13:18.16976%,6:17.4776%,17:0.00056%,16:0.00037%]
[INFO] ** s_port:[1.45442:25.93163%,-0.32151:21.06717%,-1.27613:18.16957%,-0.23351:17.47722%,-0.33484:17.35236%,-71.33197:0.00056%,-1.02014:0.00037%,-1.27347:0.00019%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.93126%,1:21.06699%,5:18.16939%,4:17.47704%,2:17.35217%,0:0.00316%]
[INFO] ** service:[0.0048200000000000005:99.99944%,-211.73542999999998:0.00056%]
[INFO] ** src:[22:38.41953%,9:25.93219%,7:18.16976%,1:17.4776%,14:0.00056%,15:0.00037%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1461 (0.27148%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/538169
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0591 - tp: 79040.0000 - fp: 960.0000 - tn: 319040.0000 - fn: 960.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9998 - val_loss: 1.1964e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/538169
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0515 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1960e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/538169
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0484 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/538169
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0452 - tp: 79146.0000 - fp: 854.0000 - tn: 319146.0000 - fn: 854.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/538169
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0469 - tp: 79051.0000 - fp: 949.0000 - tn: 319051.0000 - fn: 949.0000 - accuracy: 0.9953 - precision: 0.9881 - recall: 0.9881 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-26-27-batch-400000-500000
[INFO] processing batch 500000-600000/538169
[33m[INFO] loading file 28-28/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (372085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (372085, 17)

[INFO] analyzing data
[INFO] 372085 rows
[INFO] ** appi_name:[21:99.99221%,30:0.00161%,17:0.00134%,22:0.00108%,7:0.00108%,31:0.00081%,26:0.00081%,28:0.00027%,27:0.00027%,8:0.00027%,0:0.00027%]
[INFO] ** classification:[normal:64.30654%,Single Stage Single Point:35.69346%]
[INFO] ** dst:[21:43.27775%,10:21.02073%,8:18.20821%,9:17.48498%,6:0.00215%,16:0.00188%,18:0.00134%,22:0.00054%,17:0.00054%,15:0.00054%,2:0.00054%,25:0.00027%,7:0.00027%,0:0.00027%]
[INFO] ** i/f_dir:[1:99.99946%,0:0.00054%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.99221%,-33.760870000000004:0.00779%]
[INFO] ** modbus_function_description:[11:49.9961%,7:49.9961%,0:0.00779%]
[INFO] ** modbus_transaction_id:65535 (17.61291%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99543%,2:0.00403%,1:0.00054%]
[INFO] ** proxy_src_ip:[18:38.3356%,20:25.96288%,13:18.20847%,6:17.48525%,1:0.00215%,17:0.00161%,14:0.00161%,7:0.00134%,21:0.00081%,0:0.00027%]
[INFO] ** s_port:[1.45442:25.96262%,-0.32151:21.02073%,-1.27613:18.20821%,-0.23351:17.48471%,-0.33484:17.31486%,-71.14798:0.00108%,-71.14931:0.00108%,-71.33197:0.00054%,-0.08551:0.00054%,-0.24151:0.00054%,7.66617:0.00027%,-58.035180000000004:0.00027%,-1.2708:0.00027%,-64.19493:0.00027%,-5.1466400000000005:0.00027%,13.431270000000001:0.00027%,11.57001:0.00027%,14.4699:0.00027%,1.47576:0.00027%,14.191239999999999:0.00027%,-5.08665:0.00027%,10.192739999999999:0.00027%,-3.3787199999999995:0.00027%,6.1115699999999995:0.00027%,2.05573:0.00027%,-43.76509:0.00027%,2.52505:0.00027%,11.862:0.00027%,-58.032509999999995:0.00027%]
[INFO] ** scada_tag:[3:25.96262%,1:21.02073%,5:18.20821%,4:17.48445%,2:17.31486%,0:0.00914%]
[INFO] ** service:[0.0048200000000000005:99.99221%,-205.44247:0.00134%,-186.43601999999998:0.00134%,-211.09762999999998:0.00108%,-211.08346:0.00108%,-211.08818:0.00108%,-211.73542999999998:0.00054%,-186.44547:0.00027%,-183.8612:0.00027%,-185.9872:0.00027%,-211.35747999999998:0.00027%,-202.75898:0.00027%]
[INFO] ** src:[22:38.3356%,9:25.96288%,7:18.20847%,1:17.48525%,3:0.00242%,2:0.00161%,21:0.00134%,4:0.00108%,14:0.00054%,8:0.00054%,17:0.00027%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1011 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/372085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0447 - tp: 79036.0000 - fp: 964.0000 - tn: 319036.0000 - fn: 964.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-6-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/372085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0370 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 0.0024 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-6-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/372085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0348 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/372085
[33m[INFO] loading file 29-29/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (572085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (572085, 17)

[INFO] analyzing data
[INFO] 572085 rows
[INFO] ** appi_name:[21:99.99878%,30:0.00052%,31:0.00017%,26:0.00017%,9:0.00017%,3:0.00017%]
[INFO] ** classification:[normal:64.38973%,Single Stage Single Point:35.61027%]
[INFO] ** dst:[21:43.32853%,10:21.05981%,8:18.14346%,9:17.46646%,22:0.00052%,15:0.00052%,24:0.00017%,18:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99965%,0:0.00035%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.99878%,-33.760870000000004:0.00122%]
[INFO] ** modbus_function_description:[7:49.99974%,11:49.99904%,0:0.00122%]
[INFO] ** modbus_transaction_id:65536 (11.45564%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99913%,1:0.00052%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.43502%,20:25.95349%,13:18.14381%,6:17.46629%,17:0.00052%,21:0.00017%,16:0.00017%,7:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95296%,-0.32151:21.05963%,-1.27613:18.14346%,-0.23351:17.46629%,-0.33484:17.37539%,-71.33197:0.00052%,1.45709:0.00035%,-71.14798:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,6.1115699999999995:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:25.95261%,1:21.05946%,5:18.14346%,4:17.46594%,2:17.37539%,0:0.00315%]
[INFO] ** service:[0.0048200000000000005:99.99895%,-211.73542999999998:0.00052%,-183.8612:0.00017%,-211.08346:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.43502%,9:25.95349%,7:18.14381%,1:17.46629%,14:0.00052%,21:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1554 (0.27164%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0324 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0288 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0272 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0241 - tp: 79132.0000 - fp: 868.0000 - tn: 319132.0000 - fn: 868.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0218 - tp: 79167.0000 - fp: 833.0000 - tn: 319167.0000 - fn: 833.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/572085
[33m[INFO] loading file 30-30/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (572085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (572085, 17)

[INFO] analyzing data
[INFO] 572085 rows
[INFO] ** appi_name:[21:99.99755%,30:0.00175%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.36963%,Single Stage Single Point:35.63037%]
[INFO] ** dst:[21:43.33709%,10:21.02957%,8:18.14765%,9:17.48237%,15:0.00175%,22:0.0007%,24:0.00035%,25:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99843%,0:0.00157%]
[INFO] ** i/f_name:[2:99.99825%,3:0.00175%]
[INFO] ** modbus_function_code:[0.02961:99.99755%,-33.760870000000004:0.00245%]
[INFO] ** modbus_function_description:[7:49.99956%,11:49.99799%,0:0.00245%]
[INFO] ** modbus_transaction_id:65536 (11.45564%)
[INFO] ** orig:[0:99.99913%,2:0.00052%,1:0.00035%]
[INFO] ** proto:[0:99.9979%,1:0.00175%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.37192%,20:25.99456%,13:18.148%,6:17.48289%,17:0.00175%,7:0.00035%,16:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.99439%,-0.32151:21.02939%,-1.27613:18.14748%,-0.23351:17.48219%,-0.33484:17.34253%,-71.33197:0.00175%,-0.24151:0.00052%,-1.27347:0.00035%,-71.14798:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:25.99404%,1:21.02939%,5:18.1473%,4:17.48202%,2:17.34235%,0:0.00489%]
[INFO] ** service:[0.0048200000000000005:99.99773%,-211.73542999999998:0.00175%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.37192%,9:25.99456%,7:18.148%,1:17.48289%,14:0.00122%,21:0.00087%,16:0.00017%,15:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99913%,1:0.00087%]
[INFO] ** unixtime:1555 (0.27181%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0219 - tp: 79123.0000 - fp: 877.0000 - tn: 319123.0000 - fn: 877.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0216 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79156.0000 - fp: 844.0000 - tn: 319156.0000 - fn: 844.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0219 - tp: 79061.0000 - fp: 939.0000 - tn: 319061.0000 - fn: 939.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.2169e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/572085
[33m[INFO] loading file 31-31/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (572085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (572085, 17)

[INFO] analyzing data
[INFO] 572085 rows
[INFO] ** appi_name:[21:99.99965%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.37575%,Single Stage Single Point:35.62425%]
[INFO] ** dst:[21:43.32468%,10:21.04949%,8:18.12003%,9:17.50404%,22:0.00105%,24:0.00035%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99965%,-33.760870000000004:0.00035%]
[INFO] ** modbus_function_description:[7:49.99991%,11:49.99974%,0:0.00035%]
[INFO] ** modbus_transaction_id:65536 (11.45564%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.39342%,20:25.98145%,13:18.12021%,6:17.50404%,16:0.00052%,7:0.00035%]
[INFO] ** s_port:[1.45442:25.98075%,-0.32151:21.04949%,-1.27613:18.11986%,-0.23351:17.50387%,-0.33484:17.34393%,-1.02014:0.00052%,-1.27347:0.00035%,1.45709:0.00035%,-71.14798:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.98041%,1:21.04932%,5:18.11969%,4:17.50352%,2:17.34375%,0:0.00332%]
[INFO] ** service:[0.0048200000000000005:99.99965%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.39342%,9:25.98145%,7:18.12021%,1:17.50404%,15:0.00052%,21:0.00035%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1554 (0.27164%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79150.0000 - fp: 850.0000 - tn: 319150.0000 - fn: 850.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79132.0000 - fp: 868.0000 - tn: 319132.0000 - fn: 868.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/572085
[33m[INFO] loading file 32-32/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (572085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (572085, 17)

[INFO] analyzing data
[INFO] 572085 rows
[INFO] ** appi_name:[21:99.9965%,30:0.00297%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.38309%,Single Stage Single Point:35.61691%]
[INFO] ** dst:[21:43.32188%,10:21.05666%,8:18.15307%,9:17.46384%,15:0.00297%,22:0.00087%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99738%,0:0.00262%]
[INFO] ** i/f_name:[2:99.99703%,3:0.00297%]
[INFO] ** modbus_function_code:[0.02961:99.9965%,-33.760870000000004:0.0035%]
[INFO] ** modbus_function_description:[7:49.99904%,11:49.99747%,0:0.0035%]
[INFO] ** modbus_transaction_id:65536 (11.45564%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9965%,1:0.00297%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.42471%,20:25.95419%,13:18.15307%,6:17.46436%,17:0.00297%,14:0.00052%,16:0.00017%]
[INFO] ** s_port:[1.45442:25.95366%,-0.32151:21.05666%,-1.27613:18.15272%,-0.23351:17.46366%,-0.33484:17.36805%,-71.33197:0.00297%,-0.24151:0.00052%,-1.2708:0.00017%,-1.02014:0.00017%,13.431270000000001:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.95331%,1:21.05649%,5:18.15272%,4:17.46331%,2:17.36805%,0:0.00612%]
[INFO] ** service:[0.0048200000000000005:99.9965%,-211.73542999999998:0.00297%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.42471%,9:25.95419%,7:18.15307%,1:17.46436%,14:0.00297%,2:0.00052%,15:0.00017%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1552 (0.27129%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-6-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/572085
[33m[INFO] loading file 33-33/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (572085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (572085, 17)

[INFO] analyzing data
[INFO] 572085 rows
[INFO] ** appi_name:[21:99.99703%,30:0.00105%,17:0.0007%,22:0.00052%,31:0.00017%,28:0.00017%,26:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.39183%,Single Stage Single Point:35.60817%]
[INFO] ** dst:[21:43.32363%,10:21.06348%,8:18.1251%,9:17.48307%,22:0.0014%,15:0.00105%,16:0.0007%,6:0.0007%,24:0.00035%,17:0.00035%,18:0.00017%]
[INFO] ** i/f_dir:[1:99.99895%,0:0.00105%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99703%,-33.760870000000004:0.00297%]
[INFO] ** modbus_function_description:[7:49.99956%,11:49.99747%,0:0.00297%]
[INFO] ** modbus_transaction_id:65536 (11.45564%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99808%,1:0.00105%,2:0.00087%]
[INFO] ** proxy_src_ip:[18:38.42104%,20:25.96695%,13:18.1251%,6:17.48324%,17:0.00105%,16:0.0007%,1:0.0007%,21:0.00035%,14:0.00035%,7:0.00035%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.96607%,-0.32151:21.06348%,-1.27613:18.12475%,-0.23351:17.48289%,-0.33484:17.35756%,-71.33197:0.00105%,-1.02014:0.0007%,1.45709:0.00052%,-71.14931:0.00052%,-1.27347:0.00035%,-5.08665:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,-71.14798:0.00017%,-58.032509999999995:0.00017%,-58.035180000000004:0.00017%,-0.24151:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.96572%,1:21.06348%,5:18.12458%,4:17.48272%,2:17.35756%,0:0.00594%]
[INFO] ** service:[0.0048200000000000005:99.99703%,-211.73542999999998:0.00105%,-205.44247:0.0007%,-211.08818:0.00052%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.42104%,9:25.96695%,7:18.1251%,1:17.48324%,14:0.00105%,15:0.0007%,3:0.0007%,21:0.00035%,4:0.00035%,2:0.00035%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1556 (0.27199%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79139.0000 - fp: 861.0000 - tn: 319139.0000 - fn: 861.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79131.0000 - fp: 869.0000 - tn: 319131.0000 - fn: 869.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79148.0000 - fp: 852.0000 - tn: 319148.0000 - fn: 852.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.2730e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 0.0014 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-6-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/572085
[33m[INFO] loading file 34-34/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (413518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (413518, 17)

[INFO] analyzing data
[INFO] 413518 rows
[INFO] ** appi_name:[21:99.99758%,30:0.00073%,7:0.00073%,31:0.00024%,22:0.00024%,8:0.00024%,6:0.00024%]
[INFO] ** classification:[normal:64.34061%,Single Stage Single Point:35.65939%]
[INFO] ** dst:[21:43.28228%,10:21.05519%,8:18.18929%,9:17.47034%,22:0.00073%,15:0.00073%,16:0.00048%,2:0.00048%,18:0.00024%,6:0.00024%]
[INFO] ** i/f_dir:[1:99.99927%,0:0.00073%]
[INFO] ** i/f_name:[2:99.99927%,3:0.00073%]
[INFO] ** modbus_function_code:[0.02961:99.99758%,-33.760870000000004:0.00242%]
[INFO] ** modbus_function_description:[7:49.99927%,11:49.99831%,0:0.00242%]
[INFO] ** modbus_transaction_id:65536 (15.8484%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99879%,1:0.00073%,2:0.00048%]
[INFO] ** proxy_src_ip:[18:38.38866%,20:25.94905%,13:18.18905%,6:17.47082%,17:0.00073%,1:0.00073%,21:0.00048%,14:0.00024%,7:0.00024%]
[INFO] ** s_port:[1.45442:25.94857%,-0.32151:21.05495%,-1.27613:18.18905%,-0.23351:17.4701%,-0.33484:17.33371%,-0.24151:0.00073%,-71.33197:0.00073%,-3.0613900000000003:0.00024%,-3.3787199999999995:0.00024%,14.191239999999999:0.00024%,1.46509:0.00024%,1.47576:0.00024%,11.57001:0.00024%,-49.275529999999996:0.00024%,-71.14931:0.00024%,7.66617:0.00024%]
[INFO] ** scada_tag:[3:25.94833%,1:21.05471%,5:18.18881%,4:17.46961%,2:17.33371%,0:0.00484%]
[INFO] ** service:[0.0048200000000000005:99.99782%,-211.09762999999998:0.00073%,-211.73542999999998:0.00073%,-186.43601999999998:0.00024%,-211.35747999999998:0.00024%,-211.08818:0.00024%]
[INFO] ** src:[22:38.38866%,9:25.94905%,7:18.18905%,1:17.47082%,14:0.00073%,3:0.00073%,4:0.00048%,21:0.00024%,2:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1123 (0.27157%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/413518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/413518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79130.0000 - fp: 870.0000 - tn: 319130.0000 - fn: 870.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/413518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/413518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-33-34-batch-300000-400000
[INFO] processing batch 400000-500000/413518
[33m[INFO] loading file 35-35/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:99.99883%,30:0.00117%]
[INFO] ** classification:[normal:64.38002%,Single Stage Single Point:35.61998%]
[INFO] ** dst:[21:43.33422%,10:21.04308%,8:18.14523%,9:17.47514%,22:0.00117%,15:0.00117%]
[INFO] ** i/f_dir:[1:99.99903%,0:0.00097%]
[INFO] ** i/f_name:[2:99.99883%,3:0.00117%]
[INFO] ** modbus_function_code:[0.02961:99.99883%,-33.760870000000004:0.00117%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99864%,0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip:[18:38.40897%,20:25.9689%,13:18.14484%,6:17.47534%,17:0.00117%,16:0.00078%]
[INFO] ** s_port:[1.45442:25.96832%,-0.32151:21.04308%,-1.27613:18.14484%,-0.23351:17.47495%,-0.33484:17.3659%,-71.33197:0.00117%,-1.02014:0.00078%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.96793%,1:21.04308%,5:18.14464%,4:17.47456%,2:17.3659%,0:0.00389%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.73542999999998:0.00117%]
[INFO] ** src:[22:38.40897%,9:25.9689%,7:18.14484%,1:17.47534%,14:0.00117%,15:0.00078%]
[INFO] ** type:[0:99.99903%,1:0.00097%]
[INFO] ** unixtime:1394 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0216 - tp: 79078.0000 - fp: 922.0000 - tn: 319078.0000 - fn: 922.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79073.0000 - fp: 927.0000 - tn: 319073.0000 - fn: 927.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0196 - tp: 79160.0000 - fp: 840.0000 - tn: 319160.0000 - fn: 840.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/513518
[33m[INFO] loading file 36-36/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:99.99864%,30:0.00058%,31:0.00039%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.36094%,Single Stage Single Point:35.63906%]
[INFO] ** dst:[21:43.33597%,10:21.02283%,8:18.15672%,9:17.48215%,22:0.00078%,15:0.00058%,24:0.00039%,18:0.00039%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99942%,0:0.00058%]
[INFO] ** i/f_name:[2:99.99942%,3:0.00058%]
[INFO] ** modbus_function_code:[0.02961:99.99864%,-33.760870000000004:0.00136%]
[INFO] ** modbus_function_description:[7:50.00039%,11:49.99825%,0:0.00136%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,2:0.00058%,1:0.00058%]
[INFO] ** proxy_src_ip:[18:38.37509%,20:25.9839%,13:18.15691%,6:17.48274%,17:0.00058%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98332%,-0.32151:21.02263%,-1.27613:18.15633%,-0.23351:17.48196%,-0.33484:17.35246%,-0.24151:0.00058%,-71.33197:0.00058%,-1.27347:0.00039%,-0.08551:0.00039%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-49.275529999999996:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.98293%,1:21.02244%,5:18.15613%,4:17.48176%,2:17.35226%,0:0.00448%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.73542999999998:0.00058%,-186.43601999999998:0.00039%,-186.44547:0.00019%]
[INFO] ** src:[22:38.37509%,9:25.9839%,7:18.15691%,1:17.48274%,14:0.00058%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1395 (0.27166%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79123.0000 - fp: 877.0000 - tn: 319123.0000 - fn: 877.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 7.4014e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79145.0000 - fp: 855.0000 - tn: 319145.0000 - fn: 855.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/513518
[33m[INFO] loading file 37-37/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:99.99883%,30:0.00078%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.3884%,Single Stage Single Point:35.6116%]
[INFO] ** dst:[21:43.33811%,10:21.04834%,8:18.13198%,9:17.47943%,22:0.00078%,15:0.00078%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99922%,3:0.00078%]
[INFO] ** modbus_function_code:[0.02961:99.99883%,-33.760870000000004:0.00117%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99864%,0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99903%,1:0.00078%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.39515%,20:25.99169%,13:18.13218%,6:17.47943%,17:0.00078%,16:0.00039%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.9911%,-0.32151:21.04834%,-1.27613:18.13179%,-0.23351:17.47923%,-0.33484:17.34681%,-71.33197:0.00078%,-1.02014:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.99091%,1:21.04834%,5:18.13159%,4:17.47904%,2:17.34662%,0:0.00351%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.73542999999998:0.00078%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.39515%,9:25.99169%,7:18.13218%,1:17.47943%,14:0.00078%,15:0.00039%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1395 (0.27166%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79063.0000 - fp: 937.0000 - tn: 319063.0000 - fn: 937.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 3.7218e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/513518
[33m[INFO] loading file 38-38/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:99.99903%,30:0.00019%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.40806%,Single Stage Single Point:35.59194%]
[INFO] ** dst:[21:43.31922%,10:21.0867%,8:18.09888%,9:17.49325%,22:0.00097%,25:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99903%,-33.760870000000004:0.00097%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99922%,0:0.00097%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99942%,2:0.00039%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.45513%,20:25.95138%,13:18.09868%,6:17.49364%,7:0.00039%,17:0.00019%,16:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.9506%,-0.32151:21.08651%,-1.27613:18.09849%,-0.23351:17.49306%,-0.33484:17.36862%,1.45709:0.00039%,-0.24151:0.00039%,-71.14798:0.00019%,-64.19493:0.00019%,-1.02014:0.00019%,-61.95768:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,10.192739999999999:0.00019%,-0.24950999999999998:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.95021%,1:21.08651%,5:18.09849%,4:17.49286%,2:17.36862%,0:0.00331%]
[INFO] ** service:[0.0048200000000000005:99.99922%,-186.44547:0.00019%,-211.08346:0.00019%,-211.73542999999998:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.45513%,9:25.95138%,7:18.09868%,1:17.49364%,21:0.00039%,16:0.00019%,15:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1396 (0.27185%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79131.0000 - fp: 869.0000 - tn: 319131.0000 - fn: 869.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79128.0000 - fp: 872.0000 - tn: 319128.0000 - fn: 872.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79130.0000 - fp: 870.0000 - tn: 319130.0000 - fn: 870.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79073.0000 - fp: 927.0000 - tn: 319073.0000 - fn: 927.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79081.0000 - fp: 919.0000 - tn: 319081.0000 - fn: 919.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/513518
[33m[INFO] loading file 39-39/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.41546%,Single Stage Single Point:35.58454%]
[INFO] ** dst:[21:43.32467%,10:21.09001%,8:18.13004%,9:17.45411%,22:0.00097%,24:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00078%,11:49.99922%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.46311%,20:25.95177%,13:18.13043%,6:17.45411%,16:0.00058%]
[INFO] ** s_port:[1.45442:25.95138%,-0.32151:21.09001%,-1.27613:18.13004%,-0.23351:17.45392%,-0.33484:17.3731%,-1.02014:0.00058%,-1.27347:0.00019%,1.45709:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95099%,1:21.08982%,5:18.12984%,4:17.45392%,2:17.37291%,0:0.00253%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.46311%,9:25.95177%,7:18.13043%,1:17.45411%,15:0.00058%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1394 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79137.0000 - fp: 863.0000 - tn: 319137.0000 - fn: 863.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0214 - tp: 79064.0000 - fp: 936.0000 - tn: 319064.0000 - fn: 936.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79158.0000 - fp: 842.0000 - tn: 319158.0000 - fn: 842.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/513518
[33m[INFO] loading file 40-40/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:99.99611%,30:0.00331%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.34516%,Single Stage Single Point:35.65484%]
[INFO] ** dst:[21:43.30559%,10:21.03451%,8:18.18281%,9:17.47222%,15:0.00331%,22:0.00078%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99688%,0:0.00312%]
[INFO] ** i/f_name:[2:99.99669%,3:0.00331%]
[INFO] ** modbus_function_code:[0.02961:99.99611%,-33.760870000000004:0.00389%]
[INFO] ** modbus_function_description:[7:49.99903%,11:49.99708%,0:0.00389%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.99611%,1:0.00331%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.35445%,20:25.98643%,13:18.18261%,6:17.47261%,17:0.00331%,14:0.00058%]
[INFO] ** s_port:[1.45442:25.98565%,-0.32151:21.03451%,-1.27613:18.18242%,-0.23351:17.47203%,-0.33484:17.31994%,-71.33197:0.00331%,1.45709:0.00039%,-0.24151:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,13.431270000000001:0.00019%]
[INFO] ** scada_tag:[3:25.98526%,1:21.03432%,5:18.18223%,4:17.47164%,2:17.31974%,0:0.00682%]
[INFO] ** service:[0.0048200000000000005:99.99611%,-211.73542999999998:0.00331%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.35445%,9:25.98643%,7:18.18261%,1:17.47261%,14:0.00331%,2:0.00058%]
[INFO] ** type:[0:99.99903%,1:0.00097%]
[INFO] ** unixtime:1397 (0.27204%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1948e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/513518
[33m[INFO] loading file 41-41/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (453676, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (453676, 17)

[INFO] analyzing data
[INFO] 453676 rows
[INFO] ** appi_name:[21:99.99625%,30:0.0011%,22:0.00088%,17:0.00088%,32:0.00022%,28:0.00022%,26:0.00022%,7:0.00022%]
[INFO] ** classification:[normal:64.40081%,Single Stage Single Point:35.59919%]
[INFO] ** dst:[21:43.32894%,10:21.06724%,8:18.13387%,9:17.46511%,16:0.0011%,15:0.0011%,6:0.0011%,22:0.00066%,24:0.00044%,17:0.00044%]
[INFO] ** i/f_dir:[1:99.9989%,0:0.0011%]
[INFO] ** i/f_name:[2:99.9989%,3:0.0011%]
[INFO] ** modbus_function_code:[0.02961:99.99625%,-33.760870000000004:0.00375%]
[INFO] ** modbus_function_description:[7:49.9989%,11:49.99735%,0:0.00375%]
[INFO] ** modbus_transaction_id:65536 (14.44555%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99758%,2:0.00132%,1:0.0011%]
[INFO] ** proxy_src_ip:[18:38.4466%,20:25.9498%,13:18.13409%,6:17.46533%,17:0.0011%,1:0.00088%,21:0.00044%,16:0.00044%,14:0.00044%,0:0.00044%,7:0.00022%,2:0.00022%]
[INFO] ** s_port:[1.45442:25.94936%,-0.32151:21.06724%,-1.27613:18.13343%,-0.23351:17.46489%,-0.33484:17.37936%,-71.33197:0.0011%,-71.14931:0.00088%,-1.02014:0.00044%,-1.27347:0.00044%,-71.14798:0.00022%,-0.24151:0.00022%,-58.035180000000004:0.00022%,-1.2708:0.00022%,-5.1466400000000005:0.00022%,1.47576:0.00022%,1.46509:0.00022%,-64.19226:0.00022%,-5.08665:0.00022%,-0.24950999999999998:0.00022%,2.05573:0.00022%,-43.76509:0.00022%,-58.032509999999995:0.00022%]
[INFO] ** scada_tag:[3:25.94914%,1:21.06724%,5:18.13343%,4:17.46467%,2:17.37936%,0:0.00617%]
[INFO] ** service:[0.0048200000000000005:99.99625%,-211.73542999999998:0.0011%,-205.44247:0.00088%,-211.08818:0.00088%,89.64175:0.00022%,-211.09762999999998:0.00022%,-211.08346:0.00022%,-185.9872:0.00022%]
[INFO] ** src:[22:38.4466%,9:25.9498%,7:18.13409%,1:17.46533%,14:0.0011%,3:0.00088%,15:0.00044%,8:0.00044%,4:0.00044%,2:0.00044%,21:0.00022%,17:0.00022%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1231 (0.27134%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/453676
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79081.0000 - fp: 919.0000 - tn: 319081.0000 - fn: 919.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/453676
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/453676
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/453676
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/453676
[33m[INFO] loading file 42-42/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (397190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (397190, 17)

[INFO] analyzing data
[INFO] 397190 rows
[INFO] ** appi_name:[21:99.99144%,30:0.00227%,17:0.00126%,31:0.00101%,26:0.00101%,7:0.00101%,22:0.00076%,28:0.00025%,27:0.00025%,9:0.00025%,8:0.00025%,0:0.00025%]
[INFO] ** classification:[normal:64.37801%,Single Stage Single Point:35.62199%]
[INFO] ** dst:[21:43.31378%,10:21.05516%,8:18.17518%,9:17.44631%,16:0.00227%,6:0.00201%,18:0.00126%,2:0.00101%,22:0.00076%,15:0.00076%,17:0.0005%,25:0.00025%,24:0.00025%,7:0.00025%,0:0.00025%]
[INFO] ** i/f_dir:[1:99.99924%,0:0.00076%]
[INFO] ** i/f_name:[2:99.99924%,3:0.00076%]
[INFO] ** modbus_function_code:[0.02961:99.99144%,-33.760870000000004:0.00856%]
[INFO] ** modbus_function_description:[7:49.99648%,11:49.99496%,0:0.00856%]
[INFO] ** modbus_transaction_id:65536 (16.49991%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99547%,2:0.00378%,1:0.00076%]
[INFO] ** proxy_src_ip:[18:38.41763%,20:25.95156%,13:18.17568%,6:17.44631%,17:0.00227%,1:0.00227%,14:0.00151%,21:0.00101%,7:0.00076%,0:0.0005%,16:0.00025%,2:0.00025%]
[INFO] ** s_port:[1.45442:25.95106%,-0.32151:21.05516%,-1.27613:18.17518%,-0.23351:17.44606%,-0.33484:17.36247%,-71.14931:0.00101%,-71.14798:0.00101%,-71.33197:0.00076%,11.57001:0.0005%,-0.08551:0.0005%,-3.3787199999999995:0.0005%,-0.24151:0.00025%,13.431270000000001:0.00025%,-5.1466400000000005:0.00025%,0.31847:0.00025%,-1.02014:0.00025%,-1.2708:0.00025%,-58.035180000000004:0.00025%,7.66617:0.00025%,-64.19493:0.00025%,1.47576:0.00025%,14.4699:0.00025%,15.912510000000001:0.00025%,14.191239999999999:0.00025%,7.9608300000000005:0.00025%,-5.08665:0.00025%,10.192739999999999:0.00025%,-3.0613900000000003:0.00025%,1.45709:0.00025%,2.05573:0.00025%,-43.76509:0.00025%,11.862:0.00025%,-1.27347:0.00025%,-58.032509999999995:0.00025%]
[INFO] ** scada_tag:[3:25.95055%,1:21.05516%,5:18.17493%,4:17.44606%,2:17.36222%,0:0.01108%]
[INFO] ** service:[0.0048200000000000005:99.99144%,-211.09762999999998:0.00176%,-205.44247:0.00126%,-186.43601999999998:0.00126%,-211.08346:0.00101%,-211.08818:0.00101%,-211.73542999999998:0.00076%,-211.35747999999998:0.0005%,-186.44547:0.00025%,-183.8612:0.00025%,-185.9872:0.00025%,-202.75898:0.00025%]
[INFO] ** src:[22:38.41763%,9:25.95156%,7:18.17568%,1:17.44631%,3:0.00302%,2:0.00176%,4:0.00126%,21:0.00101%,14:0.00076%,8:0.0005%,17:0.00025%,15:0.00025%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1078 (0.27141%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/397190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1924e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/397190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1922e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/397190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79091.0000 - fp: 909.0000 - tn: 319091.0000 - fn: 909.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/397190
[33m[INFO] loading file 43-43/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597190, 17)

[INFO] analyzing data
[INFO] 597190 rows
[INFO] ** appi_name:[21:99.99833%,30:0.0005%,7:0.0005%,26:0.00033%,22:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:64.38705%,Single Stage Single Point:35.61295%]
[INFO] ** dst:[21:43.31503%,10:21.06934%,8:18.14431%,9:17.46848%,22:0.001%,15:0.0005%,6:0.0005%,16:0.00033%,2:0.00033%,24:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.9995%,3:0.0005%]
[INFO] ** modbus_function_code:[0.02961:99.99833%,-33.760870000000004:0.00167%]
[INFO] ** modbus_function_description:[7:49.99983%,11:49.99849%,0:0.00167%]
[INFO] ** modbus_transaction_id:65536 (10.97406%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.999%,2:0.0005%,1:0.0005%]
[INFO] ** proxy_src_ip:[18:38.41625%,20:25.96862%,13:18.14448%,6:17.46864%,17:0.0005%,1:0.0005%,16:0.00033%,7:0.00033%,21:0.00017%,14:0.00017%]
[INFO] ** s_port:[1.45442:25.96795%,-0.32151:21.06934%,-1.27613:18.14414%,-0.23351:17.46814%,-0.33484:17.34691%,-71.33197:0.0005%,1.47576:0.00033%,1.45709:0.00033%,-71.14798:0.00033%,-0.24151:0.00033%,-1.02014:0.00033%,-0.24950999999999998:0.00017%,-1.2708:0.00017%,-1.27347:0.00017%,-3.3787199999999995:0.00017%,7.9608300000000005:0.00017%,11.57001:0.00017%,-71.14931:0.00017%,0.31847:0.00017%]
[INFO] ** scada_tag:[3:25.96761%,1:21.06934%,5:18.14397%,4:17.46781%,2:17.34674%,0:0.00452%]
[INFO] ** service:[0.0048200000000000005:99.99833%,-211.09762999999998:0.0005%,-211.73542999999998:0.0005%,-211.08346:0.00033%,-211.35747999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.41625%,9:25.96862%,7:18.14448%,1:17.46864%,14:0.0005%,3:0.0005%,21:0.00033%,15:0.00033%,4:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99967%,1:0.00033%]
[INFO] ** unixtime:1623 (0.27177%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/597190
[33m[INFO] loading file 44-44/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597190, 17)

[INFO] analyzing data
[INFO] 597190 rows
[INFO] ** appi_name:[21:99.99833%,30:0.00067%,31:0.0005%,0:0.00033%,22:0.00017%]
[INFO] ** classification:[normal:64.39475%,Single Stage Single Point:35.60525%]
[INFO] ** dst:[21:43.33931%,10:21.0526%,8:18.14917%,9:17.45592%,22:0.001%,15:0.00067%,18:0.0005%,25:0.00033%,24:0.00033%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99933%,0:0.00067%]
[INFO] ** i/f_name:[2:99.99933%,3:0.00067%]
[INFO] ** modbus_function_code:[0.02961:99.99833%,-33.760870000000004:0.00167%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99816%,0:0.00167%]
[INFO] ** modbus_transaction_id:65536 (10.97406%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99833%,2:0.001%,1:0.00067%]
[INFO] ** proxy_src_ip:[18:38.43232%,20:25.96008%,13:18.14933%,6:17.45642%,17:0.00067%,7:0.00033%,16:0.00017%,5:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95941%,-0.32151:21.0526%,-1.27613:18.14883%,-0.23351:17.45575%,-0.33484:17.37973%,-71.33197:0.00067%,-0.24151:0.0005%,-0.08551:0.00033%,-64.19493:0.00033%,-1.27347:0.00033%,1.45709:0.00033%,-1.02014:0.00017%,-1.2708:0.00017%,1.47576:0.00017%,-71.14931:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,4.42897:0.00017%]
[INFO] ** scada_tag:[3:25.95891%,1:21.0526%,5:18.14883%,4:17.45542%,2:17.37956%,0:0.00469%]
[INFO] ** service:[0.0048200000000000005:99.99833%,-211.73542999999998:0.00067%,-186.43601999999998:0.0005%,-186.44547:0.00033%,-211.08818:0.00017%]
[INFO] ** src:[22:38.43232%,9:25.96008%,7:18.14933%,1:17.45642%,14:0.00067%,21:0.00033%,17:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1621 (0.27144%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79141.0000 - fp: 859.0000 - tn: 319141.0000 - fn: 859.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79079.0000 - fp: 921.0000 - tn: 319079.0000 - fn: 921.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/597190
[33m[INFO] loading file 45-45/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597190, 17)

[INFO] analyzing data
[INFO] 597190 rows
[INFO] ** appi_name:[21:99.99883%,30:0.0005%,31:0.00033%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:64.41183%,Single Stage Single Point:35.58817%]
[INFO] ** dst:[21:43.32239%,10:21.08676%,8:18.13393%,9:17.45441%,22:0.00134%,15:0.0005%,18:0.00033%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99967%,0:0.00033%]
[INFO] ** i/f_name:[2:99.9995%,3:0.0005%]
[INFO] ** modbus_function_code:[0.02961:99.99883%,-33.760870000000004:0.00117%]
[INFO] ** modbus_function_description:[7:50.0005%,11:49.99833%,0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (10.97406%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.999%,2:0.0005%,1:0.0005%]
[INFO] ** proxy_src_ip:[18:38.47754%,20:25.93228%,13:18.13376%,6:17.45491%,17:0.0005%,16:0.00033%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.93161%,-0.32151:21.08676%,-1.27613:18.13376%,-0.23351:17.45424%,-0.33484:17.39078%,1.45709:0.0005%,-0.24151:0.0005%,-71.33197:0.0005%,-1.02014:0.00033%,-0.08551:0.00033%,-71.14798:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:25.93111%,1:21.08659%,5:18.13376%,4:17.45424%,2:17.39061%,0:0.00368%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.73542999999998:0.0005%,-186.43601999999998:0.00033%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.47754%,9:25.93228%,7:18.13376%,1:17.45491%,14:0.0005%,15:0.00033%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1620 (0.27127%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0214 - tp: 79084.0000 - fp: 916.0000 - tn: 319084.0000 - fn: 916.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79137.0000 - fp: 863.0000 - tn: 319137.0000 - fn: 863.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/597190
[33m[INFO] loading file 46-46/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597190, 17)

[INFO] analyzing data
[INFO] 597190 rows
[INFO] ** appi_name:[21:99.99816%,30:0.001%,26:0.00017%,17:0.00017%,12:0.00017%,9:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.41334%,Single Stage Single Point:35.58666%]
[INFO] ** dst:[21:43.34198%,10:21.06867%,8:18.11166%,9:17.47501%,22:0.001%,15:0.001%,25:0.00017%,16:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99916%,0:0.00084%]
[INFO] ** i/f_name:[2:99.999%,3:0.001%]
[INFO] ** modbus_function_code:[0.02961:99.99816%,-33.760870000000004:0.00184%]
[INFO] ** modbus_function_description:[7:49.99916%,11:49.999%,0:0.00184%]
[INFO] ** modbus_transaction_id:65536 (10.97406%)
[INFO] ** orig:[0:99.99967%,1:0.00033%]
[INFO] ** proto:[0:99.99866%,1:0.001%,2:0.00033%]
[INFO] ** proxy_src_ip:[18:38.43701%,20:25.97364%,13:18.11166%,6:17.47551%,17:0.001%,16:0.00033%,7:0.00033%,5:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.97331%,-0.32151:21.0685%,-1.27613:18.11149%,-0.23351:17.47484%,-0.33484:17.36851%,-71.33197:0.001%,-0.24151:0.0005%,-1.02014:0.00033%,-64.19493:0.00017%,14.4699:0.00017%,10.192739999999999:0.00017%,-71.14798:0.00017%,-1.2708:0.00017%,1.45709:0.00017%,1.47576:0.00017%,-0.24950999999999998:0.00017%,-61.95768:0.00017%]
[INFO] ** scada_tag:[3:25.97281%,1:21.06834%,5:18.11132%,4:17.47451%,2:17.36851%,0:0.00452%]
[INFO] ** service:[0.0048200000000000005:99.99833%,-211.73542999999998:0.001%,-183.8612:0.00017%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.43701%,9:25.97364%,7:18.11166%,1:17.47551%,14:0.001%,21:0.00033%,15:0.00033%,16:0.00017%,8:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99916%,1:0.00084%]
[INFO] ** unixtime:1623 (0.27177%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79141.0000 - fp: 859.0000 - tn: 319141.0000 - fn: 859.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/597190
[33m[INFO] loading file 47-47/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597190, 17)

[INFO] analyzing data
[INFO] 597190 rows
[INFO] ** appi_name:[21:99.9995%,33:0.00017%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.40262%,Single Stage Single Point:35.59738%]
[INFO] ** dst:[21:43.31385%,10:21.08692%,8:18.12288%,9:17.47417%,22:0.00151%,24:0.00033%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.9995%,-33.760870000000004:0.0005%]
[INFO] ** modbus_function_description:[7:50.00117%,11:49.99833%,0:0.0005%]
[INFO] ** modbus_transaction_id:65536 (10.97406%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.45811%,20:25.94333%,13:18.12321%,6:17.47451%,16:0.00033%,7:0.00033%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.9425%,-0.32151:21.08692%,-1.27613:18.12271%,-0.23351:17.474%,-0.33484:17.37119%,1.45709:0.0005%,-0.24151:0.0005%,-1.27347:0.00033%,-1.02014:0.00033%,-71.14798:0.00017%,-61.95635:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.942%,1:21.08676%,5:18.12254%,4:17.47384%,2:17.37102%,0:0.00385%]
[INFO] ** service:[0.0048200000000000005:99.99967%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.45811%,9:25.94333%,7:18.12321%,1:17.47451%,21:0.00033%,15:0.00033%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1621 (0.27144%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-6-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79084.0000 - fp: 916.0000 - tn: 319084.0000 - fn: 916.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79075.0000 - fp: 925.0000 - tn: 319075.0000 - fn: 925.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/597190
[33m[INFO] loading file 48-48/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597190, 17)

[INFO] analyzing data
[INFO] 597190 rows
[INFO] ** appi_name:[21:99.99699%,30:0.00234%,33:0.00017%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.41903%,Single Stage Single Point:35.58097%]
[INFO] ** dst:[21:43.3234%,10:21.09195%,8:18.1145%,9:17.4663%,15:0.00234%,22:0.00084%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99799%,0:0.00201%]
[INFO] ** i/f_name:[2:99.99766%,3:0.00234%]
[INFO] ** modbus_function_code:[0.02961:99.99699%,-33.760870000000004:0.00301%]
[INFO] ** modbus_function_description:[7:49.99916%,11:49.99782%,0:0.00301%]
[INFO] ** modbus_transaction_id:65536 (10.97406%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99715%,1:0.00234%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.46163%,20:25.95405%,13:18.11467%,6:17.4663%,17:0.00234%,14:0.0005%,16:0.00033%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95355%,-0.32151:21.09195%,-1.27613:18.11434%,-0.23351:17.46613%,-0.33484:17.36968%,-71.33197:0.00234%,-1.02014:0.00033%,-1.2708:0.00017%,13.431270000000001:0.00017%,-0.24151:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-61.95635:0.00017%,1.45709:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.95321%,1:21.09178%,5:18.11434%,4:17.46613%,2:17.36951%,0:0.00502%]
[INFO] ** service:[0.0048200000000000005:99.99715%,-211.73542999999998:0.00234%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.46163%,9:25.95405%,7:18.11467%,1:17.4663%,14:0.00234%,2:0.0005%,15:0.00033%,8:0.00017%]
[INFO] ** type:[0:99.99967%,1:0.00033%]
[INFO] ** unixtime:1620 (0.27127%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79042.0000 - fp: 958.0000 - tn: 319042.0000 - fn: 958.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79036.0000 - fp: 964.0000 - tn: 319036.0000 - fn: 964.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/597190
[33m[INFO] loading file 49-49/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597190, 17)

[INFO] analyzing data
[INFO] 597190 rows
[INFO] ** appi_name:[21:99.99749%,30:0.00084%,17:0.00067%,26:0.00033%,22:0.00033%,28:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.3837%,Single Stage Single Point:35.6163%]
[INFO] ** dst:[21:43.3172%,10:21.06231%,8:18.12656%,9:17.48958%,22:0.00151%,15:0.00084%,16:0.00067%,6:0.00067%,24:0.00033%,17:0.00033%]
[INFO] ** i/f_dir:[1:99.99916%,0:0.00084%]
[INFO] ** i/f_name:[2:99.99916%,3:0.00084%]
[INFO] ** modbus_function_code:[0.02961:99.99749%,-33.760870000000004:0.00251%]
[INFO] ** modbus_function_description:[7:49.99967%,11:49.99782%,0:0.00251%]
[INFO] ** modbus_transaction_id:65536 (10.97406%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99849%,1:0.00084%,2:0.00067%]
[INFO] ** proxy_src_ip:[18:38.43065%,20:25.94953%,13:18.12673%,6:17.49025%,17:0.00084%,1:0.00067%,14:0.0005%,21:0.00033%,16:0.00033%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.94869%,-0.32151:21.06231%,-1.27613:18.12622%,-0.23351:17.48941%,-0.33484:17.36834%,-71.33197:0.00084%,-0.24151:0.00067%,1.45709:0.0005%,-1.27347:0.00033%,-71.14931:0.00033%,-1.02014:0.00033%,-71.14798:0.00033%,1.47576:0.00017%,-1.2708:0.00017%,-58.035180000000004:0.00017%,-58.032509999999995:0.00017%,1.46509:0.00017%,-43.76509:0.00017%,2.05573:0.00017%,-5.08665:0.00017%,-0.24950999999999998:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.94836%,1:21.06214%,5:18.12606%,4:17.48907%,2:17.36834%,0:0.00603%]
[INFO] ** service:[0.0048200000000000005:99.99749%,-211.73542999999998:0.00084%,-205.44247:0.00067%,-211.08346:0.00033%,-211.08818:0.00033%,-211.09762999999998:0.00017%,-185.9872:0.00017%]
[INFO] ** src:[22:38.43065%,9:25.94953%,7:18.12673%,1:17.49025%,14:0.00084%,3:0.00067%,2:0.0005%,15:0.00033%,4:0.00033%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1621 (0.27144%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79158.0000 - fp: 842.0000 - tn: 319158.0000 - fn: 842.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79177.0000 - fp: 823.0000 - tn: 319177.0000 - fn: 823.0000 - accuracy: 0.9959 - precision: 0.9897 - recall: 0.9897 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79139.0000 - fp: 861.0000 - tn: 319139.0000 - fn: 861.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0191 - tp: 79198.0000 - fp: 802.0000 - tn: 319198.0000 - fn: 802.0000 - accuracy: 0.9960 - precision: 0.9900 - recall: 0.9900 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/597190
[33m[INFO] loading file 50-50/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (447172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (447172, 17)

[INFO] analyzing data
[INFO] 447172 rows
[INFO] ** appi_name:[21:99.99732%,30:0.00112%,7:0.00067%,22:0.00045%,31:0.00022%,8:0.00022%]
[INFO] ** classification:[normal:64.31284%,Single Stage Single Point:35.68716%]
[INFO] ** dst:[21:43.26523%,10:21.04425%,8:18.20955%,9:17.47739%,15:0.00112%,22:0.00067%,16:0.00045%,6:0.00045%,2:0.00045%,24:0.00022%,18:0.00022%]
[INFO] ** i/f_dir:[1:99.99888%,0:0.00112%]
[INFO] ** i/f_name:[2:99.99888%,3:0.00112%]
[INFO] ** modbus_function_code:[0.02961:99.99732%,-33.760870000000004:0.00268%]
[INFO] ** modbus_function_description:[11:49.99888%,7:49.99843%,0:0.00268%]
[INFO] ** modbus_transaction_id:65536 (14.65566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99821%,1:0.00112%,2:0.00067%]
[INFO] ** proxy_src_ip:[18:38.36622%,20:25.94348%,13:18.20977%,6:17.47739%,17:0.00112%,1:0.00067%,16:0.00045%,14:0.00045%,21:0.00022%,7:0.00022%]
[INFO] ** s_port:[1.45442:25.94304%,-0.32151:21.04425%,-1.27613:18.20932%,-0.23351:17.47739%,-0.33484:17.32197%,-71.33197:0.00112%,-71.14931:0.00045%,-1.02014:0.00045%,-3.3787199999999995:0.00022%,4.33564:0.00022%,15.912510000000001:0.00022%,7.9608300000000005:0.00022%,1.46509:0.00022%,1.45709:0.00022%,-1.27347:0.00022%,-1.2708:0.00022%,0.31847:0.00022%]
[INFO] ** scada_tag:[3:25.94281%,1:21.04403%,5:18.2091%,4:17.47739%,2:17.32175%,0:0.00492%]
[INFO] ** service:[0.0048200000000000005:99.99732%,-211.73542999999998:0.00112%,-211.09762999999998:0.00067%,-211.08818:0.00045%,-186.43601999999998:0.00022%,-211.35747999999998:0.00022%]
[INFO] ** src:[22:38.36622%,9:25.94348%,7:18.20977%,1:17.47739%,14:0.00112%,3:0.00067%,15:0.00045%,2:0.00045%,21:0.00022%,4:0.00022%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1215 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/447172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/447172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/447172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/447172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-49-50-batch-300000-400000
[INFO] processing batch 400000-500000/447172
[33m[INFO] epoch 7/10[0m
[33m[INFO] loading file 1-1/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99342%,30:0.0011%,22:0.00091%,17:0.00073%,31:0.00055%,26:0.00055%,7:0.00055%,23:0.00037%,18:0.00037%,0:0.00037%,28:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:78.00399%,Single Stage Single Point:21.99601%]
[INFO] ** dst:[21:43.27177%,10:21.0347%,8:18.16687%,9:17.51954%,6:0.00146%,22:0.0011%,16:0.0011%,15:0.0011%,18:0.00055%,26:0.00037%,25:0.00037%,19:0.00037%,17:0.00037%,24:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.9989%,0:0.0011%]
[INFO] ** i/f_name:[2:99.9989%,3:0.0011%]
[INFO] ** modbus_function_code:[0.02961:99.99342%,-33.760870000000004:0.0064%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99781%,11:49.99561%,0:0.0064%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99634%,2:0.00256%,1:0.0011%]
[INFO] ** proxy_src_ip:[18:38.3967%,20:25.9094%,13:18.16705%,6:17.5199%,11:0.00128%,10:0.00128%,17:0.0011%,14:0.00091%,1:0.00091%,7:0.00055%,21:0.00037%,16:0.00037%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.90885%,-0.32151:21.03397%,-1.27613:18.16668%,-0.23351:17.51935%,-0.33484:17.36273%,-71.33197:0.0011%,-71.14931:0.00091%,-2.1481:0.00073%,-0.24151:0.00055%,-71.14798:0.00055%,-1.02014:0.00037%,-64.19493:0.00037%,-2.42942:0.00037%,4.44364:0.00037%,-43.76509:0.00018%,10.67005:0.00018%,4.29964:0.00018%,-5.08665:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,1.47576:0.00018%,1.46509:0.00018%,4.076980000000001:0.00018%,-58.032509999999995:0.00018%,-58.035180000000004:0.00018%,-1.2708:0.00018%,-1.27347:0.00018%,-5.1466400000000005:0.00018%,-68.79874000000001:0.00018%,14.253910000000001:0.00018%,1.45709:0.00018%]
[INFO] ** scada_tag:[3:25.90867%,1:21.03379%,5:18.16632%,4:17.51917%,2:17.36255%,0:0.0095%]
[INFO] ** service:[0.0048200000000000005:99.99415%,-211.73542999999998:0.0011%,-211.08818:0.00091%,-205.44247:0.00073%,-211.07873999999998:0.00073%,-211.09762999999998:0.00055%,-211.08346:0.00055%,-186.43601999999998:0.00055%,-186.44547:0.00037%,-185.9872:0.00018%,-202.75898:0.00018%]
[INFO] ** src:[22:38.3967%,9:25.9094%,7:18.16705%,1:17.5199%,11:0.00128%,10:0.00128%,14:0.0011%,3:0.00091%,2:0.00091%,21:0.00055%,15:0.00037%,4:0.00037%,8:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1485 (0.2714%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2986 - tp: 76853.0000 - fp: 3147.0000 - tn: 316853.0000 - fn: 3147.0000 - accuracy: 0.9843 - precision: 0.9607 - recall: 0.9607 - auc: 0.9884 - val_loss: 8.0941e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0102 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3106e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0070 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2388e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4432 - tp: 59723.0000 - fp: 20277.0000 - tn: 299723.0000 - fn: 20277.0000 - accuracy: 0.8986 - precision: 0.7465 - recall: 0.7465 - auc: 0.9214 - val_loss: 0.2801 - val_tp: 17226.0000 - val_fp: 2774.0000 - val_tn: 77226.0000 - val_fn: 2774.0000 - val_accuracy: 0.9445 - val_precision: 0.8613 - val_recall: 0.8613 - val_auc: 0.9878
[INFO] saving weights to checkpoints/lstm-epoch-7-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0939 - tp: 76385.0000 - fp: 3615.0000 - tn: 316385.0000 - fn: 3615.0000 - accuracy: 0.9819 - precision: 0.9548 - recall: 0.9548 - auc: 0.9988 - val_loss: 0.0011 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 2-2/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99872%,7:0.00055%,30:0.00037%,31:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:71.0877%,Single Stage Single Point:28.9123%]
[INFO] ** dst:[21:43.31289%,10:21.02922%,8:18.1442%,9:17.51131%,22:0.00091%,16:0.00037%,15:0.00037%,2:0.00037%,24:0.00018%,18:0.00018%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99963%,3:0.00037%]
[INFO] ** modbus_function_code:[0.02961:99.99872%,-33.760870000000004:0.00128%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99872%,0:0.00128%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99945%,1:0.00037%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.38172%,20:25.96094%,13:18.1442%,6:17.51168%,1:0.00055%,17:0.00037%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.96021%,-0.32151:21.02922%,-1.27613:18.14384%,-0.23351:17.51113%,-0.33484:17.3525%,-0.24151:0.00037%,-71.33197:0.00037%,1.45709:0.00037%,1.47576:0.00018%,12.60597:0.00018%,10.67005:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,4.076980000000001:0.00018%,-3.3787199999999995:0.00018%,4.29964:0.00018%,-1.27347:0.00018%]
[INFO] ** scada_tag:[3:25.95984%,1:21.02922%,5:18.14384%,4:17.51076%,2:17.35231%,0:0.00402%]
[INFO] ** service:[0.0048200000000000005:99.99872%,-211.09762999999998:0.00055%,-211.73542999999998:0.00037%,-211.35747999999998:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.38172%,9:25.96094%,7:18.1442%,1:17.51168%,3:0.00055%,14:0.00037%,21:0.00018%,15:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1488 (0.27194%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4303 - tp: 68896.0000 - fp: 11104.0000 - tn: 308896.0000 - fn: 11104.0000 - accuracy: 0.9445 - precision: 0.8612 - recall: 0.8612 - auc: 0.9764 - val_loss: 0.0199 - val_tp: 19949.0000 - val_fp: 51.0000 - val_tn: 79949.0000 - val_fn: 51.0000 - val_accuracy: 0.9990 - val_precision: 0.9974 - val_recall: 0.9974 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2416 - tp: 73463.0000 - fp: 6537.0000 - tn: 313463.0000 - fn: 6537.0000 - accuracy: 0.9673 - precision: 0.9183 - recall: 0.9183 - auc: 0.9899 - val_loss: 1.2260 - val_tp: 10648.0000 - val_fp: 9352.0000 - val_tn: 70648.0000 - val_fn: 9352.0000 - val_accuracy: 0.8130 - val_precision: 0.5324 - val_recall: 0.5324 - val_auc: 0.9386
[INFO] saving weights to checkpoints/lstm-epoch-7-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0824 - tp: 78145.0000 - fp: 1855.0000 - tn: 318145.0000 - fn: 1855.0000 - accuracy: 0.9907 - precision: 0.9768 - recall: 0.9768 - auc: 0.9987 - val_loss: 7.6068e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5338 - tp: 63560.0000 - fp: 16440.0000 - tn: 303560.0000 - fn: 16440.0000 - accuracy: 0.9178 - precision: 0.7945 - recall: 0.7945 - auc: 0.9657 - val_loss: 0.1455 - val_tp: 19818.0000 - val_fp: 182.0000 - val_tn: 79818.0000 - val_fn: 182.0000 - val_accuracy: 0.9964 - val_precision: 0.9909 - val_recall: 0.9909 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2007 - tp: 74885.0000 - fp: 5115.0000 - tn: 314885.0000 - fn: 5115.0000 - accuracy: 0.9744 - precision: 0.9361 - recall: 0.9361 - auc: 0.9930 - val_loss: 1.2914 - val_tp: 10594.0000 - val_fp: 9406.0000 - val_tn: 70594.0000 - val_fn: 9406.0000 - val_accuracy: 0.8119 - val_precision: 0.5297 - val_recall: 0.5297 - val_auc: 0.9442
[INFO] saving weights to checkpoints/lstm-epoch-7-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 3-3/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99159%,30:0.00219%,22:0.0011%,31:0.00091%,26:0.00091%,17:0.00091%,7:0.00073%,27:0.00037%,0:0.00037%,28:0.00018%,23:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:87.8572%,Single Stage Single Point:12.1428%]
[INFO] ** dst:[21:43.30869%,10:21.08459%,8:18.1559%,9:17.4415%,6:0.00219%,15:0.00146%,18:0.00128%,16:0.00128%,22:0.00091%,2:0.00037%,7:0.00037%,25:0.00037%,17:0.00037%,12:0.00018%,24:0.00018%,19:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99854%,0:0.00146%]
[INFO] ** i/f_name:[2:99.99854%,3:0.00146%]
[INFO] ** modbus_function_code:[0.02961:99.99159%,-33.760870000000004:0.00822%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99634%,11:49.99525%,0:0.00822%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.9989%,2:0.0011%]
[INFO] ** proto:[0:99.99415%,2:0.00439%,1:0.00146%]
[INFO] ** proxy_src_ip:[18:38.40895%,20:25.9847%,13:18.15608%,6:17.44186%,17:0.00219%,1:0.00146%,14:0.00128%,7:0.00091%,11:0.00073%,10:0.00073%,21:0.00055%,16:0.00018%,15:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98397%,-0.32151:21.08441%,-1.27613:18.15553%,-0.23351:17.44132%,-0.33484:17.32453%,-71.33197:0.00146%,-71.14931:0.0011%,-71.14798:0.0011%,-64.19493:0.00037%,-0.08551:0.00037%,1.45709:0.00037%,-0.24151:0.00037%,14.4699:0.00018%,4.29964:0.00018%,4.90362:0.00018%,10.192739999999999:0.00018%,-3.3787199999999995:0.00018%,13.86459:0.00018%,4.44364:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,-43.76509:0.00018%,-5.08665:0.00018%,-58.035180000000004:0.00018%,4.076980000000001:0.00018%,-58.032509999999995:0.00018%,-1.27347:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-5.1466400000000005:0.00018%,13.431270000000001:0.00018%,12.60597:0.00018%,1.47576:0.00018%,1.46509:0.00018%,14.253910000000001:0.00018%,-68.79874000000001:0.00018%,-0.24950999999999998:0.00018%,-2.1481:0.00018%,10.67005:0.00018%,-68.36943000000001:0.00018%]
[INFO] ** scada_tag:[3:25.9836%,1:21.08423%,5:18.15535%,4:17.44113%,2:17.32435%,0:0.01133%]
[INFO] ** service:[0.0048200000000000005:99.99178%,-211.73542999999998:0.00146%,-186.43601999999998:0.00128%,-211.08346:0.0011%,-211.08818:0.0011%,-205.44247:0.00091%,-211.09762999999998:0.00073%,-202.75898:0.00037%,-186.44547:0.00037%,-183.8612:0.00018%,-185.9872:0.00018%,-201.23771000000002:0.00018%,-211.35747999999998:0.00018%,-211.07873999999998:0.00018%]
[INFO] ** src:[22:38.40895%,9:25.9847%,7:18.15608%,1:17.44186%,21:0.00201%,3:0.00164%,2:0.00128%,11:0.00073%,10:0.00073%,4:0.00073%,14:0.00037%,8:0.00037%,17:0.00018%,15:0.00018%,13:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1486 (0.27158%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3741 - tp: 65777.0000 - fp: 14223.0000 - tn: 305777.0000 - fn: 14223.0000 - accuracy: 0.9289 - precision: 0.8222 - recall: 0.8222 - auc: 0.9759 - val_loss: 0.4105 - val_tp: 14615.0000 - val_fp: 5385.0000 - val_tn: 74615.0000 - val_fn: 5385.0000 - val_accuracy: 0.8923 - val_precision: 0.7308 - val_recall: 0.7308 - val_auc: 0.9584
[INFO] saving weights to checkpoints/lstm-epoch-7-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1181 - tp: 75976.0000 - fp: 4024.0000 - tn: 315976.0000 - fn: 4024.0000 - accuracy: 0.9799 - precision: 0.9497 - recall: 0.9497 - auc: 0.9984 - val_loss: 0.7108 - val_tp: 17363.0000 - val_fp: 2637.0000 - val_tn: 77363.0000 - val_fn: 2637.0000 - val_accuracy: 0.9473 - val_precision: 0.8681 - val_recall: 0.8681 - val_auc: 0.9496
[INFO] saving weights to checkpoints/lstm-epoch-7-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3701 - tp: 72020.0000 - fp: 7980.0000 - tn: 312020.0000 - fn: 7980.0000 - accuracy: 0.9601 - precision: 0.9003 - recall: 0.9003 - auc: 0.9811 - val_loss: 0.1240 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0685 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0033 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0107 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.4160e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 4-4/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99762%,30:0.00128%,31:0.00037%,33:0.00018%,26:0.00018%,23:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:91.99886%,Single Stage Single Point:8.00114%]
[INFO] ** dst:[21:43.35364%,10:20.94771%,8:18.17472%,9:17.52045%,15:0.00128%,22:0.0011%,18:0.00037%,24:0.00018%,19:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.9989%,0:0.0011%]
[INFO] ** i/f_name:[2:99.99872%,3:0.00128%]
[INFO] ** modbus_function_code:[0.02961:99.99762%,-33.760870000000004:0.00238%]
[INFO] ** modbus_function_description:[7:49.99982%,11:49.99781%,0:0.00238%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.9989%,2:0.0011%]
[INFO] ** proto:[0:99.99817%,1:0.00128%,2:0.00055%]
[INFO] ** proxy_src_ip:[18:38.26201%,20:26.03971%,13:18.17472%,6:17.52082%,17:0.00128%,21:0.00037%,16:0.00037%,14:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.03898%,-0.32151:20.94753%,-1.27613:18.17436%,-0.23351:17.52027%,-0.33484:17.31448%,-71.33197:0.00128%,1.45709:0.00037%,-0.08551:0.00037%,-0.24151:0.00037%,-1.02014:0.00037%,-1.2708:0.00018%,14.4699:0.00018%,4.44364:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:26.0388%,1:20.94734%,5:18.17436%,4:17.5199%,2:17.3143%,0:0.0053%]
[INFO] ** service:[0.0048200000000000005:99.99781%,-211.73542999999998:0.00128%,-186.43601999999998:0.00037%,-183.8612:0.00018%,-211.08346:0.00018%,-211.07873999999998:0.00018%]
[INFO] ** src:[22:38.26201%,9:26.03971%,7:18.17472%,1:17.52082%,21:0.0011%,15:0.00037%,4:0.00037%,17:0.00018%,14:0.00018%,8:0.00018%,3:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1496 (0.27341%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0101 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3272e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0066 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.1294e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0059 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.1218e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0055 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.6664e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2071 - tp: 39345.0000 - fp: 40655.0000 - tn: 279345.0000 - fn: 40655.0000 - accuracy: 0.7967 - precision: 0.4918 - recall: 0.4918 - auc: 0.8620 - val_loss: 0.5073 - val_tp: 16876.0000 - val_fp: 3124.0000 - val_tn: 76876.0000 - val_fn: 3124.0000 - val_accuracy: 0.9375 - val_precision: 0.8438 - val_recall: 0.8438 - val_auc: 0.9606
[INFO] saving weights to checkpoints/lstm-epoch-7-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 5-5/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99634%,30:0.00256%,37:0.00018%,26:0.00018%,12:0.00018%,9:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:89.70251%,Single Stage Single Point:10.29749%]
[INFO] ** dst:[21:43.36534%,10:20.76239%,8:18.2407%,9:17.62718%,15:0.00256%,22:0.00091%,25:0.00018%,24:0.00018%,6:0.00018%,2:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99781%,0:0.00219%]
[INFO] ** i/f_name:[2:99.99744%,3:0.00256%]
[INFO] ** modbus_function_code:[0.02961:99.99634%,-33.760870000000004:0.00366%]
[INFO] ** modbus_function_description:[7:49.99872%,11:49.99762%,0:0.00366%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.99799%,2:0.00201%]
[INFO] ** proto:[0:99.99708%,1:0.00256%,2:0.00037%]
[INFO] ** proxy_src_ip:[18:37.99884%,20:26.12908%,13:18.24088%,6:17.62736%,17:0.00256%,1:0.00037%,21:0.00018%,16:0.00018%,7:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.12853%,-0.32151:20.76203%,-1.27613:18.2407%,-0.23351:17.627%,-0.33484:17.23681%,-71.33197:0.00256%,-0.24151:0.00037%,1.45709:0.00037%,1.47576:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,2.22906:0.00018%,14.4699:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.12816%,1:20.76184%,5:18.24052%,4:17.627%,2:17.23681%,0:0.00567%]
[INFO] ** service:[0.0048200000000000005:99.99671%,-211.73542999999998:0.00256%,-183.8612:0.00018%,-211.08346:0.00018%,-211.35747999999998:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:37.99884%,9:26.12908%,7:18.24088%,1:17.62736%,21:0.00219%,14:0.00055%,3:0.00037%,16:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1497 (0.27359%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2804 - tp: 79407.0000 - fp: 593.0000 - tn: 319407.0000 - fn: 593.0000 - accuracy: 0.9970 - precision: 0.9926 - recall: 0.9926 - auc: 0.9981 - val_loss: 0.7883 - val_tp: 12798.0000 - val_fp: 7202.0000 - val_tn: 72798.0000 - val_fn: 7202.0000 - val_accuracy: 0.8560 - val_precision: 0.6399 - val_recall: 0.6399 - val_auc: 0.9246
[INFO] saving weights to checkpoints/lstm-epoch-7-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6968 - tp: 51358.0000 - fp: 28642.0000 - tn: 291358.0000 - fn: 28642.0000 - accuracy: 0.8568 - precision: 0.6420 - recall: 0.6420 - auc: 0.9305 - val_loss: 0.6292 - val_tp: 12799.0000 - val_fp: 7201.0000 - val_tn: 72799.0000 - val_fn: 7201.0000 - val_accuracy: 0.8560 - val_precision: 0.6399 - val_recall: 0.6399 - val_auc: 0.9567
[INFO] saving weights to checkpoints/lstm-epoch-7-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3564 - tp: 67293.0000 - fp: 12707.0000 - tn: 307293.0000 - fn: 12707.0000 - accuracy: 0.9365 - precision: 0.8412 - recall: 0.8412 - auc: 0.9772 - val_loss: 0.1088 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0804 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0236 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0055 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 6-6/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.9958%,30:0.00329%,31:0.00018%,27:0.00018%,26:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:92.61567%,Single Stage Single Point:7.38433%]
[INFO] ** dst:[21:43.37082%,10:20.73224%,8:18.28328%,9:17.60872%,15:0.00329%,22:0.00055%,25:0.00018%,24:0.00018%,18:0.00018%,12:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99689%,0:0.00311%]
[INFO] ** i/f_name:[2:99.99671%,3:0.00329%]
[INFO] ** modbus_function_code:[0.02961:99.9958%,-33.760870000000004:0.0042%]
[INFO] ** modbus_function_description:[7:49.99854%,11:49.99726%,0:0.0042%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.9958%,1:0.00329%,2:0.00091%]
[INFO] ** proxy_src_ip:[18:37.94109%,20:26.16216%,13:18.28346%,6:17.60891%,17:0.00329%,14:0.00055%,16:0.00037%,11:0.00018%]
[INFO] ** s_port:[1.45442:26.16179%,-0.32151:20.73224%,-1.27613:18.28292%,-0.23351:17.60854%,-0.33484:17.20885%,-71.33197:0.00329%,-1.02014:0.00037%,-71.14798:0.00018%,-64.19493:0.00018%,4.90362:0.00018%,-1.2708:0.00018%,-0.24151:0.00018%,13.431270000000001:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-68.36943000000001:0.00018%]
[INFO] ** scada_tag:[3:26.16161%,1:20.73187%,5:18.28273%,4:17.60817%,2:17.20867%,0:0.00694%]
[INFO] ** service:[0.0048200000000000005:99.9958%,-211.73542999999998:0.00329%,-211.08346:0.00018%,-201.23771000000002:0.00018%,-202.75898:0.00018%,-186.44547:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:37.94109%,9:26.16216%,7:18.28346%,1:17.60891%,14:0.00329%,2:0.00055%,15:0.00037%,10:0.00018%]
[INFO] ** type:[0:99.99909%,1:0.00091%]
[INFO] ** unixtime:1498 (0.27377%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0172 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0034 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0127 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0025 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0110 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0019 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0099 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0014 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4127 - tp: 64815.0000 - fp: 15185.0000 - tn: 304815.0000 - fn: 15185.0000 - accuracy: 0.9241 - precision: 0.8102 - recall: 0.8102 - auc: 0.9763 - val_loss: 0.2744 - val_tp: 14842.0000 - val_fp: 5158.0000 - val_tn: 74842.0000 - val_fn: 5158.0000 - val_accuracy: 0.8968 - val_precision: 0.7421 - val_recall: 0.7421 - val_auc: 0.9737
[INFO] saving weights to checkpoints/lstm-epoch-7-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 7-7/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99525%,30:0.00164%,22:0.00091%,17:0.00073%,26:0.00055%,31:0.00037%,28:0.00018%,27:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:81.10229%,Single Stage Single Point:18.89771%]
[INFO] ** dst:[21:43.35986%,10:20.74613%,8:18.25386%,9:17.63358%,15:0.00164%,22:0.00146%,6:0.00146%,16:0.00073%,24:0.00037%,18:0.00037%,17:0.00037%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99836%,0:0.00164%]
[INFO] ** i/f_name:[2:99.99836%,3:0.00164%]
[INFO] ** modbus_function_code:[0.02961:99.99525%,-33.760870000000004:0.00475%]
[INFO] ** modbus_function_description:[7:49.99836%,11:49.99689%,0:0.00475%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99634%,2:0.00201%,1:0.00164%]
[INFO] ** proxy_src_ip:[18:37.96905%,20:26.13767%,13:18.25422%,6:17.63376%,17:0.00164%,11:0.00073%,1:0.00073%,21:0.00055%,16:0.00055%,14:0.00037%,7:0.00037%,10:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13675%,-0.32151:20.74613%,-1.27613:18.25368%,-0.23351:17.63339%,-0.33484:17.22292%,-71.33197:0.00164%,-71.14931:0.00091%,-1.02014:0.00055%,-71.14798:0.00055%,1.45709:0.00055%,-0.24151:0.00037%,-1.27347:0.00037%,1.47576:0.00018%,1.46509:0.00018%,14.253910000000001:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,-68.79874000000001:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,6.1115699999999995:0.00018%,-5.08665:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:26.13639%,1:20.74613%,5:18.25349%,4:17.63321%,2:17.22292%,0:0.00786%]
[INFO] ** service:[0.0048200000000000005:99.99525%,-211.73542999999998:0.00164%,-211.08818:0.00091%,-205.44247:0.00073%,-211.08346:0.00055%,-186.43601999999998:0.00037%,-211.09762999999998:0.00018%,-185.9872:0.00018%,-202.75898:0.00018%]
[INFO] ** src:[22:37.96905%,9:26.13767%,7:18.25422%,1:17.63376%,14:0.00164%,10:0.00073%,3:0.00073%,15:0.00055%,4:0.00055%,21:0.00037%,2:0.00037%,11:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1495 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0797 - tp: 76383.0000 - fp: 3617.0000 - tn: 316383.0000 - fn: 3617.0000 - accuracy: 0.9819 - precision: 0.9548 - recall: 0.9548 - auc: 0.9990 - val_loss: 0.0075 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0326 - tp: 78663.0000 - fp: 1337.0000 - tn: 318663.0000 - fn: 1337.0000 - accuracy: 0.9933 - precision: 0.9833 - recall: 0.9833 - auc: 0.9998 - val_loss: 0.0024 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0265 - tp: 78965.0000 - fp: 1035.0000 - tn: 318965.0000 - fn: 1035.0000 - accuracy: 0.9948 - precision: 0.9871 - recall: 0.9871 - auc: 0.9999 - val_loss: 2.9865 - val_tp: 15776.0000 - val_fp: 4224.0000 - val_tn: 75776.0000 - val_fn: 4224.0000 - val_accuracy: 0.9155 - val_precision: 0.7888 - val_recall: 0.7888 - val_auc: 0.8824
[INFO] saving weights to checkpoints/lstm-epoch-7-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2927 - tp: 76587.0000 - fp: 3413.0000 - tn: 316587.0000 - fn: 3413.0000 - accuracy: 0.9829 - precision: 0.9573 - recall: 0.9573 - auc: 0.9869 - val_loss: 0.0117 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0194 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0042 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 8-8/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99708%,30:0.0011%,0:0.00055%,24:0.00018%,23:0.00018%,22:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.77715%,Single Stage Single Point:5.22285%]
[INFO] ** dst:[21:43.42474%,10:20.80571%,8:18.1835%,9:17.58241%,22:0.00128%,15:0.0011%,25:0.00055%,19:0.00037%,26:0.00018%,24:0.00018%]
[INFO] ** i/f_dir:[1:99.99927%,0:0.00073%]
[INFO] ** i/f_name:[2:99.9989%,3:0.0011%]
[INFO] ** modbus_function_code:[0.02961:99.99708%,-33.760870000000004:0.00274%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99963%,11:49.99744%,0:0.00274%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.99963%,2:0.00037%]
[INFO] ** proto:[0:99.99817%,1:0.0011%,2:0.00073%]
[INFO] ** proxy_src_ip:[18:38.09131%,20:26.13968%,13:18.18277%,6:17.58277%,17:0.0011%,10:0.0011%,16:0.00055%,14:0.00037%,11:0.00018%,5:0.00018%]
[INFO] ** s_port:[1.45442:26.13913%,-0.32151:20.80571%,-1.27613:18.18258%,-0.23351:17.58222%,-0.33484:17.28561%,-71.33197:0.0011%,-15.039579999999999:0.00073%,-1.02014:0.00055%,-64.19493:0.00055%,1.45709:0.00037%,-0.24151:0.00037%,4.66896:0.00037%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.13858%,1:20.80552%,5:18.18258%,4:17.58204%,2:17.28542%,0:0.00585%]
[INFO] ** service:[0.0048200000000000005:99.99781%,-211.73542999999998:0.0011%,-186.44547:0.00055%,-211.07873999999998:0.00037%,-211.08818:0.00018%]
[INFO] ** src:[22:38.09131%,9:26.13968%,7:18.18277%,1:17.58277%,11:0.0011%,14:0.00073%,15:0.00055%,21:0.00037%,2:0.00037%,16:0.00018%,10:0.00018%]
[INFO] ** type:[0:99.99945%,1:0.00037%,2:0.00018%]
[INFO] ** unixtime:1498 (0.27377%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0124 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0023 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0105 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0013 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0088 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.6055e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0075 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.8408 - val_tp: 18082.0000 - val_fp: 1918.0000 - val_tn: 78082.0000 - val_fn: 1918.0000 - val_accuracy: 0.9616 - val_precision: 0.9041 - val_recall: 0.9041 - val_auc: 0.9451
[INFO] saving weights to checkpoints/lstm-epoch-7-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4142 - tp: 65531.0000 - fp: 14469.0000 - tn: 305531.0000 - fn: 14469.0000 - accuracy: 0.9277 - precision: 0.8191 - recall: 0.8191 - auc: 0.9778 - val_loss: 0.2872 - val_tp: 16337.0000 - val_fp: 3663.0000 - val_tn: 76337.0000 - val_fn: 3663.0000 - val_accuracy: 0.9267 - val_precision: 0.8169 - val_recall: 0.8169 - val_auc: 0.9836
[INFO] saving weights to checkpoints/lstm-epoch-7-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 9-9/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99817%,30:0.0011%,31:0.00037%,26:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:94.88113%,Single Stage Single Point:5.11887%]
[INFO] ** dst:[21:43.37174%,10:20.77647%,8:18.27908%,9:17.5698%,15:0.0011%,22:0.00091%,18:0.00037%,25:0.00018%,24:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9989%,0:0.0011%]
[INFO] ** i/f_name:[2:99.9989%,3:0.0011%]
[INFO] ** modbus_function_code:[0.02961:99.99817%,-33.760870000000004:0.00183%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99799%,0:0.00183%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.99963%,2:0.00037%]
[INFO] ** proto:[0:99.99817%,1:0.0011%,2:0.00073%]
[INFO] ** proxy_src_ip:[18:38.01401%,20:26.13474%,13:18.27908%,6:17.57016%,17:0.0011%,21:0.00018%,16:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13401%,-0.32151:20.77647%,-1.27613:18.27871%,-0.23351:17.56961%,-0.33484:17.23754%,-71.33197:0.0011%,-0.24151:0.00037%,1.45709:0.00037%,-0.08551:0.00037%,1.46509:0.00018%,1.47576:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.13365%,1:20.77628%,5:18.27871%,4:17.56943%,2:17.23736%,0:0.00457%]
[INFO] ** service:[0.0048200000000000005:99.99817%,-211.73542999999998:0.0011%,-186.43601999999998:0.00037%,-211.08346:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.01401%,9:26.13474%,7:18.27908%,1:17.57016%,14:0.00073%,21:0.00037%,17:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1498 (0.27377%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2871 - tp: 65440.0000 - fp: 14560.0000 - tn: 305440.0000 - fn: 14560.0000 - accuracy: 0.9272 - precision: 0.8180 - recall: 0.8180 - auc: 0.9842 - val_loss: 0.2379 - val_tp: 16355.0000 - val_fp: 3645.0000 - val_tn: 76355.0000 - val_fn: 3645.0000 - val_accuracy: 0.9271 - val_precision: 0.8177 - val_recall: 0.8177 - val_auc: 0.9906
[INFO] saving weights to checkpoints/lstm-epoch-7-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1820 - tp: 70196.0000 - fp: 9804.0000 - tn: 310196.0000 - fn: 9804.0000 - accuracy: 0.9510 - precision: 0.8774 - recall: 0.8774 - auc: 0.9929 - val_loss: 0.1070 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0362 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0017 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0179 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.0165e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0145 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5614e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 10-10/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99616%,30:0.00183%,31:0.00037%,26:0.00018%,24:0.00018%,23:0.00018%,22:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:94.41693%,Single Stage Single Point:5.58307%]
[INFO] ** dst:[21:43.41505%,10:20.80772%,8:18.22425%,9:17.54896%,15:0.00183%,22:0.00055%,24:0.00037%,19:0.00037%,18:0.00037%,26:0.00018%,25:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99836%,0:0.00164%]
[INFO] ** i/f_name:[2:99.99817%,3:0.00183%]
[INFO] ** modbus_function_code:[0.02961:99.99616%,-33.760870000000004:0.00366%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.9989%,11:49.99726%,0:0.00366%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.99927%,1:0.00073%]
[INFO] ** proto:[0:99.99726%,1:0.00183%,2:0.00091%]
[INFO] ** proxy_src_ip:[18:38.0904%,20:26.13292%,13:18.22443%,6:17.54823%,17:0.00183%,10:0.00091%,14:0.00037%,21:0.00018%,16:0.00018%,5:0.00018%,2:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13219%,-0.32151:20.80772%,-1.27613:18.22389%,-0.23351:17.54786%,-0.33484:17.28268%,-71.33197:0.00183%,-10.51843:0.00073%,-0.08551:0.00037%,-1.27347:0.00037%,5.71692:0.00037%,1.47576:0.00037%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-71.14931:0.00018%,-64.19493:0.00018%,1.45709:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.13182%,1:20.80753%,5:18.22389%,4:17.54768%,2:17.2825%,0:0.00658%]
[INFO] ** service:[0.0048200000000000005:99.99689%,-211.73542999999998:0.00183%,-211.07873999999998:0.00037%,-186.43601999999998:0.00037%,-211.08346:0.00018%,-186.44547:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.0904%,9:26.13292%,7:18.22443%,1:17.54823%,14:0.00183%,11:0.00091%,2:0.00037%,17:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%]
[INFO] ** type:[0:99.99854%,1:0.00128%,2:0.00018%]
[INFO] ** unixtime:1495 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0126 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2607e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0107 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.8137e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4566 - tp: 60965.0000 - fp: 19035.0000 - tn: 300965.0000 - fn: 19035.0000 - accuracy: 0.9048 - precision: 0.7621 - recall: 0.7621 - auc: 0.9694 - val_loss: 0.2631 - val_tp: 12876.0000 - val_fp: 7124.0000 - val_tn: 72876.0000 - val_fn: 7124.0000 - val_accuracy: 0.8575 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.9683
[INFO] saving weights to checkpoints/lstm-epoch-7-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2152 - tp: 75610.0000 - fp: 4390.0000 - tn: 315610.0000 - fn: 4390.0000 - accuracy: 0.9780 - precision: 0.9451 - recall: 0.9451 - auc: 0.9948 - val_loss: 0.1350 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0964 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0470 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 11-11/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.9989%,31:0.00037%,30:0.00037%,26:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.38928%,10:20.87314%,8:18.1994%,9:17.5358%,22:0.00128%,18:0.00037%,15:0.00037%,25:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99963%,3:0.00037%]
[INFO] ** modbus_function_code:[0.02961:99.9989%,-33.760870000000004:0.0011%]
[INFO] ** modbus_function_description:[7:50.00073%,11:49.99817%,0:0.0011%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9989%,2:0.00073%,1:0.00037%]
[INFO] ** proxy_src_ip:[18:38.14596%,20:26.11683%,13:18.1994%,6:17.53617%,16:0.00055%,17:0.00037%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.11629%,-0.32151:20.87314%,-1.27613:18.19921%,-0.23351:17.53562%,-0.33484:17.27281%,-0.24151:0.00055%,-1.02014:0.00055%,-0.08551:0.00037%,-71.33197:0.00037%,-71.14798:0.00018%,1.45709:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:26.11592%,1:20.87314%,5:18.19903%,4:17.53525%,2:17.27263%,0:0.00402%]
[INFO] ** service:[0.0048200000000000005:99.9989%,-211.73542999999998:0.00037%,-186.43601999999998:0.00037%,-211.08346:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.14596%,9:26.11683%,7:18.1994%,1:17.53617%,15:0.00055%,14:0.00037%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1496 (0.27341%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0248 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0025 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0116 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.8199e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0093 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2866e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0081 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0297e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0073 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3370e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 12-12/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99781%,30:0.00201%,9:0.00018%]
[INFO] ** classification:[normal:93.38581%,Single Stage Single Point:6.61419%]
[INFO] ** dst:[21:43.39623%,10:20.88228%,8:18.18496%,9:17.53343%,15:0.00201%,22:0.00055%,24:0.00037%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99836%,0:0.00164%]
[INFO] ** i/f_name:[2:99.99799%,3:0.00201%]
[INFO] ** modbus_function_code:[0.02961:99.99781%,-33.760870000000004:0.00219%]
[INFO] ** modbus_function_description:[7:49.99963%,11:49.99817%,0:0.00219%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.99836%,2:0.00164%]
[INFO] ** proto:[0:99.99799%,1:0.00201%]
[INFO] ** proxy_src_ip:[18:38.15235%,20:26.12652%,13:18.18514%,6:17.53361%,17:0.00201%,16:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:26.12597%,-0.32151:20.88228%,-1.27613:18.18459%,-0.23351:17.53324%,-0.33484:17.27007%,-71.33197:0.00201%,-1.27347:0.00037%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:26.12561%,1:20.88228%,5:18.18459%,4:17.53288%,2:17.27007%,0:0.00457%]
[INFO] ** service:[0.0048200000000000005:99.99781%,-211.73542999999998:0.00201%,-183.8612:0.00018%]
[INFO] ** src:[22:38.15235%,9:26.12652%,7:18.18514%,1:17.53361%,21:0.00164%,14:0.00037%,15:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1496 (0.27341%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0061 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.3817e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0053 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8749e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4236 - tp: 65142.0000 - fp: 14858.0000 - tn: 305142.0000 - fn: 14858.0000 - accuracy: 0.9257 - precision: 0.8143 - recall: 0.8143 - auc: 0.9774 - val_loss: 0.3250 - val_tp: 13828.0000 - val_fp: 6172.0000 - val_tn: 73828.0000 - val_fn: 6172.0000 - val_accuracy: 0.8766 - val_precision: 0.6914 - val_recall: 0.6914 - val_auc: 0.9690
[INFO] saving weights to checkpoints/lstm-epoch-7-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2672 - tp: 65935.0000 - fp: 14065.0000 - tn: 305935.0000 - fn: 14065.0000 - accuracy: 0.9297 - precision: 0.8242 - recall: 0.8242 - auc: 0.9843 - val_loss: 0.2122 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1027 - tp: 79779.0000 - fp: 221.0000 - tn: 319779.0000 - fn: 221.0000 - accuracy: 0.9989 - precision: 0.9972 - recall: 0.9972 - auc: 1.0000 - val_loss: 0.0616 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 13-13/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99653%,31:0.00073%,26:0.00055%,0:0.00055%,30:0.00037%,22:0.00037%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:86.01665%,Single Stage Single Point:13.98335%]
[INFO] ** dst:[21:43.35401%,10:20.80571%,8:18.2789%,9:17.55737%,22:0.0011%,6:0.00091%,18:0.00073%,25:0.00055%,15:0.00037%,24:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99963%,3:0.00037%]
[INFO] ** modbus_function_code:[0.02961:99.99653%,-33.760870000000004:0.00329%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.9989%,11:49.99762%,0:0.00329%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99726%,2:0.00238%,1:0.00037%]
[INFO] ** proxy_src_ip:[18:38.05239%,20:26.1077%,13:18.27908%,6:17.55682%,10:0.0011%,11:0.00091%,16:0.00055%,17:0.00037%,7:0.00037%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.10715%,-0.32151:20.80571%,-1.27613:18.27871%,-0.23351:17.55645%,-0.33484:17.24668%,-9.78512:0.00073%,-64.19493:0.00055%,-1.02014:0.00055%,-71.14798:0.00055%,-0.24151:0.00037%,-71.14931:0.00037%,-0.08551:0.00037%,-71.33197:0.00037%,1.47576:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,-68.79874000000001:0.00018%,6.1115699999999995:0.00018%,14.540560000000001:0.00018%,1.45709:0.00018%]
[INFO] ** scada_tag:[3:26.10678%,1:20.80552%,5:18.27871%,4:17.55645%,2:17.2465%,0:0.00603%]
[INFO] ** service:[0.0048200000000000005:99.99726%,-186.43601999999998:0.00073%,-211.08346:0.00055%,-186.44547:0.00055%,-211.73542999999998:0.00037%,-211.08818:0.00037%,-202.75898:0.00018%]
[INFO] ** src:[22:38.05239%,9:26.1077%,7:18.27908%,1:17.55682%,11:0.0011%,10:0.00091%,15:0.00055%,21:0.00037%,14:0.00037%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1495 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0394 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0276 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0168 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0024 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0065 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.9855e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4388 - tp: 63451.0000 - fp: 16549.0000 - tn: 303451.0000 - fn: 16549.0000 - accuracy: 0.9173 - precision: 0.7931 - recall: 0.7931 - auc: 0.9774 - val_loss: 0.3097 - val_tp: 13739.0000 - val_fp: 6261.0000 - val_tn: 73739.0000 - val_fn: 6261.0000 - val_accuracy: 0.8748 - val_precision: 0.6870 - val_recall: 0.6870 - val_auc: 0.9694
[INFO] saving weights to checkpoints/lstm-epoch-7-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1423 - tp: 72139.0000 - fp: 7861.0000 - tn: 312139.0000 - fn: 7861.0000 - accuracy: 0.9607 - precision: 0.9017 - recall: 0.9017 - auc: 0.9965 - val_loss: 0.0058 - val_tp: 19996.0000 - val_fp: 4.0000 - val_tn: 79996.0000 - val_fn: 4.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-7-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 14-14/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99963%,30:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:93.73049%,Single Stage Single Point:6.26951%]
[INFO] ** dst:[21:43.34633%,10:20.81283%,8:18.2661%,9:17.57327%,22:0.00073%,24:0.00037%,15:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.99982%,3:0.00018%]
[INFO] ** modbus_function_code:[0.02961:99.99963%,-33.760870000000004:0.00037%]
[INFO] ** modbus_function_description:[7:50.00073%,11:49.9989%,0:0.00037%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,1:0.00018%]
[INFO] ** proxy_src_ip:[18:38.05257%,20:26.10715%,13:18.26629%,6:17.57345%,17:0.00018%,16:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:26.10642%,-0.32151:20.81283%,-1.27613:18.26574%,-0.23351:17.57308%,-0.33484:17.23973%,-1.27347:0.00037%,1.45709:0.00037%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%,-71.33197:0.00018%]
[INFO] ** scada_tag:[3:26.10605%,1:20.81283%,5:18.26555%,4:17.57272%,2:17.23955%,0:0.00329%]
[INFO] ** service:[0.0048200000000000005:99.99963%,-183.8612:0.00018%,-211.73542999999998:0.00018%]
[INFO] ** src:[22:38.05257%,9:26.10715%,7:18.26629%,1:17.57345%,15:0.00018%,14:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1495 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0962 - tp: 73510.0000 - fp: 6490.0000 - tn: 313510.0000 - fn: 6490.0000 - accuracy: 0.9675 - precision: 0.9189 - recall: 0.9189 - auc: 0.9979 - val_loss: 0.5351 - val_tp: 18481.0000 - val_fp: 1519.0000 - val_tn: 78481.0000 - val_fn: 1519.0000 - val_accuracy: 0.9696 - val_precision: 0.9240 - val_recall: 0.9240 - val_auc: 0.9589
[INFO] saving weights to checkpoints/lstm-epoch-7-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2368 - tp: 77094.0000 - fp: 2906.0000 - tn: 317094.0000 - fn: 2906.0000 - accuracy: 0.9855 - precision: 0.9637 - recall: 0.9637 - auc: 0.9914 - val_loss: 0.0561 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0452 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0063 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0180 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.8087e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0103 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1772e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 15-15/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99616%,30:0.00311%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:89.90628%,Single Stage Multi Point:10.09299%,Single Stage Single Point:0.00073%]
[INFO] ** dst:[21:43.30174%,10:20.77555%,8:18.31362%,9:17.60379%,15:0.00311%,22:0.00146%,25:0.00018%,24:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99708%,0:0.00292%]
[INFO] ** i/f_name:[2:99.99689%,3:0.00311%]
[INFO] ** modbus_function_code:[0.02961:99.99616%,-33.760870000000004:0.00384%]
[INFO] ** modbus_function_description:[7:49.9989%,11:49.99726%,0:0.00384%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.99726%,2:0.00274%]
[INFO] ** proto:[0:99.99653%,1:0.00311%,2:0.00037%]
[INFO] ** proxy_src_ip:[18:38.0098%,20:26.06804%,13:18.31344%,6:17.60434%,17:0.00311%,16:0.00055%,7:0.00037%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.06731%,-0.32151:20.77537%,-1.27613:18.31325%,-0.23351:17.60361%,-0.33484:17.23443%,-71.33197:0.00311%,-0.24151:0.00055%,-1.02014:0.00055%,1.45709:0.00037%,1.46509:0.00018%,1.47576:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-61.95768:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.06694%,1:20.77519%,5:18.31325%,4:17.60324%,2:17.23425%,0:0.00713%]
[INFO] ** service:[0.0048200000000000005:99.99634%,-211.73542999999998:0.00311%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.0098%,9:26.06804%,7:18.31344%,1:17.60434%,21:0.00311%,15:0.00055%,14:0.00037%,16:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1504 (0.27487%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0078 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.8250e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0068 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.9339e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0060 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.5530e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0056 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3796e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.7932 - tp: 56227.0000 - fp: 23773.0000 - tn: 296227.0000 - fn: 23773.0000 - accuracy: 0.8811 - precision: 0.7028 - recall: 0.7028 - auc: 0.8118 - val_loss: 7.5248 - val_tp: 10663.0000 - val_fp: 9337.0000 - val_tn: 70663.0000 - val_fn: 9337.0000 - val_accuracy: 0.8133 - val_precision: 0.5332 - val_recall: 0.5332 - val_auc: 0.7082
[INFO] saving weights to checkpoints/lstm-epoch-7-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 16-16/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (486862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (486862, 17)

[INFO] analyzing data
[INFO] 486862 rows
[INFO] ** appi_name:[21:99.99836%,30:0.00144%,33:0.00021%]
[INFO] ** classification:[normal:81.3859%,Single Stage Multi Point:18.6141%]
[INFO] ** dst:[21:43.35397%,10:20.79747%,8:18.25445%,9:17.59123%,15:0.00144%,22:0.00123%,24:0.00021%]
[INFO] ** i/f_dir:[1:99.99856%,0:0.00144%]
[INFO] ** i/f_name:[2:99.99856%,3:0.00144%]
[INFO] ** modbus_function_code:[0.02961:99.99836%,-33.760870000000004:0.00164%]
[INFO] ** modbus_function_description:[7:50.00041%,11:49.99795%,0:0.00164%]
[INFO] ** modbus_transaction_id:65536 (13.4609%)
[INFO] ** orig:[0:99.99856%,2:0.00144%]
[INFO] ** proto:[0:99.99856%,1:0.00144%]
[INFO] ** proxy_src_ip:[18:38.0463%,20:26.10534%,13:18.25486%,6:17.59143%,17:0.00144%,16:0.00041%,21:0.00021%]
[INFO] ** s_port:[1.45442:26.10473%,-0.32151:20.79727%,-1.27613:18.25445%,-0.23351:17.59102%,-0.33484:17.24904%,-71.33197:0.00144%,1.45709:0.00041%,-0.24151:0.00041%,-1.02014:0.00041%,-1.27347:0.00021%,1.47576:0.00021%,-49.275529999999996:0.00021%,-1.2708:0.00021%]
[INFO] ** scada_tag:[3:26.10432%,1:20.79727%,5:18.25425%,4:17.59061%,2:17.24883%,0:0.00472%]
[INFO] ** service:[0.0048200000000000005:99.99856%,-211.73542999999998:0.00144%]
[INFO] ** src:[22:38.0463%,9:26.10534%,7:18.25486%,1:17.59143%,21:0.00144%,15:0.00041%,4:0.00021%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1332 (0.27359%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/486862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5693 - tp: 42444.0000 - fp: 37556.0000 - tn: 282444.0000 - fn: 37556.0000 - accuracy: 0.8122 - precision: 0.5306 - recall: 0.5306 - auc: 0.7036 - val_loss: 7.5183 - val_tp: 10671.0000 - val_fp: 9329.0000 - val_tn: 70671.0000 - val_fn: 9329.0000 - val_accuracy: 0.8134 - val_precision: 0.5336 - val_recall: 0.5336 - val_auc: 0.7085
[INFO] saving weights to checkpoints/lstm-epoch-7-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/486862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5579 - tp: 42500.0000 - fp: 37500.0000 - tn: 282500.0000 - fn: 37500.0000 - accuracy: 0.8125 - precision: 0.5312 - recall: 0.5312 - auc: 0.7040 - val_loss: 5.0289 - val_tp: 13760.0000 - val_fp: 6240.0000 - val_tn: 73760.0000 - val_fn: 6240.0000 - val_accuracy: 0.8752 - val_precision: 0.6880 - val_recall: 0.6880 - val_auc: 0.8050
[INFO] saving weights to checkpoints/lstm-epoch-7-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/486862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0043 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.6853e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/486862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0040 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8377e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/486862
[33m[INFO] loading file 17-17/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (586862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (586862, 17)

[INFO] analyzing data
[INFO] 586862 rows
[INFO] ** appi_name:[21:99.99727%,7:0.00051%,26:0.00034%,0:0.00034%,33:0.00017%,31:0.00017%,27:0.00017%,24:0.00017%,22:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:94.74323%,Multi Stage Multi Point:5.25677%]
[INFO] ** dst:[21:43.3521%,10:20.83744%,8:18.20922%,9:17.59835%,22:0.00085%,6:0.00051%,25:0.00034%,16:0.00034%,2:0.00034%,24:0.00017%,18:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99727%,-33.760870000000004:0.00256%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99966%,11:49.99761%,0:0.00256%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.16719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99881%,2:0.00119%]
[INFO] ** proxy_src_ip:[18:38.07437%,20:26.11585%,13:18.20871%,6:17.59817%,10:0.00102%,11:0.00085%,1:0.00034%,21:0.00017%,16:0.00017%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:26.11483%,-0.32151:20.83727%,-1.27613:18.20837%,-0.23351:17.598%,-0.33484:17.2371%,6.0369:0.00068%,1.45709:0.00051%,1.47576:0.00034%,-71.14798:0.00034%,-64.19493:0.00034%,1.46509:0.00017%,-49.275529999999996:0.00017%,-1.27347:0.00017%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,-68.79874000000001:0.00017%,6.15557:0.00017%,6.06224:0.00017%,8.55414:0.00017%,-3.3787199999999995:0.00017%,-4.3880099999999995:0.00017%,-71.14931:0.00017%]
[INFO] ** scada_tag:[3:26.11466%,1:20.8371%,5:18.2082%,4:17.59749%,2:17.2371%,0:0.00545%]
[INFO] ** service:[0.0048200000000000005:99.99813%,-211.09762999999998:0.00051%,-211.08346:0.00034%,-186.44547:0.00034%,-211.35747999999998:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.07437%,9:26.11585%,7:18.20871%,1:17.59817%,11:0.00102%,10:0.00085%,3:0.00034%,21:0.00017%,15:0.00017%,4:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1603 (0.27315%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0038 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4081e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0032 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9109e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0031 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9541e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5660 - tp: 77204.0000 - fp: 2796.0000 - tn: 317204.0000 - fn: 2796.0000 - accuracy: 0.9860 - precision: 0.9650 - recall: 0.9650 - auc: 0.9780 - val_loss: 2.9262 - val_tp: 16369.0000 - val_fp: 3631.0000 - val_tn: 76369.0000 - val_fn: 3631.0000 - val_accuracy: 0.9274 - val_precision: 0.8184 - val_recall: 0.8184 - val_auc: 0.8865
[INFO] saving weights to checkpoints/lstm-epoch-7-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9293 - tp: 65471.0000 - fp: 14529.0000 - tn: 305471.0000 - fn: 14529.0000 - accuracy: 0.9274 - precision: 0.8184 - recall: 0.8184 - auc: 0.8858 - val_loss: 2.9061 - val_tp: 16394.0000 - val_fp: 3606.0000 - val_tn: 76394.0000 - val_fn: 3606.0000 - val_accuracy: 0.9279 - val_precision: 0.8197 - val_recall: 0.8197 - val_auc: 0.8873
[INFO] saving weights to checkpoints/lstm-epoch-7-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/586862
[33m[INFO] loading file 18-18/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (586862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (586862, 17)

[INFO] analyzing data
[INFO] 586862 rows
[INFO] ** appi_name:[21:99.9983%,30:0.00051%,7:0.00051%,31:0.00017%,27:0.00017%,22:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:82.40029%,Multi Stage Multi Point:17.59971%]
[INFO] ** dst:[21:43.34154%,10:20.83403%,8:18.25421%,9:17.5675%,22:0.00068%,15:0.00051%,24:0.00034%,16:0.00034%,2:0.00034%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99949%,0:0.00051%]
[INFO] ** i/f_name:[2:99.99949%,3:0.00051%]
[INFO] ** modbus_function_code:[0.02961:99.9983%,-33.760870000000004:0.0017%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.9983%,0:0.0017%]
[INFO] ** modbus_transaction_id:65536 (11.16719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99898%,2:0.00051%,1:0.00051%]
[INFO] ** proxy_src_ip:[18:38.0834%,20:26.09268%,13:18.25455%,6:17.56767%,17:0.00051%,11:0.00051%,1:0.00034%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:26.09199%,-0.32151:20.83403%,-1.27613:18.25404%,-0.23351:17.56733%,-0.33484:17.24937%,-71.33197:0.00051%,-1.27347:0.00034%,1.45709:0.00034%,-0.24151:0.00034%,1.47576:0.00017%,1.46509:0.00017%,3.6236699999999997:0.00017%,-1.2708:0.00017%,-2.48275:0.00017%,6.06224:0.00017%,-3.3787199999999995:0.00017%,8.10082:0.00017%,6.45955:0.00017%,-71.14931:0.00017%]
[INFO] ** scada_tag:[3:26.09165%,1:20.83386%,5:18.25387%,4:17.56716%,2:17.2492%,0:0.00426%]
[INFO] ** service:[0.0048200000000000005:99.9983%,-211.09762999999998:0.00051%,-211.73542999999998:0.00051%,-211.35747999999998:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.0834%,9:26.09268%,7:18.25455%,1:17.56767%,14:0.00051%,10:0.00051%,3:0.00034%,21:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1603 (0.27315%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2690 - tp: 73712.0000 - fp: 6288.0000 - tn: 313712.0000 - fn: 6288.0000 - accuracy: 0.9686 - precision: 0.9214 - recall: 0.9214 - auc: 0.9505 - val_loss: 8.1289e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.6331 - tp: 52048.0000 - fp: 27952.0000 - tn: 292048.0000 - fn: 27952.0000 - accuracy: 0.8602 - precision: 0.6506 - recall: 0.6506 - auc: 0.7801 - val_loss: 6.1152 - val_tp: 12412.0000 - val_fp: 7588.0000 - val_tn: 72412.0000 - val_fn: 7588.0000 - val_accuracy: 0.8482 - val_precision: 0.6206 - val_recall: 0.6206 - val_auc: 0.7629
[INFO] saving weights to checkpoints/lstm-epoch-7-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1401 - tp: 49531.0000 - fp: 30469.0000 - tn: 289531.0000 - fn: 30469.0000 - accuracy: 0.8477 - precision: 0.6191 - recall: 0.6191 - auc: 0.7602 - val_loss: 6.1007 - val_tp: 12430.0000 - val_fp: 7570.0000 - val_tn: 72430.0000 - val_fn: 7570.0000 - val_accuracy: 0.8486 - val_precision: 0.6215 - val_recall: 0.6215 - val_auc: 0.7634
[INFO] saving weights to checkpoints/lstm-epoch-7-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.7197 - tp: 56581.0000 - fp: 23419.0000 - tn: 296581.0000 - fn: 23419.0000 - accuracy: 0.8829 - precision: 0.7073 - recall: 0.7073 - auc: 0.8157 - val_loss: 4.3451e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0017 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5963e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/586862
[33m[INFO] loading file 19-19/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (586862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (586862, 17)

[INFO] analyzing data
[INFO] 586862 rows
[INFO] ** appi_name:[21:99.99813%,26:0.00034%,0:0.00034%,31:0.00017%,27:0.00017%,24:0.00017%,22:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:87.80633%,Single Stage Multi Point:12.19367%]
[INFO] ** dst:[21:43.38874%,10:20.82943%,8:18.20769%,9:17.57159%,22:0.00119%,6:0.00051%,25:0.00034%,24:0.00017%,18:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99813%,-33.760870000000004:0.0017%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99813%,0:0.0017%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.16719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99881%,2:0.00119%]
[INFO] ** proxy_src_ip:[18:38.11782%,20:26.10051%,13:18.20769%,6:17.57159%,10:0.00102%,11:0.00085%,16:0.00051%]
[INFO] ** s_port:[1.45442:26.09949%,-0.32151:20.82943%,-1.27613:18.20735%,-0.23351:17.57142%,-0.33484:17.28839%,-5.20264:0.00068%,1.45709:0.00051%,-1.02014:0.00051%,-64.19493:0.00034%,-71.14798:0.00034%,1.46509:0.00034%,-1.27347:0.00017%,-0.24151:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-71.14931:0.00017%,-68.79874000000001:0.00017%,0.75578:0.00017%]
[INFO] ** scada_tag:[3:26.09915%,1:20.82926%,5:18.20718%,4:17.57125%,2:17.28822%,0:0.00494%]
[INFO] ** service:[0.0048200000000000005:99.99881%,-211.08346:0.00034%,-186.44547:0.00034%,-202.75898:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.11782%,9:26.10051%,7:18.20769%,1:17.57159%,11:0.00102%,10:0.00085%,15:0.00051%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1605 (0.27349%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0015 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7185e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0013 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4794e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0012 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1542e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0011 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9305e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.6331 - tp: 37153.0000 - fp: 42847.0000 - tn: 277153.0000 - fn: 42847.0000 - accuracy: 0.7858 - precision: 0.4644 - recall: 0.4644 - auc: 0.6631 - val_loss: 9.8474 - val_tp: 7781.0000 - val_fp: 12219.0000 - val_tn: 67781.0000 - val_fn: 12219.0000 - val_accuracy: 0.7556 - val_precision: 0.3891 - val_recall: 0.3891 - val_auc: 0.6182
[INFO] saving weights to checkpoints/lstm-epoch-7-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/586862
[33m[INFO] loading file 20-20/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (586862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (586862, 17)

[INFO] analyzing data
[INFO] 586862 rows
[INFO] ** appi_name:[21:99.99676%,30:0.00273%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:90.20673%,Single Stage Multi Point:9.79327%]
[INFO] ** dst:[21:43.42827%,10:20.83659%,8:18.15418%,9:17.57619%,15:0.00273%,22:0.00119%,24:0.00034%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99761%,0:0.00239%]
[INFO] ** i/f_name:[2:99.99727%,3:0.00273%]
[INFO] ** modbus_function_code:[0.02961:99.99676%,-33.760870000000004:0.00324%]
[INFO] ** modbus_function_description:[7:49.99966%,11:49.9971%,0:0.00324%]
[INFO] ** modbus_transaction_id:65536 (11.16719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99676%,1:0.00273%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.11595%,20:26.14959%,13:18.15435%,6:17.5767%,17:0.00273%,14:0.00051%,16:0.00017%]
[INFO] ** s_port:[1.45442:26.14874%,-0.32151:20.83659%,-1.27613:18.15384%,-0.23351:17.57602%,-0.33484:17.27936%,-71.33197:0.00273%,1.45709:0.00051%,-0.24151:0.00051%,-1.27347:0.00034%,13.431270000000001:0.00017%,-1.2708:0.00017%,-1.02014:0.00017%,-71.14798:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:26.14823%,1:20.83641%,5:18.15384%,4:17.57568%,2:17.27919%,0:0.00665%]
[INFO] ** service:[0.0048200000000000005:99.99676%,-211.73542999999998:0.00273%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.11595%,9:26.14959%,7:18.15435%,1:17.5767%,14:0.00273%,2:0.00051%,15:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1604 (0.27332%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.3238 - tp: 63506.0000 - fp: 16494.0000 - tn: 303506.0000 - fn: 16494.0000 - accuracy: 0.9175 - precision: 0.7938 - recall: 0.7938 - auc: 0.8703 - val_loss: 1.5649e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3071 - tp: 73516.0000 - fp: 6484.0000 - tn: 313516.0000 - fn: 6484.0000 - accuracy: 0.9676 - precision: 0.9190 - recall: 0.9190 - auc: 0.9490 - val_loss: 2.9561 - val_tp: 16332.0000 - val_fp: 3668.0000 - val_tn: 76332.0000 - val_fn: 3668.0000 - val_accuracy: 0.9266 - val_precision: 0.8166 - val_recall: 0.8166 - val_auc: 0.8854
[INFO] saving weights to checkpoints/lstm-epoch-7-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9458 - tp: 65382.0000 - fp: 14618.0000 - tn: 305382.0000 - fn: 14618.0000 - accuracy: 0.9269 - precision: 0.8173 - recall: 0.8173 - auc: 0.8850 - val_loss: 2.9585 - val_tp: 16329.0000 - val_fp: 3671.0000 - val_tn: 76329.0000 - val_fn: 3671.0000 - val_accuracy: 0.9266 - val_precision: 0.8164 - val_recall: 0.8164 - val_auc: 0.8853
[INFO] saving weights to checkpoints/lstm-epoch-7-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.5266 - tp: 67462.0000 - fp: 12538.0000 - tn: 307462.0000 - fn: 12538.0000 - accuracy: 0.9373 - precision: 0.8433 - recall: 0.8433 - auc: 0.9014 - val_loss: 1.4279e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.4371e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3516e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/586862
[33m[INFO] loading file 21-21/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (586860, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (586860, 17)

[INFO] analyzing data
[INFO] 586860 rows
[INFO] ** appi_name:[21:99.99625%,30:0.00102%,7:0.00051%,26:0.00034%,22:0.00034%,0:0.00034%,31:0.00017%,27:0.00017%,24:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:98.96006%,Multi Stage Single Point:1.03994%]
[INFO] ** dst:[21:43.32686%,10:20.97638%,8:18.16055%,9:17.53161%,15:0.00102%,22:0.00085%,24:0.00068%,6:0.00068%,25:0.00034%,16:0.00034%,2:0.00034%,18:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.99898%,0:0.00102%]
[INFO] ** i/f_name:[2:99.99898%,3:0.00102%]
[INFO] ** modbus_function_code:[0.02961:99.99625%,-33.760870000000004:0.00358%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99915%,11:49.9971%,0:0.00358%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.16723%)
[INFO] ** orig:[0:99.99932%,2:0.00068%]
[INFO] ** proto:[0:99.99761%,2:0.00136%,1:0.00102%]
[INFO] ** proxy_src_ip:[18:38.30624%,20:25.99683%,13:18.16123%,6:17.53144%,17:0.00102%,10:0.00102%,11:0.00085%,16:0.00051%,1:0.00034%,21:0.00017%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.99615%,-0.32151:20.9757%,-1.27613:18.16038%,-0.23351:17.53127%,-0.33484:17.33054%,-71.33197:0.00102%,-1.27347:0.00068%,-6.64392:0.00068%,-1.02014:0.00051%,-64.19493:0.00034%,-71.14931:0.00034%,-71.14798:0.00034%,1.47576:0.00034%,1.46509:0.00017%,-1.2708:0.00017%,6.62488:0.00017%,10.15141:0.00017%,-68.79874000000001:0.00017%,7.060860000000001:0.00017%,-3.3787199999999995:0.00017%,-2.2440900000000004:0.00017%,1.45709:0.00017%,-0.24151:0.00017%]
[INFO] ** scada_tag:[3:25.99564%,1:20.97553%,5:18.16021%,4:17.53093%,2:17.33054%,0:0.00716%]
[INFO] ** service:[0.0048200000000000005:99.99693%,-211.73542999999998:0.00102%,-211.09762999999998:0.00051%,-211.08346:0.00034%,-186.44547:0.00034%,-211.08818:0.00034%,-211.35747999999998:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.30624%,9:25.99683%,7:18.16123%,1:17.53144%,11:0.00102%,21:0.00085%,10:0.00085%,15:0.00051%,14:0.00034%,3:0.00034%,4:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1599 (0.27247%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/586860
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.7369e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2996e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/586860
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.2470e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2902e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/586860
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.8647e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2426e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/586860
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.3693e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2335e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/586860
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.8604e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1924e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/586860
[33m[INFO] loading file 22-22/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (355901, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (355901, 17)

[INFO] analyzing data
[INFO] 355901 rows
[INFO] ** appi_name:[21:99.99269%,30:0.00646%,23:0.00028%,22:0.00028%,18:0.00028%]
[INFO] ** classification:[normal:62.75593%,Multi Stage Single Point:37.24407%]
[INFO] ** dst:[21:43.31851%,10:21.00612%,8:18.09717%,9:17.56977%,15:0.00646%,22:0.00112%,19:0.00056%,26:0.00028%]
[INFO] ** i/f_dir:[1:99.99382%,0:0.00618%]
[INFO] ** i/f_name:[2:99.99354%,3:0.00618%,0:0.00028%]
[INFO] ** modbus_function_code:[0.02961:99.99269%,-33.760870000000004:0.00731%]
[INFO] ** modbus_function_description:[7:49.99705%,11:49.99564%,0:0.00731%]
[INFO] ** modbus_transaction_id:65534 (18.41355%)
[INFO] ** orig:[0:99.99494%,2:0.0045%,1:0.00056%]
[INFO] ** proto:[0:99.99326%,1:0.00646%,2:0.00028%]
[INFO] ** proxy_src_ip:[18:38.33313%,20:25.99234%,13:18.09661%,6:17.57062%,17:0.00646%,14:0.00056%,10:0.00028%]
[INFO] ** s_port:[1.45442:25.9915%,-0.32151:21.00612%,-1.27613:18.09661%,-0.23351:17.56977%,-0.33484:17.32701%,-71.33197:0.00646%,1.45709:0.00056%,-0.24151:0.00056%,7.228860000000001:0.00056%,-0.24950999999999998:0.00028%,1.46509:0.00028%,-71.14931:0.00028%]
[INFO] ** scada_tag:[3:25.99122%,1:21.00612%,5:18.09661%,4:17.56949%,2:17.32701%,0:0.00955%]
[INFO] ** service:[0.0048200000000000005:99.99269%,-211.73542999999998:0.00646%,-211.07873999999998:0.00056%,-211.08818:0.00028%]
[INFO] ** src:[22:38.33313%,9:25.99234%,7:18.09661%,1:17.57062%,21:0.0045%,14:0.00197%,2:0.00056%,11:0.00028%]
[INFO] ** type:[0:99.99831%,1:0.00169%]
[INFO] ** unixtime:983 (0.2762%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/355901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5819 - tp: 77113.0000 - fp: 2887.0000 - tn: 317113.0000 - fn: 2887.0000 - accuracy: 0.9856 - precision: 0.9639 - recall: 0.9639 - auc: 0.9773 - val_loss: 7.5513 - val_tp: 10630.0000 - val_fp: 9370.0000 - val_tn: 70630.0000 - val_fn: 9370.0000 - val_accuracy: 0.8126 - val_precision: 0.5315 - val_recall: 0.5315 - val_auc: 0.7072
[INFO] saving weights to checkpoints/lstm-epoch-7-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/355901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5662 - tp: 42447.0000 - fp: 37553.0000 - tn: 282447.0000 - fn: 37553.0000 - accuracy: 0.8122 - precision: 0.5306 - recall: 0.5306 - auc: 0.7048 - val_loss: 7.5666 - val_tp: 10611.0000 - val_fp: 9389.0000 - val_tn: 70611.0000 - val_fn: 9389.0000 - val_accuracy: 0.8122 - val_precision: 0.5306 - val_recall: 0.5306 - val_auc: 0.7066
[INFO] saving weights to checkpoints/lstm-epoch-7-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/355901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5998 - tp: 42280.0000 - fp: 37720.0000 - tn: 282280.0000 - fn: 37720.0000 - accuracy: 0.8114 - precision: 0.5285 - recall: 0.5285 - auc: 0.7035 - val_loss: 7.5634 - val_tp: 10615.0000 - val_fp: 9385.0000 - val_tn: 70615.0000 - val_fn: 9385.0000 - val_accuracy: 0.8123 - val_precision: 0.5307 - val_recall: 0.5307 - val_auc: 0.7067
[INFO] saving weights to checkpoints/lstm-epoch-7-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/355901
[33m[INFO] loading file 23-23/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555901, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555901, 17)

[INFO] analyzing data
[INFO] 555901 rows
[INFO] ** appi_name:[21:99.99874%,30:0.00054%,31:0.00036%,33:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:93.65301%,Multi Stage Single Point:6.34699%]
[INFO] ** dst:[21:43.32714%,10:21.00032%,8:18.14028%,9:17.52974%,22:0.00108%,15:0.00054%,24:0.00036%,18:0.00036%,25:0.00018%]
[INFO] ** i/f_dir:[1:99.99946%,0:0.00054%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.99874%,-33.760870000000004:0.00126%]
[INFO] ** modbus_function_description:[7:50.00027%,11:49.99847%,0:0.00126%]
[INFO] ** modbus_transaction_id:65536 (11.78915%)
[INFO] ** orig:[0:99.99964%,2:0.00036%]
[INFO] ** proto:[0:99.99892%,2:0.00054%,1:0.00054%]
[INFO] ** proxy_src_ip:[18:38.34028%,20:25.98754%,13:18.14046%,6:17.52992%,17:0.00054%,16:0.00054%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98682%,-0.32151:21.00014%,-1.27613:18.13992%,-0.23351:17.52956%,-0.33484:17.34014%,-71.33197:0.00054%,-1.02014:0.00054%,-0.08551:0.00036%,-1.27347:0.00036%,1.45709:0.00036%,-0.24151:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,1.46509:0.00018%,-64.19493:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:25.98646%,1:21.00014%,5:18.13974%,4:17.52938%,2:17.33996%,0:0.00432%]
[INFO] ** service:[0.0048200000000000005:99.99892%,-211.73542999999998:0.00054%,-186.43601999999998:0.00036%,-186.44547:0.00018%]
[INFO] ** src:[22:38.34028%,9:25.98754%,7:18.14046%,1:17.52992%,15:0.00054%,21:0.00036%,17:0.00018%,14:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1513 (0.27217%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.1088 - tp: 44717.0000 - fp: 35283.0000 - tn: 284717.0000 - fn: 35283.0000 - accuracy: 0.8236 - precision: 0.5590 - recall: 0.5590 - auc: 0.7226 - val_loss: 1.1962e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.7835e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.5478e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3407e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.1824e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/555901
[33m[INFO] loading file 24-24/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555901, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555901, 17)

[INFO] analyzing data
[INFO] 555901 rows
[INFO] ** appi_name:[21:99.99334%,30:0.00324%,26:0.00054%,31:0.00036%,27:0.00036%,22:0.00036%,0:0.00036%,24:0.00018%,23:0.00018%,19:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,11:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:95.41645%,Multi Stage Single Point:4.58355%]
[INFO] ** dst:[21:43.36617%,10:21.01903%,8:18.10124%,9:17.50653%,15:0.00324%,22:0.00108%,6:0.00072%,25:0.00036%,24:0.00036%,19:0.00036%,18:0.00036%,7:0.00036%,26:0.00018%]
[INFO] ** i/f_dir:[1:99.99694%,0:0.00306%]
[INFO] ** i/f_name:[2:99.99676%,3:0.00324%]
[INFO] ** modbus_function_code:[0.02961:99.99334%,-33.760870000000004:0.00612%,-0.415:0.00018%,0.9188299999999999:0.00018%,0.47422:0.00018%]
[INFO] ** modbus_function_description:[7:49.99775%,11:49.99559%,0:0.00612%,15:0.00018%,10:0.00018%,2:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.78915%)
[INFO] ** orig:[0:99.99964%,1:0.00036%]
[INFO] ** proto:[0:99.99478%,1:0.00324%,2:0.00198%]
[INFO] ** proxy_src_ip:[18:38.39874%,20:25.98718%,13:18.10106%,6:17.50599%,17:0.00324%,10:0.00126%,14:0.0009%,11:0.0009%,21:0.00036%,16:0.00036%]
[INFO] ** s_port:[1.45442:25.98646%,-0.32151:21.01903%,-1.27613:18.1007%,-0.23351:17.50528%,-0.33484:17.37971%,-71.33197:0.00324%,-9.58113:0.00072%,-71.14798:0.00054%,-0.24950999999999998:0.00036%,-1.27347:0.00036%,1.45709:0.00036%,-0.24151:0.00036%,-1.02014:0.00036%,-31.55091:0.00036%,7.6315100000000005:0.00036%,-71.14931:0.00036%,-64.19493:0.00036%,-68.79874000000001:0.00018%,1.46509:0.00018%,7.4901800000000005:0.00018%,13.431270000000001:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:25.98628%,1:21.01903%,5:18.10053%,4:17.50492%,2:17.37953%,0:0.00971%]
[INFO] ** service:[0.0048200000000000005:99.99442%,-211.73542999999998:0.00324%,-211.08346:0.00054%,-211.07873999999998:0.00036%,-202.75898:0.00036%,-186.44547:0.00036%,-186.43601999999998:0.00036%,-211.08818:0.00036%]
[INFO] ** src:[22:38.39874%,9:25.98718%,7:18.10106%,1:17.50599%,14:0.00324%,11:0.00126%,10:0.0009%,2:0.0009%,15:0.00036%,4:0.00036%]
[INFO] ** type:[0:99.99874%,1:0.0009%,2:0.00036%]
[INFO] ** unixtime:1510 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0676e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.1400e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.2892e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1930e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.2268e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.3027e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5558 - val_tp: 14347.0000 - val_fp: 5653.0000 - val_tn: 74347.0000 - val_fn: 5653.0000 - val_accuracy: 0.8869 - val_precision: 0.7174 - val_recall: 0.7174 - val_auc: 0.8233
[INFO] saving weights to checkpoints/lstm-epoch-7-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/555901
[33m[INFO] loading file 25-25/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555901, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555901, 17)

[INFO] analyzing data
[INFO] 555901 rows
[INFO] ** appi_name:[21:99.9964%,30:0.00108%,17:0.00072%,22:0.00054%,31:0.00036%,28:0.00018%,26:0.00018%,12:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** classification:[normal:64.35408%,Multi Stage Single Point:35.64592%]
[INFO] ** dst:[21:43.32444%,10:21.02533%,8:18.13326%,9:17.51265%,15:0.00108%,22:0.0009%,16:0.00072%,6:0.00072%,18:0.00036%,17:0.00036%,24:0.00018%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.9964%,-33.760870000000004:0.0036%]
[INFO] ** modbus_function_description:[7:49.99901%,11:49.99739%,0:0.0036%]
[INFO] ** modbus_transaction_id:65536 (11.78915%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99784%,2:0.00108%,1:0.00108%]
[INFO] ** proxy_src_ip:[18:38.39047%,20:25.95912%,13:18.13326%,6:17.51319%,17:0.00108%,1:0.0009%,21:0.00072%,16:0.00036%,14:0.00036%,7:0.00036%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95876%,-0.32151:21.02497%,-1.27613:18.1329%,-0.23351:17.51265%,-0.33484:17.3655%,-71.33197:0.00108%,-71.14931:0.00054%,-0.24151:0.00036%,-1.02014:0.00036%,-49.275529999999996:0.00036%,1.46509:0.00018%,-5.1466400000000005:0.00018%,-1.27347:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,-0.24950999999999998:0.00018%,2.52505:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,6.1115699999999995:0.00018%,-5.08665:0.00018%,1.45709:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:25.9584%,1:21.02479%,5:18.13273%,4:17.51247%,2:17.36532%,0:0.0063%]
[INFO] ** service:[0.0048200000000000005:99.99676%,-211.73542999999998:0.00108%,-205.44247:0.00072%,-211.08818:0.00054%,-186.43601999999998:0.00036%,-211.09762999999998:0.00018%,-211.08346:0.00018%,-185.9872:0.00018%]
[INFO] ** src:[22:38.39047%,9:25.95912%,7:18.13326%,1:17.51319%,14:0.00108%,3:0.0009%,4:0.00072%,21:0.00036%,15:0.00036%,2:0.00036%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1510 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7312 - tp: 51554.0000 - fp: 28446.0000 - tn: 291554.0000 - fn: 28446.0000 - accuracy: 0.8578 - precision: 0.6444 - recall: 0.6444 - auc: 0.7778 - val_loss: 5.7566 - val_tp: 12857.0000 - val_fp: 7143.0000 - val_tn: 72857.0000 - val_fn: 7143.0000 - val_accuracy: 0.8571 - val_precision: 0.6428 - val_recall: 0.6428 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-7-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7526 - tp: 51448.0000 - fp: 28552.0000 - tn: 291448.0000 - fn: 28552.0000 - accuracy: 0.8572 - precision: 0.6431 - recall: 0.6431 - auc: 0.7769 - val_loss: 5.7380 - val_tp: 12880.0000 - val_fp: 7120.0000 - val_tn: 72880.0000 - val_fn: 7120.0000 - val_accuracy: 0.8576 - val_precision: 0.6440 - val_recall: 0.6440 - val_auc: 0.7775
[INFO] saving weights to checkpoints/lstm-epoch-7-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7449 - tp: 51486.0000 - fp: 28514.0000 - tn: 291486.0000 - fn: 28514.0000 - accuracy: 0.8574 - precision: 0.6436 - recall: 0.6436 - auc: 0.7772 - val_loss: 5.7477 - val_tp: 12868.0000 - val_fp: 7132.0000 - val_tn: 72868.0000 - val_fn: 7132.0000 - val_accuracy: 0.8574 - val_precision: 0.6434 - val_recall: 0.6434 - val_auc: 0.7771
[INFO] saving weights to checkpoints/lstm-epoch-7-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7423 - tp: 51499.0000 - fp: 28501.0000 - tn: 291499.0000 - fn: 28501.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.7773 - val_loss: 5.7598 - val_tp: 12853.0000 - val_fp: 7147.0000 - val_tn: 72853.0000 - val_fn: 7147.0000 - val_accuracy: 0.8571 - val_precision: 0.6427 - val_recall: 0.6427 - val_auc: 0.7767
[INFO] saving weights to checkpoints/lstm-epoch-7-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7570 - tp: 51426.0000 - fp: 28574.0000 - tn: 291426.0000 - fn: 28574.0000 - accuracy: 0.8571 - precision: 0.6428 - recall: 0.6428 - auc: 0.7768 - val_loss: 5.7139 - val_tp: 12910.0000 - val_fp: 7090.0000 - val_tn: 72910.0000 - val_fn: 7090.0000 - val_accuracy: 0.8582 - val_precision: 0.6455 - val_recall: 0.6455 - val_auc: 0.7784
[INFO] saving weights to checkpoints/lstm-epoch-7-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/555901
[33m[INFO] loading file 26-26/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555901, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555901, 17)

[INFO] analyzing data
[INFO] 555901 rows
[INFO] ** appi_name:[21:99.99856%,7:0.00054%,31:0.00018%,30:0.00018%,22:0.00018%,12:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:64.3951%,Single Stage Single Point:28.7303%,Multi Stage Single Point:6.87461%]
[INFO] ** dst:[21:43.31023%,10:21.08289%,8:18.12337%,9:17.48117%,22:0.00072%,24:0.00036%,16:0.00036%,2:0.00036%,18:0.00018%,15:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99982%,0:0.00018%]
[INFO] ** i/f_name:[2:99.99982%,3:0.00018%]
[INFO] ** modbus_function_code:[0.02961:99.99856%,-33.760870000000004:0.00144%]
[INFO] ** modbus_function_description:[7:49.99991%,11:49.99865%,0:0.00144%]
[INFO] ** modbus_transaction_id:65536 (11.78915%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99946%,2:0.00036%,1:0.00018%]
[INFO] ** proxy_src_ip:[18:38.46314%,20:25.93016%,13:18.12373%,6:17.48117%,1:0.00054%,21:0.00036%,16:0.00036%,17:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.92962%,-0.32151:21.08271%,-1.27613:18.12319%,-0.23351:17.48099%,-0.33484:17.38043%,-1.27347:0.00036%,-1.02014:0.00036%,7.66617:0.00018%,-71.14931:0.00018%,11.57001:0.00018%,-3.3787199999999995:0.00018%,2.52505:0.00018%,-0.24151:0.00018%,-1.2708:0.00018%,1.45709:0.00018%,-49.275529999999996:0.00018%,1.47576:0.00018%,1.46509:0.00018%,14.191239999999999:0.00018%,-71.33197:0.00018%]
[INFO] ** scada_tag:[3:25.92926%,1:21.08271%,5:18.12319%,4:17.48081%,2:17.38043%,0:0.0036%]
[INFO] ** service:[0.0048200000000000005:99.99874%,-211.09762999999998:0.00054%,-211.35747999999998:0.00018%,-211.73542999999998:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.46314%,9:25.93016%,7:18.12373%,1:17.48117%,3:0.00054%,15:0.00036%,4:0.00036%,21:0.00018%,14:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1509 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7431 - tp: 51495.0000 - fp: 28505.0000 - tn: 291495.0000 - fn: 28505.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.7773 - val_loss: 5.7380 - val_tp: 12880.0000 - val_fp: 7120.0000 - val_tn: 72880.0000 - val_fn: 7120.0000 - val_accuracy: 0.8576 - val_precision: 0.6440 - val_recall: 0.6440 - val_auc: 0.7775
[INFO] saving weights to checkpoints/lstm-epoch-7-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.5198 - tp: 66063.0000 - fp: 13937.0000 - tn: 306063.0000 - fn: 13937.0000 - accuracy: 0.9303 - precision: 0.8258 - recall: 0.8258 - auc: 0.8983 - val_loss: 0.0029 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3682 - tp: 74040.0000 - fp: 5960.0000 - tn: 314040.0000 - fn: 5960.0000 - accuracy: 0.9702 - precision: 0.9255 - recall: 0.9255 - auc: 0.9781 - val_loss: 2.5255e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1184 - tp: 77993.0000 - fp: 2007.0000 - tn: 317993.0000 - fn: 2007.0000 - accuracy: 0.9900 - precision: 0.9749 - recall: 0.9749 - auc: 0.9992 - val_loss: 1.0930e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1082 - tp: 78157.0000 - fp: 1843.0000 - tn: 318157.0000 - fn: 1843.0000 - accuracy: 0.9908 - precision: 0.9770 - recall: 0.9770 - auc: 0.9995 - val_loss: 3.6982e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/555901
[33m[INFO] loading file 27-27/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (496031, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (496031, 17)

[INFO] analyzing data
[INFO] 496031 rows
[INFO] ** appi_name:[21:99.9994%,30:0.0006%]
[INFO] ** classification:[normal:64.35122%,Single Stage Single Point:35.64878%]
[INFO] ** dst:[21:43.28056%,10:21.06884%,8:18.1789%,9:17.47008%,22:0.00081%,15:0.0006%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name:[2:99.9994%,3:0.0006%]
[INFO] ** modbus_function_code:[0.02961:99.9994%,-33.760870000000004:0.0006%]
[INFO] ** modbus_function_description:[7:50.0003%,11:49.99909%,0:0.0006%]
[INFO] ** modbus_transaction_id:65536 (13.21208%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9994%,1:0.0006%]
[INFO] ** proxy_src_ip:[18:38.42199%,20:25.92802%,13:18.1787%,6:17.47028%,17:0.0006%,16:0.0004%]
[INFO] ** s_port:[1.45442:25.92741%,-0.32151:21.06884%,-1.27613:18.1785%,-0.23351:17.46988%,-0.33484:17.35315%,-71.33197:0.0006%,-1.02014:0.0004%,-1.27347:0.0002%,1.45709:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-0.24151:0.0002%]
[INFO] ** scada_tag:[3:25.92701%,1:21.06864%,5:18.1783%,4:17.46967%,2:17.35295%,0:0.00343%]
[INFO] ** service:[0.0048200000000000005:99.9994%,-211.73542999999998:0.0006%]
[INFO] ** src:[22:38.42199%,9:25.92802%,7:18.1787%,1:17.47028%,14:0.0006%,15:0.0004%]
[INFO] ** type:[0:99.9996%,1:0.0004%]
[INFO] ** unixtime:1347 (0.27156%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/496031
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1061 - tp: 78148.0000 - fp: 1852.0000 - tn: 318148.0000 - fn: 1852.0000 - accuracy: 0.9907 - precision: 0.9768 - recall: 0.9768 - auc: 0.9994 - val_loss: 3.8275e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/496031
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0939 - tp: 78300.0000 - fp: 1700.0000 - tn: 318300.0000 - fn: 1700.0000 - accuracy: 0.9915 - precision: 0.9787 - recall: 0.9787 - auc: 0.9996 - val_loss: 6.8815e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/496031
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0928 - tp: 78231.0000 - fp: 1769.0000 - tn: 318231.0000 - fn: 1769.0000 - accuracy: 0.9912 - precision: 0.9779 - recall: 0.9779 - auc: 0.9997 - val_loss: 8.0607e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/496031
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0914 - tp: 78151.0000 - fp: 1849.0000 - tn: 318151.0000 - fn: 1849.0000 - accuracy: 0.9908 - precision: 0.9769 - recall: 0.9769 - auc: 0.9997 - val_loss: 1.4500e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/496031
[33m[INFO] loading file 28-28/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (429947, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (429947, 17)

[INFO] analyzing data
[INFO] 429947 rows
[INFO] ** appi_name:[21:99.99302%,30:0.00163%,17:0.00116%,22:0.00093%,7:0.00093%,31:0.0007%,26:0.0007%,28:0.00023%,27:0.00023%,8:0.00023%,0:0.00023%]
[INFO] ** classification:[normal:64.32304%,Single Stage Single Point:35.67696%]
[INFO] ** dst:[21:43.28231%,10:21.03352%,8:18.19922%,9:17.4775%,6:0.00186%,16:0.00163%,18:0.00116%,15:0.0007%,22:0.00047%,17:0.00047%,2:0.00047%,25:0.00023%,7:0.00023%,0:0.00023%]
[INFO] ** i/f_dir:[1:99.9993%,0:0.0007%]
[INFO] ** i/f_name:[2:99.9993%,3:0.0007%]
[INFO] ** modbus_function_code:[0.02961:99.99302%,-33.760870000000004:0.00698%]
[INFO] ** modbus_function_description:[11:49.99663%,7:49.99639%,0:0.00698%]
[INFO] ** modbus_transaction_id:65536 (15.24281%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99581%,2:0.00349%,1:0.0007%]
[INFO] ** proxy_src_ip:[18:38.35333%,20:25.9625%,13:18.19945%,6:17.47774%,1:0.00186%,17:0.00163%,14:0.0014%,7:0.00116%,21:0.0007%,0:0.00023%]
[INFO] ** s_port:[1.45442:25.96227%,-0.32151:21.03352%,-1.27613:18.19922%,-0.23351:17.47727%,-0.33484:17.31981%,-71.14798:0.00093%,-71.14931:0.00093%,-71.33197:0.0007%,-0.08551:0.00047%,-0.24151:0.00047%,7.66617:0.00023%,-58.035180000000004:0.00023%,-1.2708:0.00023%,-64.19493:0.00023%,-5.1466400000000005:0.00023%,13.431270000000001:0.00023%,11.57001:0.00023%,14.4699:0.00023%,1.47576:0.00023%,14.191239999999999:0.00023%,-5.08665:0.00023%,10.192739999999999:0.00023%,-3.3787199999999995:0.00023%,6.1115699999999995:0.00023%,2.05573:0.00023%,-43.76509:0.00023%,2.52505:0.00023%,11.862:0.00023%,-58.032509999999995:0.00023%]
[INFO] ** scada_tag:[3:25.96204%,1:21.03329%,5:18.19922%,4:17.47681%,2:17.31981%,0:0.00884%]
[INFO] ** service:[0.0048200000000000005:99.99302%,-205.44247:0.00116%,-186.43601999999998:0.00116%,-211.09762999999998:0.00093%,-211.08346:0.00093%,-211.08818:0.00093%,-211.73542999999998:0.0007%,-186.44547:0.00023%,-183.8612:0.00023%,-185.9872:0.00023%,-211.35747999999998:0.00023%,-202.75898:0.00023%]
[INFO] ** src:[22:38.35333%,9:25.9625%,7:18.19945%,1:17.47774%,3:0.00209%,2:0.0014%,21:0.00116%,4:0.00093%,14:0.0007%,8:0.00047%,17:0.00023%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1168 (0.27166%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/429947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0788 - tp: 78268.0000 - fp: 1732.0000 - tn: 318268.0000 - fn: 1732.0000 - accuracy: 0.9913 - precision: 0.9783 - recall: 0.9783 - auc: 0.9998 - val_loss: 1.2758e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/429947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0612 - tp: 78508.0000 - fp: 1492.0000 - tn: 318508.0000 - fn: 1492.0000 - accuracy: 0.9925 - precision: 0.9814 - recall: 0.9814 - auc: 0.9998 - val_loss: 6.0913e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/429947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0400 - tp: 79024.0000 - fp: 976.0000 - tn: 319024.0000 - fn: 976.0000 - accuracy: 0.9951 - precision: 0.9878 - recall: 0.9878 - auc: 0.9999 - val_loss: 0.0011 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-7-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/429947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0402 - tp: 78957.0000 - fp: 1043.0000 - tn: 318957.0000 - fn: 1043.0000 - accuracy: 0.9948 - precision: 0.9870 - recall: 0.9870 - auc: 0.9999 - val_loss: 2.4851e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-27-28-batch-300000-400000
[INFO] processing batch 400000-500000/429947
[33m[INFO] loading file 29-29/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529947, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529947, 17)

[INFO] analyzing data
[INFO] 529947 rows
[INFO] ** appi_name:[21:99.99887%,30:0.00057%,26:0.00019%,9:0.00019%,3:0.00019%]
[INFO] ** classification:[normal:64.38851%,Single Stage Single Point:35.61149%]
[INFO] ** dst:[21:43.32509%,10:21.06211%,8:18.14748%,9:17.46363%,22:0.00057%,15:0.00057%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99887%,-33.760870000000004:0.00113%]
[INFO] ** modbus_function_description:[7:49.99991%,11:49.99896%,0:0.00113%]
[INFO] ** modbus_transaction_id:65536 (12.36652%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99925%,1:0.00057%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.43988%,20:25.9475%,13:18.14785%,6:17.46344%,17:0.00057%,21:0.00019%,16:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.94693%,-0.32151:21.06192%,-1.27613:18.14748%,-0.23351:17.46344%,-0.33484:17.37796%,-71.33197:0.00057%,1.45709:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,14.4699:0.00019%]
[INFO] ** scada_tag:[3:25.94656%,1:21.06173%,5:18.14748%,4:17.46307%,2:17.37796%,0:0.00321%]
[INFO] ** service:[0.0048200000000000005:99.99906%,-211.73542999999998:0.00057%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.43988%,9:25.9475%,7:18.14785%,1:17.46344%,14:0.00057%,15:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1439 (0.27154%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0377 - tp: 78960.0000 - fp: 1040.0000 - tn: 318960.0000 - fn: 1040.0000 - accuracy: 0.9948 - precision: 0.9870 - recall: 0.9870 - auc: 0.9999 - val_loss: 8.0603e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0320 - tp: 79062.0000 - fp: 938.0000 - tn: 319062.0000 - fn: 938.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 2.0686e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0309 - tp: 79058.0000 - fp: 942.0000 - tn: 319058.0000 - fn: 942.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.2112e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0276 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.2001e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0257 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 5.9140e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/529947
[33m[INFO] loading file 30-30/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529947, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529947, 17)

[INFO] analyzing data
[INFO] 529947 rows
[INFO] ** appi_name:[21:99.99755%,30:0.0017%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.36719%,Single Stage Single Point:35.63281%]
[INFO] ** dst:[21:43.33773%,10:21.02644%,8:18.14615%,9:17.48628%,15:0.0017%,22:0.00075%,24:0.00038%,25:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.9983%,0:0.0017%]
[INFO] ** i/f_name:[2:99.9983%,3:0.0017%]
[INFO] ** modbus_function_code:[0.02961:99.99755%,-33.760870000000004:0.00245%]
[INFO] ** modbus_function_description:[7:49.99972%,11:49.99783%,0:0.00245%]
[INFO] ** modbus_transaction_id:65536 (12.36652%)
[INFO] ** orig:[0:99.99906%,2:0.00057%,1:0.00038%]
[INFO] ** proto:[0:99.99792%,1:0.0017%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.36874%,20:25.99524%,13:18.14653%,6:17.48684%,17:0.0017%,7:0.00038%,16:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.99505%,-0.32151:21.02625%,-1.27613:18.14597%,-0.23351:17.48609%,-0.33484:17.34249%,-71.33197:0.0017%,-0.24151:0.00057%,-1.27347:0.00038%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,10.192739999999999:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:25.99467%,1:21.02625%,5:18.14578%,4:17.4859%,2:17.3423%,0:0.00509%]
[INFO] ** service:[0.0048200000000000005:99.99774%,-211.73542999999998:0.0017%,-211.08346:0.00019%,-205.44247:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.36874%,9:25.99524%,7:18.14653%,1:17.48684%,14:0.00113%,21:0.00094%,16:0.00019%,15:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99925%,1:0.00075%]
[INFO] ** unixtime:1441 (0.27191%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0242 - tp: 79137.0000 - fp: 863.0000 - tn: 319137.0000 - fn: 863.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0237 - tp: 79091.0000 - fp: 909.0000 - tn: 319091.0000 - fn: 909.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1926e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0224 - tp: 79109.0000 - fp: 891.0000 - tn: 319109.0000 - fn: 891.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0220 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79137.0000 - fp: 863.0000 - tn: 319137.0000 - fn: 863.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.8965e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/529947
[33m[INFO] loading file 31-31/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529947, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529947, 17)

[INFO] analyzing data
[INFO] 529947 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.37814%,Single Stage Single Point:35.62186%]
[INFO] ** dst:[21:43.32452%,10:21.05248%,8:18.12408%,9:17.4976%,22:0.00094%,24:0.00038%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00009%,11:49.99991%]
[INFO] ** modbus_transaction_id:65536 (12.36652%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.3995%,20:25.97826%,13:18.12427%,6:17.4976%,16:0.00038%]
[INFO] ** s_port:[1.45442:25.9775%,-0.32151:21.05248%,-1.27613:18.12389%,-0.23351:17.49741%,-0.33484:17.34702%,-1.27347:0.00038%,1.45709:0.00038%,-1.02014:0.00038%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.97713%,1:21.05229%,5:18.1237%,4:17.49722%,2:17.34683%,0:0.00283%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.3995%,9:25.97826%,7:18.12427%,1:17.4976%,15:0.00038%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1440 (0.27173%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79082.0000 - fp: 918.0000 - tn: 319082.0000 - fn: 918.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79084.0000 - fp: 916.0000 - tn: 319084.0000 - fn: 916.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79151.0000 - fp: 849.0000 - tn: 319151.0000 - fn: 849.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/529947
[33m[INFO] loading file 32-32/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529947, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529947, 17)

[INFO] analyzing data
[INFO] 529947 rows
[INFO] ** appi_name:[21:99.99623%,30:0.00321%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.37172%,Single Stage Single Point:35.62828%]
[INFO] ** dst:[21:43.3198%,10:21.04701%,8:18.16634%,9:17.46193%,15:0.00321%,22:0.00094%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99717%,0:0.00283%]
[INFO] ** i/f_name:[2:99.99679%,3:0.00321%]
[INFO] ** modbus_function_code:[0.02961:99.99623%,-33.760870000000004:0.00377%]
[INFO] ** modbus_function_description:[7:49.99896%,11:49.99726%,0:0.00377%]
[INFO] ** modbus_transaction_id:65536 (12.36652%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99623%,1:0.00321%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.40724%,20:25.95995%,13:18.16634%,6:17.4625%,17:0.00321%,14:0.00057%,16:0.00019%]
[INFO] ** s_port:[1.45442:25.95939%,-0.32151:21.04701%,-1.27613:18.16597%,-0.23351:17.46175%,-0.33484:17.36023%,-71.33197:0.00321%,-0.24151:0.00057%,-1.2708:0.00019%,-1.02014:0.00019%,13.431270000000001:0.00019%,-71.14798:0.00019%,-1.27347:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,1.45709:0.00019%,11.862:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:25.95901%,1:21.04682%,5:18.16597%,4:17.46137%,2:17.36023%,0:0.0066%]
[INFO] ** service:[0.0048200000000000005:99.99623%,-211.73542999999998:0.00321%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.40724%,9:25.95995%,7:18.16634%,1:17.4625%,14:0.00321%,2:0.00057%,15:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1438 (0.27135%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79141.0000 - fp: 859.0000 - tn: 319141.0000 - fn: 859.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-7-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79078.0000 - fp: 922.0000 - tn: 319078.0000 - fn: 922.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1922e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/529947
[33m[INFO] loading file 33-33/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529947, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529947, 17)

[INFO] analyzing data
[INFO] 529947 rows
[INFO] ** appi_name:[21:99.99679%,30:0.00113%,17:0.00075%,22:0.00057%,31:0.00019%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.39852%,Single Stage Single Point:35.60148%]
[INFO] ** dst:[21:43.33698%,10:21.05663%,8:18.11106%,9:17.49043%,22:0.00132%,15:0.00113%,16:0.00075%,6:0.00075%,24:0.00038%,17:0.00038%,18:0.00019%]
[INFO] ** i/f_dir:[1:99.99887%,0:0.00113%]
[INFO] ** i/f_name:[2:99.99887%,3:0.00113%]
[INFO] ** modbus_function_code:[0.02961:99.99679%,-33.760870000000004:0.00321%]
[INFO] ** modbus_function_description:[7:49.99934%,11:49.99745%,0:0.00321%]
[INFO] ** modbus_transaction_id:65536 (12.36652%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99792%,1:0.00113%,2:0.00094%]
[INFO] ** proxy_src_ip:[18:38.42177%,20:25.9726%,13:18.11106%,6:17.49062%,17:0.00113%,16:0.00075%,1:0.00075%,21:0.00038%,14:0.00038%,7:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97184%,-0.32151:21.05663%,-1.27613:18.11068%,-0.23351:17.49024%,-0.33484:17.36513%,-71.33197:0.00113%,-1.02014:0.00075%,-71.14931:0.00057%,1.45709:0.00038%,-1.27347:0.00038%,-5.08665:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-71.14798:0.00019%,-58.032509999999995:0.00019%,-58.035180000000004:0.00019%,-0.24151:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-5.1466400000000005:0.00019%]
[INFO] ** scada_tag:[3:25.97147%,1:21.05663%,5:18.11049%,4:17.49005%,2:17.36513%,0:0.00623%]
[INFO] ** service:[0.0048200000000000005:99.99679%,-211.73542999999998:0.00113%,-205.44247:0.00075%,-211.08818:0.00057%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.42177%,9:25.9726%,7:18.11106%,1:17.49062%,14:0.00113%,15:0.00075%,3:0.00075%,21:0.00038%,4:0.00038%,2:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1441 (0.27191%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.5791e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79060.0000 - fp: 940.0000 - tn: 319060.0000 - fn: 940.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0647e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79130.0000 - fp: 870.0000 - tn: 319130.0000 - fn: 870.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/529947
[33m[INFO] loading file 34-34/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (371380, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (371380, 17)

[INFO] analyzing data
[INFO] 371380 rows
[INFO] ** appi_name:[21:99.99731%,30:0.00081%,7:0.00081%,31:0.00027%,22:0.00027%,8:0.00027%,6:0.00027%]
[INFO] ** classification:[normal:64.33464%,Single Stage Single Point:35.66536%]
[INFO] ** dst:[21:43.27212%,10:21.05929%,8:18.20561%,9:17.45974%,22:0.00081%,15:0.00081%,16:0.00054%,2:0.00054%,18:0.00027%,6:0.00027%]
[INFO] ** i/f_dir:[1:99.99919%,0:0.00081%]
[INFO] ** i/f_name:[2:99.99919%,3:0.00081%]
[INFO] ** modbus_function_code:[0.02961:99.99731%,-33.760870000000004:0.00269%]
[INFO] ** modbus_function_description:[7:49.99919%,11:49.99812%,0:0.00269%]
[INFO] ** modbus_transaction_id:65536 (17.64662%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99865%,1:0.00081%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.38683%,20:25.94459%,13:18.20561%,6:17.46028%,17:0.00081%,1:0.00081%,21:0.00054%,14:0.00027%,7:0.00027%]
[INFO] ** s_port:[1.45442:25.94432%,-0.32151:21.05902%,-1.27613:18.20561%,-0.23351:17.45948%,-0.33484:17.3278%,-0.24151:0.00081%,-71.33197:0.00081%,-3.0613900000000003:0.00027%,-3.3787199999999995:0.00027%,14.191239999999999:0.00027%,1.47576:0.00027%,11.57001:0.00027%,-49.275529999999996:0.00027%,-71.14931:0.00027%,7.66617:0.00027%]
[INFO] ** scada_tag:[3:25.94405%,1:21.05875%,5:18.20534%,4:17.45894%,2:17.3278%,0:0.00512%]
[INFO] ** service:[0.0048200000000000005:99.99758%,-211.09762999999998:0.00081%,-211.73542999999998:0.00081%,-186.43601999999998:0.00027%,-211.35747999999998:0.00027%,-211.08818:0.00027%]
[INFO] ** src:[22:38.38683%,9:25.94459%,7:18.20561%,1:17.46028%,14:0.00081%,3:0.00081%,4:0.00054%,21:0.00027%,2:0.00027%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1009 (0.27169%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/371380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0195 - tp: 79149.0000 - fp: 851.0000 - tn: 319149.0000 - fn: 851.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/371380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79075.0000 - fp: 925.0000 - tn: 319075.0000 - fn: 925.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 5.6120e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/371380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79152.0000 - fp: 848.0000 - tn: 319152.0000 - fn: 848.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1661e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/371380
[33m[INFO] loading file 35-35/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571380, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571380, 17)

[INFO] analyzing data
[INFO] 571380 rows
[INFO] ** appi_name:[21:99.99895%,30:0.00105%]
[INFO] ** classification:[normal:64.3661%,Single Stage Single Point:35.6339%]
[INFO] ** dst:[21:43.32616%,10:21.03749%,8:18.15797%,9:17.47629%,22:0.00105%,15:0.00105%]
[INFO] ** i/f_dir:[1:99.99912%,0:0.00088%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99895%,-33.760870000000004:0.00105%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99895%,0:0.00105%]
[INFO] ** modbus_transaction_id:65536 (11.46977%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.99895%,1:0.00105%]
[INFO] ** proxy_src_ip:[18:38.39546%,20:25.96871%,13:18.15762%,6:17.47646%,17:0.00105%,16:0.0007%]
[INFO] ** s_port:[1.45442:25.96818%,-0.32151:21.03749%,-1.27613:18.15762%,-0.23351:17.47611%,-0.33484:17.35798%,-71.33197:0.00105%,-1.02014:0.0007%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.96783%,1:21.03749%,5:18.15744%,4:17.47576%,2:17.35798%,0:0.0035%]
[INFO] ** service:[0.0048200000000000005:99.99895%,-211.73542999999998:0.00105%]
[INFO] ** src:[22:38.39546%,9:25.96871%,7:18.15762%,1:17.47646%,14:0.00105%,15:0.0007%]
[INFO] ** type:[0:99.99912%,1:0.00088%]
[INFO] ** unixtime:1551 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 3.5759e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79150.0000 - fp: 850.0000 - tn: 319150.0000 - fn: 850.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 4.1134e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79047.0000 - fp: 953.0000 - tn: 319047.0000 - fn: 953.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79082.0000 - fp: 918.0000 - tn: 319082.0000 - fn: 918.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/571380
[33m[INFO] loading file 36-36/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571380, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571380, 17)

[INFO] analyzing data
[INFO] 571380 rows
[INFO] ** appi_name:[21:99.9986%,30:0.0007%,31:0.00035%,33:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.36277%,Single Stage Single Point:35.63723%]
[INFO] ** dst:[21:43.33106%,10:21.02944%,8:18.14939%,9:17.48766%,22:0.00088%,15:0.0007%,24:0.00035%,18:0.00035%,25:0.00018%]
[INFO] ** i/f_dir:[1:99.9993%,0:0.0007%]
[INFO] ** i/f_name:[2:99.9993%,3:0.0007%]
[INFO] ** modbus_function_code:[0.02961:99.9986%,-33.760870000000004:0.0014%]
[INFO] ** modbus_function_description:[7:50.00035%,11:49.99825%,0:0.0014%]
[INFO] ** modbus_transaction_id:65536 (11.46977%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99877%,1:0.0007%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.38024%,20:25.98043%,13:18.14957%,6:17.48819%,17:0.0007%,21:0.00018%,16:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.97991%,-0.32151:21.02926%,-1.27613:18.14904%,-0.23351:17.48749%,-0.33484:17.35097%,-71.33197:0.0007%,-0.24151:0.00053%,-0.08551:0.00035%,-1.27347:0.00035%,1.45709:0.00018%,1.47576:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,1.46509:0.00018%,-64.19493:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:25.97956%,1:21.02909%,5:18.14887%,4:17.48731%,2:17.3508%,0:0.00438%]
[INFO] ** service:[0.0048200000000000005:99.99877%,-211.73542999999998:0.0007%,-186.43601999999998:0.00035%,-186.44547:0.00018%]
[INFO] ** src:[22:38.38024%,9:25.98043%,7:18.14957%,1:17.48819%,14:0.0007%,17:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1552 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79150.0000 - fp: 850.0000 - tn: 319150.0000 - fn: 850.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79074.0000 - fp: 926.0000 - tn: 319074.0000 - fn: 926.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79069.0000 - fp: 931.0000 - tn: 319069.0000 - fn: 931.0000 - accuracy: 0.9953 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79141.0000 - fp: 859.0000 - tn: 319141.0000 - fn: 859.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1924e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/571380
[33m[INFO] loading file 37-37/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571380, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571380, 17)

[INFO] analyzing data
[INFO] 571380 rows
[INFO] ** appi_name:[21:99.99877%,30:0.0007%,33:0.00018%,26:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:64.37677%,Single Stage Single Point:35.62323%]
[INFO] ** dst:[21:43.33491%,10:21.03994%,8:18.13732%,9:17.48591%,22:0.0007%,15:0.0007%,24:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99965%,0:0.00035%]
[INFO] ** i/f_name:[2:99.9993%,3:0.0007%]
[INFO] ** modbus_function_code:[0.02961:99.99877%,-33.760870000000004:0.00123%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99877%,0:0.00123%]
[INFO] ** modbus_transaction_id:65536 (11.46977%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99912%,1:0.0007%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.38864%,20:25.98638%,13:18.13732%,6:17.48609%,17:0.0007%,21:0.00035%,16:0.00035%,1:0.00018%]
[INFO] ** s_port:[1.45442:25.98586%,-0.32151:21.03976%,-1.27613:18.13697%,-0.23351:17.48574%,-0.33484:17.34887%,-71.33197:0.0007%,-1.02014:0.00035%,1.46509:0.00018%,1.47576:0.00018%,-1.27347:0.00018%,-49.275529999999996:0.00018%,-0.24950999999999998:0.00018%,-0.24151:0.00018%,-1.2708:0.00018%,1.45709:0.00018%,14.4699:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:25.98568%,1:21.03976%,5:18.13679%,4:17.48556%,2:17.3487%,0:0.0035%]
[INFO] ** service:[0.0048200000000000005:99.99895%,-211.73542999999998:0.0007%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.38864%,9:25.98638%,7:18.13732%,1:17.48609%,14:0.0007%,15:0.00035%,4:0.00035%,3:0.00018%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1552 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79123.0000 - fp: 877.0000 - tn: 319123.0000 - fn: 877.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79085.0000 - fp: 915.0000 - tn: 319085.0000 - fn: 915.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.7755e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/571380
[33m[INFO] loading file 38-38/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571380, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571380, 17)

[INFO] analyzing data
[INFO] 571380 rows
[INFO] ** appi_name:[21:99.99895%,30:0.00035%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.40162%,Single Stage Single Point:35.59838%]
[INFO] ** dst:[21:43.31443%,10:21.08509%,8:18.10354%,9:17.49501%,22:0.00088%,15:0.00035%,25:0.00018%,24:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99982%,0:0.00018%]
[INFO] ** i/f_name:[2:99.99965%,3:0.00035%]
[INFO] ** modbus_function_code:[0.02961:99.99895%,-33.760870000000004:0.00105%]
[INFO] ** modbus_function_description:[7:49.99965%,11:49.9993%,0:0.00105%]
[INFO] ** modbus_transaction_id:65536 (11.46977%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9993%,2:0.00035%,1:0.00035%]
[INFO] ** proxy_src_ip:[18:38.44622%,20:25.95383%,13:18.10336%,6:17.49536%,17:0.00035%,7:0.00035%,16:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95313%,-0.32151:21.08492%,-1.27613:18.10319%,-0.23351:17.49484%,-0.33484:17.3613%,-0.24151:0.00035%,-71.33197:0.00035%,1.45709:0.00035%,1.47576:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-61.95768:0.00018%,-0.24950999999999998:0.00018%,-1.02014:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:25.95278%,1:21.08492%,5:18.10319%,4:17.49466%,2:17.3613%,0:0.00315%]
[INFO] ** service:[0.0048200000000000005:99.99912%,-211.73542999999998:0.00035%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.44622%,9:25.95383%,7:18.10336%,1:17.49536%,21:0.00035%,14:0.00035%,16:0.00018%,15:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1553 (0.2718%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79085.0000 - fp: 915.0000 - tn: 319085.0000 - fn: 915.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79085.0000 - fp: 915.0000 - tn: 319085.0000 - fn: 915.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79154.0000 - fp: 846.0000 - tn: 319154.0000 - fn: 846.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 8.7464e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/571380
[33m[INFO] loading file 39-39/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571380, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571380, 17)

[INFO] analyzing data
[INFO] 571380 rows
[INFO] ** appi_name:[21:99.99965%,26:0.00018%,17:0.00018%]
[INFO] ** classification:[normal:64.39707%,Single Stage Single Point:35.60293%]
[INFO] ** dst:[21:43.31758%,10:21.07827%,8:18.13959%,9:17.46316%,22:0.00088%,24:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99965%,-33.760870000000004:0.00035%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99965%,0:0.00035%]
[INFO] ** modbus_transaction_id:65536 (11.46977%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.44237%,20:25.95383%,13:18.13977%,6:17.46316%,16:0.00053%,7:0.00035%]
[INFO] ** s_port:[1.45442:25.95331%,-0.32151:21.07827%,-1.27613:18.13942%,-0.23351:17.46298%,-0.33484:17.3641%,-1.02014:0.00053%,-71.14798:0.00018%,-1.27347:0.00018%,1.45709:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%]
[INFO] ** scada_tag:[3:25.95296%,1:21.07809%,5:18.13924%,4:17.46298%,2:17.36393%,0:0.0028%]
[INFO] ** service:[0.0048200000000000005:99.99965%,-211.08346:0.00018%,-205.44247:0.00018%]
[INFO] ** src:[22:38.44237%,9:25.95383%,7:18.13977%,1:17.46316%,15:0.00053%,21:0.00035%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1551 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79159.0000 - fp: 841.0000 - tn: 319159.0000 - fn: 841.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.6290e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79059.0000 - fp: 941.0000 - tn: 319059.0000 - fn: 941.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/571380
[33m[INFO] loading file 40-40/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571380, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571380, 17)

[INFO] analyzing data
[INFO] 571380 rows
[INFO] ** appi_name:[21:99.9965%,30:0.00298%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.33267%,Single Stage Single Point:35.66733%]
[INFO] ** dst:[21:43.29115%,10:21.03679%,8:18.20015%,9:17.46736%,15:0.00298%,22:0.00088%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9972%,0:0.0028%]
[INFO] ** i/f_name:[2:99.99702%,3:0.00298%]
[INFO] ** modbus_function_code:[0.02961:99.9965%,-33.760870000000004:0.0035%]
[INFO] ** modbus_function_description:[7:49.99912%,11:49.99737%,0:0.0035%]
[INFO] ** modbus_transaction_id:65536 (11.46977%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.9965%,1:0.00298%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.35346%,20:25.97536%,13:18.19997%,6:17.46771%,17:0.00298%,14:0.00053%]
[INFO] ** s_port:[1.45442:25.97448%,-0.32151:21.03679%,-1.27613:18.1998%,-0.23351:17.46718%,-0.33484:17.31667%,-71.33197:0.00298%,1.45709:0.00053%,-0.24151:0.00035%,-71.14798:0.00018%,-1.27347:0.00018%,11.862:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,13.431270000000001:0.00018%]
[INFO] ** scada_tag:[3:25.97413%,1:21.03661%,5:18.19962%,4:17.46683%,2:17.3165%,0:0.0063%]
[INFO] ** service:[0.0048200000000000005:99.9965%,-211.73542999999998:0.00298%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.35346%,9:25.97536%,7:18.19997%,1:17.46771%,14:0.00298%,2:0.00053%]
[INFO] ** type:[0:99.99912%,1:0.00088%]
[INFO] ** unixtime:1554 (0.27197%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79076.0000 - fp: 924.0000 - tn: 319076.0000 - fn: 924.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79089.0000 - fp: 911.0000 - tn: 319089.0000 - fn: 911.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79078.0000 - fp: 922.0000 - tn: 319078.0000 - fn: 922.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79153.0000 - fp: 847.0000 - tn: 319153.0000 - fn: 847.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1961e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/571380
[33m[INFO] loading file 41-41/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (511538, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (511538, 17)

[INFO] analyzing data
[INFO] 511538 rows
[INFO] ** appi_name:[21:99.99668%,30:0.00098%,22:0.00078%,17:0.00078%,32:0.0002%,28:0.0002%,26:0.0002%,7:0.0002%]
[INFO] ** classification:[normal:64.38994%,Single Stage Single Point:35.61006%]
[INFO] ** dst:[21:43.32503%,10:21.0608%,8:18.14352%,9:17.46635%,16:0.00098%,15:0.00098%,6:0.00098%,22:0.00059%,24:0.00039%,17:0.00039%]
[INFO] ** i/f_dir:[1:99.99902%,0:0.00098%]
[INFO] ** i/f_name:[2:99.99902%,3:0.00098%]
[INFO] ** modbus_function_code:[0.02961:99.99668%,-33.760870000000004:0.00332%]
[INFO] ** modbus_function_description:[7:49.99902%,11:49.99765%,0:0.00332%]
[INFO] ** modbus_transaction_id:65536 (12.81156%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99785%,2:0.00117%,1:0.00098%]
[INFO] ** proxy_src_ip:[18:38.43273%,20:25.9533%,13:18.14372%,6:17.46654%,17:0.00098%,1:0.00078%,21:0.00039%,16:0.00039%,14:0.00039%,0:0.00039%,7:0.0002%,2:0.0002%]
[INFO] ** s_port:[1.45442:25.95291%,-0.32151:21.0608%,-1.27613:18.14313%,-0.23351:17.46615%,-0.33484:17.37193%,-71.33197:0.00098%,-71.14931:0.00078%,-1.02014:0.00039%,-1.27347:0.00039%,-71.14798:0.0002%,-0.24151:0.0002%,-58.035180000000004:0.0002%,-1.2708:0.0002%,-5.1466400000000005:0.0002%,1.47576:0.0002%,1.46509:0.0002%,-64.19226:0.0002%,-5.08665:0.0002%,-0.24950999999999998:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:25.95272%,1:21.0608%,5:18.14313%,4:17.46596%,2:17.37193%,0:0.00547%]
[INFO] ** service:[0.0048200000000000005:99.99668%,-211.73542999999998:0.00098%,-205.44247:0.00078%,-211.08818:0.00078%,89.64175:0.0002%,-211.09762999999998:0.0002%,-211.08346:0.0002%,-185.9872:0.0002%]
[INFO] ** src:[22:38.43273%,9:25.9533%,7:18.14372%,1:17.46654%,14:0.00098%,3:0.00078%,15:0.00039%,8:0.00039%,4:0.00039%,2:0.00039%,21:0.0002%,17:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1388 (0.27134%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/511538
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79136.0000 - fp: 864.0000 - tn: 319136.0000 - fn: 864.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1939e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/511538
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79082.0000 - fp: 918.0000 - tn: 319082.0000 - fn: 918.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 3.6134e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/511538
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79084.0000 - fp: 916.0000 - tn: 319084.0000 - fn: 916.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/511538
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/511538
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0215 - tp: 79043.0000 - fp: 957.0000 - tn: 319043.0000 - fn: 957.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-40-41-batch-400000-500000
[INFO] processing batch 500000-600000/511538
[33m[INFO] loading file 42-42/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (355052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (355052, 17)

[INFO] analyzing data
[INFO] 355052 rows
[INFO] ** appi_name:[21:99.99042%,30:0.00253%,17:0.00141%,31:0.00113%,26:0.00113%,7:0.00113%,22:0.00084%,28:0.00028%,27:0.00028%,9:0.00028%,8:0.00028%,0:0.00028%]
[INFO] ** classification:[normal:64.34748%,Single Stage Single Point:35.65252%]
[INFO] ** dst:[21:43.29873%,10:21.03861%,8:18.20043%,9:17.45181%,16:0.00253%,6:0.00225%,18:0.00141%,2:0.00113%,22:0.00084%,15:0.00084%,17:0.00056%,25:0.00028%,7:0.00028%,0:0.00028%]
[INFO] ** i/f_dir:[1:99.99916%,0:0.00084%]
[INFO] ** i/f_name:[2:99.99916%,3:0.00084%]
[INFO] ** modbus_function_code:[0.02961:99.99042%,-33.760870000000004:0.00958%]
[INFO] ** modbus_function_description:[7:49.99606%,11:49.99437%,0:0.00958%]
[INFO] ** modbus_transaction_id:65536 (18.45814%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99493%,2:0.00422%,1:0.00084%]
[INFO] ** proxy_src_ip:[18:38.38733%,20:25.95028%,13:18.20071%,6:17.45181%,17:0.00253%,1:0.00253%,14:0.00169%,21:0.00113%,7:0.00084%,0:0.00056%,16:0.00028%,2:0.00028%]
[INFO] ** s_port:[1.45442:25.94972%,-0.32151:21.03861%,-1.27613:18.20043%,-0.23351:17.45153%,-0.33484:17.34873%,-71.14931:0.00113%,-71.14798:0.00113%,-71.33197:0.00084%,-3.3787199999999995:0.00056%,-0.08551:0.00056%,11.57001:0.00056%,13.431270000000001:0.00028%,-5.1466400000000005:0.00028%,0.31847:0.00028%,-1.02014:0.00028%,-64.19493:0.00028%,-1.2708:0.00028%,-58.035180000000004:0.00028%,7.66617:0.00028%,-0.24151:0.00028%,1.47576:0.00028%,14.4699:0.00028%,15.912510000000001:0.00028%,14.191239999999999:0.00028%,7.9608300000000005:0.00028%,-5.08665:0.00028%,10.192739999999999:0.00028%,-3.0613900000000003:0.00028%,1.45709:0.00028%,2.05573:0.00028%,-43.76509:0.00028%,11.862:0.00028%,-58.032509999999995:0.00028%]
[INFO] ** scada_tag:[3:25.94944%,1:21.03861%,5:18.20015%,4:17.45153%,2:17.34844%,0:0.01183%]
[INFO] ** service:[0.0048200000000000005:99.99042%,-211.09762999999998:0.00197%,-205.44247:0.00141%,-186.43601999999998:0.00141%,-211.08346:0.00113%,-211.08818:0.00113%,-211.73542999999998:0.00084%,-211.35747999999998:0.00056%,-186.44547:0.00028%,-183.8612:0.00028%,-185.9872:0.00028%,-202.75898:0.00028%]
[INFO] ** src:[22:38.38733%,9:25.95028%,7:18.20071%,1:17.45181%,3:0.00338%,2:0.00197%,4:0.00141%,21:0.00113%,14:0.00084%,8:0.00056%,17:0.00028%,15:0.00028%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:964 (0.27151%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/355052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0220 - tp: 79032.0000 - fp: 968.0000 - tn: 319032.0000 - fn: 968.0000 - accuracy: 0.9952 - precision: 0.9879 - recall: 0.9879 - auc: 0.9999 - val_loss: 1.2136e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/355052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/355052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.6545e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/355052
[33m[INFO] loading file 43-43/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555052, 17)

[INFO] analyzing data
[INFO] 555052 rows
[INFO] ** appi_name:[21:99.9991%,30:0.00054%,26:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.39649%,Single Stage Single Point:35.60351%]
[INFO] ** dst:[21:43.32639%,10:21.06812%,8:18.13434%,9:17.46899%,22:0.00108%,15:0.00054%,24:0.00018%,6:0.00018%,2:0.00018%]
[INFO] ** i/f_dir:[1:99.99982%,0:0.00018%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.9991%,-33.760870000000004:0.0009%]
[INFO] ** modbus_function_description:[7:50.00036%,11:49.99874%,0:0.0009%]
[INFO] ** modbus_transaction_id:65536 (11.80718%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99928%,1:0.00054%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.41514%,20:25.97991%,13:18.13452%,6:17.46917%,17:0.00054%,16:0.00036%,1:0.00036%]
[INFO] ** s_port:[1.45442:25.97919%,-0.32151:21.06812%,-1.27613:18.13416%,-0.23351:17.46863%,-0.33484:17.34702%,-71.33197:0.00054%,1.45709:0.00036%,1.47576:0.00036%,-0.24151:0.00036%,-1.02014:0.00036%,0.31847:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-1.2708:0.00018%]
[INFO] ** scada_tag:[3:25.97883%,1:21.06812%,5:18.13398%,4:17.46827%,2:17.34684%,0:0.00396%]
[INFO] ** service:[0.0048200000000000005:99.9991%,-211.73542999999998:0.00054%,-211.09762999999998:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.41514%,9:25.97991%,7:18.13452%,1:17.46917%,14:0.00054%,15:0.00036%,3:0.00036%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1509 (0.27187%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79109.0000 - fp: 891.0000 - tn: 319109.0000 - fn: 891.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.3422e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0215 - tp: 79070.0000 - fp: 930.0000 - tn: 319070.0000 - fn: 930.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79086.0000 - fp: 914.0000 - tn: 319086.0000 - fn: 914.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/555052
[33m[INFO] loading file 44-44/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555052, 17)

[INFO] analyzing data
[INFO] 555052 rows
[INFO] ** appi_name:[21:99.9982%,30:0.00072%,31:0.00054%,0:0.00036%,22:0.00018%]
[INFO] ** classification:[normal:64.3873%,Single Stage Single Point:35.6127%]
[INFO] ** dst:[21:43.3336%,10:21.05064%,8:18.15307%,9:17.45945%,22:0.00108%,15:0.00072%,18:0.00054%,25:0.00036%,24:0.00036%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99928%,0:0.00072%]
[INFO] ** i/f_name:[2:99.99928%,3:0.00072%]
[INFO] ** modbus_function_code:[0.02961:99.9982%,-33.760870000000004:0.0018%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99802%,0:0.0018%]
[INFO] ** modbus_transaction_id:65536 (11.80718%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9982%,2:0.00108%,1:0.00072%]
[INFO] ** proxy_src_ip:[18:38.43189%,20:25.95288%,13:18.15325%,6:17.45999%,17:0.00072%,7:0.00036%,16:0.00018%,5:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95216%,-0.32151:21.05064%,-1.27613:18.15271%,-0.23351:17.45927%,-0.33484:17.38125%,-71.33197:0.00072%,-0.24151:0.00054%,-0.08551:0.00036%,-64.19493:0.00036%,-1.27347:0.00036%,1.45709:0.00036%,-1.02014:0.00018%,-1.2708:0.00018%,1.47576:0.00018%,-71.14931:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,4.42897:0.00018%]
[INFO] ** scada_tag:[3:25.95162%,1:21.05064%,5:18.15271%,4:17.4589%,2:17.38107%,0:0.00504%]
[INFO] ** service:[0.0048200000000000005:99.9982%,-211.73542999999998:0.00072%,-186.43601999999998:0.00054%,-186.44547:0.00036%,-211.08818:0.00018%]
[INFO] ** src:[22:38.43189%,9:25.95288%,7:18.15325%,1:17.45999%,14:0.00072%,21:0.00036%,17:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1506 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79077.0000 - fp: 923.0000 - tn: 319077.0000 - fn: 923.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79082.0000 - fp: 918.0000 - tn: 319082.0000 - fn: 918.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 2.5228e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79091.0000 - fp: 909.0000 - tn: 319091.0000 - fn: 909.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/555052
[33m[INFO] loading file 45-45/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555052, 17)

[INFO] analyzing data
[INFO] 555052 rows
[INFO] ** appi_name:[21:99.99874%,30:0.00054%,31:0.00036%,26:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:64.41577%,Single Stage Single Point:35.58423%]
[INFO] ** dst:[21:43.32225%,10:21.09064%,8:18.12677%,9:17.45764%,22:0.00144%,15:0.00054%,18:0.00036%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.99874%,-33.760870000000004:0.00126%]
[INFO] ** modbus_function_description:[7:50.00036%,11:49.99838%,0:0.00126%]
[INFO] ** modbus_transaction_id:65536 (11.80718%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99892%,2:0.00054%,1:0.00054%]
[INFO] ** proxy_src_ip:[18:38.48396%,20:25.92964%,13:18.12659%,6:17.45818%,17:0.00054%,16:0.00036%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.92892%,-0.32151:21.09064%,-1.27613:18.12659%,-0.23351:17.45746%,-0.33484:17.39333%,1.45709:0.00054%,-0.24151:0.00054%,-71.33197:0.00054%,-1.02014:0.00036%,-0.08551:0.00036%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.92838%,1:21.09046%,5:18.12659%,4:17.45746%,2:17.39315%,0:0.00396%]
[INFO] ** service:[0.0048200000000000005:99.99874%,-211.73542999999998:0.00054%,-186.43601999999998:0.00036%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.48396%,9:25.92964%,7:18.12659%,1:17.45818%,14:0.00054%,15:0.00036%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1506 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79137.0000 - fp: 863.0000 - tn: 319137.0000 - fn: 863.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79109.0000 - fp: 891.0000 - tn: 319109.0000 - fn: 891.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79079.0000 - fp: 921.0000 - tn: 319079.0000 - fn: 921.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79070.0000 - fp: 930.0000 - tn: 319070.0000 - fn: 930.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/555052
[33m[INFO] loading file 46-46/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555052, 17)

[INFO] analyzing data
[INFO] 555052 rows
[INFO] ** appi_name:[21:99.9982%,30:0.00108%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.4273%,Single Stage Single Point:35.5727%]
[INFO] ** dst:[21:43.34693%,10:21.07766%,8:18.10101%,9:17.4717%,22:0.00108%,15:0.00108%,25:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9991%,0:0.0009%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.9982%,-33.760870000000004:0.0018%]
[INFO] ** modbus_function_description:[11:49.9991%,7:49.9991%,0:0.0018%]
[INFO] ** modbus_transaction_id:65536 (11.80718%)
[INFO] ** orig:[0:99.99964%,1:0.00036%]
[INFO] ** proto:[0:99.99856%,1:0.00108%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.45009%,20:25.9745%,13:18.10101%,6:17.47224%,17:0.00108%,16:0.00036%,7:0.00036%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.97414%,-0.32151:21.07748%,-1.27613:18.10083%,-0.23351:17.47152%,-0.33484:17.37261%,-71.33197:0.00108%,-0.24151:0.00054%,-1.02014:0.00036%,-71.14798:0.00018%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.97378%,1:21.0773%,5:18.10065%,4:17.47116%,2:17.37261%,0:0.0045%]
[INFO] ** service:[0.0048200000000000005:99.99838%,-211.73542999999998:0.00108%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.45009%,9:25.9745%,7:18.10101%,1:17.47224%,14:0.00108%,21:0.00036%,15:0.00036%,16:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.9991%,1:0.0009%]
[INFO] ** unixtime:1509 (0.27187%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0217 - tp: 79061.0000 - fp: 939.0000 - tn: 319061.0000 - fn: 939.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/555052
[33m[INFO] loading file 47-47/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555052, 17)

[INFO] analyzing data
[INFO] 555052 rows
[INFO] ** appi_name:[21:99.99946%,33:0.00018%,26:0.00018%,17:0.00018%]
[INFO] ** classification:[normal:64.39775%,Single Stage Single Point:35.60225%]
[INFO] ** dst:[21:43.31054%,10:21.08523%,8:18.12569%,9:17.4762%,22:0.00162%,24:0.00036%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99946%,-33.760870000000004:0.00054%]
[INFO] ** modbus_function_description:[7:50.0009%,11:49.99856%,0:0.00054%]
[INFO] ** modbus_transaction_id:65536 (11.80718%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.4573%,20:25.93919%,13:18.12605%,6:17.47656%,16:0.00036%,7:0.00036%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.93829%,-0.32151:21.08523%,-1.27613:18.12551%,-0.23351:17.47602%,-0.33484:17.37207%,1.45709:0.00054%,-0.24151:0.00054%,-1.27347:0.00036%,-1.02014:0.00036%,-71.14798:0.00018%,-61.95635:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%]
[INFO] ** scada_tag:[3:25.93775%,1:21.08505%,5:18.12533%,4:17.47584%,2:17.37189%,0:0.00414%]
[INFO] ** service:[0.0048200000000000005:99.99964%,-211.08346:0.00018%,-205.44247:0.00018%]
[INFO] ** src:[22:38.4573%,9:25.93919%,7:18.12605%,1:17.47656%,21:0.00036%,15:0.00036%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1507 (0.27151%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79079.0000 - fp: 921.0000 - tn: 319079.0000 - fn: 921.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79089.0000 - fp: 911.0000 - tn: 319089.0000 - fn: 911.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/555052
[33m[INFO] loading file 48-48/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555052, 17)

[INFO] analyzing data
[INFO] 555052 rows
[INFO] ** appi_name:[21:99.99676%,30:0.00252%,33:0.00018%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.42766%,Single Stage Single Point:35.57234%]
[INFO] ** dst:[21:43.33774%,10:21.08613%,8:18.10389%,9:17.46809%,15:0.00252%,22:0.0009%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99784%,0:0.00216%]
[INFO] ** i/f_name:[2:99.99748%,3:0.00252%]
[INFO] ** modbus_function_code:[0.02961:99.99676%,-33.760870000000004:0.00324%]
[INFO] ** modbus_function_description:[7:49.99892%,11:49.99784%,0:0.00324%]
[INFO] ** modbus_transaction_id:65536 (11.80718%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99694%,1:0.00252%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.46324%,20:25.96081%,13:18.10425%,6:17.46809%,17:0.00252%,14:0.00054%,16:0.00036%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.96045%,-0.32151:21.08613%,-1.27613:18.10389%,-0.23351:17.46791%,-0.33484:17.37711%,-71.33197:0.00252%,-1.02014:0.00036%,-71.14798:0.00018%,-1.27347:0.00018%,11.862:0.00018%,1.45709:0.00018%,-61.95635:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,13.431270000000001:0.00018%,-1.2708:0.00018%]
[INFO] ** scada_tag:[3:25.96009%,1:21.08613%,5:18.10389%,4:17.46791%,2:17.37693%,0:0.00504%]
[INFO] ** service:[0.0048200000000000005:99.99694%,-211.73542999999998:0.00252%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.46324%,9:25.96081%,7:18.10425%,1:17.46809%,14:0.00252%,2:0.00054%,15:0.00036%,8:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1506 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79137.0000 - fp: 863.0000 - tn: 319137.0000 - fn: 863.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79064.0000 - fp: 936.0000 - tn: 319064.0000 - fn: 936.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/555052
[33m[INFO] loading file 49-49/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555052, 17)

[INFO] analyzing data
[INFO] 555052 rows
[INFO] ** appi_name:[21:99.9973%,30:0.0009%,17:0.00072%,26:0.00036%,22:0.00036%,28:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.36802%,Single Stage Single Point:35.63198%]
[INFO] ** dst:[21:43.30892%,10:21.05496%,8:18.14064%,9:17.49115%,22:0.00126%,15:0.0009%,16:0.00072%,6:0.00072%,24:0.00036%,17:0.00036%]
[INFO] ** i/f_dir:[1:99.9991%,0:0.0009%]
[INFO] ** i/f_name:[2:99.9991%,3:0.0009%]
[INFO] ** modbus_function_code:[0.02961:99.9973%,-33.760870000000004:0.0027%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99766%,0:0.0027%]
[INFO] ** modbus_transaction_id:65536 (11.80718%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99838%,1:0.0009%,2:0.00072%]
[INFO] ** proxy_src_ip:[18:38.4164%,20:25.94802%,13:18.14082%,6:17.49169%,17:0.0009%,1:0.00072%,14:0.00054%,21:0.00036%,16:0.00036%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.9473%,-0.32151:21.05496%,-1.27613:18.14028%,-0.23351:17.49097%,-0.33484:17.36144%,-71.33197:0.0009%,-0.24151:0.00054%,-71.14931:0.00036%,-1.02014:0.00036%,-1.27347:0.00036%,-71.14798:0.00036%,1.45709:0.00036%,1.47576:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,-0.24950999999999998:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,-5.08665:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:25.94694%,1:21.05478%,5:18.1401%,4:17.49061%,2:17.36144%,0:0.00613%]
[INFO] ** service:[0.0048200000000000005:99.9973%,-211.73542999999998:0.0009%,-205.44247:0.00072%,-211.08346:0.00036%,-211.08818:0.00036%,-211.09762999999998:0.00018%,-185.9872:0.00018%]
[INFO] ** src:[22:38.4164%,9:25.94802%,7:18.14082%,1:17.49169%,14:0.0009%,3:0.00072%,2:0.00054%,15:0.00036%,4:0.00036%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1507 (0.27151%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79169.0000 - fp: 831.0000 - tn: 319169.0000 - fn: 831.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-7-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79074.0000 - fp: 926.0000 - tn: 319074.0000 - fn: 926.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1923e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79119.0000 - fp: 881.0000 - tn: 319119.0000 - fn: 881.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/555052
[33m[INFO] loading file 50-50/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (405034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (405034, 17)

[INFO] analyzing data
[INFO] 405034 rows
[INFO] ** appi_name:[21:99.99753%,30:0.00099%,7:0.00074%,31:0.00025%,22:0.00025%,8:0.00025%]
[INFO] ** classification:[normal:64.31263%,Single Stage Single Point:35.68737%]
[INFO] ** dst:[21:43.26452%,10:21.04515%,8:18.21279%,9:17.47434%,15:0.00099%,22:0.00049%,16:0.00049%,2:0.00049%,24:0.00025%,18:0.00025%,6:0.00025%]
[INFO] ** i/f_dir:[1:99.99901%,0:0.00099%]
[INFO] ** i/f_name:[2:99.99901%,3:0.00099%]
[INFO] ** modbus_function_code:[0.02961:99.99753%,-33.760870000000004:0.00247%]
[INFO] ** modbus_function_description:[11:49.99901%,7:49.99852%,0:0.00247%]
[INFO] ** modbus_transaction_id:65536 (16.18037%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99852%,1:0.00099%,2:0.00049%]
[INFO] ** proxy_src_ip:[18:38.37382%,20:25.93609%,13:18.21304%,6:17.47434%,17:0.00099%,1:0.00074%,21:0.00025%,16:0.00025%,14:0.00025%,7:0.00025%]
[INFO] ** s_port:[1.45442:25.9356%,-0.32151:21.04515%,-1.27613:18.21255%,-0.23351:17.47434%,-0.33484:17.32867%,-71.33197:0.00099%,-3.3787199999999995:0.00025%,4.33564:0.00025%,15.912510000000001:0.00025%,7.9608300000000005:0.00025%,1.46509:0.00025%,1.45709:0.00025%,-1.27347:0.00025%,-71.14931:0.00025%,-1.02014:0.00025%,-1.2708:0.00025%,0.31847:0.00025%]
[INFO] ** scada_tag:[3:25.93535%,1:21.0449%,5:18.2123%,4:17.47434%,2:17.32842%,0:0.00469%]
[INFO] ** service:[0.0048200000000000005:99.99753%,-211.73542999999998:0.00099%,-211.09762999999998:0.00074%,-186.43601999999998:0.00025%,-211.35747999999998:0.00025%,-211.08818:0.00025%]
[INFO] ** src:[22:38.37382%,9:25.93609%,7:18.21304%,1:17.47434%,14:0.00099%,3:0.00074%,21:0.00025%,15:0.00025%,4:0.00025%,2:0.00025%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1101 (0.27183%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/405034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/405034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.2578e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/405034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 4.6783e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/405034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-49-50-batch-300000-400000
[INFO] processing batch 400000-500000/405034
[33m[INFO] epoch 8/10[0m
[33m[INFO] loading file 1-1/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99287%,30:0.00119%,22:0.00099%,17:0.00079%,31:0.00059%,26:0.00059%,7:0.00059%,23:0.0004%,18:0.0004%,0:0.0004%,28:0.0002%,27:0.0002%,24:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:79.14932%,Single Stage Single Point:20.85068%]
[INFO] ** dst:[21:43.26818%,10:21.04096%,8:18.16393%,9:17.51941%,6:0.00158%,16:0.00119%,15:0.00119%,22:0.00099%,18:0.00059%,26:0.0004%,25:0.0004%,19:0.0004%,17:0.0004%,24:0.0002%,7:0.0002%]
[INFO] ** i/f_dir:[1:99.99881%,0:0.00119%]
[INFO] ** i/f_name:[2:99.99881%,3:0.00119%]
[INFO] ** modbus_function_code:[0.02961:99.99287%,-33.760870000000004:0.00693%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.99743%,11:49.99545%,0:0.00693%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99604%,2:0.00277%,1:0.00119%]
[INFO] ** proxy_src_ip:[18:38.40652%,20:25.90202%,13:18.16412%,6:17.51981%,11:0.00139%,10:0.00139%,17:0.00119%,14:0.00099%,1:0.00099%,7:0.00059%,21:0.0004%,16:0.0004%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.90162%,-0.32151:21.04017%,-1.27613:18.16373%,-0.23351:17.51922%,-0.33484:17.36636%,-71.33197:0.00119%,-71.14931:0.00099%,-2.1481:0.00079%,-0.24151:0.00059%,-71.14798:0.00059%,-2.42942:0.0004%,4.44364:0.0004%,-1.02014:0.0004%,-64.19493:0.0004%,-5.1466400000000005:0.0002%,-1.2708:0.0002%,-58.035180000000004:0.0002%,4.076980000000001:0.0002%,-5.08665:0.0002%,1.47576:0.0002%,1.46509:0.0002%,4.29964:0.0002%,14.253910000000001:0.0002%,-68.79874000000001:0.0002%,6.1115699999999995:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,10.67005:0.0002%,-1.27347:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:25.90142%,1:21.03997%,5:18.16353%,4:17.51902%,2:17.36616%,0:0.0099%]
[INFO] ** service:[0.0048200000000000005:99.99366%,-211.73542999999998:0.00119%,-211.08818:0.00099%,-205.44247:0.00079%,-211.07873999999998:0.00079%,-211.09762999999998:0.00059%,-211.08346:0.00059%,-186.43601999999998:0.00059%,-186.44547:0.0004%,-185.9872:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.40652%,9:25.90202%,7:18.16412%,1:17.51981%,11:0.00139%,10:0.00139%,14:0.00119%,3:0.00099%,2:0.00099%,21:0.00059%,15:0.0004%,4:0.0004%,8:0.0002%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** unixtime:1371 (0.27147%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4136 - tp: 76195.0000 - fp: 3805.0000 - tn: 316195.0000 - fn: 3805.0000 - accuracy: 0.9810 - precision: 0.9524 - recall: 0.9524 - auc: 0.9825 - val_loss: 0.0171 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0264 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0025 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0091 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7655 - val_tp: 12747.0000 - val_fp: 7253.0000 - val_tn: 72747.0000 - val_fn: 7253.0000 - val_accuracy: 0.8549 - val_precision: 0.6374 - val_recall: 0.6374 - val_auc: 0.7732
[INFO] saving weights to checkpoints/lstm-epoch-8-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8613 - tp: 55671.0000 - fp: 24329.0000 - tn: 295671.0000 - fn: 24329.0000 - accuracy: 0.8784 - precision: 0.6959 - recall: 0.6959 - auc: 0.9268 - val_loss: 0.1306 - val_tp: 19985.0000 - val_fp: 15.0000 - val_tn: 79985.0000 - val_fn: 15.0000 - val_accuracy: 0.9997 - val_precision: 0.9992 - val_recall: 0.9992 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1270 - tp: 76469.0000 - fp: 3531.0000 - tn: 316469.0000 - fn: 3531.0000 - accuracy: 0.9823 - precision: 0.9559 - recall: 0.9559 - auc: 0.9985 - val_loss: 0.0121 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 2-2/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99881%,30:0.0004%,7:0.0004%,31:0.0002%,8:0.0002%]
[INFO] ** classification:[normal:72.58897%,Single Stage Single Point:27.41103%]
[INFO] ** dst:[21:43.31253%,10:21.03522%,8:18.13125%,9:17.51882%,22:0.00079%,15:0.0004%,2:0.0004%,24:0.0002%,18:0.0002%,16:0.0002%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** i/f_name:[2:99.9996%,3:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.99881%,-33.760870000000004:0.00119%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.99901%,0:0.00119%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99941%,1:0.0004%,2:0.0002%]
[INFO] ** proxy_src_ip:[18:38.38613%,20:25.96201%,13:18.13145%,6:17.51902%,1:0.00059%,17:0.0004%,16:0.0002%,14:0.0002%]
[INFO] ** s_port:[1.45442:25.96142%,-0.32151:21.03522%,-1.27613:18.13106%,-0.23351:17.51862%,-0.33484:17.35091%,-71.33197:0.0004%,1.45709:0.0004%,-1.2708:0.0002%,-1.02014:0.0002%,-0.24151:0.0002%,4.076980000000001:0.0002%,12.60597:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,-3.3787199999999995:0.0002%,-0.24950999999999998:0.0002%,4.29964:0.0002%]
[INFO] ** scada_tag:[3:25.96102%,1:21.03522%,5:18.13106%,4:17.51842%,2:17.35071%,0:0.00356%]
[INFO] ** service:[0.0048200000000000005:99.99881%,-211.09762999999998:0.0004%,-211.73542999999998:0.0004%,-186.43601999999998:0.0002%,-211.35747999999998:0.0002%]
[INFO] ** src:[22:38.38613%,9:25.96201%,7:18.13145%,1:17.51902%,3:0.00059%,14:0.0004%,15:0.0002%,2:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1374 (0.27206%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1125 - tp: 76356.0000 - fp: 3644.0000 - tn: 316356.0000 - fn: 3644.0000 - accuracy: 0.9818 - precision: 0.9545 - recall: 0.9545 - auc: 0.9980 - val_loss: 0.0050 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5504 - tp: 64939.0000 - fp: 15061.0000 - tn: 304939.0000 - fn: 15061.0000 - accuracy: 0.9247 - precision: 0.8117 - recall: 0.8117 - auc: 0.9573 - val_loss: 0.2111 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2492 - tp: 74761.0000 - fp: 5239.0000 - tn: 314761.0000 - fn: 5239.0000 - accuracy: 0.9738 - precision: 0.9345 - recall: 0.9345 - auc: 0.9875 - val_loss: 1.1069 - val_tp: 10577.0000 - val_fp: 9423.0000 - val_tn: 70577.0000 - val_fn: 9423.0000 - val_accuracy: 0.8115 - val_precision: 0.5289 - val_recall: 0.5289 - val_auc: 0.9268
[INFO] saving weights to checkpoints/lstm-epoch-8-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1527 - tp: 75426.0000 - fp: 4574.0000 - tn: 315426.0000 - fn: 4574.0000 - accuracy: 0.9771 - precision: 0.9428 - recall: 0.9428 - auc: 0.9964 - val_loss: 0.0134 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4700 - tp: 63336.0000 - fp: 16664.0000 - tn: 303336.0000 - fn: 16664.0000 - accuracy: 0.9167 - precision: 0.7917 - recall: 0.7917 - auc: 0.9682 - val_loss: 0.2309 - val_tp: 19827.0000 - val_fp: 173.0000 - val_tn: 79827.0000 - val_fn: 173.0000 - val_accuracy: 0.9965 - val_precision: 0.9913 - val_recall: 0.9913 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-8-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 3-3/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99089%,30:0.00238%,22:0.00119%,31:0.00099%,26:0.00099%,17:0.00099%,7:0.00079%,27:0.0004%,0:0.0004%,28:0.0002%,23:0.0002%,15:0.0002%,8:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:86.84405%,Single Stage Single Point:13.15595%]
[INFO] ** dst:[21:43.30223%,10:21.09026%,8:18.15442%,9:17.44298%,6:0.00238%,15:0.00158%,18:0.00139%,16:0.00139%,22:0.00099%,2:0.0004%,7:0.0004%,25:0.0004%,17:0.0004%,12:0.0002%,24:0.0002%,19:0.0002%,0:0.0002%]
[INFO] ** i/f_dir:[1:99.99842%,0:0.00158%]
[INFO] ** i/f_name:[2:99.99842%,3:0.00158%]
[INFO] ** modbus_function_code:[0.02961:99.99089%,-33.760870000000004:0.00891%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.99604%,11:49.99485%,0:0.00891%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.99881%,2:0.00119%]
[INFO] ** proto:[0:99.99366%,2:0.00475%,1:0.00158%]
[INFO] ** proxy_src_ip:[18:38.41979%,20:25.9731%,13:18.15462%,6:17.44338%,17:0.00238%,1:0.00158%,14:0.00139%,7:0.00099%,11:0.00079%,10:0.00079%,21:0.00059%,16:0.0002%,15:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.97231%,-0.32151:21.09007%,-1.27613:18.15403%,-0.23351:17.44279%,-0.33484:17.32972%,-71.33197:0.00158%,-71.14798:0.00119%,-71.14931:0.00119%,-64.19493:0.0004%,-0.08551:0.0004%,1.45709:0.0004%,-0.24151:0.0004%,13.431270000000001:0.0002%,14.4699:0.0002%,4.076980000000001:0.0002%,-5.1466400000000005:0.0002%,-1.02014:0.0002%,1.47576:0.0002%,-1.2708:0.0002%,-58.035180000000004:0.0002%,-58.032509999999995:0.0002%,12.60597:0.0002%,-5.08665:0.0002%,1.46509:0.0002%,-2.1481:0.0002%,-1.27347:0.0002%,10.67005:0.0002%,-43.76509:0.0002%,2.05573:0.0002%,6.1115699999999995:0.0002%,4.44364:0.0002%,13.86459:0.0002%,4.29964:0.0002%,-0.24950999999999998:0.0002%,-3.3787199999999995:0.0002%,10.192739999999999:0.0002%,-68.79874000000001:0.0002%,14.253910000000001:0.0002%,4.90362:0.0002%,-68.36943000000001:0.0002%]
[INFO] ** scada_tag:[3:25.97191%,1:21.08987%,5:18.15383%,4:17.44259%,2:17.32953%,0:0.01228%]
[INFO] ** service:[0.0048200000000000005:99.99109%,-211.73542999999998:0.00158%,-186.43601999999998:0.00139%,-211.08346:0.00119%,-211.08818:0.00119%,-205.44247:0.00099%,-211.09762999999998:0.00079%,-186.44547:0.0004%,-202.75898:0.0004%,-183.8612:0.0002%,-185.9872:0.0002%,-201.23771000000002:0.0002%,-211.35747999999998:0.0002%,-211.07873999999998:0.0002%]
[INFO] ** src:[22:38.41979%,9:25.9731%,7:18.15462%,1:17.44338%,21:0.00218%,3:0.00178%,2:0.00139%,11:0.00079%,10:0.00079%,4:0.00079%,14:0.0004%,8:0.0004%,17:0.0002%,15:0.0002%,13:0.0002%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** unixtime:1371 (0.27147%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2287 - tp: 73217.0000 - fp: 6783.0000 - tn: 313217.0000 - fn: 6783.0000 - accuracy: 0.9661 - precision: 0.9152 - recall: 0.9152 - auc: 0.9916 - val_loss: 0.0437 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3647 - tp: 63624.0000 - fp: 16376.0000 - tn: 303624.0000 - fn: 16376.0000 - accuracy: 0.9181 - precision: 0.7953 - recall: 0.7953 - auc: 0.9763 - val_loss: 0.4369 - val_tp: 10716.0000 - val_fp: 9284.0000 - val_tn: 70716.0000 - val_fn: 9284.0000 - val_accuracy: 0.8143 - val_precision: 0.5358 - val_recall: 0.5358 - val_auc: 0.9451
[INFO] saving weights to checkpoints/lstm-epoch-8-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0546 - tp: 79161.0000 - fp: 839.0000 - tn: 319161.0000 - fn: 839.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 0.0037 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0164 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.8102e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0119 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8236e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 4-4/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99762%,30:0.00139%,31:0.0004%,33:0.0002%,26:0.0002%,9:0.0002%]
[INFO] ** classification:[normal:91.33128%,Single Stage Single Point:8.66872%]
[INFO] ** dst:[21:43.35807%,10:20.93522%,8:18.17363%,9:17.52951%,15:0.00139%,22:0.00119%,18:0.0004%,24:0.0002%,6:0.0002%,0:0.0002%]
[INFO] ** i/f_dir:[1:99.99881%,0:0.00119%]
[INFO] ** i/f_name:[2:99.99861%,3:0.00139%]
[INFO] ** modbus_function_code:[0.02961:99.99762%,-33.760870000000004:0.00238%]
[INFO] ** modbus_function_description:[7:49.9996%,11:49.99802%,0:0.00238%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.99881%,2:0.00119%]
[INFO] ** proto:[0:99.99802%,1:0.00139%,2:0.00059%]
[INFO] ** proxy_src_ip:[18:38.25208%,20:26.04161%,13:18.17363%,6:17.52991%,17:0.00139%,21:0.0004%,16:0.0004%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:26.04082%,-0.32151:20.93503%,-1.27613:18.17323%,-0.23351:17.52931%,-0.33484:17.31705%,-71.33197:0.00139%,1.45709:0.0004%,-0.24151:0.0004%,-1.02014:0.0004%,-0.08551:0.0004%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,14.4699:0.0002%,-49.275529999999996:0.0002%,-1.2708:0.0002%,-71.14798:0.0002%]
[INFO] ** scada_tag:[3:26.04062%,1:20.93483%,5:18.17323%,4:17.52892%,2:17.31685%,0:0.00554%]
[INFO] ** service:[0.0048200000000000005:99.99782%,-211.73542999999998:0.00139%,-186.43601999999998:0.0004%,-183.8612:0.0002%,-211.08346:0.0002%]
[INFO] ** src:[22:38.25208%,9:26.04161%,7:18.17363%,1:17.52991%,21:0.00119%,15:0.0004%,4:0.0004%,17:0.0002%,14:0.0002%,8:0.0002%,3:0.0002%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** unixtime:1382 (0.27364%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0097 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6005e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0080 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.1458e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0067 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.4425e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3325 - tp: 74603.0000 - fp: 5397.0000 - tn: 314603.0000 - fn: 5397.0000 - accuracy: 0.9730 - precision: 0.9325 - recall: 0.9325 - auc: 0.9794 - val_loss: 1.6479 - val_tp: 7790.0000 - val_fp: 12210.0000 - val_tn: 67790.0000 - val_fn: 12210.0000 - val_accuracy: 0.7558 - val_precision: 0.3895 - val_recall: 0.3895 - val_auc: 0.8671
[INFO] saving weights to checkpoints/lstm-epoch-8-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6318 - tp: 54398.0000 - fp: 25602.0000 - tn: 294398.0000 - fn: 25602.0000 - accuracy: 0.8720 - precision: 0.6800 - recall: 0.6800 - auc: 0.9337 - val_loss: 0.3821 - val_tp: 18020.0000 - val_fp: 1980.0000 - val_tn: 78020.0000 - val_fn: 1980.0000 - val_accuracy: 0.9604 - val_precision: 0.9010 - val_recall: 0.9010 - val_auc: 0.9937
[INFO] saving weights to checkpoints/lstm-epoch-8-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 5-5/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99683%,30:0.00218%,37:0.0002%,26:0.0002%,12:0.0002%,6:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:88.84333%,Single Stage Single Point:11.15667%]
[INFO] ** dst:[21:43.36599%,10:20.76137%,8:18.24986%,9:17.61901%,15:0.00218%,22:0.00079%,25:0.0002%,24:0.0002%,6:0.0002%,2:0.0002%]
[INFO] ** i/f_dir:[1:99.99802%,0:0.00198%]
[INFO] ** i/f_name:[2:99.99782%,3:0.00218%]
[INFO] ** modbus_function_code:[0.02961:99.99683%,-33.760870000000004:0.00317%]
[INFO] ** modbus_function_description:[7:49.99881%,11:49.99802%,0:0.00317%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.99822%,2:0.00178%]
[INFO] ** proto:[0:99.99743%,1:0.00218%,2:0.0004%]
[INFO] ** proxy_src_ip:[18:37.98992%,20:26.13725%,13:18.25006%,6:17.61941%,17:0.00218%,21:0.0002%,16:0.0002%,7:0.0002%,5:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:26.13705%,-0.32151:20.76098%,-1.27613:18.24986%,-0.23351:17.61901%,-0.33484:17.22894%,-71.33197:0.00218%,-0.24151:0.0004%,-71.14798:0.0002%,-1.27347:0.0002%,1.45709:0.0002%,2.22906:0.0002%,-49.275529999999996:0.0002%,-61.95768:0.0002%,-1.02014:0.0002%,-64.19493:0.0002%]
[INFO] ** scada_tag:[3:26.13666%,1:20.76078%,5:18.24966%,4:17.61901%,2:17.22894%,0:0.00495%]
[INFO] ** service:[0.0048200000000000005:99.99723%,-211.73542999999998:0.00218%,-186.44547:0.0002%,-211.08346:0.0002%,-211.35747999999998:0.0002%]
[INFO] ** src:[22:37.98992%,9:26.13725%,7:18.25006%,1:17.61941%,21:0.00198%,14:0.0004%,16:0.0002%,15:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** unixtime:1380 (0.27325%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4595 - tp: 63942.0000 - fp: 16058.0000 - tn: 303942.0000 - fn: 16058.0000 - accuracy: 0.9197 - precision: 0.7993 - recall: 0.7993 - auc: 0.9684 - val_loss: 0.5064 - val_tp: 12834.0000 - val_fp: 7166.0000 - val_tn: 72834.0000 - val_fn: 7166.0000 - val_accuracy: 0.8567 - val_precision: 0.6417 - val_recall: 0.6417 - val_auc: 0.9679
[INFO] saving weights to checkpoints/lstm-epoch-8-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1338 - tp: 73493.0000 - fp: 6507.0000 - tn: 313493.0000 - fn: 6507.0000 - accuracy: 0.9675 - precision: 0.9187 - recall: 0.9187 - auc: 0.9972 - val_loss: 1.7978 - val_tp: 17596.0000 - val_fp: 2404.0000 - val_tn: 77596.0000 - val_fn: 2404.0000 - val_accuracy: 0.9519 - val_precision: 0.8798 - val_recall: 0.8798 - val_auc: 0.9249
[INFO] saving weights to checkpoints/lstm-epoch-8-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2865 - tp: 77933.0000 - fp: 2067.0000 - tn: 317933.0000 - fn: 2067.0000 - accuracy: 0.9897 - precision: 0.9742 - recall: 0.9742 - auc: 0.9865 - val_loss: 4.6134e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0139 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.5022e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0103 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7589e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 6-6/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99545%,30:0.00356%,31:0.0002%,27:0.0002%,26:0.0002%,5:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:91.99955%,Single Stage Single Point:8.00045%]
[INFO] ** dst:[21:43.37589%,10:20.73187%,8:18.28669%,9:17.6004%,15:0.00356%,22:0.0004%,25:0.0002%,24:0.0002%,18:0.0002%,12:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99663%,0:0.00337%]
[INFO] ** i/f_name:[2:99.99644%,3:0.00356%]
[INFO] ** modbus_function_code:[0.02961:99.99545%,-33.760870000000004:0.00455%]
[INFO] ** modbus_function_description:[7:49.99822%,11:49.99723%,0:0.00455%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.9996%,1:0.0004%]
[INFO] ** proto:[0:99.99545%,1:0.00356%,2:0.00099%]
[INFO] ** proxy_src_ip:[18:37.94576%,20:26.1622%,13:18.28689%,6:17.6006%,17:0.00356%,14:0.00059%,16:0.0002%,11:0.0002%]
[INFO] ** s_port:[1.45442:26.1618%,-0.32151:20.73187%,-1.27613:18.28629%,-0.23351:17.6002%,-0.33484:17.21389%,-71.33197:0.00356%,-0.24151:0.0002%,-1.2708:0.0002%,-64.19493:0.0002%,-1.02014:0.0002%,13.431270000000001:0.0002%,4.90362:0.0002%,-71.14798:0.0002%,1.47576:0.0002%,1.46509:0.0002%,-0.24950999999999998:0.0002%,-1.27347:0.0002%,-68.36943000000001:0.0002%]
[INFO] ** scada_tag:[3:26.1616%,1:20.73167%,5:18.2861%,4:17.59981%,2:17.21369%,0:0.00713%]
[INFO] ** service:[0.0048200000000000005:99.99545%,-211.73542999999998:0.00356%,-186.44547:0.0002%,-211.08346:0.0002%,-186.43601999999998:0.0002%,-201.23771000000002:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:37.94576%,9:26.1622%,7:18.28689%,1:17.6006%,14:0.00356%,2:0.00059%,15:0.0002%,10:0.0002%]
[INFO] ** type:[0:99.99901%,1:0.00099%]
[INFO] ** unixtime:1383 (0.27384%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0091 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4169e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0078 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.0935e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0074 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.2315e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0066 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9254 - val_tp: 17432.0000 - val_fp: 2568.0000 - val_tn: 77432.0000 - val_fn: 2568.0000 - val_accuracy: 0.9486 - val_precision: 0.8716 - val_recall: 0.8716 - val_auc: 0.9197
[INFO] saving weights to checkpoints/lstm-epoch-8-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4621 - tp: 70312.0000 - fp: 9688.0000 - tn: 310312.0000 - fn: 9688.0000 - accuracy: 0.9516 - precision: 0.8789 - recall: 0.8789 - auc: 0.9767 - val_loss: 0.0013 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 7-7/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99525%,30:0.00139%,22:0.00099%,17:0.00079%,26:0.00059%,31:0.0004%,28:0.0002%,27:0.0002%,7:0.0002%]
[INFO] ** classification:[normal:82.5285%,Single Stage Single Point:17.4715%]
[INFO] ** dst:[21:43.35886%,10:20.75583%,8:18.24313%,9:17.63564%,6:0.00158%,22:0.00139%,15:0.00139%,16:0.00079%,24:0.0004%,18:0.0004%,17:0.0004%,7:0.0002%]
[INFO] ** i/f_dir:[1:99.99861%,0:0.00139%]
[INFO] ** i/f_name:[2:99.99861%,3:0.00139%]
[INFO] ** modbus_function_code:[0.02961:99.99525%,-33.760870000000004:0.00475%]
[INFO] ** modbus_function_description:[7:49.99842%,11:49.99683%,0:0.00475%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99644%,2:0.00218%,1:0.00139%]
[INFO] ** proxy_src_ip:[18:37.98378%,20:26.13171%,13:18.24352%,6:17.63584%,17:0.00139%,11:0.00079%,1:0.00079%,21:0.00059%,16:0.0004%,14:0.0004%,7:0.0004%,10:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:26.13072%,-0.32151:20.75583%,-1.27613:18.24293%,-0.23351:17.63545%,-0.33484:17.22795%,-71.33197:0.00139%,-71.14931:0.00099%,-71.14798:0.00059%,1.45709:0.00059%,-1.02014:0.0004%,-1.27347:0.0004%,-0.24151:0.0004%,-58.035180000000004:0.0002%,-1.2708:0.0002%,-5.1466400000000005:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-5.08665:0.0002%,14.253910000000001:0.0002%,-68.79874000000001:0.0002%,6.1115699999999995:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:26.13032%,1:20.75583%,5:18.24293%,4:17.63525%,2:17.22795%,0:0.00772%]
[INFO] ** service:[0.0048200000000000005:99.99525%,-211.73542999999998:0.00139%,-211.08818:0.00099%,-205.44247:0.00079%,-211.08346:0.00059%,-186.43601999999998:0.0004%,-211.09762999999998:0.0002%,-185.9872:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:37.98378%,9:26.13171%,7:18.24352%,1:17.63584%,14:0.00139%,10:0.00079%,3:0.00079%,4:0.00059%,21:0.0004%,15:0.0004%,2:0.0004%,11:0.0002%,8:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1380 (0.27325%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0609 - tp: 78693.0000 - fp: 1307.0000 - tn: 318693.0000 - fn: 1307.0000 - accuracy: 0.9935 - precision: 0.9837 - recall: 0.9837 - auc: 0.9985 - val_loss: 1.3322e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0216 - tp: 79175.0000 - fp: 825.0000 - tn: 319175.0000 - fn: 825.0000 - accuracy: 0.9959 - precision: 0.9897 - recall: 0.9897 - auc: 0.9999 - val_loss: 5.7952e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5424 - tp: 65602.0000 - fp: 14398.0000 - tn: 305602.0000 - fn: 14398.0000 - accuracy: 0.9280 - precision: 0.8200 - recall: 0.8200 - auc: 0.9707 - val_loss: 0.3140 - val_tp: 16511.0000 - val_fp: 3489.0000 - val_tn: 76511.0000 - val_fn: 3489.0000 - val_accuracy: 0.9302 - val_precision: 0.8256 - val_recall: 0.8256 - val_auc: 0.9839
[INFO] saving weights to checkpoints/lstm-epoch-8-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1240 - tp: 78102.0000 - fp: 1898.0000 - tn: 318102.0000 - fn: 1898.0000 - accuracy: 0.9905 - precision: 0.9763 - recall: 0.9763 - auc: 0.9987 - val_loss: 0.0522 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0398 - tp: 79977.0000 - fp: 23.0000 - tn: 319977.0000 - fn: 23.0000 - accuracy: 0.9999 - precision: 0.9997 - recall: 0.9997 - auc: 1.0000 - val_loss: 0.0179 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 8-8/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99703%,30:0.00099%,0:0.00059%,24:0.0002%,23:0.0002%,22:0.0002%,18:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:94.34137%,Single Stage Single Point:5.65863%]
[INFO] ** dst:[21:43.4343%,10:20.81365%,8:18.16927%,9:17.57901%,22:0.00139%,15:0.00099%,25:0.00059%,19:0.0004%,26:0.0002%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.99941%,0:0.00059%]
[INFO] ** i/f_name:[2:99.99901%,3:0.00099%]
[INFO] ** modbus_function_code:[0.02961:99.99703%,-33.760870000000004:0.00277%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9996%,11:49.99743%,0:0.00277%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.9996%,2:0.0004%]
[INFO] ** proto:[0:99.99822%,1:0.00099%,2:0.00079%]
[INFO] ** proxy_src_ip:[18:38.1008%,20:26.14774%,13:18.16848%,6:17.57941%,10:0.00119%,17:0.00099%,16:0.00059%,14:0.0004%,11:0.0002%,5:0.0002%]
[INFO] ** s_port:[1.45442:26.14715%,-0.32151:20.81365%,-1.27613:18.16828%,-0.23351:17.57882%,-0.33484:17.28715%,-71.33197:0.00099%,-15.039579999999999:0.00079%,-1.02014:0.00059%,-64.19493:0.00059%,1.45709:0.0004%,-0.24151:0.0004%,4.66896:0.0004%,-1.27347:0.0002%,-0.24950999999999998:0.0002%,1.47576:0.0002%,-71.14931:0.0002%]
[INFO] ** scada_tag:[3:26.14675%,1:20.81345%,5:18.16828%,4:17.57862%,2:17.28695%,0:0.00594%]
[INFO] ** service:[0.0048200000000000005:99.99782%,-211.73542999999998:0.00099%,-186.44547:0.00059%,-211.07873999999998:0.0004%,-211.08818:0.0002%]
[INFO] ** src:[22:38.1008%,9:26.14774%,7:18.16848%,1:17.57941%,11:0.00119%,15:0.00059%,14:0.00059%,21:0.0004%,2:0.0004%,16:0.0002%,10:0.0002%]
[INFO] ** type:[0:99.99941%,1:0.0004%,2:0.0002%]
[INFO] ** unixtime:1384 (0.27404%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0195 - tp: 79972.0000 - fp: 28.0000 - tn: 319972.0000 - fn: 28.0000 - accuracy: 0.9999 - precision: 0.9997 - recall: 0.9997 - auc: 0.9999 - val_loss: 0.0098 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0132 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0071 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0105 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0056 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2389 - tp: 74091.0000 - fp: 5909.0000 - tn: 314091.0000 - fn: 5909.0000 - accuracy: 0.9705 - precision: 0.9261 - recall: 0.9261 - auc: 0.9909 - val_loss: 0.4145 - val_tp: 16360.0000 - val_fp: 3640.0000 - val_tn: 76360.0000 - val_fn: 3640.0000 - val_accuracy: 0.9272 - val_precision: 0.8180 - val_recall: 0.8180 - val_auc: 0.9835
[INFO] saving weights to checkpoints/lstm-epoch-8-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3431 - tp: 65506.0000 - fp: 14494.0000 - tn: 305506.0000 - fn: 14494.0000 - accuracy: 0.9275 - precision: 0.8188 - recall: 0.8188 - auc: 0.9830 - val_loss: 0.2791 - val_tp: 16387.0000 - val_fp: 3613.0000 - val_tn: 76387.0000 - val_fn: 3613.0000 - val_accuracy: 0.9277 - val_precision: 0.8194 - val_recall: 0.8194 - val_auc: 0.9843
[INFO] saving weights to checkpoints/lstm-epoch-8-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 9-9/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99842%,30:0.00079%,31:0.0004%,26:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:95.96007%,Single Stage Single Point:4.03993%]
[INFO] ** dst:[21:43.36362%,10:20.76811%,8:18.29837%,9:17.56733%,22:0.00079%,15:0.00079%,18:0.0004%,25:0.0002%,24:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99921%,0:0.00079%]
[INFO] ** i/f_name:[2:99.99921%,3:0.00079%]
[INFO] ** modbus_function_code:[0.02961:99.99842%,-33.760870000000004:0.00158%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99842%,0:0.00158%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99842%,2:0.00079%,1:0.00079%]
[INFO] ** proxy_src_ip:[18:37.99863%,20:26.13369%,13:18.29857%,6:17.56753%,17:0.00079%,21:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:26.13289%,-0.32151:20.76811%,-1.27613:18.29817%,-0.23351:17.56713%,-0.33484:17.23052%,-71.33197:0.00079%,1.45709:0.0004%,-0.24151:0.0004%,-0.08551:0.0004%,-71.14798:0.0002%,-1.27347:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:26.1325%,1:20.76811%,5:18.29817%,4:17.56694%,2:17.23052%,0:0.00376%]
[INFO] ** service:[0.0048200000000000005:99.99842%,-211.73542999999998:0.00079%,-186.43601999999998:0.0004%,-186.44547:0.0002%,-211.08346:0.0002%]
[INFO] ** src:[22:37.99863%,9:26.13369%,7:18.29857%,1:17.56753%,14:0.00079%,17:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1381 (0.27345%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2210 - tp: 71113.0000 - fp: 8887.0000 - tn: 311113.0000 - fn: 8887.0000 - accuracy: 0.9556 - precision: 0.8889 - recall: 0.8889 - auc: 0.9913 - val_loss: 0.0925 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1277 - tp: 77734.0000 - fp: 2266.0000 - tn: 317734.0000 - fn: 2266.0000 - accuracy: 0.9887 - precision: 0.9717 - recall: 0.9717 - auc: 0.9970 - val_loss: 0.0446 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0289 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0104 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0163 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0070 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0123 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0047 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 10-10/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99644%,30:0.00198%,24:0.0002%,23:0.0002%,22:0.0002%,18:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:93.9511%,Single Stage Single Point:6.0489%]
[INFO] ** dst:[21:43.4147%,10:20.81206%,8:18.21917%,9:17.5503%,15:0.00198%,22:0.00059%,24:0.0004%,19:0.0004%,26:0.0002%,25:0.0002%]
[INFO] ** i/f_dir:[1:99.99822%,0:0.00178%]
[INFO] ** i/f_name:[2:99.99802%,3:0.00198%]
[INFO] ** modbus_function_code:[0.02961:99.99644%,-33.760870000000004:0.00337%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.99901%,11:49.99743%,0:0.00337%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.99921%,1:0.00079%]
[INFO] ** proto:[0:99.99762%,1:0.00198%,2:0.0004%]
[INFO] ** proxy_src_ip:[18:38.09843%,20:26.12874%,13:18.21937%,6:17.54971%,17:0.00198%,10:0.00099%,14:0.0004%,16:0.0002%,5:0.0002%]
[INFO] ** s_port:[1.45442:26.12814%,-0.32151:20.81206%,-1.27613:18.21877%,-0.23351:17.54931%,-0.33484:17.28636%,-71.33197:0.00198%,-10.51843:0.00079%,5.71692:0.0004%,-1.27347:0.0004%,1.46509:0.0002%,1.47576:0.0002%,-0.24950999999999998:0.0002%,1.45709:0.0002%,-0.24151:0.0002%,-71.14931:0.0002%,-1.02014:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:26.12775%,1:20.81187%,5:18.21877%,4:17.54912%,2:17.28616%,0:0.00634%]
[INFO] ** service:[0.0048200000000000005:99.99723%,-211.73542999999998:0.00198%,-211.07873999999998:0.0004%,-186.44547:0.0002%,-211.08818:0.0002%]
[INFO] ** src:[22:38.09843%,9:26.12874%,7:18.21937%,1:17.54971%,14:0.00198%,11:0.00099%,2:0.0004%,16:0.0002%,15:0.0002%]
[INFO] ** type:[0:99.99842%,1:0.00139%,2:0.0002%]
[INFO] ** unixtime:1380 (0.27325%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0092 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0035 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0072 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6717 - val_tp: 14586.0000 - val_fp: 5414.0000 - val_tn: 74586.0000 - val_fn: 5414.0000 - val_accuracy: 0.8917 - val_precision: 0.7293 - val_recall: 0.7293 - val_auc: 0.8462
[INFO] saving weights to checkpoints/lstm-epoch-8-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6953 - tp: 54865.0000 - fp: 25135.0000 - tn: 294865.0000 - fn: 25135.0000 - accuracy: 0.8743 - precision: 0.6858 - recall: 0.6858 - auc: 0.9613 - val_loss: 0.1367 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1227 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0880 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0727 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0458 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 11-11/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99881%,31:0.0004%,30:0.0004%,26:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.38005%,10:20.87998%,8:18.20056%,9:17.53684%,22:0.00139%,18:0.0004%,15:0.0004%,25:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** i/f_name:[2:99.9996%,3:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.99881%,-33.760870000000004:0.00119%]
[INFO] ** modbus_function_description:[7:50.0004%,11:49.99842%,0:0.00119%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99881%,2:0.00079%,1:0.0004%]
[INFO] ** proxy_src_ip:[18:38.14733%,20:26.11329%,13:18.20036%,6:17.53724%,16:0.00059%,17:0.0004%,21:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:26.1127%,-0.32151:20.87998%,-1.27613:18.20036%,-0.23351:17.53664%,-0.33484:17.26735%,-0.24151:0.00059%,-1.02014:0.00059%,-0.08551:0.0004%,-71.33197:0.0004%,-71.14798:0.0002%,1.45709:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-64.19493:0.0002%]
[INFO] ** scada_tag:[3:26.1123%,1:20.87998%,5:18.20016%,4:17.53644%,2:17.26715%,0:0.00396%]
[INFO] ** service:[0.0048200000000000005:99.99881%,-211.73542999999998:0.0004%,-186.43601999999998:0.0004%,-186.44547:0.0002%,-211.08346:0.0002%]
[INFO] ** src:[22:38.14733%,9:26.11329%,7:18.20036%,1:17.53724%,15:0.00059%,14:0.0004%,17:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1381 (0.27345%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0358 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0143 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0101 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7394e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0053 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.3059e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0052 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.2672e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0050 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7389e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 12-12/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99762%,30:0.00218%,9:0.0002%]
[INFO] ** classification:[normal:92.83395%,Single Stage Single Point:7.16605%]
[INFO] ** dst:[21:43.38876%,10:20.87305%,8:18.19541%,9:17.53941%,15:0.00218%,22:0.00059%,24:0.0004%,0:0.0002%]
[INFO] ** i/f_dir:[1:99.99822%,0:0.00178%]
[INFO] ** i/f_name:[2:99.99782%,3:0.00218%]
[INFO] ** modbus_function_code:[0.02961:99.99762%,-33.760870000000004:0.00238%]
[INFO] ** modbus_function_description:[7:49.9996%,11:49.99802%,0:0.00238%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.99822%,2:0.00178%]
[INFO] ** proto:[0:99.99782%,1:0.00218%]
[INFO] ** proxy_src_ip:[18:38.13822%,20:26.12398%,13:18.19561%,6:17.53961%,17:0.00218%,16:0.0002%,1:0.0002%]
[INFO] ** s_port:[1.45442:26.12339%,-0.32151:20.87305%,-1.27613:18.19501%,-0.23351:17.53922%,-0.33484:17.26517%,-71.33197:0.00218%,-1.27347:0.0004%,1.45709:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,14.4699:0.0002%,-0.24151:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:26.12299%,1:20.87305%,5:18.19501%,4:17.53882%,2:17.26517%,0:0.00495%]
[INFO] ** service:[0.0048200000000000005:99.99762%,-211.73542999999998:0.00218%,-183.8612:0.0002%]
[INFO] ** src:[22:38.13822%,9:26.12398%,7:18.19561%,1:17.53961%,21:0.00178%,14:0.0004%,15:0.0002%,3:0.0002%]
[INFO] ** type:[0:99.9996%,1:0.0004%]
[INFO] ** unixtime:1381 (0.27345%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0046 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0124e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0046 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1780 - val_tp: 18489.0000 - val_fp: 1511.0000 - val_tn: 78489.0000 - val_fn: 1511.0000 - val_accuracy: 0.9698 - val_precision: 0.9244 - val_recall: 0.9244 - val_auc: 0.9528
[INFO] saving weights to checkpoints/lstm-epoch-8-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6894 - tp: 55159.0000 - fp: 24841.0000 - tn: 295159.0000 - fn: 24841.0000 - accuracy: 0.8758 - precision: 0.6895 - recall: 0.6895 - auc: 0.9619 - val_loss: 0.2503 - val_tp: 18924.0000 - val_fp: 1076.0000 - val_tn: 78924.0000 - val_fn: 1076.0000 - val_accuracy: 0.9785 - val_precision: 0.9462 - val_recall: 0.9462 - val_auc: 0.9874
[INFO] saving weights to checkpoints/lstm-epoch-8-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1935 - tp: 78518.0000 - fp: 1482.0000 - tn: 318518.0000 - fn: 1482.0000 - accuracy: 0.9926 - precision: 0.9815 - recall: 0.9815 - auc: 0.9945 - val_loss: 0.0947 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0845 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0627 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 13-13/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99624%,31:0.00079%,26:0.00059%,0:0.00059%,30:0.0004%,22:0.0004%,27:0.0002%,24:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:84.84993%,Single Stage Single Point:15.15007%]
[INFO] ** dst:[21:43.36124%,10:20.80018%,8:18.27877%,9:17.55545%,22:0.00119%,6:0.00099%,18:0.00079%,25:0.00059%,15:0.0004%,24:0.0002%,7:0.0002%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** i/f_name:[2:99.9996%,3:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.99624%,-33.760870000000004:0.00356%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.99881%,11:49.99743%,0:0.00356%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99703%,2:0.00257%,1:0.0004%]
[INFO] ** proxy_src_ip:[18:38.0515%,20:26.11032%,13:18.27897%,6:17.55486%,10:0.00119%,11:0.00099%,16:0.00059%,17:0.0004%,7:0.0004%,21:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:26.10973%,-0.32151:20.80018%,-1.27613:18.27857%,-0.23351:17.55446%,-0.33484:17.25131%,-9.78512:0.00079%,-71.14798:0.00059%,-64.19493:0.00059%,-1.02014:0.00059%,-0.08551:0.0004%,-71.14931:0.0004%,-0.24151:0.0004%,-71.33197:0.0004%,-1.27347:0.0002%,1.46509:0.0002%,-68.79874000000001:0.0002%,14.540560000000001:0.0002%,1.45709:0.0002%,-1.2708:0.0002%,6.1115699999999995:0.0002%,1.47576:0.0002%]
[INFO] ** scada_tag:[3:26.10933%,1:20.79999%,5:18.27857%,4:17.55446%,2:17.25112%,0:0.00653%]
[INFO] ** service:[0.0048200000000000005:99.99703%,-186.43601999999998:0.00079%,-186.44547:0.00059%,-211.08346:0.00059%,-211.73542999999998:0.0004%,-211.08818:0.0004%,-202.75898:0.0002%]
[INFO] ** src:[22:38.0515%,9:26.11032%,7:18.27897%,1:17.55486%,11:0.00119%,10:0.00099%,15:0.00059%,21:0.0004%,14:0.0004%,17:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** unixtime:1380 (0.27325%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0522 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0368 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0329 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0147 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0185 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.7404 - val_tp: 16864.0000 - val_fp: 3136.0000 - val_tn: 76864.0000 - val_fn: 3136.0000 - val_accuracy: 0.9373 - val_precision: 0.8432 - val_recall: 0.8432 - val_auc: 0.9648
[INFO] saving weights to checkpoints/lstm-epoch-8-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6633 - tp: 51336.0000 - fp: 28664.0000 - tn: 291336.0000 - fn: 28664.0000 - accuracy: 0.8567 - precision: 0.6417 - recall: 0.6417 - auc: 0.9631 - val_loss: 0.4397 - val_tp: 12877.0000 - val_fp: 7123.0000 - val_tn: 72877.0000 - val_fn: 7123.0000 - val_accuracy: 0.8575 - val_precision: 0.6439 - val_recall: 0.6439 - val_auc: 0.9683
[INFO] saving weights to checkpoints/lstm-epoch-8-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3669 - tp: 52603.0000 - fp: 27397.0000 - tn: 292603.0000 - fn: 27397.0000 - accuracy: 0.8630 - precision: 0.6575 - recall: 0.6575 - auc: 0.9674 - val_loss: 0.2718 - val_tp: 13545.0000 - val_fp: 6455.0000 - val_tn: 73545.0000 - val_fn: 6455.0000 - val_accuracy: 0.8709 - val_precision: 0.6773 - val_recall: 0.6773 - val_auc: 0.9740
[INFO] saving weights to checkpoints/lstm-epoch-8-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 14-14/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.9996%,30:0.0002%,9:0.0002%]
[INFO] ** classification:[normal:96.19234%,Single Stage Single Point:3.80766%]
[INFO] ** dst:[21:43.34441%,10:20.80929%,8:18.27204%,9:17.57268%,22:0.00079%,24:0.0004%,15:0.0002%,0:0.0002%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.9998%,3:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9996%,-33.760870000000004:0.0004%]
[INFO] ** modbus_function_description:[7:50.00059%,11:49.99901%,0:0.0004%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9998%,1:0.0002%]
[INFO] ** proxy_src_ip:[18:38.04635%,20:26.10795%,13:18.27224%,6:17.57288%,17:0.0002%,16:0.0002%,1:0.0002%]
[INFO] ** s_port:[1.45442:26.10715%,-0.32151:20.80929%,-1.27613:18.27164%,-0.23351:17.57248%,-0.33484:17.23706%,-1.27347:0.0004%,1.45709:0.0004%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,14.4699:0.0002%,-0.24151:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%,-71.33197:0.0002%]
[INFO] ** scada_tag:[3:26.10676%,1:20.80929%,5:18.27144%,4:17.57208%,2:17.23686%,0:0.00356%]
[INFO] ** service:[0.0048200000000000005:99.9996%,-183.8612:0.0002%,-211.73542999999998:0.0002%]
[INFO] ** src:[22:38.04635%,9:26.10795%,7:18.27224%,1:17.57288%,15:0.0002%,14:0.0002%,3:0.0002%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** unixtime:1380 (0.27325%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2799 - tp: 62573.0000 - fp: 17427.0000 - tn: 302573.0000 - fn: 17427.0000 - accuracy: 0.9129 - precision: 0.7822 - recall: 0.7822 - auc: 0.9798 - val_loss: 0.2557 - val_tp: 19232.0000 - val_fp: 768.0000 - val_tn: 79232.0000 - val_fn: 768.0000 - val_accuracy: 0.9846 - val_precision: 0.9616 - val_recall: 0.9616 - val_auc: 0.9935
[INFO] saving weights to checkpoints/lstm-epoch-8-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2010 - tp: 78807.0000 - fp: 1193.0000 - tn: 318807.0000 - fn: 1193.0000 - accuracy: 0.9940 - precision: 0.9851 - recall: 0.9851 - auc: 0.9989 - val_loss: 0.0824 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0545 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0204 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0272 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0063 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0183 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0023 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 15-15/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99604%,30:0.00317%,26:0.0002%,17:0.0002%,12:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:89.0641%,Single Stage Multi Point:10.93511%,Single Stage Single Point:0.00079%]
[INFO] ** dst:[21:43.2953%,10:20.76949%,8:18.31797%,9:17.61169%,15:0.00317%,22:0.00158%,25:0.0002%,24:0.0002%,16:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99683%,0:0.00317%]
[INFO] ** i/f_name:[2:99.99683%,3:0.00317%]
[INFO] ** modbus_function_code:[0.02961:99.99604%,-33.760870000000004:0.00396%]
[INFO] ** modbus_function_description:[7:49.99901%,11:49.99703%,0:0.00396%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.99703%,2:0.00297%]
[INFO] ** proto:[0:99.99644%,1:0.00317%,2:0.0004%]
[INFO] ** proxy_src_ip:[18:38.00259%,20:26.0628%,13:18.31778%,6:17.61228%,17:0.00317%,16:0.00059%,7:0.0004%,5:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:26.06201%,-0.32151:20.76929%,-1.27613:18.31758%,-0.23351:17.61149%,-0.33484:17.2333%,-71.33197:0.00317%,-1.02014:0.00059%,-0.24151:0.00059%,1.45709:0.0004%,-64.19493:0.0002%,-61.95768:0.0002%,-71.14798:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,10.192739999999999:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%]
[INFO] ** scada_tag:[3:26.06161%,1:20.7691%,5:18.31758%,4:17.61109%,2:17.2331%,0:0.00752%]
[INFO] ** service:[0.0048200000000000005:99.99624%,-211.73542999999998:0.00317%,-186.44547:0.0002%,-211.08346:0.0002%,-205.44247:0.0002%]
[INFO] ** src:[22:38.00259%,9:26.0628%,7:18.31778%,1:17.61228%,21:0.00337%,15:0.00059%,16:0.0002%,14:0.0002%,8:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1388 (0.27483%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0163 - tp: 79968.0000 - fp: 32.0000 - tn: 319968.0000 - fn: 32.0000 - accuracy: 0.9998 - precision: 0.9996 - recall: 0.9996 - auc: 1.0000 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0136 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7388e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0118 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3252e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0111 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8864 - val_tp: 13937.0000 - val_fp: 6063.0000 - val_tn: 73937.0000 - val_fn: 6063.0000 - val_accuracy: 0.8787 - val_precision: 0.6969 - val_recall: 0.6969 - val_auc: 0.8078
[INFO] saving weights to checkpoints/lstm-epoch-8-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5433 - tp: 42589.0000 - fp: 37411.0000 - tn: 282589.0000 - fn: 37411.0000 - accuracy: 0.8129 - precision: 0.5324 - recall: 0.5324 - auc: 0.7037 - val_loss: 7.5668 - val_tp: 10611.0000 - val_fp: 9389.0000 - val_tn: 70611.0000 - val_fn: 9389.0000 - val_accuracy: 0.8122 - val_precision: 0.5306 - val_recall: 0.5306 - val_auc: 0.7066
[INFO] saving weights to checkpoints/lstm-epoch-8-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 16-16/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (444724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (444724, 17)

[INFO] analyzing data
[INFO] 444724 rows
[INFO] ** appi_name:[21:99.99865%,30:0.00112%,33:0.00022%]
[INFO] ** classification:[normal:84.06382%,Single Stage Multi Point:15.93618%]
[INFO] ** dst:[21:43.35993%,10:20.79739%,8:18.24997%,9:17.59024%,22:0.00112%,15:0.00112%,24:0.00022%]
[INFO] ** i/f_dir:[1:99.99888%,0:0.00112%]
[INFO] ** i/f_name:[2:99.99888%,3:0.00112%]
[INFO] ** modbus_function_code:[0.02961:99.99865%,-33.760870000000004:0.00135%]
[INFO] ** modbus_function_description:[7:50.00045%,11:49.9982%,0:0.00135%]
[INFO] ** modbus_transaction_id:65536 (14.73633%)
[INFO] ** orig:[0:99.99888%,2:0.00112%]
[INFO] ** proto:[0:99.99888%,1:0.00112%]
[INFO] ** proxy_src_ip:[18:38.04967%,20:26.10788%,13:18.25042%,6:17.59024%,17:0.00112%,16:0.00045%,21:0.00022%]
[INFO] ** s_port:[1.45442:26.1072%,-0.32151:20.79717%,-1.27613:18.24997%,-0.23351:17.59001%,-0.33484:17.2525%,-71.33197:0.00112%,1.45709:0.00045%,-1.02014:0.00045%,-1.27347:0.00022%,1.47576:0.00022%,-49.275529999999996:0.00022%,-0.24151:0.00022%,-1.2708:0.00022%]
[INFO] ** scada_tag:[3:26.10675%,1:20.79717%,5:18.24975%,4:17.58956%,2:17.2525%,0:0.00427%]
[INFO] ** service:[0.0048200000000000005:99.99888%,-211.73542999999998:0.00112%]
[INFO] ** src:[22:38.04967%,9:26.10788%,7:18.25042%,1:17.59024%,21:0.00112%,15:0.00045%,4:0.00022%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1215 (0.2732%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/444724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5643 - tp: 42484.0000 - fp: 37516.0000 - tn: 282484.0000 - fn: 37516.0000 - accuracy: 0.8124 - precision: 0.5311 - recall: 0.5311 - auc: 0.7032 - val_loss: 7.5506 - val_tp: 10631.0000 - val_fp: 9369.0000 - val_tn: 70631.0000 - val_fn: 9369.0000 - val_accuracy: 0.8126 - val_precision: 0.5315 - val_recall: 0.5315 - val_auc: 0.7072
[INFO] saving weights to checkpoints/lstm-epoch-8-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/444724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.8394 - tp: 56012.0000 - fp: 23988.0000 - tn: 296012.0000 - fn: 23988.0000 - accuracy: 0.8801 - precision: 0.7002 - recall: 0.7002 - auc: 0.8104 - val_loss: 4.8442e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/444724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0080 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9637e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/444724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0075 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9076e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/444724
[33m[INFO] loading file 17-17/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544724, 17)

[INFO] analyzing data
[INFO] 544724 rows
[INFO] ** appi_name:[21:99.99706%,7:0.00055%,26:0.00037%,0:0.00037%,33:0.00018%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.33658%,Multi Stage Multi Point:5.66342%]
[INFO] ** dst:[21:43.34654%,10:20.85038%,8:18.20059%,9:17.59956%,22:0.00073%,6:0.00055%,25:0.00037%,16:0.00037%,2:0.00037%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99706%,-33.760870000000004:0.00275%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99945%,11:49.99761%,0:0.00275%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (12.03105%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99871%,2:0.00129%]
[INFO] ** proxy_src_ip:[18:38.08387%,20:26.11359%,13:18.20004%,6:17.59937%,10:0.0011%,11:0.00092%,1:0.00037%,21:0.00018%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.11267%,-0.32151:20.85019%,-1.27613:18.19968%,-0.23351:17.59919%,-0.33484:17.23368%,6.0369:0.00073%,1.47576:0.00037%,-71.14798:0.00037%,1.45709:0.00037%,-64.19493:0.00037%,1.46509:0.00018%,-68.79874000000001:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,6.15557:0.00018%,6.06224:0.00018%,8.55414:0.00018%,-3.3787199999999995:0.00018%,-4.3880099999999995:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.11249%,1:20.85001%,5:18.19949%,4:17.59882%,2:17.23368%,0:0.00551%]
[INFO] ** service:[0.0048200000000000005:99.99798%,-211.09762999999998:0.00055%,-211.08346:0.00037%,-186.44547:0.00037%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.08387%,9:26.11359%,7:18.20004%,1:17.59937%,11:0.0011%,10:0.00092%,3:0.00037%,21:0.00018%,15:0.00018%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1488 (0.27317%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0069 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1099e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0063 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3656e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0056 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2219e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.1141 - tp: 69528.0000 - fp: 10472.0000 - tn: 309528.0000 - fn: 10472.0000 - accuracy: 0.9476 - precision: 0.8691 - recall: 0.8691 - auc: 0.9178 - val_loss: 2.9456 - val_tp: 16345.0000 - val_fp: 3655.0000 - val_tn: 76345.0000 - val_fn: 3655.0000 - val_accuracy: 0.9269 - val_precision: 0.8173 - val_recall: 0.8173 - val_auc: 0.8858
[INFO] saving weights to checkpoints/lstm-epoch-8-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9168 - tp: 65542.0000 - fp: 14458.0000 - tn: 305542.0000 - fn: 14458.0000 - accuracy: 0.9277 - precision: 0.8193 - recall: 0.8193 - auc: 0.8864 - val_loss: 1.8254 - val_tp: 17735.0000 - val_fp: 2265.0000 - val_tn: 77735.0000 - val_fn: 2265.0000 - val_accuracy: 0.9547 - val_precision: 0.8867 - val_recall: 0.8867 - val_auc: 0.9292
[INFO] saving weights to checkpoints/lstm-epoch-8-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/544724
[33m[INFO] loading file 18-18/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544724, 17)

[INFO] analyzing data
[INFO] 544724 rows
[INFO] ** appi_name:[21:99.99816%,30:0.00055%,7:0.00055%,31:0.00018%,27:0.00018%,22:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:82.19318%,Multi Stage Multi Point:17.80682%]
[INFO] ** dst:[21:43.33791%,10:20.83349%,8:18.26448%,9:17.56119%,22:0.00073%,15:0.00055%,24:0.00037%,16:0.00037%,2:0.00037%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99945%,0:0.00055%]
[INFO] ** i/f_name:[2:99.99945%,3:0.00055%]
[INFO] ** modbus_function_code:[0.02961:99.99816%,-33.760870000000004:0.00184%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99798%,0:0.00184%]
[INFO] ** modbus_transaction_id:65536 (12.03105%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9989%,2:0.00055%,1:0.00055%]
[INFO] ** proxy_src_ip:[18:38.07469%,20:26.09725%,13:18.26485%,6:17.56137%,17:0.00055%,11:0.00055%,1:0.00037%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.09652%,-0.32151:20.83349%,-1.27613:18.2643%,-0.23351:17.561%,-0.33484:17.24121%,-71.33197:0.00055%,-1.27347:0.00037%,1.45709:0.00037%,-0.24151:0.00037%,1.47576:0.00018%,1.46509:0.00018%,3.6236699999999997:0.00018%,-1.2708:0.00018%,-2.48275:0.00018%,6.06224:0.00018%,-3.3787199999999995:0.00018%,8.10082:0.00018%,6.45955:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.09615%,1:20.8333%,5:18.26411%,4:17.56082%,2:17.24102%,0:0.00459%]
[INFO] ** service:[0.0048200000000000005:99.99816%,-211.09762999999998:0.00055%,-211.73542999999998:0.00055%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.07469%,9:26.09725%,7:18.26485%,1:17.56137%,14:0.00055%,10:0.00055%,3:0.00037%,21:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1489 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2025 - tp: 74051.0000 - fp: 5949.0000 - tn: 314051.0000 - fn: 5949.0000 - accuracy: 0.9703 - precision: 0.9256 - recall: 0.9256 - auc: 0.9532 - val_loss: 6.1499 - val_tp: 12369.0000 - val_fp: 7631.0000 - val_tn: 72369.0000 - val_fn: 7631.0000 - val_accuracy: 0.8474 - val_precision: 0.6184 - val_recall: 0.6184 - val_auc: 0.7615
[INFO] saving weights to checkpoints/lstm-epoch-8-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1116 - tp: 49678.0000 - fp: 30322.0000 - tn: 289678.0000 - fn: 30322.0000 - accuracy: 0.8484 - precision: 0.6210 - recall: 0.6210 - auc: 0.7613 - val_loss: 6.1450 - val_tp: 12375.0000 - val_fp: 7625.0000 - val_tn: 72375.0000 - val_fn: 7625.0000 - val_accuracy: 0.8475 - val_precision: 0.6187 - val_recall: 0.6187 - val_auc: 0.7617
[INFO] saving weights to checkpoints/lstm-epoch-8-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1405 - tp: 49534.0000 - fp: 30466.0000 - tn: 289534.0000 - fn: 30466.0000 - accuracy: 0.8477 - precision: 0.6192 - recall: 0.6192 - auc: 0.7601 - val_loss: 6.1378 - val_tp: 12384.0000 - val_fp: 7616.0000 - val_tn: 72384.0000 - val_fn: 7616.0000 - val_accuracy: 0.8477 - val_precision: 0.6192 - val_recall: 0.6192 - val_auc: 0.7620
[INFO] saving weights to checkpoints/lstm-epoch-8-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4917 - tp: 72611.0000 - fp: 7389.0000 - tn: 312611.0000 - fn: 7389.0000 - accuracy: 0.9631 - precision: 0.9076 - recall: 0.9076 - auc: 0.9418 - val_loss: 4.0894e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0029 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0117e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/544724
[33m[INFO] loading file 19-19/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544724, 17)

[INFO] analyzing data
[INFO] 544724 rows
[INFO] ** appi_name:[21:99.99798%,26:0.00037%,0:0.00037%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:86.86307%,Single Stage Multi Point:13.13693%]
[INFO] ** dst:[21:43.38234%,10:20.82486%,8:18.21877%,9:17.57128%,22:0.00129%,6:0.00055%,25:0.00037%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99798%,-33.760870000000004:0.00184%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99798%,0:0.00184%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (12.03105%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99871%,2:0.00129%]
[INFO] ** proxy_src_ip:[18:38.11141%,20:26.09597%,13:18.21877%,6:17.57128%,10:0.0011%,11:0.00092%,16:0.00055%]
[INFO] ** s_port:[1.45442:26.09487%,-0.32151:20.82486%,-1.27613:18.2184%,-0.23351:17.5711%,-0.33484:17.28655%,-5.20264:0.00073%,1.45709:0.00055%,-1.02014:0.00055%,-64.19493:0.00037%,-71.14798:0.00037%,1.46509:0.00037%,-1.27347:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-71.14931:0.00018%,-68.79874000000001:0.00018%,0.75578:0.00018%]
[INFO] ** scada_tag:[3:26.0945%,1:20.82467%,5:18.21822%,4:17.57092%,2:17.28637%,0:0.00532%]
[INFO] ** service:[0.0048200000000000005:99.99871%,-211.08346:0.00037%,-186.44547:0.00037%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.11141%,9:26.09597%,7:18.21877%,1:17.57128%,11:0.0011%,10:0.00092%,15:0.00055%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1490 (0.27353%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0026 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3752e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0022 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9315e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0021 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6129e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.5355 - tp: 72387.0000 - fp: 7613.0000 - tn: 312387.0000 - fn: 7613.0000 - accuracy: 0.9619 - precision: 0.9048 - recall: 0.9048 - auc: 0.9401 - val_loss: 9.7821 - val_tp: 7862.0000 - val_fp: 12138.0000 - val_tn: 67862.0000 - val_fn: 12138.0000 - val_accuracy: 0.7572 - val_precision: 0.3931 - val_recall: 0.3931 - val_auc: 0.6207
[INFO] saving weights to checkpoints/lstm-epoch-8-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.8431 - tp: 31148.0000 - fp: 48852.0000 - tn: 271148.0000 - fn: 48852.0000 - accuracy: 0.7557 - precision: 0.3893 - recall: 0.3893 - auc: 0.6159 - val_loss: 2.3831 - val_tp: 17043.0000 - val_fp: 2957.0000 - val_tn: 77043.0000 - val_fn: 2957.0000 - val_accuracy: 0.9409 - val_precision: 0.8522 - val_recall: 0.8522 - val_auc: 0.9076
[INFO] saving weights to checkpoints/lstm-epoch-8-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/544724
[33m[INFO] loading file 20-20/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544724, 17)

[INFO] analyzing data
[INFO] 544724 rows
[INFO] ** appi_name:[21:99.99651%,30:0.00294%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:92.47711%,Single Stage Multi Point:7.52289%]
[INFO] ** dst:[21:43.42621%,10:20.83569%,8:18.16424%,9:17.5689%,15:0.00294%,22:0.0011%,24:0.00037%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99743%,0:0.00257%]
[INFO] ** i/f_name:[2:99.99706%,3:0.00294%]
[INFO] ** modbus_function_code:[0.02961:99.99651%,-33.760870000000004:0.00349%]
[INFO] ** modbus_function_description:[7:49.99982%,11:49.9967%,0:0.00349%]
[INFO] ** modbus_transaction_id:65536 (12.03105%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99651%,1:0.00294%,2:0.00055%]
[INFO] ** proxy_src_ip:[18:38.11471%,20:26.14774%,13:18.16443%,6:17.56945%,17:0.00294%,14:0.00055%,16:0.00018%]
[INFO] ** s_port:[1.45442:26.147%,-0.32151:20.83569%,-1.27613:18.16388%,-0.23351:17.56871%,-0.33484:17.27903%,-71.33197:0.00294%,-0.24151:0.00055%,1.45709:0.00037%,-1.27347:0.00037%,13.431270000000001:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-71.14798:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:26.14664%,1:20.83551%,5:18.16388%,4:17.56835%,2:17.27884%,0:0.00679%]
[INFO] ** service:[0.0048200000000000005:99.99651%,-211.73542999999998:0.00294%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.11471%,9:26.14774%,7:18.16443%,1:17.56945%,14:0.00294%,2:0.00055%,15:0.00018%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1489 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0014 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2764e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.8550 - tp: 65835.0000 - fp: 14165.0000 - tn: 305835.0000 - fn: 14165.0000 - accuracy: 0.9292 - precision: 0.8229 - recall: 0.8229 - auc: 0.8886 - val_loss: 2.9343 - val_tp: 16359.0000 - val_fp: 3641.0000 - val_tn: 76359.0000 - val_fn: 3641.0000 - val_accuracy: 0.9272 - val_precision: 0.8180 - val_recall: 0.8180 - val_auc: 0.8862
[INFO] saving weights to checkpoints/lstm-epoch-8-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9560 - tp: 65333.0000 - fp: 14667.0000 - tn: 305333.0000 - fn: 14667.0000 - accuracy: 0.9267 - precision: 0.8167 - recall: 0.8167 - auc: 0.8847 - val_loss: 2.9166 - val_tp: 16381.0000 - val_fp: 3619.0000 - val_tn: 76381.0000 - val_fn: 3619.0000 - val_accuracy: 0.9276 - val_precision: 0.8191 - val_recall: 0.8191 - val_auc: 0.8869
[INFO] saving weights to checkpoints/lstm-epoch-8-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.9856 - tp: 75113.0000 - fp: 4887.0000 - tn: 315113.0000 - fn: 4887.0000 - accuracy: 0.9756 - precision: 0.9389 - recall: 0.9389 - auc: 0.9616 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.6359e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1922e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/544724
[33m[INFO] loading file 21-21/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544722, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544722, 17)

[INFO] analyzing data
[INFO] 544722 rows
[INFO] ** appi_name:[21:99.99614%,30:0.00092%,7:0.00055%,26:0.00037%,22:0.00037%,0:0.00037%,31:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:98.87961%,Multi Stage Single Point:1.12039%]
[INFO] ** dst:[21:43.30503%,10:20.98538%,8:18.17019%,9:17.53463%,22:0.00092%,15:0.00092%,24:0.00073%,6:0.00073%,25:0.00037%,16:0.00037%,2:0.00037%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99908%,0:0.00092%]
[INFO] ** i/f_name:[2:99.99908%,3:0.00092%]
[INFO] ** modbus_function_code:[0.02961:99.99614%,-33.760870000000004:0.00367%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.9989%,11:49.99725%,0:0.00367%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (12.03109%)
[INFO] ** orig:[0:99.99927%,2:0.00073%]
[INFO] ** proto:[0:99.99761%,2:0.00147%,1:0.00092%]
[INFO] ** proxy_src_ip:[18:38.31165%,20:25.97857%,13:18.17074%,6:17.53463%,10:0.0011%,17:0.00092%,11:0.00092%,16:0.00055%,1:0.00037%,21:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.97802%,-0.32151:20.98465%,-1.27613:18.17%,-0.23351:17.53445%,-0.33484:17.327%,-71.33197:0.00092%,-1.27347:0.00073%,-6.64392:0.00073%,-1.02014:0.00055%,-64.19493:0.00037%,-71.14931:0.00037%,-71.14798:0.00037%,1.47576:0.00018%,1.46509:0.00018%,6.62488:0.00018%,10.15141:0.00018%,-68.79874000000001:0.00018%,7.060860000000001:0.00018%,-3.3787199999999995:0.00018%,-2.2440900000000004:0.00018%,1.45709:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.97765%,1:20.98447%,5:18.16982%,4:17.53408%,2:17.327%,0:0.00698%]
[INFO] ** service:[0.0048200000000000005:99.99688%,-211.73542999999998:0.00092%,-211.09762999999998:0.00055%,-211.08346:0.00037%,-186.44547:0.00037%,-211.08818:0.00037%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.31165%,9:25.97857%,7:18.17074%,1:17.53463%,11:0.0011%,21:0.00092%,10:0.00092%,15:0.00055%,3:0.00037%,14:0.00018%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1483 (0.27225%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544722
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.0441e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/544722
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.9547e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6909e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/544722
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1034e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/544722
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.4768e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/544722
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.8985e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1944e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/544722
[33m[INFO] loading file 22-22/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (313763, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (313763, 17)

[INFO] analyzing data
[INFO] 313763 rows
[INFO] ** appi_name:[21:99.99235%,30:0.00669%,23:0.00032%,22:0.00032%,18:0.00032%]
[INFO] ** classification:[normal:57.7541%,Multi Stage Single Point:42.2459%]
[INFO] ** dst:[21:43.29892%,10:21.00726%,8:18.11208%,9:17.57282%,15:0.00669%,22:0.00127%,19:0.00064%,26:0.00032%]
[INFO] ** i/f_dir:[1:99.99363%,0:0.00637%]
[INFO] ** i/f_name:[2:99.99331%,3:0.00637%,0:0.00032%]
[INFO] ** modbus_function_code:[0.02961:99.99235%,-33.760870000000004:0.00765%]
[INFO] ** modbus_function_description:[7:49.99697%,11:49.99538%,0:0.00765%]
[INFO] ** modbus_transaction_id:65534 (20.88647%)
[INFO] ** orig:[0:99.9949%,2:0.00446%,1:0.00064%]
[INFO] ** proto:[0:99.99299%,1:0.00669%,2:0.00032%]
[INFO] ** proxy_src_ip:[18:38.33371%,20:25.97343%,13:18.11144%,6:17.57377%,17:0.00669%,14:0.00064%,10:0.00032%]
[INFO] ** s_port:[1.45442:25.97247%,-0.32151:21.00726%,-1.27613:18.11144%,-0.23351:17.57282%,-0.33484:17.32645%,-71.33197:0.00669%,1.45709:0.00064%,-0.24151:0.00064%,7.228860000000001:0.00064%,-0.24950999999999998:0.00032%,1.46509:0.00032%,-71.14931:0.00032%]
[INFO] ** scada_tag:[3:25.97215%,1:21.00726%,5:18.11144%,4:17.5725%,2:17.32645%,0:0.0102%]
[INFO] ** service:[0.0048200000000000005:99.99235%,-211.73542999999998:0.00669%,-211.07873999999998:0.00064%,-211.08818:0.00032%]
[INFO] ** src:[22:38.33371%,9:25.97343%,7:18.11144%,1:17.57377%,21:0.00446%,14:0.00223%,2:0.00064%,11:0.00032%]
[INFO] ** type:[0:99.99809%,1:0.00191%]
[INFO] ** unixtime:866 (0.276%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/313763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.5569 - tp: 57384.0000 - fp: 22616.0000 - tn: 297384.0000 - fn: 22616.0000 - accuracy: 0.8869 - precision: 0.7173 - recall: 0.7173 - auc: 0.8222 - val_loss: 7.5836 - val_tp: 10590.0000 - val_fp: 9410.0000 - val_tn: 70590.0000 - val_fn: 9410.0000 - val_accuracy: 0.8118 - val_precision: 0.5295 - val_recall: 0.5295 - val_auc: 0.7059
[INFO] saving weights to checkpoints/lstm-epoch-8-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/313763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5745 - tp: 42406.0000 - fp: 37594.0000 - tn: 282406.0000 - fn: 37594.0000 - accuracy: 0.8120 - precision: 0.5301 - recall: 0.5301 - auc: 0.7045 - val_loss: 7.6190 - val_tp: 10546.0000 - val_fp: 9454.0000 - val_tn: 70546.0000 - val_fn: 9454.0000 - val_accuracy: 0.8109 - val_precision: 0.5273 - val_recall: 0.5273 - val_auc: 0.7046
[INFO] saving weights to checkpoints/lstm-epoch-8-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/313763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5809 - tp: 42374.0000 - fp: 37626.0000 - tn: 282374.0000 - fn: 37626.0000 - accuracy: 0.8119 - precision: 0.5297 - recall: 0.5297 - auc: 0.7043 - val_loss: 7.5811 - val_tp: 10593.0000 - val_fp: 9407.0000 - val_tn: 70593.0000 - val_fn: 9407.0000 - val_accuracy: 0.8119 - val_precision: 0.5296 - val_recall: 0.5296 - val_auc: 0.7060
[INFO] saving weights to checkpoints/lstm-epoch-8-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/313763
[33m[INFO] loading file 23-23/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513763, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513763, 17)

[INFO] analyzing data
[INFO] 513763 rows
[INFO] ** appi_name:[21:99.99903%,31:0.00039%,33:0.00019%,30:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:96.98694%,Multi Stage Single Point:3.01306%]
[INFO] ** dst:[21:43.33652%,10:20.99645%,8:18.13832%,9:17.52656%,22:0.00097%,24:0.00039%,18:0.00039%,25:0.00019%,15:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99903%,-33.760870000000004:0.00097%]
[INFO] ** modbus_function_description:[7:50.00049%,11:49.99854%,0:0.00097%]
[INFO] ** modbus_transaction_id:65536 (12.75608%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99922%,2:0.00058%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.34239%,20:25.99078%,13:18.13852%,6:17.52676%,16:0.00058%,21:0.00019%,17:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.99019%,-0.32151:20.99626%,-1.27613:18.13794%,-0.23351:17.52637%,-0.33484:17.34613%,-1.02014:0.00058%,-0.08551:0.00039%,-1.27347:0.00039%,1.47576:0.00019%,-49.275529999999996:0.00019%,1.46509:0.00019%,-0.24151:0.00019%,-0.24950999999999998:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%,1.45709:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.9898%,1:20.99626%,5:18.13774%,4:17.52617%,2:17.34594%,0:0.00409%]
[INFO] ** service:[0.0048200000000000005:99.99922%,-186.43601999999998:0.00039%,-186.44547:0.00019%,-211.73542999999998:0.00019%]
[INFO] ** src:[22:38.34239%,9:25.99078%,7:18.13852%,1:17.52676%,15:0.00058%,17:0.00019%,14:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1397 (0.27192%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.1191 - tp: 64520.0000 - fp: 15480.0000 - tn: 304520.0000 - fn: 15480.0000 - accuracy: 0.9226 - precision: 0.8065 - recall: 0.8065 - auc: 0.8783 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.0795e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.6260e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.2725e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4160e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.0047e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/513763
[33m[INFO] loading file 24-24/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513763, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513763, 17)

[INFO] analyzing data
[INFO] 513763 rows
[INFO] ** appi_name:[21:99.9928%,30:0.0035%,26:0.00058%,31:0.00039%,27:0.00039%,22:0.00039%,0:0.00039%,24:0.00019%,23:0.00019%,19:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,11:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:95.04051%,Multi Stage Single Point:4.95949%]
[INFO] ** dst:[21:43.3661%,10:21.03188%,8:18.09083%,9:17.50379%,15:0.0035%,22:0.00117%,6:0.00078%,25:0.00039%,19:0.00039%,18:0.00039%,7:0.00039%,26:0.00019%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99669%,0:0.00331%]
[INFO] ** i/f_name:[2:99.9965%,3:0.0035%]
[INFO] ** modbus_function_code:[0.02961:99.9928%,-33.760870000000004:0.00662%,0.47422:0.00019%,-0.415:0.00019%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99737%,11:49.99543%,0:0.00662%,15:0.00019%,10:0.00019%,2:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.75608%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.99436%,1:0.0035%,2:0.00214%]
[INFO] ** proxy_src_ip:[18:38.41947%,20:25.97929%,13:18.09064%,6:17.50301%,17:0.0035%,10:0.00136%,14:0.00097%,11:0.00097%,21:0.00039%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.97852%,-0.32151:21.03188%,-1.27613:18.09044%,-0.23351:17.50243%,-0.33484:17.38759%,-71.33197:0.0035%,-9.58113:0.00078%,-71.14798:0.00058%,7.6315100000000005:0.00039%,-64.19493:0.00039%,-1.02014:0.00039%,-71.14931:0.00039%,-0.24151:0.00039%,1.45709:0.00039%,-31.55091:0.00039%,7.4901800000000005:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,1.46509:0.00019%,13.431270000000001:0.00019%,-68.79874000000001:0.00019%,-0.24950999999999998:0.00019%,11.862:0.00019%]
[INFO] ** scada_tag:[3:25.97832%,1:21.03188%,5:18.09025%,4:17.50204%,2:17.38739%,0:0.01012%]
[INFO] ** service:[0.0048200000000000005:99.99397%,-211.73542999999998:0.0035%,-211.08346:0.00058%,-186.44547:0.00039%,-186.43601999999998:0.00039%,-211.07873999999998:0.00039%,-211.08818:0.00039%,-202.75898:0.00039%]
[INFO] ** src:[22:38.41947%,9:25.97929%,7:18.09064%,1:17.50301%,14:0.0035%,11:0.00136%,10:0.00097%,2:0.00097%,15:0.00039%,4:0.00039%]
[INFO] ** type:[0:99.99864%,1:0.00097%,2:0.00039%]
[INFO] ** unixtime:1396 (0.27172%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.8138e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.5387e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3436e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3193e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.1545e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.7160 - tp: 66520.0000 - fp: 13480.0000 - tn: 306520.0000 - fn: 13480.0000 - accuracy: 0.9326 - precision: 0.8315 - recall: 0.8315 - auc: 0.8947 - val_loss: 5.7243 - val_tp: 12897.0000 - val_fp: 7103.0000 - val_tn: 72897.0000 - val_fn: 7103.0000 - val_accuracy: 0.8579 - val_precision: 0.6449 - val_recall: 0.6449 - val_auc: 0.7780
[INFO] saving weights to checkpoints/lstm-epoch-8-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/513763
[33m[INFO] loading file 25-25/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513763, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513763, 17)

[INFO] analyzing data
[INFO] 513763 rows
[INFO] ** appi_name:[21:99.99611%,30:0.00117%,17:0.00078%,22:0.00058%,31:0.00039%,28:0.00019%,26:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** classification:[normal:64.33647%,Multi Stage Single Point:35.66353%]
[INFO] ** dst:[21:43.30927%,10:21.02273%,8:18.1539%,9:17.50944%,15:0.00117%,22:0.00097%,16:0.00078%,6:0.00078%,18:0.00039%,17:0.00039%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name:[2:99.99883%,3:0.00117%]
[INFO] ** modbus_function_code:[0.02961:99.99611%,-33.760870000000004:0.00389%]
[INFO] ** modbus_function_description:[7:49.99873%,11:49.99737%,0:0.00389%]
[INFO] ** modbus_transaction_id:65536 (12.75608%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99766%,2:0.00117%,1:0.00117%]
[INFO] ** proxy_src_ip:[18:38.3819%,20:25.94971%,13:18.15409%,6:17.51002%,17:0.00117%,1:0.00097%,21:0.00078%,16:0.00039%,14:0.00039%,7:0.00039%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.94951%,-0.32151:21.02234%,-1.27613:18.1537%,-0.23351:17.50944%,-0.33484:17.35956%,-71.33197:0.00117%,-71.14931:0.00058%,-1.02014:0.00039%,-0.24151:0.00039%,-49.275529999999996:0.00039%,-71.14798:0.00019%,-58.035180000000004:0.00019%,-1.2708:0.00019%,-5.1466400000000005:0.00019%,-5.08665:0.00019%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.45709:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,2.52505:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.94912%,1:21.02214%,5:18.15351%,4:17.50924%,2:17.35937%,0:0.00662%]
[INFO] ** service:[0.0048200000000000005:99.9965%,-211.73542999999998:0.00117%,-205.44247:0.00078%,-211.08818:0.00058%,-186.43601999999998:0.00039%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.3819%,9:25.94971%,7:18.15409%,1:17.51002%,14:0.00117%,3:0.00097%,4:0.00078%,21:0.00039%,15:0.00039%,2:0.00039%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1396 (0.27172%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7570 - tp: 51426.0000 - fp: 28574.0000 - tn: 291426.0000 - fn: 28574.0000 - accuracy: 0.8571 - precision: 0.6428 - recall: 0.6428 - auc: 0.7768 - val_loss: 5.7493 - val_tp: 12866.0000 - val_fp: 7134.0000 - val_tn: 72866.0000 - val_fn: 7134.0000 - val_accuracy: 0.8573 - val_precision: 0.6433 - val_recall: 0.6433 - val_auc: 0.7771
[INFO] saving weights to checkpoints/lstm-epoch-8-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7435 - tp: 51493.0000 - fp: 28507.0000 - tn: 291493.0000 - fn: 28507.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.7773 - val_loss: 5.7453 - val_tp: 12871.0000 - val_fp: 7129.0000 - val_tn: 72871.0000 - val_fn: 7129.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.7772
[INFO] saving weights to checkpoints/lstm-epoch-8-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7518 - tp: 51452.0000 - fp: 28548.0000 - tn: 291452.0000 - fn: 28548.0000 - accuracy: 0.8573 - precision: 0.6431 - recall: 0.6431 - auc: 0.7770 - val_loss: 5.7413 - val_tp: 12876.0000 - val_fp: 7124.0000 - val_tn: 72876.0000 - val_fn: 7124.0000 - val_accuracy: 0.8575 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.7774
[INFO] saving weights to checkpoints/lstm-epoch-8-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7472 - tp: 51475.0000 - fp: 28525.0000 - tn: 291475.0000 - fn: 28525.0000 - accuracy: 0.8574 - precision: 0.6434 - recall: 0.6434 - auc: 0.7771 - val_loss: 5.7630 - val_tp: 12849.0000 - val_fp: 7151.0000 - val_tn: 72849.0000 - val_fn: 7151.0000 - val_accuracy: 0.8570 - val_precision: 0.6424 - val_recall: 0.6424 - val_auc: 0.7765
[INFO] saving weights to checkpoints/lstm-epoch-8-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7417 - tp: 51502.0000 - fp: 28498.0000 - tn: 291502.0000 - fn: 28498.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7774 - val_loss: 5.7227 - val_tp: 12899.0000 - val_fp: 7101.0000 - val_tn: 72899.0000 - val_fn: 7101.0000 - val_accuracy: 0.8580 - val_precision: 0.6449 - val_recall: 0.6449 - val_auc: 0.7781
[INFO] saving weights to checkpoints/lstm-epoch-8-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/513763
[33m[INFO] loading file 26-26/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513763, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513763, 17)

[INFO] analyzing data
[INFO] 513763 rows
[INFO] ** appi_name:[21:99.99883%,7:0.00058%,30:0.00019%,22:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:64.39487%,Single Stage Single Point:31.08671%,Multi Stage Single Point:4.51843%]
[INFO] ** dst:[21:43.30888%,10:21.08404%,8:18.1212%,9:17.48355%,22:0.00078%,24:0.00039%,16:0.00039%,2:0.00039%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99883%,-33.760870000000004:0.00117%]
[INFO] ** modbus_function_description:[7:49.9999%,11:49.99893%,0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (12.75608%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99961%,2:0.00019%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.46599%,20:25.92732%,13:18.12159%,6:17.48355%,16:0.00039%,1:0.00039%,21:0.00019%,17:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.92674%,-0.32151:21.08404%,-1.27613:18.121%,-0.23351:17.48335%,-0.33484:17.38194%,-1.27347:0.00039%,-1.02014:0.00039%,7.66617:0.00019%,-1.2708:0.00019%,-71.14931:0.00019%,-0.24151:0.00019%,11.57001:0.00019%,1.47576:0.00019%,1.46509:0.00019%,14.191239999999999:0.00019%,-3.3787199999999995:0.00019%,1.45709:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.92635%,1:21.08404%,5:18.121%,4:17.48316%,2:17.38194%,0:0.0035%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.09762999999998:0.00058%,-211.73542999999998:0.00019%,-211.35747999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.46599%,9:25.92732%,7:18.12159%,1:17.48355%,15:0.00039%,3:0.00039%,21:0.00019%,14:0.00019%,4:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1394 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.0621 - tp: 52855.0000 - fp: 27145.0000 - tn: 292855.0000 - fn: 27145.0000 - accuracy: 0.8643 - precision: 0.6607 - recall: 0.6607 - auc: 0.7880 - val_loss: 0.0025 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0583 - tp: 78887.0000 - fp: 1113.0000 - tn: 318887.0000 - fn: 1113.0000 - accuracy: 0.9944 - precision: 0.9861 - recall: 0.9861 - auc: 0.9996 - val_loss: 1.5970e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0480 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.6463e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0424 - tp: 79155.0000 - fp: 845.0000 - tn: 319155.0000 - fn: 845.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 5.4841e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0419 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 4.3831e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/513763
[33m[INFO] loading file 27-27/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (453893, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (453893, 17)

[INFO] analyzing data
[INFO] 453893 rows
[INFO] ** appi_name:[21:99.99934%,30:0.00066%]
[INFO] ** classification:[normal:64.33917%,Single Stage Single Point:35.66083%]
[INFO] ** dst:[21:43.27121%,10:21.06598%,8:18.19041%,9:17.47064%,22:0.00088%,15:0.00066%,24:0.00022%]
[INFO] ** i/f_dir:[1:99.99978%,0:0.00022%]
[INFO] ** i/f_name:[2:99.99934%,3:0.00066%]
[INFO] ** modbus_function_code:[0.02961:99.99934%,-33.760870000000004:0.00066%]
[INFO] ** modbus_function_description:[7:50.00033%,11:49.99901%,0:0.00066%]
[INFO] ** modbus_transaction_id:65536 (14.43865%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99934%,1:0.00066%]
[INFO] ** proxy_src_ip:[18:38.40729%,20:25.93056%,13:18.19019%,6:17.47086%,17:0.00066%,16:0.00044%]
[INFO] ** s_port:[1.45442:25.9299%,-0.32151:21.06598%,-1.27613:18.18997%,-0.23351:17.47042%,-0.33484:17.34131%,-71.33197:0.00066%,-1.02014:0.00044%,-1.27347:0.00022%,1.45709:0.00022%,-0.24950999999999998:0.00022%,1.46509:0.00022%,1.47576:0.00022%,-0.24151:0.00022%]
[INFO] ** scada_tag:[3:25.92946%,1:21.06576%,5:18.18975%,4:17.4702%,2:17.34109%,0:0.00375%]
[INFO] ** service:[0.0048200000000000005:99.99934%,-211.73542999999998:0.00066%]
[INFO] ** src:[22:38.40729%,9:25.93056%,7:18.19019%,1:17.47086%,14:0.00066%,15:0.00044%]
[INFO] ** type:[0:99.99956%,1:0.00044%]
[INFO] ** unixtime:1233 (0.27165%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/453893
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0435 - tp: 79029.0000 - fp: 971.0000 - tn: 319029.0000 - fn: 971.0000 - accuracy: 0.9951 - precision: 0.9879 - recall: 0.9879 - auc: 0.9997 - val_loss: 2.2559e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/453893
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0341 - tp: 79152.0000 - fp: 848.0000 - tn: 319152.0000 - fn: 848.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 8.0052e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/453893
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0327 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 2.8652e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/453893
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0294 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 8.6225e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/453893
[33m[INFO] loading file 28-28/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (387809, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (387809, 17)

[INFO] analyzing data
[INFO] 387809 rows
[INFO] ** appi_name:[21:99.99226%,30:0.00181%,17:0.00129%,22:0.00103%,7:0.00103%,31:0.00077%,26:0.00077%,28:0.00026%,27:0.00026%,8:0.00026%,0:0.00026%]
[INFO] ** classification:[normal:64.30743%,Single Stage Single Point:35.69257%]
[INFO] ** dst:[21:43.28084%,10:21.01859%,8:18.20613%,9:17.48619%,6:0.00206%,16:0.00181%,18:0.00129%,15:0.00077%,22:0.00052%,17:0.00052%,2:0.00052%,25:0.00026%,7:0.00026%,0:0.00026%]
[INFO] ** i/f_dir:[1:99.99923%,0:0.00077%]
[INFO] ** i/f_name:[2:99.99923%,3:0.00077%]
[INFO] ** modbus_function_code:[0.02961:99.99226%,-33.760870000000004:0.00774%]
[INFO] ** modbus_function_description:[7:49.99626%,11:49.996%,0:0.00774%]
[INFO] ** modbus_transaction_id:65536 (16.89904%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99536%,2:0.00387%,1:0.00077%]
[INFO] ** proxy_src_ip:[18:38.33614%,20:25.9633%,13:18.20639%,6:17.48644%,1:0.00206%,17:0.00181%,14:0.00155%,7:0.00129%,21:0.00077%,0:0.00026%]
[INFO] ** s_port:[1.45442:25.96304%,-0.32151:21.01859%,-1.27613:18.20613%,-0.23351:17.48593%,-0.33484:17.31755%,-71.14798:0.00103%,-71.14931:0.00103%,-71.33197:0.00077%,-0.08551:0.00052%,-0.24151:0.00052%,7.66617:0.00026%,-58.035180000000004:0.00026%,-1.2708:0.00026%,-64.19493:0.00026%,-5.1466400000000005:0.00026%,13.431270000000001:0.00026%,11.57001:0.00026%,14.4699:0.00026%,1.47576:0.00026%,14.191239999999999:0.00026%,-5.08665:0.00026%,10.192739999999999:0.00026%,-3.3787199999999995:0.00026%,6.1115699999999995:0.00026%,2.05573:0.00026%,-43.76509:0.00026%,2.52505:0.00026%,11.862:0.00026%,-58.032509999999995:0.00026%]
[INFO] ** scada_tag:[3:25.96278%,1:21.01859%,5:18.20613%,4:17.48567%,2:17.31755%,0:0.00928%]
[INFO] ** service:[0.0048200000000000005:99.99226%,-205.44247:0.00129%,-186.43601999999998:0.00129%,-211.09762999999998:0.00103%,-211.08346:0.00103%,-211.08818:0.00103%,-211.73542999999998:0.00077%,-186.44547:0.00026%,-183.8612:0.00026%,-185.9872:0.00026%,-211.35747999999998:0.00026%,-202.75898:0.00026%]
[INFO] ** src:[22:38.33614%,9:25.9633%,7:18.20639%,1:17.48644%,3:0.00232%,2:0.00155%,21:0.00129%,4:0.00103%,14:0.00077%,8:0.00052%,17:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1054 (0.27178%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/387809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0300 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9997 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/387809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0253 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.6722e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/387809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0231 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/387809
[33m[INFO] loading file 29-29/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587809, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587809, 17)

[INFO] analyzing data
[INFO] 587809 rows
[INFO] ** appi_name:[21:99.99881%,30:0.00051%,31:0.00017%,26:0.00017%,9:0.00017%,3:0.00017%]
[INFO] ** classification:[normal:64.38401%,Single Stage Single Point:35.61599%]
[INFO] ** dst:[21:43.32087%,10:21.06177%,8:18.14586%,9:17.46979%,22:0.00051%,15:0.00051%,24:0.00017%,18:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99949%,3:0.00051%]
[INFO] ** modbus_function_code:[0.02961:99.99881%,-33.760870000000004:0.00119%]
[INFO] ** modbus_function_description:[7:49.99974%,11:49.99906%,0:0.00119%]
[INFO] ** modbus_transaction_id:65536 (11.1492%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99915%,1:0.00051%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.43561%,20:25.9472%,13:18.1462%,6:17.46962%,17:0.00051%,21:0.00017%,16:0.00017%,7:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.94669%,-0.32151:21.0616%,-1.27613:18.14586%,-0.23351:17.46962%,-0.33484:17.37401%,-71.33197:0.00051%,1.45709:0.00034%,-71.14798:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,6.1115699999999995:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:25.94635%,1:21.06143%,5:18.14586%,4:17.46928%,2:17.37401%,0:0.00306%]
[INFO] ** service:[0.0048200000000000005:99.99898%,-211.73542999999998:0.00051%,-183.8612:0.00017%,-211.08346:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.43561%,9:25.9472%,7:18.1462%,1:17.46962%,14:0.00051%,21:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1596 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0220 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.3382e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1924e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/587809
[33m[INFO] loading file 30-30/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587809, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587809, 17)

[INFO] analyzing data
[INFO] 587809 rows
[INFO] ** appi_name:[21:99.99745%,30:0.0017%,26:0.00017%,17:0.00017%,12:0.00017%,3:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.37601%,Single Stage Single Point:35.62399%]
[INFO] ** dst:[21:43.3435%,10:21.02962%,8:18.1428%,9:17.48085%,15:0.0017%,22:0.00068%,24:0.00034%,25:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99847%,0:0.00153%]
[INFO] ** i/f_name:[2:99.9983%,3:0.0017%]
[INFO] ** modbus_function_code:[0.02961:99.99745%,-33.760870000000004:0.00255%]
[INFO] ** modbus_function_description:[7:49.99957%,11:49.99787%,0:0.00255%]
[INFO] ** modbus_transaction_id:65536 (11.1492%)
[INFO] ** orig:[0:99.99915%,2:0.00051%,1:0.00034%]
[INFO] ** proto:[0:99.99796%,1:0.0017%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.37624%,20:25.99654%,13:18.14314%,6:17.48136%,17:0.0017%,7:0.00034%,0:0.00034%,16:0.00017%,5:0.00017%]
[INFO] ** s_port:[1.45442:25.99637%,-0.32151:21.02928%,-1.27613:18.14263%,-0.23351:17.48068%,-0.33484:17.34696%,-71.33197:0.0017%,-0.24151:0.00051%,-1.27347:0.00034%,-61.95768:0.00034%,-71.14798:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:25.99603%,1:21.02928%,5:18.14246%,4:17.48051%,2:17.34679%,0:0.00493%]
[INFO] ** service:[0.0048200000000000005:99.99779%,-211.73542999999998:0.0017%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.37624%,9:25.99654%,7:18.14314%,1:17.48136%,14:0.00119%,21:0.00085%,8:0.00034%,16:0.00017%,15:0.00017%]
[INFO] ** type:[0:99.99915%,1:0.00085%]
[INFO] ** unixtime:1598 (0.27186%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.2080e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1923e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0216 - tp: 79036.0000 - fp: 964.0000 - tn: 319036.0000 - fn: 964.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9999 - val_loss: 1.1922e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79138.0000 - fp: 862.0000 - tn: 319138.0000 - fn: 862.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/587809
[33m[INFO] loading file 31-31/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587809, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587809, 17)

[INFO] analyzing data
[INFO] 587809 rows
[INFO] ** appi_name:[21:99.99966%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.3784%,Single Stage Single Point:35.6216%]
[INFO] ** dst:[21:43.32581%,10:21.05123%,8:18.12051%,9:17.50075%,22:0.00102%,24:0.00034%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99966%,-33.760870000000004:0.00034%]
[INFO] ** modbus_function_description:[7:50.00009%,11:49.99957%,0:0.00034%]
[INFO] ** modbus_transaction_id:65536 (11.1492%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.39938%,20:25.97817%,13:18.12085%,6:17.50075%,16:0.00051%,7:0.00034%]
[INFO] ** s_port:[1.45442:25.97749%,-0.32151:21.05123%,-1.27613:18.12034%,-0.23351:17.50058%,-0.33484:17.34815%,-1.02014:0.00051%,-1.27347:0.00034%,1.45709:0.00034%,-71.14798:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.97715%,1:21.05106%,5:18.12017%,4:17.50024%,2:17.34798%,0:0.0034%]
[INFO] ** service:[0.0048200000000000005:99.99966%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.39938%,9:25.97817%,7:18.12085%,1:17.50075%,15:0.00051%,21:0.00034%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1597 (0.27169%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79071.0000 - fp: 929.0000 - tn: 319071.0000 - fn: 929.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1923e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79124.0000 - fp: 876.0000 - tn: 319124.0000 - fn: 876.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0196 - tp: 79143.0000 - fp: 857.0000 - tn: 319143.0000 - fn: 857.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/587809
[33m[INFO] loading file 32-32/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587809, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587809, 17)

[INFO] analyzing data
[INFO] 587809 rows
[INFO] ** appi_name:[21:99.9966%,30:0.00289%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.38197%,Single Stage Single Point:35.61803%]
[INFO] ** dst:[21:43.32104%,10:21.0565%,8:18.15301%,9:17.46503%,15:0.00289%,22:0.00085%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99745%,0:0.00255%]
[INFO] ** i/f_name:[2:99.99711%,3:0.00289%]
[INFO] ** modbus_function_code:[0.02961:99.9966%,-33.760870000000004:0.0034%]
[INFO] ** modbus_function_description:[7:49.99906%,11:49.99753%,0:0.0034%]
[INFO] ** modbus_transaction_id:65536 (11.1492%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9966%,1:0.00289%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.42473%,20:25.95316%,13:18.15301%,6:17.46554%,17:0.00289%,14:0.00051%,16:0.00017%]
[INFO] ** s_port:[1.45442:25.95265%,-0.32151:21.0565%,-1.27613:18.15267%,-0.23351:17.46486%,-0.33484:17.36823%,-71.33197:0.00289%,-0.24151:0.00051%,-1.2708:0.00017%,-1.02014:0.00017%,13.431270000000001:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.95231%,1:21.05633%,5:18.15267%,4:17.46452%,2:17.36823%,0:0.00595%]
[INFO] ** service:[0.0048200000000000005:99.9966%,-211.73542999999998:0.00289%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.42473%,9:25.95316%,7:18.15301%,1:17.46554%,14:0.00289%,2:0.00051%,15:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1595 (0.27135%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79144.0000 - fp: 856.0000 - tn: 319144.0000 - fn: 856.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79070.0000 - fp: 930.0000 - tn: 319070.0000 - fn: 930.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.2763e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/587809
[33m[INFO] loading file 33-33/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587809, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587809, 17)

[INFO] analyzing data
[INFO] 587809 rows
[INFO] ** appi_name:[21:99.99711%,30:0.00102%,17:0.00068%,22:0.00051%,31:0.00017%,28:0.00017%,26:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.39371%,Single Stage Single Point:35.60629%]
[INFO] ** dst:[21:43.32632%,10:21.06279%,8:18.12374%,9:17.48255%,22:0.00136%,15:0.00102%,16:0.00068%,6:0.00068%,24:0.00034%,17:0.00034%,18:0.00017%]
[INFO] ** i/f_dir:[1:99.99898%,0:0.00102%]
[INFO] ** i/f_name:[2:99.99898%,3:0.00102%]
[INFO] ** modbus_function_code:[0.02961:99.99711%,-33.760870000000004:0.00289%]
[INFO] ** modbus_function_description:[7:49.99957%,11:49.99753%,0:0.00289%]
[INFO] ** modbus_transaction_id:65536 (11.1492%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99813%,1:0.00102%,2:0.00085%]
[INFO] ** proxy_src_ip:[18:38.42286%,20:25.96711%,13:18.12374%,6:17.48272%,17:0.00102%,16:0.00068%,1:0.00068%,21:0.00034%,14:0.00034%,7:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.96626%,-0.32151:21.06279%,-1.27613:18.1234%,-0.23351:17.48238%,-0.33484:17.36006%,-71.33197:0.00102%,-1.02014:0.00068%,1.45709:0.00051%,-71.14931:0.00051%,-1.27347:0.00034%,-5.08665:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,-71.14798:0.00017%,-58.032509999999995:0.00017%,-58.035180000000004:0.00017%,-0.24151:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.96592%,1:21.06262%,5:18.12323%,4:17.48221%,2:17.36006%,0:0.00595%]
[INFO] ** service:[0.0048200000000000005:99.99711%,-211.73542999999998:0.00102%,-205.44247:0.00068%,-211.08818:0.00051%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.42286%,9:25.96711%,7:18.12374%,1:17.48272%,14:0.00102%,15:0.00068%,3:0.00068%,21:0.00034%,4:0.00034%,2:0.00034%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1598 (0.27186%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79154.0000 - fp: 846.0000 - tn: 319154.0000 - fn: 846.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79070.0000 - fp: 930.0000 - tn: 319070.0000 - fn: 930.0000 - accuracy: 0.9953 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79074.0000 - fp: 926.0000 - tn: 319074.0000 - fn: 926.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/587809
[33m[INFO] loading file 34-34/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (429242, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (429242, 17)

[INFO] analyzing data
[INFO] 429242 rows
[INFO] ** appi_name:[21:99.99767%,30:0.0007%,7:0.0007%,31:0.00023%,22:0.00023%,8:0.00023%,6:0.00023%]
[INFO] ** classification:[normal:64.35134%,Single Stage Single Point:35.64866%]
[INFO] ** dst:[21:43.2905%,10:21.05782%,8:18.18461%,9:17.46427%,22:0.0007%,15:0.0007%,16:0.00047%,2:0.00047%,18:0.00023%,6:0.00023%]
[INFO] ** i/f_dir:[1:99.9993%,0:0.0007%]
[INFO] ** i/f_name:[2:99.9993%,3:0.0007%]
[INFO] ** modbus_function_code:[0.02961:99.99767%,-33.760870000000004:0.00233%]
[INFO] ** modbus_function_description:[7:49.9993%,11:49.99837%,0:0.00233%]
[INFO] ** modbus_transaction_id:65536 (15.26784%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99884%,1:0.0007%,2:0.00047%]
[INFO] ** proxy_src_ip:[18:38.39629%,20:25.95226%,13:18.18438%,6:17.46474%,17:0.0007%,1:0.0007%,21:0.00047%,14:0.00023%,7:0.00023%]
[INFO] ** s_port:[1.45442:25.95179%,-0.32151:21.05759%,-1.27613:18.18438%,-0.23351:17.46404%,-0.33484:17.3387%,-0.24151:0.0007%,-71.33197:0.0007%,-3.0613900000000003:0.00023%,-3.3787199999999995:0.00023%,14.191239999999999:0.00023%,1.46509:0.00023%,1.47576:0.00023%,11.57001:0.00023%,-49.275529999999996:0.00023%,-71.14931:0.00023%,7.66617:0.00023%]
[INFO] ** scada_tag:[3:25.95156%,1:21.05735%,5:18.18415%,4:17.46358%,2:17.3387%,0:0.00466%]
[INFO] ** service:[0.0048200000000000005:99.9979%,-211.09762999999998:0.0007%,-211.73542999999998:0.0007%,-186.43601999999998:0.00023%,-211.35747999999998:0.00023%,-211.08818:0.00023%]
[INFO] ** src:[22:38.39629%,9:25.95226%,7:18.18438%,1:17.46474%,14:0.0007%,3:0.0007%,4:0.00047%,21:0.00023%,2:0.00023%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1166 (0.27164%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/429242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79077.0000 - fp: 923.0000 - tn: 319077.0000 - fn: 923.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1936e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/429242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79073.0000 - fp: 927.0000 - tn: 319073.0000 - fn: 927.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/429242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/429242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-33-34-batch-300000-400000
[INFO] processing batch 400000-500000/429242
[33m[INFO] loading file 35-35/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529242, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529242, 17)

[INFO] analyzing data
[INFO] 529242 rows
[INFO] ** appi_name:[21:99.99887%,30:0.00113%]
[INFO] ** classification:[normal:64.37452%,Single Stage Single Point:35.62548%]
[INFO] ** dst:[21:43.33462%,10:21.03726%,8:18.1469%,9:17.47896%,22:0.00113%,15:0.00113%]
[INFO] ** i/f_dir:[1:99.99906%,0:0.00094%]
[INFO] ** i/f_name:[2:99.99887%,3:0.00113%]
[INFO] ** modbus_function_code:[0.02961:99.99887%,-33.760870000000004:0.00113%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99887%,0:0.00113%]
[INFO] ** modbus_transaction_id:65536 (12.38299%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99887%,1:0.00113%]
[INFO] ** proxy_src_ip:[18:38.40096%,20:25.97148%,13:18.14652%,6:17.47915%,17:0.00113%,16:0.00076%]
[INFO] ** s_port:[1.45442:25.97092%,-0.32151:21.03726%,-1.27613:18.14652%,-0.23351:17.47877%,-0.33484:17.3637%,-71.33197:0.00113%,-1.02014:0.00076%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.97054%,1:21.03726%,5:18.14633%,4:17.47839%,2:17.3637%,0:0.00378%]
[INFO] ** service:[0.0048200000000000005:99.99887%,-211.73542999999998:0.00113%]
[INFO] ** src:[22:38.40096%,9:25.97148%,7:18.14652%,1:17.47915%,14:0.00113%,15:0.00076%]
[INFO] ** type:[0:99.99906%,1:0.00094%]
[INFO] ** unixtime:1437 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79079.0000 - fp: 921.0000 - tn: 319079.0000 - fn: 921.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0216 - tp: 79014.0000 - fp: 986.0000 - tn: 319014.0000 - fn: 986.0000 - accuracy: 0.9951 - precision: 0.9877 - recall: 0.9877 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79089.0000 - fp: 911.0000 - tn: 319089.0000 - fn: 911.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/529242
[33m[INFO] loading file 36-36/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529242, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529242, 17)

[INFO] analyzing data
[INFO] 529242 rows
[INFO] ** appi_name:[21:99.99868%,30:0.00057%,31:0.00038%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.35222%,Single Stage Single Point:35.64778%]
[INFO] ** dst:[21:43.32952%,10:21.02063%,8:18.16107%,9:17.48652%,22:0.00076%,15:0.00057%,24:0.00038%,18:0.00038%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99943%,0:0.00057%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99868%,-33.760870000000004:0.00132%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99849%,0:0.00132%]
[INFO] ** modbus_transaction_id:65536 (12.38299%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99887%,2:0.00057%,1:0.00057%]
[INFO] ** proxy_src_ip:[18:38.36808%,20:25.98225%,13:18.16126%,6:17.48709%,17:0.00057%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98169%,-0.32151:21.02044%,-1.27613:18.16069%,-0.23351:17.48633%,-0.33484:17.34764%,-0.24151:0.00057%,-71.33197:0.00057%,-1.27347:0.00038%,-0.08551:0.00038%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-49.275529999999996:0.00019%,-1.2708:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:25.98131%,1:21.02025%,5:18.1605%,4:17.48614%,2:17.34745%,0:0.00435%]
[INFO] ** service:[0.0048200000000000005:99.99887%,-211.73542999999998:0.00057%,-186.43601999999998:0.00038%,-186.44547:0.00019%]
[INFO] ** src:[22:38.36808%,9:25.98225%,7:18.16126%,1:17.48709%,14:0.00057%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1438 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79123.0000 - fp: 877.0000 - tn: 319123.0000 - fn: 877.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 2.2022e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79151.0000 - fp: 849.0000 - tn: 319151.0000 - fn: 849.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79154.0000 - fp: 846.0000 - tn: 319154.0000 - fn: 846.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/529242
[33m[INFO] loading file 37-37/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529242, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529242, 17)

[INFO] analyzing data
[INFO] 529242 rows
[INFO] ** appi_name:[21:99.99887%,30:0.00076%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.38472%,Single Stage Single Point:35.61528%]
[INFO] ** dst:[21:43.33783%,10:21.045%,8:18.1348%,9:17.48028%,22:0.00076%,15:0.00076%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99924%,3:0.00076%]
[INFO] ** modbus_function_code:[0.02961:99.99887%,-33.760870000000004:0.00113%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99887%,0:0.00113%]
[INFO] ** modbus_transaction_id:65536 (12.38299%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99906%,1:0.00076%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.39794%,20:25.98528%,13:18.13499%,6:17.48028%,17:0.00076%,16:0.00038%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.98471%,-0.32151:21.045%,-1.27613:18.13462%,-0.23351:17.48009%,-0.33484:17.35293%,-71.33197:0.00076%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%,14.4699:0.00019%]
[INFO] ** scada_tag:[3:25.98452%,1:21.045%,5:18.13443%,4:17.47991%,2:17.35274%,0:0.0034%]
[INFO] ** service:[0.0048200000000000005:99.99887%,-211.73542999999998:0.00076%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.39794%,9:25.98528%,7:18.13499%,1:17.48028%,14:0.00076%,15:0.00038%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1438 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79038.0000 - fp: 962.0000 - tn: 319038.0000 - fn: 962.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79137.0000 - fp: 863.0000 - tn: 319137.0000 - fn: 863.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79088.0000 - fp: 912.0000 - tn: 319088.0000 - fn: 912.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79079.0000 - fp: 921.0000 - tn: 319079.0000 - fn: 921.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79147.0000 - fp: 853.0000 - tn: 319147.0000 - fn: 853.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/529242
[33m[INFO] loading file 38-38/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529242, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529242, 17)

[INFO] analyzing data
[INFO] 529242 rows
[INFO] ** appi_name:[21:99.99906%,30:0.00019%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.41061%,Single Stage Single Point:35.58939%]
[INFO] ** dst:[21:43.32139%,10:21.08714%,8:18.09664%,9:17.49294%,22:0.00094%,25:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99906%,-33.760870000000004:0.00094%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99943%,0:0.00094%]
[INFO] ** modbus_transaction_id:65536 (12.38299%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99943%,2:0.00038%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.45519%,20:25.95391%,13:18.09645%,6:17.49332%,7:0.00038%,17:0.00019%,16:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95316%,-0.32151:21.08695%,-1.27613:18.09626%,-0.23351:17.49275%,-0.33484:17.36824%,-0.24151:0.00038%,1.45709:0.00038%,-64.19493:0.00019%,10.192739999999999:0.00019%,-1.02014:0.00019%,-71.14798:0.00019%,-61.95768:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.95278%,1:21.08695%,5:18.09626%,4:17.49256%,2:17.36824%,0:0.00321%]
[INFO] ** service:[0.0048200000000000005:99.99924%,-211.08346:0.00019%,-205.44247:0.00019%,-186.44547:0.00019%,-211.73542999999998:0.00019%]
[INFO] ** src:[22:38.45519%,9:25.95391%,7:18.09645%,1:17.49332%,21:0.00038%,16:0.00019%,15:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1438 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79150.0000 - fp: 850.0000 - tn: 319150.0000 - fn: 850.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79077.0000 - fp: 923.0000 - tn: 319077.0000 - fn: 923.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79073.0000 - fp: 927.0000 - tn: 319073.0000 - fn: 927.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/529242
[33m[INFO] loading file 39-39/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529242, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529242, 17)

[INFO] analyzing data
[INFO] 529242 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.41288%,Single Stage Single Point:35.58712%]
[INFO] ** dst:[21:43.32517%,10:21.08695%,8:18.12762%,9:17.45912%,22:0.00094%,24:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00057%,11:49.99943%]
[INFO] ** modbus_transaction_id:65536 (12.38299%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.45972%,20:25.95259%,13:18.128%,6:17.45912%,16:0.00057%]
[INFO] ** s_port:[1.45442:25.95221%,-0.32151:21.08695%,-1.27613:18.12762%,-0.23351:17.45893%,-0.33484:17.37277%,-1.02014:0.00057%,-1.27347:0.00019%,1.45709:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95183%,1:21.08676%,5:18.12744%,4:17.45893%,2:17.37258%,0:0.00246%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.45972%,9:25.95259%,7:18.128%,1:17.45912%,15:0.00057%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1437 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79150.0000 - fp: 850.0000 - tn: 319150.0000 - fn: 850.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/529242
[33m[INFO] loading file 40-40/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529242, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529242, 17)

[INFO] analyzing data
[INFO] 529242 rows
[INFO] ** appi_name:[21:99.99622%,30:0.00321%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.33371%,Single Stage Single Point:35.66629%]
[INFO] ** dst:[21:43.29097%,10:21.03763%,8:18.19451%,9:17.47197%,15:0.00321%,22:0.00094%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99698%,0:0.00302%]
[INFO] ** i/f_name:[2:99.99679%,3:0.00321%]
[INFO] ** modbus_function_code:[0.02961:99.99622%,-33.760870000000004:0.00378%]
[INFO] ** modbus_function_description:[7:49.99924%,11:49.99698%,0:0.00378%]
[INFO] ** modbus_transaction_id:65536 (12.38299%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99622%,1:0.00321%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.3524%,20:25.97715%,13:18.19432%,6:17.47235%,17:0.00321%,14:0.00057%]
[INFO] ** s_port:[1.45442:25.97621%,-0.32151:21.03763%,-1.27613:18.19413%,-0.23351:17.47178%,-0.33484:17.31476%,-71.33197:0.00321%,1.45709:0.00057%,-0.24151:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,13.431270000000001:0.00019%]
[INFO] ** scada_tag:[3:25.97583%,1:21.03745%,5:18.19395%,4:17.4714%,2:17.31457%,0:0.0068%]
[INFO] ** service:[0.0048200000000000005:99.99622%,-211.73542999999998:0.00321%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.3524%,9:25.97715%,7:18.19432%,1:17.47235%,14:0.00321%,2:0.00057%]
[INFO] ** type:[0:99.99906%,1:0.00094%]
[INFO] ** unixtime:1439 (0.2719%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79138.0000 - fp: 862.0000 - tn: 319138.0000 - fn: 862.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79066.0000 - fp: 934.0000 - tn: 319066.0000 - fn: 934.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/529242
[33m[INFO] loading file 41-41/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (469400, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (469400, 17)

[INFO] analyzing data
[INFO] 469400 rows
[INFO] ** appi_name:[21:99.99638%,30:0.00107%,22:0.00085%,17:0.00085%,32:0.00021%,28:0.00021%,26:0.00021%,7:0.00021%]
[INFO] ** classification:[normal:64.3905%,Single Stage Single Point:35.6095%]
[INFO] ** dst:[21:43.32318%,10:21.06285%,8:18.13975%,9:17.46954%,16:0.00107%,15:0.00107%,6:0.00107%,22:0.00064%,24:0.00043%,17:0.00043%]
[INFO] ** i/f_dir:[1:99.99893%,0:0.00107%]
[INFO] ** i/f_name:[2:99.99893%,3:0.00107%]
[INFO] ** modbus_function_code:[0.02961:99.99638%,-33.760870000000004:0.00362%]
[INFO] ** modbus_function_description:[7:49.99915%,11:49.99723%,0:0.00362%]
[INFO] ** modbus_transaction_id:65536 (13.96165%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99766%,2:0.00128%,1:0.00107%]
[INFO] ** proxy_src_ip:[18:38.43822%,20:25.94802%,13:18.13997%,6:17.46975%,17:0.00107%,1:0.00085%,21:0.00043%,16:0.00043%,14:0.00043%,0:0.00043%,7:0.00021%,2:0.00021%]
[INFO] ** s_port:[1.45442:25.94759%,-0.32151:21.06285%,-1.27613:18.13933%,-0.23351:17.46932%,-0.33484:17.37537%,-71.33197:0.00107%,-71.14931:0.00085%,-1.02014:0.00043%,-1.27347:0.00043%,-71.14798:0.00021%,-0.24151:0.00021%,-58.035180000000004:0.00021%,-1.2708:0.00021%,-5.1466400000000005:0.00021%,1.47576:0.00021%,1.46509:0.00021%,-64.19226:0.00021%,-5.08665:0.00021%,-0.24950999999999998:0.00021%,2.05573:0.00021%,-43.76509:0.00021%,-58.032509999999995:0.00021%]
[INFO] ** scada_tag:[3:25.94738%,1:21.06285%,5:18.13933%,4:17.46911%,2:17.37537%,0:0.00597%]
[INFO] ** service:[0.0048200000000000005:99.99638%,-211.73542999999998:0.00107%,-205.44247:0.00085%,-211.08818:0.00085%,89.64175:0.00021%,-211.09762999999998:0.00021%,-211.08346:0.00021%,-185.9872:0.00021%]
[INFO] ** src:[22:38.43822%,9:25.94802%,7:18.13997%,1:17.46975%,14:0.00107%,3:0.00085%,15:0.00043%,8:0.00043%,4:0.00043%,2:0.00043%,21:0.00021%,17:0.00021%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1273 (0.2712%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/469400
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/469400
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 8.0603e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/469400
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/469400
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/469400
[33m[INFO] loading file 42-42/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (412914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (412914, 17)

[INFO] analyzing data
[INFO] 412914 rows
[INFO] ** appi_name:[21:99.99177%,30:0.00218%,17:0.00121%,31:0.00097%,26:0.00097%,7:0.00097%,22:0.00073%,28:0.00024%,27:0.00024%,9:0.00024%,8:0.00024%,0:0.00024%]
[INFO] ** classification:[normal:64.37927%,Single Stage Single Point:35.62073%]
[INFO] ** dst:[21:43.31653%,10:21.05402%,8:18.17618%,9:17.44407%,16:0.00218%,6:0.00194%,18:0.00121%,2:0.00097%,22:0.00073%,15:0.00073%,17:0.00048%,25:0.00024%,24:0.00024%,7:0.00024%,0:0.00024%]
[INFO] ** i/f_dir:[1:99.99927%,0:0.00073%]
[INFO] ** i/f_name:[2:99.99927%,3:0.00073%]
[INFO] ** modbus_function_code:[0.02961:99.99177%,-33.760870000000004:0.00823%]
[INFO] ** modbus_function_description:[7:49.99661%,11:49.99516%,0:0.00823%]
[INFO] ** modbus_transaction_id:65536 (15.87159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99564%,2:0.00363%,1:0.00073%]
[INFO] ** proxy_src_ip:[18:38.41357%,20:25.95722%,13:18.17667%,6:17.44407%,17:0.00218%,1:0.00218%,14:0.00145%,21:0.00097%,7:0.00073%,0:0.00048%,16:0.00024%,2:0.00024%]
[INFO] ** s_port:[1.45442:25.95674%,-0.32151:21.05402%,-1.27613:18.17618%,-0.23351:17.44383%,-0.33484:17.35955%,-71.14931:0.00097%,-71.14798:0.00097%,-71.33197:0.00073%,11.57001:0.00048%,-0.08551:0.00048%,-3.3787199999999995:0.00048%,-0.24151:0.00024%,13.431270000000001:0.00024%,-5.1466400000000005:0.00024%,0.31847:0.00024%,-1.02014:0.00024%,-1.2708:0.00024%,-58.035180000000004:0.00024%,7.66617:0.00024%,-64.19493:0.00024%,1.47576:0.00024%,14.4699:0.00024%,15.912510000000001:0.00024%,14.191239999999999:0.00024%,7.9608300000000005:0.00024%,-5.08665:0.00024%,10.192739999999999:0.00024%,-3.0613900000000003:0.00024%,1.45709:0.00024%,2.05573:0.00024%,-43.76509:0.00024%,11.862:0.00024%,-1.27347:0.00024%,-58.032509999999995:0.00024%]
[INFO] ** scada_tag:[3:25.95625%,1:21.05402%,5:18.17594%,4:17.44383%,2:17.3593%,0:0.01066%]
[INFO] ** service:[0.0048200000000000005:99.99177%,-211.09762999999998:0.0017%,-205.44247:0.00121%,-186.43601999999998:0.00121%,-211.08346:0.00097%,-211.08818:0.00097%,-211.73542999999998:0.00073%,-211.35747999999998:0.00048%,-186.44547:0.00024%,-183.8612:0.00024%,-185.9872:0.00024%,-202.75898:0.00024%]
[INFO] ** src:[22:38.41357%,9:25.95722%,7:18.17667%,1:17.44407%,3:0.00291%,2:0.0017%,4:0.00121%,21:0.00097%,14:0.00073%,8:0.00048%,17:0.00024%,15:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1121 (0.27149%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/412914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79139.0000 - fp: 861.0000 - tn: 319139.0000 - fn: 861.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 2.2058e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/412914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79075.0000 - fp: 925.0000 - tn: 319075.0000 - fn: 925.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 4.9078e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/412914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79131.0000 - fp: 869.0000 - tn: 319131.0000 - fn: 869.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/412914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-41-42-batch-300000-400000
[INFO] processing batch 400000-500000/412914
[33m[INFO] loading file 43-43/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (512914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (512914, 17)

[INFO] analyzing data
[INFO] 512914 rows
[INFO] ** appi_name:[21:99.99922%,30:0.00058%,26:0.00019%]
[INFO] ** classification:[normal:64.39949%,Single Stage Single Point:35.60051%]
[INFO] ** dst:[21:43.33085%,10:21.06688%,8:18.12936%,9:17.47096%,22:0.00097%,15:0.00058%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99942%,3:0.00058%]
[INFO] ** modbus_function_code:[0.02961:99.99922%,-33.760870000000004:0.00078%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99903%,0:0.00078%]
[INFO] ** modbus_transaction_id:65536 (12.77719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99922%,1:0.00058%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.42087%,20:25.97726%,13:18.12955%,6:17.47116%,17:0.00058%,16:0.00039%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.97667%,-0.32151:21.06688%,-1.27613:18.12916%,-0.23351:17.47077%,-0.33484:17.35398%,-71.33197:0.00058%,1.45709:0.00039%,-1.02014:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.97628%,1:21.06688%,5:18.12897%,4:17.47038%,2:17.35379%,0:0.0037%]
[INFO] ** service:[0.0048200000000000005:99.99922%,-211.73542999999998:0.00058%,-211.08346:0.00019%]
[INFO] ** src:[22:38.42087%,9:25.97726%,7:18.12955%,1:17.47116%,14:0.00058%,15:0.00039%,3:0.00019%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1395 (0.27198%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0196 - tp: 79150.0000 - fp: 850.0000 - tn: 319150.0000 - fn: 850.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79143.0000 - fp: 857.0000 - tn: 319143.0000 - fn: 857.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/512914
[33m[INFO] loading file 44-44/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (512914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (512914, 17)

[INFO] analyzing data
[INFO] 512914 rows
[INFO] ** appi_name:[21:99.99805%,30:0.00078%,31:0.00058%,0:0.00039%,22:0.00019%]
[INFO] ** classification:[normal:64.36498%,Single Stage Single Point:35.63502%]
[INFO] ** dst:[21:43.32052%,10:21.04134%,8:18.1703%,9:17.46453%,22:0.00097%,15:0.00078%,18:0.00058%,25:0.00039%,24:0.00039%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name:[2:99.99922%,3:0.00078%]
[INFO] ** modbus_function_code:[0.02961:99.99805%,-33.760870000000004:0.00195%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99786%,0:0.00195%]
[INFO] ** modbus_transaction_id:65536 (12.77719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99805%,2:0.00117%,1:0.00078%]
[INFO] ** proxy_src_ip:[18:38.41034%,20:25.95191%,13:18.17049%,6:17.46511%,17:0.00078%,7:0.00039%,16:0.00019%,5:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95133%,-0.32151:21.04134%,-1.27613:18.16991%,-0.23351:17.46433%,-0.33484:17.36899%,-71.33197:0.00078%,-0.24151:0.00058%,-64.19493:0.00039%,-0.08551:0.00039%,-1.27347:0.00039%,1.46509:0.00019%,1.47576:0.00019%,-0.24950999999999998:0.00019%,1.45709:0.00019%,4.42897:0.00019%,-71.14931:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95094%,1:21.04134%,5:18.16991%,4:17.46394%,2:17.3688%,0:0.00507%]
[INFO] ** service:[0.0048200000000000005:99.99805%,-211.73542999999998:0.00078%,-186.43601999999998:0.00058%,-186.44547:0.00039%,-211.08818:0.00019%]
[INFO] ** src:[22:38.41034%,9:25.95191%,7:18.17049%,1:17.46511%,14:0.00078%,21:0.00039%,17:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1391 (0.2712%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.2025e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79119.0000 - fp: 881.0000 - tn: 319119.0000 - fn: 881.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79063.0000 - fp: 937.0000 - tn: 319063.0000 - fn: 937.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79141.0000 - fp: 859.0000 - tn: 319141.0000 - fn: 859.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/512914
[33m[INFO] loading file 45-45/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (512914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (512914, 17)

[INFO] analyzing data
[INFO] 512914 rows
[INFO] ** appi_name:[21:99.99903%,30:0.00058%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.42074%,Single Stage Single Point:35.57926%]
[INFO] ** dst:[21:43.32481%,10:21.09359%,8:18.11746%,9:17.46199%,22:0.00117%,15:0.00058%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99942%,3:0.00058%]
[INFO] ** modbus_function_code:[0.02961:99.99903%,-33.760870000000004:0.00097%]
[INFO] ** modbus_function_description:[7:50.00039%,11:49.99864%,0:0.00097%]
[INFO] ** modbus_transaction_id:65536 (12.77719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99922%,1:0.00058%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.48715%,20:25.93183%,13:18.11727%,6:17.46238%,17:0.00058%,16:0.00039%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.93125%,-0.32151:21.09359%,-1.27613:18.11727%,-0.23351:17.46199%,-0.33484:17.39356%,1.45709:0.00058%,-71.33197:0.00058%,-1.02014:0.00039%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,14.4699:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.93086%,1:21.0934%,5:18.11727%,4:17.46199%,2:17.39336%,0:0.00312%]
[INFO] ** service:[0.0048200000000000005:99.99903%,-211.73542999999998:0.00058%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.48715%,9:25.93183%,7:18.11727%,1:17.46238%,14:0.00058%,15:0.00039%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1392 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79139.0000 - fp: 861.0000 - tn: 319139.0000 - fn: 861.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/512914
[33m[INFO] loading file 46-46/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (512914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (512914, 17)

[INFO] analyzing data
[INFO] 512914 rows
[INFO] ** appi_name:[21:99.99825%,30:0.00097%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.42756%,Single Stage Single Point:35.57244%]
[INFO] ** dst:[21:43.3521%,10:21.07293%,8:18.10342%,9:17.46901%,22:0.00097%,15:0.00097%,25:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99903%,0:0.00097%]
[INFO] ** i/f_name:[2:99.99903%,3:0.00097%]
[INFO] ** modbus_function_code:[0.02961:99.99825%,-33.760870000000004:0.00175%]
[INFO] ** modbus_function_description:[11:49.99922%,7:49.99903%,0:0.00175%]
[INFO] ** modbus_transaction_id:65536 (12.77719%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.99864%,1:0.00097%,2:0.00039%]
[INFO] ** proxy_src_ip:[18:38.44933%,20:25.9755%,13:18.10342%,6:17.4696%,17:0.00097%,16:0.00039%,7:0.00039%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97531%,-0.32151:21.07273%,-1.27613:18.10323%,-0.23351:17.46882%,-0.33484:17.3766%,-71.33197:0.00097%,-0.24151:0.00058%,-1.02014:0.00039%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,10.192739999999999:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.97492%,1:21.07254%,5:18.10303%,4:17.46843%,2:17.3766%,0:0.00448%]
[INFO] ** service:[0.0048200000000000005:99.99844%,-211.73542999999998:0.00097%,-186.44547:0.00019%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.44933%,9:25.9755%,7:18.10342%,1:17.4696%,14:0.00097%,21:0.00039%,15:0.00039%,16:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99922%,1:0.00078%]
[INFO] ** unixtime:1395 (0.27198%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79128.0000 - fp: 872.0000 - tn: 319128.0000 - fn: 872.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79085.0000 - fp: 915.0000 - tn: 319085.0000 - fn: 915.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79052.0000 - fp: 948.0000 - tn: 319052.0000 - fn: 948.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/512914
[33m[INFO] loading file 47-47/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (512914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (512914, 17)

[INFO] analyzing data
[INFO] 512914 rows
[INFO] ** appi_name:[21:99.99981%,33:0.00019%]
[INFO] ** classification:[normal:64.3913%,Single Stage Single Point:35.6087%]
[INFO] ** dst:[21:43.30219%,10:21.08736%,8:18.12643%,9:17.48188%,22:0.00175%,24:0.00039%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99981%,-33.760870000000004:0.00019%]
[INFO] ** modbus_function_description:[7:50.00136%,11:49.99844%,0:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.77719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.45771%,20:25.93261%,13:18.12682%,6:17.48227%,16:0.00039%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.93164%,-0.32151:21.08736%,-1.27613:18.12624%,-0.23351:17.48168%,-0.33484:17.37036%,1.45709:0.00058%,-0.24151:0.00058%,-1.27347:0.00039%,-1.02014:0.00039%,-61.95635:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.93105%,1:21.08716%,5:18.12604%,4:17.48149%,2:17.37016%,0:0.00409%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.45771%,9:25.93261%,7:18.12682%,1:17.48227%,15:0.00039%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1392 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79150.0000 - fp: 850.0000 - tn: 319150.0000 - fn: 850.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79060.0000 - fp: 940.0000 - tn: 319060.0000 - fn: 940.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0214 - tp: 79066.0000 - fp: 934.0000 - tn: 319066.0000 - fn: 934.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/512914
[33m[INFO] loading file 48-48/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (512914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (512914, 17)

[INFO] analyzing data
[INFO] 512914 rows
[INFO] ** appi_name:[21:99.99669%,30:0.00273%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.41801%,Single Stage Single Point:35.58199%]
[INFO] ** dst:[21:43.33222%,10:21.0819%,8:18.11103%,9:17.47057%,15:0.00273%,22:0.00078%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99766%,0:0.00234%]
[INFO] ** i/f_name:[2:99.99727%,3:0.00273%]
[INFO] ** modbus_function_code:[0.02961:99.99669%,-33.760870000000004:0.00331%]
[INFO] ** modbus_function_description:[7:49.99903%,11:49.99766%,0:0.00331%]
[INFO] ** modbus_transaction_id:65536 (12.77719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99669%,1:0.00273%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.45381%,20:25.96049%,13:18.11142%,6:17.47057%,17:0.00273%,14:0.00058%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.9601%,-0.32151:21.0819%,-1.27613:18.11103%,-0.23351:17.47038%,-0.33484:17.37192%,-71.33197:0.00273%,-1.02014:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,1.45709:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,13.431270000000001:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95971%,1:21.0819%,5:18.11103%,4:17.47038%,2:17.37172%,0:0.00526%]
[INFO] ** service:[0.0048200000000000005:99.99669%,-211.73542999999998:0.00273%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.45381%,9:25.96049%,7:18.11142%,1:17.47057%,14:0.00273%,2:0.00058%,15:0.00039%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1392 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79132.0000 - fp: 868.0000 - tn: 319132.0000 - fn: 868.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79055.0000 - fp: 945.0000 - tn: 319055.0000 - fn: 945.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79130.0000 - fp: 870.0000 - tn: 319130.0000 - fn: 870.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/512914
[33m[INFO] loading file 49-49/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (512914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (512914, 17)

[INFO] analyzing data
[INFO] 512914 rows
[INFO] ** appi_name:[21:99.99727%,30:0.00097%,17:0.00078%,22:0.00039%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.36401%,Single Stage Single Point:35.63599%]
[INFO] ** dst:[21:43.2979%,10:21.06162%,8:18.14534%,9:17.49085%,22:0.00136%,15:0.00097%,16:0.00078%,6:0.00058%,17:0.00039%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99903%,0:0.00097%]
[INFO] ** i/f_name:[2:99.99903%,3:0.00097%]
[INFO] ** modbus_function_code:[0.02961:99.99727%,-33.760870000000004:0.00273%]
[INFO] ** modbus_function_description:[7:49.99942%,11:49.99786%,0:0.00273%]
[INFO] ** modbus_transaction_id:65536 (12.77719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99844%,1:0.00097%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.41814%,20:25.94217%,13:18.14515%,6:17.49143%,17:0.00097%,1:0.00078%,21:0.00039%,16:0.00039%,14:0.00039%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.94139%,-0.32151:21.06162%,-1.27613:18.14495%,-0.23351:17.49065%,-0.33484:17.35652%,-71.33197:0.00097%,-0.24151:0.00058%,1.45709:0.00039%,-1.02014:0.00039%,-71.14931:0.00039%,-71.14798:0.00019%,-58.035180000000004:0.00019%,-5.1466400000000005:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,-5.08665:0.00019%,-0.24950999999999998:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.941%,1:21.06143%,5:18.14476%,4:17.49026%,2:17.35652%,0:0.00604%]
[INFO] ** service:[0.0048200000000000005:99.99727%,-211.73542999999998:0.00097%,-205.44247:0.00078%,-211.08818:0.00039%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.41814%,9:25.94217%,7:18.14515%,1:17.49143%,14:0.00097%,3:0.00078%,15:0.00039%,4:0.00039%,2:0.00039%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1393 (0.27159%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.7106e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/512914
[33m[INFO] loading file 50-50/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (362896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (362896, 17)

[INFO] analyzing data
[INFO] 362896 rows
[INFO] ** appi_name:[21:99.99752%,30:0.00083%,7:0.00083%,31:0.00028%,22:0.00028%,8:0.00028%]
[INFO] ** classification:[normal:64.2917%,Single Stage Single Point:35.7083%]
[INFO] ** dst:[21:43.24793%,10:21.04074%,8:18.22836%,9:17.47966%,15:0.00083%,22:0.00055%,16:0.00055%,2:0.00055%,24:0.00028%,18:0.00028%,6:0.00028%]
[INFO] ** i/f_dir:[1:99.99917%,0:0.00083%]
[INFO] ** i/f_name:[2:99.99917%,3:0.00083%]
[INFO] ** modbus_function_code:[0.02961:99.99752%,-33.760870000000004:0.00248%]
[INFO] ** modbus_function_description:[7:49.9989%,11:49.99862%,0:0.00248%]
[INFO] ** modbus_transaction_id:65535 (18.05889%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99862%,1:0.00083%,2:0.00055%]
[INFO] ** proxy_src_ip:[18:38.36113%,20:25.92781%,13:18.22864%,6:17.47966%,17:0.00083%,1:0.00083%,21:0.00028%,16:0.00028%,14:0.00028%,7:0.00028%]
[INFO] ** s_port:[1.45442:25.92726%,-0.32151:21.04074%,-1.27613:18.22809%,-0.23351:17.47966%,-0.33484:17.32039%,-71.33197:0.00083%,-3.3787199999999995:0.00028%,4.33564:0.00028%,15.912510000000001:0.00028%,7.9608300000000005:0.00028%,1.46509:0.00028%,1.45709:0.00028%,-1.27347:0.00028%,-71.14931:0.00028%,-1.02014:0.00028%,-1.2708:0.00028%,0.31847:0.00028%]
[INFO] ** scada_tag:[3:25.92699%,1:21.04046%,5:18.22781%,4:17.47966%,2:17.32011%,0:0.00496%]
[INFO] ** service:[0.0048200000000000005:99.99752%,-211.09762999999998:0.00083%,-211.73542999999998:0.00083%,-186.43601999999998:0.00028%,-211.35747999999998:0.00028%,-211.08818:0.00028%]
[INFO] ** src:[22:38.36113%,9:25.92781%,7:18.22864%,1:17.47966%,14:0.00083%,3:0.00083%,21:0.00028%,15:0.00028%,4:0.00028%,2:0.00028%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:986 (0.2717%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/362896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/362896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79074.0000 - fp: 926.0000 - tn: 319074.0000 - fn: 926.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/362896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79109.0000 - fp: 891.0000 - tn: 319109.0000 - fn: 891.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/362896
[33m[INFO] epoch 9/10[0m
[33m[INFO] loading file 1-1/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.9936%,30:0.00107%,22:0.00089%,17:0.00071%,31:0.00053%,26:0.00053%,7:0.00053%,23:0.00036%,18:0.00036%,0:0.00036%,28:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:77.62002%,Single Stage Single Point:22.37998%]
[INFO] ** dst:[21:43.26785%,10:21.03728%,8:18.16854%,9:17.5194%,6:0.00142%,22:0.00107%,16:0.00107%,15:0.00107%,18:0.00053%,26:0.00036%,25:0.00036%,19:0.00036%,17:0.00036%,24:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99893%,0:0.00107%]
[INFO] ** i/f_name:[2:99.99893%,3:0.00107%]
[INFO] ** modbus_function_code:[0.02961:99.9936%,-33.760870000000004:0.00622%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99769%,11:49.99591%,0:0.00622%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99645%,2:0.00249%,1:0.00107%]
[INFO] ** proxy_src_ip:[18:38.39875%,20:25.90603%,13:18.16872%,6:17.51975%,11:0.00124%,10:0.00124%,17:0.00107%,14:0.00089%,1:0.00089%,7:0.00053%,21:0.00036%,16:0.00036%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.9055%,-0.32151:21.03657%,-1.27613:18.16837%,-0.23351:17.51922%,-0.33484:17.36218%,-71.33197:0.00107%,-71.14931:0.00089%,-2.1481:0.00071%,-0.24151:0.00053%,-71.14798:0.00053%,-1.02014:0.00036%,-64.19493:0.00036%,-2.42942:0.00036%,4.44364:0.00036%,-43.76509:0.00018%,10.67005:0.00018%,4.29964:0.00018%,-5.08665:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,1.47576:0.00018%,1.46509:0.00018%,4.076980000000001:0.00018%,-58.032509999999995:0.00018%,-58.035180000000004:0.00018%,-1.2708:0.00018%,-1.27347:0.00018%,-5.1466400000000005:0.00018%,-68.79874000000001:0.00018%,14.253910000000001:0.00018%,1.45709:0.00018%]
[INFO] ** scada_tag:[3:25.90532%,1:21.03639%,5:18.16801%,4:17.51904%,2:17.362%,0:0.00924%]
[INFO] ** service:[0.0048200000000000005:99.99432%,-211.73542999999998:0.00107%,-211.08818:0.00089%,-205.44247:0.00071%,-211.07873999999998:0.00071%,-211.09762999999998:0.00053%,-211.08346:0.00053%,-186.43601999999998:0.00053%,-186.44547:0.00036%,-185.9872:0.00018%,-202.75898:0.00018%]
[INFO] ** src:[22:38.39875%,9:25.90603%,7:18.16872%,1:17.51975%,11:0.00124%,10:0.00124%,14:0.00107%,3:0.00089%,2:0.00089%,21:0.00053%,15:0.00036%,4:0.00036%,8:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1528 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1540 - tp: 77779.0000 - fp: 2221.0000 - tn: 317779.0000 - fn: 2221.0000 - accuracy: 0.9889 - precision: 0.9722 - recall: 0.9722 - auc: 0.9948 - val_loss: 0.0010 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0116 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4164e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0076 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5586e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2351 - tp: 62304.0000 - fp: 17696.0000 - tn: 302304.0000 - fn: 17696.0000 - accuracy: 0.9115 - precision: 0.7788 - recall: 0.7788 - auc: 0.9299 - val_loss: 0.6409 - val_tp: 10620.0000 - val_fp: 9380.0000 - val_tn: 70620.0000 - val_fn: 9380.0000 - val_accuracy: 0.8124 - val_precision: 0.5310 - val_recall: 0.5310 - val_auc: 0.9306
[INFO] saving weights to checkpoints/lstm-epoch-9-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4752 - tp: 56880.0000 - fp: 23120.0000 - tn: 296880.0000 - fn: 23120.0000 - accuracy: 0.8844 - precision: 0.7110 - recall: 0.7110 - auc: 0.9520 - val_loss: 0.3936 - val_tp: 16510.0000 - val_fp: 3490.0000 - val_tn: 76510.0000 - val_fn: 3490.0000 - val_accuracy: 0.9302 - val_precision: 0.8255 - val_recall: 0.8255 - val_auc: 0.9782
[INFO] saving weights to checkpoints/lstm-epoch-9-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 2-2/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99858%,30:0.00053%,7:0.00053%,31:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:70.58124%,Single Stage Single Point:29.41876%]
[INFO] ** dst:[21:43.3112%,10:21.02982%,8:18.14154%,9:17.51496%,22:0.00089%,15:0.00053%,16:0.00036%,2:0.00036%,24:0.00018%,18:0.00018%]
[INFO] ** i/f_dir:[1:99.99947%,0:0.00053%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99858%,-33.760870000000004:0.00142%]
[INFO] ** modbus_function_description:[7:49.99982%,11:49.99876%,0:0.00142%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99929%,1:0.00053%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.37974%,20:25.96181%,13:18.14154%,6:17.51531%,17:0.00053%,1:0.00053%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.9611%,-0.32151:21.02982%,-1.27613:18.14118%,-0.23351:17.51478%,-0.33484:17.34992%,-71.33197:0.00053%,-0.24151:0.00036%,1.45709:0.00036%,1.46509:0.00018%,1.47576:0.00018%,12.60597:0.00018%,10.67005:0.00018%,-0.24950999999999998:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,4.076980000000001:0.00018%,-3.3787199999999995:0.00018%,4.29964:0.00018%,-1.27347:0.00018%]
[INFO] ** scada_tag:[3:25.96075%,1:21.02982%,5:18.14118%,4:17.51443%,2:17.34974%,0:0.00409%]
[INFO] ** service:[0.0048200000000000005:99.99858%,-211.09762999999998:0.00053%,-211.73542999999998:0.00053%,-211.35747999999998:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.37974%,9:25.96181%,7:18.14154%,1:17.51531%,14:0.00053%,3:0.00053%,21:0.00018%,15:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1531 (0.27199%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3919 - tp: 66469.0000 - fp: 13531.0000 - tn: 306469.0000 - fn: 13531.0000 - accuracy: 0.9323 - precision: 0.8309 - recall: 0.8309 - auc: 0.9772 - val_loss: 0.3348 - val_tp: 18054.0000 - val_fp: 1946.0000 - val_tn: 78054.0000 - val_fn: 1946.0000 - val_accuracy: 0.9611 - val_precision: 0.9027 - val_recall: 0.9027 - val_auc: 0.9853
[INFO] saving weights to checkpoints/lstm-epoch-9-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3164 - tp: 71077.0000 - fp: 8923.0000 - tn: 311077.0000 - fn: 8923.0000 - accuracy: 0.9554 - precision: 0.8885 - recall: 0.8885 - auc: 0.9851 - val_loss: 0.4882 - val_tp: 13375.0000 - val_fp: 6625.0000 - val_tn: 73375.0000 - val_fn: 6625.0000 - val_accuracy: 0.8675 - val_precision: 0.6687 - val_recall: 0.6687 - val_auc: 0.9564
[INFO] saving weights to checkpoints/lstm-epoch-9-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1169 - tp: 73160.0000 - fp: 6840.0000 - tn: 313160.0000 - fn: 6840.0000 - accuracy: 0.9658 - precision: 0.9145 - recall: 0.9145 - auc: 0.9974 - val_loss: 0.0125 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7732 - tp: 53562.0000 - fp: 26438.0000 - tn: 293562.0000 - fn: 26438.0000 - accuracy: 0.8678 - precision: 0.6695 - recall: 0.6695 - auc: 0.9343 - val_loss: 0.4334 - val_tp: 14342.0000 - val_fp: 5658.0000 - val_tn: 74342.0000 - val_fn: 5658.0000 - val_accuracy: 0.8868 - val_precision: 0.7171 - val_recall: 0.7171 - val_auc: 0.9602
[INFO] saving weights to checkpoints/lstm-epoch-9-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4049 - tp: 64173.0000 - fp: 15827.0000 - tn: 304173.0000 - fn: 15827.0000 - accuracy: 0.9209 - precision: 0.8022 - recall: 0.8022 - auc: 0.9693 - val_loss: 0.5719 - val_tp: 11746.0000 - val_fp: 8254.0000 - val_tn: 71746.0000 - val_fn: 8254.0000 - val_accuracy: 0.8349 - val_precision: 0.5873 - val_recall: 0.5873 - val_auc: 0.9365
[INFO] saving weights to checkpoints/lstm-epoch-9-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 3-3/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99183%,30:0.00213%,22:0.00107%,31:0.00089%,26:0.00089%,17:0.00089%,7:0.00071%,27:0.00036%,0:0.00036%,28:0.00018%,23:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:88.1964%,Single Stage Single Point:11.8036%]
[INFO] ** dst:[21:43.31102%,10:21.0808%,8:18.15451%,9:17.44461%,6:0.00213%,15:0.00142%,18:0.00124%,16:0.00124%,22:0.00089%,2:0.00036%,7:0.00036%,25:0.00036%,17:0.00036%,12:0.00018%,24:0.00018%,19:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99858%,0:0.00142%]
[INFO] ** i/f_name:[2:99.99858%,3:0.00142%]
[INFO] ** modbus_function_code:[0.02961:99.99183%,-33.760870000000004:0.00799%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99662%,11:49.9952%,0:0.00799%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99893%,2:0.00107%]
[INFO] ** proto:[0:99.99432%,2:0.00426%,1:0.00142%]
[INFO] ** proxy_src_ip:[18:38.40514%,20:25.98704%,13:18.15469%,6:17.44496%,17:0.00213%,1:0.00142%,14:0.00124%,7:0.00089%,11:0.00071%,10:0.00071%,21:0.00053%,16:0.00018%,15:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98633%,-0.32151:21.08063%,-1.27613:18.15415%,-0.23351:17.44443%,-0.33484:17.32451%,-71.33197:0.00142%,-71.14931:0.00107%,-71.14798:0.00107%,-64.19493:0.00036%,-0.08551:0.00036%,1.45709:0.00036%,-0.24151:0.00036%,14.4699:0.00018%,4.29964:0.00018%,4.90362:0.00018%,10.192739999999999:0.00018%,-3.3787199999999995:0.00018%,13.86459:0.00018%,4.44364:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,-43.76509:0.00018%,-5.08665:0.00018%,-58.035180000000004:0.00018%,4.076980000000001:0.00018%,-58.032509999999995:0.00018%,-1.27347:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-5.1466400000000005:0.00018%,13.431270000000001:0.00018%,12.60597:0.00018%,1.47576:0.00018%,1.46509:0.00018%,14.253910000000001:0.00018%,-68.79874000000001:0.00018%,-0.24950999999999998:0.00018%,-2.1481:0.00018%,10.67005:0.00018%,-68.36943000000001:0.00018%]
[INFO] ** scada_tag:[3:25.98597%,1:21.08045%,5:18.15398%,4:17.44425%,2:17.32434%,0:0.01101%]
[INFO] ** service:[0.0048200000000000005:99.99201%,-211.73542999999998:0.00142%,-186.43601999999998:0.00124%,-211.08346:0.00107%,-211.08818:0.00107%,-205.44247:0.00089%,-211.09762999999998:0.00071%,-202.75898:0.00036%,-186.44547:0.00036%,-183.8612:0.00018%,-185.9872:0.00018%,-201.23771000000002:0.00018%,-211.35747999999998:0.00018%,-211.07873999999998:0.00018%]
[INFO] ** src:[22:38.40514%,9:25.98704%,7:18.15469%,1:17.44496%,21:0.00195%,3:0.0016%,2:0.00124%,11:0.00071%,10:0.00071%,4:0.00071%,14:0.00036%,8:0.00036%,17:0.00018%,15:0.00018%,13:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1529 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3087 - tp: 64002.0000 - fp: 15998.0000 - tn: 304002.0000 - fn: 15998.0000 - accuracy: 0.9200 - precision: 0.8000 - recall: 0.8000 - auc: 0.9816 - val_loss: 0.6502 - val_tp: 10979.0000 - val_fp: 9021.0000 - val_tn: 70979.0000 - val_fn: 9021.0000 - val_accuracy: 0.8196 - val_precision: 0.5490 - val_recall: 0.5490 - val_auc: 0.9267
[INFO] saving weights to checkpoints/lstm-epoch-9-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4274 - tp: 62256.0000 - fp: 17744.0000 - tn: 302256.0000 - fn: 17744.0000 - accuracy: 0.9113 - precision: 0.7782 - recall: 0.7782 - auc: 0.9650 - val_loss: 0.3753 - val_tp: 16531.0000 - val_fp: 3469.0000 - val_tn: 76531.0000 - val_fn: 3469.0000 - val_accuracy: 0.9306 - val_precision: 0.8266 - val_recall: 0.8266 - val_auc: 0.9802
[INFO] saving weights to checkpoints/lstm-epoch-9-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3866 - tp: 58909.0000 - fp: 21091.0000 - tn: 298909.0000 - fn: 21091.0000 - accuracy: 0.8945 - precision: 0.7364 - recall: 0.7364 - auc: 0.9706 - val_loss: 0.0795 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0434 - tp: 77942.0000 - fp: 2058.0000 - tn: 317942.0000 - fn: 2058.0000 - accuracy: 0.9897 - precision: 0.9743 - recall: 0.9743 - auc: 0.9998 - val_loss: 0.0032 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0260 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.4531e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 4-4/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99769%,30:0.00124%,31:0.00036%,33:0.00018%,26:0.00018%,23:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:92.22236%,Single Stage Single Point:7.77764%]
[INFO] ** dst:[21:43.35206%,10:20.94703%,8:18.17725%,9:17.52011%,22:0.00124%,15:0.00124%,18:0.00036%,24:0.00018%,19:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99893%,0:0.00107%]
[INFO] ** i/f_name:[2:99.99876%,3:0.00124%]
[INFO] ** modbus_function_code:[0.02961:99.99769%,-33.760870000000004:0.00231%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99805%,0:0.00231%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99893%,2:0.00107%]
[INFO] ** proto:[0:99.99822%,1:0.00124%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.26071%,20:26.03874%,13:18.17725%,6:17.52047%,17:0.00124%,16:0.00053%,21:0.00036%,14:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.03802%,-0.32151:20.94685%,-1.27613:18.17689%,-0.23351:17.51993%,-0.33484:17.31386%,-71.33197:0.00124%,-1.02014:0.00053%,1.45709:0.00036%,-0.08551:0.00036%,-0.24151:0.00036%,-1.2708:0.00018%,14.4699:0.00018%,4.44364:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:26.03785%,1:20.94668%,5:18.17689%,4:17.51958%,2:17.31368%,0:0.00533%]
[INFO] ** service:[0.0048200000000000005:99.99787%,-211.73542999999998:0.00124%,-186.43601999999998:0.00036%,-183.8612:0.00018%,-211.08346:0.00018%,-211.07873999999998:0.00018%]
[INFO] ** src:[22:38.26071%,9:26.03874%,7:18.17725%,1:17.52047%,21:0.00107%,15:0.00053%,4:0.00036%,17:0.00018%,14:0.00018%,8:0.00018%,3:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1539 (0.27341%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0221 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5950e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5985e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0183 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.5809e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0166 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8669e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3349 - tp: 48707.0000 - fp: 31293.0000 - tn: 288707.0000 - fn: 31293.0000 - accuracy: 0.8435 - precision: 0.6088 - recall: 0.6088 - auc: 0.8860 - val_loss: 0.7568 - val_tp: 7832.0000 - val_fp: 12168.0000 - val_tn: 67832.0000 - val_fn: 12168.0000 - val_accuracy: 0.7566 - val_precision: 0.3916 - val_recall: 0.3916 - val_auc: 0.8617
[INFO] saving weights to checkpoints/lstm-epoch-9-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 5-5/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99645%,30:0.00249%,37:0.00018%,26:0.00018%,12:0.00018%,9:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:89.89796%,Single Stage Single Point:10.10204%]
[INFO] ** dst:[21:43.36343%,10:20.76689%,8:18.23996%,9:17.62546%,15:0.00249%,22:0.00089%,25:0.00018%,24:0.00018%,6:0.00018%,2:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99787%,0:0.00213%]
[INFO] ** i/f_name:[2:99.99751%,3:0.00249%]
[INFO] ** modbus_function_code:[0.02961:99.99645%,-33.760870000000004:0.00355%]
[INFO] ** modbus_function_description:[7:49.99893%,11:49.99751%,0:0.00355%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99805%,2:0.00195%]
[INFO] ** proto:[0:99.99716%,1:0.00249%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.00382%,20:26.12685%,13:18.23996%,6:17.62564%,17:0.00249%,1:0.00036%,21:0.00018%,16:0.00018%,7:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.12614%,-0.32151:20.76654%,-1.27613:18.23978%,-0.23351:17.62528%,-0.33484:17.23729%,-71.33197:0.00249%,-0.24151:0.00036%,1.45709:0.00036%,1.47576:0.00018%,1.46509:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,2.22906:0.00018%,14.4699:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.12579%,1:20.76636%,5:18.2396%,4:17.62528%,2:17.23729%,0:0.00568%]
[INFO] ** service:[0.0048200000000000005:99.9968%,-211.73542999999998:0.00249%,-183.8612:0.00018%,-211.08346:0.00018%,-211.35747999999998:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.00382%,9:26.12685%,7:18.23996%,1:17.62564%,21:0.00213%,14:0.00053%,3:0.00036%,16:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1540 (0.27359%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1781 - tp: 79459.0000 - fp: 541.0000 - tn: 319459.0000 - fn: 541.0000 - accuracy: 0.9973 - precision: 0.9932 - recall: 0.9932 - auc: 0.9977 - val_loss: 0.5201 - val_tp: 17868.0000 - val_fp: 2132.0000 - val_tn: 77868.0000 - val_fn: 2132.0000 - val_accuracy: 0.9574 - val_precision: 0.8934 - val_recall: 0.8934 - val_auc: 0.9581
[INFO] saving weights to checkpoints/lstm-epoch-9-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3491 - tp: 60582.0000 - fp: 19418.0000 - tn: 300582.0000 - fn: 19418.0000 - accuracy: 0.9029 - precision: 0.7573 - recall: 0.7573 - auc: 0.9761 - val_loss: 0.1007 - val_tp: 18449.0000 - val_fp: 1551.0000 - val_tn: 78449.0000 - val_fn: 1551.0000 - val_accuracy: 0.9690 - val_precision: 0.9225 - val_recall: 0.9225 - val_auc: 0.9985
[INFO] saving weights to checkpoints/lstm-epoch-9-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2754 - tp: 66583.0000 - fp: 13417.0000 - tn: 306583.0000 - fn: 13417.0000 - accuracy: 0.9329 - precision: 0.8323 - recall: 0.8323 - auc: 0.9853 - val_loss: 0.3101 - val_tp: 13837.0000 - val_fp: 6163.0000 - val_tn: 73837.0000 - val_fn: 6163.0000 - val_accuracy: 0.8767 - val_precision: 0.6919 - val_recall: 0.6919 - val_auc: 0.9694
[INFO] saving weights to checkpoints/lstm-epoch-9-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2148 - tp: 76334.0000 - fp: 3666.0000 - tn: 316334.0000 - fn: 3666.0000 - accuracy: 0.9817 - precision: 0.9542 - recall: 0.9542 - auc: 0.9975 - val_loss: 0.1422 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1113 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0500 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 6-6/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99591%,30:0.0032%,31:0.00018%,27:0.00018%,26:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:92.82194%,Single Stage Single Point:7.17806%]
[INFO] ** dst:[21:43.37764%,10:20.73154%,8:18.27602%,9:17.61%,15:0.0032%,22:0.00053%,25:0.00018%,24:0.00018%,18:0.00018%,12:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99698%,0:0.00302%]
[INFO] ** i/f_name:[2:99.9968%,3:0.0032%]
[INFO] ** modbus_function_code:[0.02961:99.99591%,-33.760870000000004:0.00409%]
[INFO] ** modbus_function_description:[7:49.99858%,11:49.99734%,0:0.00409%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99964%,1:0.00036%]
[INFO] ** proto:[0:99.99591%,1:0.0032%,2:0.00089%]
[INFO] ** proxy_src_ip:[18:37.94253%,20:26.16682%,13:18.2762%,6:17.61018%,17:0.0032%,14:0.00053%,16:0.00036%,11:0.00018%]
[INFO] ** s_port:[1.45442:26.16647%,-0.32151:20.73154%,-1.27613:18.27567%,-0.23351:17.60982%,-0.33484:17.21099%,-71.33197:0.0032%,-1.02014:0.00036%,-71.14798:0.00018%,-64.19493:0.00018%,4.90362:0.00018%,-1.2708:0.00018%,-0.24151:0.00018%,13.431270000000001:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-68.36943000000001:0.00018%]
[INFO] ** scada_tag:[3:26.16629%,1:20.73118%,5:18.27549%,4:17.60947%,2:17.21082%,0:0.00675%]
[INFO] ** service:[0.0048200000000000005:99.99591%,-211.73542999999998:0.0032%,-211.08346:0.00018%,-201.23771000000002:0.00018%,-202.75898:0.00018%,-186.44547:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:37.94253%,9:26.16682%,7:18.2762%,1:17.61018%,14:0.0032%,2:0.00053%,15:0.00036%,10:0.00018%]
[INFO] ** type:[0:99.99911%,1:0.00089%]
[INFO] ** unixtime:1541 (0.27376%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0229 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.4639e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0088 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0211e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0086 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7354e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0078 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0501e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3388 - tp: 69486.0000 - fp: 10514.0000 - tn: 309486.0000 - fn: 10514.0000 - accuracy: 0.9474 - precision: 0.8686 - recall: 0.8686 - auc: 0.9835 - val_loss: 0.4906 - val_tp: 12752.0000 - val_fp: 7248.0000 - val_tn: 72752.0000 - val_fn: 7248.0000 - val_accuracy: 0.8550 - val_precision: 0.6376 - val_recall: 0.6376 - val_auc: 0.9672
[INFO] saving weights to checkpoints/lstm-epoch-9-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 7-7/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99538%,30:0.0016%,22:0.00089%,17:0.00071%,26:0.00053%,31:0.00036%,28:0.00018%,27:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:80.62484%,Single Stage Single Point:19.37516%]
[INFO] ** dst:[21:43.35934%,10:20.74397%,8:18.25168%,9:17.6386%,15:0.0016%,22:0.00142%,6:0.00142%,16:0.00071%,24:0.00036%,18:0.00036%,17:0.00036%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.9984%,0:0.0016%]
[INFO] ** i/f_name:[2:99.9984%,3:0.0016%]
[INFO] ** modbus_function_code:[0.02961:99.99538%,-33.760870000000004:0.00462%]
[INFO] ** modbus_function_description:[7:49.9984%,11:49.99698%,0:0.00462%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99645%,2:0.00195%,1:0.0016%]
[INFO] ** proxy_src_ip:[18:37.96758%,20:26.13644%,13:18.25204%,6:17.63878%,17:0.0016%,11:0.00071%,1:0.00071%,21:0.00053%,16:0.00053%,14:0.00036%,7:0.00036%,10:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13556%,-0.32151:20.74397%,-1.27613:18.25151%,-0.23351:17.63843%,-0.33484:17.22361%,-71.33197:0.0016%,-71.14931:0.00089%,-1.02014:0.00053%,-71.14798:0.00053%,1.45709:0.00053%,-0.24151:0.00036%,-1.27347:0.00036%,1.47576:0.00018%,1.46509:0.00018%,14.253910000000001:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,-68.79874000000001:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,6.1115699999999995:0.00018%,-5.08665:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:26.1352%,1:20.74397%,5:18.25133%,4:17.63825%,2:17.22361%,0:0.00764%]
[INFO] ** service:[0.0048200000000000005:99.99538%,-211.73542999999998:0.0016%,-211.08818:0.00089%,-205.44247:0.00071%,-211.08346:0.00053%,-186.43601999999998:0.00036%,-211.09762999999998:0.00018%,-185.9872:0.00018%,-202.75898:0.00018%]
[INFO] ** src:[22:37.96758%,9:26.13644%,7:18.25204%,1:17.63878%,14:0.0016%,10:0.00071%,3:0.00071%,15:0.00053%,4:0.00053%,21:0.00036%,2:0.00036%,11:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1538 (0.27323%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1199 - tp: 73105.0000 - fp: 6895.0000 - tn: 313105.0000 - fn: 6895.0000 - accuracy: 0.9655 - precision: 0.9138 - recall: 0.9138 - auc: 0.9971 - val_loss: 2.4974e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0264 - tp: 79002.0000 - fp: 998.0000 - tn: 319002.0000 - fn: 998.0000 - accuracy: 0.9950 - precision: 0.9875 - recall: 0.9875 - auc: 0.9999 - val_loss: 5.9464e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0230 - tp: 79079.0000 - fp: 921.0000 - tn: 319079.0000 - fn: 921.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 7.5936e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4333 - tp: 76452.0000 - fp: 3548.0000 - tn: 316452.0000 - fn: 3548.0000 - accuracy: 0.9823 - precision: 0.9556 - recall: 0.9556 - auc: 0.9818 - val_loss: 0.0592 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0417 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0067 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 8-8/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99716%,30:0.00107%,0:0.00053%,24:0.00018%,23:0.00018%,22:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.92304%,Single Stage Single Point:5.07696%]
[INFO] ** dst:[21:43.42081%,10:20.79905%,8:18.19537%,9:17.58122%,22:0.00124%,15:0.00107%,25:0.00053%,19:0.00036%,26:0.00018%,24:0.00018%]
[INFO] ** i/f_dir:[1:99.99929%,0:0.00071%]
[INFO] ** i/f_name:[2:99.99893%,3:0.00107%]
[INFO] ** modbus_function_code:[0.02961:99.99716%,-33.760870000000004:0.00266%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99751%,0:0.00266%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99964%,2:0.00036%]
[INFO] ** proto:[0:99.99822%,1:0.00107%,2:0.00071%]
[INFO] ** proxy_src_ip:[18:38.08075%,20:26.13964%,13:18.19466%,6:17.58158%,17:0.00107%,10:0.00107%,16:0.00053%,14:0.00036%,11:0.00018%,5:0.00018%]
[INFO] ** s_port:[1.45442:26.13911%,-0.32151:20.79905%,-1.27613:18.19448%,-0.23351:17.58105%,-0.33484:17.2817%,-71.33197:0.00107%,-15.039579999999999:0.00071%,-1.02014:0.00053%,-64.19493:0.00053%,1.45709:0.00036%,-0.24151:0.00036%,4.66896:0.00036%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.13858%,1:20.79887%,5:18.19448%,4:17.58087%,2:17.28152%,0:0.00568%]
[INFO] ** service:[0.0048200000000000005:99.99787%,-211.73542999999998:0.00107%,-186.44547:0.00053%,-211.07873999999998:0.00036%,-211.08818:0.00018%]
[INFO] ** src:[22:38.08075%,9:26.13964%,7:18.19466%,1:17.58158%,11:0.00107%,14:0.00071%,15:0.00053%,21:0.00036%,2:0.00036%,16:0.00018%,10:0.00018%]
[INFO] ** type:[0:99.99947%,1:0.00036%,2:0.00018%]
[INFO] ** unixtime:1541 (0.27376%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0071 - tp: 79987.0000 - fp: 13.0000 - tn: 319987.0000 - fn: 13.0000 - accuracy: 0.9999 - precision: 0.9998 - recall: 0.9998 - auc: 1.0000 - val_loss: 5.9897e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0063 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3530e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0058 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8121e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0055 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1303e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4189 - tp: 66476.0000 - fp: 13524.0000 - tn: 306476.0000 - fn: 13524.0000 - accuracy: 0.9324 - precision: 0.8310 - recall: 0.8310 - auc: 0.9784 - val_loss: 0.2920 - val_tp: 16362.0000 - val_fp: 3638.0000 - val_tn: 76362.0000 - val_fn: 3638.0000 - val_accuracy: 0.9272 - val_precision: 0.8181 - val_recall: 0.8181 - val_auc: 0.9841
[INFO] saving weights to checkpoints/lstm-epoch-9-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 9-9/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99822%,30:0.00107%,31:0.00036%,26:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:94.51106%,Single Stage Single Point:5.48894%]
[INFO] ** dst:[21:43.3732%,10:20.77133%,8:18.28153%,9:17.5711%,15:0.00107%,22:0.00089%,18:0.00036%,25:0.00018%,24:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99893%,0:0.00107%]
[INFO] ** i/f_name:[2:99.99893%,3:0.00107%]
[INFO] ** modbus_function_code:[0.02961:99.99822%,-33.760870000000004:0.00178%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99822%,0:0.00178%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99964%,2:0.00036%]
[INFO] ** proto:[0:99.99822%,1:0.00107%,2:0.00071%]
[INFO] ** proxy_src_ip:[18:38.00755%,20:26.13751%,13:18.28153%,6:17.57145%,17:0.00107%,21:0.00018%,16:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.1368%,-0.32151:20.77133%,-1.27613:18.28117%,-0.23351:17.57092%,-0.33484:17.23622%,-71.33197:0.00107%,-0.24151:0.00036%,1.45709:0.00036%,-0.08551:0.00036%,1.46509:0.00018%,1.47576:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.13644%,1:20.77115%,5:18.28117%,4:17.57074%,2:17.23604%,0:0.00444%]
[INFO] ** service:[0.0048200000000000005:99.99822%,-211.73542999999998:0.00107%,-186.43601999999998:0.00036%,-211.08346:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.00755%,9:26.13751%,7:18.28153%,1:17.57145%,14:0.00071%,21:0.00036%,17:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1541 (0.27376%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2274 - tp: 66299.0000 - fp: 13701.0000 - tn: 306299.0000 - fn: 13701.0000 - accuracy: 0.9315 - precision: 0.8287 - recall: 0.8287 - auc: 0.9895 - val_loss: 0.2519 - val_tp: 16321.0000 - val_fp: 3679.0000 - val_tn: 76321.0000 - val_fn: 3679.0000 - val_accuracy: 0.9264 - val_precision: 0.8160 - val_recall: 0.8160 - val_auc: 0.9832
[INFO] saving weights to checkpoints/lstm-epoch-9-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2492 - tp: 67173.0000 - fp: 12827.0000 - tn: 307173.0000 - fn: 12827.0000 - accuracy: 0.9359 - precision: 0.8397 - recall: 0.8397 - auc: 0.9861 - val_loss: 0.1117 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0285 - tp: 79951.0000 - fp: 49.0000 - tn: 319951.0000 - fn: 49.0000 - accuracy: 0.9998 - precision: 0.9994 - recall: 0.9994 - auc: 1.0000 - val_loss: 2.3392e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0167 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.0387e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0142 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.1983e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 10-10/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99627%,30:0.00178%,31:0.00036%,26:0.00018%,24:0.00018%,23:0.00018%,22:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:94.57289%,Single Stage Single Point:5.42711%]
[INFO] ** dst:[21:43.41353%,10:20.80526%,8:18.22433%,9:17.55298%,15:0.00178%,22:0.00053%,24:0.00036%,19:0.00036%,18:0.00036%,26:0.00018%,25:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9984%,0:0.0016%]
[INFO] ** i/f_name:[2:99.99822%,3:0.00178%]
[INFO] ** modbus_function_code:[0.02961:99.99627%,-33.760870000000004:0.00355%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99876%,11:49.99751%,0:0.00355%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99929%,1:0.00071%]
[INFO] ** proto:[0:99.99734%,1:0.00178%,2:0.00089%]
[INFO] ** proxy_src_ip:[18:38.08217%,20:26.13715%,13:18.2245%,6:17.55227%,17:0.00178%,10:0.00089%,14:0.00036%,21:0.00018%,16:0.00018%,5:0.00018%,2:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13644%,-0.32151:20.80526%,-1.27613:18.22397%,-0.23351:17.55191%,-0.33484:17.2769%,-71.33197:0.00178%,-10.51843:0.00071%,-0.08551:0.00036%,-1.27347:0.00036%,5.71692:0.00036%,1.47576:0.00036%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-71.14931:0.00018%,-64.19493:0.00018%,1.45709:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.13609%,1:20.80509%,5:18.22397%,4:17.55173%,2:17.27673%,0:0.0064%]
[INFO] ** service:[0.0048200000000000005:99.99698%,-211.73542999999998:0.00178%,-211.07873999999998:0.00036%,-186.43601999999998:0.00036%,-211.08346:0.00018%,-186.44547:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.08217%,9:26.13715%,7:18.2245%,1:17.55227%,14:0.00178%,11:0.00089%,2:0.00036%,17:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%]
[INFO] ** type:[0:99.99858%,1:0.00124%,2:0.00018%]
[INFO] ** unixtime:1538 (0.27323%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0125 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9978e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0111 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1401e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4033 - tp: 66624.0000 - fp: 13376.0000 - tn: 306624.0000 - fn: 13376.0000 - accuracy: 0.9331 - precision: 0.8328 - recall: 0.8328 - auc: 0.9769 - val_loss: 0.3368 - val_tp: 12831.0000 - val_fp: 7169.0000 - val_tn: 72831.0000 - val_fn: 7169.0000 - val_accuracy: 0.8566 - val_precision: 0.6416 - val_recall: 0.6416 - val_auc: 0.9679
[INFO] saving weights to checkpoints/lstm-epoch-9-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2440 - tp: 69978.0000 - fp: 10022.0000 - tn: 309978.0000 - fn: 10022.0000 - accuracy: 0.9499 - precision: 0.8747 - recall: 0.8747 - auc: 0.9884 - val_loss: 0.1478 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0320 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7920e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 11-11/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99893%,31:0.00036%,30:0.00036%,26:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.39221%,10:20.87455%,8:18.19484%,9:17.5361%,22:0.00124%,18:0.00036%,15:0.00036%,25:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99964%,3:0.00036%]
[INFO] ** modbus_function_code:[0.02961:99.99893%,-33.760870000000004:0.00107%]
[INFO] ** modbus_function_description:[7:50.00071%,11:49.99822%,0:0.00107%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99893%,2:0.00071%,1:0.00036%]
[INFO] ** proxy_src_ip:[18:38.14843%,20:26.11868%,13:18.19484%,6:17.53645%,16:0.00053%,17:0.00036%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.11815%,-0.32151:20.87455%,-1.27613:18.19466%,-0.23351:17.53592%,-0.33484:17.27388%,-0.24151:0.00053%,-1.02014:0.00053%,-0.08551:0.00036%,-71.33197:0.00036%,-71.14798:0.00018%,1.45709:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:26.11779%,1:20.87437%,5:18.19448%,4:17.53557%,2:17.27371%,0:0.00409%]
[INFO] ** service:[0.0048200000000000005:99.99893%,-211.73542999999998:0.00036%,-186.43601999999998:0.00036%,-211.08346:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.14843%,9:26.11868%,7:18.19484%,1:17.53645%,15:0.00053%,14:0.00036%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1538 (0.27323%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0098 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5658e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0086 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9428e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0077 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6424e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0069 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9699e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0061 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9689e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 12-12/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99787%,30:0.00195%,9:0.00018%]
[INFO] ** classification:[normal:93.57057%,Single Stage Single Point:6.42943%]
[INFO] ** dst:[21:43.40447%,10:20.88254%,8:18.17654%,9:17.53343%,15:0.00195%,22:0.00053%,24:0.00036%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.9984%,0:0.0016%]
[INFO] ** i/f_name:[2:99.99805%,3:0.00195%]
[INFO] ** modbus_function_code:[0.02961:99.99787%,-33.760870000000004:0.00213%]
[INFO] ** modbus_function_description:[7:49.99982%,11:49.99805%,0:0.00213%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.9984%,2:0.0016%]
[INFO] ** proto:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip:[18:38.15536%,20:26.132%,13:18.17671%,6:17.53361%,17:0.00195%,16:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:26.13147%,-0.32151:20.88254%,-1.27613:18.17618%,-0.23351:17.53326%,-0.33484:17.27282%,-71.33197:0.00195%,-1.27347:0.00036%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:26.13111%,1:20.88254%,5:18.17618%,4:17.5329%,2:17.27282%,0:0.00444%]
[INFO] ** service:[0.0048200000000000005:99.99787%,-211.73542999999998:0.00195%,-183.8612:0.00018%]
[INFO] ** src:[22:38.15536%,9:26.132%,7:18.17671%,1:17.53361%,21:0.0016%,14:0.00036%,15:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1539 (0.27341%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0056 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2940e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0047 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4114e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3482 - tp: 70580.0000 - fp: 9420.0000 - tn: 310580.0000 - fn: 9420.0000 - accuracy: 0.9529 - precision: 0.8823 - recall: 0.8823 - auc: 0.9841 - val_loss: 0.4797 - val_tp: 12828.0000 - val_fp: 7172.0000 - val_tn: 72828.0000 - val_fn: 7172.0000 - val_accuracy: 0.8566 - val_precision: 0.6414 - val_recall: 0.6414 - val_auc: 0.9679
[INFO] saving weights to checkpoints/lstm-epoch-9-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2885 - tp: 63753.0000 - fp: 16247.0000 - tn: 303753.0000 - fn: 16247.0000 - accuracy: 0.9188 - precision: 0.7969 - recall: 0.7969 - auc: 0.9811 - val_loss: 0.3205 - val_tp: 12849.0000 - val_fp: 7151.0000 - val_tn: 72849.0000 - val_fn: 7151.0000 - val_accuracy: 0.8570 - val_precision: 0.6424 - val_recall: 0.6424 - val_auc: 0.9680
[INFO] saving weights to checkpoints/lstm-epoch-9-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1527 - tp: 78928.0000 - fp: 1072.0000 - tn: 318928.0000 - fn: 1072.0000 - accuracy: 0.9946 - precision: 0.9866 - recall: 0.9866 - auc: 0.9995 - val_loss: 0.0749 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 13-13/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99662%,31:0.00071%,26:0.00053%,0:0.00053%,30:0.00036%,22:0.00036%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:86.40726%,Single Stage Single Point:13.59274%]
[INFO] ** dst:[21:43.35881%,10:20.8058%,8:18.27442%,9:17.55706%,22:0.00107%,6:0.00089%,18:0.00071%,25:0.00053%,15:0.00036%,24:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99964%,3:0.00036%]
[INFO] ** modbus_function_code:[0.02961:99.99662%,-33.760870000000004:0.0032%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99876%,11:49.99787%,0:0.0032%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99734%,2:0.00231%,1:0.00036%]
[INFO] ** proxy_src_ip:[18:38.05392%,20:26.11104%,13:18.2746%,6:17.55653%,10:0.00107%,11:0.00089%,16:0.00053%,17:0.00036%,7:0.00036%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.11051%,-0.32151:20.8058%,-1.27613:18.27425%,-0.23351:17.55617%,-0.33484:17.24812%,-9.78512:0.00071%,-64.19493:0.00053%,-1.02014:0.00053%,-71.14798:0.00053%,-0.24151:0.00036%,-71.14931:0.00036%,-0.08551:0.00036%,-71.33197:0.00036%,1.47576:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,-68.79874000000001:0.00018%,6.1115699999999995:0.00018%,14.540560000000001:0.00018%,1.45709:0.00018%]
[INFO] ** scada_tag:[3:26.11015%,1:20.80562%,5:18.27425%,4:17.55617%,2:17.24795%,0:0.00586%]
[INFO] ** service:[0.0048200000000000005:99.99734%,-186.43601999999998:0.00071%,-211.08346:0.00053%,-186.44547:0.00053%,-211.73542999999998:0.00036%,-211.08818:0.00036%,-202.75898:0.00018%]
[INFO] ** src:[22:38.05392%,9:26.11104%,7:18.2746%,1:17.55653%,11:0.00107%,10:0.00089%,15:0.00053%,21:0.00036%,14:0.00036%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1538 (0.27323%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0272 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0591 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0430 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0115 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0106 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9935e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3283 - tp: 68747.0000 - fp: 11253.0000 - tn: 308747.0000 - fn: 11253.0000 - accuracy: 0.9437 - precision: 0.8593 - recall: 0.8593 - auc: 0.9837 - val_loss: 0.4434 - val_tp: 12866.0000 - val_fp: 7134.0000 - val_tn: 72866.0000 - val_fn: 7134.0000 - val_accuracy: 0.8573 - val_precision: 0.6433 - val_recall: 0.6433 - val_auc: 0.9679
[INFO] saving weights to checkpoints/lstm-epoch-9-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0711 - tp: 76516.0000 - fp: 3484.0000 - tn: 316516.0000 - fn: 3484.0000 - accuracy: 0.9826 - precision: 0.9564 - recall: 0.9564 - auc: 0.9991 - val_loss: 2.0287e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 14-14/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99947%,30:0.00018%,26:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:92.90757%,Single Stage Single Point:7.09243%]
[INFO] ** dst:[21:43.35188%,10:20.81024%,8:18.26323%,9:17.57305%,22:0.00071%,24:0.00036%,15:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.99982%,3:0.00018%]
[INFO] ** modbus_function_code:[0.02961:99.99947%,-33.760870000000004:0.00053%]
[INFO] ** modbus_function_description:[7:50.00053%,11:49.99893%,0:0.00053%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99964%,2:0.00018%,1:0.00018%]
[INFO] ** proxy_src_ip:[18:38.05126%,20:26.1114%,13:18.26341%,6:17.57323%,21:0.00018%,17:0.00018%,16:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:26.11068%,-0.32151:20.81024%,-1.27613:18.26288%,-0.23351:17.57287%,-0.33484:17.24102%,-1.27347:0.00036%,1.45709:0.00036%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%,-71.33197:0.00018%]
[INFO] ** scada_tag:[3:26.11033%,1:20.81024%,5:18.2627%,4:17.57252%,2:17.24084%,0:0.00338%]
[INFO] ** service:[0.0048200000000000005:99.99947%,-183.8612:0.00018%,-211.08346:0.00018%,-211.73542999999998:0.00018%]
[INFO] ** src:[22:38.05126%,9:26.1114%,7:18.26341%,1:17.57323%,15:0.00018%,14:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1538 (0.27323%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0650 - tp: 78607.0000 - fp: 1393.0000 - tn: 318607.0000 - fn: 1393.0000 - accuracy: 0.9930 - precision: 0.9826 - recall: 0.9826 - auc: 0.9976 - val_loss: 9.4375e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3346 - tp: 74466.0000 - fp: 5534.0000 - tn: 314466.0000 - fn: 5534.0000 - accuracy: 0.9723 - precision: 0.9308 - recall: 0.9308 - auc: 0.9855 - val_loss: 0.0824 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0678 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0472 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0429 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0329 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0306 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0243 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 15-15/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99627%,30:0.00302%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:90.18824%,Single Stage Multi Point:9.81105%,Single Stage Single Point:0.00071%]
[INFO] ** dst:[21:43.30462%,10:20.77684%,8:18.31209%,9:17.60112%,15:0.00302%,22:0.0016%,25:0.00018%,24:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99716%,0:0.00284%]
[INFO] ** i/f_name:[2:99.99698%,3:0.00302%]
[INFO] ** modbus_function_code:[0.02961:99.99627%,-33.760870000000004:0.00373%]
[INFO] ** modbus_function_description:[7:49.99911%,11:49.99716%,0:0.00373%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99734%,2:0.00266%]
[INFO] ** proto:[0:99.99662%,1:0.00302%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.01093%,20:26.07125%,13:18.31173%,6:17.60165%,17:0.00302%,16:0.00071%,7:0.00036%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.07036%,-0.32151:20.77666%,-1.27613:18.31155%,-0.23351:17.60094%,-0.33484:17.23427%,-71.33197:0.00302%,-1.02014:0.00071%,-0.24151:0.00053%,1.46509:0.00036%,1.45709:0.00036%,1.47576:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-61.95768:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.07%,1:20.77648%,5:18.31155%,4:17.60059%,2:17.23409%,0:0.00728%]
[INFO] ** service:[0.0048200000000000005:99.99645%,-211.73542999999998:0.00302%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.01093%,9:26.07125%,7:18.31173%,1:17.60165%,21:0.00302%,15:0.00071%,14:0.00036%,16:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1547 (0.27483%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0229 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0188 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0180 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0137 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0125 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0073 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0089 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0049 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.3185 - tp: 63563.0000 - fp: 16437.0000 - tn: 303563.0000 - fn: 16437.0000 - accuracy: 0.9178 - precision: 0.7945 - recall: 0.7945 - auc: 0.8588 - val_loss: 7.5270 - val_tp: 10665.0000 - val_fp: 9335.0000 - val_tn: 70665.0000 - val_fn: 9335.0000 - val_accuracy: 0.8133 - val_precision: 0.5332 - val_recall: 0.5332 - val_auc: 0.6921
[INFO] saving weights to checkpoints/lstm-epoch-9-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 16-16/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (502586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (502586, 17)

[INFO] analyzing data
[INFO] 502586 rows
[INFO] ** appi_name:[21:99.99821%,30:0.00159%,33:0.0002%]
[INFO] ** classification:[normal:80.50821%,Single Stage Multi Point:19.49179%]
[INFO] ** dst:[21:43.34661%,10:20.79465%,8:18.26155%,9:17.5942%,15:0.00159%,22:0.00119%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.99841%,0:0.00159%]
[INFO] ** i/f_name:[2:99.99841%,3:0.00159%]
[INFO] ** modbus_function_code:[0.02961:99.99821%,-33.760870000000004:0.00179%]
[INFO] ** modbus_function_description:[7:50.0004%,11:49.99781%,0:0.00179%]
[INFO] ** modbus_transaction_id:65536 (13.03976%)
[INFO] ** orig:[0:99.99841%,2:0.00159%]
[INFO] ** proto:[0:99.99841%,1:0.00159%]
[INFO] ** proxy_src_ip:[18:38.04065%,20:26.10081%,13:18.26195%,6:17.5944%,17:0.00159%,16:0.0004%,21:0.0002%]
[INFO] ** s_port:[1.45442:26.10021%,-0.32151:20.79445%,-1.27613:18.26155%,-0.23351:17.594%,-0.33484:17.2462%,-71.33197:0.00159%,1.45709:0.0004%,-0.24151:0.0004%,-1.02014:0.0004%,-1.27347:0.0002%,1.47576:0.0002%,-49.275529999999996:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:26.09981%,1:20.79425%,5:18.26135%,4:17.59361%,2:17.246%,0:0.00497%]
[INFO] ** service:[0.0048200000000000005:99.99841%,-211.73542999999998:0.00159%]
[INFO] ** src:[22:38.04065%,9:26.10081%,7:18.26195%,1:17.5944%,21:0.00159%,15:0.0004%,4:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1376 (0.27378%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5634 - tp: 42486.0000 - fp: 37514.0000 - tn: 282486.0000 - fn: 37514.0000 - accuracy: 0.8124 - precision: 0.5311 - recall: 0.5311 - auc: 0.6786 - val_loss: 7.5513 - val_tp: 10633.0000 - val_fp: 9367.0000 - val_tn: 70633.0000 - val_fn: 9367.0000 - val_accuracy: 0.8127 - val_precision: 0.5317 - val_recall: 0.5317 - val_auc: 0.6923
[INFO] saving weights to checkpoints/lstm-epoch-9-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5500 - tp: 42542.0000 - fp: 37458.0000 - tn: 282542.0000 - fn: 37458.0000 - accuracy: 0.8127 - precision: 0.5318 - recall: 0.5318 - auc: 0.6871 - val_loss: 7.5742 - val_tp: 10603.0000 - val_fp: 9397.0000 - val_tn: 70603.0000 - val_fn: 9397.0000 - val_accuracy: 0.8121 - val_precision: 0.5301 - val_recall: 0.5301 - val_auc: 0.6985
[INFO] saving weights to checkpoints/lstm-epoch-9-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8540 - tp: 75773.0000 - fp: 4227.0000 - tn: 315773.0000 - fn: 4227.0000 - accuracy: 0.9789 - precision: 0.9472 - recall: 0.9472 - auc: 0.9655 - val_loss: 6.9930e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0018 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.2933e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0016 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9538e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-15-16-batch-400000-500000
[INFO] processing batch 500000-600000/502586
[33m[INFO] loading file 17-17/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (502586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (502586, 17)

[INFO] analyzing data
[INFO] 502586 rows
[INFO] ** appi_name:[21:99.99702%,7:0.0006%,26:0.0004%,0:0.0004%,31:0.0002%,27:0.0002%,24:0.0002%,22:0.0002%,16:0.0002%,15:0.0002%,8:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:93.86175%,Multi Stage Multi Point:6.13825%]
[INFO] ** dst:[21:43.35298%,10:20.85195%,8:18.19171%,9:17.60017%,22:0.0008%,6:0.0006%,25:0.0004%,16:0.0004%,2:0.0004%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99702%,-33.760870000000004:0.00279%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9994%,11:49.99761%,0:0.00279%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.03976%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99861%,2:0.00139%]
[INFO] ** proxy_src_ip:[18:38.08841%,20:26.11712%,13:18.19112%,6:17.60017%,10:0.00119%,11:0.00099%,1:0.0004%,16:0.0002%,14:0.0002%,7:0.0002%]
[INFO] ** s_port:[1.45442:26.11633%,-0.32151:20.85195%,-1.27613:18.19072%,-0.23351:17.59997%,-0.33484:17.23645%,6.0369:0.0008%,-64.19493:0.0004%,-71.14798:0.0004%,1.45709:0.0004%,-3.3787199999999995:0.0002%,-68.79874000000001:0.0002%,-1.27347:0.0002%,1.46509:0.0002%,1.47576:0.0002%,8.55414:0.0002%,6.06224:0.0002%,-4.3880099999999995:0.0002%,-0.24151:0.0002%,-71.14931:0.0002%,-1.02014:0.0002%,6.15557:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:26.11613%,1:20.85175%,5:18.19052%,4:17.59957%,2:17.23645%,0:0.00557%]
[INFO] ** service:[0.0048200000000000005:99.99781%,-211.09762999999998:0.0006%,-186.44547:0.0004%,-211.08346:0.0004%,-186.43601999999998:0.0002%,-211.35747999999998:0.0002%,-211.08818:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.08841%,9:26.11712%,7:18.19112%,1:17.60017%,11:0.00119%,10:0.00099%,3:0.0004%,21:0.0002%,15:0.0002%,2:0.0002%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** unixtime:1374 (0.27339%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0013 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2433e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0012 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4373e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0011 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8941 - val_tp: 16409.0000 - val_fp: 3591.0000 - val_tn: 76409.0000 - val_fn: 3591.0000 - val_accuracy: 0.9282 - val_precision: 0.8205 - val_recall: 0.8205 - val_auc: 0.8883
[INFO] saving weights to checkpoints/lstm-epoch-9-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9255 - tp: 65483.0000 - fp: 14517.0000 - tn: 305483.0000 - fn: 14517.0000 - accuracy: 0.9274 - precision: 0.8185 - recall: 0.8185 - auc: 0.8863 - val_loss: 2.9046 - val_tp: 16396.0000 - val_fp: 3604.0000 - val_tn: 76396.0000 - val_fn: 3604.0000 - val_accuracy: 0.9279 - val_precision: 0.8198 - val_recall: 0.8198 - val_auc: 0.8874
[INFO] saving weights to checkpoints/lstm-epoch-9-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.8418 - tp: 70862.0000 - fp: 9138.0000 - tn: 310862.0000 - fn: 9138.0000 - accuracy: 0.9543 - precision: 0.8858 - recall: 0.8858 - auc: 0.9284 - val_loss: 1.4424e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/502586
[33m[INFO] loading file 18-18/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (502586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (502586, 17)

[INFO] analyzing data
[INFO] 502586 rows
[INFO] ** appi_name:[21:99.99801%,30:0.0006%,7:0.0006%,31:0.0002%,27:0.0002%,22:0.0002%,8:0.0002%]
[INFO] ** classification:[normal:80.70022%,Multi Stage Multi Point:19.29978%]
[INFO] ** dst:[21:43.34243%,10:20.8235%,8:18.27488%,9:17.5562%,22:0.0006%,15:0.0006%,24:0.0004%,16:0.0004%,2:0.0004%,18:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.9994%,0:0.0006%]
[INFO] ** i/f_name:[2:99.9994%,3:0.0006%]
[INFO] ** modbus_function_code:[0.02961:99.99801%,-33.760870000000004:0.00199%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.99821%,0:0.00199%]
[INFO] ** modbus_transaction_id:65536 (13.03976%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99881%,2:0.0006%,1:0.0006%]
[INFO] ** proxy_src_ip:[18:38.06274%,20:26.10379%,13:18.27528%,6:17.5562%,17:0.0006%,11:0.0006%,1:0.0004%,14:0.0002%,7:0.0002%]
[INFO] ** s_port:[1.45442:26.103%,-0.32151:20.8235%,-1.27613:18.27468%,-0.23351:17.556%,-0.33484:17.23924%,-71.33197:0.0006%,1.45709:0.0004%,-1.27347:0.0004%,-1.2708:0.0002%,-71.14931:0.0002%,-0.24151:0.0002%,6.45955:0.0002%,-2.48275:0.0002%,1.47576:0.0002%,1.46509:0.0002%,-3.3787199999999995:0.0002%,3.6236699999999997:0.0002%,6.06224:0.0002%,8.10082:0.0002%]
[INFO] ** scada_tag:[3:26.1026%,1:20.8233%,5:18.27448%,4:17.5558%,2:17.23904%,0:0.00478%]
[INFO] ** service:[0.0048200000000000005:99.99801%,-211.09762999999998:0.0006%,-211.73542999999998:0.0006%,-186.43601999999998:0.0002%,-211.35747999999998:0.0002%,-211.08818:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.06274%,9:26.10379%,7:18.27528%,1:17.5562%,14:0.0006%,10:0.0006%,3:0.0004%,21:0.0002%,2:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1374 (0.27339%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.4295 - tp: 58018.0000 - fp: 21982.0000 - tn: 298018.0000 - fn: 21982.0000 - accuracy: 0.8901 - precision: 0.7252 - recall: 0.7252 - auc: 0.8261 - val_loss: 6.1040 - val_tp: 12426.0000 - val_fp: 7574.0000 - val_tn: 72426.0000 - val_fn: 7574.0000 - val_accuracy: 0.8485 - val_precision: 0.6213 - val_recall: 0.6213 - val_auc: 0.7633
[INFO] saving weights to checkpoints/lstm-epoch-9-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1337 - tp: 49559.0000 - fp: 30441.0000 - tn: 289559.0000 - fn: 30441.0000 - accuracy: 0.8478 - precision: 0.6195 - recall: 0.6195 - auc: 0.7595 - val_loss: 6.1427 - val_tp: 12378.0000 - val_fp: 7622.0000 - val_tn: 72378.0000 - val_fn: 7622.0000 - val_accuracy: 0.8476 - val_precision: 0.6189 - val_recall: 0.6189 - val_auc: 0.7618
[INFO] saving weights to checkpoints/lstm-epoch-9-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.9197 - tp: 50621.0000 - fp: 29379.0000 - tn: 290621.0000 - fn: 29379.0000 - accuracy: 0.8531 - precision: 0.6328 - recall: 0.6328 - auc: 0.7681 - val_loss: 6.7304e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.3143e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.1236e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.0419e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8368e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/502586
[33m[INFO] loading file 19-19/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (502586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (502586, 17)

[INFO] analyzing data
[INFO] 502586 rows
[INFO] ** appi_name:[21:99.99781%,26:0.0004%,0:0.0004%,31:0.0002%,27:0.0002%,24:0.0002%,22:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:85.76164%,Single Stage Multi Point:14.23836%]
[INFO] ** dst:[21:43.38302%,10:20.82947%,8:18.21101%,9:17.57351%,22:0.00139%,6:0.0006%,25:0.0004%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99781%,-33.760870000000004:0.00199%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.99801%,0:0.00199%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.03976%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99861%,2:0.00139%]
[INFO] ** proxy_src_ip:[18:38.11825%,20:26.09424%,13:18.21121%,6:17.57351%,10:0.00119%,11:0.00099%,16:0.0006%]
[INFO] ** s_port:[1.45442:26.09325%,-0.32151:20.82947%,-1.27613:18.21081%,-0.23351:17.57331%,-0.33484:17.28878%,-5.20264:0.0008%,1.45709:0.0006%,-1.02014:0.0006%,-64.19493:0.0004%,-71.14798:0.0004%,-1.27347:0.0002%,1.47576:0.0002%,-0.24151:0.0002%,-71.14931:0.0002%,1.46509:0.0002%,-68.79874000000001:0.0002%,-1.2708:0.0002%,0.75578:0.0002%]
[INFO] ** scada_tag:[3:26.09285%,1:20.82927%,5:18.21061%,4:17.57311%,2:17.28878%,0:0.00537%]
[INFO] ** service:[0.0048200000000000005:99.99861%,-186.44547:0.0004%,-211.08346:0.0004%,-186.43601999999998:0.0002%,-211.08818:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.11825%,9:26.09424%,7:18.21121%,1:17.57351%,11:0.00119%,10:0.00099%,15:0.0006%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** unixtime:1375 (0.27359%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.3667e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6300e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.9846e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0178e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.5488e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2760e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.6995 - tp: 46749.0000 - fp: 33251.0000 - tn: 286749.0000 - fn: 33251.0000 - accuracy: 0.8337 - precision: 0.5844 - recall: 0.5844 - auc: 0.7385 - val_loss: 9.8425 - val_tp: 7787.0000 - val_fp: 12213.0000 - val_tn: 67787.0000 - val_fn: 12213.0000 - val_accuracy: 0.7557 - val_precision: 0.3893 - val_recall: 0.3893 - val_auc: 0.6183
[INFO] saving weights to checkpoints/lstm-epoch-9-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.2580 - tp: 53904.0000 - fp: 26096.0000 - tn: 293904.0000 - fn: 26096.0000 - accuracy: 0.8695 - precision: 0.6738 - recall: 0.6738 - auc: 0.7947 - val_loss: 8.0528e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/502586
[33m[INFO] loading file 20-20/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (502586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (502586, 17)

[INFO] analyzing data
[INFO] 502586 rows
[INFO] ** appi_name:[21:99.99622%,30:0.00318%,31:0.0002%,27:0.0002%,26:0.0002%]
[INFO] ** classification:[normal:91.84637%,Single Stage Multi Point:8.15363%]
[INFO] ** dst:[21:43.42401%,10:20.83663%,8:18.16684%,9:17.56714%,15:0.00318%,22:0.00119%,24:0.0004%,18:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99721%,0:0.00279%]
[INFO] ** i/f_name:[2:99.99682%,3:0.00318%]
[INFO] ** modbus_function_code:[0.02961:99.99622%,-33.760870000000004:0.00378%]
[INFO] ** modbus_function_description:[7:49.9996%,11:49.99662%,0:0.00378%]
[INFO] ** modbus_transaction_id:65536 (13.03976%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99622%,1:0.00318%,2:0.0006%]
[INFO] ** proxy_src_ip:[18:38.11746%,20:26.14378%,13:18.16704%,6:17.56774%,17:0.00318%,14:0.0006%,16:0.0002%]
[INFO] ** s_port:[1.45442:26.14299%,-0.32151:20.83663%,-1.27613:18.16644%,-0.23351:17.56694%,-0.33484:17.28082%,-71.33197:0.00318%,-0.24151:0.0006%,1.45709:0.0004%,-1.27347:0.0004%,-1.2708:0.0002%,-1.02014:0.0002%,13.431270000000001:0.0002%,-71.14798:0.0002%,1.47576:0.0002%,-0.24950999999999998:0.0002%,11.862:0.0002%,1.46509:0.0002%]
[INFO] ** scada_tag:[3:26.14259%,1:20.83643%,5:18.16644%,4:17.56655%,2:17.28062%,0:0.00736%]
[INFO] ** service:[0.0048200000000000005:99.99622%,-211.73542999999998:0.00318%,-211.08346:0.0002%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.11746%,9:26.14378%,7:18.16704%,1:17.56774%,14:0.00318%,2:0.0006%,15:0.0002%]
[INFO] ** type:[0:99.9996%,1:0.0004%]
[INFO] ** unixtime:1374 (0.27339%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7212 - tp: 76422.0000 - fp: 3578.0000 - tn: 316422.0000 - fn: 3578.0000 - accuracy: 0.9821 - precision: 0.9553 - recall: 0.9553 - auc: 0.9719 - val_loss: 2.9665 - val_tp: 16319.0000 - val_fp: 3681.0000 - val_tn: 76319.0000 - val_fn: 3681.0000 - val_accuracy: 0.9264 - val_precision: 0.8159 - val_recall: 0.8159 - val_auc: 0.8850
[INFO] saving weights to checkpoints/lstm-epoch-9-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9410 - tp: 65404.0000 - fp: 14596.0000 - tn: 305404.0000 - fn: 14596.0000 - accuracy: 0.9270 - precision: 0.8176 - recall: 0.8176 - auc: 0.8854 - val_loss: 2.9754 - val_tp: 16308.0000 - val_fp: 3692.0000 - val_tn: 76308.0000 - val_fn: 3692.0000 - val_accuracy: 0.9262 - val_precision: 0.8154 - val_recall: 0.8154 - val_auc: 0.8846
[INFO] saving weights to checkpoints/lstm-epoch-9-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9354 - tp: 65432.0000 - fp: 14568.0000 - tn: 305432.0000 - fn: 14568.0000 - accuracy: 0.9272 - precision: 0.8179 - recall: 0.8179 - auc: 0.8855 - val_loss: 0.6963 - val_tp: 19136.0000 - val_fp: 864.0000 - val_tn: 79136.0000 - val_fn: 864.0000 - val_accuracy: 0.9827 - val_precision: 0.9568 - val_recall: 0.9568 - val_auc: 0.9730
[INFO] saving weights to checkpoints/lstm-epoch-9-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9085e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5015e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.6894e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6427e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/502586
[33m[INFO] loading file 21-21/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (502584, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (502584, 17)

[INFO] analyzing data
[INFO] 502584 rows
[INFO] ** appi_name:[21:99.99602%,30:0.0008%,7:0.0006%,26:0.0004%,22:0.0004%,0:0.0004%,31:0.0002%,27:0.0002%,24:0.0002%,16:0.0002%,15:0.0002%,8:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:98.78568%,Multi Stage Single Point:1.21432%]
[INFO] ** dst:[21:43.30281%,10:21.00544%,8:18.16234%,9:17.52483%,22:0.00099%,15:0.0008%,6:0.0008%,25:0.0004%,24:0.0004%,16:0.0004%,2:0.0004%,18:0.0002%,7:0.0002%]
[INFO] ** i/f_dir:[1:99.9992%,0:0.0008%]
[INFO] ** i/f_name:[2:99.9992%,3:0.0008%]
[INFO] ** modbus_function_code:[0.02961:99.99602%,-33.760870000000004:0.00378%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.99861%,11:49.99741%,0:0.00378%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.03981%)
[INFO] ** orig:[0:99.9992%,2:0.0008%]
[INFO] ** proto:[0:99.99761%,2:0.00159%,1:0.0008%]
[INFO] ** proxy_src_ip:[18:38.33906%,20:25.96899%,13:18.16254%,6:17.52483%,10:0.00119%,11:0.00099%,17:0.0008%,16:0.0006%,1:0.0004%,21:0.0002%,14:0.0002%,7:0.0002%]
[INFO] ** s_port:[1.45442:25.9684%,-0.32151:21.00465%,-1.27613:18.16214%,-0.23351:17.52463%,-0.33484:17.33442%,-6.64392:0.0008%,-71.33197:0.0008%,-1.02014:0.0006%,-1.27347:0.0004%,-71.14931:0.0004%,-71.14798:0.0004%,-64.19493:0.0004%,1.45709:0.0002%,-2.2440900000000004:0.0002%,-3.3787199999999995:0.0002%,-68.79874000000001:0.0002%,10.15141:0.0002%,1.46509:0.0002%,1.47576:0.0002%,7.060860000000001:0.0002%,-0.24151:0.0002%,6.62488:0.0002%]
[INFO] ** scada_tag:[3:25.968%,1:21.00445%,5:18.16194%,4:17.52443%,2:17.33442%,0:0.00677%]
[INFO] ** service:[0.0048200000000000005:99.99682%,-211.73542999999998:0.0008%,-211.09762999999998:0.0006%,-186.44547:0.0004%,-211.08346:0.0004%,-211.08818:0.0004%,-186.43601999999998:0.0002%,-211.35747999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.33906%,9:25.96899%,7:18.16254%,1:17.52483%,11:0.00119%,21:0.00099%,10:0.00099%,15:0.0006%,3:0.0004%,4:0.0002%,2:0.0002%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** unixtime:1368 (0.27219%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/502584
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.4069e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1740e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/502584
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.1312e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.7253e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/502584
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.0205e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.9117e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/502584
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.8221e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3088e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/502584
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.5357e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9449 - val_tp: 15105.0000 - val_fp: 4895.0000 - val_tn: 75105.0000 - val_fn: 4895.0000 - val_accuracy: 0.9021 - val_precision: 0.7552 - val_recall: 0.7552 - val_auc: 0.8470
[INFO] saving weights to checkpoints/lstm-epoch-9-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/502584
[33m[INFO] loading file 22-22/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (271625, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (271625, 17)

[INFO] analyzing data
[INFO] 271625 rows
[INFO] ** appi_name:[21:99.9919%,30:0.00699%,23:0.00037%,22:0.00037%,18:0.00037%]
[INFO] ** classification:[normal:53.00249%,Multi Stage Single Point:46.99751%]
[INFO] ** dst:[21:43.30897%,10:21.00948%,8:18.10179%,9:17.57018%,15:0.00699%,22:0.00147%,19:0.00074%,26:0.00037%]
[INFO] ** i/f_dir:[1:99.99337%,0:0.00663%]
[INFO] ** i/f_name:[2:99.99301%,3:0.00663%,0:0.00037%]
[INFO] ** modbus_function_code:[0.02961:99.9919%,-33.760870000000004:0.0081%]
[INFO] ** modbus_function_description:[7:49.99724%,11:49.99466%,0:0.0081%]
[INFO] ** modbus_transaction_id:64487 (23.74119%)
[INFO] ** orig:[0:99.99485%,2:0.00442%,1:0.00074%]
[INFO] ** proto:[0:99.99264%,1:0.00699%,2:0.00037%]
[INFO] ** proxy_src_ip:[18:38.33152%,20:25.98803%,13:18.10106%,6:17.57128%,17:0.00699%,14:0.00074%,10:0.00037%]
[INFO] ** s_port:[1.45442:25.98693%,-0.32151:21.00948%,-1.27613:18.10106%,-0.23351:17.57018%,-0.33484:17.32204%,-71.33197:0.00699%,1.45709:0.00074%,-0.24151:0.00074%,7.228860000000001:0.00074%,-0.24950999999999998:0.00037%,1.46509:0.00037%,-71.14931:0.00037%]
[INFO] ** scada_tag:[3:25.98656%,1:21.00948%,5:18.10106%,4:17.56981%,2:17.32204%,0:0.01104%]
[INFO] ** service:[0.0048200000000000005:99.9919%,-211.73542999999998:0.00699%,-211.07873999999998:0.00074%,-211.08818:0.00037%]
[INFO] ** src:[22:38.33152%,9:25.98803%,7:18.10106%,1:17.57128%,21:0.00442%,14:0.00258%,2:0.00074%,11:0.00037%]
[INFO] ** type:[0:99.99779%,1:0.00221%]
[INFO] ** unixtime:750 (0.27612%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/271625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5615 - tp: 42470.0000 - fp: 37530.0000 - tn: 282470.0000 - fn: 37530.0000 - accuracy: 0.8123 - precision: 0.5309 - recall: 0.5309 - auc: 0.7068 - val_loss: 7.5771 - val_tp: 10598.0000 - val_fp: 9402.0000 - val_tn: 70598.0000 - val_fn: 9402.0000 - val_accuracy: 0.8120 - val_precision: 0.5299 - val_recall: 0.5299 - val_auc: 0.7062
[INFO] saving weights to checkpoints/lstm-epoch-9-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/271625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5941 - tp: 42308.0000 - fp: 37692.0000 - tn: 282308.0000 - fn: 37692.0000 - accuracy: 0.8115 - precision: 0.5289 - recall: 0.5289 - auc: 0.7055 - val_loss: 7.5828 - val_tp: 10591.0000 - val_fp: 9409.0000 - val_tn: 70591.0000 - val_fn: 9409.0000 - val_accuracy: 0.8118 - val_precision: 0.5296 - val_recall: 0.5296 - val_auc: 0.7060
[INFO] saving weights to checkpoints/lstm-epoch-9-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/271625
[33m[INFO] loading file 23-23/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571625, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571625, 17)

[INFO] analyzing data
[INFO] 571625 rows
[INFO] ** appi_name:[21:99.9986%,30:0.0007%,31:0.00035%,33:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:92.53724%,Multi Stage Single Point:7.46276%]
[INFO] ** dst:[21:43.32368%,10:20.99856%,8:18.14091%,9:17.53422%,22:0.00105%,15:0.0007%,24:0.00035%,18:0.00035%,25:0.00017%]
[INFO] ** i/f_dir:[1:99.9993%,0:0.0007%]
[INFO] ** i/f_name:[2:99.9993%,3:0.0007%]
[INFO] ** modbus_function_code:[0.02961:99.9986%,-33.760870000000004:0.0014%]
[INFO] ** modbus_function_description:[7:50.00044%,11:49.99816%,0:0.0014%]
[INFO] ** modbus_transaction_id:65536 (11.46486%)
[INFO] ** orig:[0:99.99948%,2:0.00052%]
[INFO] ** proto:[0:99.99878%,1:0.0007%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.33562%,20:25.98714%,13:18.14091%,6:17.5344%,17:0.0007%,16:0.00052%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.98627%,-0.32151:20.99838%,-1.27613:18.14039%,-0.23351:17.53405%,-0.33484:17.33724%,-71.33197:0.0007%,-1.02014:0.00052%,-0.08551:0.00035%,-1.27347:0.00035%,1.45709:0.00035%,1.46509:0.00035%,-0.24151:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.98592%,1:20.99838%,5:18.14021%,4:17.53387%,2:17.33707%,0:0.00455%]
[INFO] ** service:[0.0048200000000000005:99.99878%,-211.73542999999998:0.0007%,-186.43601999999998:0.00035%,-186.44547:0.00017%]
[INFO] ** src:[22:38.33562%,9:25.98714%,7:18.14091%,1:17.5344%,21:0.00052%,15:0.00052%,17:0.00017%,14:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1557 (0.27238%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5631 - tp: 42462.0000 - fp: 37538.0000 - tn: 282462.0000 - fn: 37538.0000 - accuracy: 0.8123 - precision: 0.5308 - recall: 0.5308 - auc: 0.7067 - val_loss: 4.1270 - val_tp: 14879.0000 - val_fp: 5121.0000 - val_tn: 74879.0000 - val_fn: 5121.0000 - val_accuracy: 0.8976 - val_precision: 0.7440 - val_recall: 0.7440 - val_auc: 0.8400
[INFO] saving weights to checkpoints/lstm-epoch-9-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2176e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5730e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0251e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4596e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.1219e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3602e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.3057e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2757e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/571625
[33m[INFO] loading file 24-24/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571625, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571625, 17)

[INFO] analyzing data
[INFO] 571625 rows
[INFO] ** appi_name:[21:99.99353%,30:0.00315%,26:0.00052%,31:0.00035%,27:0.00035%,22:0.00035%,0:0.00035%,24:0.00017%,23:0.00017%,19:0.00017%,18:0.00017%,16:0.00017%,15:0.00017%,11:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:95.54253%,Multi Stage Single Point:4.45747%]
[INFO] ** dst:[21:43.37022%,10:21.01465%,8:18.0977%,9:17.51061%,15:0.00315%,22:0.00105%,6:0.0007%,25:0.00035%,24:0.00035%,19:0.00035%,18:0.00035%,7:0.00035%,26:0.00017%]
[INFO] ** i/f_dir:[1:99.99703%,0:0.00297%]
[INFO] ** i/f_name:[2:99.99685%,3:0.00315%]
[INFO] ** modbus_function_code:[0.02961:99.99353%,-33.760870000000004:0.00595%,-0.415:0.00017%,0.9188299999999999:0.00017%,0.47422:0.00017%]
[INFO] ** modbus_function_description:[7:49.99781%,11:49.99571%,0:0.00595%,15:0.00017%,10:0.00017%,2:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.46486%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.99493%,1:0.00315%,2:0.00192%]
[INFO] ** proxy_src_ip:[18:38.39545%,20:25.99029%,13:18.09753%,6:17.50991%,17:0.00315%,10:0.00122%,14:0.00087%,11:0.00087%,21:0.00035%,16:0.00035%]
[INFO] ** s_port:[1.45442:25.98942%,-0.32151:21.01465%,-1.27613:18.09718%,-0.23351:17.50921%,-0.33484:17.3808%,-71.33197:0.00315%,-9.58113:0.0007%,-71.14798:0.00052%,-0.24950999999999998:0.00035%,-1.27347:0.00035%,1.45709:0.00035%,-0.24151:0.00035%,-1.02014:0.00035%,-31.55091:0.00035%,7.6315100000000005:0.00035%,-71.14931:0.00035%,-64.19493:0.00035%,1.47576:0.00035%,-68.79874000000001:0.00017%,1.46509:0.00017%,7.4901800000000005:0.00017%,13.431270000000001:0.00017%,11.862:0.00017%]
[INFO] ** scada_tag:[3:25.98924%,1:21.01465%,5:18.097%,4:17.50886%,2:17.38063%,0:0.00962%]
[INFO] ** service:[0.0048200000000000005:99.99458%,-211.73542999999998:0.00315%,-211.08346:0.00052%,-211.07873999999998:0.00035%,-202.75898:0.00035%,-186.44547:0.00035%,-186.43601999999998:0.00035%,-211.08818:0.00035%]
[INFO] ** src:[22:38.39545%,9:25.99029%,7:18.09753%,1:17.50991%,14:0.00315%,11:0.00122%,10:0.00087%,2:0.00087%,15:0.00035%,4:0.00035%]
[INFO] ** type:[0:99.99878%,1:0.00087%,2:0.00035%]
[INFO] ** unixtime:1553 (0.27168%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.2445e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2368e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.2884e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2130e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.6236e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.1235e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.4484e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0314 - val_tp: 19961.0000 - val_fp: 39.0000 - val_tn: 79961.0000 - val_fn: 39.0000 - val_accuracy: 0.9992 - val_precision: 0.9980 - val_recall: 0.9980 - val_auc: 0.9988
[INFO] saving weights to checkpoints/lstm-epoch-9-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/571625
[33m[INFO] loading file 25-25/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571625, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571625, 17)

[INFO] analyzing data
[INFO] 571625 rows
[INFO] ** appi_name:[21:99.9965%,30:0.00105%,17:0.0007%,22:0.00052%,31:0.00035%,28:0.00017%,26:0.00017%,12:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** classification:[normal:64.3525%,Multi Stage Single Point:35.6475%]
[INFO] ** dst:[21:43.32141%,10:21.0269%,8:18.13147%,9:17.51603%,15:0.00105%,22:0.00087%,16:0.0007%,6:0.0007%,18:0.00035%,17:0.00035%,24:0.00017%]
[INFO] ** i/f_dir:[1:99.99895%,0:0.00105%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.9965%,-33.760870000000004:0.0035%]
[INFO] ** modbus_function_description:[7:49.99904%,11:49.99746%,0:0.0035%]
[INFO] ** modbus_transaction_id:65536 (11.46486%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9979%,2:0.00105%,1:0.00105%]
[INFO] ** proxy_src_ip:[18:38.39178%,20:25.95635%,13:18.13147%,6:17.51655%,17:0.00105%,1:0.00087%,21:0.0007%,16:0.00035%,14:0.00035%,7:0.00035%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.956%,-0.32151:21.02655%,-1.27613:18.13112%,-0.23351:17.51603%,-0.33484:17.36523%,-71.33197:0.00105%,-71.14931:0.00052%,-0.24151:0.00035%,-1.02014:0.00035%,-49.275529999999996:0.00035%,1.46509:0.00017%,-5.1466400000000005:0.00017%,-1.27347:0.00017%,-1.2708:0.00017%,-58.035180000000004:0.00017%,-58.032509999999995:0.00017%,-0.24950999999999998:0.00017%,2.52505:0.00017%,-43.76509:0.00017%,2.05573:0.00017%,6.1115699999999995:0.00017%,-5.08665:0.00017%,1.45709:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:25.95565%,1:21.02637%,5:18.13094%,4:17.51585%,2:17.36506%,0:0.00612%]
[INFO] ** service:[0.0048200000000000005:99.99685%,-211.73542999999998:0.00105%,-205.44247:0.0007%,-211.08818:0.00052%,-186.43601999999998:0.00035%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%]
[INFO] ** src:[22:38.39178%,9:25.95635%,7:18.13147%,1:17.51655%,14:0.00105%,3:0.00087%,4:0.0007%,21:0.00035%,15:0.00035%,2:0.00035%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1553 (0.27168%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7284 - tp: 51568.0000 - fp: 28432.0000 - tn: 291568.0000 - fn: 28432.0000 - accuracy: 0.8578 - precision: 0.6446 - recall: 0.6446 - auc: 0.7779 - val_loss: 5.7550 - val_tp: 12859.0000 - val_fp: 7141.0000 - val_tn: 72859.0000 - val_fn: 7141.0000 - val_accuracy: 0.8572 - val_precision: 0.6429 - val_recall: 0.6429 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-9-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7548 - tp: 51437.0000 - fp: 28563.0000 - tn: 291437.0000 - fn: 28563.0000 - accuracy: 0.8572 - precision: 0.6430 - recall: 0.6430 - auc: 0.7769 - val_loss: 5.7566 - val_tp: 12857.0000 - val_fp: 7143.0000 - val_tn: 72857.0000 - val_fn: 7143.0000 - val_accuracy: 0.8571 - val_precision: 0.6428 - val_recall: 0.6428 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-9-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7504 - tp: 51459.0000 - fp: 28541.0000 - tn: 291459.0000 - fn: 28541.0000 - accuracy: 0.8573 - precision: 0.6432 - recall: 0.6432 - auc: 0.7770 - val_loss: 5.7163 - val_tp: 12907.0000 - val_fp: 7093.0000 - val_tn: 72907.0000 - val_fn: 7093.0000 - val_accuracy: 0.8581 - val_precision: 0.6453 - val_recall: 0.6453 - val_auc: 0.7783
[INFO] saving weights to checkpoints/lstm-epoch-9-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7520 - tp: 51451.0000 - fp: 28549.0000 - tn: 291451.0000 - fn: 28549.0000 - accuracy: 0.8573 - precision: 0.6431 - recall: 0.6431 - auc: 0.7770 - val_loss: 5.7066 - val_tp: 12919.0000 - val_fp: 7081.0000 - val_tn: 72919.0000 - val_fn: 7081.0000 - val_accuracy: 0.8584 - val_precision: 0.6460 - val_recall: 0.6460 - val_auc: 0.7787
[INFO] saving weights to checkpoints/lstm-epoch-9-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7552 - tp: 51435.0000 - fp: 28565.0000 - tn: 291435.0000 - fn: 28565.0000 - accuracy: 0.8572 - precision: 0.6429 - recall: 0.6429 - auc: 0.7768 - val_loss: 5.7566 - val_tp: 12857.0000 - val_fp: 7143.0000 - val_tn: 72857.0000 - val_fn: 7143.0000 - val_accuracy: 0.8571 - val_precision: 0.6428 - val_recall: 0.6428 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-9-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/571625
[33m[INFO] loading file 26-26/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571625, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571625, 17)

[INFO] analyzing data
[INFO] 571625 rows
[INFO] ** appi_name:[21:99.99825%,30:0.00052%,7:0.00052%,31:0.00017%,22:0.00017%,12:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:64.39799%,Single Stage Single Point:27.94%,Multi Stage Single Point:7.66202%]
[INFO] ** dst:[21:43.30654%,10:21.08918%,8:18.12167%,9:17.47999%,22:0.0007%,15:0.00052%,24:0.00035%,16:0.00035%,2:0.00035%,18:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99948%,0:0.00052%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.99825%,-33.760870000000004:0.00175%]
[INFO] ** modbus_function_description:[7:49.99956%,11:49.99869%,0:0.00175%]
[INFO] ** modbus_transaction_id:65536 (11.46486%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99913%,1:0.00052%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.46753%,20:25.92836%,13:18.12202%,6:17.47999%,17:0.00052%,1:0.00052%,21:0.00035%,16:0.00035%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.92784%,-0.32151:21.089%,-1.27613:18.1215%,-0.23351:17.47982%,-0.33484:17.37853%,-71.33197:0.00052%,-1.02014:0.00035%,-1.27347:0.00035%,-49.275529999999996:0.00017%,1.47576:0.00017%,1.45709:0.00017%,1.46509:0.00017%,-1.2708:0.00017%,14.191239999999999:0.00017%,2.52505:0.00017%,-3.3787199999999995:0.00017%,11.57001:0.00017%,-71.14931:0.00017%,7.66617:0.00017%,-0.24151:0.00017%]
[INFO] ** scada_tag:[3:25.92749%,1:21.089%,5:18.12132%,4:17.47964%,2:17.37853%,0:0.00402%]
[INFO] ** service:[0.0048200000000000005:99.99843%,-211.09762999999998:0.00052%,-211.73542999999998:0.00052%,-211.35747999999998:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.46753%,9:25.92836%,7:18.12202%,1:17.47999%,14:0.00052%,3:0.00052%,15:0.00035%,4:0.00035%,21:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1551 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7433 - tp: 51494.0000 - fp: 28506.0000 - tn: 291494.0000 - fn: 28506.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.7773 - val_loss: 5.7445 - val_tp: 12872.0000 - val_fp: 7128.0000 - val_tn: 72872.0000 - val_fn: 7128.0000 - val_accuracy: 0.8574 - val_precision: 0.6436 - val_recall: 0.6436 - val_auc: 0.7772
[INFO] saving weights to checkpoints/lstm-epoch-9-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.7108 - tp: 60669.0000 - fp: 19331.0000 - tn: 300669.0000 - fn: 19331.0000 - accuracy: 0.9033 - precision: 0.7584 - recall: 0.7584 - auc: 0.8526 - val_loss: 0.0019 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0687 - tp: 79051.0000 - fp: 949.0000 - tn: 319051.0000 - fn: 949.0000 - accuracy: 0.9953 - precision: 0.9881 - recall: 0.9881 - auc: 0.9927 - val_loss: 9.8486e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0632 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9930 - val_loss: 7.1067e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0629 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9930 - val_loss: 5.8939e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/571625
[33m[INFO] loading file 27-27/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (511755, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (511755, 17)

[INFO] analyzing data
[INFO] 511755 rows
[INFO] ** appi_name:[21:99.99941%,30:0.00059%]
[INFO] ** classification:[normal:64.35814%,Single Stage Single Point:35.64186%]
[INFO] ** dst:[21:43.2879%,10:21.06848%,8:18.17413%,9:17.46793%,22:0.00078%,15:0.00059%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name:[2:99.99941%,3:0.00059%]
[INFO] ** modbus_function_code:[0.02961:99.99941%,-33.760870000000004:0.00059%]
[INFO] ** modbus_function_description:[7:50.00029%,11:49.99912%,0:0.00059%]
[INFO] ** modbus_transaction_id:65536 (12.80613%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99941%,1:0.00059%]
[INFO] ** proxy_src_ip:[18:38.42346%,20:25.9335%,13:18.17393%,6:17.46812%,17:0.00059%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.93292%,-0.32151:21.06848%,-1.27613:18.17374%,-0.23351:17.46773%,-0.33484:17.35498%,-71.33197:0.00059%,-1.02014:0.00039%,-1.27347:0.0002%,1.45709:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-0.24151:0.0002%]
[INFO] ** scada_tag:[3:25.93253%,1:21.06828%,5:18.17354%,4:17.46754%,2:17.35479%,0:0.00332%]
[INFO] ** service:[0.0048200000000000005:99.99941%,-211.73542999999998:0.00059%]
[INFO] ** src:[22:38.42346%,9:25.9335%,7:18.17393%,1:17.46812%,14:0.00059%,15:0.00039%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1390 (0.27161%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/511755
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0677 - tp: 79051.0000 - fp: 949.0000 - tn: 319051.0000 - fn: 949.0000 - accuracy: 0.9953 - precision: 0.9881 - recall: 0.9881 - auc: 0.9930 - val_loss: 8.3654e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/511755
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0644 - tp: 79064.0000 - fp: 936.0000 - tn: 319064.0000 - fn: 936.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9925 - val_loss: 0.0014 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/511755
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0604 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9981 - val_loss: 4.6301e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/511755
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0565 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9998 - val_loss: 3.8364e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/511755
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0576 - tp: 79085.0000 - fp: 915.0000 - tn: 319085.0000 - fn: 915.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9998 - val_loss: 2.9112e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-26-27-batch-400000-500000
[INFO] processing batch 500000-600000/511755
[33m[INFO] loading file 28-28/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (345671, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (345671, 17)

[INFO] analyzing data
[INFO] 345671 rows
[INFO] ** appi_name:[21:99.99161%,30:0.00174%,17:0.00145%,22:0.00116%,7:0.00116%,31:0.00087%,26:0.00087%,28:0.00029%,27:0.00029%,8:0.00029%,0:0.00029%]
[INFO] ** classification:[normal:64.3071%,Single Stage Single Point:35.6929%]
[INFO] ** dst:[21:43.2822%,10:21.01652%,8:18.20401%,9:17.48859%,6:0.00231%,16:0.00203%,18:0.00145%,17:0.00058%,15:0.00058%,2:0.00058%,25:0.00029%,22:0.00029%,7:0.00029%,0:0.00029%]
[INFO] ** i/f_dir:[1:99.99942%,0:0.00058%]
[INFO] ** i/f_name:[2:99.99942%,3:0.00058%]
[INFO] ** modbus_function_code:[0.02961:99.99161%,-33.760870000000004:0.00839%]
[INFO] ** modbus_function_description:[11:49.99581%,7:49.99581%,0:0.00839%]
[INFO] ** modbus_transaction_id:65535 (18.95878%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99508%,2:0.00434%,1:0.00058%]
[INFO] ** proxy_src_ip:[18:38.33501%,20:25.96371%,13:18.2043%,6:17.48859%,1:0.00231%,17:0.00174%,14:0.00174%,7:0.00145%,21:0.00087%,0:0.00029%]
[INFO] ** s_port:[1.45442:25.96342%,-0.32151:21.01652%,-1.27613:18.20401%,-0.23351:17.48831%,-0.33484:17.31849%,-71.14798:0.00116%,-71.14931:0.00116%,-71.33197:0.00058%,-0.08551:0.00058%,7.66617:0.00029%,-58.035180000000004:0.00029%,-1.2708:0.00029%,-64.19493:0.00029%,-5.1466400000000005:0.00029%,13.431270000000001:0.00029%,-0.24151:0.00029%,11.57001:0.00029%,14.4699:0.00029%,1.47576:0.00029%,14.191239999999999:0.00029%,-5.08665:0.00029%,10.192739999999999:0.00029%,-3.3787199999999995:0.00029%,6.1115699999999995:0.00029%,2.05573:0.00029%,-43.76509:0.00029%,2.52505:0.00029%,11.862:0.00029%,-58.032509999999995:0.00029%]
[INFO] ** scada_tag:[3:25.96342%,1:21.01652%,5:18.20401%,4:17.48802%,2:17.31849%,0:0.00955%]
[INFO] ** service:[0.0048200000000000005:99.99161%,-205.44247:0.00145%,-186.43601999999998:0.00145%,-211.09762999999998:0.00116%,-211.08346:0.00116%,-211.08818:0.00116%,-211.73542999999998:0.00058%,-186.44547:0.00029%,-183.8612:0.00029%,-185.9872:0.00029%,-211.35747999999998:0.00029%,-202.75898:0.00029%]
[INFO] ** src:[22:38.33501%,9:25.96371%,7:18.2043%,1:17.48859%,3:0.0026%,2:0.00174%,21:0.00145%,4:0.00116%,14:0.00058%,8:0.00058%,17:0.00029%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:940 (0.27193%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/345671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0526 - tp: 79136.0000 - fp: 864.0000 - tn: 319136.0000 - fn: 864.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9998 - val_loss: 2.2625e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/345671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0508 - tp: 79131.0000 - fp: 869.0000 - tn: 319131.0000 - fn: 869.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9998 - val_loss: 1.8777e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/345671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0504 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.5599e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/345671
[33m[INFO] loading file 29-29/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (545671, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (545671, 17)

[INFO] analyzing data
[INFO] 545671 rows
[INFO] ** appi_name:[21:99.99872%,30:0.00055%,31:0.00018%,26:0.00018%,9:0.00018%,3:0.00018%]
[INFO] ** classification:[normal:64.39228%,Single Stage Single Point:35.60772%]
[INFO] ** dst:[21:43.32922%,10:21.06159%,8:18.14427%,9:17.46309%,22:0.00055%,15:0.00055%,24:0.00018%,18:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99945%,3:0.00055%]
[INFO] ** modbus_function_code:[0.02961:99.99872%,-33.760870000000004:0.00128%]
[INFO] ** modbus_function_description:[7:49.99973%,11:49.99899%,0:0.00128%]
[INFO] ** modbus_transaction_id:65536 (12.01017%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99908%,1:0.00055%,2:0.00037%]
[INFO] ** proxy_src_ip:[18:38.438%,20:25.953%,13:18.14463%,6:17.4629%,17:0.00055%,21:0.00018%,16:0.00018%,7:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95245%,-0.32151:21.06141%,-1.27613:18.14427%,-0.23351:17.4629%,-0.33484:17.37659%,-71.33197:0.00055%,1.45709:0.00037%,-71.14798:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,6.1115699999999995:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.95208%,1:21.06123%,5:18.14427%,4:17.46254%,2:17.37659%,0:0.0033%]
[INFO] ** service:[0.0048200000000000005:99.9989%,-211.73542999999998:0.00055%,-183.8612:0.00018%,-211.08346:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.438%,9:25.953%,7:18.14463%,1:17.4629%,14:0.00055%,21:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1482 (0.27159%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0449 - tp: 79154.0000 - fp: 846.0000 - tn: 319154.0000 - fn: 846.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.7303e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0430 - tp: 79146.0000 - fp: 854.0000 - tn: 319146.0000 - fn: 854.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 9.2475e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0437 - tp: 79074.0000 - fp: 926.0000 - tn: 319074.0000 - fn: 926.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 6.0507e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0393 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 3.6239e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0368 - tp: 79085.0000 - fp: 915.0000 - tn: 319085.0000 - fn: 915.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 2.1429e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/545671
[33m[INFO] loading file 30-30/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (545671, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (545671, 17)

[INFO] analyzing data
[INFO] 545671 rows
[INFO] ** appi_name:[21:99.99743%,30:0.00183%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.36809%,Single Stage Single Point:35.63191%]
[INFO] ** dst:[21:43.33564%,10:21.02934%,8:18.14738%,9:17.48416%,15:0.00183%,22:0.00073%,24:0.00037%,25:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99835%,0:0.00165%]
[INFO] ** i/f_name:[2:99.99817%,3:0.00183%]
[INFO] ** modbus_function_code:[0.02961:99.99743%,-33.760870000000004:0.00257%]
[INFO] ** modbus_function_description:[7:49.99973%,11:49.99771%,0:0.00257%]
[INFO] ** modbus_transaction_id:65536 (12.01017%)
[INFO] ** orig:[0:99.99908%,2:0.00055%,1:0.00037%]
[INFO] ** proto:[0:99.9978%,1:0.00183%,2:0.00037%]
[INFO] ** proxy_src_ip:[18:38.36799%,20:25.9968%,13:18.14775%,6:17.48471%,17:0.00183%,7:0.00037%,16:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.99662%,-0.32151:21.02915%,-1.27613:18.1472%,-0.23351:17.48398%,-0.33484:17.33884%,-71.33197:0.00183%,-0.24151:0.00055%,-1.27347:0.00037%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.99625%,1:21.02915%,5:18.14702%,4:17.4838%,2:17.33865%,0:0.00513%]
[INFO] ** service:[0.0048200000000000005:99.99762%,-211.73542999999998:0.00183%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.36799%,9:25.9968%,7:18.14775%,1:17.48471%,14:0.00128%,21:0.00092%,16:0.00018%,15:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99908%,1:0.00092%]
[INFO] ** unixtime:1483 (0.27178%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0352 - tp: 79045.0000 - fp: 955.0000 - tn: 319045.0000 - fn: 955.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9999 - val_loss: 8.3254e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0295 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 8.0322e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0283 - tp: 79080.0000 - fp: 920.0000 - tn: 319080.0000 - fn: 920.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 3.3980e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0262 - tp: 79080.0000 - fp: 920.0000 - tn: 319080.0000 - fn: 920.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 2.1364e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0235 - tp: 79131.0000 - fp: 869.0000 - tn: 319131.0000 - fn: 869.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 7.1535e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/545671
[33m[INFO] loading file 31-31/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (545671, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (545671, 17)

[INFO] analyzing data
[INFO] 545671 rows
[INFO] ** appi_name:[21:99.99963%,26:0.00018%,17:0.00018%]
[INFO] ** classification:[normal:64.37304%,Single Stage Single Point:35.62696%]
[INFO] ** dst:[21:43.31749%,10:21.05408%,8:18.12631%,9:17.50047%,22:0.00092%,24:0.00037%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99963%,-33.760870000000004:0.00037%]
[INFO] ** modbus_function_description:[7:49.99991%,11:49.99973%,0:0.00037%]
[INFO] ** modbus_transaction_id:65536 (12.01017%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.39511%,20:25.97719%,13:18.12649%,6:17.50047%,16:0.00037%,7:0.00037%]
[INFO] ** s_port:[1.45442:25.97646%,-0.32151:21.05408%,-1.27613:18.12612%,-0.23351:17.50029%,-0.33484:17.34104%,-1.27347:0.00037%,1.45709:0.00037%,-1.02014:0.00037%,-71.14798:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,10.192739999999999:0.00018%]
[INFO] ** scada_tag:[3:25.97609%,1:21.0539%,5:18.12594%,4:17.50011%,2:17.34085%,0:0.00312%]
[INFO] ** service:[0.0048200000000000005:99.99963%,-211.08346:0.00018%,-205.44247:0.00018%]
[INFO] ** src:[22:38.39511%,9:25.97719%,7:18.12649%,1:17.50047%,21:0.00037%,15:0.00037%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1483 (0.27178%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0227 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1301e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 2.4625e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.5838e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79079.0000 - fp: 921.0000 - tn: 319079.0000 - fn: 921.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 7.1772e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.2165e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/545671
[33m[INFO] loading file 32-32/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (545671, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (545671, 17)

[INFO] analyzing data
[INFO] 545671 rows
[INFO] ** appi_name:[21:99.99633%,30:0.00312%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.3767%,Single Stage Single Point:35.6233%]
[INFO] ** dst:[21:43.32134%,10:21.0506%,8:18.16094%,9:17.46235%,15:0.00312%,22:0.00092%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99725%,0:0.00275%]
[INFO] ** i/f_name:[2:99.99688%,3:0.00312%]
[INFO] ** modbus_function_code:[0.02961:99.99633%,-33.760870000000004:0.00367%]
[INFO] ** modbus_function_description:[7:49.99918%,11:49.99716%,0:0.00367%]
[INFO] ** modbus_transaction_id:65536 (12.01017%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99633%,1:0.00312%,2:0.00055%]
[INFO] ** proxy_src_ip:[18:38.41509%,20:25.95722%,13:18.16094%,6:17.4629%,17:0.00312%,14:0.00055%,16:0.00018%]
[INFO] ** s_port:[1.45442:25.95667%,-0.32151:21.0506%,-1.27613:18.16058%,-0.23351:17.46217%,-0.33484:17.36449%,-71.33197:0.00312%,-0.24151:0.00055%,-1.2708:0.00018%,-1.02014:0.00018%,13.431270000000001:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,1.45709:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:25.9563%,1:21.05041%,5:18.16058%,4:17.4618%,2:17.36449%,0:0.00641%]
[INFO] ** service:[0.0048200000000000005:99.99633%,-211.73542999999998:0.00312%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.41509%,9:25.95722%,7:18.16094%,1:17.4629%,14:0.00312%,2:0.00055%,15:0.00018%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1481 (0.27141%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1963e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1964e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79146.0000 - fp: 854.0000 - tn: 319146.0000 - fn: 854.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1929e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79074.0000 - fp: 926.0000 - tn: 319074.0000 - fn: 926.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.0901e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79091.0000 - fp: 909.0000 - tn: 319091.0000 - fn: 909.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/545671
[33m[INFO] loading file 33-33/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (545671, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (545671, 17)

[INFO] analyzing data
[INFO] 545671 rows
[INFO] ** appi_name:[21:99.99688%,30:0.0011%,17:0.00073%,22:0.00055%,31:0.00018%,28:0.00018%,26:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.39448%,Single Stage Single Point:35.60552%]
[INFO] ** dst:[21:43.32831%,10:21.06123%,8:18.12044%,9:17.48508%,22:0.00147%,15:0.0011%,16:0.00073%,6:0.00073%,24:0.00037%,17:0.00037%,18:0.00018%]
[INFO] ** i/f_dir:[1:99.9989%,0:0.0011%]
[INFO] ** i/f_name:[2:99.9989%,3:0.0011%]
[INFO] ** modbus_function_code:[0.02961:99.99688%,-33.760870000000004:0.00312%]
[INFO] ** modbus_function_description:[7:49.99954%,11:49.99734%,0:0.00312%]
[INFO] ** modbus_transaction_id:65536 (12.01017%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99798%,1:0.0011%,2:0.00092%]
[INFO] ** proxy_src_ip:[18:38.4226%,20:25.96785%,13:18.12044%,6:17.48526%,17:0.0011%,16:0.00073%,1:0.00073%,21:0.00037%,14:0.00037%,7:0.00037%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.96693%,-0.32151:21.06123%,-1.27613:18.12008%,-0.23351:17.48489%,-0.33484:17.36138%,-71.33197:0.0011%,-1.02014:0.00073%,1.45709:0.00055%,-71.14931:0.00055%,-1.27347:0.00037%,-5.08665:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,-43.76509:0.00018%,-71.14798:0.00018%,-58.032509999999995:0.00018%,-58.035180000000004:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:25.96656%,1:21.06123%,5:18.11989%,4:17.48471%,2:17.36138%,0:0.00623%]
[INFO] ** service:[0.0048200000000000005:99.99688%,-211.73542999999998:0.0011%,-205.44247:0.00073%,-211.08818:0.00055%,-211.09762999999998:0.00018%,-211.08346:0.00018%,-185.9872:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.4226%,9:25.96785%,7:18.12044%,1:17.48526%,14:0.0011%,15:0.00073%,3:0.00073%,21:0.00037%,4:0.00037%,2:0.00037%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1484 (0.27196%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79086.0000 - fp: 914.0000 - tn: 319086.0000 - fn: 914.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79154.0000 - fp: 846.0000 - tn: 319154.0000 - fn: 846.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.9322e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79123.0000 - fp: 877.0000 - tn: 319123.0000 - fn: 877.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/545671
[33m[INFO] loading file 34-34/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (387104, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (387104, 17)

[INFO] analyzing data
[INFO] 387104 rows
[INFO] ** appi_name:[21:99.99742%,30:0.00077%,7:0.00077%,31:0.00026%,22:0.00026%,8:0.00026%,6:0.00026%]
[INFO] ** classification:[normal:64.34369%,Single Stage Single Point:35.65631%]
[INFO] ** dst:[21:43.28553%,10:21.05507%,8:18.19718%,9:17.45913%,22:0.00077%,15:0.00077%,16:0.00052%,2:0.00052%,18:0.00026%,6:0.00026%]
[INFO] ** i/f_dir:[1:99.99923%,0:0.00077%]
[INFO] ** i/f_name:[2:99.99923%,3:0.00077%]
[INFO] ** modbus_function_code:[0.02961:99.99742%,-33.760870000000004:0.00258%]
[INFO] ** modbus_function_description:[7:49.99923%,11:49.99819%,0:0.00258%]
[INFO] ** modbus_transaction_id:65536 (16.92982%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99871%,1:0.00077%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.38968%,20:25.95091%,13:18.19718%,6:17.45965%,17:0.00077%,1:0.00077%,21:0.00052%,14:0.00026%,7:0.00026%]
[INFO] ** s_port:[1.45442:25.95065%,-0.32151:21.05481%,-1.27613:18.19718%,-0.23351:17.45887%,-0.33484:17.33488%,-0.24151:0.00077%,-71.33197:0.00077%,-3.0613900000000003:0.00026%,-3.3787199999999995:0.00026%,14.191239999999999:0.00026%,1.47576:0.00026%,11.57001:0.00026%,-49.275529999999996:0.00026%,-71.14931:0.00026%,7.66617:0.00026%]
[INFO] ** scada_tag:[3:25.95039%,1:21.05455%,5:18.19692%,4:17.45836%,2:17.33488%,0:0.00491%]
[INFO] ** service:[0.0048200000000000005:99.99768%,-211.09762999999998:0.00077%,-211.73542999999998:0.00077%,-186.43601999999998:0.00026%,-211.35747999999998:0.00026%,-211.08818:0.00026%]
[INFO] ** src:[22:38.38968%,9:25.95091%,7:18.19718%,1:17.45965%,14:0.00077%,3:0.00077%,4:0.00052%,21:0.00026%,2:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1051 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/387104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79123.0000 - fp: 877.0000 - tn: 319123.0000 - fn: 877.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/387104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/387104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.4134e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/387104
[33m[INFO] loading file 35-35/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587104, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587104, 17)

[INFO] analyzing data
[INFO] 587104 rows
[INFO] ** appi_name:[21:99.99898%,30:0.00102%]
[INFO] ** classification:[normal:64.3627%,Single Stage Single Point:35.6373%]
[INFO] ** dst:[21:43.32231%,10:21.03784%,8:18.16424%,9:17.47339%,22:0.00119%,15:0.00102%]
[INFO] ** i/f_dir:[1:99.99915%,0:0.00085%]
[INFO] ** i/f_name:[2:99.99898%,3:0.00102%]
[INFO] ** modbus_function_code:[0.02961:99.99898%,-33.760870000000004:0.00102%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99881%,0:0.00102%]
[INFO] ** modbus_transaction_id:65536 (11.16259%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99898%,1:0.00102%]
[INFO] ** proxy_src_ip:[18:38.39354%,20:25.96712%,13:18.1639%,6:17.47374%,17:0.00102%,16:0.00068%]
[INFO] ** s_port:[1.45442:25.96661%,-0.32151:21.03784%,-1.27613:18.1639%,-0.23351:17.47322%,-0.33484:17.3557%,-71.33197:0.00102%,-1.02014:0.00068%,-0.24151:0.00034%,1.45709:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.96627%,1:21.03784%,5:18.16373%,4:17.47288%,2:17.3557%,0:0.00358%]
[INFO] ** service:[0.0048200000000000005:99.99898%,-211.73542999999998:0.00102%]
[INFO] ** src:[22:38.39354%,9:25.96712%,7:18.1639%,1:17.47374%,14:0.00102%,15:0.00068%]
[INFO] ** type:[0:99.99915%,1:0.00085%]
[INFO] ** unixtime:1594 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79119.0000 - fp: 881.0000 - tn: 319119.0000 - fn: 881.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1991e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79149.0000 - fp: 851.0000 - tn: 319149.0000 - fn: 851.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/587104
[33m[INFO] loading file 36-36/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587104, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587104, 17)

[INFO] analyzing data
[INFO] 587104 rows
[INFO] ** appi_name:[21:99.99864%,30:0.00068%,31:0.00034%,33:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.36185%,Single Stage Single Point:35.63815%]
[INFO] ** dst:[21:43.32895%,10:21.03069%,8:18.15113%,9:17.48685%,22:0.00085%,15:0.00068%,24:0.00034%,18:0.00034%,25:0.00017%]
[INFO] ** i/f_dir:[1:99.99932%,0:0.00068%]
[INFO] ** i/f_name:[2:99.99932%,3:0.00068%]
[INFO] ** modbus_function_code:[0.02961:99.99864%,-33.760870000000004:0.00136%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99847%,0:0.00136%]
[INFO] ** modbus_transaction_id:65536 (11.16259%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99881%,1:0.00068%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.38162%,20:25.97819%,13:18.1513%,6:17.48736%,17:0.00068%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.97768%,-0.32151:21.03052%,-1.27613:18.15079%,-0.23351:17.48668%,-0.33484:17.3511%,-71.33197:0.00068%,-0.24151:0.00051%,-0.08551:0.00034%,-1.27347:0.00034%,1.45709:0.00017%,1.47576:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,-64.19493:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.97734%,1:21.03035%,5:18.15062%,4:17.48651%,2:17.35093%,0:0.00426%]
[INFO] ** service:[0.0048200000000000005:99.99881%,-211.73542999999998:0.00068%,-186.43601999999998:0.00034%,-186.44547:0.00017%]
[INFO] ** src:[22:38.38162%,9:25.97819%,7:18.1513%,1:17.48736%,14:0.00068%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1594 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79136.0000 - fp: 864.0000 - tn: 319136.0000 - fn: 864.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.2826e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/587104
[33m[INFO] loading file 37-37/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587104, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587104, 17)

[INFO] analyzing data
[INFO] 587104 rows
[INFO] ** appi_name:[21:99.99881%,30:0.00068%,33:0.00017%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:64.37974%,Single Stage Single Point:35.62026%]
[INFO] ** dst:[21:43.33968%,10:21.03818%,8:18.13733%,9:17.48293%,22:0.00068%,15:0.00068%,24:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99932%,3:0.00068%]
[INFO] ** modbus_function_code:[0.02961:99.99881%,-33.760870000000004:0.00119%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99881%,0:0.00119%]
[INFO] ** modbus_transaction_id:65536 (11.16259%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99915%,1:0.00068%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.3869%,20:25.99114%,13:18.13733%,6:17.4831%,17:0.00068%,21:0.00034%,16:0.00034%,1:0.00017%]
[INFO] ** s_port:[1.45442:25.99063%,-0.32151:21.03801%,-1.27613:18.13699%,-0.23351:17.48276%,-0.33484:17.34889%,-71.33197:0.00068%,-1.02014:0.00034%,1.46509:0.00017%,1.47576:0.00017%,-1.27347:0.00017%,-49.275529999999996:0.00017%,-0.24950999999999998:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,1.45709:0.00017%,14.4699:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:25.99045%,1:21.03801%,5:18.13682%,4:17.48259%,2:17.34872%,0:0.00341%]
[INFO] ** service:[0.0048200000000000005:99.99898%,-211.73542999999998:0.00068%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.3869%,9:25.99114%,7:18.13733%,1:17.4831%,14:0.00068%,15:0.00034%,4:0.00034%,3:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1595 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79042.0000 - fp: 958.0000 - tn: 319042.0000 - fn: 958.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79151.0000 - fp: 849.0000 - tn: 319151.0000 - fn: 849.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.2820e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79123.0000 - fp: 877.0000 - tn: 319123.0000 - fn: 877.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/587104
[33m[INFO] loading file 38-38/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587104, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587104, 17)

[INFO] analyzing data
[INFO] 587104 rows
[INFO] ** appi_name:[21:99.99898%,30:0.00034%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.4075%,Single Stage Single Point:35.5925%]
[INFO] ** dst:[21:43.3206%,10:21.08485%,8:18.09782%,9:17.49486%,22:0.00085%,15:0.00034%,25:0.00017%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.99966%,3:0.00034%]
[INFO] ** modbus_function_code:[0.02961:99.99898%,-33.760870000000004:0.00102%]
[INFO] ** modbus_function_description:[7:49.99966%,11:49.99932%,0:0.00102%]
[INFO] ** modbus_transaction_id:65536 (11.16259%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99932%,2:0.00034%,1:0.00034%]
[INFO] ** proxy_src_ip:[18:38.44549%,20:25.96065%,13:18.09765%,6:17.49503%,17:0.00034%,7:0.00034%,16:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.9598%,-0.32151:21.08468%,-1.27613:18.09748%,-0.23351:17.49452%,-0.33484:17.36081%,1.47576:0.00034%,-0.24151:0.00034%,-71.33197:0.00034%,1.45709:0.00034%,-1.27347:0.00017%,1.46509:0.00017%,-61.95768:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:25.95946%,1:21.08468%,5:18.09748%,4:17.49435%,2:17.36064%,0:0.00341%]
[INFO] ** service:[0.0048200000000000005:99.99915%,-211.73542999999998:0.00034%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.44549%,9:25.96065%,7:18.09765%,1:17.49503%,21:0.00034%,14:0.00034%,16:0.00017%,15:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1595 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79079.0000 - fp: 921.0000 - tn: 319079.0000 - fn: 921.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79059.0000 - fp: 941.0000 - tn: 319059.0000 - fn: 941.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/587104
[33m[INFO] loading file 39-39/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587104, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587104, 17)

[INFO] analyzing data
[INFO] 587104 rows
[INFO] ** appi_name:[21:99.99966%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.39643%,Single Stage Single Point:35.60357%]
[INFO] ** dst:[21:43.31379%,10:21.08144%,8:18.13818%,9:17.46522%,22:0.00085%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99966%,-33.760870000000004:0.00034%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99966%,0:0.00034%]
[INFO] ** modbus_transaction_id:65536 (11.16259%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.4431%,20:25.95247%,13:18.13835%,6:17.46522%,16:0.00051%,7:0.00034%]
[INFO] ** s_port:[1.45442:25.95196%,-0.32151:21.08144%,-1.27613:18.13801%,-0.23351:17.46505%,-0.33484:17.36166%,-1.02014:0.00051%,-71.14798:0.00017%,-1.27347:0.00017%,1.45709:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.95162%,1:21.08127%,5:18.13784%,4:17.46505%,2:17.36149%,0:0.00273%]
[INFO] ** service:[0.0048200000000000005:99.99966%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.4431%,9:25.95247%,7:18.13835%,1:17.46522%,15:0.00051%,21:0.00034%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1593 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79068.0000 - fp: 932.0000 - tn: 319068.0000 - fn: 932.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-9-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79178.0000 - fp: 822.0000 - tn: 319178.0000 - fn: 822.0000 - accuracy: 0.9959 - precision: 0.9897 - recall: 0.9897 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/587104
[33m[INFO] loading file 40-40/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587104, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587104, 17)

[INFO] analyzing data
[INFO] 587104 rows
[INFO] ** appi_name:[21:99.99659%,30:0.0029%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.33937%,Single Stage Single Point:35.66063%]
[INFO] ** dst:[21:43.29488%,10:21.03988%,8:18.19558%,9:17.46522%,15:0.0029%,22:0.00085%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99727%,0:0.00273%]
[INFO] ** i/f_name:[2:99.9971%,3:0.0029%]
[INFO] ** modbus_function_code:[0.02961:99.99659%,-33.760870000000004:0.00341%]
[INFO] ** modbus_function_description:[7:49.99932%,11:49.99727%,0:0.00341%]
[INFO] ** modbus_transaction_id:65536 (11.16259%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99659%,1:0.0029%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.35947%,20:25.97615%,13:18.19541%,6:17.46556%,17:0.0029%,14:0.00051%]
[INFO] ** s_port:[1.45442:25.9753%,-0.32151:21.03988%,-1.27613:18.19524%,-0.23351:17.46505%,-0.33484:17.31959%,-71.33197:0.0029%,1.45709:0.00051%,-0.24151:0.00034%,-71.14798:0.00017%,-1.27347:0.00017%,11.862:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%,13.431270000000001:0.00017%]
[INFO] ** scada_tag:[3:25.97496%,1:21.03971%,5:18.19507%,4:17.46471%,2:17.31942%,0:0.00613%]
[INFO] ** service:[0.0048200000000000005:99.99659%,-211.73542999999998:0.0029%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.35947%,9:25.97615%,7:18.19541%,1:17.46556%,14:0.0029%,2:0.00051%]
[INFO] ** type:[0:99.99915%,1:0.00085%]
[INFO] ** unixtime:1596 (0.27184%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79128.0000 - fp: 872.0000 - tn: 319128.0000 - fn: 872.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/587104
[33m[INFO] loading file 41-41/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (527262, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (527262, 17)

[INFO] analyzing data
[INFO] 527262 rows
[INFO] ** appi_name:[21:99.99678%,30:0.00095%,22:0.00076%,17:0.00076%,32:0.00019%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.38526%,Single Stage Single Point:35.61474%]
[INFO] ** dst:[21:43.32343%,10:21.05784%,8:18.14639%,9:17.46817%,16:0.00095%,15:0.00095%,6:0.00095%,22:0.00057%,24:0.00038%,17:0.00038%]
[INFO] ** i/f_dir:[1:99.99905%,0:0.00095%]
[INFO] ** i/f_name:[2:99.99905%,3:0.00095%]
[INFO] ** modbus_function_code:[0.02961:99.99678%,-33.760870000000004:0.00322%]
[INFO] ** modbus_function_description:[7:49.99905%,11:49.99772%,0:0.00322%]
[INFO] ** modbus_transaction_id:65536 (12.42949%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99791%,2:0.00114%,1:0.00095%]
[INFO] ** proxy_src_ip:[18:38.42701%,20:25.95446%,13:18.14658%,6:17.46836%,17:0.00095%,1:0.00076%,21:0.00038%,16:0.00038%,14:0.00038%,0:0.00038%,7:0.00019%,2:0.00019%]
[INFO] ** s_port:[1.45442:25.95408%,-0.32151:21.05784%,-1.27613:18.14601%,-0.23351:17.46798%,-0.33484:17.36916%,-71.33197:0.00095%,-71.14931:0.00076%,-1.27347:0.00038%,-1.02014:0.00038%,-0.24151:0.00019%,-5.1466400000000005:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,1.46509:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,-5.08665:0.00019%,-64.19226:0.00019%,-0.24950999999999998:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:25.95389%,1:21.05784%,5:18.14601%,4:17.46779%,2:17.36897%,0:0.0055%]
[INFO] ** service:[0.0048200000000000005:99.99678%,-211.73542999999998:0.00095%,-205.44247:0.00076%,-211.08818:0.00076%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%,89.64175:0.00019%]
[INFO] ** src:[22:38.42701%,9:25.95446%,7:18.14658%,1:17.46836%,14:0.00095%,3:0.00076%,15:0.00038%,8:0.00038%,4:0.00038%,2:0.00038%,21:0.00019%,17:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1430 (0.27121%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/527262
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0370 - tp: 78962.0000 - fp: 1038.0000 - tn: 318962.0000 - fn: 1038.0000 - accuracy: 0.9948 - precision: 0.9870 - recall: 0.9870 - auc: 0.9992 - val_loss: 0.2537 - val_tp: 19626.0000 - val_fp: 374.0000 - val_tn: 79626.0000 - val_fn: 374.0000 - val_accuracy: 0.9925 - val_precision: 0.9813 - val_recall: 0.9813 - val_auc: 0.9899
[INFO] saving weights to checkpoints/lstm-epoch-9-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/527262
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0266 - tp: 79086.0000 - fp: 914.0000 - tn: 319086.0000 - fn: 914.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9996 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/527262
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/527262
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 3.4842e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/527262
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79067.0000 - fp: 933.0000 - tn: 319067.0000 - fn: 933.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-40-41-batch-400000-500000
[INFO] processing batch 500000-600000/527262
[33m[INFO] loading file 42-42/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (370776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (370776, 17)

[INFO] analyzing data
[INFO] 370776 rows
[INFO] ** appi_name:[21:99.99083%,30:0.00243%,17:0.00135%,31:0.00108%,26:0.00108%,7:0.00108%,22:0.00081%,28:0.00027%,27:0.00027%,9:0.00027%,8:0.00027%,0:0.00027%]
[INFO] ** classification:[normal:64.3553%,Single Stage Single Point:35.6447%]
[INFO] ** dst:[21:43.30485%,10:21.04074%,8:18.19589%,9:17.44854%,16:0.00243%,6:0.00216%,18:0.00135%,2:0.00108%,22:0.00081%,15:0.00081%,17:0.00054%,25:0.00027%,7:0.00027%,0:0.00027%]
[INFO] ** i/f_dir:[1:99.99919%,0:0.00081%]
[INFO] ** i/f_name:[2:99.99919%,3:0.00081%]
[INFO] ** modbus_function_code:[0.02961:99.99083%,-33.760870000000004:0.00917%]
[INFO] ** modbus_function_description:[7:49.99595%,11:49.99488%,0:0.00917%]
[INFO] ** modbus_transaction_id:65536 (17.67536%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99515%,2:0.00405%,1:0.00081%]
[INFO] ** proxy_src_ip:[18:38.39461%,20:25.95125%,13:18.19616%,6:17.44854%,17:0.00243%,1:0.00243%,14:0.00162%,21:0.00108%,7:0.00081%,0:0.00054%,16:0.00027%,2:0.00027%]
[INFO] ** s_port:[1.45442:25.95071%,-0.32151:21.04074%,-1.27613:18.19589%,-0.23351:17.44827%,-0.33484:17.35387%,-71.14931:0.00108%,-71.14798:0.00108%,-71.33197:0.00081%,-3.3787199999999995:0.00054%,-0.08551:0.00054%,11.57001:0.00054%,13.431270000000001:0.00027%,-5.1466400000000005:0.00027%,0.31847:0.00027%,-1.02014:0.00027%,-64.19493:0.00027%,-1.2708:0.00027%,-58.035180000000004:0.00027%,7.66617:0.00027%,-0.24151:0.00027%,1.47576:0.00027%,14.4699:0.00027%,15.912510000000001:0.00027%,14.191239999999999:0.00027%,7.9608300000000005:0.00027%,-5.08665:0.00027%,10.192739999999999:0.00027%,-3.0613900000000003:0.00027%,1.45709:0.00027%,2.05573:0.00027%,-43.76509:0.00027%,11.862:0.00027%,-58.032509999999995:0.00027%]
[INFO] ** scada_tag:[3:25.95044%,1:21.04074%,5:18.19562%,4:17.44827%,2:17.3536%,0:0.01133%]
[INFO] ** service:[0.0048200000000000005:99.99083%,-211.09762999999998:0.00189%,-205.44247:0.00135%,-186.43601999999998:0.00135%,-211.08346:0.00108%,-211.08818:0.00108%,-211.73542999999998:0.00081%,-211.35747999999998:0.00054%,-186.44547:0.00027%,-183.8612:0.00027%,-185.9872:0.00027%,-202.75898:0.00027%]
[INFO] ** src:[22:38.39461%,9:25.95125%,7:18.19616%,1:17.44854%,3:0.00324%,2:0.00189%,4:0.00135%,21:0.00108%,14:0.00081%,8:0.00054%,17:0.00027%,15:0.00027%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1007 (0.27159%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/370776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79048.0000 - fp: 952.0000 - tn: 319048.0000 - fn: 952.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9999 - val_loss: 7.9740e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/370776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0214 - tp: 79036.0000 - fp: 964.0000 - tn: 319036.0000 - fn: 964.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/370776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/370776
[33m[INFO] loading file 43-43/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (570776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (570776, 17)

[INFO] analyzing data
[INFO] 570776 rows
[INFO] ** appi_name:[21:99.99877%,30:0.00053%,26:0.00035%,8:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.39847%,Single Stage Single Point:35.60153%]
[INFO] ** dst:[21:43.32523%,10:21.07096%,8:18.13005%,9:17.4713%,22:0.00105%,15:0.00053%,6:0.00035%,2:0.00035%,24:0.00018%]
[INFO] ** i/f_dir:[1:99.99982%,0:0.00018%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99877%,-33.760870000000004:0.00123%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99877%,0:0.00123%]
[INFO] ** modbus_transaction_id:65536 (11.48191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99912%,1:0.00053%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.42068%,20:25.97604%,13:18.13023%,6:17.47148%,17:0.00053%,1:0.00053%,16:0.00035%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.97534%,-0.32151:21.07096%,-1.27613:18.12988%,-0.23351:17.47095%,-0.33484:17.34971%,-71.33197:0.00053%,-71.14798:0.00035%,1.45709:0.00035%,1.47576:0.00035%,-0.24151:0.00035%,-1.02014:0.00035%,0.31847:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-1.2708:0.00018%,-3.3787199999999995:0.00018%]
[INFO] ** scada_tag:[3:25.97499%,1:21.07096%,5:18.1297%,4:17.4706%,2:17.34954%,0:0.0042%]
[INFO] ** service:[0.0048200000000000005:99.99877%,-211.73542999999998:0.00053%,-211.08346:0.00035%,-211.09762999999998:0.00018%,-211.35747999999998:0.00018%]
[INFO] ** src:[22:38.42068%,9:25.97604%,7:18.13023%,1:17.47148%,14:0.00053%,3:0.00053%,15:0.00035%,21:0.00018%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1552 (0.27191%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79148.0000 - fp: 852.0000 - tn: 319148.0000 - fn: 852.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79057.0000 - fp: 943.0000 - tn: 319057.0000 - fn: 943.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1926e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/570776
[33m[INFO] loading file 44-44/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (570776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (570776, 17)

[INFO] analyzing data
[INFO] 570776 rows
[INFO] ** appi_name:[21:99.99825%,30:0.0007%,31:0.00053%,0:0.00035%,22:0.00018%]
[INFO] ** classification:[normal:64.39461%,Single Stage Single Point:35.60539%]
[INFO] ** dst:[21:43.33679%,10:21.05484%,8:18.14915%,9:17.45606%,22:0.00105%,15:0.0007%,18:0.00053%,25:0.00035%,24:0.00035%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9993%,0:0.0007%]
[INFO] ** i/f_name:[2:99.9993%,3:0.0007%]
[INFO] ** modbus_function_code:[0.02961:99.99825%,-33.760870000000004:0.00175%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99825%,0:0.00175%]
[INFO] ** modbus_transaction_id:65536 (11.48191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99825%,2:0.00105%,1:0.0007%]
[INFO] ** proxy_src_ip:[18:38.43627%,20:25.95589%,13:18.14933%,6:17.45659%,17:0.0007%,7:0.00035%,16:0.00018%,5:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95519%,-0.32151:21.05484%,-1.27613:18.1488%,-0.23351:17.45588%,-0.33484:17.38142%,-71.33197:0.0007%,-0.24151:0.00053%,-0.08551:0.00035%,-64.19493:0.00035%,-1.27347:0.00035%,1.45709:0.00035%,-1.02014:0.00018%,-1.2708:0.00018%,1.47576:0.00018%,-71.14931:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,4.42897:0.00018%]
[INFO] ** scada_tag:[3:25.95467%,1:21.05484%,5:18.1488%,4:17.45553%,2:17.38125%,0:0.00491%]
[INFO] ** service:[0.0048200000000000005:99.99825%,-211.73542999999998:0.0007%,-186.43601999999998:0.00053%,-186.44547:0.00035%,-211.08818:0.00018%]
[INFO] ** src:[22:38.43627%,9:25.95589%,7:18.14933%,1:17.45659%,14:0.0007%,21:0.00035%,17:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1549 (0.27138%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 3.4624e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79130.0000 - fp: 870.0000 - tn: 319130.0000 - fn: 870.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0215 - tp: 79046.0000 - fp: 954.0000 - tn: 319046.0000 - fn: 954.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79058.0000 - fp: 942.0000 - tn: 319058.0000 - fn: 942.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/570776
[33m[INFO] loading file 45-45/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (570776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (570776, 17)

[INFO] analyzing data
[INFO] 570776 rows
[INFO] ** appi_name:[21:99.99877%,30:0.00053%,31:0.00035%,26:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:64.41389%,Single Stage Single Point:35.58611%]
[INFO] ** dst:[21:43.32295%,10:21.08813%,8:18.13023%,9:17.45606%,22:0.0014%,15:0.00053%,18:0.00035%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99965%,0:0.00035%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99877%,-33.760870000000004:0.00123%]
[INFO] ** modbus_function_description:[7:50.00035%,11:49.99842%,0:0.00123%]
[INFO] ** modbus_transaction_id:65536 (11.48191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99895%,2:0.00053%,1:0.00053%]
[INFO] ** proxy_src_ip:[18:38.48235%,20:25.92944%,13:18.13005%,6:17.45659%,17:0.00053%,16:0.00035%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.92874%,-0.32151:21.08813%,-1.27613:18.13005%,-0.23351:17.45588%,-0.33484:17.39421%,1.45709:0.00053%,-0.24151:0.00053%,-71.33197:0.00053%,-1.02014:0.00035%,-0.08551:0.00035%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.92821%,1:21.08796%,5:18.13005%,4:17.45588%,2:17.39404%,0:0.00385%]
[INFO] ** service:[0.0048200000000000005:99.99877%,-211.73542999999998:0.00053%,-186.43601999999998:0.00035%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.48235%,9:25.92944%,7:18.13005%,1:17.45659%,14:0.00053%,15:0.00035%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1549 (0.27138%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79109.0000 - fp: 891.0000 - tn: 319109.0000 - fn: 891.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0194 - tp: 79156.0000 - fp: 844.0000 - tn: 319156.0000 - fn: 844.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.2053e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79137.0000 - fp: 863.0000 - tn: 319137.0000 - fn: 863.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.2026e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/570776
[33m[INFO] loading file 46-46/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (570776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (570776, 17)

[INFO] analyzing data
[INFO] 570776 rows
[INFO] ** appi_name:[21:99.99825%,30:0.00105%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.42405%,Single Stage Single Point:35.57595%]
[INFO] ** dst:[21:43.348%,10:21.07342%,8:18.1036%,9:17.47235%,22:0.00105%,15:0.00105%,25:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99912%,0:0.00088%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99825%,-33.760870000000004:0.00175%]
[INFO] ** modbus_function_description:[11:49.99912%,7:49.99912%,0:0.00175%]
[INFO] ** modbus_transaction_id:65536 (11.48191%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.9986%,1:0.00105%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.44626%,20:25.97516%,13:18.1036%,6:17.47288%,17:0.00105%,16:0.00035%,7:0.00035%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.97481%,-0.32151:21.07324%,-1.27613:18.10342%,-0.23351:17.47218%,-0.33484:17.37301%,-71.33197:0.00105%,-0.24151:0.00053%,-1.02014:0.00035%,-71.14798:0.00018%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.97446%,1:21.07307%,5:18.10325%,4:17.47183%,2:17.37301%,0:0.00438%]
[INFO] ** service:[0.0048200000000000005:99.99842%,-211.73542999999998:0.00105%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.44626%,9:25.97516%,7:18.1036%,1:17.47288%,14:0.00105%,21:0.00035%,15:0.00035%,16:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99912%,1:0.00088%]
[INFO] ** unixtime:1552 (0.27191%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79144.0000 - fp: 856.0000 - tn: 319144.0000 - fn: 856.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79088.0000 - fp: 912.0000 - tn: 319088.0000 - fn: 912.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79089.0000 - fp: 911.0000 - tn: 319089.0000 - fn: 911.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/570776
[33m[INFO] loading file 47-47/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (570776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (570776, 17)

[INFO] analyzing data
[INFO] 570776 rows
[INFO] ** appi_name:[21:99.99947%,33:0.00018%,26:0.00018%,17:0.00018%]
[INFO] ** classification:[normal:64.39321%,Single Stage Single Point:35.60679%]
[INFO] ** dst:[21:43.30911%,10:21.08218%,8:18.13023%,9:17.47621%,22:0.00158%,24:0.00035%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99947%,-33.760870000000004:0.00053%]
[INFO] ** modbus_function_description:[7:50.00088%,11:49.9986%,0:0.00053%]
[INFO] ** modbus_transaction_id:65536 (11.48191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.45081%,20:25.94117%,13:18.13058%,6:17.47656%,16:0.00035%,7:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.9403%,-0.32151:21.08218%,-1.27613:18.13005%,-0.23351:17.47603%,-0.33484:17.36863%,1.45709:0.00053%,-0.24151:0.00053%,-1.27347:0.00035%,-1.02014:0.00035%,-71.14798:0.00018%,-61.95635:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%]
[INFO] ** scada_tag:[3:25.93977%,1:21.082%,5:18.12988%,4:17.47586%,2:17.36846%,0:0.00403%]
[INFO] ** service:[0.0048200000000000005:99.99965%,-211.08346:0.00018%,-205.44247:0.00018%]
[INFO] ** src:[22:38.45081%,9:25.94117%,7:18.13058%,1:17.47656%,21:0.00035%,15:0.00035%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1549 (0.27138%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79123.0000 - fp: 877.0000 - tn: 319123.0000 - fn: 877.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79165.0000 - fp: 835.0000 - tn: 319165.0000 - fn: 835.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79072.0000 - fp: 928.0000 - tn: 319072.0000 - fn: 928.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/570776
[33m[INFO] loading file 48-48/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (570776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (570776, 17)

[INFO] analyzing data
[INFO] 570776 rows
[INFO] ** appi_name:[21:99.99685%,30:0.00245%,33:0.00018%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.43246%,Single Stage Single Point:35.56754%]
[INFO] ** dst:[21:43.33364%,10:21.09497%,8:18.09974%,9:17.46762%,15:0.00245%,22:0.00088%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9979%,0:0.0021%]
[INFO] ** i/f_name:[2:99.99755%,3:0.00245%]
[INFO] ** modbus_function_code:[0.02961:99.99685%,-33.760870000000004:0.00315%]
[INFO] ** modbus_function_description:[7:49.99912%,11:49.99772%,0:0.00315%]
[INFO] ** modbus_transaction_id:65536 (11.48191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99702%,1:0.00245%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.47254%,20:25.95642%,13:18.09992%,6:17.46762%,17:0.00245%,14:0.00053%,16:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95589%,-0.32151:21.09497%,-1.27613:18.09957%,-0.23351:17.46745%,-0.33484:17.37757%,-71.33197:0.00245%,-1.02014:0.00035%,-1.2708:0.00018%,13.431270000000001:0.00018%,-0.24151:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-61.95635:0.00018%,1.45709:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:25.95554%,1:21.09479%,5:18.09957%,4:17.46745%,2:17.37739%,0:0.00526%]
[INFO] ** service:[0.0048200000000000005:99.99702%,-211.73542999999998:0.00245%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.47254%,9:25.95642%,7:18.09992%,1:17.46762%,14:0.00245%,2:0.00053%,15:0.00035%,8:0.00018%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1548 (0.27121%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0193 - tp: 79176.0000 - fp: 824.0000 - tn: 319176.0000 - fn: 824.0000 - accuracy: 0.9959 - precision: 0.9897 - recall: 0.9897 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 4.4363e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/570776
[33m[INFO] loading file 49-49/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (570776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (570776, 17)

[INFO] analyzing data
[INFO] 570776 rows
[INFO] ** appi_name:[21:99.99737%,30:0.00088%,17:0.0007%,26:0.00035%,22:0.00035%,28:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.37674%,Single Stage Single Point:35.62326%]
[INFO] ** dst:[21:43.31419%,10:21.05835%,8:18.13408%,9:17.489%,22:0.0014%,15:0.00088%,16:0.0007%,6:0.0007%,24:0.00035%,17:0.00035%]
[INFO] ** i/f_dir:[1:99.99912%,0:0.00088%]
[INFO] ** i/f_name:[2:99.99912%,3:0.00088%]
[INFO] ** modbus_function_code:[0.02961:99.99737%,-33.760870000000004:0.00263%]
[INFO] ** modbus_function_description:[7:49.99982%,11:49.99755%,0:0.00263%]
[INFO] ** modbus_transaction_id:65536 (11.48191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99842%,1:0.00088%,2:0.0007%]
[INFO] ** proxy_src_ip:[18:38.42208%,20:25.95116%,13:18.13426%,6:17.48952%,17:0.00088%,1:0.0007%,14:0.00053%,21:0.00035%,16:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95029%,-0.32151:21.05835%,-1.27613:18.13373%,-0.23351:17.48882%,-0.33484:17.36373%,-71.33197:0.00088%,1.45709:0.00053%,-0.24151:0.00053%,-1.27347:0.00035%,-71.14931:0.00035%,-1.02014:0.00035%,-71.14798:0.00035%,1.47576:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,1.46509:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,-5.08665:0.00018%,-0.24950999999999998:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:25.94993%,1:21.05817%,5:18.13356%,4:17.48847%,2:17.36373%,0:0.00613%]
[INFO] ** service:[0.0048200000000000005:99.99737%,-211.73542999999998:0.00088%,-205.44247:0.0007%,-211.08346:0.00035%,-211.08818:0.00035%,-211.09762999999998:0.00018%,-185.9872:0.00018%]
[INFO] ** src:[22:38.42208%,9:25.95116%,7:18.13426%,1:17.48952%,14:0.00088%,3:0.0007%,2:0.00053%,15:0.00035%,4:0.00035%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1550 (0.27156%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79091.0000 - fp: 909.0000 - tn: 319091.0000 - fn: 909.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.6063e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79167.0000 - fp: 833.0000 - tn: 319167.0000 - fn: 833.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79143.0000 - fp: 857.0000 - tn: 319143.0000 - fn: 857.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 8.0603e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/570776
[33m[INFO] loading file 50-50/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (420758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (420758, 17)

[INFO] analyzing data
[INFO] 420758 rows
[INFO] ** appi_name:[21:99.99739%,30:0.00119%,7:0.00071%,31:0.00024%,22:0.00024%,8:0.00024%]
[INFO] ** classification:[normal:64.30727%,Single Stage Single Point:35.69273%]
[INFO] ** dst:[21:43.25931%,10:21.04464%,8:18.21997%,9:17.47251%,15:0.00119%,22:0.00071%,16:0.00048%,2:0.00048%,24:0.00024%,18:0.00024%,6:0.00024%]
[INFO] ** i/f_dir:[1:99.99881%,0:0.00119%]
[INFO] ** i/f_name:[2:99.99881%,3:0.00119%]
[INFO] ** modbus_function_code:[0.02961:99.99739%,-33.760870000000004:0.00261%]
[INFO] ** modbus_function_description:[7:49.99881%,11:49.99857%,0:0.00261%]
[INFO] ** modbus_transaction_id:65536 (15.5757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99834%,1:0.00119%,2:0.00048%]
[INFO] ** proxy_src_ip:[18:38.36885%,20:25.93534%,13:18.22021%,6:17.47251%,17:0.00119%,1:0.00071%,16:0.00048%,21:0.00024%,14:0.00024%,7:0.00024%]
[INFO] ** s_port:[1.45442:25.93486%,-0.32151:21.04464%,-1.27613:18.21974%,-0.23351:17.47251%,-0.33484:17.32421%,-71.33197:0.00119%,-1.02014:0.00048%,-3.3787199999999995:0.00024%,4.33564:0.00024%,15.912510000000001:0.00024%,7.9608300000000005:0.00024%,1.46509:0.00024%,1.45709:0.00024%,-1.27347:0.00024%,-71.14931:0.00024%,-1.2708:0.00024%,0.31847:0.00024%]
[INFO] ** scada_tag:[3:25.93462%,1:21.0444%,5:18.2195%,4:17.47251%,2:17.32397%,0:0.00499%]
[INFO] ** service:[0.0048200000000000005:99.99739%,-211.73542999999998:0.00119%,-211.09762999999998:0.00071%,-186.43601999999998:0.00024%,-211.35747999999998:0.00024%,-211.08818:0.00024%]
[INFO] ** src:[22:38.36885%,9:25.93534%,7:18.22021%,1:17.47251%,14:0.00119%,3:0.00071%,15:0.00048%,21:0.00024%,4:0.00024%,2:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1143 (0.27165%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/420758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79064.0000 - fp: 936.0000 - tn: 319064.0000 - fn: 936.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.5671e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/420758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/420758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79128.0000 - fp: 872.0000 - tn: 319128.0000 - fn: 872.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/420758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79050.0000 - fp: 950.0000 - tn: 319050.0000 - fn: 950.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-49-50-batch-300000-400000
[INFO] processing batch 400000-500000/420758
[33m[INFO] epoch 10/10[0m
[33m[INFO] loading file 1-1/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99309%,30:0.00115%,22:0.00096%,17:0.00077%,31:0.00058%,26:0.00058%,7:0.00058%,23:0.00038%,18:0.00038%,0:0.00038%,28:0.00019%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:78.70162%,Single Stage Single Point:21.29838%]
[INFO] ** dst:[21:43.26482%,10:21.04471%,8:18.16852%,9:17.51466%,6:0.00154%,16:0.00115%,15:0.00115%,22:0.00096%,18:0.00058%,26:0.00038%,25:0.00038%,19:0.00038%,17:0.00038%,24:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99885%,0:0.00115%]
[INFO] ** i/f_name:[2:99.99885%,3:0.00115%]
[INFO] ** modbus_function_code:[0.02961:99.99309%,-33.760870000000004:0.00672%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.9975%,11:49.99558%,0:0.00672%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99616%,2:0.00269%,1:0.00115%]
[INFO] ** proxy_src_ip:[18:38.4044%,20:25.90455%,13:18.16871%,6:17.51505%,11:0.00134%,10:0.00134%,17:0.00115%,14:0.00096%,1:0.00096%,7:0.00058%,21:0.00038%,16:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.90416%,-0.32151:21.04394%,-1.27613:18.16832%,-0.23351:17.51447%,-0.33484:17.36046%,-71.33197:0.00115%,-71.14931:0.00096%,-2.1481:0.00077%,-0.24151:0.00058%,-71.14798:0.00058%,-2.42942:0.00038%,4.44364:0.00038%,-1.02014:0.00038%,-64.19493:0.00038%,-5.1466400000000005:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,4.076980000000001:0.00019%,-5.08665:0.00019%,1.47576:0.00019%,1.46509:0.00019%,4.29964:0.00019%,14.253910000000001:0.00019%,-68.79874000000001:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,10.67005:0.00019%,-1.27347:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.90397%,1:21.04375%,5:18.16794%,4:17.51428%,2:17.36027%,0:0.00979%]
[INFO] ** service:[0.0048200000000000005:99.99386%,-211.73542999999998:0.00115%,-211.08818:0.00096%,-205.44247:0.00077%,-211.07873999999998:0.00077%,-211.09762999999998:0.00058%,-211.08346:0.00058%,-186.43601999999998:0.00058%,-186.44547:0.00038%,-185.9872:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.4044%,9:25.90455%,7:18.16871%,1:17.51505%,11:0.00134%,10:0.00134%,14:0.00115%,3:0.00096%,2:0.00096%,21:0.00058%,15:0.00038%,4:0.00038%,8:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1413 (0.27134%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3456 - tp: 77913.0000 - fp: 2087.0000 - tn: 317913.0000 - fn: 2087.0000 - accuracy: 0.9896 - precision: 0.9739 - recall: 0.9739 - auc: 0.9860 - val_loss: 1.3922e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0083 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2003e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0058 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2089e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3813 - tp: 43975.0000 - fp: 36025.0000 - tn: 283975.0000 - fn: 36025.0000 - accuracy: 0.8199 - precision: 0.5497 - recall: 0.5497 - auc: 0.8948 - val_loss: 0.4409 - val_tp: 12725.0000 - val_fp: 7275.0000 - val_tn: 72725.0000 - val_fn: 7275.0000 - val_accuracy: 0.8545 - val_precision: 0.6363 - val_recall: 0.6363 - val_auc: 0.9514
[INFO] saving weights to checkpoints/lstm-epoch-10-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2693 - tp: 70638.0000 - fp: 9362.0000 - tn: 310638.0000 - fn: 9362.0000 - accuracy: 0.9532 - precision: 0.8830 - recall: 0.8830 - auc: 0.9917 - val_loss: 0.0503 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 2-2/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99866%,7:0.00058%,30:0.00038%,31:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:72.00254%,Single Stage Single Point:27.99746%]
[INFO] ** dst:[21:43.31378%,10:21.02954%,8:18.13971%,9:17.51466%,22:0.00077%,16:0.00038%,15:0.00038%,2:0.00038%,24:0.00019%,18:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99866%,-33.760870000000004:0.00134%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99885%,0:0.00134%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99942%,1:0.00038%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.38117%,20:25.96273%,13:18.13971%,6:17.51485%,1:0.00058%,17:0.00038%,16:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.96196%,-0.32151:21.02954%,-1.27613:18.13933%,-0.23351:17.51447%,-0.33484:17.35163%,-71.33197:0.00038%,1.45709:0.00038%,12.60597:0.00019%,-1.2708:0.00019%,-1.02014:0.00019%,-0.24151:0.00019%,4.076980000000001:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-1.27347:0.00019%,-3.3787199999999995:0.00019%,-0.24950999999999998:0.00019%,10.67005:0.00019%,4.29964:0.00019%]
[INFO] ** scada_tag:[3:25.96158%,1:21.02954%,5:18.13933%,4:17.51428%,2:17.35144%,0:0.00384%]
[INFO] ** service:[0.0048200000000000005:99.99866%,-211.09762999999998:0.00058%,-211.73542999999998:0.00038%,-186.43601999999998:0.00019%,-211.35747999999998:0.00019%]
[INFO] ** src:[22:38.38117%,9:25.96273%,7:18.13971%,1:17.51485%,3:0.00058%,14:0.00038%,21:0.00019%,15:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1416 (0.27191%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3504 - tp: 74069.0000 - fp: 5931.0000 - tn: 314069.0000 - fn: 5931.0000 - accuracy: 0.9703 - precision: 0.9259 - recall: 0.9259 - auc: 0.9863 - val_loss: 0.0338 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3788 - tp: 62670.0000 - fp: 17330.0000 - tn: 302670.0000 - fn: 17330.0000 - accuracy: 0.9134 - precision: 0.7834 - recall: 0.7834 - auc: 0.9728 - val_loss: 0.4205 - val_tp: 10691.0000 - val_fp: 9309.0000 - val_tn: 70691.0000 - val_fn: 9309.0000 - val_accuracy: 0.8138 - val_precision: 0.5346 - val_recall: 0.5346 - val_auc: 0.9448
[INFO] saving weights to checkpoints/lstm-epoch-10-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0958 - tp: 74686.0000 - fp: 5314.0000 - tn: 314686.0000 - fn: 5314.0000 - accuracy: 0.9734 - precision: 0.9336 - recall: 0.9336 - auc: 0.9985 - val_loss: 3.5795 - val_tp: 12788.0000 - val_fp: 7212.0000 - val_tn: 72788.0000 - val_fn: 7212.0000 - val_accuracy: 0.8558 - val_precision: 0.6394 - val_recall: 0.6394 - val_auc: 0.7965
[INFO] saving weights to checkpoints/lstm-epoch-10-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5898 - tp: 62217.0000 - fp: 17783.0000 - tn: 302217.0000 - fn: 17783.0000 - accuracy: 0.9111 - precision: 0.7777 - recall: 0.7777 - auc: 0.9542 - val_loss: 0.3828 - val_tp: 16518.0000 - val_fp: 3482.0000 - val_tn: 76518.0000 - val_fn: 3482.0000 - val_accuracy: 0.9304 - val_precision: 0.8259 - val_recall: 0.8259 - val_auc: 0.9732
[INFO] saving weights to checkpoints/lstm-epoch-10-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4217 - tp: 55883.0000 - fp: 24117.0000 - tn: 295883.0000 - fn: 24117.0000 - accuracy: 0.8794 - precision: 0.6985 - recall: 0.6985 - auc: 0.9550 - val_loss: 0.3841 - val_tp: 10572.0000 - val_fp: 9428.0000 - val_tn: 70572.0000 - val_fn: 9428.0000 - val_accuracy: 0.8114 - val_precision: 0.5286 - val_recall: 0.5286 - val_auc: 0.9444
[INFO] saving weights to checkpoints/lstm-epoch-10-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 3-3/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99117%,30:0.0023%,22:0.00115%,31:0.00096%,26:0.00096%,17:0.00096%,7:0.00077%,27:0.00038%,0:0.00038%,28:0.00019%,23:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:87.24129%,Single Stage Single Point:12.75871%]
[INFO] ** dst:[21:43.30438%,10:21.08753%,8:18.15507%,9:17.44323%,6:0.0023%,15:0.00154%,18:0.00134%,16:0.00134%,22:0.00096%,2:0.00038%,7:0.00038%,25:0.00038%,17:0.00038%,12:0.00019%,24:0.00019%,19:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99846%,0:0.00154%]
[INFO] ** i/f_name:[2:99.99846%,3:0.00154%]
[INFO] ** modbus_function_code:[0.02961:99.99117%,-33.760870000000004:0.00864%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99616%,11:49.99501%,0:0.00864%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99885%,2:0.00115%]
[INFO] ** proto:[0:99.99386%,2:0.00461%,1:0.00154%]
[INFO] ** proxy_src_ip:[18:38.41804%,20:25.97425%,13:18.15527%,6:17.44361%,17:0.0023%,1:0.00154%,14:0.00134%,7:0.00096%,11:0.00077%,10:0.00077%,21:0.00058%,16:0.00019%,15:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97348%,-0.32151:21.08734%,-1.27613:18.15469%,-0.23351:17.44303%,-0.33484:17.3307%,-71.33197:0.00154%,-71.14798:0.00115%,-71.14931:0.00115%,-64.19493:0.00038%,-0.08551:0.00038%,1.45709:0.00038%,-0.24151:0.00038%,13.431270000000001:0.00019%,14.4699:0.00019%,4.076980000000001:0.00019%,-5.1466400000000005:0.00019%,-1.02014:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,12.60597:0.00019%,-5.08665:0.00019%,1.46509:0.00019%,-2.1481:0.00019%,-1.27347:0.00019%,10.67005:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,6.1115699999999995:0.00019%,4.44364:0.00019%,13.86459:0.00019%,4.29964:0.00019%,-0.24950999999999998:0.00019%,-3.3787199999999995:0.00019%,10.192739999999999:0.00019%,-68.79874000000001:0.00019%,14.253910000000001:0.00019%,4.90362:0.00019%,-68.36943000000001:0.00019%]
[INFO] ** scada_tag:[3:25.9731%,1:21.08715%,5:18.1545%,4:17.44284%,2:17.33051%,0:0.01191%]
[INFO] ** service:[0.0048200000000000005:99.99136%,-211.73542999999998:0.00154%,-186.43601999999998:0.00134%,-211.08346:0.00115%,-211.08818:0.00115%,-205.44247:0.00096%,-211.09762999999998:0.00077%,-186.44547:0.00038%,-202.75898:0.00038%,-183.8612:0.00019%,-185.9872:0.00019%,-201.23771000000002:0.00019%,-211.35747999999998:0.00019%,-211.07873999999998:0.00019%]
[INFO] ** src:[22:38.41804%,9:25.97425%,7:18.15527%,1:17.44361%,21:0.00211%,3:0.00173%,2:0.00134%,11:0.00077%,10:0.00077%,4:0.00077%,14:0.00038%,8:0.00038%,17:0.00019%,15:0.00019%,13:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1414 (0.27153%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2796 - tp: 70128.0000 - fp: 9872.0000 - tn: 310128.0000 - fn: 9872.0000 - accuracy: 0.9506 - precision: 0.8766 - recall: 0.8766 - auc: 0.9868 - val_loss: 0.2010 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2479 - tp: 73041.0000 - fp: 6959.0000 - tn: 313041.0000 - fn: 6959.0000 - accuracy: 0.9652 - precision: 0.9130 - recall: 0.9130 - auc: 0.9903 - val_loss: 0.7122 - val_tp: 10567.0000 - val_fp: 9433.0000 - val_tn: 70567.0000 - val_fn: 9433.0000 - val_accuracy: 0.8113 - val_precision: 0.5283 - val_recall: 0.5283 - val_auc: 0.9444
[INFO] saving weights to checkpoints/lstm-epoch-10-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2206 - tp: 65225.0000 - fp: 14775.0000 - tn: 305225.0000 - fn: 14775.0000 - accuracy: 0.9261 - precision: 0.8153 - recall: 0.8153 - auc: 0.9890 - val_loss: 9.3944e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0238 - tp: 77429.0000 - fp: 2571.0000 - tn: 317429.0000 - fn: 2571.0000 - accuracy: 0.9871 - precision: 0.9679 - recall: 0.9679 - auc: 0.9997 - val_loss: 8.3078e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0223 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4495e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 4-4/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.9977%,30:0.00134%,31:0.00038%,33:0.00019%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:91.59302%,Single Stage Single Point:8.40698%]
[INFO] ** dst:[21:43.35545%,10:20.94024%,8:18.1714%,9:17.52945%,15:0.00134%,22:0.00115%,18:0.00038%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99885%,0:0.00115%]
[INFO] ** i/f_name:[2:99.99866%,3:0.00134%]
[INFO] ** modbus_function_code:[0.02961:99.9977%,-33.760870000000004:0.0023%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99808%,0:0.0023%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99885%,2:0.00115%]
[INFO] ** proto:[0:99.99808%,1:0.00134%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.25846%,20:26.03762%,13:18.1714%,6:17.52983%,17:0.00134%,21:0.00038%,16:0.00038%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.03685%,-0.32151:20.94005%,-1.27613:18.17101%,-0.23351:17.52926%,-0.33484:17.31841%,-71.33197:0.00134%,1.45709:0.00038%,-0.24151:0.00038%,-1.02014:0.00038%,-0.08551:0.00038%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,14.4699:0.00019%,-49.275529999999996:0.00019%,-1.2708:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:26.03666%,1:20.93986%,5:18.17101%,4:17.52887%,2:17.31822%,0:0.00538%]
[INFO] ** service:[0.0048200000000000005:99.99789%,-211.73542999999998:0.00134%,-186.43601999999998:0.00038%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.25846%,9:26.03762%,7:18.1714%,1:17.52983%,21:0.00115%,15:0.00038%,4:0.00038%,17:0.00019%,14:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1424 (0.27345%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4742e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0183 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2560e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0171 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1963e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0159 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.4527 - val_tp: 11993.0000 - val_fp: 8007.0000 - val_tn: 71993.0000 - val_fn: 8007.0000 - val_accuracy: 0.8399 - val_precision: 0.5997 - val_recall: 0.5997 - val_auc: 0.7498
[INFO] saving weights to checkpoints/lstm-epoch-10-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2972 - tp: 44232.0000 - fp: 35768.0000 - tn: 284232.0000 - fn: 35768.0000 - accuracy: 0.8212 - precision: 0.5529 - recall: 0.5529 - auc: 0.8734 - val_loss: 0.5955 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 5-5/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99674%,30:0.0023%,37:0.00019%,26:0.00019%,12:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:89.1802%,Single Stage Single Point:10.8198%]
[INFO] ** dst:[21:43.36563%,10:20.76358%,8:18.24667%,9:17.62028%,15:0.0023%,22:0.00077%,25:0.00019%,24:0.00019%,6:0.00019%,2:0.00019%]
[INFO] ** i/f_dir:[1:99.99808%,0:0.00192%]
[INFO] ** i/f_name:[2:99.9977%,3:0.0023%]
[INFO] ** modbus_function_code:[0.02961:99.99674%,-33.760870000000004:0.00326%]
[INFO] ** modbus_function_description:[7:49.99904%,11:49.9977%,0:0.00326%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99827%,2:0.00173%]
[INFO] ** proto:[0:99.99731%,1:0.0023%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:37.99442%,20:26.13479%,13:18.24686%,6:17.62047%,17:0.0023%,21:0.00019%,16:0.00019%,7:0.00019%,5:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.1344%,-0.32151:20.7632%,-1.27613:18.24667%,-0.23351:17.62008%,-0.33484:17.23123%,-71.33197:0.0023%,-0.24151:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.45709:0.00019%,1.47576:0.00019%,2.22906:0.00019%,-49.275529999999996:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:26.13402%,1:20.763%,5:18.24648%,4:17.62008%,2:17.23123%,0:0.00518%]
[INFO] ** service:[0.0048200000000000005:99.99712%,-211.73542999999998:0.0023%,-186.44547:0.00019%,-211.08346:0.00019%,-211.35747999999998:0.00019%]
[INFO] ** src:[22:37.99442%,9:26.13479%,7:18.24686%,1:17.62047%,21:0.00192%,14:0.00058%,16:0.00019%,15:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1423 (0.27326%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4999 - tp: 69908.0000 - fp: 10092.0000 - tn: 309908.0000 - fn: 10092.0000 - accuracy: 0.9495 - precision: 0.8738 - recall: 0.8738 - auc: 0.9652 - val_loss: 0.7080 - val_tp: 12815.0000 - val_fp: 7185.0000 - val_tn: 72815.0000 - val_fn: 7185.0000 - val_accuracy: 0.8563 - val_precision: 0.6407 - val_recall: 0.6407 - val_auc: 0.8901
[INFO] saving weights to checkpoints/lstm-epoch-10-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6771 - tp: 51330.0000 - fp: 28670.0000 - tn: 291330.0000 - fn: 28670.0000 - accuracy: 0.8567 - precision: 0.6416 - recall: 0.6416 - auc: 0.9051 - val_loss: 0.6614 - val_tp: 12824.0000 - val_fp: 7176.0000 - val_tn: 72824.0000 - val_fn: 7176.0000 - val_accuracy: 0.8565 - val_precision: 0.6412 - val_recall: 0.6412 - val_auc: 0.8986
[INFO] saving weights to checkpoints/lstm-epoch-10-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3161 - tp: 76778.0000 - fp: 3222.0000 - tn: 316778.0000 - fn: 3222.0000 - accuracy: 0.9839 - precision: 0.9597 - recall: 0.9597 - auc: 0.9897 - val_loss: 0.1935 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1506 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1184 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0992 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0833 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 6-6/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99558%,30:0.00346%,31:0.00019%,27:0.00019%,26:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:92.24112%,Single Stage Single Point:7.75888%]
[INFO] ** dst:[21:43.37735%,10:20.73036%,8:18.28335%,9:17.60395%,15:0.00346%,22:0.00038%,25:0.00019%,24:0.00019%,18:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99674%,0:0.00326%]
[INFO] ** i/f_name:[2:99.99654%,3:0.00346%]
[INFO] ** modbus_function_code:[0.02961:99.99558%,-33.760870000000004:0.00442%]
[INFO] ** modbus_function_description:[7:49.99846%,11:49.99712%,0:0.00442%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99558%,1:0.00346%,2:0.00096%]
[INFO] ** proxy_src_ip:[18:37.94622%,20:26.16167%,13:18.28354%,6:17.60415%,17:0.00346%,14:0.00058%,16:0.00019%,11:0.00019%]
[INFO] ** s_port:[1.45442:26.16129%,-0.32151:20.73036%,-1.27613:18.28296%,-0.23351:17.60376%,-0.33484:17.21587%,-71.33197:0.00346%,-0.24151:0.00019%,-1.2708:0.00019%,-64.19493:0.00019%,-1.02014:0.00019%,13.431270000000001:0.00019%,4.90362:0.00019%,-71.14798:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-1.27347:0.00019%,-68.36943000000001:0.00019%]
[INFO] ** scada_tag:[3:26.1611%,1:20.73017%,5:18.28277%,4:17.60338%,2:17.21567%,0:0.00691%]
[INFO] ** service:[0.0048200000000000005:99.99558%,-211.73542999999998:0.00346%,-186.44547:0.00019%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-201.23771000000002:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:37.94622%,9:26.16167%,7:18.28354%,1:17.60415%,14:0.00346%,2:0.00058%,15:0.00019%,10:0.00019%]
[INFO] ** type:[0:99.99904%,1:0.00096%]
[INFO] ** unixtime:1426 (0.27383%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0718 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0629 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0557 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0494 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0443 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0398 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0361 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0326 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.9734 - tp: 54289.0000 - fp: 25711.0000 - tn: 294289.0000 - fn: 25711.0000 - accuracy: 0.8714 - precision: 0.6786 - recall: 0.6786 - auc: 0.9184 - val_loss: 0.9336 - val_tp: 12813.0000 - val_fp: 7187.0000 - val_tn: 72813.0000 - val_fn: 7187.0000 - val_accuracy: 0.8563 - val_precision: 0.6406 - val_recall: 0.6406 - val_auc: 0.9043
[INFO] saving weights to checkpoints/lstm-epoch-10-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 7-7/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99539%,30:0.00134%,22:0.00096%,17:0.00077%,26:0.00058%,31:0.00038%,28:0.00019%,27:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:81.9636%,Single Stage Single Point:18.0364%]
[INFO] ** dst:[21:43.36083%,10:20.74495%,8:18.25186%,9:17.63602%,6:0.00154%,22:0.00134%,15:0.00134%,16:0.00077%,24:0.00038%,18:0.00038%,17:0.00038%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99866%,0:0.00134%]
[INFO] ** i/f_name:[2:99.99866%,3:0.00134%]
[INFO] ** modbus_function_code:[0.02961:99.99539%,-33.760870000000004:0.00461%]
[INFO] ** modbus_function_description:[7:49.99827%,11:49.99712%,0:0.00461%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99654%,2:0.00211%,1:0.00134%]
[INFO] ** proxy_src_ip:[18:37.9685%,20:26.13805%,13:18.25224%,6:17.63621%,17:0.00134%,11:0.00077%,1:0.00077%,21:0.00058%,16:0.00038%,14:0.00038%,7:0.00038%,10:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.13709%,-0.32151:20.74495%,-1.27613:18.25166%,-0.23351:17.63583%,-0.33484:17.22355%,-71.33197:0.00134%,-71.14931:0.00096%,-71.14798:0.00058%,1.45709:0.00058%,-1.02014:0.00038%,-1.27347:0.00038%,-0.24151:0.00038%,-58.035180000000004:0.00019%,-1.2708:0.00019%,-5.1466400000000005:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-5.08665:0.00019%,14.253910000000001:0.00019%,-68.79874000000001:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:26.13671%,1:20.74495%,5:18.25166%,4:17.63564%,2:17.22355%,0:0.00749%]
[INFO] ** service:[0.0048200000000000005:99.99539%,-211.73542999999998:0.00134%,-211.08818:0.00096%,-205.44247:0.00077%,-211.08346:0.00058%,-186.43601999999998:0.00038%,-211.09762999999998:0.00019%,-185.9872:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:37.9685%,9:26.13805%,7:18.25224%,1:17.63621%,14:0.00134%,10:0.00077%,3:0.00077%,4:0.00058%,21:0.00038%,15:0.00038%,2:0.00038%,11:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1423 (0.27326%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8372 - tp: 51167.0000 - fp: 28833.0000 - tn: 291167.0000 - fn: 28833.0000 - accuracy: 0.8558 - precision: 0.6396 - recall: 0.6396 - auc: 0.9098 - val_loss: 0.7591 - val_tp: 12817.0000 - val_fp: 7183.0000 - val_tn: 72817.0000 - val_fn: 7183.0000 - val_accuracy: 0.8563 - val_precision: 0.6409 - val_recall: 0.6409 - val_auc: 0.9043
[INFO] saving weights to checkpoints/lstm-epoch-10-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7175 - tp: 51268.0000 - fp: 28732.0000 - tn: 291268.0000 - fn: 28732.0000 - accuracy: 0.8563 - precision: 0.6409 - recall: 0.6409 - auc: 0.9097 - val_loss: 0.6838 - val_tp: 12876.0000 - val_fp: 7124.0000 - val_tn: 72876.0000 - val_fn: 7124.0000 - val_accuracy: 0.8575 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.9056
[INFO] saving weights to checkpoints/lstm-epoch-10-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5906 - tp: 57946.0000 - fp: 22054.0000 - tn: 297946.0000 - fn: 22054.0000 - accuracy: 0.8897 - precision: 0.7243 - recall: 0.7243 - auc: 0.9295 - val_loss: 0.3000 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2274 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1716 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1408 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1162 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 8-8/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99693%,30:0.00115%,0:0.00058%,24:0.00019%,23:0.00019%,22:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:94.51223%,Single Stage Single Point:5.48777%]
[INFO] ** dst:[21:43.43361%,10:20.81139%,8:18.17255%,9:17.57861%,22:0.00134%,15:0.00115%,25:0.00058%,19:0.00038%,26:0.00019%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99923%,0:0.00077%]
[INFO] ** i/f_name:[2:99.99885%,3:0.00115%]
[INFO] ** modbus_function_code:[0.02961:99.99693%,-33.760870000000004:0.00288%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99942%,11:49.9975%,0:0.00288%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99962%,2:0.00038%]
[INFO] ** proto:[0:99.99808%,1:0.00115%,2:0.00077%]
[INFO] ** proxy_src_ip:[18:38.10081%,20:26.14477%,13:18.17178%,6:17.57899%,17:0.00115%,10:0.00115%,16:0.00058%,14:0.00038%,11:0.00019%,5:0.00019%]
[INFO] ** s_port:[1.45442:26.1442%,-0.32151:20.81139%,-1.27613:18.17159%,-0.23351:17.57841%,-0.33484:17.28941%,-71.33197:0.00115%,-15.039579999999999:0.00077%,-1.02014:0.00058%,-64.19493:0.00058%,1.45709:0.00038%,-0.24151:0.00038%,4.66896:0.00038%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-71.14931:0.00019%]
[INFO] ** scada_tag:[3:26.14381%,1:20.8112%,5:18.17159%,4:17.57822%,2:17.28922%,0:0.00595%]
[INFO] ** service:[0.0048200000000000005:99.9977%,-211.73542999999998:0.00115%,-186.44547:0.00058%,-211.07873999999998:0.00038%,-211.08818:0.00019%]
[INFO] ** src:[22:38.10081%,9:26.14477%,7:18.17178%,1:17.57899%,11:0.00115%,14:0.00077%,15:0.00058%,21:0.00038%,2:0.00038%,16:0.00019%,10:0.00019%]
[INFO] ** type:[0:99.99942%,1:0.00038%,2:0.00019%]
[INFO] ** unixtime:1427 (0.27402%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0993 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0858 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0755 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0664 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0594 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0530 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1644 - tp: 76928.0000 - fp: 3072.0000 - tn: 316928.0000 - fn: 3072.0000 - accuracy: 0.9846 - precision: 0.9616 - recall: 0.9616 - auc: 0.9901 - val_loss: 0.5886 - val_tp: 16374.0000 - val_fp: 3626.0000 - val_tn: 76374.0000 - val_fn: 3626.0000 - val_accuracy: 0.9275 - val_precision: 0.8187 - val_recall: 0.8187 - val_auc: 0.9547
[INFO] saving weights to checkpoints/lstm-epoch-10-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5563 - tp: 65482.0000 - fp: 14518.0000 - tn: 305482.0000 - fn: 14518.0000 - accuracy: 0.9274 - precision: 0.8185 - recall: 0.8185 - auc: 0.9545 - val_loss: 0.5231 - val_tp: 16398.0000 - val_fp: 3602.0000 - val_tn: 76398.0000 - val_fn: 3602.0000 - val_accuracy: 0.9280 - val_precision: 0.8199 - val_recall: 0.8199 - val_auc: 0.9550
[INFO] saving weights to checkpoints/lstm-epoch-10-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 9-9/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99827%,30:0.00096%,31:0.00038%,26:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:95.53708%,Single Stage Single Point:4.46292%]
[INFO] ** dst:[21:43.36064%,10:20.77491%,8:18.29084%,9:17.57093%,15:0.00096%,22:0.00077%,18:0.00038%,25:0.00019%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99904%,0:0.00096%]
[INFO] ** i/f_name:[2:99.99904%,3:0.00096%]
[INFO] ** modbus_function_code:[0.02961:99.99827%,-33.760870000000004:0.00173%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99846%,0:0.00173%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99981%,2:0.00019%]
[INFO] ** proto:[0:99.99827%,1:0.00096%,2:0.00077%]
[INFO] ** proxy_src_ip:[18:38.00825%,20:26.12788%,13:18.29103%,6:17.57112%,17:0.00096%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.12711%,-0.32151:20.77491%,-1.27613:18.29065%,-0.23351:17.57073%,-0.33484:17.23334%,-71.33197:0.00096%,1.45709:0.00038%,-0.24151:0.00038%,-0.08551:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.12672%,1:20.77472%,5:18.29065%,4:17.57054%,2:17.23334%,0:0.00403%]
[INFO] ** service:[0.0048200000000000005:99.99827%,-211.73542999999998:0.00096%,-186.43601999999998:0.00038%,-186.44547:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.00825%,9:26.12788%,7:18.29103%,1:17.57112%,14:0.00077%,21:0.00019%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1425 (0.27364%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5096 - tp: 65374.0000 - fp: 14626.0000 - tn: 305374.0000 - fn: 14626.0000 - accuracy: 0.9269 - precision: 0.8172 - recall: 0.8172 - auc: 0.9544 - val_loss: 0.4999 - val_tp: 16295.0000 - val_fp: 3705.0000 - val_tn: 76295.0000 - val_fn: 3705.0000 - val_accuracy: 0.9259 - val_precision: 0.8148 - val_recall: 0.8148 - val_auc: 0.9484
[INFO] saving weights to checkpoints/lstm-epoch-10-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2430 - tp: 75090.0000 - fp: 4910.0000 - tn: 315090.0000 - fn: 4910.0000 - accuracy: 0.9754 - precision: 0.9386 - recall: 0.9386 - auc: 0.9845 - val_loss: 0.1011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0828 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0676 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0578 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0495 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0435 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0382 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 10-10/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99654%,30:0.00192%,24:0.00019%,23:0.00019%,22:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:94.13374%,Single Stage Single Point:5.86626%]
[INFO] ** dst:[21:43.41153%,10:20.81178%,8:18.22478%,9:17.54827%,15:0.00192%,22:0.00058%,24:0.00038%,19:0.00038%,26:0.00019%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99827%,0:0.00173%]
[INFO] ** i/f_name:[2:99.99808%,3:0.00192%]
[INFO] ** modbus_function_code:[0.02961:99.99654%,-33.760870000000004:0.00326%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99904%,11:49.9975%,0:0.00326%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99923%,1:0.00077%]
[INFO] ** proto:[0:99.9977%,1:0.00192%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.09389%,20:26.1298%,13:18.22497%,6:17.54769%,17:0.00192%,10:0.00096%,14:0.00038%,16:0.00019%,5:0.00019%]
[INFO] ** s_port:[1.45442:26.12922%,-0.32151:20.81178%,-1.27613:18.2244%,-0.23351:17.54731%,-0.33484:17.28212%,-71.33197:0.00192%,-10.51843:0.00077%,5.71692:0.00038%,-1.27347:0.00038%,1.46509:0.00019%,1.47576:0.00019%,-0.24950999999999998:0.00019%,1.45709:0.00019%,-0.24151:0.00019%,-71.14931:0.00019%,-1.02014:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.12884%,1:20.81159%,5:18.2244%,4:17.54711%,2:17.28192%,0:0.00614%]
[INFO] ** service:[0.0048200000000000005:99.99731%,-211.73542999999998:0.00192%,-211.07873999999998:0.00038%,-186.44547:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.09389%,9:26.1298%,7:18.22497%,1:17.54769%,14:0.00192%,11:0.00096%,2:0.00038%,16:0.00019%,15:0.00019%]
[INFO] ** type:[0:99.99846%,1:0.00134%,2:0.00019%]
[INFO] ** unixtime:1423 (0.27326%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0339 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0305 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0276 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0249 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.1119 - tp: 51543.0000 - fp: 28457.0000 - tn: 291543.0000 - fn: 28457.0000 - accuracy: 0.8577 - precision: 0.6443 - recall: 0.6443 - auc: 0.9110 - val_loss: 0.3381 - val_tp: 17908.0000 - val_fp: 2092.0000 - val_tn: 77908.0000 - val_fn: 2092.0000 - val_accuracy: 0.9582 - val_precision: 0.8954 - val_recall: 0.8954 - val_auc: 0.9739
[INFO] saving weights to checkpoints/lstm-epoch-10-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0791 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0698 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0625 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0560 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 11-11/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99885%,31:0.00038%,30:0.00038%,26:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.38407%,10:20.87822%,8:18.19982%,9:17.5354%,22:0.00134%,18:0.00038%,15:0.00038%,25:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99885%,-33.760870000000004:0.00115%]
[INFO] ** modbus_function_description:[7:50.00058%,11:49.99827%,0:0.00115%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99885%,2:0.00077%,1:0.00038%]
[INFO] ** proxy_src_ip:[18:38.14689%,20:26.11578%,13:18.19982%,6:17.53578%,16:0.00058%,17:0.00038%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.1152%,-0.32151:20.87822%,-1.27613:18.19962%,-0.23351:17.53521%,-0.33484:17.26867%,-0.24151:0.00058%,-1.02014:0.00058%,-0.08551:0.00038%,-71.33197:0.00038%,-71.14798:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.11482%,1:20.87822%,5:18.19943%,4:17.53482%,2:17.26848%,0:0.00422%]
[INFO] ** service:[0.0048200000000000005:99.99885%,-211.73542999999998:0.00038%,-186.43601999999998:0.00038%,-186.44547:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.14689%,9:26.11578%,7:18.19982%,1:17.53578%,15:0.00058%,14:0.00038%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1423 (0.27326%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0468 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0105 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0042 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0019 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0028 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0010 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0018 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2112e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0014 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6782e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 12-12/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.9977%,30:0.00211%,9:0.00019%]
[INFO] ** classification:[normal:93.05032%,Single Stage Single Point:6.94968%]
[INFO] ** dst:[21:43.39367%,10:20.87284%,8:18.19156%,9:17.53866%,15:0.00211%,22:0.00058%,24:0.00038%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99827%,0:0.00173%]
[INFO] ** i/f_name:[2:99.99789%,3:0.00211%]
[INFO] ** modbus_function_code:[0.02961:99.9977%,-33.760870000000004:0.0023%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99808%,0:0.0023%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99827%,2:0.00173%]
[INFO] ** proto:[0:99.99789%,1:0.00211%]
[INFO] ** proxy_src_ip:[18:38.14094%,20:26.12595%,13:18.19175%,6:17.53886%,17:0.00211%,16:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:26.12538%,-0.32151:20.87284%,-1.27613:18.19118%,-0.23351:17.53847%,-0.33484:17.2681%,-71.33197:0.00211%,-1.27347:0.00038%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.12499%,1:20.87284%,5:18.19118%,4:17.53809%,2:17.2681%,0:0.0048%]
[INFO] ** service:[0.0048200000000000005:99.9977%,-211.73542999999998:0.00211%,-183.8612:0.00019%]
[INFO] ** src:[22:38.14094%,9:26.12595%,7:18.19175%,1:17.53886%,21:0.00173%,14:0.00038%,15:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1423 (0.27326%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0014 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.7928e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0013 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3069e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0486 - tp: 55462.0000 - fp: 24538.0000 - tn: 295462.0000 - fn: 24538.0000 - accuracy: 0.8773 - precision: 0.6933 - recall: 0.6933 - auc: 0.9353 - val_loss: 0.7718 - val_tp: 12835.0000 - val_fp: 7165.0000 - val_tn: 72835.0000 - val_fn: 7165.0000 - val_accuracy: 0.8567 - val_precision: 0.6417 - val_recall: 0.6417 - val_auc: 0.9679
[INFO] saving weights to checkpoints/lstm-epoch-10-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1722 - tp: 75512.0000 - fp: 4488.0000 - tn: 315512.0000 - fn: 4488.0000 - accuracy: 0.9776 - precision: 0.9439 - recall: 0.9439 - auc: 0.9944 - val_loss: 0.0476 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0389 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0207 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 13-13/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99635%,31:0.00077%,26:0.00058%,0:0.00058%,30:0.00038%,22:0.00038%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:85.30738%,Single Stage Single Point:14.69262%]
[INFO] ** dst:[21:43.35392%,10:20.79968%,8:18.2797%,9:17.56248%,22:0.00115%,6:0.00096%,18:0.00077%,25:0.00058%,15:0.00038%,24:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99635%,-33.760870000000004:0.00346%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99904%,11:49.99731%,0:0.00346%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99712%,2:0.0025%,1:0.00038%]
[INFO] ** proxy_src_ip:[18:38.05184%,20:26.10214%,13:18.27989%,6:17.5619%,10:0.00115%,11:0.00096%,16:0.00058%,17:0.00038%,7:0.00038%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.10157%,-0.32151:20.79968%,-1.27613:18.27951%,-0.23351:17.56152%,-0.33484:17.25216%,-9.78512:0.00077%,-71.14798:0.00058%,-64.19493:0.00058%,-1.02014:0.00058%,-0.08551:0.00038%,-71.14931:0.00038%,-0.24151:0.00038%,-71.33197:0.00038%,-1.27347:0.00019%,1.46509:0.00019%,-68.79874000000001:0.00019%,14.540560000000001:0.00019%,1.45709:0.00019%,-1.2708:0.00019%,6.1115699999999995:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:26.10118%,1:20.79949%,5:18.27951%,4:17.56152%,2:17.25197%,0:0.00634%]
[INFO] ** service:[0.0048200000000000005:99.99712%,-186.43601999999998:0.00077%,-186.44547:0.00058%,-211.08346:0.00058%,-211.73542999999998:0.00038%,-211.08818:0.00038%,-202.75898:0.00019%]
[INFO] ** src:[22:38.05184%,9:26.10214%,7:18.27989%,1:17.5619%,11:0.00115%,10:0.00096%,15:0.00058%,21:0.00038%,14:0.00038%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1423 (0.27326%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0073 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.7379e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0043 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2095e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0040 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2451e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8176 - tp: 53857.0000 - fp: 26143.0000 - tn: 293857.0000 - fn: 26143.0000 - accuracy: 0.8693 - precision: 0.6732 - recall: 0.6732 - auc: 0.9433 - val_loss: 0.5351 - val_tp: 12807.0000 - val_fp: 7193.0000 - val_tn: 72807.0000 - val_fn: 7193.0000 - val_accuracy: 0.8561 - val_precision: 0.6403 - val_recall: 0.6403 - val_auc: 0.9676
[INFO] saving weights to checkpoints/lstm-epoch-10-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3803 - tp: 56564.0000 - fp: 23436.0000 - tn: 296564.0000 - fn: 23436.0000 - accuracy: 0.8828 - precision: 0.7071 - recall: 0.7071 - auc: 0.9741 - val_loss: 0.0731 - val_tp: 19269.0000 - val_fp: 731.0000 - val_tn: 79269.0000 - val_fn: 731.0000 - val_accuracy: 0.9854 - val_precision: 0.9635 - val_recall: 0.9635 - val_auc: 0.9997
[INFO] saving weights to checkpoints/lstm-epoch-10-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 14-14/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99962%,30:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:95.22542%,Single Stage Single Point:4.77458%]
[INFO] ** dst:[21:43.34566%,10:20.80851%,8:18.26875%,9:17.57553%,22:0.00077%,24:0.00038%,15:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99962%,-33.760870000000004:0.00038%]
[INFO] ** modbus_function_description:[7:50.00058%,11:49.99904%,0:0.00038%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99981%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.04627%,20:26.10848%,13:18.26895%,6:17.57573%,17:0.00019%,16:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:26.10771%,-0.32151:20.80851%,-1.27613:18.26837%,-0.23351:17.57534%,-0.33484:17.23776%,-1.27347:0.00038%,1.45709:0.00038%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:26.10733%,1:20.80851%,5:18.26818%,4:17.57496%,2:17.23757%,0:0.00346%]
[INFO] ** service:[0.0048200000000000005:99.99962%,-183.8612:0.00019%,-211.73542999999998:0.00019%]
[INFO] ** src:[22:38.04627%,9:26.10848%,7:18.26895%,1:17.57573%,15:0.00019%,14:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1423 (0.27326%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2282 - tp: 71357.0000 - fp: 8643.0000 - tn: 311357.0000 - fn: 8643.0000 - accuracy: 0.9568 - precision: 0.8920 - recall: 0.8920 - auc: 0.9912 - val_loss: 0.5042 - val_tp: 12877.0000 - val_fp: 7123.0000 - val_tn: 72877.0000 - val_fn: 7123.0000 - val_accuracy: 0.8575 - val_precision: 0.6439 - val_recall: 0.6439 - val_auc: 0.9677
[INFO] saving weights to checkpoints/lstm-epoch-10-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2031 - tp: 77393.0000 - fp: 2607.0000 - tn: 317393.0000 - fn: 2607.0000 - accuracy: 0.9870 - precision: 0.9674 - recall: 0.9674 - auc: 0.9974 - val_loss: 0.1163 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0551 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0100 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0160 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0032 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0107 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.6914e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 15-15/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99616%,30:0.00307%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:89.39431%,Single Stage Multi Point:10.60493%,Single Stage Single Point:0.00077%]
[INFO] ** dst:[21:43.29746%,10:20.77395%,8:18.31407%,9:17.60914%,15:0.00307%,22:0.00154%,25:0.00019%,24:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99693%,0:0.00307%]
[INFO] ** i/f_name:[2:99.99693%,3:0.00307%]
[INFO] ** modbus_function_code:[0.02961:99.99616%,-33.760870000000004:0.00384%]
[INFO] ** modbus_function_description:[7:49.99904%,11:49.99712%,0:0.00384%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99712%,2:0.00288%]
[INFO] ** proto:[0:99.99654%,1:0.00307%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.00249%,20:26.0695%,13:18.31388%,6:17.60972%,17:0.00307%,16:0.00058%,7:0.00038%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.06873%,-0.32151:20.77376%,-1.27613:18.31369%,-0.23351:17.60895%,-0.33484:17.22873%,-71.33197:0.00307%,-1.02014:0.00058%,-0.24151:0.00058%,1.45709:0.00038%,-64.19493:0.00019%,-61.95768:0.00019%,-71.14798:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,10.192739999999999:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%]
[INFO] ** scada_tag:[3:26.06835%,1:20.77356%,5:18.31369%,4:17.60856%,2:17.22854%,0:0.0073%]
[INFO] ** service:[0.0048200000000000005:99.99635%,-211.73542999999998:0.00307%,-186.44547:0.00019%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.00249%,9:26.0695%,7:18.31388%,1:17.60972%,21:0.00326%,15:0.00058%,16:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1431 (0.27479%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0170 - tp: 79942.0000 - fp: 58.0000 - tn: 319942.0000 - fn: 58.0000 - accuracy: 0.9997 - precision: 0.9993 - recall: 0.9993 - auc: 0.9996 - val_loss: 2.3012e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0082 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.9180e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0079 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4953e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0073 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5609e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.2812 - tp: 43880.0000 - fp: 36120.0000 - tn: 283880.0000 - fn: 36120.0000 - accuracy: 0.8194 - precision: 0.5485 - recall: 0.5485 - auc: 0.7152 - val_loss: 7.5570 - val_tp: 10623.0000 - val_fp: 9377.0000 - val_tn: 70623.0000 - val_fn: 9377.0000 - val_accuracy: 0.8125 - val_precision: 0.5311 - val_recall: 0.5311 - val_auc: 0.7070
[INFO] saving weights to checkpoints/lstm-epoch-10-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 16-16/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (460448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (460448, 17)

[INFO] analyzing data
[INFO] 460448 rows
[INFO] ** appi_name:[21:99.99848%,30:0.0013%,33:0.00022%]
[INFO] ** classification:[normal:83.00829%,Single Stage Multi Point:16.99171%]
[INFO] ** dst:[21:43.3569%,10:20.7967%,8:18.25266%,9:17.59091%,22:0.0013%,15:0.0013%,24:0.00022%]
[INFO] ** i/f_dir:[1:99.9987%,0:0.0013%]
[INFO] ** i/f_name:[2:99.9987%,3:0.0013%]
[INFO] ** modbus_function_code:[0.02961:99.99848%,-33.760870000000004:0.00152%]
[INFO] ** modbus_function_description:[7:50.00065%,11:49.99783%,0:0.00152%]
[INFO] ** modbus_transaction_id:65536 (14.23309%)
[INFO] ** orig:[0:99.9987%,2:0.0013%]
[INFO] ** proto:[0:99.9987%,1:0.0013%]
[INFO] ** proxy_src_ip:[18:38.04729%,20:26.10653%,13:18.25309%,6:17.59113%,17:0.0013%,16:0.00043%,21:0.00022%]
[INFO] ** s_port:[1.45442:26.10588%,-0.32151:20.79649%,-1.27613:18.25266%,-0.23351:17.59069%,-0.33484:17.25081%,-71.33197:0.0013%,1.45709:0.00043%,-0.24151:0.00043%,-1.02014:0.00043%,-1.27347:0.00022%,1.47576:0.00022%,-49.275529999999996:0.00022%,-1.2708:0.00022%]
[INFO] ** scada_tag:[3:26.10545%,1:20.79649%,5:18.25244%,4:17.59026%,2:17.25059%,0:0.00478%]
[INFO] ** service:[0.0048200000000000005:99.9987%,-211.73542999999998:0.0013%]
[INFO] ** src:[22:38.04729%,9:26.10653%,7:18.25309%,1:17.59113%,21:0.0013%,15:0.00043%,4:0.00022%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1259 (0.27343%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/460448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5598 - tp: 42496.0000 - fp: 37504.0000 - tn: 282496.0000 - fn: 37504.0000 - accuracy: 0.8125 - precision: 0.5312 - recall: 0.5312 - auc: 0.7046 - val_loss: 7.5554 - val_tp: 10625.0000 - val_fp: 9375.0000 - val_tn: 70625.0000 - val_fn: 9375.0000 - val_accuracy: 0.8125 - val_precision: 0.5312 - val_recall: 0.5312 - val_auc: 0.7070
[INFO] saving weights to checkpoints/lstm-epoch-10-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/460448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.3219 - tp: 48641.0000 - fp: 31359.0000 - tn: 288641.0000 - fn: 31359.0000 - accuracy: 0.8432 - precision: 0.6080 - recall: 0.6080 - auc: 0.7530 - val_loss: 3.1380e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/460448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0059 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8335e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/460448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0055 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0305e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/460448
[33m[INFO] loading file 17-17/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (560448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (560448, 17)

[INFO] analyzing data
[INFO] 560448 rows
[INFO] ** appi_name:[21:99.99715%,7:0.00054%,26:0.00036%,0:0.00036%,33:0.00018%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.49548%,Multi Stage Multi Point:5.50452%]
[INFO] ** dst:[21:43.34943%,10:20.84422%,8:18.20544%,9:17.59806%,22:0.00071%,6:0.00054%,25:0.00036%,16:0.00036%,2:0.00036%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99715%,-33.760870000000004:0.00268%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.9975%,0:0.00268%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.6935%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99875%,2:0.00125%]
[INFO] ** proxy_src_ip:[18:38.07811%,20:26.11607%,13:18.2049%,6:17.59789%,10:0.00107%,11:0.00089%,1:0.00036%,21:0.00018%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.11518%,-0.32151:20.84404%,-1.27613:18.20454%,-0.23351:17.59771%,-0.33484:17.23407%,6.0369:0.00071%,1.47576:0.00036%,-71.14798:0.00036%,1.45709:0.00036%,-64.19493:0.00036%,1.46509:0.00018%,-68.79874000000001:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,6.15557:0.00018%,6.06224:0.00018%,8.55414:0.00018%,-3.3787199999999995:0.00018%,-4.3880099999999995:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.115%,1:20.84386%,5:18.20437%,4:17.59717%,2:17.23407%,0:0.00553%]
[INFO] ** service:[0.0048200000000000005:99.99804%,-211.09762999999998:0.00054%,-211.08346:0.00036%,-186.44547:0.00036%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.07811%,9:26.11607%,7:18.2049%,1:17.59789%,11:0.00107%,10:0.00089%,3:0.00036%,21:0.00018%,15:0.00018%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1531 (0.27317%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0051 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.6805e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0049 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.1380e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0044 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.1036e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.5360 - tp: 72394.0000 - fp: 7606.0000 - tn: 312394.0000 - fn: 7606.0000 - accuracy: 0.9620 - precision: 0.9049 - recall: 0.9049 - auc: 0.9402 - val_loss: 2.9335 - val_tp: 16360.0000 - val_fp: 3640.0000 - val_tn: 76360.0000 - val_fn: 3640.0000 - val_accuracy: 0.9272 - val_precision: 0.8180 - val_recall: 0.8180 - val_auc: 0.8863
[INFO] saving weights to checkpoints/lstm-epoch-10-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9243 - tp: 65501.0000 - fp: 14499.0000 - tn: 305501.0000 - fn: 14499.0000 - accuracy: 0.9275 - precision: 0.8188 - recall: 0.8188 - auc: 0.8860 - val_loss: 2.9166 - val_tp: 16381.0000 - val_fp: 3619.0000 - val_tn: 76381.0000 - val_fn: 3619.0000 - val_accuracy: 0.9276 - val_precision: 0.8191 - val_recall: 0.8191 - val_auc: 0.8869
[INFO] saving weights to checkpoints/lstm-epoch-10-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/560448
[33m[INFO] loading file 18-18/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (560448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (560448, 17)

[INFO] analyzing data
[INFO] 560448 rows
[INFO] ** appi_name:[21:99.99822%,30:0.00054%,7:0.00054%,31:0.00018%,27:0.00018%,22:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:82.42763%,Multi Stage Multi Point:17.57237%]
[INFO] ** dst:[21:43.34354%,10:20.83387%,8:18.25772%,9:17.56202%,22:0.00071%,15:0.00054%,24:0.00036%,16:0.00036%,2:0.00036%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99946%,0:0.00054%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.99822%,-33.760870000000004:0.00178%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99804%,0:0.00178%]
[INFO] ** modbus_transaction_id:65536 (11.6935%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99893%,2:0.00054%,1:0.00054%]
[INFO] ** proxy_src_ip:[18:38.07954%,20:26.09841%,13:18.25807%,6:17.5622%,17:0.00054%,11:0.00054%,1:0.00036%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.09769%,-0.32151:20.83387%,-1.27613:18.25754%,-0.23351:17.56184%,-0.33484:17.24567%,-71.33197:0.00054%,-1.27347:0.00036%,1.45709:0.00036%,-0.24151:0.00036%,1.47576:0.00018%,1.46509:0.00018%,3.6236699999999997:0.00018%,-1.2708:0.00018%,-2.48275:0.00018%,6.06224:0.00018%,-3.3787199999999995:0.00018%,8.10082:0.00018%,6.45955:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.09734%,1:20.83369%,5:18.25736%,4:17.56166%,2:17.24549%,0:0.00446%]
[INFO] ** service:[0.0048200000000000005:99.99822%,-211.09762999999998:0.00054%,-211.73542999999998:0.00054%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.07954%,9:26.09841%,7:18.25807%,1:17.5622%,14:0.00054%,10:0.00054%,3:0.00036%,21:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1532 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3028 - tp: 78514.0000 - fp: 1486.0000 - tn: 318514.0000 - fn: 1486.0000 - accuracy: 0.9926 - precision: 0.9814 - recall: 0.9814 - auc: 0.9883 - val_loss: 6.1088 - val_tp: 12420.0000 - val_fp: 7580.0000 - val_tn: 72420.0000 - val_fn: 7580.0000 - val_accuracy: 0.8484 - val_precision: 0.6210 - val_recall: 0.6210 - val_auc: 0.7631
[INFO] saving weights to checkpoints/lstm-epoch-10-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1258 - tp: 49605.0000 - fp: 30395.0000 - tn: 289605.0000 - fn: 30395.0000 - accuracy: 0.8480 - precision: 0.6201 - recall: 0.6201 - auc: 0.7610 - val_loss: 6.0781 - val_tp: 12458.0000 - val_fp: 7542.0000 - val_tn: 72458.0000 - val_fn: 7542.0000 - val_accuracy: 0.8492 - val_precision: 0.6229 - val_recall: 0.6229 - val_auc: 0.7643
[INFO] saving weights to checkpoints/lstm-epoch-10-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1462 - tp: 49503.0000 - fp: 30497.0000 - tn: 289503.0000 - fn: 30497.0000 - accuracy: 0.8475 - precision: 0.6188 - recall: 0.6188 - auc: 0.7602 - val_loss: 6.1281 - val_tp: 12396.0000 - val_fp: 7604.0000 - val_tn: 72396.0000 - val_fn: 7604.0000 - val_accuracy: 0.8479 - val_precision: 0.6198 - val_recall: 0.6198 - val_auc: 0.7624
[INFO] saving weights to checkpoints/lstm-epoch-10-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.6979 - tp: 66620.0000 - fp: 13380.0000 - tn: 306620.0000 - fn: 13380.0000 - accuracy: 0.9331 - precision: 0.8328 - recall: 0.8328 - auc: 0.8949 - val_loss: 1.4721e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0024 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3731e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/560448
[33m[INFO] loading file 19-19/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (560448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (560448, 17)

[INFO] analyzing data
[INFO] 560448 rows
[INFO] ** appi_name:[21:99.99804%,26:0.00036%,0:0.00036%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:87.23164%,Single Stage Multi Point:12.76836%]
[INFO] ** dst:[21:43.38815%,10:20.82566%,8:18.20883%,9:17.57469%,22:0.00125%,6:0.00054%,25:0.00036%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99804%,-33.760870000000004:0.00178%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99804%,0:0.00178%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.6935%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99875%,2:0.00125%]
[INFO] ** proxy_src_ip:[18:38.11415%,20:26.09983%,13:18.20883%,6:17.57469%,10:0.00107%,11:0.00089%,16:0.00054%]
[INFO] ** s_port:[1.45442:26.09876%,-0.32151:20.82566%,-1.27613:18.20847%,-0.23351:17.57451%,-0.33484:17.28849%,-5.20264:0.00071%,1.45709:0.00054%,-1.02014:0.00054%,-64.19493:0.00036%,-71.14798:0.00036%,1.46509:0.00036%,-1.27347:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-71.14931:0.00018%,-68.79874000000001:0.00018%,0.75578:0.00018%]
[INFO] ** scada_tag:[3:26.09841%,1:20.82548%,5:18.20829%,4:17.57433%,2:17.28831%,0:0.00517%]
[INFO] ** service:[0.0048200000000000005:99.99875%,-211.08346:0.00036%,-186.44547:0.00036%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.11415%,9:26.09983%,7:18.20883%,1:17.57469%,11:0.00107%,10:0.00089%,15:0.00054%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1533 (0.27353%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0021 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3242e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0018 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2660e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0017 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2327e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0015 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.2404 - val_tp: 9775.0000 - val_fp: 10225.0000 - val_tn: 69775.0000 - val_fn: 10225.0000 - val_accuracy: 0.7955 - val_precision: 0.4888 - val_recall: 0.4888 - val_auc: 0.6805
[INFO] saving weights to checkpoints/lstm-epoch-10-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.8273 - tp: 31226.0000 - fp: 48774.0000 - tn: 271226.0000 - fn: 48774.0000 - accuracy: 0.7561 - precision: 0.3903 - recall: 0.3903 - auc: 0.6165 - val_loss: 9.8385 - val_tp: 7792.0000 - val_fp: 12208.0000 - val_tn: 67792.0000 - val_fn: 12208.0000 - val_accuracy: 0.7558 - val_precision: 0.3896 - val_recall: 0.3896 - val_auc: 0.6185
[INFO] saving weights to checkpoints/lstm-epoch-10-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/560448
[33m[INFO] loading file 20-20/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (560448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (560448, 17)

[INFO] analyzing data
[INFO] 560448 rows
[INFO] ** appi_name:[21:99.99661%,30:0.00285%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:92.62519%,Single Stage Multi Point:7.37481%]
[INFO] ** dst:[21:43.42544%,10:20.83762%,8:18.15797%,9:17.57415%,15:0.00285%,22:0.00107%,24:0.00036%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9975%,0:0.0025%]
[INFO] ** i/f_name:[2:99.99715%,3:0.00285%]
[INFO] ** modbus_function_code:[0.02961:99.99661%,-33.760870000000004:0.00339%]
[INFO] ** modbus_function_description:[7:49.99946%,11:49.99715%,0:0.00339%]
[INFO] ** modbus_transaction_id:65536 (11.6935%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99661%,1:0.00285%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.11594%,20:26.14765%,13:18.15815%,6:17.57469%,17:0.00285%,14:0.00054%,16:0.00018%]
[INFO] ** s_port:[1.45442:26.14694%,-0.32151:20.83762%,-1.27613:18.15762%,-0.23351:17.57398%,-0.33484:17.27832%,-71.33197:0.00285%,-0.24151:0.00054%,1.45709:0.00036%,-1.27347:0.00036%,13.431270000000001:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-71.14798:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:26.1464%,1:20.83744%,5:18.15762%,4:17.57362%,2:17.27814%,0:0.00678%]
[INFO] ** service:[0.0048200000000000005:99.99661%,-211.73542999999998:0.00285%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.11594%,9:26.14765%,7:18.15815%,1:17.57469%,14:0.00285%,2:0.00054%,15:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1532 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0724 - tp: 79647.0000 - fp: 353.0000 - tn: 319647.0000 - fn: 353.0000 - accuracy: 0.9982 - precision: 0.9956 - recall: 0.9956 - auc: 0.9972 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.2758 - tp: 68709.0000 - fp: 11291.0000 - tn: 308709.0000 - fn: 11291.0000 - accuracy: 0.9435 - precision: 0.8589 - recall: 0.8589 - auc: 0.9112 - val_loss: 2.9407 - val_tp: 16351.0000 - val_fp: 3649.0000 - val_tn: 76351.0000 - val_fn: 3649.0000 - val_accuracy: 0.9270 - val_precision: 0.8176 - val_recall: 0.8176 - val_auc: 0.8860
[INFO] saving weights to checkpoints/lstm-epoch-10-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9498 - tp: 65363.0000 - fp: 14637.0000 - tn: 305363.0000 - fn: 14637.0000 - accuracy: 0.9268 - precision: 0.8170 - recall: 0.8170 - auc: 0.8850 - val_loss: 2.9480 - val_tp: 16342.0000 - val_fp: 3658.0000 - val_tn: 76342.0000 - val_fn: 3658.0000 - val_accuracy: 0.9268 - val_precision: 0.8171 - val_recall: 0.8171 - val_auc: 0.8857
[INFO] saving weights to checkpoints/lstm-epoch-10-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.5610 - tp: 72256.0000 - fp: 7744.0000 - tn: 312256.0000 - fn: 7744.0000 - accuracy: 0.9613 - precision: 0.9032 - recall: 0.9032 - auc: 0.9391 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.9826e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/560448
[33m[INFO] loading file 21-21/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (560446, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (560446, 17)

[INFO] analyzing data
[INFO] 560446 rows
[INFO] ** appi_name:[21:99.99607%,30:0.00107%,7:0.00054%,26:0.00036%,22:0.00036%,0:0.00036%,31:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:98.91105%,Multi Stage Single Point:1.08895%]
[INFO] ** dst:[21:43.31283%,10:20.98293%,8:18.16535%,9:17.53407%,15:0.00107%,22:0.00089%,24:0.00071%,6:0.00071%,25:0.00036%,16:0.00036%,2:0.00036%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99893%,0:0.00107%]
[INFO] ** i/f_name:[2:99.99893%,3:0.00107%]
[INFO] ** modbus_function_code:[0.02961:99.99607%,-33.760870000000004:0.00375%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99893%,11:49.99715%,0:0.00375%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.69354%)
[INFO] ** orig:[0:99.99929%,2:0.00071%]
[INFO] ** proto:[0:99.9975%,2:0.00143%,1:0.00107%]
[INFO] ** proxy_src_ip:[18:38.30985%,20:25.98555%,13:18.16607%,6:17.53407%,17:0.00107%,10:0.00107%,11:0.00089%,16:0.00054%,1:0.00036%,21:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.98502%,-0.32151:20.98222%,-1.27613:18.16518%,-0.23351:17.53389%,-0.33484:17.32763%,-71.33197:0.00107%,-1.27347:0.00071%,-6.64392:0.00071%,-1.02014:0.00054%,-64.19493:0.00036%,-71.14931:0.00036%,-71.14798:0.00036%,1.47576:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,6.62488:0.00018%,10.15141:0.00018%,-68.79874000000001:0.00018%,7.060860000000001:0.00018%,-3.3787199999999995:0.00018%,-2.2440900000000004:0.00018%,1.45709:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.98448%,1:20.98204%,5:18.165%,4:17.53354%,2:17.32763%,0:0.00732%]
[INFO] ** service:[0.0048200000000000005:99.99679%,-211.73542999999998:0.00107%,-211.09762999999998:0.00054%,-211.08346:0.00036%,-186.44547:0.00036%,-211.08818:0.00036%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.30985%,9:25.98555%,7:18.16607%,1:17.53407%,11:0.00107%,21:0.00089%,10:0.00089%,15:0.00054%,14:0.00036%,3:0.00036%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1527 (0.27246%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/560446
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.7504e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/560446
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1665e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/560446
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.2023e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/560446
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.6689e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/560446
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.1064e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1947e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/560446
[33m[INFO] loading file 22-22/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (329487, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (329487, 17)

[INFO] analyzing data
[INFO] 329487 rows
[INFO] ** appi_name:[21:99.99241%,30:0.00668%,23:0.0003%,22:0.0003%,18:0.0003%]
[INFO] ** classification:[normal:59.77019%,Multi Stage Single Point:40.22981%]
[INFO] ** dst:[21:43.3137%,10:21.00356%,8:18.09965%,9:17.57429%,15:0.00668%,22:0.00121%,19:0.00061%,26:0.0003%]
[INFO] ** i/f_dir:[1:99.99363%,0:0.00637%]
[INFO] ** i/f_name:[2:99.99332%,3:0.00637%,0:0.0003%]
[INFO] ** modbus_function_code:[0.02961:99.99241%,-33.760870000000004:0.00759%]
[INFO] ** modbus_function_description:[7:49.99712%,11:49.9953%,0:0.00759%]
[INFO] ** modbus_transaction_id:65534 (19.88971%)
[INFO] ** orig:[0:99.99484%,2:0.00455%,1:0.00061%]
[INFO] ** proto:[0:99.99302%,1:0.00668%,2:0.0003%]
[INFO] ** proxy_src_ip:[18:38.32959%,20:25.98858%,13:18.09904%,6:17.5752%,17:0.00668%,14:0.00061%,10:0.0003%]
[INFO] ** s_port:[1.45442:25.98767%,-0.32151:21.00356%,-1.27613:18.09904%,-0.23351:17.57429%,-0.33484:17.32603%,-71.33197:0.00668%,1.45709:0.00061%,-0.24151:0.00061%,7.228860000000001:0.00061%,-0.24950999999999998:0.0003%,1.46509:0.0003%,-71.14931:0.0003%]
[INFO] ** scada_tag:[3:25.98737%,1:21.00356%,5:18.09904%,4:17.57399%,2:17.32603%,0:0.01002%]
[INFO] ** service:[0.0048200000000000005:99.99241%,-211.73542999999998:0.00668%,-211.07873999999998:0.00061%,-211.08818:0.0003%]
[INFO] ** src:[22:38.32959%,9:25.98858%,7:18.09904%,1:17.5752%,21:0.00455%,14:0.00212%,2:0.00061%,11:0.0003%]
[INFO] ** type:[0:99.99818%,1:0.00182%]
[INFO] ** unixtime:910 (0.27619%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/329487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.0762 - tp: 64733.0000 - fp: 15267.0000 - tn: 304733.0000 - fn: 15267.0000 - accuracy: 0.9237 - precision: 0.8092 - recall: 0.8092 - auc: 0.8800 - val_loss: 7.5546 - val_tp: 10626.0000 - val_fp: 9374.0000 - val_tn: 70626.0000 - val_fn: 9374.0000 - val_accuracy: 0.8125 - val_precision: 0.5313 - val_recall: 0.5313 - val_auc: 0.7071
[INFO] saving weights to checkpoints/lstm-epoch-10-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/329487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5717 - tp: 42420.0000 - fp: 37580.0000 - tn: 282420.0000 - fn: 37580.0000 - accuracy: 0.8121 - precision: 0.5303 - recall: 0.5303 - auc: 0.7046 - val_loss: 7.5779 - val_tp: 10597.0000 - val_fp: 9403.0000 - val_tn: 70597.0000 - val_fn: 9403.0000 - val_accuracy: 0.8119 - val_precision: 0.5299 - val_recall: 0.5299 - val_auc: 0.7062
[INFO] saving weights to checkpoints/lstm-epoch-10-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/329487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5944 - tp: 42307.0000 - fp: 37693.0000 - tn: 282307.0000 - fn: 37693.0000 - accuracy: 0.8115 - precision: 0.5288 - recall: 0.5288 - auc: 0.7037 - val_loss: 7.5836 - val_tp: 10590.0000 - val_fp: 9410.0000 - val_tn: 70590.0000 - val_fn: 9410.0000 - val_accuracy: 0.8118 - val_precision: 0.5295 - val_recall: 0.5295 - val_auc: 0.7059
[INFO] saving weights to checkpoints/lstm-epoch-10-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/329487
[33m[INFO] loading file 23-23/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529487, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529487, 17)

[INFO] analyzing data
[INFO] 529487 rows
[INFO] ** appi_name:[21:99.99887%,31:0.00038%,30:0.00038%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:95.68261%,Multi Stage Single Point:4.31739%]
[INFO] ** dst:[21:43.3293%,10:21.00373%,8:18.1385%,9:17.52621%,22:0.00094%,24:0.00038%,18:0.00038%,15:0.00038%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99887%,-33.760870000000004:0.00113%]
[INFO] ** modbus_function_description:[7:50.00047%,11:49.99839%,0:0.00113%]
[INFO] ** modbus_transaction_id:65536 (12.37726%)
[INFO] ** orig:[0:99.99981%,2:0.00019%]
[INFO] ** proto:[0:99.99906%,2:0.00057%,1:0.00038%]
[INFO] ** proxy_src_ip:[18:38.35127%,20:25.98194%,13:18.13869%,6:17.5264%,16:0.00057%,17:0.00038%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98137%,-0.32151:21.00354%,-1.27613:18.13812%,-0.23351:17.52602%,-0.33484:17.34773%,-1.02014:0.00057%,-1.27347:0.00038%,-0.08551:0.00038%,-71.33197:0.00038%,1.45709:0.00019%,-0.24151:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,1.46509:0.00019%,-64.19493:0.00019%,-0.24950999999999998:0.00019%,-49.275529999999996:0.00019%]
[INFO] ** scada_tag:[3:25.981%,1:21.00354%,5:18.13793%,4:17.52583%,2:17.34755%,0:0.00415%]
[INFO] ** service:[0.0048200000000000005:99.99906%,-211.73542999999998:0.00038%,-186.43601999999998:0.00038%,-186.44547:0.00019%]
[INFO] ** src:[22:38.35127%,9:25.98194%,7:18.13869%,1:17.5264%,15:0.00057%,21:0.00019%,17:0.00019%,14:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1440 (0.27196%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.6059 - tp: 57140.0000 - fp: 22860.0000 - tn: 297140.0000 - fn: 22860.0000 - accuracy: 0.8857 - precision: 0.7143 - recall: 0.7143 - auc: 0.8203 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.5757e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.2517e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.9711e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.6850e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/529487
[33m[INFO] loading file 24-24/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529487, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529487, 17)

[INFO] analyzing data
[INFO] 529487 rows
[INFO] ** appi_name:[21:99.99301%,30:0.0034%,26:0.00057%,31:0.00038%,27:0.00038%,22:0.00038%,0:0.00038%,24:0.00019%,23:0.00019%,19:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,11:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:95.18779%,Multi Stage Single Point:4.81221%]
[INFO] ** dst:[21:43.3597%,10:21.02393%,8:18.09959%,9:17.5094%,15:0.0034%,22:0.00113%,6:0.00076%,25:0.00038%,24:0.00038%,19:0.00038%,18:0.00038%,7:0.00038%,26:0.00019%]
[INFO] ** i/f_dir:[1:99.99679%,0:0.00321%]
[INFO] ** i/f_name:[2:99.9966%,3:0.0034%]
[INFO] ** modbus_function_code:[0.02961:99.99301%,-33.760870000000004:0.00642%,-0.415:0.00019%,0.9188299999999999:0.00019%,0.47422:0.00019%]
[INFO] ** modbus_function_description:[7:49.99745%,11:49.99556%,0:0.00642%,15:0.00019%,10:0.00019%,2:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.37726%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99452%,1:0.0034%,2:0.00208%]
[INFO] ** proxy_src_ip:[18:38.40283%,20:25.98156%,13:18.09959%,6:17.50865%,17:0.0034%,10:0.00132%,14:0.00094%,11:0.00094%,21:0.00038%,16:0.00038%]
[INFO] ** s_port:[1.45442:25.98081%,-0.32151:21.02393%,-1.27613:18.09922%,-0.23351:17.50808%,-0.33484:17.3789%,-71.33197:0.0034%,-9.58113:0.00076%,-71.14798:0.00057%,-1.27347:0.00038%,1.45709:0.00038%,-0.24151:0.00038%,-1.02014:0.00038%,-31.55091:0.00038%,7.6315100000000005:0.00038%,-71.14931:0.00038%,-64.19493:0.00038%,-68.79874000000001:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,7.4901800000000005:0.00019%,13.431270000000001:0.00019%,11.862:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:25.98062%,1:21.02393%,5:18.09903%,4:17.5077%,2:17.37871%,0:0.01001%]
[INFO] ** service:[0.0048200000000000005:99.99415%,-211.73542999999998:0.0034%,-211.08346:0.00057%,-211.07873999999998:0.00038%,-202.75898:0.00038%,-186.44547:0.00038%,-186.43601999999998:0.00038%,-211.08818:0.00038%]
[INFO] ** src:[22:38.40283%,9:25.98156%,7:18.09959%,1:17.50865%,14:0.0034%,11:0.00132%,10:0.00094%,2:0.00094%,15:0.00038%,4:0.00038%]
[INFO] ** type:[0:99.99868%,1:0.00094%,2:0.00038%]
[INFO] ** unixtime:1438 (0.27158%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.5271e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3452e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.1814e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3346e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0374e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1925e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.5932 - tp: 72093.0000 - fp: 7907.0000 - tn: 312093.0000 - fn: 7907.0000 - accuracy: 0.9605 - precision: 0.9012 - recall: 0.9012 - auc: 0.9382 - val_loss: 5.7171 - val_tp: 12906.0000 - val_fp: 7094.0000 - val_tn: 72906.0000 - val_fn: 7094.0000 - val_accuracy: 0.8581 - val_precision: 0.6453 - val_recall: 0.6453 - val_auc: 0.7783
[INFO] saving weights to checkpoints/lstm-epoch-10-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/529487
[33m[INFO] loading file 25-25/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529487, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529487, 17)

[INFO] analyzing data
[INFO] 529487 rows
[INFO] ** appi_name:[21:99.99622%,30:0.00113%,17:0.00076%,22:0.00057%,31:0.00038%,28:0.00019%,26:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** classification:[normal:64.34133%,Multi Stage Single Point:35.65867%]
[INFO] ** dst:[21:43.31627%,10:21.02053%,8:18.14775%,9:17.51091%,15:0.00113%,22:0.00094%,16:0.00076%,6:0.00076%,18:0.00038%,17:0.00038%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99887%,0:0.00113%]
[INFO] ** i/f_name:[2:99.99887%,3:0.00113%]
[INFO] ** modbus_function_code:[0.02961:99.99622%,-33.760870000000004:0.00378%]
[INFO] ** modbus_function_description:[7:49.99896%,11:49.99726%,0:0.00378%]
[INFO] ** modbus_transaction_id:65536 (12.37726%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99773%,2:0.00113%,1:0.00113%]
[INFO] ** proxy_src_ip:[18:38.38111%,20:25.9555%,13:18.14775%,6:17.51148%,17:0.00113%,1:0.00094%,21:0.00076%,16:0.00038%,14:0.00038%,7:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95512%,-0.32151:21.02016%,-1.27613:18.14738%,-0.23351:17.51091%,-0.33484:17.36096%,-71.33197:0.00113%,-71.14931:0.00057%,-0.24151:0.00038%,-1.02014:0.00038%,-49.275529999999996:0.00038%,1.46509:0.00019%,-5.1466400000000005:0.00019%,-1.27347:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,-0.24950999999999998:0.00019%,2.52505:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,6.1115699999999995:0.00019%,-5.08665:0.00019%,1.45709:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:25.95474%,1:21.01997%,5:18.14719%,4:17.51072%,2:17.36077%,0:0.00661%]
[INFO] ** service:[0.0048200000000000005:99.9966%,-211.73542999999998:0.00113%,-205.44247:0.00076%,-211.08818:0.00057%,-186.43601999999998:0.00038%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.38111%,9:25.9555%,7:18.14775%,1:17.51148%,14:0.00113%,3:0.00094%,4:0.00076%,21:0.00038%,15:0.00038%,2:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1439 (0.27177%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7480 - tp: 51471.0000 - fp: 28529.0000 - tn: 291471.0000 - fn: 28529.0000 - accuracy: 0.8574 - precision: 0.6434 - recall: 0.6434 - auc: 0.7771 - val_loss: 5.7646 - val_tp: 12847.0000 - val_fp: 7153.0000 - val_tn: 72847.0000 - val_fn: 7153.0000 - val_accuracy: 0.8569 - val_precision: 0.6424 - val_recall: 0.6424 - val_auc: 0.7765
[INFO] saving weights to checkpoints/lstm-epoch-10-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7455 - tp: 51483.0000 - fp: 28517.0000 - tn: 291483.0000 - fn: 28517.0000 - accuracy: 0.8574 - precision: 0.6435 - recall: 0.6435 - auc: 0.7772 - val_loss: 5.7308 - val_tp: 12889.0000 - val_fp: 7111.0000 - val_tn: 72889.0000 - val_fn: 7111.0000 - val_accuracy: 0.8578 - val_precision: 0.6445 - val_recall: 0.6445 - val_auc: 0.7778
[INFO] saving weights to checkpoints/lstm-epoch-10-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7516 - tp: 51453.0000 - fp: 28547.0000 - tn: 291453.0000 - fn: 28547.0000 - accuracy: 0.8573 - precision: 0.6432 - recall: 0.6432 - auc: 0.7770 - val_loss: 5.7550 - val_tp: 12859.0000 - val_fp: 7141.0000 - val_tn: 72859.0000 - val_fn: 7141.0000 - val_accuracy: 0.8572 - val_precision: 0.6429 - val_recall: 0.6429 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-10-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7389 - tp: 51516.0000 - fp: 28484.0000 - tn: 291516.0000 - fn: 28484.0000 - accuracy: 0.8576 - precision: 0.6439 - recall: 0.6439 - auc: 0.7775 - val_loss: 5.7872 - val_tp: 12819.0000 - val_fp: 7181.0000 - val_tn: 72819.0000 - val_fn: 7181.0000 - val_accuracy: 0.8564 - val_precision: 0.6410 - val_recall: 0.6410 - val_auc: 0.7756
[INFO] saving weights to checkpoints/lstm-epoch-10-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7411 - tp: 51505.0000 - fp: 28495.0000 - tn: 291505.0000 - fn: 28495.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7774 - val_loss: 5.7501 - val_tp: 12865.0000 - val_fp: 7135.0000 - val_tn: 72865.0000 - val_fn: 7135.0000 - val_accuracy: 0.8573 - val_precision: 0.6432 - val_recall: 0.6432 - val_auc: 0.7770
[INFO] saving weights to checkpoints/lstm-epoch-10-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/529487
[33m[INFO] loading file 26-26/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529487, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529487, 17)

[INFO] analyzing data
[INFO] 529487 rows
[INFO] ** appi_name:[21:99.99849%,7:0.00057%,31:0.00019%,30:0.00019%,22:0.00019%,12:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:64.39837%,Single Stage Single Point:30.16354%,Multi Stage Single Point:5.43809%]
[INFO] ** dst:[21:43.31079%,10:21.0855%,8:18.11867%,9:17.48258%,22:0.00076%,24:0.00038%,16:0.00038%,2:0.00038%,18:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99849%,-33.760870000000004:0.00151%]
[INFO] ** modbus_function_description:[7:49.99972%,11:49.99877%,0:0.00151%]
[INFO] ** modbus_transaction_id:65536 (12.37726%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99943%,2:0.00038%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.4678%,20:25.92868%,13:18.11905%,6:17.48258%,1:0.00057%,21:0.00038%,16:0.00038%,17:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.92812%,-0.32151:21.08531%,-1.27613:18.11848%,-0.23351:17.48239%,-0.33484:17.38249%,-1.27347:0.00038%,-1.02014:0.00038%,7.66617:0.00019%,-71.14931:0.00019%,11.57001:0.00019%,-3.3787199999999995:0.00019%,2.52505:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%,1.45709:0.00019%,-49.275529999999996:0.00019%,1.47576:0.00019%,1.46509:0.00019%,14.191239999999999:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.92774%,1:21.08531%,5:18.11848%,4:17.4822%,2:17.38249%,0:0.00378%]
[INFO] ** service:[0.0048200000000000005:99.99868%,-211.09762999999998:0.00057%,-211.35747999999998:0.00019%,-211.73542999999998:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.4678%,9:25.92868%,7:18.11905%,1:17.48258%,3:0.00057%,15:0.00038%,4:0.00038%,21:0.00019%,14:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1437 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7397 - tp: 51512.0000 - fp: 28488.0000 - tn: 291512.0000 - fn: 28488.0000 - accuracy: 0.8576 - precision: 0.6439 - recall: 0.6439 - auc: 0.7774 - val_loss: 5.7308 - val_tp: 12889.0000 - val_fp: 7111.0000 - val_tn: 72889.0000 - val_fn: 7111.0000 - val_accuracy: 0.8578 - val_precision: 0.6445 - val_recall: 0.6445 - val_auc: 0.7778
[INFO] saving weights to checkpoints/lstm-epoch-10-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4212 - tp: 63210.0000 - fp: 16790.0000 - tn: 303210.0000 - fn: 16790.0000 - accuracy: 0.9161 - precision: 0.7901 - recall: 0.7901 - auc: 0.9035 - val_loss: 0.0032 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0660 - tp: 78828.0000 - fp: 1172.0000 - tn: 318828.0000 - fn: 1172.0000 - accuracy: 0.9941 - precision: 0.9854 - recall: 0.9854 - auc: 0.9995 - val_loss: 1.2967e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0539 - tp: 79136.0000 - fp: 864.0000 - tn: 319136.0000 - fn: 864.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9998 - val_loss: 5.3103e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0555 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 4.3690e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/529487
[33m[INFO] loading file 27-27/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (469617, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (469617, 17)

[INFO] analyzing data
[INFO] 469617 rows
[INFO] ** appi_name:[21:99.99936%,30:0.00064%]
[INFO] ** classification:[normal:64.33796%,Single Stage Single Point:35.66204%]
[INFO] ** dst:[21:43.27314%,10:21.06291%,8:18.1878%,9:17.47445%,22:0.00085%,15:0.00064%,24:0.00021%]
[INFO] ** i/f_dir:[1:99.99979%,0:0.00021%]
[INFO] ** i/f_name:[2:99.99936%,3:0.00064%]
[INFO] ** modbus_function_code:[0.02961:99.99936%,-33.760870000000004:0.00064%]
[INFO] ** modbus_function_description:[7:50.00032%,11:49.99904%,0:0.00064%]
[INFO] ** modbus_transaction_id:65536 (13.9552%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99936%,1:0.00064%]
[INFO] ** proxy_src_ip:[18:38.40257%,20:25.93411%,13:18.18759%,6:17.47467%,17:0.00064%,16:0.00043%]
[INFO] ** s_port:[1.45442:25.93347%,-0.32151:21.06291%,-1.27613:18.18737%,-0.23351:17.47424%,-0.33484:17.33966%,-71.33197:0.00064%,-1.02014:0.00043%,-1.27347:0.00021%,1.45709:0.00021%,-0.24950999999999998:0.00021%,1.46509:0.00021%,1.47576:0.00021%,-0.24151:0.00021%]
[INFO] ** scada_tag:[3:25.93305%,1:21.0627%,5:18.18716%,4:17.47403%,2:17.33945%,0:0.00362%]
[INFO] ** service:[0.0048200000000000005:99.99936%,-211.73542999999998:0.00064%]
[INFO] ** src:[22:38.40257%,9:25.93411%,7:18.18759%,1:17.47467%,14:0.00064%,15:0.00043%]
[INFO] ** type:[0:99.99957%,1:0.00043%]
[INFO] ** unixtime:1276 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/469617
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0572 - tp: 79050.0000 - fp: 950.0000 - tn: 319050.0000 - fn: 950.0000 - accuracy: 0.9953 - precision: 0.9881 - recall: 0.9881 - auc: 0.9999 - val_loss: 2.5112e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/469617
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0498 - tp: 79156.0000 - fp: 844.0000 - tn: 319156.0000 - fn: 844.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.5431e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/469617
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0486 - tp: 79162.0000 - fp: 838.0000 - tn: 319162.0000 - fn: 838.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 5.0651e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/469617
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0490 - tp: 79137.0000 - fp: 863.0000 - tn: 319137.0000 - fn: 863.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 2.2447e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/469617
[33m[INFO] loading file 28-28/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (403533, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (403533, 17)

[INFO] analyzing data
[INFO] 403533 rows
[INFO] ** appi_name:[21:99.99257%,30:0.00173%,17:0.00124%,22:0.00099%,7:0.00099%,31:0.00074%,26:0.00074%,28:0.00025%,27:0.00025%,8:0.00025%,0:0.00025%]
[INFO] ** classification:[normal:64.31172%,Single Stage Single Point:35.68828%]
[INFO] ** dst:[21:43.28345%,10:21.02059%,8:18.20495%,9:17.48308%,6:0.00198%,16:0.00173%,18:0.00124%,15:0.00074%,22:0.0005%,17:0.0005%,2:0.0005%,25:0.00025%,7:0.00025%,0:0.00025%]
[INFO] ** i/f_dir:[1:99.99926%,0:0.00074%]
[INFO] ** i/f_name:[2:99.99926%,3:0.00074%]
[INFO] ** modbus_function_code:[0.02961:99.99257%,-33.760870000000004:0.00743%]
[INFO] ** modbus_function_description:[11:49.99641%,7:49.99616%,0:0.00743%]
[INFO] ** modbus_transaction_id:65536 (16.24056%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99554%,2:0.00372%,1:0.00074%]
[INFO] ** proxy_src_ip:[18:38.34259%,20:25.96145%,13:18.2052%,6:17.48333%,1:0.00198%,17:0.00173%,14:0.00149%,7:0.00124%,21:0.00074%,0:0.00025%]
[INFO] ** s_port:[1.45442:25.9612%,-0.32151:21.02059%,-1.27613:18.20495%,-0.23351:17.48283%,-0.33484:17.322%,-71.14798:0.00099%,-71.14931:0.00099%,-71.33197:0.00074%,-0.08551:0.0005%,-0.24151:0.0005%,7.66617:0.00025%,-58.035180000000004:0.00025%,-1.2708:0.00025%,-64.19493:0.00025%,-5.1466400000000005:0.00025%,13.431270000000001:0.00025%,11.57001:0.00025%,14.4699:0.00025%,1.47576:0.00025%,14.191239999999999:0.00025%,-5.08665:0.00025%,10.192739999999999:0.00025%,-3.3787199999999995:0.00025%,6.1115699999999995:0.00025%,2.05573:0.00025%,-43.76509:0.00025%,2.52505:0.00025%,11.862:0.00025%,-58.032509999999995:0.00025%]
[INFO] ** scada_tag:[3:25.96095%,1:21.02059%,5:18.20495%,4:17.48259%,2:17.322%,0:0.00892%]
[INFO] ** service:[0.0048200000000000005:99.99257%,-205.44247:0.00124%,-186.43601999999998:0.00124%,-211.09762999999998:0.00099%,-211.08346:0.00099%,-211.08818:0.00099%,-211.73542999999998:0.00074%,-186.44547:0.00025%,-183.8612:0.00025%,-185.9872:0.00025%,-211.35747999999998:0.00025%,-202.75898:0.00025%]
[INFO] ** src:[22:38.34259%,9:25.96145%,7:18.2052%,1:17.48333%,3:0.00223%,2:0.00149%,21:0.00124%,4:0.00099%,14:0.00074%,8:0.0005%,17:0.00025%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1097 (0.27185%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/403533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0486 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-10-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/403533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0477 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 2.4994e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/403533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0477 - tp: 79077.0000 - fp: 923.0000 - tn: 319077.0000 - fn: 923.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.5684e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/403533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0444 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.4982e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-27-28-batch-300000-400000
[INFO] processing batch 400000-500000/403533
[33m[INFO] loading file 29-29/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (503533, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (503533, 17)

[INFO] analyzing data
[INFO] 503533 rows
[INFO] ** appi_name:[21:99.99881%,30:0.0006%,26:0.0002%,9:0.0002%,3:0.0002%]
[INFO] ** classification:[normal:64.38863%,Single Stage Single Point:35.61137%]
[INFO] ** dst:[21:43.32626%,10:21.06098%,8:18.14538%,9:17.46559%,22:0.0006%,15:0.0006%,24:0.0002%,6:0.0002%,0:0.0002%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** i/f_name:[2:99.9994%,3:0.0006%]
[INFO] ** modbus_function_code:[0.02961:99.99881%,-33.760870000000004:0.00119%]
[INFO] ** modbus_function_description:[7:49.9997%,11:49.99911%,0:0.00119%]
[INFO] ** modbus_transaction_id:65536 (13.01523%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99921%,1:0.0006%,2:0.0002%]
[INFO] ** proxy_src_ip:[18:38.44237%,20:25.94507%,13:18.14578%,6:17.46539%,17:0.0006%,21:0.0002%,16:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.94448%,-0.32151:21.06078%,-1.27613:18.14538%,-0.23351:17.46539%,-0.33484:17.38158%,-71.33197:0.0006%,1.45709:0.0004%,-71.14798:0.0002%,-1.27347:0.0002%,1.47576:0.0002%,14.4699:0.0002%,-61.95768:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.94408%,1:21.06059%,5:18.14538%,4:17.46499%,2:17.38158%,0:0.00338%]
[INFO] ** service:[0.0048200000000000005:99.99901%,-211.73542999999998:0.0006%,-183.8612:0.0002%,-211.08346:0.0002%]
[INFO] ** src:[22:38.44237%,9:25.94507%,7:18.14578%,1:17.46539%,14:0.0006%,15:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** unixtime:1368 (0.27168%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0743 - tp: 78806.0000 - fp: 1194.0000 - tn: 318806.0000 - fn: 1194.0000 - accuracy: 0.9940 - precision: 0.9851 - recall: 0.9851 - auc: 0.9985 - val_loss: 2.9483e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0379 - tp: 79150.0000 - fp: 850.0000 - tn: 319150.0000 - fn: 850.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 3.6197e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0378 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 2.6604e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0358 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 2.5787e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0330 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 2.2109e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/503533
[33m[INFO] loading file 30-30/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (503533, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (503533, 17)

[INFO] analyzing data
[INFO] 503533 rows
[INFO] ** appi_name:[21:99.99742%,30:0.00179%,26:0.0002%,17:0.0002%,12:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:64.36559%,Single Stage Single Point:35.63441%]
[INFO] ** dst:[21:43.33956%,10:21.02285%,8:18.14658%,9:17.48743%,15:0.00179%,22:0.00079%,24:0.0004%,25:0.0002%,16:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99821%,0:0.00179%]
[INFO] ** i/f_name:[2:99.99821%,3:0.00179%]
[INFO] ** modbus_function_code:[0.02961:99.99742%,-33.760870000000004:0.00258%]
[INFO] ** modbus_function_description:[7:49.9997%,11:49.99772%,0:0.00258%]
[INFO] ** modbus_transaction_id:65536 (13.01523%)
[INFO] ** orig:[0:99.99901%,2:0.0006%,1:0.0004%]
[INFO] ** proto:[0:99.99782%,1:0.00179%,2:0.0004%]
[INFO] ** proxy_src_ip:[18:38.36253%,20:25.99969%,13:18.14697%,6:17.48803%,17:0.00179%,7:0.0004%,16:0.0002%,5:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.99949%,-0.32151:21.02265%,-1.27613:18.14638%,-0.23351:17.48724%,-0.33484:17.33988%,-71.33197:0.00179%,-0.24151:0.0006%,-1.27347:0.0004%,-71.14798:0.0002%,-0.24950999999999998:0.0002%,10.192739999999999:0.0002%,1.47576:0.0002%,-61.95768:0.0002%,-1.02014:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.99909%,1:21.02265%,5:18.14618%,4:17.48704%,2:17.33968%,0:0.00536%]
[INFO] ** service:[0.0048200000000000005:99.99762%,-211.73542999999998:0.00179%,-186.44547:0.0002%,-211.08346:0.0002%,-205.44247:0.0002%]
[INFO] ** src:[22:38.36253%,9:25.99969%,7:18.14697%,1:17.48803%,14:0.00119%,21:0.00099%,16:0.0002%,15:0.0002%,8:0.0002%]
[INFO] ** type:[0:99.99921%,1:0.00079%]
[INFO] ** unixtime:1369 (0.27188%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0305 - tp: 79119.0000 - fp: 881.0000 - tn: 319119.0000 - fn: 881.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 4.5644e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0277 - tp: 79141.0000 - fp: 859.0000 - tn: 319141.0000 - fn: 859.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1000e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0277 - tp: 79075.0000 - fp: 925.0000 - tn: 319075.0000 - fn: 925.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 2.0860e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0249 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.3874e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0231 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 3.0888e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/503533
[33m[INFO] loading file 31-31/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (503533, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (503533, 17)

[INFO] analyzing data
[INFO] 503533 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.37592%,Single Stage Single Point:35.62408%]
[INFO] ** dst:[21:43.31871%,10:21.05622%,8:18.12612%,9:17.49776%,22:0.00079%,24:0.0004%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[11:50.0001%,7:49.9999%]
[INFO] ** modbus_transaction_id:65536 (13.01523%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.40602%,20:25.9697%,13:18.12632%,6:17.49756%,16:0.0004%]
[INFO] ** s_port:[1.45442:25.9689%,-0.32151:21.05622%,-1.27613:18.12592%,-0.23351:17.49756%,-0.33484:17.34981%,-1.27347:0.0004%,1.45709:0.0004%,-1.02014:0.0004%,1.46509:0.0002%,1.47576:0.0002%]
[INFO] ** scada_tag:[3:25.96851%,1:21.05602%,5:18.12572%,4:17.49736%,2:17.34961%,0:0.00278%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.40602%,9:25.9697%,7:18.12632%,1:17.49756%,15:0.0004%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1368 (0.27168%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0241 - tp: 79066.0000 - fp: 934.0000 - tn: 319066.0000 - fn: 934.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1930e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79132.0000 - fp: 868.0000 - tn: 319132.0000 - fn: 868.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 4.4691e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79068.0000 - fp: 932.0000 - tn: 319068.0000 - fn: 932.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 7.3490e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/503533
[33m[INFO] loading file 32-32/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (503533, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (503533, 17)

[INFO] analyzing data
[INFO] 503533 rows
[INFO] ** appi_name:[21:99.99603%,30:0.00338%,31:0.0002%,27:0.0002%,26:0.0002%]
[INFO] ** classification:[normal:64.38744%,Single Stage Single Point:35.61256%]
[INFO] ** dst:[21:43.32943%,10:21.05284%,8:18.15134%,9:17.46142%,15:0.00338%,22:0.00099%,18:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99702%,0:0.00298%]
[INFO] ** i/f_name:[2:99.99662%,3:0.00338%]
[INFO] ** modbus_function_code:[0.02961:99.99603%,-33.760870000000004:0.00397%]
[INFO] ** modbus_function_description:[7:49.99871%,11:49.99732%,0:0.00397%]
[INFO] ** modbus_transaction_id:65536 (13.01523%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99603%,1:0.00338%,2:0.0006%]
[INFO] ** proxy_src_ip:[18:38.41695%,20:25.96553%,13:18.15114%,6:17.46221%,17:0.00338%,14:0.0006%,16:0.0002%]
[INFO] ** s_port:[1.45442:25.96513%,-0.32151:21.05284%,-1.27613:18.15095%,-0.23351:17.46142%,-0.33484:17.36411%,-71.33197:0.00338%,-0.24151:0.0006%,-71.14798:0.0002%,11.862:0.0002%,1.45709:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%,13.431270000000001:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.96473%,1:21.05264%,5:18.15095%,4:17.46102%,2:17.36411%,0:0.00655%]
[INFO] ** service:[0.0048200000000000005:99.99603%,-211.73542999999998:0.00338%,-211.08346:0.0002%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.41695%,9:25.96553%,7:18.15114%,1:17.46221%,14:0.00338%,2:0.0006%,15:0.0002%]
[INFO] ** type:[0:99.9996%,1:0.0004%]
[INFO] ** unixtime:1367 (0.27148%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79143.0000 - fp: 857.0000 - tn: 319143.0000 - fn: 857.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.5224e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/503533
[33m[INFO] loading file 33-33/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (503533, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (503533, 17)

[INFO] analyzing data
[INFO] 503533 rows
[INFO] ** appi_name:[21:99.99662%,30:0.00119%,17:0.00079%,22:0.0006%,31:0.0002%,28:0.0002%,26:0.0002%,7:0.0002%]
[INFO] ** classification:[normal:64.39379%,Single Stage Single Point:35.60621%]
[INFO] ** dst:[21:43.33499%,10:21.05383%,8:18.11401%,9:17.4922%,22:0.00119%,15:0.00119%,16:0.00079%,6:0.00079%,24:0.0004%,17:0.0004%,18:0.0002%]
[INFO] ** i/f_dir:[1:99.99881%,0:0.00119%]
[INFO] ** i/f_name:[2:99.99881%,3:0.00119%]
[INFO] ** modbus_function_code:[0.02961:99.99662%,-33.760870000000004:0.00338%]
[INFO] ** modbus_function_description:[7:49.9995%,11:49.99712%,0:0.00338%]
[INFO] ** modbus_transaction_id:65536 (13.01523%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99782%,1:0.00119%,2:0.00099%]
[INFO] ** proxy_src_ip:[18:38.41536%,20:25.97427%,13:18.11401%,6:17.4924%,17:0.00119%,1:0.00079%,16:0.0006%,21:0.0004%,14:0.0004%,7:0.0004%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.97347%,-0.32151:21.05383%,-1.27613:18.11361%,-0.23351:17.492%,-0.33484:17.36152%,-71.33197:0.00119%,-1.02014:0.0006%,-71.14931:0.0006%,1.45709:0.0004%,-1.27347:0.0004%,-71.14798:0.0002%,-58.035180000000004:0.0002%,-5.1466400000000005:0.0002%,-0.24151:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-5.08665:0.0002%,-0.24950999999999998:0.0002%,6.1115699999999995:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:25.97307%,1:21.05383%,5:18.11341%,4:17.4918%,2:17.36152%,0:0.00636%]
[INFO] ** service:[0.0048200000000000005:99.99662%,-211.73542999999998:0.00119%,-205.44247:0.00079%,-211.08818:0.0006%,-211.09762999999998:0.0002%,-211.08346:0.0002%,-185.9872:0.0002%,-186.43601999999998:0.0002%]
[INFO] ** src:[22:38.41536%,9:25.97427%,7:18.11401%,1:17.4924%,14:0.00119%,3:0.00079%,15:0.0006%,21:0.0004%,4:0.0004%,2:0.0004%,8:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1370 (0.27208%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 2.7427e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79063.0000 - fp: 937.0000 - tn: 319063.0000 - fn: 937.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.4859e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79137.0000 - fp: 863.0000 - tn: 319137.0000 - fn: 863.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 2.4844e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/503533
[33m[INFO] loading file 34-34/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (344966, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (344966, 17)

[INFO] analyzing data
[INFO] 344966 rows
[INFO] ** appi_name:[21:99.99768%,7:0.00087%,31:0.00029%,30:0.00029%,22:0.00029%,8:0.00029%,6:0.00029%]
[INFO] ** classification:[normal:64.33504%,Single Stage Single Point:35.66496%]
[INFO] ** dst:[21:43.27006%,10:21.06208%,8:18.21368%,9:17.45129%,22:0.00087%,16:0.00058%,2:0.00058%,18:0.00029%,15:0.00029%,6:0.00029%]
[INFO] ** i/f_dir:[1:99.99971%,0:0.00029%]
[INFO] ** i/f_name:[2:99.99971%,3:0.00029%]
[INFO] ** modbus_function_code:[0.02961:99.99768%,-33.760870000000004:0.00232%]
[INFO] ** modbus_function_description:[7:49.99913%,11:49.99855%,0:0.00232%]
[INFO] ** modbus_transaction_id:65536 (18.99781%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99913%,2:0.00058%,1:0.00029%]
[INFO] ** proxy_src_ip:[18:38.38465%,20:25.94748%,13:18.21368%,6:17.45186%,1:0.00087%,21:0.00058%,17:0.00029%,14:0.00029%,7:0.00029%]
[INFO] ** s_port:[1.45442:25.94719%,-0.32151:21.06179%,-1.27613:18.21368%,-0.23351:17.451%,-0.33484:17.32287%,-0.24151:0.00087%,-3.0613900000000003:0.00029%,-3.3787199999999995:0.00029%,14.191239999999999:0.00029%,1.47576:0.00029%,11.57001:0.00029%,-49.275529999999996:0.00029%,-71.14931:0.00029%,7.66617:0.00029%,-71.33197:0.00029%]
[INFO] ** scada_tag:[3:25.9469%,1:21.0615%,5:18.21339%,4:17.45071%,2:17.32287%,0:0.00464%]
[INFO] ** service:[0.0048200000000000005:99.99797%,-211.09762999999998:0.00087%,-211.73542999999998:0.00029%,-186.43601999999998:0.00029%,-211.35747999999998:0.00029%,-211.08818:0.00029%]
[INFO] ** src:[22:38.38465%,9:25.94748%,7:18.21368%,1:17.45186%,3:0.00087%,4:0.00058%,21:0.00029%,14:0.00029%,2:0.00029%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:937 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/344966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0224 - tp: 79078.0000 - fp: 922.0000 - tn: 319078.0000 - fn: 922.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9998 - val_loss: 1.2606e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/344966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1923e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/344966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79123.0000 - fp: 877.0000 - tn: 319123.0000 - fn: 877.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/344966
[33m[INFO] loading file 35-35/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544966, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544966, 17)

[INFO] analyzing data
[INFO] 544966 rows
[INFO] ** appi_name:[21:99.9989%,30:0.0011%]
[INFO] ** classification:[normal:64.3697%,Single Stage Single Point:35.6303%]
[INFO] ** dst:[21:43.33371%,10:21.03342%,8:18.15508%,9:17.47559%,22:0.0011%,15:0.0011%]
[INFO] ** i/f_dir:[1:99.99908%,0:0.00092%]
[INFO] ** i/f_name:[2:99.9989%,3:0.0011%]
[INFO] ** modbus_function_code:[0.02961:99.9989%,-33.760870000000004:0.0011%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99872%,0:0.0011%]
[INFO] ** modbus_transaction_id:65536 (12.0257%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.9989%,1:0.0011%]
[INFO] ** proxy_src_ip:[18:38.39873%,20:25.96896%,13:18.15471%,6:17.47577%,17:0.0011%,16:0.00073%]
[INFO] ** s_port:[1.45442:25.96841%,-0.32151:21.03342%,-1.27613:18.15471%,-0.23351:17.4754%,-0.33484:17.3653%,-71.33197:0.0011%,-1.02014:0.00073%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.96804%,1:21.03342%,5:18.15453%,4:17.47504%,2:17.3653%,0:0.00367%]
[INFO] ** service:[0.0048200000000000005:99.9989%,-211.73542999999998:0.0011%]
[INFO] ** src:[22:38.39873%,9:25.96896%,7:18.15471%,1:17.47577%,14:0.0011%,15:0.00073%]
[INFO] ** type:[0:99.99908%,1:0.00092%]
[INFO] ** unixtime:1479 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 5.0646e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79141.0000 - fp: 859.0000 - tn: 319141.0000 - fn: 859.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/544966
[33m[INFO] loading file 36-36/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544966, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544966, 17)

[INFO] analyzing data
[INFO] 544966 rows
[INFO] ** appi_name:[21:99.99872%,30:0.00055%,31:0.00037%,33:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.35612%,Single Stage Single Point:35.64388%]
[INFO] ** dst:[21:43.33041%,10:21.0237%,8:18.15636%,9:17.48733%,22:0.00073%,15:0.00055%,24:0.00037%,18:0.00037%,25:0.00018%]
[INFO] ** i/f_dir:[1:99.99945%,0:0.00055%]
[INFO] ** i/f_name:[2:99.99945%,3:0.00055%]
[INFO] ** modbus_function_code:[0.02961:99.99872%,-33.760870000000004:0.00128%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99853%,0:0.00128%]
[INFO] ** modbus_transaction_id:65536 (12.0257%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9989%,2:0.00055%,1:0.00055%]
[INFO] ** proxy_src_ip:[18:38.37267%,20:25.98162%,13:18.15655%,6:17.48788%,17:0.00055%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98107%,-0.32151:21.02351%,-1.27613:18.156%,-0.23351:17.48715%,-0.33484:17.34916%,-0.24151:0.00055%,-71.33197:0.00055%,-1.27347:0.00037%,-0.08551:0.00037%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-49.275529999999996:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.9807%,1:21.02333%,5:18.15581%,4:17.48696%,2:17.34897%,0:0.00422%]
[INFO] ** service:[0.0048200000000000005:99.9989%,-211.73542999999998:0.00055%,-186.43601999999998:0.00037%,-186.44547:0.00018%]
[INFO] ** src:[22:38.37267%,9:25.98162%,7:18.15655%,1:17.48788%,14:0.00055%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1480 (0.27158%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1971e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79076.0000 - fp: 924.0000 - tn: 319076.0000 - fn: 924.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79080.0000 - fp: 920.0000 - tn: 319080.0000 - fn: 920.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79083.0000 - fp: 917.0000 - tn: 319083.0000 - fn: 917.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 8.0988e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/544966
[33m[INFO] loading file 37-37/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544966, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544966, 17)

[INFO] analyzing data
[INFO] 544966 rows
[INFO] ** appi_name:[21:99.9989%,30:0.00073%,26:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:64.37943%,Single Stage Single Point:35.62057%]
[INFO] ** dst:[21:43.33518%,10:21.04241%,8:18.13581%,9:17.48458%,22:0.00073%,15:0.00073%,24:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99927%,3:0.00073%]
[INFO] ** modbus_function_code:[0.02961:99.9989%,-33.760870000000004:0.0011%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99872%,0:0.0011%]
[INFO] ** modbus_transaction_id:65536 (12.0257%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99908%,1:0.00073%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.39139%,20:25.98658%,13:18.13599%,6:17.48458%,17:0.00073%,16:0.00037%,21:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:25.98602%,-0.32151:21.04241%,-1.27613:18.13563%,-0.23351:17.48439%,-0.33484:17.34897%,-71.33197:0.00073%,-1.02014:0.00037%,-71.14798:0.00018%,-1.27347:0.00018%,1.45709:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.2708:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.98584%,1:21.04241%,5:18.13544%,4:17.48421%,2:17.34879%,0:0.0033%]
[INFO] ** service:[0.0048200000000000005:99.9989%,-211.73542999999998:0.00073%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.39139%,9:25.98658%,7:18.13599%,1:17.48458%,14:0.00073%,15:0.00037%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1480 (0.27158%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0196 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 7.5738e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79124.0000 - fp: 876.0000 - tn: 319124.0000 - fn: 876.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79081.0000 - fp: 919.0000 - tn: 319081.0000 - fn: 919.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0216 - tp: 79050.0000 - fp: 950.0000 - tn: 319050.0000 - fn: 950.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9999 - val_loss: 1.0682e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0196 - tp: 79178.0000 - fp: 822.0000 - tn: 319178.0000 - fn: 822.0000 - accuracy: 0.9959 - precision: 0.9897 - recall: 0.9897 - auc: 0.9999 - val_loss: 1.1948e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/544966
[33m[INFO] loading file 38-38/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544966, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544966, 17)

[INFO] analyzing data
[INFO] 544966 rows
[INFO] ** appi_name:[21:99.99908%,30:0.00018%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.41264%,Single Stage Single Point:35.58736%]
[INFO] ** dst:[21:43.32197%,10:21.08866%,8:18.09507%,9:17.49247%,22:0.00092%,25:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99982%,0:0.00018%]
[INFO] ** i/f_name:[2:99.99982%,3:0.00018%]
[INFO] ** modbus_function_code:[0.02961:99.99908%,-33.760870000000004:0.00092%]
[INFO] ** modbus_function_description:[7:49.99963%,11:49.99945%,0:0.00092%]
[INFO] ** modbus_transaction_id:65536 (12.0257%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99945%,2:0.00037%,1:0.00018%]
[INFO] ** proxy_src_ip:[18:38.45946%,20:25.95171%,13:18.09489%,6:17.49283%,7:0.00037%,17:0.00018%,16:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95098%,-0.32151:21.08847%,-1.27613:18.09471%,-0.23351:17.49228%,-0.33484:17.37099%,-0.24151:0.00037%,1.45709:0.00037%,-64.19493:0.00018%,10.192739999999999:0.00018%,-1.02014:0.00018%,-71.14798:0.00018%,-61.95768:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-71.33197:0.00018%]
[INFO] ** scada_tag:[3:25.95061%,1:21.08847%,5:18.09471%,4:17.4921%,2:17.37099%,0:0.00312%]
[INFO] ** service:[0.0048200000000000005:99.99927%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%,-211.73542999999998:0.00018%]
[INFO] ** src:[22:38.45946%,9:25.95171%,7:18.09489%,1:17.49283%,21:0.00037%,16:0.00018%,15:0.00018%,14:0.00018%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1481 (0.27176%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79080.0000 - fp: 920.0000 - tn: 319080.0000 - fn: 920.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.3663e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/544966
[33m[INFO] loading file 39-39/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544966, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544966, 17)

[INFO] analyzing data
[INFO] 544966 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.41007%,Single Stage Single Point:35.58993%]
[INFO] ** dst:[21:43.32472%,10:21.08443%,8:18.1292%,9:17.46054%,22:0.00092%,24:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99982%]
[INFO] ** modbus_transaction_id:65536 (12.0257%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.45561%,20:25.95391%,13:18.12939%,6:17.46054%,16:0.00055%]
[INFO] ** s_port:[1.45442:25.95336%,-0.32151:21.08443%,-1.27613:18.12902%,-0.23351:17.46036%,-0.33484:17.37118%,-1.02014:0.00055%,-1.27347:0.00018%,1.45709:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.2708:0.00018%]
[INFO] ** scada_tag:[3:25.953%,1:21.08425%,5:18.12884%,4:17.46036%,2:17.37099%,0:0.00257%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.45561%,9:25.95391%,7:18.12939%,1:17.46054%,15:0.00055%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1479 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 7.6197e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79124.0000 - fp: 876.0000 - tn: 319124.0000 - fn: 876.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79057.0000 - fp: 943.0000 - tn: 319057.0000 - fn: 943.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/544966
[33m[INFO] loading file 40-40/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544966, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544966, 17)

[INFO] analyzing data
[INFO] 544966 rows
[INFO] ** appi_name:[21:99.99633%,30:0.00312%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.33851%,Single Stage Single Point:35.66149%]
[INFO] ** dst:[21:43.29408%,10:21.03948%,8:18.19325%,9:17.46843%,15:0.00312%,22:0.00092%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99706%,0:0.00294%]
[INFO] ** i/f_name:[2:99.99688%,3:0.00312%]
[INFO] ** modbus_function_code:[0.02961:99.99633%,-33.760870000000004:0.00367%]
[INFO] ** modbus_function_description:[7:49.99927%,11:49.99706%,0:0.00367%]
[INFO] ** modbus_transaction_id:65536 (12.0257%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.99633%,1:0.00312%,2:0.00055%]
[INFO] ** proxy_src_ip:[18:38.35652%,20:25.97795%,13:18.19306%,6:17.4688%,17:0.00312%,14:0.00055%]
[INFO] ** s_port:[1.45442:25.97703%,-0.32151:21.03948%,-1.27613:18.19288%,-0.23351:17.46825%,-0.33484:17.31704%,-71.33197:0.00312%,1.45709:0.00055%,-0.24151:0.00037%,-71.14798:0.00018%,-1.27347:0.00018%,11.862:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,13.431270000000001:0.00018%]
[INFO] ** scada_tag:[3:25.97667%,1:21.03929%,5:18.19269%,4:17.46788%,2:17.31686%,0:0.00661%]
[INFO] ** service:[0.0048200000000000005:99.99633%,-211.73542999999998:0.00312%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.35652%,9:25.97795%,7:18.19306%,1:17.4688%,14:0.00312%,2:0.00055%]
[INFO] ** type:[0:99.99908%,1:0.00092%]
[INFO] ** unixtime:1482 (0.27194%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79076.0000 - fp: 924.0000 - tn: 319076.0000 - fn: 924.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1946e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/544966
[33m[INFO] loading file 41-41/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (485124, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (485124, 17)

[INFO] analyzing data
[INFO] 485124 rows
[INFO] ** appi_name:[21:99.9965%,30:0.00103%,22:0.00082%,17:0.00082%,32:0.00021%,28:0.00021%,26:0.00021%,7:0.00021%]
[INFO] ** classification:[normal:64.38581%,Single Stage Single Point:35.61419%]
[INFO] ** dst:[21:43.32047%,10:21.06101%,8:18.14031%,9:17.47368%,16:0.00103%,15:0.00103%,6:0.00103%,22:0.00062%,24:0.00041%,17:0.00041%]
[INFO] ** i/f_dir:[1:99.99897%,0:0.00103%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.9965%,-33.760870000000004:0.0035%]
[INFO] ** modbus_function_description:[7:49.99897%,11:49.99753%,0:0.0035%]
[INFO] ** modbus_transaction_id:65536 (13.50912%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99773%,2:0.00124%,1:0.00103%]
[INFO] ** proxy_src_ip:[18:38.42997%,20:25.95172%,13:18.14052%,6:17.47388%,17:0.00103%,1:0.00082%,21:0.00041%,16:0.00041%,14:0.00041%,0:0.00041%,7:0.00021%,2:0.00021%]
[INFO] ** s_port:[1.45442:25.9513%,-0.32151:21.06101%,-1.27613:18.1399%,-0.23351:17.47347%,-0.33484:17.36896%,-71.33197:0.00103%,-71.14931:0.00082%,-1.02014:0.00041%,-1.27347:0.00041%,-71.14798:0.00021%,-0.24151:0.00021%,-58.035180000000004:0.00021%,-1.2708:0.00021%,-5.1466400000000005:0.00021%,1.47576:0.00021%,1.46509:0.00021%,-64.19226:0.00021%,-5.08665:0.00021%,-0.24950999999999998:0.00021%,2.05573:0.00021%,-43.76509:0.00021%,-58.032509999999995:0.00021%]
[INFO] ** scada_tag:[3:25.9511%,1:21.06101%,5:18.1399%,4:17.47326%,2:17.36896%,0:0.00577%]
[INFO] ** service:[0.0048200000000000005:99.9965%,-211.73542999999998:0.00103%,-205.44247:0.00082%,-211.08818:0.00082%,89.64175:0.00021%,-211.09762999999998:0.00021%,-211.08346:0.00021%,-185.9872:0.00021%]
[INFO] ** src:[22:38.42997%,9:25.95172%,7:18.14052%,1:17.47388%,14:0.00103%,3:0.00082%,15:0.00041%,8:0.00041%,4:0.00041%,2:0.00041%,21:0.00021%,17:0.00021%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1316 (0.27127%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/485124
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 3.6184e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/485124
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0194 - tp: 79143.0000 - fp: 857.0000 - tn: 319143.0000 - fn: 857.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/485124
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/485124
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.0603e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/485124
[33m[INFO] loading file 42-42/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (428638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (428638, 17)

[INFO] analyzing data
[INFO] 428638 rows
[INFO] ** appi_name:[21:99.99207%,30:0.0021%,17:0.00117%,31:0.00093%,26:0.00093%,7:0.00093%,22:0.0007%,28:0.00023%,27:0.00023%,9:0.00023%,8:0.00023%,0:0.00023%]
[INFO] ** classification:[normal:64.38417%,Single Stage Single Point:35.61583%]
[INFO] ** dst:[21:43.32187%,10:21.05366%,8:18.16848%,9:17.44689%,16:0.0021%,6:0.00187%,18:0.00117%,22:0.00093%,2:0.00093%,15:0.0007%,17:0.00047%,25:0.00023%,24:0.00023%,7:0.00023%,0:0.00023%]
[INFO] ** i/f_dir:[1:99.9993%,0:0.0007%]
[INFO] ** i/f_name:[2:99.9993%,3:0.0007%]
[INFO] ** modbus_function_code:[0.02961:99.99207%,-33.760870000000004:0.00793%]
[INFO] ** modbus_function_description:[7:49.99697%,11:49.9951%,0:0.00793%]
[INFO] ** modbus_transaction_id:65536 (15.28936%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9958%,2:0.0035%,1:0.0007%]
[INFO] ** proxy_src_ip:[18:38.4133%,20:25.96247%,13:18.16894%,6:17.44689%,17:0.0021%,1:0.0021%,14:0.0014%,21:0.00093%,7:0.0007%,16:0.00047%,0:0.00047%,2:0.00023%]
[INFO] ** s_port:[1.45442:25.962%,-0.32151:21.05366%,-1.27613:18.16848%,-0.23351:17.44666%,-0.33484:17.35964%,-71.14798:0.00093%,-71.14931:0.00093%,-71.33197:0.0007%,11.57001:0.00047%,-0.08551:0.00047%,-3.3787199999999995:0.00047%,-1.02014:0.00047%,-5.1466400000000005:0.00023%,-0.24151:0.00023%,13.431270000000001:0.00023%,0.31847:0.00023%,-1.2708:0.00023%,-58.035180000000004:0.00023%,7.66617:0.00023%,-64.19493:0.00023%,1.47576:0.00023%,14.4699:0.00023%,15.912510000000001:0.00023%,14.191239999999999:0.00023%,7.9608300000000005:0.00023%,-5.08665:0.00023%,10.192739999999999:0.00023%,-3.0613900000000003:0.00023%,1.45709:0.00023%,2.05573:0.00023%,-43.76509:0.00023%,11.862:0.00023%,-1.27347:0.00023%,-58.032509999999995:0.00023%]
[INFO] ** scada_tag:[3:25.96153%,1:21.05366%,5:18.16824%,4:17.44666%,2:17.3594%,0:0.0105%]
[INFO] ** service:[0.0048200000000000005:99.99207%,-211.09762999999998:0.00163%,-205.44247:0.00117%,-186.43601999999998:0.00117%,-211.08346:0.00093%,-211.08818:0.00093%,-211.73542999999998:0.0007%,-211.35747999999998:0.00047%,-186.44547:0.00023%,-183.8612:0.00023%,-185.9872:0.00023%,-202.75898:0.00023%]
[INFO] ** src:[22:38.4133%,9:25.96247%,7:18.16894%,1:17.44689%,3:0.0028%,2:0.00163%,4:0.00117%,21:0.00093%,14:0.0007%,15:0.00047%,8:0.00047%,17:0.00023%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1163 (0.27132%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/428638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79139.0000 - fp: 861.0000 - tn: 319139.0000 - fn: 861.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.7321e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/428638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0193 - tp: 79167.0000 - fp: 833.0000 - tn: 319167.0000 - fn: 833.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 1.4719e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/428638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/428638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 6.3549e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-41-42-batch-300000-400000
[INFO] processing batch 400000-500000/428638
[33m[INFO] loading file 43-43/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528638, 17)

[INFO] analyzing data
[INFO] 528638 rows
[INFO] ** appi_name:[21:99.99924%,30:0.00057%,26:0.00019%]
[INFO] ** classification:[normal:64.39984%,Single Stage Single Point:35.60016%]
[INFO] ** dst:[21:43.33154%,10:21.06659%,8:18.13074%,9:17.46923%,22:0.00095%,15:0.00057%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99924%,-33.760870000000004:0.00076%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99905%,0:0.00076%]
[INFO] ** modbus_transaction_id:65536 (12.39714%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99924%,1:0.00057%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.41892%,20:25.97959%,13:18.13093%,6:17.46942%,17:0.00057%,16:0.00038%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.97903%,-0.32151:21.06659%,-1.27613:18.13055%,-0.23351:17.46904%,-0.33484:17.35233%,-71.33197:0.00057%,1.45709:0.00038%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.97865%,1:21.06659%,5:18.13037%,4:17.46866%,2:17.35214%,0:0.00359%]
[INFO] ** service:[0.0048200000000000005:99.99924%,-211.73542999999998:0.00057%,-211.08346:0.00019%]
[INFO] ** src:[22:38.41892%,9:25.97959%,7:18.13093%,1:17.46942%,14:0.00057%,15:0.00038%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1437 (0.27183%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79131.0000 - fp: 869.0000 - tn: 319131.0000 - fn: 869.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.0153e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79136.0000 - fp: 864.0000 - tn: 319136.0000 - fn: 864.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/528638
[33m[INFO] loading file 44-44/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528638, 17)

[INFO] analyzing data
[INFO] 528638 rows
[INFO] ** appi_name:[21:99.99811%,30:0.00076%,31:0.00057%,0:0.00038%,22:0.00019%]
[INFO] ** classification:[normal:64.37089%,Single Stage Single Point:35.62911%]
[INFO] ** dst:[21:43.32303%,10:21.04465%,8:18.16479%,9:17.46412%,22:0.00113%,15:0.00076%,18:0.00057%,25:0.00038%,24:0.00038%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99924%,0:0.00076%]
[INFO] ** i/f_name:[2:99.99924%,3:0.00076%]
[INFO] ** modbus_function_code:[0.02961:99.99811%,-33.760870000000004:0.00189%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99792%,0:0.00189%]
[INFO] ** modbus_transaction_id:65536 (12.39714%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99811%,2:0.00113%,1:0.00076%]
[INFO] ** proxy_src_ip:[18:38.41627%,20:25.95197%,13:18.16498%,6:17.46469%,17:0.00076%,7:0.00038%,16:0.00019%,5:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95122%,-0.32151:21.04465%,-1.27613:18.16441%,-0.23351:17.46394%,-0.33484:17.37162%,-71.33197:0.00076%,-0.24151:0.00057%,-0.08551:0.00038%,-64.19493:0.00038%,-1.27347:0.00038%,1.45709:0.00038%,-1.02014:0.00019%,-1.2708:0.00019%,1.47576:0.00019%,-71.14931:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,4.42897:0.00019%]
[INFO] ** scada_tag:[3:25.95065%,1:21.04465%,5:18.16441%,4:17.46356%,2:17.37143%,0:0.0053%]
[INFO] ** service:[0.0048200000000000005:99.99811%,-211.73542999999998:0.00076%,-186.43601999999998:0.00057%,-186.44547:0.00038%,-211.08818:0.00019%]
[INFO] ** src:[22:38.41627%,9:25.95197%,7:18.16498%,1:17.46469%,14:0.00076%,21:0.00038%,17:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1434 (0.27126%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79067.0000 - fp: 933.0000 - tn: 319067.0000 - fn: 933.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 5.5473e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 4.7024e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79062.0000 - fp: 938.0000 - tn: 319062.0000 - fn: 938.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.5478e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/528638
[33m[INFO] loading file 45-45/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528638, 17)

[INFO] analyzing data
[INFO] 528638 rows
[INFO] ** appi_name:[21:99.99905%,30:0.00057%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.41024%,Single Stage Single Point:35.58976%]
[INFO] ** dst:[21:43.32095%,10:21.08702%,8:18.12564%,9:17.46431%,22:0.00113%,15:0.00057%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99905%,-33.760870000000004:0.00095%]
[INFO] ** modbus_function_description:[7:50.00038%,11:49.99868%,0:0.00095%]
[INFO] ** modbus_transaction_id:65536 (12.39714%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99924%,1:0.00057%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.4804%,20:25.92833%,13:18.12545%,6:17.4645%,17:0.00057%,16:0.00038%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.92757%,-0.32151:21.08702%,-1.27613:18.12545%,-0.23351:17.46412%,-0.33484:17.39338%,1.45709:0.00057%,-71.33197:0.00057%,-1.02014:0.00038%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,14.4699:0.00019%]
[INFO] ** scada_tag:[3:25.927%,1:21.08683%,5:18.12545%,4:17.46412%,2:17.39319%,0:0.0034%]
[INFO] ** service:[0.0048200000000000005:99.99905%,-211.73542999999998:0.00057%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.4804%,9:25.92833%,7:18.12545%,1:17.4645%,14:0.00057%,15:0.00038%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1435 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 3.3035e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0196 - tp: 79145.0000 - fp: 855.0000 - tn: 319145.0000 - fn: 855.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79109.0000 - fp: 891.0000 - tn: 319109.0000 - fn: 891.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/528638
[33m[INFO] loading file 46-46/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528638, 17)

[INFO] analyzing data
[INFO] 528638 rows
[INFO] ** appi_name:[21:99.99811%,30:0.00113%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.42291%,Single Stage Single Point:35.57709%]
[INFO] ** dst:[21:43.34705%,10:21.07302%,8:18.10445%,9:17.47264%,22:0.00113%,15:0.00113%,25:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99905%,0:0.00095%]
[INFO] ** i/f_name:[2:99.99887%,3:0.00113%]
[INFO] ** modbus_function_code:[0.02961:99.99811%,-33.760870000000004:0.00189%]
[INFO] ** modbus_function_description:[11:49.99905%,7:49.99905%,0:0.00189%]
[INFO] ** modbus_transaction_id:65536 (12.39714%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99849%,1:0.00113%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.44635%,20:25.97373%,13:18.10445%,6:17.4732%,17:0.00113%,16:0.00038%,7:0.00038%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97335%,-0.32151:21.07283%,-1.27613:18.10426%,-0.23351:17.47245%,-0.33484:17.37351%,-71.33197:0.00113%,-0.24151:0.00057%,-1.02014:0.00038%,-71.14798:0.00019%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-1.2708:0.00019%,10.192739999999999:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:25.97297%,1:21.07264%,5:18.10407%,4:17.47207%,2:17.37351%,0:0.00473%]
[INFO] ** service:[0.0048200000000000005:99.9983%,-211.73542999999998:0.00113%,-211.08346:0.00019%,-205.44247:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.44635%,9:25.97373%,7:18.10445%,1:17.4732%,14:0.00113%,21:0.00038%,15:0.00038%,16:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99905%,1:0.00095%]
[INFO] ** unixtime:1437 (0.27183%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 5.5944e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79075.0000 - fp: 925.0000 - tn: 319075.0000 - fn: 925.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 3.4261e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79124.0000 - fp: 876.0000 - tn: 319124.0000 - fn: 876.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/528638
[33m[INFO] loading file 47-47/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528638, 17)

[INFO] analyzing data
[INFO] 528638 rows
[INFO] ** appi_name:[21:99.99943%,33:0.00019%,26:0.00019%,17:0.00019%]
[INFO] ** classification:[normal:64.39435%,Single Stage Single Point:35.60565%]
[INFO] ** dst:[21:43.30619%,10:21.08607%,8:18.1281%,9:17.47718%,22:0.0017%,24:0.00038%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99943%,-33.760870000000004:0.00057%]
[INFO] ** modbus_function_description:[7:50.00132%,11:49.99811%,0:0.00057%]
[INFO] ** modbus_transaction_id:65536 (12.39714%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99981%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.45656%,20:25.93646%,13:18.12847%,6:17.47756%,16:0.00038%,7:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.93552%,-0.32151:21.08607%,-1.27613:18.12791%,-0.23351:17.47699%,-0.33484:17.37049%,1.45709:0.00057%,-0.24151:0.00057%,-1.27347:0.00038%,-1.02014:0.00038%,-71.14798:0.00019%,-61.95635:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,10.192739999999999:0.00019%]
[INFO] ** scada_tag:[3:25.93495%,1:21.08588%,5:18.12772%,4:17.4768%,2:17.3703%,0:0.00435%]
[INFO] ** service:[0.0048200000000000005:99.99962%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.45656%,9:25.93646%,7:18.12847%,1:17.47756%,21:0.00038%,15:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1435 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79068.0000 - fp: 932.0000 - tn: 319068.0000 - fn: 932.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 3.5029e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 2.0732e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/528638
[33m[INFO] loading file 48-48/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528638, 17)

[INFO] analyzing data
[INFO] 528638 rows
[INFO] ** appi_name:[21:99.9966%,30:0.00265%,33:0.00019%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.41762%,Single Stage Single Point:35.58238%]
[INFO] ** dst:[21:43.33079%,10:21.08286%,8:18.11391%,9:17.4681%,15:0.00265%,22:0.00095%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99773%,0:0.00227%]
[INFO] ** i/f_name:[2:99.99735%,3:0.00265%]
[INFO] ** modbus_function_code:[0.02961:99.9966%,-33.760870000000004:0.0034%]
[INFO] ** modbus_function_description:[7:49.99887%,11:49.99773%,0:0.0034%]
[INFO] ** modbus_transaction_id:65536 (12.39714%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99678%,1:0.00265%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.45278%,20:25.96105%,13:18.11429%,6:17.4681%,17:0.00265%,14:0.00057%,16:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.96068%,-0.32151:21.08286%,-1.27613:18.11391%,-0.23351:17.46791%,-0.33484:17.36992%,-71.33197:0.00265%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,1.45709:0.00019%,-61.95635:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,13.431270000000001:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.9603%,1:21.08286%,5:18.11391%,4:17.46791%,2:17.36973%,0:0.0053%]
[INFO] ** service:[0.0048200000000000005:99.99678%,-211.73542999999998:0.00265%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.45278%,9:25.96105%,7:18.11429%,1:17.4681%,14:0.00265%,2:0.00057%,15:0.00038%,8:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1434 (0.27126%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79086.0000 - fp: 914.0000 - tn: 319086.0000 - fn: 914.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79128.0000 - fp: 872.0000 - tn: 319128.0000 - fn: 872.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/528638
[33m[INFO] loading file 49-49/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528638, 17)

[INFO] analyzing data
[INFO] 528638 rows
[INFO] ** appi_name:[21:99.99735%,30:0.00095%,17:0.00076%,22:0.00038%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.36862%,Single Stage Single Point:35.63138%]
[INFO] ** dst:[21:43.30336%,10:21.06092%,8:18.14153%,9:17.48985%,22:0.00132%,15:0.00095%,16:0.00076%,6:0.00057%,24:0.00038%,17:0.00038%]
[INFO] ** i/f_dir:[1:99.99905%,0:0.00095%]
[INFO] ** i/f_name:[2:99.99905%,3:0.00095%]
[INFO] ** modbus_function_code:[0.02961:99.99735%,-33.760870000000004:0.00265%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99773%,0:0.00265%]
[INFO] ** modbus_transaction_id:65536 (12.39714%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99849%,1:0.00095%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.42138%,20:25.94365%,13:18.14153%,6:17.49042%,17:0.00095%,1:0.00076%,21:0.00038%,16:0.00038%,14:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.94289%,-0.32151:21.06092%,-1.27613:18.14115%,-0.23351:17.48966%,-0.33484:17.36046%,-71.33197:0.00095%,-0.24151:0.00057%,-1.27347:0.00038%,-1.02014:0.00038%,1.45709:0.00038%,-71.14931:0.00038%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-5.1466400000000005:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,-5.08665:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:25.94252%,1:21.06073%,5:18.14096%,4:17.48928%,2:17.36046%,0:0.00605%]
[INFO] ** service:[0.0048200000000000005:99.99735%,-211.73542999999998:0.00095%,-205.44247:0.00076%,-211.08818:0.00038%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.42138%,9:25.94365%,7:18.14153%,1:17.49042%,14:0.00095%,3:0.00076%,15:0.00038%,4:0.00038%,2:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1435 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1926e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79045.0000 - fp: 955.0000 - tn: 319045.0000 - fn: 955.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79123.0000 - fp: 877.0000 - tn: 319123.0000 - fn: 877.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79078.0000 - fp: 922.0000 - tn: 319078.0000 - fn: 922.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/528638
[33m[INFO] loading file 50-50/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (378620, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (378620, 17)

[INFO] analyzing data
[INFO] 378620 rows
[INFO] ** appi_name:[21:99.99736%,30:0.00106%,7:0.00079%,31:0.00026%,22:0.00026%,8:0.00026%]
[INFO] ** classification:[normal:64.2956%,Single Stage Single Point:35.7044%]
[INFO] ** dst:[21:43.25181%,10:21.04062%,8:18.22725%,9:17.47689%,15:0.00106%,22:0.00053%,16:0.00053%,2:0.00053%,24:0.00026%,18:0.00026%,6:0.00026%]
[INFO] ** i/f_dir:[1:99.99894%,0:0.00106%]
[INFO] ** i/f_name:[2:99.99894%,3:0.00106%]
[INFO] ** modbus_function_code:[0.02961:99.99736%,-33.760870000000004:0.00264%]
[INFO] ** modbus_function_description:[11:49.99894%,7:49.99842%,0:0.00264%]
[INFO] ** modbus_transaction_id:65535 (17.30891%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99842%,1:0.00106%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.36115%,20:25.93154%,13:18.22751%,6:17.47689%,17:0.00106%,1:0.00079%,21:0.00026%,16:0.00026%,14:0.00026%,7:0.00026%]
[INFO] ** s_port:[1.45442:25.93101%,-0.32151:21.04062%,-1.27613:18.22698%,-0.23351:17.47689%,-0.33484:17.32053%,-71.33197:0.00106%,-3.3787199999999995:0.00026%,4.33564:0.00026%,15.912510000000001:0.00026%,7.9608300000000005:0.00026%,1.46509:0.00026%,1.45709:0.00026%,-1.27347:0.00026%,-71.14931:0.00026%,-1.02014:0.00026%,-1.2708:0.00026%,0.31847:0.00026%]
[INFO] ** scada_tag:[3:25.93075%,1:21.04036%,5:18.22672%,4:17.47689%,2:17.32027%,0:0.00502%]
[INFO] ** service:[0.0048200000000000005:99.99736%,-211.73542999999998:0.00106%,-211.09762999999998:0.00079%,-186.43601999999998:0.00026%,-211.35747999999998:0.00026%,-211.08818:0.00026%]
[INFO] ** src:[22:38.36115%,9:25.93154%,7:18.22751%,1:17.47689%,14:0.00106%,3:0.00079%,21:0.00026%,15:0.00026%,4:0.00026%,2:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1029 (0.27178%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/378620
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79081.0000 - fp: 919.0000 - tn: 319081.0000 - fn: 919.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/378620
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79088.0000 - fp: 912.0000 - tn: 319088.0000 - fn: 912.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/378620
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79080.0000 - fp: 920.0000 - tn: 319080.0000 - fn: 920.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1974e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
Using TensorFlow backend.
train.py:159: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version
of pandas will change to not sort by default.

To accept the future behavior, pass 'sort=False'.

To retain the current behavior and silence the warning, pass 'sort=True'.

  df = pd.concat(df_from_each_file, ignore_index=True)
[INFO] saving weights to checkpoints/lstm-epoch-10-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/378620
2020-02-02 23:23:29.566776: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory
2020-02-02 23:23:29.566949: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory
2020-02-02 23:23:29.566965: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-02-02 23:23:30.370732: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2020-02-02 23:23:30.370765: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-02-02 23:23:30.370796: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (bastia): /proc/driver/nvidia/version does not exist
2020-02-02 23:23:30.370941: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-02-02 23:23:30.379962: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2112050000 Hz
2020-02-02 23:23:30.381191: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x4310af0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-02-02 23:23:30.381285: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Date: 2020-02-02 23:23:30.365453
[INFO] input_shape (10, 16)
[INFO] LSTM first and last layer neurons: 5
adding core layer 0
[INFO] created DNN
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2015-12-31_130240_112.log.part10_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1364 (0.2728%)
[INFO] ** orig:[0:99.9992%,1:0.0008%]
[INFO] ** type:[0:99.9984%,1:0.0014%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9984%,3:0.0016%]
[INFO] ** i/f_dir:[1:99.9986%,0:0.0014%]
[INFO] ** src:[22:38.114%,9:26.0964%,7:18.2424%,1:17.543%,14:0.0016%,11:0.0012%,10:0.001%,15:0.0004%]
[INFO] ** dst:[21:43.3686%,10:20.8412%,8:18.2422%,9:17.5434%,15:0.0016%,22:0.0014%,6:0.0006%,25:0.0004%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.997%,1:0.0016%,2:0.0014%]
[INFO] ** appi_name:[21:99.9962%,30:0.0016%,26:0.0004%,0:0.0004%,31:0.0002%,27:0.0002%,24:0.0002%,22:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.114%,20:26.0964%,13:18.2424%,6:17.543%,17:0.0016%,10:0.0012%,11:0.001%,16:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.9962%,-33.760870000000004:0.0036%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9988%,11:49.9974%,0:0.0036%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.0954%,1:20.841%,5:18.242%,4:17.5424%,2:17.2726%,0:0.0066%]
[INFO] ** service:[0.0048200000000000005:99.997%,-211.73542999999998:0.0016%,-186.44547:0.0004%,-211.08346:0.0004%,-186.43601999999998:0.0002%,-211.08818:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.0956%,-0.32151:20.8412%,-1.27613:18.242%,-0.23351:17.5424%,-0.33484:17.2728%,-71.33197:0.0016%,-9.54647:0.0008%,-0.24151:0.0006%,-64.19493:0.0004%,-1.02014:0.0004%,-71.14798:0.0004%,1.45709:0.0004%,-1.27347:0.0002%,1.46509:0.0002%,-68.79874000000001:0.0002%,-71.14931:0.0002%,-3.22139:0.0002%,-1.2708:0.0002%,1.47576:0.0002%]
[INFO] ** classification:[normal:79.7796%,Single Stage Single Point:20.2204%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7327352e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.7327352e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.7327352e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [-1.0388781e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.0388781e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0388781e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 1 1 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.86586643e-17 1.00000000e+00 1.76455856e-17 2.91898274e-16
   2.99595448e-16]
  [1.00000000e+00 1.43208758e-14 6.79222538e-16 6.61241763e-17
   8.69563957e-17]
  [1.05355731e-10 1.00000000e+00 3.34411928e-14 2.07358626e-13
   1.69910689e-13]
  ...
  [1.70778547e-09 1.00000000e+00 9.11592104e-14 3.69787859e-13
   6.22333131e-13]
  [1.06432365e-08 1.00000000e+00 3.95906588e-13 1.78851248e-12
   1.62873870e-12]
  [1.40106511e-11 1.00000000e+00 1.12890789e-14 6.67889816e-14
   6.23856367e-14]]

 [[9.67943195e-17 1.00000000e+00 2.12516993e-17 3.43453808e-16
   3.49507102e-16]
  [5.31411748e-10 1.00000000e+00 4.16946751e-14 2.36357917e-13
   4.85993570e-13]
  [1.13720136e-08 1.00000000e+00 3.72166761e-13 1.48894113e-12
   1.50056172e-12]
  ...
  [1.03703645e-12 1.00000000e+00 2.66550215e-15 1.87497248e-14
   1.99649172e-14]
  [1.01898841e-07 9.99999881e-01 8.65455494e-13 3.80688233e-12
   5.55911176e-12]
  [9.17840381e-09 1.00000000e+00 3.74226746e-13 1.46870060e-12
   1.21936640e-12]]

 [[9.28505480e-01 7.14945495e-02 1.09673493e-09 6.92570723e-10
   7.19153459e-10]
  [9.99999166e-01 8.06129037e-07 4.73890415e-12 1.81200074e-12
   1.95582352e-12]
  [1.81222176e-10 1.00000000e+00 5.69780158e-14 3.55849519e-13
   2.23334453e-13]
  ...
  [3.82060028e-09 1.00000000e+00 1.92199785e-13 8.67400661e-13
   1.11621237e-12]
  [1.00000000e+00 3.16127299e-14 1.39820046e-15 1.37604486e-16
   1.24076510e-16]
  [5.74252841e-12 1.00000000e+00 7.44567372e-15 5.47842479e-14
   4.63683216e-14]]

 ...

 [[6.19099756e-17 1.00000000e+00 1.66828152e-17 2.77891314e-16
   2.85989399e-16]
  [1.99776806e-10 1.00000000e+00 2.53603934e-14 1.54030610e-13
   3.13045759e-13]
  [8.24104473e-02 9.17589545e-01 1.29504474e-09 1.53463064e-09
   1.42763368e-09]
  ...
  [1.00000000e+00 4.75518496e-13 3.83845474e-15 4.53539768e-16
   6.39274082e-16]
  [4.71018016e-12 1.00000000e+00 8.01273178e-15 6.80340861e-14
   4.78283489e-14]
  [2.52814458e-09 1.00000000e+00 1.17113269e-13 4.79376033e-13
   7.62338489e-13]]

 [[6.67789394e-17 1.00000000e+00 1.73820260e-17 2.88075270e-16
   2.95883749e-16]
  [1.00000000e+00 4.44100831e-14 1.17916473e-15 1.26922037e-16
   1.62024565e-16]
  [5.59550453e-12 1.00000000e+00 7.31367634e-15 5.73313302e-14
   4.55549871e-14]
  ...
  [1.37257394e-09 1.00000000e+00 7.44513839e-14 2.66524053e-13
   4.78021106e-13]
  [1.00000000e+00 2.75810932e-15 4.02539650e-16 3.82097820e-17
   4.04182748e-17]
  [2.23390924e-11 1.00000000e+00 1.62989315e-14 1.22805547e-13
   8.97633815e-14]]

 [[6.19104454e-17 1.00000000e+00 1.66828780e-17 2.77892372e-16
   2.85990484e-16]
  [2.00073486e-10 1.00000000e+00 2.53793128e-14 1.54130818e-13
   3.13259564e-13]
  [1.43729328e-09 1.00000000e+00 1.25722349e-13 5.95224662e-13
   6.04807979e-13]
  ...
  [1.03351869e-10 1.00000000e+00 3.01712933e-14 1.86389844e-13
   1.89218202e-13]
  [1.00000000e+00 1.16529880e-14 6.99002558e-16 6.52033985e-17
   8.13018619e-17]
  [4.54660615e-12 1.00000000e+00 7.42783012e-15 6.29936506e-14
   4.55851482e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.8658664e-17 1.0000000e+00 1.7645586e-17 2.9189827e-16 2.9959545e-16]
 [1.0000000e+00 1.4320876e-14 6.7922254e-16 6.6124176e-17 8.6956396e-17]
 [1.0535573e-10 1.0000000e+00 3.3441193e-14 2.0735863e-13 1.6991069e-13]
 ...
 [1.0335187e-10 1.0000000e+00 3.0171293e-14 1.8638984e-13 1.8921820e-13]
 [1.0000000e+00 1.1652988e-14 6.9900256e-16 6.5203399e-17 8.1301862e-17]
 [4.5466061e-12 1.0000000e+00 7.4278301e-15 6.2993651e-14 4.5585148e-14]] (100000, 5)2020-02-02 23:23:33.193510: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-02 23:23:33.197383: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 23:23:33.199159: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 23:23:33.212808: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-02 23:23:33.213717: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-02 23:23:33.215017: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 23:23:33.216357: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 23:23:33.219448: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.

pred 3 (argmax) [1 0 1 ... 1 0 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.699931544494628
tp :  43742.0
fp :  56258.0
tn :  343742.0
fn :  56258.0
accuracy :  0.774970293045044
precision :  0.4374200105667114
recall :  0.4374200105667114
auc :  0.6521366238594055

y_eval {0: 64261, 1: 35739}
pred {0: 18403, 1: 81597}
[INFO] confusion matrix for file 
[[13203 51058     0     0     0]
 [ 5200 30539     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[13203 51058     0     0     0]
 [ 5200 30539     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0388781e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.0388781e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0388781e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-3.4502095e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4502095e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-3.4502095e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 1 1] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.40115636e-17 1.00000000e+00 1.69875353e-17 2.82336384e-16
   2.90311384e-16]
  [1.57100583e-10 1.00000000e+00 2.24792075e-14 1.38536426e-13
   2.80190964e-13]
  [7.05520131e-09 1.00000000e+00 2.85722130e-13 1.19392213e-12
   1.22060435e-12]
  ...
  [3.57309951e-08 1.00000000e+00 4.32182366e-13 1.55630695e-12
   2.91593919e-12]
  [3.17954307e-09 1.00000000e+00 2.64604338e-13 1.29616326e-12
   8.19662643e-13]
  [5.63403382e-13 1.00000000e+00 1.85716823e-15 1.40576874e-14
   1.61621628e-14]]

 [[7.42017604e-17 1.00000000e+00 1.84080972e-17 3.02973203e-16
   3.10224282e-16]
  [1.48647678e-10 1.00000000e+00 2.19004214e-14 1.35163419e-13
   2.72423794e-13]
  [1.47829771e-09 1.00000000e+00 1.26786250e-13 5.98635724e-13
   6.12016622e-13]
  ...
  [3.11201021e-08 1.00000000e+00 4.07579027e-13 1.48497046e-12
   2.72886271e-12]
  [3.67014508e-09 1.00000000e+00 2.81365941e-13 1.35276718e-12
   8.71431941e-13]
  [1.77828065e-12 1.00000000e+00 3.37334302e-15 2.32408206e-14
   2.68977261e-14]]

 [[8.40931597e-17 1.00000000e+00 1.96945384e-17 3.21358900e-16
   3.28143740e-16]
  [1.00000000e+00 6.69366906e-13 3.47513097e-15 4.31526044e-16
   7.99343351e-16]
  [7.18907030e-13 1.00000000e+00 2.65538392e-15 2.45447177e-14
   2.08600159e-14]
  ...
  [1.00707425e-08 1.00000000e+00 3.84426161e-13 1.59169195e-12
   1.30749079e-12]
  [8.35899579e-12 1.00000000e+00 7.49574607e-15 4.53175332e-14
   5.59106086e-14]
  [3.10337245e-09 1.00000000e+00 1.84695765e-13 9.97165458e-13
   9.62773047e-13]]

 ...

 [[6.82015841e-17 1.00000000e+00 1.75818232e-17 2.90974399e-16
   2.98698493e-16]
  [1.00000000e+00 6.00185179e-12 1.25166711e-14 2.11044463e-15
   2.54386695e-15]
  [4.43098158e-01 5.56901872e-01 2.07599826e-09 2.25279595e-09
   2.18613927e-09]
  ...
  [9.61120905e-11 1.00000000e+00 3.30077457e-14 1.53216036e-13
   1.21129438e-13]
  [1.27007249e-09 1.00000000e+00 7.69173475e-14 4.61890725e-13
   8.33744803e-13]
  [3.92798938e-07 9.99999642e-01 2.55702360e-12 7.63925208e-12
   6.04231552e-12]]

 [[9.73836336e-08 9.99999881e-01 1.05883824e-12 3.00695168e-12
   2.89175715e-12]
  [4.98563000e-15 1.00000000e+00 1.58231419e-16 1.97131227e-15
   2.29154769e-15]
  [1.99212900e-06 9.99997973e-01 3.44915784e-12 9.93736950e-12
   1.57968569e-11]
  ...
  [5.16249044e-10 1.00000000e+00 5.11760773e-14 2.20260659e-13
   3.41750743e-13]
  [1.11044081e-08 1.00000000e+00 3.76288085e-13 1.73957680e-12
   1.78238945e-12]
  [7.34472552e-11 1.00000000e+00 2.88152477e-14 1.55739299e-13
   1.29827559e-13]]

 [[6.43361691e-17 1.00000000e+00 1.70345175e-17 2.83023274e-16
   2.90971064e-16]
  [1.00000000e+00 9.16863113e-11 3.39239203e-14 6.33288884e-15
   1.32849240e-14]
  [1.06175051e-12 1.00000000e+00 3.34368416e-15 2.98477267e-14
   2.61821916e-14]
  ...
  [7.64230663e-07 9.99999285e-01 3.50722945e-12 1.16927605e-11
   9.79694884e-12]
  [3.01869792e-12 1.00000000e+00 4.46619255e-15 2.83704572e-14
   3.50963731e-14]
  [5.30802158e-09 1.00000000e+00 2.45068397e-13 1.29822672e-12
   1.22136828e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.40115636e-17 1.00000000e+00 1.69875353e-17 2.82336384e-16
  2.90311384e-16]
 [1.57100583e-10 1.00000000e+00 2.24792075e-14 1.38536426e-13
  2.80190964e-13]
 [7.05520131e-09 1.00000000e+00 2.85722130e-13 1.19392213e-12
  1.22060435e-12]
 ...
 [7.64230663e-07 9.99999285e-01 3.50722945e-12 1.16927605e-11
  9.79694884e-12]
 [3.01869792e-12 1.00000000e+00 4.46619255e-15 2.83704572e-14
  3.50963731e-14]
 [5.30802158e-09 1.00000000e+00 2.45068397e-13 1.29822672e-12
  1.22136828e-12]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.641398051452637
tp :  44263.0
fp :  55737.0
tn :  344263.0
fn :  55737.0
accuracy :  0.7770543098449707
precision :  0.44262999296188354
recall :  0.44262999296188354
auc :  0.6554678678512573

y_eval {0: 64231, 1: 35769}
pred {0: 16412, 1: 83588}
[INFO] confusion matrix for file 
[[12453 51778     0     0     0]
 [ 3959 31810     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 25656 102836      0      0      0]
 [  9159  62349      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4502095e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4502095e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-3.4502095e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 ...
 [ 3.4629455e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 3.4629455e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 3.4629455e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 1 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.27303977e-07 9.99999881e-01 1.21508522e-12 3.37152094e-12
   3.24617178e-12]
  [5.48245675e-15 1.00000000e+00 1.66671123e-16 2.06478299e-15
   2.39469682e-15]
  [4.79993503e-07 9.99999523e-01 1.67745516e-12 5.33111402e-12
   8.30640071e-12]
  ...
  [1.00000000e+00 1.30016345e-10 5.95264059e-14 9.40955687e-15
   1.42814329e-14]
  [7.14983790e-13 1.00000000e+00 3.78449916e-15 4.20820842e-14
   2.13883256e-14]
  [6.88294000e-09 1.00000000e+00 1.69915880e-13 5.92334396e-13
   1.12781139e-12]]

 [[6.50300148e-17 1.00000000e+00 1.71339032e-17 2.84472627e-16
   2.92377456e-16]
  [1.00000000e+00 7.35651678e-11 3.06046556e-14 5.60705572e-15
   1.17110979e-14]
  [5.87414394e-13 1.00000000e+00 2.59224968e-15 2.51072322e-14
   1.96278168e-14]
  ...
  [1.97384068e-07 9.99999762e-01 1.69543633e-12 5.94716420e-12
   5.28014308e-12]
  [9.62312782e-12 1.00000000e+00 8.40778456e-15 4.93637181e-14
   5.81305159e-14]
  [1.00000000e+00 8.71084211e-14 2.02413600e-15 2.34995527e-16
   2.56934898e-16]]

 [[6.50126507e-17 1.00000000e+00 1.71314200e-17 2.84435728e-16
   2.92341775e-16]
  [1.00000000e+00 5.05133869e-12 1.15198183e-14 1.91398064e-15
   2.31124798e-15]
  [1.72570512e-14 1.00000000e+00 3.33304871e-16 3.84858610e-15
   3.68456876e-15]
  ...
  [1.59766582e-08 1.00000000e+00 4.38419266e-13 1.57259318e-12
   1.53967247e-12]
  [1.17161654e-11 1.00000000e+00 9.78316024e-15 6.05052304e-14
   6.50688271e-14]
  [1.00000000e+00 9.46646461e-14 1.99200995e-15 2.29263946e-16
   2.68782109e-16]]

 ...

 [[1.00000000e+00 6.24821592e-12 1.95242399e-14 3.75461838e-15
   3.13339341e-15]
  [8.87924790e-01 1.12075254e-01 1.41613010e-09 1.38091594e-09
   1.27149957e-09]
  [1.00000000e+00 1.49432982e-08 5.45411372e-13 1.40578291e-13
   1.81004964e-13]
  ...
  [2.75057863e-13 1.00000000e+00 2.32220647e-15 2.76468386e-14
   1.39013328e-14]
  [5.56063728e-09 1.00000000e+00 1.48559293e-13 5.26084059e-13
   1.01374800e-12]
  [3.63363455e-08 1.00000000e+00 7.84230807e-13 3.40658231e-12
   3.07926991e-12]]

 [[1.00000000e+00 6.36853504e-12 1.97012172e-14 3.79343155e-15
   3.16650943e-15]
  [8.88876438e-01 1.11123599e-01 1.41184631e-09 1.37600897e-09
   1.26595712e-09]
  [9.99999762e-01 2.67931313e-07 2.26112401e-12 7.41594449e-13
   9.46125123e-13]
  ...
  [4.47705033e-11 1.00000000e+00 2.28898897e-14 1.33876701e-13
   1.06175404e-13]
  [1.00000000e+00 4.84272969e-11 3.26517039e-14 5.72729332e-15
   9.44072938e-15]
  [2.54603565e-12 1.00000000e+00 6.43855832e-15 6.07434296e-14
   3.84343843e-14]]

 [[6.41085754e-17 1.00000000e+00 1.70017330e-17 2.82546474e-16
   2.90508584e-16]
  [1.21396214e-01 8.78603756e-01 1.70764525e-09 4.28001146e-09
   2.44053378e-09]
  [1.35413336e-15 1.00000000e+00 7.01082487e-17 8.34209610e-16
   1.27991761e-15]
  ...
  [2.12285286e-07 9.99999762e-01 1.04395843e-12 3.45060482e-12
   6.56496732e-12]
  [2.56226684e-09 1.00000000e+00 2.29643290e-13 1.13007021e-12
   7.77699086e-13]
  [1.64849742e-12 1.00000000e+00 3.43317742e-15 2.37711411e-14
   2.48036522e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.2730398e-07 9.9999988e-01 1.2150852e-12 3.3715209e-12 3.2461718e-12]
 [5.4824568e-15 1.0000000e+00 1.6667112e-16 2.0647830e-15 2.3946968e-15]
 [4.7999350e-07 9.9999952e-01 1.6774552e-12 5.3311140e-12 8.3064007e-12]
 ...
 [2.1228529e-07 9.9999976e-01 1.0439584e-12 3.4506048e-12 6.5649673e-12]
 [2.5622668e-09 1.0000000e+00 2.2964329e-13 1.1300702e-12 7.7769909e-13]
 [1.6484974e-12 1.0000000e+00 3.4331774e-15 2.3771141e-14 2.4803652e-14]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  9.610122508239746
tp :  39093.0
fp :  60907.0
tn :  339093.0
fn :  60907.0
accuracy :  0.7563745379447937
precision :  0.3909299969673157
recall :  0.3909299969673157
auc :  0.6208696365356445

y_eval {0: 70406, 1: 29594}
pred {0: 14979, 1: 85021}
[INFO] confusion matrix for file 
[[12239 58167     0     0     0]
 [ 2740 26854     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 37895 161003      0      0      0]
 [ 11899  89203      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 0.34629455  0.          0.         ...  4.          0.00482
  -0.23351   ]
 [ 0.34629455  0.          0.         ...  3.          0.00482
   1.45442   ]
 [ 0.34629455  0.          0.         ...  2.          0.00482
  -0.33484   ]
 ...
 [ 1.03761     0.          0.         ...  1.          0.00482
  -0.32151   ]
 [ 1.03761     0.          0.         ...  2.          0.00482
  -0.33484   ]
 [ 1.03761     0.          0.         ...  3.          0.00482
   1.45442   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.00000000e+00 6.61835213e-12 2.00631002e-14 3.87290145e-15
   3.23438747e-15]
  [9.77143943e-01 2.28560157e-02 8.37154235e-10 7.48267726e-10
   4.93470431e-10]
  [2.29402293e-15 1.00000000e+00 1.14525048e-16 1.45660190e-15
   1.50872714e-15]
  ...
  [2.11436685e-07 9.99999762e-01 1.71927360e-12 5.47863794e-12
   4.92045163e-12]
  [1.12057733e-11 1.00000000e+00 8.73661122e-15 4.85167157e-14
   6.11876272e-14]
  [1.00000000e+00 6.19509706e-13 5.29255832e-15 7.51879542e-16
   8.00045012e-16]]

 [[6.37892505e-17 1.00000000e+00 1.69555532e-17 2.81870410e-16
   2.89857692e-16]
  [1.00000000e+00 1.86978912e-08 7.34621728e-13 2.91463658e-13
   2.48905334e-13]
  [8.70526888e-16 1.00000000e+00 6.37019532e-17 8.62853352e-16
   1.01387409e-15]
  ...
  [2.48719001e-08 1.00000000e+00 3.90180699e-13 1.50260663e-12
   2.29062472e-12]
  [3.17487536e-10 1.00000000e+00 6.32526258e-14 3.39001342e-13
   3.14473653e-13]
  [7.43980832e-12 1.00000000e+00 8.16238895e-15 5.45492267e-14
   5.04388198e-14]]

 [[9.68833236e-10 1.00000000e+00 9.87419849e-14 4.19485166e-13
   3.95971531e-13]
  [2.32918102e-14 1.00000000e+00 3.32940170e-16 3.69619682e-15
   4.63115518e-15]
  [3.61749471e-07 9.99999642e-01 1.53358738e-12 4.89414976e-12
   7.23043630e-12]
  ...
  [1.70021007e-12 1.00000000e+00 3.21519710e-15 2.22165544e-14
   2.74211230e-14]
  [1.00000000e+00 1.00233644e-13 2.05762789e-15 2.47296510e-16
   2.89416864e-16]
  [1.66383682e-12 1.00000000e+00 4.22890940e-15 3.77744101e-14
   2.94952627e-14]]

 ...

 [[6.84259552e-17 1.00000000e+00 1.76159262e-17 2.91507686e-16
   2.99139797e-16]
  [9.99995470e-01 4.53810890e-06 5.57456815e-12 2.58318974e-12
   6.38375680e-12]
  [1.22353967e-11 1.00000000e+00 1.23554257e-14 8.91559369e-14
   8.26432835e-14]
  ...
  [2.72079518e-07 9.99999762e-01 1.98190119e-12 8.70186562e-12
   7.54046652e-12]
  [3.62438829e-11 1.00000000e+00 1.53940361e-14 7.79138852e-14
   1.05228848e-13]
  [1.34312539e-09 1.00000000e+00 1.35247756e-13 7.59263583e-13
   6.21311921e-13]]

 [[1.00000000e+00 2.34057440e-09 3.17174726e-13 8.71607745e-14
   7.86277781e-14]
  [4.15088334e-06 9.99995828e-01 1.28415976e-11 4.04022753e-11
   1.58326269e-11]
  [1.00000000e+00 1.98703827e-08 6.04804509e-13 1.49893905e-13
   2.34622380e-13]
  ...
  [3.07320454e-11 1.00000000e+00 1.55115483e-14 1.02498142e-13
   1.13500551e-13]
  [8.80043399e-11 1.00000000e+00 2.85598842e-14 1.73365012e-13
   1.81507641e-13]
  [1.00000000e+00 1.27948452e-09 2.06042621e-13 4.42640377e-14
   5.34362254e-14]]

 [[6.31141851e-17 1.00000000e+00 1.68588739e-17 2.80471773e-16
   2.88471152e-16]
  [9.93148203e-11 1.00000000e+00 1.79141946e-14 1.13977824e-13
   2.26686657e-13]
  [1.23968613e-09 1.00000000e+00 1.14080471e-13 5.44783402e-13
   5.67664080e-13]
  ...
  [2.22716706e-10 1.00000000e+00 4.41306740e-14 2.63897709e-13
   2.80465782e-13]
  [7.15979720e-10 1.00000000e+00 7.68495985e-14 3.49616982e-13
   4.23501593e-13]
  [1.00000000e+00 3.96143618e-10 1.22515442e-13 2.50828699e-14
   2.83328743e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.0000000e+00 6.6183521e-12 2.0063100e-14 3.8729015e-15 3.2343875e-15]
 [9.7714394e-01 2.2856016e-02 8.3715423e-10 7.4826773e-10 4.9347043e-10]
 [2.2940229e-15 1.0000000e+00 1.1452505e-16 1.4566019e-15 1.5087271e-15]
 ...
 [2.2271671e-10 1.0000000e+00 4.4130674e-14 2.6389771e-13 2.8046578e-13]
 [7.1597972e-10 1.0000000e+00 7.6849598e-14 3.4961698e-13 4.2350159e-13]
 [1.0000000e+00 3.9614362e-10 1.2251544e-13 2.5082870e-14 2.8332874e-14]] (100000, 5)
pred 3 (argmax) [0 0 1 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  13.659653520202637
tp :  14349.0
fp :  85651.0
tn :  314349.0
fn :  85651.0
accuracy :  0.6573992967605591
precision :  0.1434900015592575
recall :  0.1434900015592575
auc :  0.4649341106414795

y_eval {0: 100000}
pred {0: 14349, 1: 85651}
[INFO] confusion matrix for file 
[[14349 85651     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 52244 246654      0      0      0]
 [ 11899  89203      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0376101e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0376101e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0376101e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 1.7314672e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.7314672e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.7314672e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.31137021e-17 1.00000000e+00 1.68587449e-17 2.80469629e-16
   2.88470040e-16]
  [2.77998707e-10 1.00000000e+00 2.99929657e-14 1.78522954e-13
   3.63929888e-13]
  [9.09525818e-13 1.00000000e+00 2.96296148e-15 2.61063957e-14
   2.23643380e-14]
  ...
  [3.28659600e-10 1.00000000e+00 7.05774008e-14 3.55637123e-13
   2.41420870e-13]
  [1.51138581e-11 1.00000000e+00 8.46648987e-15 5.60962579e-14
   9.20804909e-14]
  [1.17905586e-07 9.99999881e-01 1.43037177e-12 5.36194396e-12
   4.08122191e-12]]

 [[6.85043124e-17 1.00000000e+00 1.76268830e-17 2.91666743e-16
   2.99292739e-16]
  [1.70124984e-10 1.00000000e+00 2.34154635e-14 1.43440923e-13
   2.90253146e-13]
  [1.00000000e+00 2.88902596e-10 1.02849275e-13 1.98830227e-14
   2.19654312e-14]
  ...
  [6.64995142e-11 1.00000000e+00 2.15232495e-14 1.42123916e-13
   1.73431161e-13]
  [3.77282072e-09 1.00000000e+00 1.91336937e-13 8.00853849e-13
   8.86726510e-13]
  [1.00000000e+00 3.39342288e-09 3.36129101e-13 7.38615712e-14
   9.06446142e-14]]

 [[6.50784082e-17 1.00000000e+00 1.71405703e-17 2.84564901e-16
   2.92475633e-16]
  [1.54433272e-10 1.00000000e+00 2.22962772e-14 1.37548542e-13
   2.77877954e-13]
  [7.59781543e-11 1.00000000e+00 2.94668668e-14 1.84031501e-13
   1.60021139e-13]
  ...
  [2.73463863e-10 1.00000000e+00 4.85263414e-14 2.67276462e-13
   2.93970469e-13]
  [3.31421224e-10 1.00000000e+00 5.42383995e-14 2.69636960e-13
   3.00923403e-13]
  [1.00000000e+00 3.13542192e-10 1.03012617e-13 2.07696544e-14
   2.50660834e-14]]

 ...

 [[6.18460048e-17 1.00000000e+00 1.66733985e-17 2.77753538e-16
   2.85856335e-16]
  [1.35949113e-10 1.00000000e+00 2.09381835e-14 1.30488421e-13
   2.62129348e-13]
  [9.99999762e-01 1.80825865e-07 2.34964587e-12 7.12523627e-13
   7.85844751e-13]
  ...
  [1.37924494e-09 1.00000000e+00 9.69378386e-14 5.56952108e-13
   7.65468201e-13]
  [3.65449782e-09 1.00000000e+00 2.12348883e-13 8.87469297e-13
   8.16040486e-13]
  [9.99992013e-01 7.96193581e-06 1.29908393e-11 4.70879455e-12
   6.98302787e-12]]

 [[6.18113360e-17 1.00000000e+00 1.66683114e-17 2.77678311e-16
   2.85784364e-16]
  [1.36130746e-10 1.00000000e+00 2.09519664e-14 1.30563610e-13
   2.62293388e-13]
  [1.28874755e-09 1.00000000e+00 1.17505289e-13 5.60218647e-13
   5.76941218e-13]
  ...
  [1.00000000e+00 2.88102804e-08 8.60381319e-13 2.58129916e-13
   3.27236692e-13]
  [2.92159390e-13 1.00000000e+00 1.85039366e-15 1.87408581e-14
   1.42154761e-14]
  [9.26066512e-09 1.00000000e+00 2.36164143e-13 9.17474430e-13
   1.32234805e-12]]

 [[9.99999762e-01 2.26534937e-07 2.64329487e-12 9.45338642e-13
   9.29167767e-13]
  [3.52852513e-14 1.00000000e+00 6.62254351e-16 8.42055951e-15
   4.95767495e-15]
  [1.22569369e-14 1.00000000e+00 2.03613883e-16 2.15934702e-15
   3.52688172e-15]
  ...
  [6.60717481e-09 1.00000000e+00 3.28622763e-13 1.58850450e-12
   1.37507692e-12]
  [3.41773073e-12 1.00000000e+00 5.62711177e-15 3.72623278e-14
   3.27888792e-14]
  [1.19058341e-09 1.00000000e+00 8.55315168e-14 4.97518584e-13
   7.45370996e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.3113702e-17 1.0000000e+00 1.6858745e-17 2.8046963e-16 2.8847004e-16]
 [2.7799871e-10 1.0000000e+00 2.9992966e-14 1.7852295e-13 3.6392989e-13]
 [9.0952582e-13 1.0000000e+00 2.9629615e-15 2.6106396e-14 2.2364338e-14]
 ...
 [6.6071748e-09 1.0000000e+00 3.2862276e-13 1.5885045e-12 1.3750769e-12]
 [3.4177307e-12 1.0000000e+00 5.6271118e-15 3.7262328e-14 3.2788879e-14]
 [1.1905834e-09 1.0000000e+00 8.5531517e-14 4.9751858e-13 7.4537100e-13]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.69678589630127
tp :  14301.0
fp :  85699.0
tn :  314301.0
fn :  85699.0
accuracy :  0.6572072505950928
precision :  0.1430100053548813
recall :  0.1430100053548813
auc :  0.4637196958065033

y_eval {0: 100000}
pred {0: 14301, 1: 85699}
[INFO] confusion matrix for file 
[[14301 85699     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 66545 332353      0      0      0]
 [ 11899  89203      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2015-12-31_181648_113.log.part08_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1370 (0.274%)
[INFO] ** orig:[0:99.9948%,2:0.0052%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9948%,3:0.0052%]
[INFO] ** i/f_dir:[1:99.9948%,0:0.0052%]
[INFO] ** src:[22:38.4402%,9:25.9738%,7:18.1202%,1:17.4598%,21:0.0052%,2:0.0004%,15:0.0002%,11:0.0002%]
[INFO] ** dst:[21:43.345%,10:21.0682%,8:18.1202%,9:17.4594%,15:0.0052%,22:0.0012%,19:0.0004%,26:0.0002%,24:0.0002%]
[INFO] ** proto:[0:99.9946%,1:0.0052%,2:0.0002%]
[INFO] ** appi_name:[21:99.9942%,30:0.0052%,23:0.0002%,22:0.0002%,18:0.0002%]
[INFO] ** proxy_src_ip:[18:38.4402%,20:25.9738%,13:18.1202%,6:17.4598%,17:0.0052%,14:0.0004%,16:0.0002%,10:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9942%,-33.760870000000004:0.0058%]
[INFO] ** modbus_function_description:[7:49.998%,11:49.9962%,0:0.0058%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:25.9726%,1:21.0682%,5:18.1198%,4:17.459%,2:17.3718%,0:0.0086%]
[INFO] ** service:[0.0048200000000000005:99.9942%,-211.73542999999998:0.0052%,-211.07873999999998:0.0004%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:25.973%,-0.32151:21.0682%,-1.27613:18.12%,-0.23351:17.4592%,-0.33484:17.372%,-71.33197:0.0052%,-0.24151:0.0006%,1.45709:0.0004%,8.38348:0.0004%,-1.27347:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-71.14931:0.0002%,-1.02014:0.0002%]
[INFO] ** classification:[normal:80.1196%,Multi Stage Multi Point:14.47%,Single Stage Multi Point:5.4104%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7318661  0.         0.        ...  1.         0.00482   -0.32151  ]
 [-1.7318661  0.         0.        ...  2.         0.00482   -0.33484  ]
 [-1.7318661  0.         0.        ...  3.         0.00482    1.45442  ]
 ...
 [-1.0381526  0.         0.        ...  1.         0.00482   -0.32151  ]
 [-1.0381526  0.         0.        ...  3.         0.00482    1.45442  ]
 [-1.0381526  0.         0.        ...  3.         0.00482    1.45442  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.49526635e-17 1.00000000e+00 1.71225990e-17 2.84303379e-16
   2.92221364e-16]
  [1.58561220e-10 1.00000000e+00 2.25876006e-14 1.39091375e-13
   2.81305307e-13]
  [8.52807069e-09 1.00000000e+00 3.15223108e-13 1.29748415e-12
   1.32689584e-12]
  ...
  [1.00000000e+00 1.83575316e-14 9.33814331e-16 9.21875455e-17
   1.03156973e-16]
  [5.38707967e-12 1.00000000e+00 7.72873180e-15 6.18571898e-14
   4.80201240e-14]
  [1.85984817e-07 9.99999762e-01 1.02523198e-12 3.29969429e-12
   6.02670908e-12]]

 [[1.00000000e+00 6.77991691e-12 2.01253809e-14 3.87755801e-15
   3.24549864e-15]
  [9.95891452e-01 4.10854816e-03 3.68440556e-10 2.86220825e-10
   1.90804969e-10]
  [3.14780720e-14 1.00000000e+00 4.50424222e-16 4.62386477e-15
   4.85118808e-15]
  ...
  [3.43409762e-13 1.00000000e+00 1.41795602e-15 1.07296264e-14
   1.25775058e-14]
  [7.83806286e-07 9.99999166e-01 2.48190357e-12 9.45307894e-12
   1.33913757e-11]
  [4.06217815e-09 1.00000000e+00 2.28664689e-13 9.13704117e-13
   8.64305806e-13]]

 [[1.00000000e+00 6.69689087e-12 2.00079177e-14 3.85171462e-15
   3.22359733e-15]
  [9.98846531e-01 1.15348655e-03 1.81765991e-10 1.31735206e-10
   1.00921126e-10]
  [2.64740903e-11 1.00000000e+00 1.44672346e-14 8.24570176e-14
   9.20611786e-14]
  ...
  [1.00000000e+00 6.36412646e-16 1.90310264e-16 1.52306649e-17
   1.59356825e-17]
  [6.57290333e-11 1.00000000e+00 2.62034741e-14 1.69206310e-13
   1.40477229e-13]
  [1.66787544e-08 1.00000000e+00 2.96789665e-13 1.12487894e-12
   2.11792411e-12]]

 ...

 [[7.16671268e-17 1.00000000e+00 1.80640397e-17 2.98001967e-16
   3.05421711e-16]
  [3.27491312e-10 1.00000000e+00 3.25540105e-14 1.91132673e-13
   3.91658521e-13]
  [1.45561763e-09 1.00000000e+00 1.27560018e-13 6.02781063e-13
   6.07541198e-13]
  ...
  [4.26587210e-09 1.00000000e+00 2.49293045e-13 1.10591527e-12
   9.86639047e-13]
  [1.04891104e-11 1.00000000e+00 9.82763370e-15 6.24321829e-14
   5.79060928e-14]
  [2.07486428e-09 1.00000000e+00 1.18127743e-13 6.06404358e-13
   8.57686047e-13]]

 [[7.58886145e-08 9.99999881e-01 9.31485358e-13 2.70310098e-12
   2.59674183e-12]
  [5.31893069e-15 1.00000000e+00 1.63216248e-16 2.02351851e-15
   2.36028822e-15]
  [5.21683319e-07 9.99999523e-01 1.74980874e-12 5.54368270e-12
   8.66892929e-12]
  ...
  [1.00000000e+00 1.73604853e-10 6.59987744e-14 1.03438037e-14
   1.61982701e-14]
  [6.88037951e-13 1.00000000e+00 3.69409661e-15 4.10758260e-14
   2.12234574e-14]
  [1.86578730e-09 1.00000000e+00 8.94610178e-14 3.43064769e-13
   6.17447662e-13]]

 [[7.17390650e-17 1.00000000e+00 1.80738964e-17 2.98145221e-16
   3.05559195e-16]
  [9.93188739e-01 6.81131147e-03 3.23376464e-10 3.63595126e-10
   3.43150175e-10]
  [1.10908478e-14 1.00000000e+00 2.00268341e-16 1.96801393e-15
   3.48152649e-15]
  ...
  [1.52660122e-12 1.00000000e+00 3.30431301e-15 2.30849106e-14
   2.38939660e-14]
  [3.27085019e-07 9.99999642e-01 1.51727665e-12 5.92972026e-12
   9.21845846e-12]
  [1.00000000e+00 1.09922575e-12 7.83204525e-15 9.13408249e-16
   8.65444373e-16]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.4952664e-17 1.0000000e+00 1.7122599e-17 2.8430338e-16 2.9222136e-16]
 [1.5856122e-10 1.0000000e+00 2.2587601e-14 1.3909138e-13 2.8130531e-13]
 [8.5280707e-09 1.0000000e+00 3.1522311e-13 1.2974841e-12 1.3268958e-12]
 ...
 [1.5266012e-12 1.0000000e+00 3.3043130e-15 2.3084911e-14 2.3893966e-14]
 [3.2708502e-07 9.9999964e-01 1.5172766e-12 5.9297203e-12 9.2184585e-12]
 [1.0000000e+00 1.0992257e-12 7.8320453e-15 9.1340825e-16 8.6544437e-16]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  14.228170399475097
tp :  10332.0
fp :  89668.0
tn :  310332.0
fn :  89668.0
accuracy :  0.6413313746452332
precision :  0.10332000255584717
recall :  0.10332000255584717
auc :  0.4382669925689697

y_eval {0: 72948, 2: 27052}
pred {0: 18269, 1: 81731}
[INFO] confusion matrix for file 
[[10332 62616     0     0     0]
 [    0     0     0     0     0]
 [ 7937 19115     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 76877 394969      0      0      0]
 [ 11899  89203      0      0      0]
 [  7937  19115      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0381526e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0381526e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.0381526e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [-3.4698951e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4698951e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-3.4698951e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.5547301e-17 1.0000000e+00 1.7207656e-17 2.8554463e-16 2.9341880e-16]
  [1.0000000e+00 1.9425444e-13 2.3876004e-15 2.9371222e-16 3.7047209e-16]
  [2.2791662e-13 1.0000000e+00 1.3385001e-15 1.3131853e-14 1.1195075e-14]
  ...
  [5.2965757e-12 1.0000000e+00 7.4650420e-15 5.9672936e-14 4.8023512e-14]
  [3.6963296e-08 1.0000000e+00 4.4229290e-13 1.5651840e-12 2.8215930e-12]
  [3.7935735e-09 1.0000000e+00 2.6601922e-13 1.2291035e-12 8.9625882e-13]]

 [[1.0000000e+00 3.2910952e-13 4.8541315e-15 7.6578248e-16 6.1345557e-16]
  [9.9075061e-01 9.2494013e-03 5.2337262e-10 4.4752690e-10 3.2102299e-10]
  [4.3697644e-14 1.0000000e+00 5.8813214e-16 6.2078655e-15 5.5122774e-15]
  ...
  [3.0200169e-08 1.0000000e+00 7.3433734e-13 3.1246249e-12 2.1212472e-12]
  [1.3709392e-12 1.0000000e+00 2.5744423e-15 1.7642248e-14 2.6847905e-14]
  [1.0000000e+00 7.1671303e-15 6.1617613e-16 5.9719985e-17 6.2477236e-17]]

 [[6.8176610e-17 1.0000000e+00 1.7578336e-17 2.9092448e-16 2.9864950e-16]
  [1.0000000e+00 2.2519516e-13 2.5620100e-15 3.1915013e-16 4.0219274e-16]
  [3.2035572e-13 1.0000000e+00 1.6023783e-15 1.5338350e-14 1.3062457e-14]
  ...
  [1.0000000e+00 7.8362786e-14 2.1393985e-15 2.3570928e-16 2.1417411e-16]
  [7.0103439e-13 1.0000000e+00 2.4706185e-15 2.1860440e-14 1.8873798e-14]
  [3.6440806e-06 9.9999630e-01 4.4619594e-12 1.2140112e-11 2.3868680e-11]]

 ...

 [[1.0000000e+00 7.2963792e-13 7.0737742e-15 1.1782475e-15 9.5502234e-16]
  [9.9985909e-01 1.4090056e-04 7.0583858e-11 4.5445460e-11 3.2020771e-11]
  [2.1822159e-10 1.0000000e+00 4.1166963e-14 1.8864164e-13 2.3323831e-13]
  ...
  [1.0000000e+00 6.1659967e-15 5.6003193e-16 5.1120589e-17 5.5053998e-17]
  [7.0948373e-12 1.0000000e+00 8.4662637e-15 6.4473485e-14 5.2652849e-14]
  [1.2814738e-07 9.9999988e-01 8.2005502e-13 2.7267604e-12 5.2426817e-12]]

 [[6.1823360e-17 1.0000000e+00 1.6670091e-17 2.7770481e-16 2.8580946e-16]
  [1.0000000e+00 1.3175057e-10 5.6749707e-14 1.2875134e-14 1.4576004e-14]
  [4.0335912e-15 1.0000000e+00 1.4966371e-16 1.8709276e-15 1.9789296e-15]
  ...
  [1.4101657e-07 9.9999988e-01 8.1905614e-13 2.7371610e-12 5.6341216e-12]
  [3.6538148e-09 1.0000000e+00 2.9117694e-13 1.4061563e-12 8.6174286e-13]
  [1.0367161e-12 1.0000000e+00 2.5095729e-15 1.7763262e-14 2.0823919e-14]]

 [[6.1823598e-17 1.0000000e+00 1.6670091e-17 2.7770481e-16 2.8580946e-16]
  [1.7357141e-10 1.0000000e+00 2.3638575e-14 1.4490109e-13 2.9343829e-13]
  [8.5061764e-08 9.9999988e-01 1.1206365e-12 4.0194354e-12 3.5566780e-12]
  ...
  [4.8982494e-09 1.0000000e+00 2.9931716e-13 1.3383490e-12 9.8479092e-13]
  [9.0200043e-13 1.0000000e+00 2.4971872e-15 1.8770765e-14 2.0082548e-14]
  [4.5150294e-08 1.0000000e+00 5.8336474e-13 2.5213317e-12 3.5123733e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.5547301e-17 1.0000000e+00 1.7207656e-17 2.8554463e-16 2.9341880e-16]
 [1.0000000e+00 1.9425444e-13 2.3876004e-15 2.9371222e-16 3.7047209e-16]
 [2.2791662e-13 1.0000000e+00 1.3385001e-15 1.3131853e-14 1.1195075e-14]
 ...
 [4.8982494e-09 1.0000000e+00 2.9931716e-13 1.3383490e-12 9.8479092e-13]
 [9.0200043e-13 1.0000000e+00 2.4971872e-15 1.8770765e-14 2.0082548e-14]
 [4.5150294e-08 1.0000000e+00 5.8336474e-13 2.5213317e-12 3.5123733e-12]] (100000, 5)
pred 3 (argmax) [1 0 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.140926686096192
tp :  16217.0
fp :  83783.0
tn :  316217.0
fn :  83783.0
accuracy :  0.6648712754249573
precision :  0.16216999292373657
recall :  0.16216999292373657
auc :  0.4776380956172943

y_eval {0: 100000}
pred {0: 16217, 1: 83783}
[INFO] confusion matrix for file 
[[16217 83783     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 93094 478752      0      0      0]
 [ 11899  89203      0      0      0]
 [  7937  19115      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4698951e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4698951e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4698951e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 3.4672397e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 3.4672397e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4672397e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[7.4252728e-17 1.0000000e+00 1.8414981e-17 3.0307495e-16 3.1032016e-16]
  [2.8659311e-10 1.0000000e+00 3.0456628e-14 1.8025734e-13 3.6816779e-13]
  [1.0000000e+00 3.4828415e-15 4.3413647e-16 4.0216185e-17 4.2364131e-17]
  ...
  [1.4268687e-06 9.9999857e-01 3.2997155e-12 1.1860316e-11 1.7469269e-11]
  [4.6656384e-10 1.0000000e+00 7.8483647e-14 3.9109715e-13 3.4414941e-13]
  [1.0000000e+00 6.1213686e-13 5.0437640e-15 5.7838702e-16 6.7712703e-16]]

 [[6.1917771e-17 1.0000000e+00 1.6683897e-17 2.7790722e-16 2.8600467e-16]
  [6.1595007e-10 1.0000000e+00 4.4674215e-14 2.5261149e-13 5.2458504e-13]
  [2.6471190e-09 1.0000000e+00 1.7583636e-13 7.9244358e-13 7.9147382e-13]
  ...
  [1.6365456e-12 1.0000000e+00 3.4904095e-15 2.3719420e-14 2.3891367e-14]
  [3.4194461e-08 1.0000000e+00 4.8018772e-13 2.2670494e-12 3.4412464e-12]
  [1.4347194e-08 1.0000000e+00 4.7962117e-13 1.8524164e-12 1.4848459e-12]]

 [[6.4544136e-17 1.0000000e+00 1.7064890e-17 2.8347276e-16 2.9138984e-16]
  [1.0000000e+00 8.8524283e-13 3.9860206e-15 5.1161584e-16 9.4463444e-16]
  [6.7008486e-13 1.0000000e+00 2.5532584e-15 2.3668894e-14 2.0270037e-14]
  ...
  [1.9295436e-08 1.0000000e+00 5.4456212e-13 2.1537605e-12 1.7435264e-12]
  [2.9973780e-12 1.0000000e+00 4.4452687e-15 2.9190582e-14 3.5293396e-14]
  [6.3732621e-08 9.9999988e-01 8.3858506e-13 3.6970904e-12 3.8404961e-12]]

 ...

 [[7.0231108e-17 1.0000000e+00 1.7866736e-17 2.9514649e-16 3.0265787e-16]
  [1.8272228e-10 1.0000000e+00 2.4276769e-14 1.4798548e-13 2.9979768e-13]
  [2.7098830e-09 1.0000000e+00 1.7430732e-13 7.8468119e-13 7.9976547e-13]
  ...
  [7.0537212e-09 1.0000000e+00 3.0133350e-13 1.2667271e-12 1.2763456e-12]
  [8.6831983e-12 1.0000000e+00 9.6154435e-15 6.4086913e-14 5.2950652e-14]
  [5.1560251e-10 1.0000000e+00 5.4583677e-14 2.9957761e-13 4.5348426e-13]]

 [[6.1896039e-17 1.0000000e+00 1.6680714e-17 2.7786164e-16 2.8595994e-16]
  [1.0000000e+00 6.7998842e-09 2.5557507e-13 6.8585599e-14 1.5577792e-13]
  [2.8903074e-12 1.0000000e+00 5.7264852e-15 4.6854624e-14 4.2310658e-14]
  ...
  [2.0694335e-07 9.9999976e-01 1.7583069e-12 7.2494385e-12 6.1185575e-12]
  [1.0000000e+00 1.1170234e-09 1.6497326e-13 2.7336160e-14 4.2040688e-14]
  [9.3347389e-13 1.0000000e+00 4.3173371e-15 4.4999530e-14 2.3485327e-14]]

 [[1.0000000e+00 4.0452626e-08 1.1780897e-12 3.8119161e-13 3.6728265e-13]
  [2.2958507e-13 1.0000000e+00 1.8539122e-15 2.0972758e-14 1.1292825e-14]
  [1.4335497e-14 1.0000000e+00 2.1648803e-16 2.2229429e-15 3.7489937e-15]
  ...
  [4.3583794e-13 1.0000000e+00 1.7265669e-15 1.3787575e-14 1.4409843e-14]
  [1.7739065e-07 9.9999988e-01 1.1552747e-12 4.6670042e-12 6.8504998e-12]
  [3.9267939e-10 1.0000000e+00 7.6564596e-14 4.0332725e-13 3.1437529e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[7.4252728e-17 1.0000000e+00 1.8414981e-17 3.0307495e-16 3.1032016e-16]
 [2.8659311e-10 1.0000000e+00 3.0456628e-14 1.8025734e-13 3.6816779e-13]
 [1.0000000e+00 3.4828415e-15 4.3413647e-16 4.0216185e-17 4.2364131e-17]
 ...
 [4.3583794e-13 1.0000000e+00 1.7265669e-15 1.3787575e-14 1.4409843e-14]
 [1.7739065e-07 9.9999988e-01 1.1552747e-12 4.6670042e-12 6.8504998e-12]
 [3.9267939e-10 1.0000000e+00 7.6564596e-14 4.0332725e-13 3.1437529e-13]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.47113065032959
tp :  15034.0
fp :  84966.0
tn :  315034.0
fn :  84966.0
accuracy :  0.6601393222808838
precision :  0.1503400057554245
recall :  0.1503400057554245
auc :  0.4687579572200775

y_eval {0: 100000}
pred {0: 15034, 1: 84966}
[INFO] confusion matrix for file 
[[15034 84966     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[108128 563718      0      0      0]
 [ 11899  89203      0      0      0]
 [  7937  19115      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4672397e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4672397e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 3.4672397e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 1.0378871e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.0378871e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0378871e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[5.3888322e-10 1.0000000e+00 7.2967369e-14 3.2637649e-13 3.0746553e-13]
  [1.9586529e-14 1.0000000e+00 3.0329815e-16 3.4048232e-15 4.2711103e-15]
  [2.4325798e-11 1.0000000e+00 1.2155570e-14 8.0827922e-14 9.6010439e-14]
  ...
  [1.4140852e-12 1.0000000e+00 3.8670256e-15 3.4794040e-14 2.7275172e-14]
  [3.7225007e-08 1.0000000e+00 4.4498202e-13 1.5804294e-12 2.8100890e-12]
  [2.6903491e-09 1.0000000e+00 2.2327695e-13 1.0774981e-12 7.9438214e-13]]

 [[7.0352578e-17 1.0000000e+00 1.7883509e-17 2.9538977e-16 3.0289231e-16]
  [1.0061612e-10 1.0000000e+00 1.8045851e-14 1.1451082e-13 2.2763727e-13]
  [1.5300317e-09 1.0000000e+00 1.2728782e-13 5.9787581e-13 6.2256103e-13]
  ...
  [3.3070779e-13 1.0000000e+00 2.1656083e-15 2.3677383e-14 1.4570556e-14]
  [4.3360860e-08 1.0000000e+00 4.3227799e-13 1.4395408e-12 2.8954775e-12]
  [9.3849053e-09 1.0000000e+00 4.4303336e-13 2.0491087e-12 1.4950709e-12]]

 [[7.0372980e-17 1.0000000e+00 1.7886308e-17 2.9543035e-16 3.0293162e-16]
  [1.0071981e-10 1.0000000e+00 1.8055076e-14 1.1456062e-13 2.2774453e-13]
  [1.5315820e-09 1.0000000e+00 1.2735945e-13 5.9816778e-13 6.2283658e-13]
  ...
  [4.0461634e-09 1.0000000e+00 2.2924024e-13 1.0168755e-12 1.0007362e-12]
  [2.2984205e-11 1.0000000e+00 1.5635652e-14 9.5156860e-14 8.0830857e-14]
  [3.8291997e-10 1.0000000e+00 4.8311808e-14 2.7216256e-13 3.9635087e-13]]

 ...

 [[9.9999988e-01 8.0751583e-08 1.6387662e-12 5.4883002e-13 5.2810474e-13]
  [8.9065853e-14 1.0000000e+00 1.0963011e-15 1.3119961e-14 7.4007911e-15]
  [2.8705188e-06 9.9999714e-01 3.4984630e-12 1.0368540e-11 2.5158589e-11]
  ...
  [7.1440211e-12 1.0000000e+00 6.8830503e-15 4.6264784e-14 5.5714094e-14]
  [5.3455116e-09 1.0000000e+00 2.3675498e-13 1.1487401e-12 1.2134363e-12]
  [3.1322524e-11 1.0000000e+00 1.7109142e-14 9.9981980e-14 1.0025582e-13]]

 [[3.2303834e-13 1.0000000e+00 1.5584492e-15 1.3294988e-14 1.2420261e-14]
  [7.1114707e-13 1.0000000e+00 3.4037714e-15 4.1722993e-14 2.1771063e-14]
  [1.0173415e-15 1.0000000e+00 5.9197856e-17 7.2742184e-16 1.0429262e-15]
  ...
  [1.0000000e+00 1.3125301e-09 2.0760635e-13 4.3084222e-14 5.1232334e-14]
  [7.6036027e-14 1.0000000e+00 9.4410493e-16 1.0805738e-14 7.5056174e-15]
  [9.1783726e-08 9.9999988e-01 6.7150750e-13 2.2679402e-12 4.1387922e-12]]

 [[6.3266770e-17 1.0000000e+00 1.6880238e-17 2.8077472e-16 2.8878823e-16]
  [9.9880183e-01 1.1981757e-03 2.2136167e-10 2.9584427e-10 1.5655184e-10]
  [7.6405797e-16 1.0000000e+00 5.6352473e-17 7.4544522e-16 9.7477653e-16]
  ...
  [5.7283372e-13 1.0000000e+00 3.2335733e-15 3.5474268e-14 2.0106465e-14]
  [2.6853800e-10 1.0000000e+00 3.6284154e-14 1.6513226e-13 2.5028926e-13]
  [1.1409426e-08 1.0000000e+00 3.6161468e-13 1.6936720e-12 1.9201374e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[5.3888322e-10 1.0000000e+00 7.2967369e-14 3.2637649e-13 3.0746553e-13]
 [1.9586529e-14 1.0000000e+00 3.0329815e-16 3.4048232e-15 4.2711103e-15]
 [2.4325798e-11 1.0000000e+00 1.2155570e-14 8.0827922e-14 9.6010439e-14]
 ...
 [5.7283372e-13 1.0000000e+00 3.2335733e-15 3.5474268e-14 2.0106465e-14]
 [2.6853800e-10 1.0000000e+00 3.6284154e-14 1.6513226e-13 2.5028926e-13]
 [1.1409426e-08 1.0000000e+00 3.6161468e-13 1.6936720e-12 1.9201374e-12]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  14.5933759185791
tp :  8710.0
fp :  91290.0
tn :  308710.0
fn :  91290.0
accuracy :  0.6348434090614319
precision :  0.08709999918937683
recall :  0.08709999918937683
auc :  0.42941251397132874

y_eval {0: 74770, 4: 25230}
pred {0: 14664, 1: 85336}
[INFO] confusion matrix for file 
[[ 8710 66060     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [ 5954 19276     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[116838 629778      0      0      0]
 [ 11899  89203      0      0      0]
 [  7937  19115      0      0      0]
 [     0      0      0      0      0]
 [  5954  19276      0      0      0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0378871  0.         0.        ...  2.         0.00482   -0.33484  ]
 [ 1.0378871  0.         0.        ...  3.         0.00482    1.45442  ]
 [ 1.0378871  0.         0.        ...  4.         0.00482   -0.23351  ]
 ...
 [ 1.7316006  0.         0.        ...  3.         0.00482    1.45442  ]
 [ 1.7316006  0.         0.        ...  2.         0.00482   -0.33484  ]
 [ 1.7316006  0.         0.        ...  4.         0.00482   -0.23351  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 4 0 ... 4 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.53039638e-17 1.00000000e+00 1.71727708e-17 2.85033125e-16
   2.92930092e-16]
  [2.50967497e-10 1.00000000e+00 2.85080187e-14 1.70730644e-13
   3.46955808e-13]
  [2.70115809e-12 1.00000000e+00 5.09777038e-15 4.07158438e-14
   3.65579217e-14]
  ...
  [2.70995537e-09 1.00000000e+00 1.86004153e-13 8.60035133e-13
   8.62275529e-13]
  [2.60841869e-11 1.00000000e+00 1.69140723e-14 1.00871724e-13
   8.31359246e-14]
  [1.00000000e+00 1.19832775e-08 4.67852590e-13 1.32042950e-13
   2.26950566e-13]]

 [[1.00000000e+00 2.10496354e-09 3.01737232e-13 8.24225874e-14
   7.42519924e-14]
  [1.45778003e-08 1.00000000e+00 7.26455137e-13 3.84843069e-12
   1.40571658e-12]
  [1.00000000e+00 1.49627208e-08 5.51819495e-13 1.38328354e-13
   1.95806750e-13]
  ...
  [3.67397573e-13 1.00000000e+00 1.50703594e-15 1.25048829e-14
   1.43581554e-14]
  [5.18167786e-10 1.00000000e+00 6.91725865e-14 4.21231409e-13
   4.65249746e-13]
  [1.98539865e-11 1.00000000e+00 1.45573335e-14 9.48938736e-14
   8.48432517e-14]]

 [[3.86358670e-13 1.00000000e+00 1.71100804e-15 1.43756382e-14
   1.34248429e-14]
  [9.99994159e-01 5.81882023e-06 1.78751059e-11 1.31689937e-11
   6.50062382e-12]
  [9.98807907e-01 1.19215646e-03 1.48025689e-10 9.37472669e-11
   1.01996044e-10]
  ...
  [1.75970129e-14 1.00000000e+00 3.82003283e-16 4.21374031e-15
   3.44487940e-15]
  [5.45337890e-08 1.00000000e+00 5.51570074e-13 2.48914973e-12
   4.39699926e-12]
  [1.42350742e-09 1.00000000e+00 1.75776657e-13 9.46876366e-13
   5.99792351e-13]]

 ...

 [[6.28307203e-17 1.00000000e+00 1.68171228e-17 2.79855107e-16
   2.87891782e-16]
  [7.42886516e-11 1.00000000e+00 1.55182941e-14 1.00742128e-13
   1.98174945e-13]
  [1.22546773e-09 1.00000000e+00 1.12222318e-13 5.35415408e-13
   5.65500609e-13]
  ...
  [8.21618468e-11 1.00000000e+00 2.76265979e-14 1.72697360e-13
   1.70274060e-13]
  [4.35325997e-10 1.00000000e+00 5.65445280e-14 2.70819825e-13
   3.50517711e-13]
  [2.74775147e-10 1.00000000e+00 5.80722265e-14 3.29545419e-13
   2.86335896e-13]]

 [[8.93625773e-15 1.00000000e+00 2.37429317e-16 2.72841086e-15
   2.59455467e-15]
  [4.46873875e-12 1.00000000e+00 4.08405025e-15 3.10542506e-14
   5.17954278e-14]
  [4.64129446e-09 1.00000000e+00 2.00703061e-13 8.55173733e-13
   1.01774676e-12]
  ...
  [2.02623369e-11 1.00000000e+00 1.25993551e-14 8.17657303e-14
   8.78628157e-14]
  [9.99999762e-01 2.89755604e-07 2.41325167e-12 8.10536534e-13
   1.21546046e-12]
  [4.38601575e-13 1.00000000e+00 2.64253019e-15 2.81697104e-14
   1.73932625e-14]]

 [[9.99999523e-01 4.73428315e-07 3.75514507e-12 1.41538517e-12
   1.39633108e-12]
  [1.75076933e-14 1.00000000e+00 4.46462331e-16 5.89725260e-15
   3.67771584e-15]
  [5.81065686e-14 1.00000000e+00 4.50039510e-16 4.31259668e-15
   7.19175103e-15]
  ...
  [9.99958634e-01 4.13890411e-05 3.11965592e-11 1.47816186e-11
   1.86523505e-11]
  [7.82061522e-14 1.00000000e+00 1.08683221e-15 1.33113786e-14
   7.93247287e-15]
  [2.83735058e-09 1.00000000e+00 1.14910766e-13 4.68921993e-13
   8.01569043e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.53039638e-17 1.00000000e+00 1.71727708e-17 2.85033125e-16
  2.92930092e-16]
 [2.50967497e-10 1.00000000e+00 2.85080187e-14 1.70730644e-13
  3.46955808e-13]
 [2.70115809e-12 1.00000000e+00 5.09777038e-15 4.07158438e-14
  3.65579217e-14]
 ...
 [9.99958634e-01 4.13890411e-05 3.11965592e-11 1.47816186e-11
  1.86523505e-11]
 [7.82061522e-14 1.00000000e+00 1.08683221e-15 1.33113786e-14
  7.93247287e-15]
 [2.83735058e-09 1.00000000e+00 1.14910766e-13 4.68921993e-13
  8.01569043e-13]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 0 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  15.495775155639649
tp :  3385.0
fp :  96615.0
tn :  303385.0
fn :  96615.0
accuracy :  0.6135435700416565
precision :  0.03384999930858612
recall :  0.03384999930858612
auc :  0.3953937292098999

y_eval {0: 52880, 4: 47120}
pred {0: 14263, 1: 85737}
[INFO] confusion matrix for file 
[[ 3385 49495     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [10878 36242     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[120223 679273      0      0      0]
 [ 11899  89203      0      0      0]
 [  7937  19115      0      0      0]
 [     0      0      0      0      0]
 [ 16832  55518      0      0      0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2015-12-31_181648_113.log.part09_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1359 (0.2718%)
[INFO] ** orig:[0:99.9966%,2:0.0034%]
[INFO] ** type:[0:99.9996%,1:0.0004%]
[INFO] ** i/f_name:[2:99.9938%,3:0.0062%]
[INFO] ** i/f_dir:[1:99.9942%,0:0.0058%]
[INFO] ** src:[22:38.4204%,9:25.9634%,7:18.123%,1:17.486%,21:0.0034%,14:0.0028%,15:0.0006%,2:0.0004%]
[INFO] ** dst:[21:43.3316%,10:21.0518%,8:18.123%,9:17.486%,15:0.0062%,22:0.0008%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.9934%,1:0.0062%,2:0.0004%]
[INFO] ** appi_name:[21:99.9934%,30:0.0062%,31:0.0002%,27:0.0002%]
[INFO] ** proxy_src_ip:[18:38.4204%,20:25.9634%,13:18.123%,6:17.486%,17:0.0062%,16:0.0006%,14:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.9934%,-33.760870000000004:0.0066%]
[INFO] ** modbus_function_description:[7:49.9972%,11:49.9962%,0:0.0066%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:25.9624%,1:21.0518%,5:18.1226%,4:17.4856%,2:17.3686%,0:0.009%]
[INFO] ** service:[0.0048200000000000005:99.9934%,-211.73542999999998:0.0062%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:25.9628%,-0.32151:21.0518%,-1.27613:18.1226%,-0.23351:17.4858%,-0.33484:17.3686%,-71.33197:0.0062%,-1.02014:0.0006%,-1.27347:0.0002%,11.862:0.0002%,1.45709:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,13.431270000000001:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:73.9096%,Multi Stage Multi Point:26.0904%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7313178e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.7313178e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.7313178e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [-1.0397894e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.0397894e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0397894e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 4 0 ... 4 4 4] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.00000000e+00 2.62350336e-10 1.14263620e-13 2.81929309e-14
   2.42055182e-14]
  [9.99988317e-01 1.16725023e-05 1.97052270e-11 9.74994044e-12
   7.52520789e-12]
  [2.88872416e-05 9.99971151e-01 1.69297475e-11 2.57637262e-11
   3.75686010e-11]
  ...
  [5.84094884e-10 1.00000000e+00 5.83364398e-14 3.32926720e-13
   4.99415288e-13]
  [1.00000000e+00 4.11051156e-15 4.69687498e-16 4.23326288e-17
   4.45106748e-17]
  [1.27240857e-11 1.00000000e+00 1.14547018e-14 8.36546273e-14
   6.83245981e-14]]

 [[1.00000000e+00 2.48649490e-10 1.11389989e-13 2.73844312e-14
   2.35028045e-14]
  [9.99987721e-01 1.22631791e-05 2.01921813e-11 1.00335417e-11
   7.73825101e-12]
  [1.79869076e-07 9.99999762e-01 1.27772391e-12 3.11960418e-12
   4.18654824e-12]
  ...
  [1.00000000e+00 2.45967373e-14 1.00926273e-15 9.92361302e-17
   1.21131561e-16]
  [1.03233212e-11 1.00000000e+00 1.09850356e-14 8.40613725e-14
   6.44463121e-14]
  [1.28072557e-08 1.00000000e+00 2.59760258e-13 9.75131326e-13
   1.71593902e-12]]

 [[1.00000000e+00 2.35802183e-10 1.08618674e-13 2.66074902e-14
   2.28278039e-14]
  [9.99948382e-01 5.16352702e-05 4.05865723e-11 2.23587832e-11
   1.70405790e-11]
  [4.43213466e-09 1.00000000e+00 1.93606023e-13 6.71565234e-13
   8.50928703e-13]
  ...
  [6.60778241e-08 9.99999881e-01 1.03040168e-12 4.04015710e-12
   3.59856177e-12]
  [7.34004437e-12 1.00000000e+00 7.97309487e-15 4.91537319e-14
   4.66805007e-14]
  [5.52416646e-09 1.00000000e+00 1.87387215e-13 9.35066911e-13
   1.39890682e-12]]

 ...

 [[7.55346197e-17 1.00000000e+00 1.85867599e-17 3.05551042e-16
   3.12713473e-16]
  [1.48048671e-10 1.00000000e+00 2.18607752e-14 1.34921046e-13
   2.71830545e-13]
  [1.00000000e+00 1.22950030e-15 2.62665976e-16 2.29020834e-17
   2.39842441e-17]
  ...
  [8.43573787e-07 9.99999166e-01 2.65207040e-12 9.75594345e-12
   1.34642150e-11]
  [2.71246747e-10 1.00000000e+00 5.81602366e-14 2.97422080e-13
   2.65590311e-13]
  [6.77219184e-11 1.00000000e+00 2.40599743e-14 1.37320751e-13
   1.44257449e-13]]

 [[7.13370883e-17 1.00000000e+00 1.80157290e-17 2.97259437e-16
   3.04789718e-16]
  [1.79373447e-10 1.00000000e+00 2.40591476e-14 1.46799971e-13
   2.97152168e-13]
  [2.03950812e-09 1.00000000e+00 1.50327098e-13 6.91947910e-13
   7.05479620e-13]
  ...
  [9.68314513e-13 1.00000000e+00 2.60497783e-15 1.84474221e-14
   1.91539865e-14]
  [1.02433944e-07 9.99999881e-01 8.46013743e-13 3.72149143e-12
   5.65513738e-12]
  [1.10958549e-08 1.00000000e+00 4.23773104e-13 1.66713735e-12
   1.32871166e-12]]

 [[7.12807805e-17 1.00000000e+00 1.80080346e-17 2.97148316e-16
   3.04680425e-16]
  [1.00000000e+00 1.57854863e-13 1.81452076e-15 2.03094135e-16
   3.53850978e-16]
  [1.31784749e-04 9.99868155e-01 5.49223202e-11 1.05637214e-10
   9.18944573e-11]
  ...
  [5.63273428e-09 1.00000000e+00 2.08130496e-13 1.15908433e-12
   1.47988100e-12]
  [1.90458831e-08 1.00000000e+00 4.60596567e-13 1.57758626e-12
   1.65432457e-12]
  [2.14293149e-11 1.00000000e+00 1.40739996e-14 8.48673616e-14
   8.55163515e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.0000000e+00 2.6235034e-10 1.1426362e-13 2.8192931e-14 2.4205518e-14]
 [9.9998832e-01 1.1672502e-05 1.9705227e-11 9.7499404e-12 7.5252079e-12]
 [2.8887242e-05 9.9997115e-01 1.6929748e-11 2.5763726e-11 3.7568601e-11]
 ...
 [5.6327343e-09 1.0000000e+00 2.0813050e-13 1.1590843e-12 1.4798810e-12]
 [1.9045883e-08 1.0000000e+00 4.6059657e-13 1.5775863e-12 1.6543246e-12]
 [2.1429315e-11 1.0000000e+00 1.4074000e-14 8.4867362e-14 8.5516351e-14]] (100000, 5)
pred 3 (argmax) [0 0 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  15.03150001373291
tp :  5478.0
fp :  94522.0
tn :  305478.0
fn :  94522.0
accuracy :  0.6219155192375183
precision :  0.05477999895811081
recall :  0.05477999895811081
auc :  0.4080183804035187

y_eval {0: 52975, 4: 47025}
pred {0: 18278, 1: 81722}
[INFO] confusion matrix for file 
[[ 5478 47497     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [12800 34225     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[125701 726770      0      0      0]
 [ 11899  89203      0      0      0]
 [  7937  19115      0      0      0]
 [     0      0      0      0      0]
 [ 29632  89743      0      0      0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0397894e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0397894e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0397894e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-3.4570932e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-3.4570932e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4570932e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [4 0 4 ... 0 4 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.11749750e-02 9.08825040e-01 1.15938614e-09 1.05280795e-09
   1.07380815e-09]
  [6.92291463e-16 1.00000000e+00 6.15719962e-17 8.82944762e-16
   9.24111781e-16]
  [7.67713937e-05 9.99923229e-01 2.05512864e-11 4.69808498e-11
   8.25572041e-11]
  ...
  [4.83495188e-10 1.00000000e+00 5.07509074e-14 2.29867666e-13
   3.51539408e-13]
  [1.99098373e-08 1.00000000e+00 5.20113683e-13 2.22044605e-12
   2.17020954e-12]
  [4.72248837e-11 1.00000000e+00 2.23576854e-14 1.24472549e-13
   1.09470999e-13]]

 [[6.18509612e-17 1.00000000e+00 1.66740983e-17 2.77763067e-16
   2.85866155e-16]
  [2.10868767e-10 1.00000000e+00 2.60565495e-14 1.57712209e-13
   3.20920834e-13]
  [1.00000000e+00 1.20547124e-15 2.61368612e-16 2.27510932e-17
   2.36926150e-17]
  ...
  [2.00704960e-07 9.99999762e-01 1.23052469e-12 4.95776640e-12
   7.53542020e-12]
  [1.00000000e+00 2.80601551e-14 1.32673693e-15 1.28278124e-16
   1.18590357e-16]
  [4.34125739e-12 1.00000000e+00 6.65851795e-15 5.06862855e-14
   4.03128594e-14]]

 [[7.57782012e-17 1.00000000e+00 1.86192615e-17 3.06018816e-16
   3.13165921e-16]
  [1.31315042e-10 1.00000000e+00 2.06009899e-14 1.28194425e-13
   2.57156411e-13]
  [3.17997362e-09 1.00000000e+00 1.87724917e-13 8.33760686e-13
   8.58738590e-13]
  ...
  [6.64414496e-11 1.00000000e+00 2.37822965e-14 1.44522943e-13
   1.52065453e-13]
  [1.00000000e+00 5.32426954e-15 4.98990815e-16 4.41142832e-17
   5.17614720e-17]
  [6.90006993e-12 1.00000000e+00 8.96572516e-15 7.22117001e-14
   5.36590832e-14]]

 ...

 [[7.16381556e-17 1.00000000e+00 1.80601801e-17 2.97946274e-16
   3.05365780e-16]
  [2.50445331e-10 1.00000000e+00 2.84494074e-14 1.69919769e-13
   3.46330332e-13]
  [1.00000000e+00 8.02214062e-14 1.95580733e-15 2.20373356e-16
   2.38151360e-16]
  ...
  [1.05883281e-07 9.99999881e-01 9.17208367e-13 3.99295831e-12
   5.49419928e-12]
  [5.24317756e-10 1.00000000e+00 8.12567177e-14 3.94852309e-13
   3.46453226e-13]
  [1.37339480e-11 1.00000000e+00 1.01563977e-14 6.42107353e-14
   7.20320410e-14]]

 [[6.75897454e-08 9.99999881e-01 8.77673747e-13 2.57267883e-12
   2.47018400e-12]
  [5.80520383e-15 1.00000000e+00 1.70598868e-16 2.10236923e-15
   2.45699991e-15]
  [4.90213552e-07 9.99999523e-01 1.69986562e-12 5.39832979e-12
   8.40869128e-12]
  ...
  [1.25843574e-12 1.00000000e+00 2.79299606e-15 1.91963382e-14
   2.33670098e-14]
  [3.97385875e-08 1.00000000e+00 6.29131133e-13 2.94715619e-12
   3.25057732e-12]
  [1.00000000e+00 1.54886813e-12 7.85469492e-15 9.34548497e-16
   1.11345911e-15]]

 [[1.00000000e+00 1.21844068e-09 2.30988405e-13 6.20683856e-14
   5.57581054e-14]
  [4.07659216e-04 9.99592364e-01 1.23809574e-10 2.41355963e-10
   1.10321176e-10]
  [6.08546956e-16 1.00000000e+00 5.06324830e-17 6.82466410e-16
   8.58810993e-16]
  ...
  [8.95387388e-13 1.00000000e+00 2.36311710e-15 1.69907372e-14
   1.93307403e-14]
  [1.00651653e-06 9.99999046e-01 2.82635200e-12 1.02620993e-11
   1.49097523e-11]
  [5.35446854e-10 1.00000000e+00 8.52606492e-14 4.19048531e-13
   3.53229788e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.1174975e-02 9.0882504e-01 1.1593861e-09 1.0528080e-09 1.0738082e-09]
 [6.9229146e-16 1.0000000e+00 6.1571996e-17 8.8294476e-16 9.2411178e-16]
 [7.6771394e-05 9.9992323e-01 2.0551286e-11 4.6980850e-11 8.2557204e-11]
 ...
 [8.9538739e-13 1.0000000e+00 2.3631171e-15 1.6990737e-14 1.9330740e-14]
 [1.0065165e-06 9.9999905e-01 2.8263520e-12 1.0262099e-11 1.4909752e-11]
 [5.3544685e-10 1.0000000e+00 8.5260649e-14 4.1904853e-13 3.5322979e-13]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  15.25238976135254
tp :  4112.0
fp :  95888.0
tn :  304112.0
fn :  95888.0
accuracy :  0.6164515614509583
precision :  0.041120000183582306
recall :  0.041120000183582306
auc :  0.4000626802444458

y_eval {0: 53029, 4: 46971}
pred {0: 16111, 1: 83889}
[INFO] confusion matrix for file 
[[ 4112 48917     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [11999 34972     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[129813 775687      0      0      0]
 [ 11899  89203      0      0      0]
 [  7937  19115      0      0      0]
 [     0      0      0      0      0]
 [ 41631 124715      0      0      0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4570932e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4570932e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4570932e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [ 3.4581903e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 3.4581903e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4581903e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [4 4 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.18389307e-17 1.00000000e+00 1.66723166e-17 2.77737656e-16
   2.85842174e-16]
  [1.94335520e-10 1.00000000e+00 2.50131658e-14 1.52202415e-13
   3.09095468e-13]
  [1.39220124e-09 1.00000000e+00 1.23568460e-13 5.86446039e-13
   5.96394028e-13]
  ...
  [5.82969003e-12 1.00000000e+00 6.97067034e-15 4.25175134e-14
   4.04038477e-14]
  [7.00956981e-09 1.00000000e+00 2.09310068e-13 1.09810880e-12
   1.70769811e-12]
  [2.69436615e-08 1.00000000e+00 6.70325124e-13 2.49976428e-12
   1.93768309e-12]]

 [[6.46816725e-17 1.00000000e+00 1.70849523e-17 2.83769219e-16
   2.91666743e-16]
  [3.44493863e-04 9.99655485e-01 6.67985528e-11 2.16332396e-10
   1.76288734e-10]
  [2.71658543e-02 9.72834170e-01 3.96322170e-10 3.17992493e-10
   8.62264093e-10]
  ...
  [2.31615877e-12 1.00000000e+00 3.78805204e-15 2.74478096e-14
   3.20072202e-14]
  [1.68325315e-07 9.99999881e-01 1.16353194e-12 4.29415141e-12
   6.04674383e-12]
  [1.00000000e+00 1.69598656e-12 9.46340953e-15 1.17392266e-15
   1.16151701e-15]]

 [[1.00000000e+00 5.44807309e-13 6.15495178e-15 1.00449997e-15
   8.11287204e-16]
  [7.86317945e-01 2.13682115e-01 1.75790860e-09 1.79335313e-09
   1.74607595e-09]
  [9.99987841e-01 1.22066840e-05 1.52402327e-11 6.73449361e-12
   7.55696287e-12]
  ...
  [1.25798039e-07 9.99999881e-01 7.91537083e-13 3.93715399e-12
   8.20714243e-12]
  [2.81597323e-07 9.99999762e-01 2.60816303e-12 8.59412281e-12
   4.71726347e-12]
  [3.85349131e-12 1.00000000e+00 3.95527286e-15 2.15096258e-14
   3.98146380e-14]]

 ...

 [[1.00000000e+00 4.71422467e-12 1.70870635e-14 3.22527001e-15
   2.68232210e-15]
  [9.17634070e-01 8.23659077e-02 1.67785208e-09 1.63679781e-09
   9.24294308e-10]
  [2.07497682e-15 1.00000000e+00 1.05149036e-16 1.32457763e-15
   1.46756706e-15]
  ...
  [1.00000000e+00 4.48996092e-12 1.28828477e-14 2.12849872e-15
   2.49339860e-15]
  [4.28391534e-13 1.00000000e+00 2.06704499e-15 2.00951926e-14
   1.63300176e-14]
  [4.81013060e-08 1.00000000e+00 5.17386806e-13 1.82437919e-12
   3.03186556e-12]]

 [[6.48704550e-17 1.00000000e+00 1.71108464e-17 2.84132093e-16
   2.92054207e-16]
  [1.74984857e-02 9.82501566e-01 6.53978760e-10 1.88237492e-09
   1.09765508e-09]
  [1.72112849e-15 1.00000000e+00 7.84537401e-17 9.07524758e-16
   1.42660984e-15]
  ...
  [1.55839839e-08 1.00000000e+00 4.58323321e-13 2.10020803e-12
   2.15197825e-12]
  [1.87333447e-11 1.00000000e+00 1.44956577e-14 8.67327450e-14
   6.88591640e-14]
  [2.34752551e-10 1.00000000e+00 3.54992457e-14 2.14352611e-13
   3.40550206e-13]]

 [[4.44408876e-12 1.00000000e+00 6.09797484e-15 4.15156462e-14
   3.87118994e-14]
  [1.35099697e-14 1.00000000e+00 3.84757146e-16 5.56036599e-15
   3.49807391e-15]
  [7.39444178e-15 1.00000000e+00 1.56600497e-16 1.69071291e-15
   2.61706965e-15]
  ...
  [2.52959986e-10 1.00000000e+00 5.13910779e-14 2.71618042e-13
   2.65239003e-13]
  [2.18020116e-11 1.00000000e+00 1.32925533e-14 8.52931820e-14
   9.16851230e-14]
  [1.00000000e+00 1.45429242e-11 2.14039957e-14 3.48203132e-15
   4.58705949e-15]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.1838931e-17 1.0000000e+00 1.6672317e-17 2.7773766e-16 2.8584217e-16]
 [1.9433552e-10 1.0000000e+00 2.5013166e-14 1.5220242e-13 3.0909547e-13]
 [1.3922012e-09 1.0000000e+00 1.2356846e-13 5.8644604e-13 5.9639403e-13]
 ...
 [2.5295999e-10 1.0000000e+00 5.1391078e-14 2.7161804e-13 2.6523900e-13]
 [2.1802012e-11 1.0000000e+00 1.3292553e-14 8.5293182e-14 9.1685123e-14]
 [1.0000000e+00 1.4542924e-11 2.1403996e-14 3.4820313e-15 4.5870595e-15]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  15.025068029785157
tp :  5938.0
fp :  94062.0
tn :  305938.0
fn :  94062.0
accuracy :  0.6237555146217346
precision :  0.059379998594522476
recall :  0.059379998594522476
auc :  0.41131460666656494

y_eval {0: 63544, 4: 36456}
pred {0: 14945, 1: 85055}
[INFO] confusion matrix for file 
[[ 5938 57606     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [ 9007 27449     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[135751 833293      0      0      0]
 [ 11899  89203      0      0      0]
 [  7937  19115      0      0      0]
 [     0      0      0      0      0]
 [ 50638 152164      0      0      0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4581903e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4581903e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4581903e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 1.0398991e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.0398991e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0398991e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.18660622e-17 1.00000000e+00 1.66763251e-17 2.77796975e-16
   2.85897760e-16]
  [1.92980673e-10 1.00000000e+00 2.49163144e-14 1.51638535e-13
   3.08151264e-13]
  [1.96869743e-11 1.00000000e+00 1.41679703e-14 9.64382518e-14
   8.87832830e-14]
  ...
  [8.70341097e-08 9.99999881e-01 6.51284528e-13 2.29192685e-12
   4.21718736e-12]
  [4.73633088e-09 1.00000000e+00 2.85882402e-13 1.32077519e-12
   1.08352010e-12]
  [4.93360951e-12 1.00000000e+00 6.50660598e-15 4.06891385e-14
   3.80976243e-14]]

 [[1.00000000e+00 5.05643791e-12 1.76634931e-14 3.34962038e-15
   2.78813113e-15]
  [8.77127528e-01 1.22872494e-01 1.46279910e-09 1.43460466e-09
   1.33245026e-09]
  [1.00000000e+00 2.57639670e-08 7.47978610e-13 1.96988232e-13
   2.28659892e-13]
  ...
  [9.48603713e-07 9.99999046e-01 2.20634340e-12 6.57437386e-12
   1.26577013e-11]
  [2.15578977e-09 1.00000000e+00 1.98147366e-13 9.50874253e-13
   7.16661810e-13]
  [1.87192991e-12 1.00000000e+00 3.72055665e-15 2.55992059e-14
   2.58763703e-14]]

 [[1.00000000e+00 5.14720601e-12 1.78128657e-14 3.38193701e-15
   2.81564276e-15]
  [9.82176661e-01 1.78233106e-02 7.45683792e-10 6.57002619e-10
   4.32607089e-10]
  [3.41884055e-15 1.00000000e+00 1.40922513e-16 1.73501793e-15
   1.80506257e-15]
  ...
  [1.95457122e-13 1.00000000e+00 1.96989921e-15 2.44295415e-14
   1.22814619e-14]
  [1.10501241e-09 1.00000000e+00 6.65362066e-14 2.59619095e-13
   4.67138372e-13]
  [5.32830136e-08 1.00000000e+00 8.61243314e-13 3.68569888e-12
   3.86070819e-12]]

 ...

 [[9.99999881e-01 1.02316008e-07 1.82261216e-12 6.20486464e-13
   6.02850018e-13]
  [1.05581733e-12 1.00000000e+00 4.34602314e-15 4.50603401e-14
   2.19806862e-14]
  [5.98043695e-16 1.00000000e+00 4.47753196e-17 5.84218953e-16
   8.65926494e-16]
  ...
  [1.46182136e-10 1.00000000e+00 3.90348730e-14 2.22630576e-13
   2.14346891e-13]
  [1.00000000e+00 1.34792065e-11 2.18124604e-14 3.43880045e-15
   4.31532836e-15]
  [2.60164367e-13 1.00000000e+00 1.85088790e-15 2.02668286e-14
   1.33320877e-14]]

 [[6.18545016e-17 1.00000000e+00 1.66746079e-17 2.77771538e-16
   2.85873779e-16]
  [2.17605614e-10 1.00000000e+00 2.64657697e-14 1.59843303e-13
   3.25618520e-13]
  [1.08101670e-11 1.00000000e+00 1.03803667e-14 7.40104863e-14
   6.80523888e-14]
  ...
  [5.13753040e-10 1.00000000e+00 6.74019692e-14 3.58749922e-13
   3.89205514e-13]
  [1.00000000e+00 1.72764006e-12 7.89443685e-15 1.03342541e-15
   1.32358755e-15]
  [5.48131256e-13 1.00000000e+00 2.66439402e-15 2.71578533e-14
   1.82089400e-14]]

 [[6.18545016e-17 1.00000000e+00 1.66746079e-17 2.77772597e-16
   2.85873779e-16]
  [3.65953212e-10 1.00000000e+00 3.44126922e-14 2.01273107e-13
   4.13073032e-13]
  [1.82171844e-09 1.00000000e+00 1.43314315e-13 6.64904438e-13
   6.71423041e-13]
  ...
  [9.00776762e-12 1.00000000e+00 9.05830417e-15 5.37049551e-14
   4.81913364e-14]
  [1.20844525e-08 1.00000000e+00 2.69865402e-13 1.36425116e-12
   2.21840558e-12]
  [9.22808141e-09 1.00000000e+00 3.98046342e-13 1.65810898e-12
   1.21694083e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.18660622e-17 1.00000000e+00 1.66763251e-17 2.77796975e-16
  2.85897760e-16]
 [1.92980673e-10 1.00000000e+00 2.49163144e-14 1.51638535e-13
  3.08151264e-13]
 [1.96869743e-11 1.00000000e+00 1.41679703e-14 9.64382518e-14
  8.87832830e-14]
 ...
 [9.00776762e-12 1.00000000e+00 9.05830417e-15 5.37049551e-14
  4.81913364e-14]
 [1.20844525e-08 1.00000000e+00 2.69865402e-13 1.36425116e-12
  2.21840558e-12]
 [9.22808141e-09 1.00000000e+00 3.98046342e-13 1.65810898e-12
  1.21694083e-12]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.63072947692871
tp :  14495.0
fp :  85505.0
tn :  314495.0
fn :  85505.0
accuracy :  0.6579833030700684
precision :  0.1449500024318695
recall :  0.1449500024318695
auc :  0.4660007357597351

y_eval {0: 100000}
pred {0: 14495, 1: 85505}
[INFO] confusion matrix for file 
[[14495 85505     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[150246 918798      0      0      0]
 [ 11899  89203      0      0      0]
 [  7937  19115      0      0      0]
 [     0      0      0      0      0]
 [ 50638 152164      0      0      0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0398991e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0398991e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0398991e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 1.7339792e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.7339792e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.7339792e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.31069589e-17 1.00000000e+00 1.68577159e-17 2.80452503e-16
   2.88456832e-16]
  [1.00000000e+00 3.54901723e-14 1.34145974e-15 1.68773498e-16
   1.52889434e-16]
  [3.07528336e-09 1.00000000e+00 1.84495431e-13 8.76021478e-13
   7.78677199e-13]
  ...
  [1.00000000e+00 1.57381011e-10 6.51281736e-14 1.08550686e-14
   1.58141068e-14]
  [3.46285419e-13 1.00000000e+00 2.35003722e-15 2.60804155e-14
   1.53294871e-14]
  [3.47552609e-09 1.00000000e+00 1.24711615e-13 4.81685709e-13
   8.58311198e-13]]

 [[6.18547332e-17 1.00000000e+00 1.66746707e-17 2.77772597e-16
   2.85874864e-16]
  [2.18095930e-10 1.00000000e+00 2.64956700e-14 1.60001000e-13
   3.25954704e-13]
  [1.73829595e-09 1.00000000e+00 1.39078107e-13 6.48874184e-13
   6.57638278e-13]
  ...
  [1.00206843e-10 1.00000000e+00 2.95459390e-14 1.84623557e-13
   1.89574756e-13]
  [8.39748493e-10 1.00000000e+00 7.95010759e-14 3.60067499e-13
   4.71902573e-13]
  [1.00000000e+00 1.64194212e-12 8.87720683e-15 1.23053728e-15
   1.29499987e-15]]

 [[6.44208989e-17 1.00000000e+00 1.70464123e-17 2.83193925e-16
   2.91144282e-16]
  [1.54729285e-10 1.00000000e+00 2.23148695e-14 1.37666124e-13
   2.78178630e-13]
  [1.61623270e-09 1.00000000e+00 1.32960591e-13 6.23704430e-13
   6.37064566e-13]
  ...
  [3.69587170e-08 1.00000000e+00 4.39333357e-13 1.57378743e-12
   2.80137654e-12]
  [2.76097056e-09 1.00000000e+00 2.23439689e-13 1.08756374e-12
   8.22083178e-13]
  [2.49017538e-12 1.00000000e+00 4.33646734e-15 2.92109104e-14
   2.96861399e-14]]

 ...

 [[6.18092118e-17 1.00000000e+00 1.66679937e-17 2.77674076e-16
   2.85780023e-16]
  [1.30078351e-10 1.00000000e+00 2.04842281e-14 1.28043165e-13
   2.56840231e-13]
  [1.27107092e-09 1.00000000e+00 1.16498594e-13 5.55888668e-13
   5.73514814e-13]
  ...
  [2.57670019e-09 1.00000000e+00 1.59667472e-13 7.16927060e-13
   8.55225938e-13]
  [6.13342432e-11 1.00000000e+00 2.84554315e-14 1.68306341e-13
   1.25744413e-13]
  [3.47696802e-11 1.00000000e+00 1.37682334e-14 8.70268755e-14
   1.28429128e-13]]

 [[9.99999881e-01 1.04166382e-07 1.84004201e-12 6.24297055e-13
   6.05313380e-13]
  [4.56910849e-14 1.00000000e+00 7.56881007e-16 9.42763002e-15
   5.52969451e-15]
  [1.05075758e-14 1.00000000e+00 1.87727502e-16 2.00560504e-15
   3.30341812e-15]
  ...
  [3.63565689e-09 1.00000000e+00 1.41438930e-13 6.06360394e-13
   9.51485635e-13]
  [1.01482711e-09 1.00000000e+00 1.21222355e-13 6.33134929e-13
   5.59181011e-13]
  [3.26789030e-12 1.00000000e+00 5.50446055e-15 3.86985366e-14
   3.41551162e-14]]

 [[6.78789572e-17 1.00000000e+00 1.75392846e-17 2.90395584e-16
   2.98062212e-16]
  [1.00000000e+00 1.41169539e-15 2.73722879e-16 2.48857850e-17
   2.49733702e-17]
  [4.06681118e-14 1.00000000e+00 5.46333075e-16 6.03512161e-15
   4.77391920e-15]
  ...
  [7.43208606e-10 1.00000000e+00 1.17172480e-13 6.27435495e-13
   4.51196182e-13]
  [1.03578311e-12 1.00000000e+00 2.70161751e-15 1.94872601e-14
   2.02728222e-14]
  [1.76606836e-08 1.00000000e+00 3.55167366e-13 1.73086252e-12
   2.49411125e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.3106959e-17 1.0000000e+00 1.6857716e-17 2.8045250e-16 2.8845683e-16]
 [1.0000000e+00 3.5490172e-14 1.3414597e-15 1.6877350e-16 1.5288943e-16]
 [3.0752834e-09 1.0000000e+00 1.8449543e-13 8.7602148e-13 7.7867720e-13]
 ...
 [7.4320861e-10 1.0000000e+00 1.1717248e-13 6.2743550e-13 4.5119618e-13]
 [1.0357831e-12 1.0000000e+00 2.7016175e-15 1.9487260e-14 2.0272822e-14]
 [1.7660684e-08 1.0000000e+00 3.5516737e-13 1.7308625e-12 2.4941113e-12]] (100000, 5)
pred 3 (argmax) [1 0 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.704218026733399
tp :  14247.0
fp :  85753.0
tn :  314247.0
fn :  85753.0
accuracy :  0.6569913029670715
precision :  0.14247000217437744
recall :  0.14247000217437744
auc :  0.4634774327278137

y_eval {0: 100000}
pred {0: 14247, 1: 85753}
[INFO] confusion matrix for file 
[[14247 85753     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 164493 1004551       0       0       0]
 [  11899   89203       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2015-12-31_233049_114.log.part11_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1361 (0.2722%)
[INFO] ** orig:[0:99.9996%,2:0.0004%]
[INFO] ** type:[0:99.9994%,1:0.0004%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9968%,3:0.0032%]
[INFO] ** i/f_dir:[1:99.9972%,0:0.0028%]
[INFO] ** src:[22:38.4512%,9:25.9642%,7:18.089%,1:17.4908%,14:0.0028%,11:0.0008%,21:0.0004%,15:0.0004%,2:0.0004%]
[INFO] ** dst:[21:43.3436%,10:21.0714%,8:18.0896%,9:17.4906%,15:0.0032%,22:0.001%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.9964%,1:0.0032%,2:0.0004%]
[INFO] ** appi_name:[21:99.9956%,30:0.0032%,31:0.0002%,27:0.0002%,24:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.4512%,20:25.9642%,13:18.089%,6:17.4908%,17:0.0032%,10:0.0008%,16:0.0004%,14:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.9956%,-33.760870000000004:0.0042%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.999%,11:49.9966%,0:0.0042%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:25.9632%,1:21.0714%,5:18.0886%,4:17.4902%,2:17.3796%,0:0.007%]
[INFO] ** service:[0.0048200000000000005:99.9964%,-211.73542999999998:0.0032%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:25.9636%,-0.32151:21.0714%,-1.27613:18.0886%,-0.23351:17.4904%,-0.33484:17.3798%,-71.33197:0.0032%,6.286230000000001:0.0008%,1.45709:0.0004%,-1.02014:0.0004%,-1.27347:0.0002%,11.862:0.0002%,-0.24950999999999998:0.0002%,1.47576:0.0002%,-0.24151:0.0002%,13.431270000000001:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:95.0874%,Single Stage Single Point:4.9126%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7336235  0.         0.        ...  1.         0.00482   -0.32151  ]
 [-1.7336235  0.         0.        ...  2.         0.00482   -0.33484  ]
 [-1.7336235  0.         0.        ...  3.         0.00482    1.45442  ]
 ...
 [-1.0400795  0.         0.        ...  3.         0.00482    1.45442  ]
 [-1.0400795  0.         0.        ...  1.         0.00482   -0.32151  ]
 [-1.0400795  0.         0.        ...  1.         0.00482   -0.32151  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.40149782e-17 1.00000000e+00 1.69880531e-17 2.82344986e-16
   2.90318055e-16]
  [3.79942244e-10 1.00000000e+00 3.50324357e-14 2.04089322e-13
   4.20194668e-13]
  [1.00000000e+00 1.15046175e-15 2.56893737e-16 2.22399237e-17
   2.30190120e-17]
  ...
  [1.00000000e+00 1.43035341e-15 2.71850857e-16 2.29425690e-17
   2.55067594e-17]
  [2.34356944e-11 1.00000000e+00 1.60134035e-14 1.14119651e-13
   9.05492315e-14]
  [1.02934319e-08 1.00000000e+00 2.34563752e-13 9.28105249e-13
   1.69757242e-12]]

 [[6.19610093e-17 1.00000000e+00 1.66902614e-17 2.78000501e-16
   2.86095251e-16]
  [2.01892822e-10 1.00000000e+00 2.54937639e-14 1.54727874e-13
   3.14567220e-13]
  [8.35406766e-09 1.00000000e+00 3.13259564e-13 1.29093524e-12
   1.31448476e-12]
  ...
  [2.07788106e-10 1.00000000e+00 4.36093016e-14 2.60029438e-13
   2.65152483e-13]
  [6.61070088e-10 1.00000000e+00 7.16267865e-14 3.26735248e-13
   4.14533181e-13]
  [1.93710104e-10 1.00000000e+00 4.88505348e-14 2.83716627e-13
   2.42708089e-13]]

 [[2.22411707e-01 7.77588308e-01 1.69518100e-09 1.42086842e-09
   1.45498236e-09]
  [6.81886139e-16 1.00000000e+00 6.12688180e-17 8.78925591e-16
   9.17130112e-16]
  [1.00000000e+00 3.31846621e-08 6.39160437e-13 1.86538868e-13
   3.34745225e-13]
  ...
  [1.78285120e-09 1.00000000e+00 1.84064149e-13 9.12575462e-13
   6.34254151e-13]
  [1.48200517e-12 1.00000000e+00 3.08447344e-15 2.15629431e-14
   2.45366675e-14]
  [9.99144092e-08 9.99999881e-01 9.00860441e-13 3.80346405e-12
   5.16761764e-12]]

 ...

 [[6.79465743e-17 1.00000000e+00 1.75461783e-17 2.90457603e-16
   2.98196414e-16]
  [1.31875774e-10 1.00000000e+00 2.06269006e-14 1.28544311e-13
   2.58119074e-13]
  [1.83201154e-09 1.00000000e+00 1.41082472e-13 6.54529870e-13
   6.73544553e-13]
  ...
  [3.81233977e-12 1.00000000e+00 5.60500251e-15 3.53313163e-14
   3.32341576e-14]
  [5.42168443e-08 1.00000000e+00 5.82150918e-13 2.69704983e-12
   4.44322443e-12]
  [7.73911069e-09 1.00000000e+00 3.71453329e-13 1.57308520e-12
   1.12575682e-12]]

 [[2.45977034e-08 1.00000000e+00 5.21997972e-13 1.67072172e-12
   1.59723298e-12]
  [6.60513836e-15 1.00000000e+00 1.80695620e-16 2.20362546e-15
   2.60401412e-15]
  [5.23551876e-07 9.99999523e-01 1.76560589e-12 5.58260296e-12
   8.68809798e-12]
  ...
  [1.00000000e+00 1.19416477e-10 5.60382971e-14 8.83181010e-15
   1.35778585e-14]
  [1.11878497e-12 1.00000000e+00 4.76811321e-15 5.11540239e-14
   2.63310305e-14]
  [8.67453276e-10 1.00000000e+00 6.12315239e-14 2.49338202e-13
   4.38502885e-13]]

 [[6.18368065e-17 1.00000000e+00 1.66719990e-17 2.77733395e-16
   2.85836721e-16]
  [1.93539490e-10 1.00000000e+00 2.49602652e-14 1.51913557e-13
   3.08520597e-13]
  [1.40660916e-09 1.00000000e+00 1.24237494e-13 5.89180560e-13
   5.99105184e-13]
  ...
  [1.00000000e+00 3.66584882e-13 3.87643400e-15 4.87180793e-16
   5.67342827e-16]
  [1.20212087e-12 1.00000000e+00 3.64474127e-15 3.32578745e-14
   2.55212992e-14]
  [3.77472986e-08 1.00000000e+00 4.54760090e-13 1.61716463e-12
   2.78681158e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.4014978e-17 1.0000000e+00 1.6988053e-17 2.8234499e-16 2.9031805e-16]
 [3.7994224e-10 1.0000000e+00 3.5032436e-14 2.0408932e-13 4.2019467e-13]
 [1.0000000e+00 1.1504617e-15 2.5689374e-16 2.2239924e-17 2.3019012e-17]
 ...
 [1.0000000e+00 3.6658488e-13 3.8764340e-15 4.8718079e-16 5.6734283e-16]
 [1.2021209e-12 1.0000000e+00 3.6447413e-15 3.3257875e-14 2.5521299e-14]
 [3.7747299e-08 1.0000000e+00 4.5476009e-13 1.6171646e-12 2.7868116e-12]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 0 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  12.780487413024902
tp :  18416.0
fp :  81584.0
tn :  318416.0
fn :  81584.0
accuracy :  0.6736671924591064
precision :  0.1841599941253662
recall :  0.1841599941253662
auc :  0.4907394349575043

y_eval {0: 100000}
pred {0: 18416, 1: 81584}
[INFO] confusion matrix for file 
[[18416 81584     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 182909 1086135       0       0       0]
 [  11899   89203       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0400795e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0400795e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0400795e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [-3.4653556e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4653556e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-3.4653556e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[7.14533833e-17 1.00000000e+00 1.80347774e-17 2.97578239e-16
   3.05011853e-16]
  [1.89414928e-10 1.00000000e+00 2.47253847e-14 1.50343158e-13
   3.04684961e-13]
  [6.11671805e-02 9.38832760e-01 1.11922649e-09 1.35935196e-09
   1.27039479e-09]
  ...
  [1.33425380e-11 1.00000000e+00 1.11082510e-14 6.10821005e-14
   5.53864849e-14]
  [6.04954575e-09 1.00000000e+00 1.93599748e-13 1.07488096e-12
   1.65312599e-12]
  [1.98149763e-08 1.00000000e+00 5.45827706e-13 2.05226916e-12
   1.68539661e-12]]

 [[7.14765576e-17 1.00000000e+00 1.80379405e-17 2.97624772e-16
   3.05056084e-16]
  [1.89165808e-10 1.00000000e+00 2.47091200e-14 1.50256001e-13
   3.04499644e-13]
  [1.00000000e+00 9.56937912e-14 2.12140587e-15 2.42554078e-16
   2.63420550e-16]
  ...
  [1.49894490e-07 9.99999881e-01 1.05218449e-12 4.35365372e-12
   6.35879977e-12]
  [1.00000000e+00 1.69379474e-12 9.43910901e-15 1.13590104e-15
   1.11536367e-15]
  [9.22086626e-13 1.00000000e+00 3.15211961e-15 2.70580643e-14
   2.03557399e-14]]

 [[6.37982569e-17 1.00000000e+00 1.69568469e-17 2.81888700e-16
   2.89876486e-16]
  [9.99961734e-01 3.82725193e-05 2.50947717e-11 1.77221692e-11
   1.84355933e-11]
  [1.27134411e-14 1.00000000e+00 2.27632587e-16 2.29737697e-15
   3.67056773e-15]
  ...
  [3.82678735e-07 9.99999642e-01 1.41609283e-12 4.49888304e-12
   8.76375882e-12]
  [3.24298366e-09 1.00000000e+00 2.64704274e-13 1.26401905e-12
   8.22807913e-13]
  [1.05434422e-12 1.00000000e+00 2.60294156e-15 1.86403254e-14
   2.08967314e-14]]

 ...

 [[6.19165864e-17 1.00000000e+00 1.66837052e-17 2.77905104e-16
   2.86002475e-16]
  [1.95718552e-10 1.00000000e+00 2.50936357e-14 1.52578525e-13
   3.10141940e-13]
  [2.33541002e-07 9.99999762e-01 1.88395024e-12 6.21358347e-12
   5.55206445e-12]
  ...
  [1.00000000e+00 1.75972500e-10 7.31001224e-14 1.47459644e-14
   1.87347459e-14]
  [4.85567370e-13 1.00000000e+00 2.41990431e-15 2.40256728e-14
   1.76376044e-14]
  [1.06270495e-08 1.00000000e+00 2.43013807e-13 9.25746784e-13
   1.45027794e-12]]

 [[6.90421254e-17 1.00000000e+00 1.77018140e-17 2.92753565e-16
   3.00346104e-16]
  [1.20060975e-10 1.00000000e+00 1.96901736e-14 1.23463861e-13
   2.47111115e-13]
  [1.38814427e-09 1.00000000e+00 1.21795261e-13 5.77144831e-13
   5.95985772e-13]
  ...
  [1.38713450e-11 1.00000000e+00 1.17967380e-14 6.76994675e-14
   5.70612147e-14]
  [1.53323343e-09 1.00000000e+00 9.15149507e-14 5.27406189e-13
   8.67849141e-13]
  [3.10501420e-08 1.00000000e+00 7.27786538e-13 2.75986070e-12
   2.08644126e-12]]

 [[6.90595094e-17 1.00000000e+00 1.77041781e-17 2.92788188e-16
   3.00379324e-16]
  [9.99999642e-01 3.51078711e-07 1.64651084e-12 6.13978323e-13
   1.47874898e-12]
  [6.85830559e-12 1.00000000e+00 9.09025425e-15 6.90157634e-14
   6.34315598e-14]
  ...
  [2.48809926e-07 9.99999762e-01 1.96112918e-12 8.38233649e-12
   6.90025207e-12]
  [1.00166663e-11 1.00000000e+00 7.84699793e-15 4.40561623e-14
   5.96959344e-14]
  [4.59201921e-09 1.00000000e+00 2.47029583e-13 1.29904908e-12
   1.10862914e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[7.1453383e-17 1.0000000e+00 1.8034777e-17 2.9757824e-16 3.0501185e-16]
 [1.8941493e-10 1.0000000e+00 2.4725385e-14 1.5034316e-13 3.0468496e-13]
 [6.1167181e-02 9.3883276e-01 1.1192265e-09 1.3593520e-09 1.2703948e-09]
 ...
 [2.4880993e-07 9.9999976e-01 1.9611292e-12 8.3823365e-12 6.9002521e-12]
 [1.0016666e-11 1.0000000e+00 7.8469979e-15 4.4056162e-14 5.9695934e-14]
 [4.5920192e-09 1.0000000e+00 2.4702958e-13 1.2990491e-12 1.1086291e-12]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.139635223388671
tp :  16213.0
fp :  83787.0
tn :  316213.0
fn :  83787.0
accuracy :  0.6648552417755127
precision :  0.16212999820709229
recall :  0.16212999820709229
auc :  0.4777988791465759

y_eval {0: 100000}
pred {0: 16213, 1: 83787}
[INFO] confusion matrix for file 
[[16213 83787     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 199122 1169922       0       0       0]
 [  11899   89203       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-0.34653556  0.          0.         ...  3.          0.00482
   1.45442   ]
 [-0.34653556  0.          0.         ...  2.          0.00482
  -0.33484   ]
 [-0.34653556  0.          0.         ...  1.          0.00482
  -0.32151   ]
 ...
 [ 0.34700835  0.          0.         ...  4.          0.00482
  -0.23351   ]
 [ 0.34700835  0.          0.         ...  2.          0.00482
  -0.33484   ]
 [ 0.34700835  0.          0.         ...  3.          0.00482
   1.45442   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.90766353e-17 1.00000000e+00 1.77066100e-17 2.92822837e-16
   3.00413708e-16]
  [1.52115001e-10 1.00000000e+00 2.21365251e-14 1.36554681e-13
   2.75688137e-13]
  [1.41479151e-09 1.00000000e+00 1.24083090e-13 5.88201417e-13
   6.00400155e-13]
  ...
  [1.24314664e-11 1.00000000e+00 1.09748992e-14 6.31829319e-14
   5.41470250e-14]
  [2.75016454e-09 1.00000000e+00 1.22870911e-13 6.84532509e-13
   1.14614882e-12]
  [7.08241217e-08 9.99999881e-01 1.14174132e-12 4.06148162e-12
   2.96431087e-12]]

 [[1.04371633e-11 1.00000000e+00 9.49577382e-15 6.00181187e-14
   5.60083765e-14]
  [1.68367992e-13 1.00000000e+00 8.60526076e-16 8.23538710e-15
   1.14242417e-14]
  [3.58023513e-08 1.00000000e+00 5.08328893e-13 1.88520879e-12
   2.53391448e-12]
  ...
  [6.29448360e-12 1.00000000e+00 6.50504278e-15 4.24182038e-14
   5.00860272e-14]
  [1.00000000e+00 1.57650640e-12 7.49574607e-15 1.08739199e-15
   1.36643133e-15]
  [8.76188607e-13 1.00000000e+00 3.20396967e-15 3.07567455e-14
   2.27358585e-14]]

 [[6.73191280e-17 1.00000000e+00 1.74583135e-17 2.89186207e-16
   2.96956834e-16]
  [3.57203295e-10 1.00000000e+00 3.40217627e-14 1.98992339e-13
   4.07846527e-13]
  [1.65121250e-09 1.00000000e+00 1.36096524e-13 6.36149011e-13
   6.42665175e-13]
  ...
  [1.78263168e-11 1.00000000e+00 1.33129532e-14 7.49645029e-14
   6.39872473e-14]
  [2.94791969e-09 1.00000000e+00 1.29005584e-13 7.10119680e-13
   1.16838895e-12]
  [6.07002946e-08 9.99999881e-01 1.04774067e-12 3.75511037e-12
   2.76917226e-12]]

 ...

 [[6.34753918e-17 1.00000000e+00 1.69102088e-17 2.81209909e-16
   2.89215985e-16]
  [1.88339927e-10 1.00000000e+00 2.46211454e-14 1.50016609e-13
   3.04567027e-13]
  [1.00000000e+00 1.11358554e-13 2.28542809e-15 2.64040287e-16
   2.86422841e-16]
  ...
  [4.62924667e-08 1.00000000e+00 6.01696752e-13 2.74488852e-12
   3.73766122e-12]
  [8.05651990e-10 1.00000000e+00 1.00372727e-13 4.69668521e-13
   4.19082114e-13]
  [1.16703990e-11 1.00000000e+00 9.45752689e-15 6.05276192e-14
   6.67902555e-14]]

 [[3.20780877e-08 1.00000000e+00 5.98364023e-13 1.87136591e-12
   1.79103867e-12]
  [7.58245429e-15 1.00000000e+00 1.94352729e-16 2.34858541e-15
   2.77627627e-15]
  [4.34863967e-09 1.00000000e+00 1.66227532e-13 7.68742708e-13
   9.80910448e-13]
  ...
  [2.79433247e-12 1.00000000e+00 4.36394847e-15 2.80335142e-14
   3.23690727e-14]
  [4.40308190e-09 1.00000000e+00 1.99792128e-13 1.08106558e-12
   1.21279072e-12]
  [1.00000000e+00 5.10041120e-13 4.52385771e-15 5.17478791e-16
   6.17571563e-16]]

 [[6.60346886e-17 1.00000000e+00 1.72767193e-17 2.86545237e-16
   2.94397577e-16]
  [4.31333164e-10 1.00000000e+00 3.73912632e-14 2.16130241e-13
   4.44870025e-13]
  [1.00000000e+00 1.26666838e-13 2.45515422e-15 2.82781552e-16
   3.04000098e-16]
  ...
  [2.16015451e-07 9.99999762e-01 1.26116511e-12 5.25037652e-12
   7.71420601e-12]
  [8.04307010e-10 1.00000000e+00 1.04690921e-13 5.02092508e-13
   4.25805116e-13]
  [2.35972578e-11 1.00000000e+00 1.34595068e-14 7.90296783e-14
   8.84007223e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.9076635e-17 1.0000000e+00 1.7706610e-17 2.9282284e-16 3.0041371e-16]
 [1.5211500e-10 1.0000000e+00 2.2136525e-14 1.3655468e-13 2.7568814e-13]
 [1.4147915e-09 1.0000000e+00 1.2408309e-13 5.8820142e-13 6.0040015e-13]
 ...
 [2.1601545e-07 9.9999976e-01 1.2611651e-12 5.2503765e-12 7.7142060e-12]
 [8.0430701e-10 1.0000000e+00 1.0469092e-13 5.0209251e-13 4.2580512e-13]
 [2.3597258e-11 1.0000000e+00 1.3459507e-14 7.9029678e-14 8.8400722e-14]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  12.288436737060547
tp :  22364.0
fp :  77636.0
tn :  322364.0
fn :  77636.0
accuracy :  0.6894590854644775
precision :  0.22363999485969543
recall :  0.22363999485969543
auc :  0.5151872634887695

y_eval {0: 92639, 1: 7361}
pred {0: 15167, 1: 84833}
[INFO] confusion matrix for file 
[[15085 77554     0     0     0]
 [   82  7279     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 214207 1247476       0       0       0]
 [  11981   96482       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4700835e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4700835e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4700835e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 1.0380025e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0380025e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.0380025e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 1 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.60442640e-17 1.00000000e+00 1.72780378e-17 2.86564904e-16
   2.94417800e-16]
  [1.00000000e+00 1.75310863e-10 4.58414028e-14 9.01806841e-15
   1.92139937e-14]
  [1.18287433e-12 1.00000000e+00 3.55015289e-15 3.14107803e-14
   2.76393000e-14]
  ...
  [1.00000000e+00 6.99451009e-15 6.16521772e-16 6.07781080e-17
   6.25044074e-17]
  [3.11200393e-12 1.00000000e+00 5.51431747e-15 4.57472432e-14
   3.75244371e-14]
  [8.56648370e-08 9.99999881e-01 6.74125415e-13 2.31637062e-12
   4.38424427e-12]]

 [[6.36305510e-17 1.00000000e+00 1.69328652e-17 2.81543720e-16
   2.89533914e-16]
  [4.51774701e-10 1.00000000e+00 3.82538849e-14 2.20591530e-13
   4.54773968e-13]
  [1.00000000e+00 1.15372840e-13 2.34954425e-15 2.68944157e-16
   2.88605407e-16]
  ...
  [8.71901079e-07 9.99999166e-01 2.61116779e-12 9.93798707e-12
   1.45062053e-11]
  [1.09169707e-09 1.00000000e+00 1.23887052e-13 5.76775064e-13
   4.85404360e-13]
  [5.13064114e-12 1.00000000e+00 6.19832919e-15 4.15401220e-14
   4.48843233e-14]]

 [[5.37826139e-08 1.00000000e+00 7.80431709e-13 2.33349668e-12
   2.23828811e-12]
  [4.97964275e-15 1.00000000e+00 1.57582671e-16 1.96325995e-15
   2.28787051e-15]
  [6.06652293e-07 9.99999404e-01 1.88105542e-12 5.91094014e-12
   9.33067946e-12]
  ...
  [1.06664233e-12 1.00000000e+00 2.60179976e-15 1.82909497e-14
   2.19682806e-14]
  [1.00000000e+00 3.94703767e-14 1.33773957e-15 1.48691737e-16
   1.68082174e-16]
  [3.83355847e-12 1.00000000e+00 6.40133376e-15 5.28038035e-14
   4.21731233e-14]]

 ...

 [[6.49558862e-17 1.00000000e+00 1.71230556e-17 2.84309891e-16
   2.92226949e-16]
  [2.60735045e-10 1.00000000e+00 2.90558762e-14 1.73592667e-13
   3.53138173e-13]
  [1.00000000e+00 2.12276419e-09 2.72978255e-13 5.96992345e-14
   6.55296536e-14]
  ...
  [4.90460650e-09 1.00000000e+00 1.81219135e-13 9.71214862e-13
   1.38991726e-12]
  [9.44872092e-09 1.00000000e+00 3.56637707e-13 1.38651222e-12
   1.24255814e-12]
  [5.46936801e-12 1.00000000e+00 6.45826200e-15 4.16938755e-14
   4.58419279e-14]]

 [[1.00000000e+00 1.05511728e-11 2.49068581e-14 4.95028585e-15
   4.17350709e-15]
  [9.85248089e-01 1.47519661e-02 7.00987490e-10 6.01795391e-10
   3.78921172e-10]
  [3.88601310e-15 1.00000000e+00 1.46598282e-16 1.75923735e-15
   1.92652138e-15]
  ...
  [1.00000000e+00 2.09578743e-11 2.63697806e-14 5.00056277e-15
   6.04380708e-15]
  [5.77281387e-13 1.00000000e+00 2.40192455e-15 2.25450762e-14
   1.88493359e-14]
  [1.05917216e-07 9.99999881e-01 8.07014828e-13 2.67674489e-12
   4.14527006e-12]]

 [[6.31081633e-17 1.00000000e+00 1.68578449e-17 2.80454647e-16
   2.88459029e-16]
  [1.55645691e-10 1.00000000e+00 2.23718478e-14 1.37990002e-13
   2.79077298e-13]
  [8.05307487e-11 1.00000000e+00 3.03337813e-14 1.88437373e-13
   1.64322887e-13]
  ...
  [3.94290739e-10 1.00000000e+00 7.62016860e-14 3.67041060e-13
   2.56324909e-13]
  [1.42746474e-11 1.00000000e+00 8.33920454e-15 5.73311066e-14
   9.16006976e-14]
  [8.86535929e-08 9.99999881e-01 1.19368296e-12 4.44544488e-12
   3.53942114e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.60442640e-17 1.00000000e+00 1.72780378e-17 2.86564904e-16
  2.94417800e-16]
 [1.00000000e+00 1.75310863e-10 4.58414028e-14 9.01806841e-15
  1.92139937e-14]
 [1.18287433e-12 1.00000000e+00 3.55015289e-15 3.14107803e-14
  2.76393000e-14]
 ...
 [3.94290739e-10 1.00000000e+00 7.62016860e-14 3.67041060e-13
  2.56324909e-13]
 [1.42746474e-11 1.00000000e+00 8.33920454e-15 5.73311066e-14
  9.16006976e-14]
 [8.86535929e-08 9.99999881e-01 1.19368296e-12 4.44544488e-12
  3.53942114e-12]] (100000, 5)
pred 3 (argmax) [1 0 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  10.89768137359619
tp :  31489.0
fp :  68511.0
tn :  331489.0
fn :  68511.0
accuracy :  0.7259588241577148
precision :  0.3148899972438812
recall :  0.3148899972438812
auc :  0.5726773738861084

y_eval {0: 82798, 1: 17202}
pred {0: 14445, 1: 85555}
[INFO] confusion matrix for file 
[[14366 68432     0     0     0]
 [   79 17123     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 228573 1315908       0       0       0]
 [  12060  113605       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0380025e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.0380025e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0380025e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [ 1.7315464e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.7315464e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.7315464e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.33580645e-17 1.00000000e+00 1.68933161e-17 2.80963290e-16
   2.88976672e-16]
  [9.99985814e-01 1.42039689e-05 9.63437663e-12 4.93246720e-12
   1.22824780e-11]
  [1.75377664e-11 1.00000000e+00 1.49102549e-14 1.04142044e-13
   9.71859176e-14]
  ...
  [4.55541709e-07 9.99999523e-01 2.43154780e-12 1.04721336e-11
   9.89086677e-12]
  [2.81684103e-11 1.00000000e+00 1.39228796e-14 7.37441724e-14
   9.52981726e-14]
  [1.13603016e-09 1.00000000e+00 1.19963731e-13 6.55761957e-13
   5.61605179e-13]]

 [[6.18684247e-17 1.00000000e+00 1.66766427e-17 2.77802269e-16
   2.85903213e-16]
  [9.99986172e-01 1.38575242e-05 9.52716898e-12 4.87308848e-12
   1.21228201e-11]
  [1.91262700e-11 1.00000000e+00 1.55998160e-14 1.08146104e-13
   1.01021906e-13]
  ...
  [2.74810617e-07 9.99999762e-01 1.99643622e-12 8.81405105e-12
   7.60450817e-12]
  [3.49948265e-11 1.00000000e+00 1.50668035e-14 7.63778960e-14
   1.03647431e-13]
  [1.24003607e-09 1.00000000e+00 1.29999527e-13 7.34202900e-13
   5.99266351e-13]]

 [[8.17567260e-13 1.00000000e+00 2.52882152e-15 1.99274428e-14
   1.85884548e-14]
  [5.94287640e-13 1.00000000e+00 1.57247082e-15 1.37174868e-14
   2.03563600e-14]
  [1.59808646e-08 1.00000000e+00 3.52836548e-13 1.37896931e-12
   1.75945478e-12]
  ...
  [5.58917929e-12 1.00000000e+00 6.24010782e-15 4.25502868e-14
   4.84425563e-14]
  [1.00000000e+00 1.52408242e-11 2.14848586e-14 3.62147158e-15
   4.87603071e-15]
  [5.49020627e-13 1.00000000e+00 2.61862734e-15 2.64816245e-14
   1.87956272e-14]]

 ...

 [[6.31999538e-17 1.00000000e+00 1.68703900e-17 2.80629083e-16
   2.88651676e-16]
  [2.12151643e-10 1.00000000e+00 2.61373852e-14 1.58064561e-13
   3.21704685e-13]
  [2.22818786e-09 1.00000000e+00 1.58172520e-13 7.23805130e-13
   7.33603770e-13]
  ...
  [6.36500672e-14 1.00000000e+00 1.07030490e-15 1.40320774e-14
   7.23931447e-15]
  [4.98210895e-09 1.00000000e+00 1.39966936e-13 5.12067656e-13
   9.89313015e-13]
  [2.11290896e-08 1.00000000e+00 5.99129199e-13 2.71346834e-12
   2.41870846e-12]]

 [[6.59533734e-17 1.00000000e+00 1.72671653e-17 2.86434858e-16
   2.94234788e-16]
  [2.07974860e-10 1.00000000e+00 2.58890572e-14 1.56660790e-13
   3.18530304e-13]
  [1.42007150e-09 1.00000000e+00 1.25036971e-13 5.92474529e-13
   6.01343357e-13]
  ...
  [3.30204863e-09 1.00000000e+00 1.54460727e-13 6.92425826e-13
   1.01585190e-12]
  [6.42314424e-10 1.00000000e+00 1.03890475e-13 5.36855228e-13
   3.67272863e-13]
  [2.69937588e-12 1.00000000e+00 3.85399271e-15 2.73484153e-14
   3.70445624e-14]]

 [[6.59634385e-17 1.00000000e+00 1.72685484e-17 2.86455637e-16
   2.94255011e-16]
  [2.08111361e-10 1.00000000e+00 2.58976512e-14 1.56705906e-13
   3.18625714e-13]
  [9.99725878e-01 2.74101127e-04 8.44182363e-11 4.28603091e-11
   4.58813855e-11]
  ...
  [9.99700427e-01 2.99602922e-04 6.87106066e-11 5.14430235e-11
   7.64250677e-11]
  [1.38421141e-11 1.00000000e+00 1.44869790e-14 1.06150291e-13
   7.82404672e-14]
  [5.00029636e-11 1.00000000e+00 1.87042544e-14 1.06771850e-13
   1.19786532e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.33580645e-17 1.00000000e+00 1.68933161e-17 2.80963290e-16
  2.88976672e-16]
 [9.99985814e-01 1.42039689e-05 9.63437663e-12 4.93246720e-12
  1.22824780e-11]
 [1.75377664e-11 1.00000000e+00 1.49102549e-14 1.04142044e-13
  9.71859176e-14]
 ...
 [9.99700427e-01 2.99602922e-04 6.87106066e-11 5.14430235e-11
  7.64250677e-11]
 [1.38421141e-11 1.00000000e+00 1.44869790e-14 1.06150291e-13
  7.82404672e-14]
 [5.00029636e-11 1.00000000e+00 1.87042544e-14 1.06771850e-13
  1.19786532e-13]] (100000, 5)
pred 3 (argmax) [1 0 1 ... 0 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.695684133911133
tp :  14308.0
fp :  85692.0
tn :  314308.0
fn :  85692.0
accuracy :  0.657235324382782
precision :  0.1430799961090088
recall :  0.1430799961090088
auc :  0.4636506140232086

y_eval {0: 100000}
pred {0: 14308, 1: 85692}
[INFO] confusion matrix for file 
[[14308 85692     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 242881 1401600       0       0       0]
 [  12060  113605       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-01_151435_117.log.part03_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0:99.9976%,2:0.0024%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9966%,3:0.0034%]
[INFO] ** i/f_dir:[1:99.9966%,0:0.0034%]
[INFO] ** src:[22:38.1462%,9:26.099%,7:18.1904%,1:17.5592%,21:0.0028%,14:0.001%,3:0.0006%,15:0.0004%,2:0.0004%]
[INFO] ** dst:[21:43.376%,10:20.8688%,8:18.1902%,9:17.5592%,15:0.0034%,22:0.0008%,18:0.0004%,16:0.0004%,6:0.0004%,24:0.0002%,2:0.0002%]
[INFO] ** proto:[0:99.9958%,1:0.0034%,2:0.0008%]
[INFO] ** appi_name:[21:99.9952%,30:0.0034%,7:0.0006%,31:0.0004%,26:0.0002%,22:0.0002%]
[INFO] ** proxy_src_ip:[18:38.1462%,20:26.099%,13:18.1904%,6:17.5592%,17:0.0034%,1:0.0006%,16:0.0004%,14:0.0004%,7:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.9952%,-33.760870000000004:0.0048%]
[INFO] ** modbus_function_description:[7:49.9978%,11:49.9974%,0:0.0048%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.0982%,1:20.8688%,5:18.19%,4:17.5588%,2:17.2772%,0:0.007%]
[INFO] ** service:[0.0048200000000000005:99.9952%,-211.73542999999998:0.0034%,-211.09762999999998:0.0006%,-186.43601999999998:0.0004%,-211.08346:0.0002%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.0986%,-0.32151:20.8688%,-1.27613:18.1902%,-0.23351:17.559%,-0.33484:17.2774%,-71.33197:0.0034%,-1.02014:0.0004%,-71.14931:0.0002%,-0.24151:0.0002%,4.42897:0.0002%,-71.14798:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,-0.78282:0.0002%,-2.92807:0.0002%,-4.88132:0.0002%,1.45709:0.0002%,9.18344:0.0002%]
[INFO] ** classification:[normal:84.2104%,Single Stage Single Point:15.7896%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7315832e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.7315832e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.7315832e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [-1.0377140e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0377140e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0377140e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.18738510e-17 1.00000000e+00 1.66774699e-17 2.77812884e-16
   2.85914118e-16]
  [1.00000000e+00 1.66130147e-14 7.29734184e-16 7.21501870e-17
   9.46802179e-17]
  [3.76295661e-11 1.00000000e+00 1.95369437e-14 1.31392510e-13
   1.07854826e-13]
  ...
  [1.09941075e-11 1.00000000e+00 1.08878725e-14 8.21173777e-14
   6.50988662e-14]
  [6.99653597e-08 9.99999881e-01 6.05350351e-13 2.06081224e-12
   3.89770247e-12]
  [8.71064820e-09 1.00000000e+00 4.38896152e-13 1.93120389e-12
   1.26098502e-12]]

 [[7.35482480e-17 1.00000000e+00 1.83198304e-17 3.01698789e-16
   3.08994787e-16]
  [1.00000000e+00 2.64367868e-12 6.54446835e-15 9.10267239e-16
   1.75234526e-15]
  [7.26959671e-13 1.00000000e+00 2.69394043e-15 2.48638085e-14
   2.13203461e-14]
  ...
  [1.78267769e-07 9.99999881e-01 1.62118225e-12 5.49980851e-12
   4.78869982e-12]
  [3.15660670e-12 1.00000000e+00 4.68419130e-15 3.05779910e-14
   3.62721802e-14]
  [5.16187271e-09 1.00000000e+00 2.34059625e-13 1.21525218e-12
   1.19745706e-12]]

 [[6.18743208e-17 1.00000000e+00 1.66775328e-17 2.77813942e-16
   2.85915230e-16]
  [1.60097102e-10 1.00000000e+00 2.26841386e-14 1.39700222e-13
   2.82824057e-13]
  [2.33617214e-09 1.00000000e+00 1.61216526e-13 7.35043591e-13
   7.49658256e-13]
  ...
  [2.53552930e-12 1.00000000e+00 4.36150182e-15 2.83372518e-14
   2.84533681e-14]
  [2.51479513e-08 1.00000000e+00 4.06783738e-13 1.97187188e-12
   3.05085774e-12]
  [1.84750135e-08 1.00000000e+00 5.56397864e-13 2.12550789e-12
   1.64033630e-12]]

 ...

 [[6.41628913e-17 1.00000000e+00 1.70093232e-17 2.82654286e-16
   2.90619439e-16]
  [2.06448900e-10 1.00000000e+00 2.57867000e-14 1.56176572e-13
   3.17603311e-13]
  [5.36813305e-09 1.00000000e+00 2.49220295e-13 1.06349359e-12
   1.08142445e-12]
  ...
  [1.87661220e-09 1.00000000e+00 1.68724193e-13 8.01037188e-13
   6.79002048e-13]
  [3.87960540e-12 1.00000000e+00 5.70577021e-15 3.91869019e-14
   3.74870965e-14]
  [2.60002331e-08 1.00000000e+00 4.23040617e-13 1.84170301e-12
   2.75242221e-12]]

 [[2.28839852e-07 9.99999762e-01 1.64216091e-12 4.33135645e-12
   4.18117754e-12]
  [8.74646604e-01 1.25353441e-01 1.74180503e-09 2.11811435e-09
   1.49031942e-09]
  [3.87355155e-15 1.00000000e+00 1.42169252e-16 1.71268622e-15
   1.98676596e-15]
  ...
  [6.01388479e-07 9.99999404e-01 3.07115032e-12 9.37790730e-12
   7.81708379e-12]
  [1.00000000e+00 2.24064406e-10 7.81506817e-14 1.26566314e-14
   1.97370230e-14]
  [8.97904852e-13 1.00000000e+00 4.53910387e-15 5.13387618e-14
   2.36954536e-14]]

 [[6.78186525e-17 1.00000000e+00 1.75282483e-17 2.90197352e-16
   2.97943998e-16]
  [9.99999881e-01 9.96671616e-08 1.35181016e-12 5.50474922e-13
   6.32790803e-13]
  [1.16175685e-14 1.00000000e+00 2.35085180e-16 2.52139495e-15
   3.43548305e-15]
  ...
  [3.54840950e-07 9.99999642e-01 2.32816978e-12 8.29220286e-12
   6.99241056e-12]
  [6.08787326e-12 1.00000000e+00 6.28334250e-15 3.79016446e-14
   4.88815734e-14]
  [1.00000000e+00 3.43022052e-14 1.31477111e-15 1.41181863e-16
   1.49515344e-16]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.18738510e-17 1.00000000e+00 1.66774699e-17 2.77812884e-16
  2.85914118e-16]
 [1.00000000e+00 1.66130147e-14 7.29734184e-16 7.21501870e-17
  9.46802179e-17]
 [3.76295661e-11 1.00000000e+00 1.95369437e-14 1.31392510e-13
  1.07854826e-13]
 ...
 [3.54840950e-07 9.99999642e-01 2.32816978e-12 8.29220286e-12
  6.99241056e-12]
 [6.08787326e-12 1.00000000e+00 6.28334250e-15 3.79016446e-14
  4.88815734e-14]
 [1.00000000e+00 3.43022052e-14 1.31477111e-15 1.41181863e-16
  1.49515344e-16]] (100000, 5)
pred 3 (argmax) [1 0 1 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  9.42002802581787
tp :  39295.0
fp :  60705.0
tn :  339295.0
fn :  60705.0
accuracy :  0.7571824789047241
precision :  0.39294999837875366
recall :  0.39294999837875366
auc :  0.6238723397254944

y_eval {0: 70708, 1: 29292}
pred {0: 18315, 1: 81685}
[INFO] confusion matrix for file 
[[14159 56549     0     0     0]
 [ 4156 25136     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 257040 1458149       0       0       0]
 [  16216  138741       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.037714e+00  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 [-1.037714e+00  0.000000e+00  0.000000e+00 ...  3.000000e+00
   4.820000e-03  1.454420e+00]
 [-1.037714e+00  0.000000e+00  0.000000e+00 ...  4.000000e+00
   4.820000e-03 -2.335100e-01]
 ...
 [-3.463864e-01  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 [-3.463864e-01  0.000000e+00  0.000000e+00 ...  2.000000e+00
   4.820000e-03 -3.348400e-01]
 [-3.463864e-01  0.000000e+00  0.000000e+00 ...  3.000000e+00
   4.820000e-03  1.454420e+00]] shape (100000, 16)
y_test [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [1 0 1 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[7.91858743e-17 1.00000000e+00 1.90637139e-17 3.12340302e-16
   3.19409560e-16]
  [6.09645501e-10 1.00000000e+00 4.45814345e-14 2.51303373e-13
   5.19421691e-13]
  [1.33082643e-01 8.66917372e-01 1.64482072e-09 1.82516713e-09
   1.66962710e-09]
  ...
  [3.42645946e-11 1.00000000e+00 1.95692766e-14 1.08934448e-13
   9.22242697e-14]
  [1.04251510e-10 1.00000000e+00 2.55024205e-14 1.64368654e-13
   2.20662220e-13]
  [5.96584329e-08 9.99999881e-01 8.37038230e-13 2.87795699e-12
   2.97411965e-12]]

 [[6.78465979e-17 1.00000000e+00 1.75321262e-17 2.90253812e-16
   2.97999690e-16]
  [1.00000000e+00 4.59047314e-11 2.45357306e-14 4.31458763e-15
   8.93411050e-15]
  [2.39336418e-06 9.99997616e-01 7.54161490e-12 2.06877970e-11
   1.71631546e-11]
  ...
  [5.12048473e-07 9.99999523e-01 2.30696061e-12 1.04065055e-11
   1.17673336e-11]
  [1.00000000e+00 4.12727491e-12 1.29531429e-14 1.49337001e-15
   1.70269981e-15]
  [7.97176452e-13 1.00000000e+00 3.02007543e-15 2.63574613e-14
   1.92381240e-14]]

 [[6.66087387e-17 1.00000000e+00 1.73591660e-17 2.87756733e-16
   2.95538557e-16]
  [3.43638312e-10 1.00000000e+00 3.33242921e-14 1.95266343e-13
   4.00975477e-13]
  [5.34923483e-09 1.00000000e+00 2.50983397e-13 1.07027180e-12
   1.07870516e-12]
  ...
  [5.02321473e-09 1.00000000e+00 2.62598266e-13 1.13472036e-12
   1.05038602e-12]
  [1.39524087e-11 1.00000000e+00 1.14695681e-14 7.21167239e-14
   6.68478605e-14]
  [8.19101231e-10 1.00000000e+00 7.46330894e-14 4.01376442e-13
   5.46388076e-13]]

 ...

 [[1.00000000e+00 7.38478072e-13 7.11442115e-15 1.18600367e-15
   9.61452169e-16]
  [9.88010347e-01 1.19896354e-02 5.88682714e-10 5.10729181e-10
   3.67044423e-10]
  [9.98697221e-01 1.30286277e-03 1.54217084e-10 8.39851383e-11
   8.66527614e-11]
  ...
  [1.10856724e-13 1.00000000e+00 1.18764268e-15 1.27220520e-14
   8.09769512e-15]
  [1.16929030e-07 9.99999881e-01 6.73984035e-13 2.29976953e-12
   4.95287145e-12]
  [3.03555190e-08 1.00000000e+00 7.69294188e-13 3.10408405e-12
   2.45987345e-12]]

 [[6.60918964e-17 1.00000000e+00 1.72848273e-17 2.86662207e-16
   2.94512165e-16]
  [1.82182186e-10 1.00000000e+00 2.42363790e-14 1.47945688e-13
   2.99657597e-13]
  [3.86019128e-09 1.00000000e+00 2.09301692e-13 9.16266086e-13
   9.35239950e-13]
  ...
  [1.20137875e-11 1.00000000e+00 1.07170268e-14 6.17506263e-14
   5.37570171e-14]
  [7.35794137e-09 1.00000000e+00 2.06641629e-13 1.08728586e-12
   1.79200231e-12]
  [3.09376418e-08 1.00000000e+00 7.43349284e-13 2.80826187e-12
   2.06043125e-12]]

 [[4.50429659e-11 1.00000000e+00 2.02475095e-14 1.12613633e-13
   1.05355767e-13]
  [7.22687426e-14 1.00000000e+00 5.70774846e-16 5.81058757e-15
   7.76143828e-15]
  [7.31743421e-05 9.99926805e-01 2.59351429e-11 5.82817683e-11
   7.46361375e-11]
  ...
  [1.66450978e-12 1.00000000e+00 3.12769690e-15 2.17127562e-14
   2.79969648e-14]
  [2.89434592e-08 1.00000000e+00 5.60994935e-13 2.50391591e-12
   2.57858405e-12]
  [1.00000000e+00 2.62784045e-10 9.04316905e-14 1.50132744e-14
   1.96753827e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[7.9185874e-17 1.0000000e+00 1.9063714e-17 3.1234030e-16 3.1940956e-16]
 [6.0964550e-10 1.0000000e+00 4.4581434e-14 2.5130337e-13 5.1942169e-13]
 [1.3308264e-01 8.6691737e-01 1.6448207e-09 1.8251671e-09 1.6696271e-09]
 ...
 [1.6645098e-12 1.0000000e+00 3.1276969e-15 2.1712756e-14 2.7996965e-14]
 [2.8943459e-08 1.0000000e+00 5.6099494e-13 2.5039159e-12 2.5785840e-12]
 [1.0000000e+00 2.6278404e-10 9.0431690e-14 1.5013274e-14 1.9675383e-14]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  8.636126210021972
tp :  44354.0
fp :  55646.0
tn :  344354.0
fn :  55646.0
accuracy :  0.7774183750152588
precision :  0.4435400068759918
recall :  0.4435400068759918
auc :  0.6558855772018433

y_eval {0: 64215, 1: 35785}
pred {0: 16093, 1: 83907}
[INFO] confusion matrix for file 
[[12331 51884     0     0     0]
 [ 3762 32023     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 269371 1510033       0       0       0]
 [  19978  170764       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4638640e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4638640e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4638640e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 3.4494117e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4494117e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4494117e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 1 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.1831850e-17 1.0000000e+00 1.6671299e-17 2.7772281e-16 2.8582690e-16]
  [2.6984109e-10 1.0000000e+00 2.9486206e-14 1.7566238e-13 3.5941565e-13]
  [1.4809844e-07 9.9999988e-01 1.4979764e-12 5.1145290e-12 4.5384178e-12]
  ...
  [6.3376630e-11 1.0000000e+00 2.2805088e-14 1.4597045e-13 1.5738227e-13]
  [1.0000000e+00 1.6504133e-12 7.3442627e-15 9.5408658e-16 1.2816129e-15]
  [6.7891786e-13 1.0000000e+00 2.9421922e-15 2.9309691e-14 2.0237587e-14]]

 [[6.1832088e-17 1.0000000e+00 1.6671299e-17 2.7772387e-16 2.8582799e-16]
  [2.7016864e-10 1.0000000e+00 2.9504323e-14 1.7575622e-13 3.5961587e-13]
  [1.4113725e-07 9.9999988e-01 1.4611785e-12 5.0080344e-12 4.4434443e-12]
  ...
  [2.2368242e-12 1.0000000e+00 4.2308135e-15 2.9593031e-14 2.8595260e-14]
  [2.7119720e-09 1.0000000e+00 1.3031481e-13 6.8508372e-13 1.0201800e-12]
  [1.0000000e+00 4.9854947e-12 1.5367985e-14 2.0881979e-15 2.1256343e-15]]

 [[6.4524442e-17 1.0000000e+00 1.7061571e-17 2.8341979e-16 2.9135427e-16]
  [3.6685543e-10 1.0000000e+00 3.4460048e-14 2.0133300e-13 4.1324011e-13]
  [1.2589010e-09 1.0000000e+00 1.1839392e-13 5.6576168e-13 5.7018377e-13]
  ...
  [1.0000000e+00 6.1205082e-12 1.4681221e-14 2.3014997e-15 2.7938166e-15]
  [6.6867275e-13 1.0000000e+00 2.7379821e-15 2.6204773e-14 2.0116440e-14]
  [2.0929264e-08 1.0000000e+00 3.4504986e-13 1.2695231e-12 2.0363915e-12]]

 ...

 [[6.4862785e-17 1.0000000e+00 1.7109736e-17 2.8411581e-16 2.9203970e-16]
  [1.8522911e-10 1.0000000e+00 2.4422508e-14 1.4891675e-13 3.0211616e-13]
  [1.0000000e+00 2.5698274e-10 9.7397649e-14 1.8648220e-14 2.0543819e-14]
  ...
  [3.5703454e-09 1.0000000e+00 1.5557660e-13 8.4407649e-13 1.1940087e-12]
  [3.6494270e-09 1.0000000e+00 2.1780917e-13 9.1744299e-13 8.1615568e-13]
  [7.3288250e-12 1.0000000e+00 7.3589291e-15 4.6789964e-14 5.3148770e-14]]

 [[2.2302000e-12 1.0000000e+00 4.2623697e-15 3.0805711e-14 2.8720102e-14]
  [4.2619594e-13 1.0000000e+00 1.3486996e-15 1.2066589e-14 1.7474232e-14]
  [6.8712552e-08 9.9999988e-01 7.3332388e-13 2.5717664e-12 3.3635434e-12]
  ...
  [2.2421800e-09 1.0000000e+00 1.6950479e-13 7.9783359e-13 8.0941205e-13]
  [2.2461328e-11 1.0000000e+00 1.5878969e-14 9.5542050e-14 7.6090867e-14]
  [3.2496444e-10 1.0000000e+00 4.1721245e-14 2.4169731e-13 3.8841792e-13]]

 [[2.4402837e-12 1.0000000e+00 4.4665161e-15 3.2030791e-14 2.9862133e-14]
  [4.0605198e-13 1.0000000e+00 1.3177336e-15 1.1831214e-14 1.7090975e-14]
  [8.1588919e-10 1.0000000e+00 7.8944406e-14 3.9497735e-13 4.5772929e-13]
  ...
  [9.0514098e-12 1.0000000e+00 8.2069429e-15 5.3001880e-14 5.9610601e-14]
  [1.0000000e+00 1.0564020e-11 1.8484404e-14 2.9873283e-15 3.8729455e-15]
  [4.3034641e-13 1.0000000e+00 2.2820044e-15 2.3391357e-14 1.6750436e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.1831850e-17 1.0000000e+00 1.6671299e-17 2.7772281e-16 2.8582690e-16]
 [2.6984109e-10 1.0000000e+00 2.9486206e-14 1.7566238e-13 3.5941565e-13]
 [1.4809844e-07 9.9999988e-01 1.4979764e-12 5.1145290e-12 4.5384178e-12]
 ...
 [9.0514098e-12 1.0000000e+00 8.2069429e-15 5.3001880e-14 5.9610601e-14]
 [1.0000000e+00 1.0564020e-11 1.8484404e-14 2.9873283e-15 3.8729455e-15]
 [4.3034641e-13 1.0000000e+00 2.2820044e-15 2.3391357e-14 1.6750436e-14]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 0 1] (100000,)
[33m[INFO] metrics:[0m
loss :  11.6607847946167
tp :  26303.0
fp :  73697.0
tn :  326303.0
fn :  73697.0
accuracy :  0.7052149176597595
precision :  0.2630299925804138
recall :  0.2630299925804138
auc :  0.5401915907859802

y_eval {0: 86129, 1: 13871}
pred {0: 14956, 1: 85044}
[INFO] confusion matrix for file 
[[13694 72435     0     0     0]
 [ 1262 12609     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 283065 1582468       0       0       0]
 [  21240  183373       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 0.34494117  0.          0.         ...  4.          0.00482
  -0.23351   ]
 [ 0.34494117  0.          0.         ...  3.          0.00482
   1.45442   ]
 [ 0.34494117  0.          0.         ...  1.          0.00482
  -0.32151   ]
 ...
 [ 1.0388104   0.          0.         ...  3.          0.00482
   1.45442   ]
 [ 1.0388104   0.          0.         ...  2.          0.00482
  -0.33484   ]
 [ 1.0388104   0.          0.         ...  4.          0.00482
  -0.23351   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99999881e-01 1.03730798e-07 1.88525172e-12 6.70767641e-13
   6.25529522e-13]
  [8.63201677e-10 1.00000000e+00 1.49535522e-13 8.91821773e-13
   4.07565041e-13]
  [4.29034639e-15 1.00000000e+00 1.24842796e-16 1.40460488e-15
   2.04937144e-15]
  ...
  [1.00000000e+00 3.00457294e-12 1.17783015e-14 1.67914350e-15
   1.72294157e-15]
  [2.76042264e-13 1.00000000e+00 1.64085952e-15 1.60725823e-14
   1.28148885e-14]
  [8.85552140e-07 9.99999166e-01 2.17503142e-12 6.49245371e-12
   1.21917303e-11]]

 [[1.00000000e+00 1.07742623e-12 8.48313915e-15 1.44886013e-15
   1.18292672e-15]
  [9.91307557e-01 8.69244244e-03 5.15953447e-10 4.36492259e-10
   3.02755626e-10]
  [3.53875488e-01 6.46124542e-01 1.74945991e-09 1.24542732e-09
   1.88848448e-09]
  ...
  [1.57059241e-10 1.00000000e+00 2.80040138e-14 1.87526671e-13
   3.04144405e-13]
  [2.11336499e-07 9.99999762e-01 1.75319665e-12 5.48601008e-12
   4.76647324e-12]
  [1.78811098e-11 1.00000000e+00 1.08906973e-14 5.67230860e-14
   7.44752431e-14]]

 [[2.92963635e-12 1.00000000e+00 4.91146295e-15 3.46684419e-14
   3.23219980e-14]
  [1.86197263e-13 1.00000000e+00 8.92623649e-16 8.46610278e-15
   1.19471363e-14]
  [2.60011248e-08 1.00000000e+00 4.33123128e-13 1.64830877e-12
   2.21737342e-12]
  ...
  [3.42504627e-12 1.00000000e+00 4.82625101e-15 3.34117398e-14
   3.82239813e-14]
  [1.00000000e+00 4.20259791e-12 1.16640172e-14 1.81583641e-15
   2.38490597e-15]
  [6.97301808e-13 1.00000000e+00 2.89078263e-15 2.84291769e-14
   2.07602693e-14]]

 ...

 [[6.18877807e-17 1.00000000e+00 1.66795048e-17 2.77843615e-16
   2.85943579e-16]
  [2.27451863e-10 1.00000000e+00 2.71228589e-14 1.63621070e-13
   3.31962891e-13]
  [1.50255164e-09 1.00000000e+00 1.28333867e-13 6.04062048e-13
   6.17055615e-13]
  ...
  [2.12098339e-09 1.00000000e+00 1.38062657e-13 6.24976199e-13
   7.91905658e-13]
  [1.08058847e-10 1.00000000e+00 3.90829980e-14 2.24898550e-13
   1.63016139e-13]
  [3.51053978e-11 1.00000000e+00 1.38740490e-14 8.58081577e-14
   1.26384011e-13]]

 [[8.42499762e-14 1.00000000e+00 7.71938712e-16 7.37646689e-15
   6.91985514e-15]
  [1.48611931e-14 1.00000000e+00 3.78633098e-16 5.34561815e-15
   3.64353170e-15]
  [1.07820628e-14 1.00000000e+00 1.88739243e-16 1.97491026e-15
   3.15341854e-15]
  ...
  [5.46074241e-10 1.00000000e+00 7.55848834e-14 3.84200376e-13
   3.81517463e-13]
  [9.99999762e-01 2.77949766e-07 2.59498369e-12 8.13708909e-13
   1.09106235e-12]
  [1.38415185e-13 1.00000000e+00 1.42869026e-15 1.65274898e-14
   1.02151470e-14]]

 [[9.99999762e-01 1.95987781e-07 2.47562192e-12 8.85354019e-13
   8.67812549e-13]
  [5.75192021e-13 1.00000000e+00 3.14666514e-15 3.40477937e-14
   1.68923747e-14]
  [1.10950326e-15 1.00000000e+00 6.08017587e-17 7.57340258e-16
   1.14685561e-15]
  ...
  [1.00000000e+00 2.19471978e-08 8.32022764e-13 2.24113642e-13
   2.63471211e-13]
  [7.13137977e-14 1.00000000e+00 9.49392220e-16 1.11943917e-14
   7.42598867e-15]
  [1.62207652e-08 1.00000000e+00 2.81229657e-13 1.06390743e-12
   1.86630420e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999988e-01 1.0373080e-07 1.8852517e-12 6.7076764e-13 6.2552952e-13]
 [8.6320168e-10 1.0000000e+00 1.4953552e-13 8.9182177e-13 4.0756504e-13]
 [4.2903464e-15 1.0000000e+00 1.2484280e-16 1.4046049e-15 2.0493714e-15]
 ...
 [1.0000000e+00 2.1947198e-08 8.3202276e-13 2.2411364e-13 2.6347121e-13]
 [7.1313798e-14 1.0000000e+00 9.4939222e-16 1.1194392e-14 7.4259887e-15]
 [1.6220765e-08 1.0000000e+00 2.8122966e-13 1.0639074e-12 1.8663042e-12]] (100000, 5)
pred 3 (argmax) [0 1 1 ... 0 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.631449717712403
tp :  14473.0
fp :  85527.0
tn :  314473.0
fn :  85527.0
accuracy :  0.6578953266143799
precision :  0.14473000168800354
recall :  0.14473000168800354
auc :  0.4656982719898224

y_eval {0: 100000}
pred {0: 14473, 1: 85527}
[INFO] confusion matrix for file 
[[14473 85527     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 297538 1667995       0       0       0]
 [  21240  183373       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0388104e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0388104e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0388104e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 1.7326796e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.7326796e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.7326796e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.73201537e-17 1.00000000e+00 1.74606445e-17 2.89251296e-16
   2.96957946e-16]
  [1.51363380e-10 1.00000000e+00 2.20771989e-14 1.36292399e-13
   2.75181706e-13]
  [1.45060509e-11 1.00000000e+00 1.20009441e-14 8.34493743e-14
   7.75022882e-14]
  ...
  [1.44557893e-10 1.00000000e+00 4.39898294e-14 2.25659091e-13
   1.62538006e-13]
  [6.30477198e-11 1.00000000e+00 1.74235440e-14 1.11406781e-13
   1.88099834e-13]
  [1.00000000e+00 8.69548322e-11 6.24271820e-14 1.11867929e-14
   1.07367914e-14]]

 [[1.00000000e+00 5.60640388e-11 5.47599075e-14 1.21012531e-14
   1.04186891e-14]
  [6.99959928e-04 9.99300003e-01 1.57400176e-10 3.09952508e-10
   1.43746209e-10]
  [2.00116378e-16 1.00000000e+00 2.94551340e-17 4.37329516e-16
   5.13420392e-16]
  ...
  [3.88422308e-07 9.99999642e-01 1.51599230e-12 4.45393071e-12
   6.91139463e-12]
  [6.79026391e-10 1.00000000e+00 8.72948700e-14 4.43681984e-13
   4.93514084e-13]
  [1.43305506e-10 1.00000000e+00 4.33559303e-14 2.24213267e-13
   1.65003794e-13]]

 [[6.18884888e-17 1.00000000e+00 1.66796322e-17 2.77845733e-16
   2.85944665e-16]
  [9.99436915e-01 5.63018140e-04 5.62911662e-11 3.92123660e-11
   1.00118330e-10]
  [9.40890269e-13 1.00000000e+00 3.53694616e-15 3.31036434e-14
   2.53808137e-14]
  ...
  [1.32379681e-08 1.00000000e+00 4.27179884e-13 2.06343189e-12
   1.75010332e-12]
  [1.40364890e-11 1.00000000e+00 9.54421987e-15 5.39618568e-14
   6.95853287e-14]
  [1.00000000e+00 7.88553278e-10 1.64772330e-13 4.00000603e-14
   4.59092162e-14]]

 ...

 [[6.30648455e-17 1.00000000e+00 1.68508371e-17 2.80343395e-16
   2.88374326e-16]
  [1.54816077e-10 1.00000000e+00 2.23123996e-14 1.37675312e-13
   2.78383517e-13]
  [9.99858022e-01 1.41966913e-04 6.09153075e-11 2.97402866e-11
   3.20507960e-11]
  ...
  [1.48029755e-10 1.00000000e+00 3.13093938e-14 2.03506632e-13
   2.64593740e-13]
  [8.86058871e-09 1.00000000e+00 3.09798411e-13 1.19940451e-12
   1.25064466e-12]
  [1.63704276e-11 1.00000000e+00 1.20723439e-14 7.42553940e-14
   7.62204359e-14]]

 [[7.21593382e-15 1.00000000e+00 2.12091928e-16 2.47948418e-15
   2.36214365e-15]
  [1.04499907e-11 1.00000000e+00 6.20587667e-15 4.44554265e-14
   7.66780031e-14]
  [3.97984889e-09 1.00000000e+00 1.91671521e-13 8.25977849e-13
   9.42163556e-13]
  ...
  [5.65682397e-11 1.00000000e+00 2.13937517e-14 1.34611560e-13
   1.46745382e-13]
  [9.99999046e-01 9.88292982e-07 4.50254591e-12 1.53747869e-12
   2.21684281e-12]
  [2.19587816e-13 1.00000000e+00 1.81623812e-15 2.00446637e-14
   1.25582324e-14]]

 [[6.60813085e-17 1.00000000e+00 1.72853550e-17 2.86699397e-16
   2.94490804e-16]
  [1.00000000e+00 1.64248148e-15 2.93880305e-16 2.70453302e-17
   2.71238528e-17]
  [9.68323886e-01 3.16761546e-02 7.82495624e-10 6.95605018e-10
   6.76181611e-10]
  ...
  [1.98562694e-10 1.00000000e+00 3.72447773e-14 2.28904704e-13
   2.85155905e-13]
  [1.14646702e-10 1.00000000e+00 3.52866675e-14 2.06654233e-13
   2.02328890e-13]
  [9.66862528e-12 1.00000000e+00 9.77327536e-15 6.73536476e-14
   6.09460602e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.7320154e-17 1.0000000e+00 1.7460645e-17 2.8925130e-16 2.9695795e-16]
 [1.5136338e-10 1.0000000e+00 2.2077199e-14 1.3629240e-13 2.7518171e-13]
 [1.4506051e-11 1.0000000e+00 1.2000944e-14 8.3449374e-14 7.7502288e-14]
 ...
 [1.9856269e-10 1.0000000e+00 3.7244777e-14 2.2890470e-13 2.8515590e-13]
 [1.1464670e-10 1.0000000e+00 3.5286668e-14 2.0665423e-13 2.0232889e-13]
 [9.6686253e-12 1.0000000e+00 9.7732754e-15 6.7353648e-14 6.0946060e-14]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.681823497009278
tp :  14387.0
fp :  85613.0
tn :  314387.0
fn :  85613.0
accuracy :  0.6575512290000916
precision :  0.14386999607086182
recall :  0.14386999607086182
auc :  0.4643543064594269

y_eval {0: 100000}
pred {0: 14387, 1: 85613}
[INFO] confusion matrix for file 
[[14387 85613     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 311925 1753608       0       0       0]
 [  21240  183373       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-01_151435_117.log.part12_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1377 (0.2754%)
[INFO] ** orig:[0:99.9964%,2:0.0036%]
[INFO] ** type:[0:99.9994%,1:0.0004%,2:0.0002%]
[INFO] ** i/f_name:[2:99.996%,3:0.004%]
[INFO] ** i/f_dir:[1:99.9964%,0:0.0036%]
[INFO] ** src:[22:38.049%,9:26.1306%,7:18.2264%,1:17.587%,21:0.0036%,11:0.0014%,10:0.001%,14:0.0004%,15:0.0002%,8:0.0002%,4:0.0002%]
[INFO] ** dst:[21:43.355%,10:20.8256%,8:18.226%,9:17.5868%,15:0.004%,6:0.001%,22:0.0006%,25:0.0004%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.9942%,1:0.004%,2:0.0018%]
[INFO] ** appi_name:[21:99.9932%,30:0.004%,22:0.0006%,26:0.0004%,0:0.0004%,31:0.0002%,27:0.0002%,24:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%,3:0.0002%]
[INFO] ** proxy_src_ip:[18:38.049%,20:26.1306%,13:18.2264%,6:17.587%,17:0.004%,10:0.0014%,11:0.001%,21:0.0002%,16:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9932%,-33.760870000000004:0.0066%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9974%,11:49.9958%,0:0.0066%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.13%,1:20.8244%,5:18.2258%,4:17.5864%,2:17.2242%,0:0.0092%]
[INFO] ** service:[0.0048200000000000005:99.9942%,-211.73542999999998:0.004%,-211.08818:0.0006%,-186.44547:0.0004%,-211.08346:0.0004%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.1304%,-0.32151:20.8246%,-1.27613:18.226%,-0.23351:17.5866%,-0.33484:17.2244%,-71.33197:0.004%,-6.49859:0.0008%,-71.14931:0.0006%,-0.24151:0.0004%,-64.19493:0.0004%,-71.14798:0.0004%,-68.79874000000001:0.0002%,-1.81611:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,-61.95768:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:97.1716%,Single Stage Single Point:2.8284%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7293270e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.7293270e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.7293270e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 ...
 [-1.0398644e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.0398644e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0398644e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.29427812e-16 1.00000000e+00 2.48621574e-17 3.93812272e-16
   3.98071551e-16]
  [1.00000000e+00 1.24060079e-14 6.42765923e-16 6.16909646e-17
   7.97007578e-17]
  [4.57078923e-11 1.00000000e+00 2.16256321e-14 1.43129920e-13
   1.15170568e-13]
  ...
  [4.75600635e-11 1.00000000e+00 2.25443884e-14 1.47193618e-13
   1.18869988e-13]
  [6.53372680e-08 9.99999881e-01 5.85224686e-13 2.05541075e-12
   4.03487443e-12]
  [8.84360318e-09 1.00000000e+00 4.72086237e-13 2.11293700e-12
   1.21116561e-12]]

 [[7.88070851e-17 1.00000000e+00 1.90192596e-17 3.11771281e-16
   3.18723093e-16]
  [1.33808492e-10 1.00000000e+00 2.08018485e-14 1.29200849e-13
   2.59230164e-13]
  [1.64133834e-03 9.98358667e-01 1.75881490e-10 2.84858331e-10
   2.71279221e-10]
  ...
  [1.33379835e-11 1.00000000e+00 1.26603982e-14 9.30671555e-14
   6.80327919e-14]
  [1.42476306e-08 1.00000000e+00 2.64472146e-13 1.04730721e-12
   2.02134208e-12]
  [1.37115180e-07 9.99999881e-01 1.88241675e-12 6.74611929e-12
   4.18824177e-12]]

 [[9.99079943e-01 9.19998391e-04 1.35687322e-10 6.27407848e-11
   6.61654342e-11]
  [7.17804360e-16 1.00000000e+00 6.36582318e-17 9.03714275e-16
   9.31281491e-16]
  [9.99996543e-01 3.45700096e-06 5.90030108e-12 2.47576027e-12
   4.55269069e-12]
  ...
  [2.75168072e-13 1.00000000e+00 1.13506068e-15 8.39246766e-15
   1.25557896e-14]
  [5.08756557e-07 9.99999523e-01 2.68229427e-12 1.10635199e-11
   9.68063390e-12]
  [1.00000000e+00 2.95173804e-14 1.08309489e-15 1.00340032e-16
   1.28709462e-16]]

 ...

 [[7.57441015e-17 1.00000000e+00 1.86147170e-17 3.05953436e-16
   3.13102606e-16]
  [1.25604138e-10 1.00000000e+00 2.01526147e-14 1.25790478e-13
   2.51924404e-13]
  [1.90713201e-09 1.00000000e+00 1.43797870e-13 6.64659734e-13
   6.85309773e-13]
  ...
  [3.50011353e-09 1.00000000e+00 2.63196474e-13 1.23737153e-12
   8.53938231e-13]
  [5.87068263e-13 1.00000000e+00 1.96334974e-15 1.51356436e-14
   1.65300445e-14]
  [1.28399861e-07 9.99999881e-01 9.94284299e-13 4.06456596e-12
   5.75496161e-12]]

 [[6.38033656e-17 1.00000000e+00 1.69575582e-17 2.81900506e-16
   2.89886438e-16]
  [7.29562466e-10 1.00000000e+00 4.86523799e-14 2.71979379e-13
   5.66549954e-13]
  [1.74350245e-09 1.00000000e+00 1.41976532e-13 6.61462584e-13
   6.58381281e-13]
  ...
  [1.10635199e-12 1.00000000e+00 2.75159373e-15 1.91088464e-14
   2.00971103e-14]
  [1.15735403e-07 9.99999881e-01 8.96768282e-13 3.93985842e-12
   6.07898454e-12]
  [1.68067704e-09 1.00000000e+00 1.61934593e-13 7.55052433e-13
   5.78780784e-13]]

 [[6.76261907e-17 1.00000000e+00 1.75012558e-17 2.89805732e-16
   2.97564633e-16]
  [1.00000000e+00 1.41263954e-13 1.72895931e-15 1.92312068e-16
   3.32770022e-16]
  [8.67351059e-13 1.00000000e+00 2.87777750e-15 2.61144137e-14
   2.22089277e-14]
  ...
  [5.87147841e-09 1.00000000e+00 3.04854124e-13 1.29779108e-12
   9.99421899e-13]
  [1.00000000e+00 8.65465523e-13 5.48551115e-15 6.20336437e-16
   8.42241864e-16]
  [3.97614016e-12 1.00000000e+00 8.08849464e-15 7.27134011e-14
   4.38414021e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.2942781e-16 1.0000000e+00 2.4862157e-17 3.9381227e-16 3.9807155e-16]
 [1.0000000e+00 1.2406008e-14 6.4276592e-16 6.1690965e-17 7.9700758e-17]
 [4.5707892e-11 1.0000000e+00 2.1625632e-14 1.4312992e-13 1.1517057e-13]
 ...
 [5.8714784e-09 1.0000000e+00 3.0485412e-13 1.2977911e-12 9.9942190e-13]
 [1.0000000e+00 8.6546552e-13 5.4855112e-15 6.2033644e-16 8.4224186e-16]
 [3.9761402e-12 1.0000000e+00 8.0884946e-15 7.2713401e-14 4.3841402e-14]] (100000, 5)
pred 3 (argmax) [1 0 1 ... 1 0 1] (100000,)
[33m[INFO] metrics:[0m
loss :  12.783683549499512
tp :  18475.0
fp :  81525.0
tn :  318475.0
fn :  81525.0
accuracy :  0.673903226852417
precision :  0.1847500056028366
recall :  0.1847500056028366
auc :  0.4907601475715637

y_eval {0: 100000}
pred {0: 18475, 1: 81525}
[INFO] confusion matrix for file 
[[18475 81525     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 330400 1835133       0       0       0]
 [  21240  183373       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0398644e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.0398644e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0398644e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-3.4786710e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4786710e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-3.4786710e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.00000000e+00 3.39195360e-13 4.92485835e-15 7.78634454e-16
   6.23984291e-16]
  [9.94580150e-01 5.41985454e-03 3.81709997e-10 3.16540461e-10
   2.46797166e-10]
  [1.00000000e+00 3.64167355e-13 3.07982916e-15 3.02859965e-16
   4.38022389e-16]
  ...
  [4.80740638e-08 1.00000000e+00 5.95826665e-13 2.88868148e-12
   4.12062832e-12]
  [3.12842410e-08 1.00000000e+00 6.49297564e-13 2.17581335e-12
   1.95124971e-12]
  [5.85104491e-12 1.00000000e+00 6.44578351e-15 4.12331302e-14
   4.85008016e-14]]

 [[2.00243756e-01 7.99756229e-01 1.62878389e-09 1.37910749e-09
   1.41149703e-09]
  [8.42784971e-16 1.00000000e+00 6.85393385e-17 9.69285001e-16
   1.01161399e-15]
  [4.51168216e-06 9.99995470e-01 4.91544999e-12 1.36877818e-11
   2.29723983e-11]
  ...
  [1.16799691e-12 1.00000000e+00 2.69977352e-15 1.81076010e-14
   2.25309748e-14]
  [1.00000000e+00 3.88807435e-15 4.67440691e-16 4.28512446e-17
   4.40313964e-17]
  [1.03828777e-11 1.00000000e+00 1.03868635e-14 7.73770357e-14
   6.24301568e-14]]

 [[6.18379844e-17 1.00000000e+00 1.66721892e-17 2.77736598e-16
   2.85839977e-16]
  [9.30695713e-01 6.93042949e-02 9.94959559e-10 1.39427425e-09
   1.24870669e-09]
  [1.24648776e-14 1.00000000e+00 2.08548220e-16 2.00391478e-15
   3.67624327e-15]
  ...
  [1.00000000e+00 8.96647267e-16 2.30058569e-16 1.88118093e-17
   1.91519840e-17]
  [1.58167854e-11 1.00000000e+00 1.26286590e-14 9.09709320e-14
   7.42565189e-14]
  [3.58094582e-07 9.99999642e-01 1.38685547e-12 4.35204997e-12
   8.77026403e-12]]

 ...

 [[7.43179032e-17 1.00000000e+00 1.84237640e-17 3.03201002e-16
   3.10442102e-16]
  [1.92727598e-10 1.00000000e+00 2.49602178e-14 1.51548899e-13
   3.06855669e-13]
  [2.20007079e-09 1.00000000e+00 1.64217923e-13 7.72209391e-13
   7.14734261e-13]
  ...
  [3.99748368e-09 1.00000000e+00 2.76600411e-13 1.27662800e-12
   9.05731165e-13]
  [8.61364907e-13 1.00000000e+00 2.41095752e-15 1.80556626e-14
   1.95786109e-14]
  [5.61353318e-07 9.99999404e-01 2.12941015e-12 7.85278526e-12
   1.11590997e-11]]

 [[1.00000000e+00 4.80230818e-13 5.79502588e-15 9.37254662e-16
   7.55464715e-16]
  [9.94188309e-01 5.81169361e-03 3.87184090e-10 3.21113663e-10
   2.57181859e-10]
  [2.13636921e-11 1.00000000e+00 1.38845056e-14 8.39970996e-14
   8.26191735e-14]
  ...
  [9.32433295e-08 9.99999881e-01 1.39982741e-12 5.20452301e-12
   3.12179492e-12]
  [1.00000000e+00 1.86493165e-11 1.80032889e-14 2.37669589e-15
   4.94664277e-15]
  [2.30175462e-11 1.00000000e+00 2.59024437e-14 2.38717927e-13
   1.06933268e-13]]

 [[1.00000000e+00 4.80210652e-13 5.79493779e-15 9.37240368e-16
   7.55458945e-16]
  [9.96116877e-01 3.88313364e-03 3.26760813e-10 2.64350569e-10
   2.04305864e-10]
  [9.98179436e-01 1.82063901e-03 1.77837273e-10 9.51867127e-11
   9.70478073e-11]
  ...
  [2.58490951e-10 1.00000000e+00 5.59876547e-14 2.73259036e-13
   2.10270007e-13]
  [3.78253151e-10 1.00000000e+00 4.16161754e-14 2.31982727e-13
   4.22315855e-13]
  [1.00000000e+00 9.26918530e-16 2.38497743e-16 1.98637746e-17
   1.95483558e-17]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.0000000e+00 3.3919536e-13 4.9248583e-15 7.7863445e-16 6.2398429e-16]
 [9.9458015e-01 5.4198545e-03 3.8171000e-10 3.1654046e-10 2.4679717e-10]
 [1.0000000e+00 3.6416736e-13 3.0798292e-15 3.0285997e-16 4.3802239e-16]
 ...
 [2.5849095e-10 1.0000000e+00 5.5987655e-14 2.7325904e-13 2.1027001e-13]
 [3.7825315e-10 1.0000000e+00 4.1616175e-14 2.3198273e-13 4.2231586e-13]
 [1.0000000e+00 9.2691853e-16 2.3849774e-16 1.9863775e-17 1.9548356e-17]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  13.121272691345215
tp :  16336.0
fp :  83664.0
tn :  316336.0
fn :  83664.0
accuracy :  0.6653472781181335
precision :  0.16335999965667725
recall :  0.16335999965667725
auc :  0.47836703062057495

y_eval {0: 100000}
pred {0: 16336, 1: 83664}
[INFO] confusion matrix for file 
[[16336 83664     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 346736 1918797       0       0       0]
 [  21240  183373       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4786710e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4786710e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4786710e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 3.4666502e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4666502e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 3.4666502e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.5843524e-17 1.0000000e+00 1.7249588e-17 2.8615092e-16 2.9401488e-16]
  [1.3423335e-10 1.0000000e+00 2.0801689e-14 1.2953866e-13 2.6039273e-13]
  [4.0804556e-05 9.9995923e-01 2.7035801e-11 5.9636122e-11 5.3466960e-11]
  ...
  [3.8917454e-12 1.0000000e+00 5.3610769e-15 4.0889709e-14 4.3741422e-14]
  [9.8646645e-08 9.9999988e-01 8.8953503e-13 2.9788318e-12 4.0973045e-12]
  [5.6039451e-11 1.0000000e+00 2.7012892e-14 1.6735753e-13 1.3767741e-13]]

 [[1.7202195e-03 9.9827981e-01 1.5917402e-10 1.9901895e-10 1.9974608e-10]
  [1.0265143e-15 1.0000000e+00 7.4611625e-17 1.0435629e-15 1.1100662e-15]
  [3.7852815e-06 9.9999619e-01 4.5124200e-12 1.2696618e-11 2.1365036e-11]
  ...
  [1.7411678e-11 1.0000000e+00 1.3126219e-14 9.4644067e-14 7.8590902e-14]
  [3.8379266e-08 1.0000000e+00 4.5000069e-13 1.6380415e-12 3.1631941e-12]
  [5.7319007e-09 1.0000000e+00 3.7813787e-13 1.7560351e-12 1.0063809e-12]]

 [[6.1848129e-17 1.0000000e+00 1.6673653e-17 2.7775777e-16 2.8586070e-16]
  [2.0594157e-10 1.0000000e+00 2.5750918e-14 1.5610510e-13 3.1744708e-13]
  [6.9685382e-09 1.0000000e+00 2.8522283e-13 1.1922495e-12 1.2135011e-12]
  ...
  [3.5828021e-09 1.0000000e+00 2.5016805e-13 1.1511067e-12 8.7278264e-13]
  [4.4709297e-12 1.0000000e+00 5.7803663e-15 3.8167959e-14 4.0554247e-14]
  [1.3975842e-08 1.0000000e+00 3.3419215e-13 1.5597303e-12 2.0424714e-12]]

 ...

 [[6.1907375e-17 1.0000000e+00 1.6682368e-17 2.7788599e-16 2.8598395e-16]
  [1.0000000e+00 4.2818367e-11 2.3847162e-14 4.1890425e-15 8.6156117e-15]
  [1.0734366e-12 1.0000000e+00 3.3498376e-15 2.9888059e-14 2.6138732e-14]
  ...
  [5.9141411e-07 9.9999940e-01 2.9888813e-12 1.0072488e-11 8.8313298e-12]
  [3.4675353e-12 1.0000000e+00 4.9042733e-15 3.1262553e-14 3.7402962e-14]
  [3.9885504e-09 1.0000000e+00 2.0792457e-13 1.1046735e-12 1.0660261e-12]]

 [[4.9851678e-07 9.9999952e-01 2.4492682e-12 6.0413120e-12 5.8519686e-12]
  [3.6248025e-15 1.0000000e+00 1.3632234e-16 1.7413170e-15 1.9812639e-15]
  [5.2101041e-06 9.9999475e-01 5.5462154e-12 1.4955943e-11 2.4308696e-11]
  ...
  [8.4634438e-10 1.0000000e+00 6.5111531e-14 2.7214179e-13 4.3542914e-13]
  [9.6801918e-09 1.0000000e+00 3.6459616e-13 1.6889686e-12 1.6339724e-12]
  [4.3190430e-11 1.0000000e+00 2.1345330e-14 1.1892397e-13 1.0269422e-13]]

 [[6.6678903e-17 1.0000000e+00 1.7367908e-17 2.8786984e-16 2.9568515e-16]
  [1.0000000e+00 2.4573882e-08 7.6881015e-13 2.9407927e-13 2.8249842e-13]
  [1.7618579e-05 9.9998236e-01 1.2496099e-11 2.1811775e-11 4.2222826e-11]
  ...
  [2.4447887e-12 1.0000000e+00 4.1274658e-15 2.6426425e-14 2.8383988e-14]
  [9.1158920e-09 1.0000000e+00 2.5451944e-13 1.3446896e-12 1.8745131e-12]
  [6.5285048e-09 1.0000000e+00 2.9015020e-13 1.1383015e-12 1.0354039e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.5843524e-17 1.0000000e+00 1.7249588e-17 2.8615092e-16 2.9401488e-16]
 [1.3423335e-10 1.0000000e+00 2.0801689e-14 1.2953866e-13 2.6039273e-13]
 [4.0804556e-05 9.9995923e-01 2.7035801e-11 5.9636122e-11 5.3466960e-11]
 ...
 [2.4447887e-12 1.0000000e+00 4.1274658e-15 2.6426425e-14 2.8383988e-14]
 [9.1158920e-09 1.0000000e+00 2.5451944e-13 1.3446896e-12 1.8745131e-12]
 [6.5285048e-09 1.0000000e+00 2.9015020e-13 1.1383015e-12 1.0354039e-12]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.443057736206054
tp :  15198.0
fp :  84802.0
tn :  315198.0
fn :  84802.0
accuracy :  0.6607953310012817
precision :  0.15197999775409698
recall :  0.15197999775409698
auc :  0.4699159562587738

y_eval {0: 100000}
pred {0: 15198, 1: 84802}
[INFO] confusion matrix for file 
[[15198 84802     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 361934 2003599       0       0       0]
 [  21240  183373       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4666502e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4666502e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4666502e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 1.0386623e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.0386623e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0386623e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.6690352e-17 1.0000000e+00 1.7369499e-17 2.8789401e-16 2.9570773e-16]
  [1.0000000e+00 3.1631114e-11 2.0655640e-14 3.5260612e-15 7.2288282e-15]
  [9.0305394e-13 1.0000000e+00 3.0586139e-15 2.7697403e-14 2.4117451e-14]
  ...
  [3.7956312e-07 9.9999964e-01 2.4126992e-12 8.3263726e-12 7.1306502e-12]
  [3.7671559e-12 1.0000000e+00 5.0596429e-15 3.1958296e-14 3.8910512e-14]
  [5.1553490e-09 1.0000000e+00 2.4003789e-13 1.2568382e-12 1.1958320e-12]]

 [[6.6701800e-17 1.0000000e+00 1.7371155e-17 2.8791706e-16 2.9573028e-16]
  [1.0000000e+00 2.9959962e-11 2.0141893e-14 3.4230816e-15 7.0084251e-15]
  [1.9206466e-12 1.0000000e+00 4.9556518e-15 4.4570891e-14 3.3017443e-14]
  ...
  [1.0000000e+00 3.6675554e-13 4.2510517e-15 5.1434567e-16 5.3147500e-16]
  [3.1861051e-13 1.0000000e+00 1.7921362e-15 1.7821666e-14 1.3721595e-14]
  [1.0441483e-07 9.9999988e-01 7.2229218e-13 2.4781308e-12 4.7385373e-12]]

 [[6.1908321e-17 1.0000000e+00 1.6682496e-17 2.7788814e-16 2.8598612e-16]
  [2.9010083e-10 1.0000000e+00 3.0578980e-14 1.8133116e-13 3.7154546e-13]
  [1.3816674e-09 1.0000000e+00 1.2406700e-13 5.8930530e-13 5.9413574e-13]
  ...
  [1.0000000e+00 6.9962125e-09 4.4093426e-13 1.1729994e-13 1.4466828e-13]
  [2.4856045e-13 1.0000000e+00 1.6780165e-15 1.7146417e-14 1.3164932e-14]
  [5.1118288e-08 1.0000000e+00 5.5794307e-13 1.9207784e-12 2.8823302e-12]]

 ...

 [[6.4878621e-17 1.0000000e+00 1.7112021e-17 2.8414943e-16 2.9207202e-16]
  [1.4859013e-10 1.0000000e+00 2.1893071e-14 1.3551320e-13 2.7287572e-13]
  [2.4744649e-09 1.0000000e+00 1.6531313e-13 7.4920370e-13 7.6907122e-13]
  ...
  [9.7243394e-14 1.0000000e+00 1.3039325e-15 1.6552318e-14 8.8373709e-15]
  [4.4431379e-09 1.0000000e+00 1.3447812e-13 4.9672587e-13 9.3307339e-13]
  [1.4592210e-08 1.0000000e+00 4.8432330e-13 2.2214034e-12 2.0350130e-12]]

 [[6.2875322e-17 1.0000000e+00 1.6823348e-17 2.7994267e-16 2.8798406e-16]
  [2.3096146e-10 1.0000000e+00 2.7274861e-14 1.6406546e-13 3.3453204e-13]
  [2.5868048e-09 1.0000000e+00 1.7112838e-13 7.7376777e-13 7.8354901e-13]
  ...
  [2.7553387e-11 1.0000000e+00 1.6959914e-14 9.1562093e-14 7.5406044e-14]
  [9.9998021e-01 1.9785120e-05 1.6807189e-11 1.0043960e-11 1.8012784e-11]
  [4.5267325e-11 1.0000000e+00 3.2394518e-14 2.4431883e-13 1.3540314e-13]]

 [[6.1866300e-17 1.0000000e+00 1.6676388e-17 2.7779803e-16 2.8589887e-16]
  [1.5010901e-10 1.0000000e+00 2.1992513e-14 1.3613547e-13 2.7441019e-13]
  [2.4453473e-09 1.0000000e+00 1.6441758e-13 7.4608071e-13 7.6520252e-13]
  ...
  [2.7803665e-08 1.0000000e+00 3.8224149e-13 1.4810162e-12 2.4389343e-12]
  [3.2005589e-09 1.0000000e+00 2.0735071e-13 9.4741825e-13 9.3043780e-13]
  [2.1792616e-11 1.0000000e+00 1.5200506e-14 8.7863487e-14 7.3857343e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.6690352e-17 1.0000000e+00 1.7369499e-17 2.8789401e-16 2.9570773e-16]
 [1.0000000e+00 3.1631114e-11 2.0655640e-14 3.5260612e-15 7.2288282e-15]
 [9.0305394e-13 1.0000000e+00 3.0586139e-15 2.7697403e-14 2.4117451e-14]
 ...
 [2.7803665e-08 1.0000000e+00 3.8224149e-13 1.4810162e-12 2.4389343e-12]
 [3.2005589e-09 1.0000000e+00 2.0735071e-13 9.4741825e-13 9.3043780e-13]
 [2.1792616e-11 1.0000000e+00 1.5200506e-14 8.7863487e-14 7.3857343e-14]] (100000, 5)
pred 3 (argmax) [1 0 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.597431340026855
tp :  14682.0
fp :  85318.0
tn :  314682.0
fn :  85318.0
accuracy :  0.65873122215271
precision :  0.14681999385356903
recall :  0.14681999385356903
auc :  0.4671352207660675

y_eval {0: 100000}
pred {0: 14682, 1: 85318}
[INFO] confusion matrix for file 
[[14682 85318     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 376616 2088917       0       0       0]
 [  21240  183373       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0386623e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0386623e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0386623e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [ 1.7331945e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.7331945e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.7331945e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 1 1] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99999881e-01 9.45977803e-08 1.75840776e-12 5.95272258e-13
   5.76948862e-13]
  [1.00514735e-12 1.00000000e+00 4.22059323e-15 4.38386408e-14
   2.14927292e-14]
  [6.84479225e-16 1.00000000e+00 4.78954648e-17 6.18542951e-16
   9.22931546e-16]
  ...
  [1.98499928e-09 1.00000000e+00 1.01418067e-13 4.43352061e-13
   7.00736290e-13]
  [1.15776033e-09 1.00000000e+00 1.26038326e-13 6.64431563e-13
   6.19488402e-13]
  [7.07765834e-12 1.00000000e+00 8.43203511e-15 5.53371741e-14
   4.68653504e-14]]

 [[6.68554106e-17 1.00000000e+00 1.73950938e-17 2.88296213e-16
   2.96036162e-16]
  [1.51540461e-10 1.00000000e+00 2.20871803e-14 1.36352193e-13
   2.75371766e-13]
  [1.45641743e-09 1.00000000e+00 1.25941710e-13 5.95642567e-13
   6.08304151e-13]
  ...
  [7.04259637e-11 1.00000000e+00 2.82470800e-14 1.42823944e-13
   1.14347334e-13]
  [2.82725232e-10 1.00000000e+00 3.85447967e-14 2.43584124e-13
   3.97682104e-13]
  [5.10086196e-08 1.00000000e+00 9.29114858e-13 3.41302095e-12
   2.58583389e-12]]

 [[3.38946841e-14 1.00000000e+00 4.78883629e-16 4.93599260e-15
   4.65082456e-15]
  [3.62471143e-12 1.00000000e+00 3.73741302e-15 2.87431212e-14
   4.68530176e-14]
  [6.61337785e-09 1.00000000e+00 2.39027304e-13 9.90665015e-13
   1.18361007e-12]
  ...
  [9.99997973e-01 1.99690317e-06 6.32423107e-12 2.32470488e-12
   3.30191083e-12]
  [3.01364538e-13 1.00000000e+00 2.11066211e-15 2.26441096e-14
   1.46957895e-14]
  [2.30345654e-09 1.00000000e+00 1.10576919e-13 4.45245213e-13
   6.68598748e-13]]

 ...

 [[6.18226518e-17 1.00000000e+00 1.66699012e-17 2.77702690e-16
   2.85808345e-16]
  [1.51830354e-10 1.00000000e+00 2.20951018e-14 1.36566146e-13
   2.75984883e-13]
  [1.08736726e-11 1.00000000e+00 1.03229904e-14 7.33846916e-14
   6.82107975e-14]
  ...
  [1.00000000e+00 1.64430917e-11 2.37573616e-14 3.88966169e-15
   4.77078771e-15]
  [3.60411055e-13 1.00000000e+00 2.03033819e-15 2.05236100e-14
   1.51864808e-14]
  [2.60911435e-08 1.00000000e+00 3.72827501e-13 1.35093911e-12
   2.27731202e-12]]

 [[6.18429409e-17 1.00000000e+00 1.66729535e-17 2.77747186e-16
   2.85850882e-16]
  [6.05088758e-07 9.99999404e-01 3.27888302e-12 1.86038303e-11
   1.14616398e-11]
  [2.08510141e-15 1.00000000e+00 8.46903378e-17 9.46994058e-16
   1.51765117e-15]
  ...
  [1.00000000e+00 1.96651593e-12 8.82736402e-15 1.29028084e-15
   1.49906049e-15]
  [2.87423676e-13 1.00000000e+00 1.75601227e-15 1.81320006e-14
   1.36730794e-14]
  [5.92298619e-08 1.00000000e+00 5.56430770e-13 1.92488603e-12
   3.43240996e-12]]

 [[6.22904257e-17 1.00000000e+00 1.67384001e-17 2.78705577e-16
   2.86777060e-16]
  [1.00000000e+00 2.68334553e-15 3.71661117e-16 3.57407835e-17
   3.55619438e-17]
  [2.90063722e-14 1.00000000e+00 4.54879139e-16 5.13863464e-15
   4.13110420e-15]
  ...
  [3.55628314e-13 1.00000000e+00 1.83058092e-15 1.80582105e-14
   1.48537121e-14]
  [4.31439737e-08 1.00000000e+00 4.86965069e-13 1.79105916e-12
   3.09483212e-12]
  [1.62280611e-09 1.00000000e+00 1.67837031e-13 8.25919574e-13
   6.32673818e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999988e-01 9.4597780e-08 1.7584078e-12 5.9527226e-13 5.7694886e-13]
 [1.0051474e-12 1.0000000e+00 4.2205932e-15 4.3838641e-14 2.1492729e-14]
 [6.8447922e-16 1.0000000e+00 4.7895465e-17 6.1854295e-16 9.2293155e-16]
 ...
 [3.5562831e-13 1.0000000e+00 1.8305809e-15 1.8058210e-14 1.4853712e-14]
 [4.3143974e-08 1.0000000e+00 4.8696507e-13 1.7910592e-12 3.0948321e-12]
 [1.6228061e-09 1.0000000e+00 1.6783703e-13 8.2591957e-13 6.3267382e-13]] (100000, 5)
pred 3 (argmax) [0 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  12.35865786743164
tp :  22011.0
fp :  77989.0
tn :  322011.0
fn :  77989.0
accuracy :  0.6880470514297485
precision :  0.2201099991798401
recall :  0.2201099991798401
auc :  0.5135715007781982

y_eval {0: 85858, 1: 14142}
pred {0: 14355, 1: 85645}
[INFO] confusion matrix for file 
[[11112 74746     0     0     0]
 [ 3243 10899     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 387728 2163663       0       0       0]
 [  24483  194272       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-01_151435_117.log.part13_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0:99.9986%,2:0.0014%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.998%,3:0.002%]
[INFO] ** i/f_dir:[1:99.998%,0:0.002%]
[INFO] ** src:[22:38.1186%,9:26.0918%,7:18.2288%,1:17.558%,21:0.0018%,14:0.0006%,15:0.0004%]
[INFO] ** dst:[21:43.3702%,10:20.8392%,8:18.2288%,9:17.5578%,15:0.002%,22:0.0012%,24:0.0004%,18:0.0002%,6:0.0002%]
[INFO] ** proto:[0:99.9976%,1:0.002%,2:0.0004%]
[INFO] ** appi_name:[21:99.9976%,30:0.002%,31:0.0002%,22:0.0002%]
[INFO] ** proxy_src_ip:[18:38.1186%,20:26.0918%,13:18.2288%,6:17.558%,17:0.002%,16:0.0004%,7:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.9976%,-33.760870000000004:0.0024%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.9978%,0:0.0024%]
[INFO] ** modbus_transaction_id:65534 (13.1068%)
[INFO] ** scada_tag:[3:26.0906%,1:20.839%,5:18.2282%,4:17.5572%,2:17.2792%,0:0.0058%]
[INFO] ** service:[0.0048200000000000005:99.9976%,-211.73542999999998:0.002%,-186.43601999999998:0.0002%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.0908%,-0.32151:20.8392%,-1.27613:18.2284%,-0.23351:17.5576%,-0.33484:17.2794%,-71.33197:0.002%,1.45709:0.0006%,-1.27347:0.0004%,-1.02014:0.0004%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,4.42897:0.0002%,-0.24151:0.0002%,-71.14931:0.0002%]
[INFO] ** classification:[normal:87.5394%,Single Stage Single Point:12.4606%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7325106  0.         0.        ...  2.         0.00482   -0.33484  ]
 [-1.7325106  0.         0.        ...  3.         0.00482    1.45442  ]
 [-1.7325106  0.         0.        ...  2.         0.00482   -0.33484  ]
 ...
 [-1.0383536  0.         0.        ...  1.         0.00482   -0.32151  ]
 [-1.0383536  0.         0.        ...  2.         0.00482   -0.33484  ]
 [-1.0383536  0.         0.        ...  1.         0.00482   -0.32151  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 1 0 ... 1 0 1] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.19184790e-17 1.00000000e+00 1.66840245e-17 2.77909339e-16
   2.86006869e-16]
  [4.83455498e-10 1.00000000e+00 3.95491270e-14 2.27101256e-13
   4.69489356e-13]
  [2.70101785e-09 1.00000000e+00 1.76998918e-13 7.96553307e-13
   7.98512569e-13]
  ...
  [3.54709084e-09 1.00000000e+00 2.29082459e-13 1.03211504e-12
   9.02750856e-13]
  [4.39927261e-12 1.00000000e+00 6.18703739e-15 4.22404218e-14
   3.97707685e-14]
  [3.00007064e-09 1.00000000e+00 1.40934004e-13 7.06097561e-13
   1.01712963e-12]]

 [[7.19459793e-17 1.00000000e+00 1.81021165e-17 2.98552671e-16
   3.05954600e-16]
  [1.40947934e-10 1.00000000e+00 2.13248608e-14 1.32156832e-13
   2.65949209e-13]
  [5.02462573e-02 9.49753761e-01 9.93627292e-10 1.22080335e-09
   1.18105603e-09]
  ...
  [1.57031845e-08 1.00000000e+00 2.87275683e-13 1.12090599e-12
   1.98342189e-12]
  [4.25568913e-09 1.00000000e+00 2.80011447e-13 1.30430259e-12
   9.56898189e-13]
  [1.71350250e-12 1.00000000e+00 3.45335269e-15 2.38601727e-14
   2.58374593e-14]]

 [[6.18726731e-17 1.00000000e+00 1.66772780e-17 2.77810766e-16
   2.85911948e-16]
  [1.58353886e-10 1.00000000e+00 2.25598721e-14 1.39032489e-13
   2.81404565e-13]
  [2.31362796e-09 1.00000000e+00 1.60373139e-13 7.31761873e-13
   7.46470756e-13]
  ...
  [1.34875132e-11 1.00000000e+00 1.07482653e-14 6.08406012e-14
   5.80149874e-14]
  [7.18741244e-09 1.00000000e+00 2.15725807e-13 1.13360851e-12
   1.72976683e-12]
  [1.00000000e+00 9.45803630e-14 2.30606965e-15 2.41188529e-16
   2.32583124e-16]]

 ...

 [[1.00000000e+00 3.74040868e-11 4.49085552e-14 9.67862960e-15
   8.30675640e-15]
  [9.98087347e-01 1.91264122e-03 2.60391264e-10 1.85413712e-10
   1.18895185e-10]
  [6.40920490e-14 1.00000000e+00 6.25571577e-16 5.90540148e-15
   6.70390960e-15]
  ...
  [2.81800089e-06 9.99997139e-01 3.96885519e-12 1.11396161e-11
   2.03967520e-11]
  [4.16692592e-09 1.00000000e+00 2.69248924e-13 1.20588695e-12
   9.77069445e-13]
  [8.64512368e-12 1.00000000e+00 8.60342715e-15 5.18414860e-14
   4.91681721e-14]]

 [[1.00000000e+00 3.23852653e-13 4.81560296e-15 7.58641459e-16
   6.07417491e-16]
  [9.98715878e-01 1.28410861e-03 1.90904278e-10 1.44418533e-10
   1.12662206e-10]
  [8.41532213e-08 9.99999881e-01 9.08662251e-13 2.50560683e-12
   3.02626110e-12]
  ...
  [1.79238693e-10 1.00000000e+00 4.48254613e-14 2.30409333e-13
   2.00674723e-13]
  [3.39417217e-10 1.00000000e+00 4.62347920e-14 2.48554758e-13
   3.49247757e-13]
  [2.15688498e-08 1.00000000e+00 5.26559861e-13 2.02202447e-12
   1.89005474e-12]]

 [[6.42319510e-17 1.00000000e+00 1.70192527e-17 2.82798811e-16
   2.90760259e-16]
  [1.00000000e+00 5.69312286e-09 2.34695781e-13 6.19186912e-14
   1.40521451e-13]
  [6.35825836e-06 9.99993682e-01 1.29177008e-11 3.19694826e-11
   2.72705174e-11]
  ...
  [5.26282093e-08 1.00000000e+00 6.65710217e-13 2.97363241e-12
   4.25633183e-12]
  [8.70366834e-10 1.00000000e+00 1.19483728e-13 5.78037184e-13
   3.88876052e-13]
  [8.42491008e-12 1.00000000e+00 6.48116492e-15 4.17261779e-14
   6.46600557e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.1918479e-17 1.0000000e+00 1.6684025e-17 2.7790934e-16 2.8600687e-16]
 [4.8345550e-10 1.0000000e+00 3.9549127e-14 2.2710126e-13 4.6948936e-13]
 [2.7010179e-09 1.0000000e+00 1.7699892e-13 7.9655331e-13 7.9851257e-13]
 ...
 [5.2628209e-08 1.0000000e+00 6.6571022e-13 2.9736324e-12 4.2563318e-12]
 [8.7036683e-10 1.0000000e+00 1.1948373e-13 5.7803718e-13 3.8887605e-13]
 [8.4249101e-12 1.0000000e+00 6.4811649e-15 4.1726178e-14 6.4660056e-14]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  9.367472187805175
tp :  39520.0
fp :  60480.0
tn :  339520.0
fn :  60480.0
accuracy :  0.7580825090408325
precision :  0.3952000141143799
recall :  0.3952000141143799
auc :  0.6260124444961548

y_eval {0: 53028, 1: 46972}
pred {0: 18250, 1: 81750}
[INFO] confusion matrix for file 
[[ 5399 47629     0     0     0]
 [12851 34121     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 393127 2211292       0       0       0]
 [  37334  228393       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0383536   0.          0.         ...  2.          0.00482
  -0.33484   ]
 [-1.0383536   0.          0.         ...  4.          0.00482
  -0.23351   ]
 [-1.0383536   0.          0.         ...  3.          0.00482
   1.45442   ]
 ...
 [-0.34673914  0.          0.         ...  1.          0.00482
  -0.32151   ]
 [-0.34673914  0.          0.         ...  1.          0.00482
  -0.32151   ]
 [-0.34673914  0.          0.         ...  4.          0.00482
  -0.23351   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 1 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.8533846e-17 1.0000000e+00 1.7628228e-17 2.9164673e-16 2.9935097e-16]
  [1.0000000e+00 6.6692996e-14 1.4309101e-15 1.5966054e-16 2.0336470e-16]
  [1.9571985e-12 1.0000000e+00 4.1958078e-15 3.5459926e-14 2.8718899e-14]
  ...
  [2.2847382e-06 9.9999774e-01 5.9447477e-12 1.5680679e-11 1.4190542e-11]
  [1.2248355e-11 1.0000000e+00 9.1471274e-15 4.6472798e-14 5.7608872e-14]
  [1.0000000e+00 2.9707413e-12 1.1266148e-14 1.8952648e-15 2.0205257e-15]]

 [[6.4242731e-17 1.0000000e+00 1.7020811e-17 2.8282147e-16 2.9078244e-16]
  [3.5911468e-10 1.0000000e+00 3.4055393e-14 1.9910091e-13 4.0943968e-13]
  [2.6825236e-02 9.7317481e-01 7.5662032e-10 9.7194408e-10 8.9404362e-10]
  ...
  [1.0000000e+00 3.5278579e-11 3.2860565e-14 5.8699828e-15 7.6076315e-15]
  [1.1438775e-12 1.0000000e+00 3.7493655e-15 3.4753450e-14 2.5878395e-14]
  [6.2695227e-09 1.0000000e+00 1.9097161e-13 7.5277322e-13 1.1313059e-12]]

 [[6.1950375e-17 1.0000000e+00 1.6688670e-17 2.7797824e-16 2.8607341e-16]
  [3.6159040e-10 1.0000000e+00 3.4158308e-14 1.9972926e-13 4.1104687e-13]
  [1.9086057e-09 1.0000000e+00 1.4728122e-13 6.8186895e-13 6.8509152e-13]
  ...
  [5.2650197e-08 1.0000000e+00 5.2794368e-13 1.8641768e-12 3.3132861e-12]
  [7.5960553e-09 1.0000000e+00 3.7829730e-13 1.6882793e-12 1.2810918e-12]
  [1.4177014e-12 1.0000000e+00 3.2991489e-15 2.3277109e-14 2.3006845e-14]]

 ...

 [[6.6949583e-17 1.0000000e+00 1.7406113e-17 2.8842494e-16 2.9622367e-16]
  [9.9999881e-01 1.1897644e-06 2.9451858e-12 1.2196582e-12 2.9736461e-12]
  [1.9691770e-12 1.0000000e+00 5.0339990e-15 4.3810136e-14 3.5586900e-14]
  ...
  [5.2824419e-07 9.9999952e-01 2.5886257e-12 1.0173508e-11 9.9803898e-12]
  [2.2863265e-11 1.0000000e+00 1.3104905e-14 7.1914398e-14 8.6341727e-14]
  [1.0000000e+00 2.7407517e-11 3.2527759e-14 5.7787785e-15 6.5372821e-15]]

 [[6.6961587e-17 1.0000000e+00 1.7407773e-17 2.8844913e-16 2.9624739e-16]
  [1.0000000e+00 1.9196405e-11 2.2064654e-14 4.1537013e-15 4.9009072e-15]
  [7.5719909e-15 1.0000000e+00 2.1327972e-16 2.5884649e-15 2.5780096e-15]
  ...
  [1.4939280e-08 1.0000000e+00 4.2675477e-13 1.5688184e-12 1.5084532e-12]
  [1.0000000e+00 1.7654823e-08 6.9162991e-13 1.6078938e-13 2.2649391e-13]
  [1.6735818e-13 1.0000000e+00 1.7787258e-15 2.2030046e-14 1.1201910e-14]]

 [[6.1830202e-17 1.0000000e+00 1.6671044e-17 2.7771963e-16 2.8582362e-16]
  [1.8277560e-10 1.0000000e+00 2.4257052e-14 1.4819054e-13 3.0049953e-13]
  [3.4114382e-09 1.0000000e+00 1.9646254e-13 8.6889594e-13 8.8586441e-13]
  ...
  [4.6869694e-08 1.0000000e+00 4.9425546e-13 1.7873599e-12 3.1134643e-12]
  [3.0816247e-09 1.0000000e+00 2.2370322e-13 1.0581640e-12 8.8527655e-13]
  [5.1682486e-12 1.0000000e+00 6.6534650e-15 4.2392000e-14 3.9956214e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.8533846e-17 1.0000000e+00 1.7628228e-17 2.9164673e-16 2.9935097e-16]
 [1.0000000e+00 6.6692996e-14 1.4309101e-15 1.5966054e-16 2.0336470e-16]
 [1.9571985e-12 1.0000000e+00 4.1958078e-15 3.5459926e-14 2.8718899e-14]
 ...
 [4.6869694e-08 1.0000000e+00 4.9425546e-13 1.7873599e-12 3.1134643e-12]
 [3.0816247e-09 1.0000000e+00 2.2370322e-13 1.0581640e-12 8.8527655e-13]
 [5.1682486e-12 1.0000000e+00 6.6534650e-15 4.2392000e-14 3.9956214e-14]] (100000, 5)
pred 3 (argmax) [1 0 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  11.979757502746581
tp :  23449.0
fp :  76551.0
tn :  323449.0
fn :  76551.0
accuracy :  0.6937989592552185
precision :  0.23449000716209412
recall :  0.23449000716209412
auc :  0.5236278772354126

y_eval {0: 84669, 1: 15331}
pred {0: 16234, 1: 83766}
[INFO] confusion matrix for file 
[[12176 72493     0     0     0]
 [ 4058 11273     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 405303 2283785       0       0       0]
 [  41392  239666       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4673914e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4673914e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4673914e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 3.4741792e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 3.4741792e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4741792e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.88123147e-17 1.00000000e+00 1.76697690e-17 2.92288253e-16
   2.99896144e-16]
  [2.89463564e-10 1.00000000e+00 3.05814300e-14 1.81079896e-13
   3.70401301e-13]
  [1.00000000e+00 1.10819048e-10 6.51740286e-14 1.16653073e-14
   1.27649525e-14]
  ...
  [1.28287452e-08 1.00000000e+00 2.92358938e-13 1.46480072e-12
   2.15838675e-12]
  [2.90805668e-09 1.00000000e+00 1.99263512e-13 8.64112926e-13
   7.45174809e-13]
  [1.54367231e-11 1.00000000e+00 1.07670195e-14 6.35937632e-14
   7.26177676e-14]]

 [[6.44388388e-17 1.00000000e+00 1.70495341e-17 2.83246865e-16
   2.91177608e-16]
  [3.03123859e-10 1.00000000e+00 3.12759699e-14 1.84830734e-13
   3.78802729e-13]
  [1.00000000e+00 1.12415723e-10 6.57533855e-14 1.17716988e-14
   1.28513109e-14]
  ...
  [1.00000000e+00 7.63110269e-11 4.57832082e-14 9.47186038e-15
   1.31790508e-14]
  [2.22982570e-12 1.00000000e+00 5.42408559e-15 4.84144788e-14
   3.51773325e-14]
  [2.15205964e-09 1.00000000e+00 1.12540843e-13 4.77917131e-13
   6.89598769e-13]]

 [[1.00000000e+00 1.87759319e-09 2.82835929e-13 7.78131899e-14
   7.03587240e-14]
  [2.36236292e-06 9.99997616e-01 8.90521511e-12 2.73327472e-11
   1.20366035e-11]
  [8.72801278e-16 1.00000000e+00 5.81324204e-17 7.48922550e-16
   1.01341002e-15]
  ...
  [2.69397628e-06 9.99997258e-01 4.13998133e-12 1.14766660e-11
   1.84913283e-11]
  [2.86432461e-10 1.00000000e+00 6.06066372e-14 3.26834968e-13
   3.11497166e-13]
  [3.85575044e-11 1.00000000e+00 1.97022337e-14 1.11048669e-13
   9.63336534e-14]]

 ...

 [[5.99526189e-08 9.99999881e-01 8.25231376e-13 2.44427547e-12
   2.34565644e-12]
  [5.69213933e-15 1.00000000e+00 1.68658937e-16 2.08052489e-15
   2.43453363e-15]
  [4.88695528e-10 1.00000000e+00 5.31390389e-14 2.84645679e-13
   3.72242005e-13]
  ...
  [1.00000000e+00 3.43391114e-11 3.33788071e-14 4.95032397e-15
   6.69486286e-15]
  [4.99642049e-13 1.00000000e+00 2.82910084e-15 3.02666827e-14
   1.75833909e-14]
  [5.23690380e-09 1.00000000e+00 1.50648564e-13 5.75677093e-13
   1.08166167e-12]]

 [[1.00000000e+00 2.47462762e-11 3.74009634e-14 7.85982031e-15
   6.67222252e-15]
  [3.50236148e-02 9.64976370e-01 1.14244958e-09 1.64581770e-09
   7.89952159e-10]
  [1.00000000e+00 2.80751227e-08 6.67266210e-13 1.69126296e-13
   2.88812919e-13]
  ...
  [1.13351133e-08 1.00000000e+00 2.53687262e-13 1.05925034e-12
   1.73763022e-12]
  [3.75846826e-10 1.00000000e+00 7.69651947e-14 4.26300813e-13
   3.29653568e-13]
  [3.75065864e-12 1.00000000e+00 5.29637547e-15 3.62484599e-14
   3.80232887e-14]]

 [[1.00000000e+00 4.13275032e-08 1.19048391e-12 3.84883233e-13
   3.70527068e-13]
  [1.29955224e-05 9.99987006e-01 2.40298875e-11 6.72817496e-11
   2.61130666e-11]
  [8.55318782e-17 1.00000000e+00 1.90411832e-17 3.01789739e-16
   3.44763850e-16]
  ...
  [2.86031332e-09 1.00000000e+00 2.01691989e-13 8.99541888e-13
   7.42142242e-13]
  [3.31749125e-12 1.00000000e+00 4.73846705e-15 3.16414443e-14
   3.72717807e-14]
  [1.00000000e+00 5.50865404e-14 1.58395775e-15 1.82409022e-16
   2.05506962e-16]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.88123147e-17 1.00000000e+00 1.76697690e-17 2.92288253e-16
  2.99896144e-16]
 [2.89463564e-10 1.00000000e+00 3.05814300e-14 1.81079896e-13
  3.70401301e-13]
 [1.00000000e+00 1.10819048e-10 6.51740286e-14 1.16653073e-14
  1.27649525e-14]
 ...
 [2.86031332e-09 1.00000000e+00 2.01691989e-13 8.99541888e-13
  7.42142242e-13]
 [3.31749125e-12 1.00000000e+00 4.73846705e-15 3.16414443e-14
  3.72717807e-14]
 [1.00000000e+00 5.50865404e-14 1.58395775e-15 1.82409022e-16
  2.05506962e-16]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  13.489333520507813
tp :  14908.0
fp :  85092.0
tn :  314908.0
fn :  85092.0
accuracy :  0.6596353054046631
precision :  0.14907999336719513
recall :  0.14907999336719513
auc :  0.4682423174381256

y_eval {0: 100000}
pred {0: 14908, 1: 85092}
[INFO] confusion matrix for file 
[[14908 85092     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 420211 2368877       0       0       0]
 [  41392  239666       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 0.34741792  0.          0.         ...  4.          0.00482
  -0.23351   ]
 [ 0.34741792  0.          0.         ...  4.          0.00482
  -0.23351   ]
 [ 0.34741792  0.          0.         ...  2.          0.00482
  -0.33484   ]
 ...
 [ 1.0390323   0.          0.         ...  1.          0.00482
  -0.32151   ]
 [ 1.0390323   0.          0.         ...  2.          0.00482
  -0.33484   ]
 [ 1.0390323   0.          0.         ...  1.          0.00482
  -0.32151   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.00000000e+00 2.60389522e-11 3.83096705e-14 8.07662432e-15
   6.86061112e-15]
  [9.49910462e-01 5.00895455e-02 1.04208453e-09 9.66076663e-10
   8.31492764e-10]
  [9.99999762e-01 2.18785743e-07 2.09271012e-12 6.80243730e-13
   8.61640728e-13]
  ...
  [7.64111951e-12 1.00000000e+00 7.74032683e-15 5.31976535e-14
   5.57196196e-14]
  [1.00000000e+00 2.94348611e-13 3.44271184e-15 4.47869571e-16
   5.42172449e-16]
  [6.54106760e-13 1.00000000e+00 2.75232874e-15 2.73097906e-14
   1.98074708e-14]]

 [[6.28175449e-17 1.00000000e+00 1.68152633e-17 2.79828425e-16
   2.87865444e-16]
  [1.00000000e+00 2.85761248e-10 1.03090056e-13 2.92854967e-14
   2.40005735e-14]
  [8.51913128e-16 1.00000000e+00 6.60354430e-17 9.26929118e-16
   9.72073221e-16]
  ...
  [2.37440827e-06 9.99997616e-01 5.01641610e-12 1.70780248e-11
   2.04055176e-11]
  [4.32331219e-11 1.00000000e+00 2.09706774e-14 1.17071730e-13
   1.14025651e-13]
  [4.19119323e-11 1.00000000e+00 1.88868713e-14 1.23766828e-13
   1.27117257e-13]]

 [[6.54958168e-17 1.00000000e+00 1.72001091e-17 2.85431363e-16
   2.93316975e-16]
  [1.00000000e+00 9.32510319e-11 3.41669747e-14 6.38131668e-15
   1.34045014e-14]
  [1.58051889e-13 1.00000000e+00 1.32049112e-15 1.43051786e-14
   1.07764292e-14]
  ...
  [1.97835541e-12 1.00000000e+00 5.08774575e-15 4.73845138e-14
   3.24057018e-14]
  [6.57712373e-09 1.00000000e+00 1.77357816e-13 6.75679239e-13
   1.22495644e-12]
  [5.12389153e-09 1.00000000e+00 3.04644873e-13 1.43687449e-12
   1.10401640e-12]]

 ...

 [[6.18266620e-17 1.00000000e+00 1.66705365e-17 2.77711160e-16
   2.85815995e-16]
  [1.55420829e-10 1.00000000e+00 2.23506923e-14 1.37917374e-13
   2.78992134e-13]
  [1.41710599e-09 1.00000000e+00 1.24303156e-13 5.89418813e-13
   6.01200025e-13]
  ...
  [2.17855288e-13 1.00000000e+00 1.81189919e-15 2.08502293e-14
   1.22690063e-14]
  [1.45509924e-08 1.00000000e+00 2.46338404e-13 8.73000728e-13
   1.72399280e-12]
  [1.18280683e-08 1.00000000e+00 4.78041164e-13 2.17776470e-12
   1.70364124e-12]]

 [[6.18561493e-17 1.00000000e+00 1.66748610e-17 2.77775773e-16
   2.85878146e-16]
  [1.71533870e-10 1.00000000e+00 2.35042393e-14 1.44207942e-13
   2.91819655e-13]
  [3.68297792e-09 1.00000000e+00 2.04026656e-13 8.96698243e-13
   9.16488023e-13]
  ...
  [5.24305293e-08 1.00000000e+00 5.19959943e-13 1.86948569e-12
   3.34576897e-12]
  [3.35591688e-09 1.00000000e+00 2.43418783e-13 1.15649179e-12
   9.02413452e-13]
  [2.72155432e-12 1.00000000e+00 4.62107888e-15 3.07488850e-14
   3.04197619e-14]]

 [[6.96279678e-17 1.00000000e+00 1.77833045e-17 2.93937506e-16
   3.01487110e-16]
  [1.00000000e+00 2.28009035e-11 2.98740389e-14 6.64372579e-15
   5.69546224e-15]
  [9.99234915e-01 7.65147968e-04 1.21028410e-10 7.70792735e-11
   8.20105511e-11]
  ...
  [1.94794007e-12 1.00000000e+00 3.79469066e-15 2.63738548e-14
   2.71850091e-14]
  [1.69137926e-09 1.00000000e+00 1.08337696e-13 6.02721323e-13
   8.20998868e-13]
  [9.01750674e-10 1.00000000e+00 1.04557618e-13 4.94647780e-13
   4.48487466e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.00000000e+00 2.60389522e-11 3.83096705e-14 8.07662432e-15
  6.86061112e-15]
 [9.49910462e-01 5.00895455e-02 1.04208453e-09 9.66076663e-10
  8.31492764e-10]
 [9.99999762e-01 2.18785743e-07 2.09271012e-12 6.80243730e-13
  8.61640728e-13]
 ...
 [1.94794007e-12 1.00000000e+00 3.79469066e-15 2.63738548e-14
  2.71850091e-14]
 [1.69137926e-09 1.00000000e+00 1.08337696e-13 6.02721323e-13
  8.20998868e-13]
 [9.01750674e-10 1.00000000e+00 1.04557618e-13 4.94647780e-13
  4.48487466e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.620650778198241
tp :  14550.0
fp :  85450.0
tn :  314550.0
fn :  85450.0
accuracy :  0.6582033038139343
precision :  0.14550000429153442
recall :  0.14550000429153442
auc :  0.4662189781665802

y_eval {0: 100000}
pred {0: 14550, 1: 85450}
[INFO] confusion matrix for file 
[[14550 85450     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 434761 2454327       0       0       0]
 [  41392  239666       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0390323e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0390323e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.0390323e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 1.7331893e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.7331893e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.7331893e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[5.81405826e-11 1.00000000e+00 2.31052190e-14 1.25665049e-13
   1.17631978e-13]
  [8.09133779e-14 1.00000000e+00 6.06757440e-16 6.13607989e-15
   8.17588219e-15]
  [3.67366582e-10 1.00000000e+00 5.13702037e-14 2.79777070e-13
   3.18936419e-13]
  ...
  [6.55906145e-12 1.00000000e+00 6.92223107e-15 4.47580544e-14
   5.14531621e-14]
  [2.08707340e-09 1.00000000e+00 1.41787637e-13 7.14878786e-13
   7.54722673e-13]
  [7.69478439e-11 1.00000000e+00 2.54163722e-14 1.40651501e-13
   1.58465133e-13]]

 [[6.17543724e-11 1.00000000e+00 2.38370199e-14 1.28961539e-13
   1.20734789e-13]
  [7.88171205e-14 1.00000000e+00 5.99174007e-16 6.07137462e-15
   8.07853438e-15]
  [6.20620568e-08 9.99999881e-01 6.53732548e-13 2.34048566e-12
   3.25047151e-12]
  ...
  [3.20763728e-12 1.00000000e+00 4.58956205e-15 3.13097530e-14
   3.74165895e-14]
  [1.00000000e+00 4.35733209e-13 4.09531409e-15 5.37895779e-16
   6.53027515e-16]
  [1.79744511e-12 1.00000000e+00 4.55044226e-15 4.08547030e-14
   3.10783673e-14]]

 [[9.99999762e-01 2.48720028e-07 2.77478171e-12 1.01075517e-12
   9.91519258e-13]
  [5.47794666e-13 1.00000000e+00 3.07650604e-15 3.34599529e-14
   1.65644459e-14]
  [2.09055597e-05 9.99979138e-01 9.24614465e-12 2.21626276e-11
   5.65668450e-11]
  ...
  [8.61016174e-14 1.00000000e+00 8.95809657e-16 8.44642536e-15
   6.56069073e-15]
  [5.27017448e-07 9.99999523e-01 1.60758104e-12 6.05997327e-12
   1.22234245e-11]
  [8.32940650e-09 1.00000000e+00 4.35425838e-13 2.00573802e-12
   1.28729861e-12]]

 ...

 [[6.22920867e-17 1.00000000e+00 1.67386565e-17 2.78708780e-16
   2.86781427e-16]
  [7.18507476e-11 1.00000000e+00 1.52636675e-14 9.93339932e-14
   1.95159847e-13]
  [1.10500609e-09 1.00000000e+00 1.06176820e-13 5.10411917e-13
   5.40397479e-13]
  ...
  [1.15064737e-13 1.00000000e+00 1.34822647e-15 1.65147911e-14
   9.33401678e-15]
  [2.37543070e-08 1.00000000e+00 3.12016851e-13 1.05217462e-12
   2.09328952e-12]
  [1.12829568e-08 1.00000000e+00 4.60748573e-13 2.12246952e-12
   1.72084233e-12]]

 [[6.81862383e-17 1.00000000e+00 1.75823592e-17 2.91021039e-16
   2.98667735e-16]
  [9.99987125e-01 1.28333722e-05 9.16317629e-12 4.63616688e-12
   1.15578059e-11]
  [1.49012365e-11 1.00000000e+00 1.37227206e-14 9.73441637e-14
   9.03522117e-14]
  ...
  [3.23602876e-07 9.99999642e-01 2.05968402e-12 9.08943233e-12
   8.52176142e-12]
  [4.34092033e-11 1.00000000e+00 1.74834986e-14 8.91477782e-14
   1.14041751e-13]
  [1.83285043e-09 1.00000000e+00 1.53234738e-13 8.11341066e-13
   7.03623845e-13]]

 [[6.28566143e-17 1.00000000e+00 1.68205887e-17 2.79903149e-16
   2.87945621e-16]
  [1.73339162e-10 1.00000000e+00 2.36144214e-14 1.44671316e-13
   2.93229579e-13]
  [1.30360132e-12 1.00000000e+00 3.52949269e-15 3.00912927e-14
   2.62910844e-14]
  ...
  [1.84316937e-11 1.00000000e+00 1.45669711e-14 8.68849060e-14
   6.81431772e-14]
  [1.00000000e+00 2.14477467e-08 6.09680600e-13 1.83430501e-13
   3.21739651e-13]
  [4.41600229e-12 1.00000000e+00 9.37544770e-15 8.75276143e-14
   5.03436675e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[5.8140583e-11 1.0000000e+00 2.3105219e-14 1.2566505e-13 1.1763198e-13]
 [8.0913378e-14 1.0000000e+00 6.0675744e-16 6.1360799e-15 8.1758822e-15]
 [3.6736658e-10 1.0000000e+00 5.1370204e-14 2.7977707e-13 3.1893642e-13]
 ...
 [1.8431694e-11 1.0000000e+00 1.4566971e-14 8.6884906e-14 6.8143177e-14]
 [1.0000000e+00 2.1447747e-08 6.0968060e-13 1.8343050e-13 3.2173965e-13]
 [4.4160023e-12 1.0000000e+00 9.3754477e-15 8.7527614e-14 5.0343667e-14]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 0 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.697244078063965
tp :  14282.0
fp :  85718.0
tn :  314282.0
fn :  85718.0
accuracy :  0.6571313142776489
precision :  0.14282000064849854
recall :  0.14282000064849854
auc :  0.4638262689113617

y_eval {0: 100000}
pred {0: 14282, 1: 85718}
[INFO] confusion matrix for file 
[[14282 85718     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 449043 2540045       0       0       0]
 [  41392  239666       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-01_203011_118.log.part06_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:99.9988%,2:0.0008%,1:0.0004%]
[INFO] ** type:[0:99.9986%,1:0.001%,2:0.0004%]
[INFO] ** i/f_name:[2:99.998%,3:0.002%]
[INFO] ** i/f_dir:[1:99.9982%,0:0.0018%]
[INFO] ** src:[22:38.138%,9:26.0904%,7:18.1762%,1:17.5892%,10:0.0018%,11:0.0016%,14:0.0012%,21:0.0008%,15:0.0006%,4:0.0002%]
[INFO] ** dst:[21:43.3838%,10:20.845%,8:18.1758%,9:17.589%,15:0.002%,22:0.0014%,6:0.0014%,25:0.0004%,24:0.0004%,18:0.0004%,7:0.0004%]
[INFO] ** proto:[0:99.9954%,2:0.0026%,1:0.002%]
[INFO] ** appi_name:[21:99.9944%,30:0.002%,26:0.0008%,22:0.0006%,31:0.0004%,27:0.0004%,15:0.0004%,0:0.0004%,24:0.0002%,16:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.138%,20:26.0904%,13:18.1762%,6:17.5892%,17:0.002%,11:0.0018%,10:0.0016%,16:0.0006%,21:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9944%,-33.760870000000004:0.0052%,0.9188299999999999:0.0004%]
[INFO] ** modbus_function_description:[7:49.998%,11:49.9964%,0:0.0052%,15:0.0004%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.0894%,1:20.8438%,5:18.1758%,4:17.5888%,2:17.294%,0:0.0082%]
[INFO] ** service:[0.0048200000000000005:99.9954%,-211.73542999999998:0.002%,-211.08346:0.0008%,-211.08818:0.0006%,-186.44547:0.0004%,-186.43601999999998:0.0004%,-202.75898:0.0004%]
[INFO] ** s_port:[1.45442:26.0898%,-0.32151:20.844%,-1.27613:18.1758%,-0.23351:17.589%,-0.33484:17.294%,-71.33197:0.002%,-6.46392:0.0008%,-71.14798:0.0008%,1.45709:0.0006%,-71.14931:0.0006%,-1.02014:0.0006%,-1.27347:0.0004%,-68.79874000000001:0.0004%,-64.19493:0.0004%,-1.81611:0.0004%,-6.49859:0.0002%,-0.24151:0.0002%]
[INFO] ** classification:[normal:90.7904%,Single Stage Multi Point:5.7378%,Single Stage Single Point:3.4718%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7324393e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.7324393e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.7324393e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [-1.0386956e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0386956e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.0386956e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[7.8129101e-17 1.0000000e+00 1.8930372e-17 3.1049422e-16 3.1749018e-16]
  [1.0000000e+00 1.8281671e-14 6.8934257e-16 6.5658414e-17 1.0422972e-16]
  [1.2212612e-12 1.0000000e+00 3.3696775e-15 2.9667407e-14 2.5047826e-14]
  ...
  [1.0000000e+00 1.1301396e-15 2.6291159e-16 2.1861575e-17 2.1814424e-17]
  [2.0504430e-11 1.0000000e+00 1.4679848e-14 1.0431719e-13 8.3509561e-14]
  [4.1092250e-08 1.0000000e+00 4.6402671e-13 1.6935105e-12 3.2942620e-12]]

 [[1.2477376e-16 1.0000000e+00 2.4375699e-17 3.8709202e-16 3.9160115e-16]
  [1.0000000e+00 8.3408310e-14 1.5802702e-15 1.7893346e-16 2.3144582e-16]
  [2.3628907e-12 1.0000000e+00 4.5373730e-15 3.7312398e-14 3.1920281e-14]
  ...
  [4.3342437e-11 1.0000000e+00 2.1855188e-14 1.4520375e-13 1.1552521e-13]
  [5.7509801e-08 1.0000000e+00 5.5188476e-13 1.9429679e-12 3.7360505e-12]
  [7.4989721e-09 1.0000000e+00 4.2362923e-13 1.9078675e-12 1.1394310e-12]]

 [[7.8255270e-17 1.0000000e+00 1.8946916e-17 3.1073240e-16 3.1771917e-16]
  [1.0000000e+00 2.6718586e-12 8.3030820e-15 1.2905417e-15 1.6352233e-15]
  [3.9088216e-14 1.0000000e+00 5.1118274e-16 5.5588811e-15 5.3621404e-15]
  ...
  [4.0471684e-12 1.0000000e+00 4.9776293e-15 3.1022284e-14 3.8221139e-14]
  [4.2437640e-07 9.9999952e-01 2.0391735e-12 7.9467015e-12 9.6945845e-12]
  [1.9286586e-10 1.0000000e+00 4.5453963e-14 2.2797706e-13 2.1970387e-13]]

 ...

 [[6.4185411e-17 1.0000000e+00 1.7012567e-17 2.8270175e-16 2.9066489e-16]
  [1.0000000e+00 1.6066951e-13 1.8359517e-15 2.0665787e-16 3.5852639e-16]
  [6.9446006e-13 1.0000000e+00 2.5619708e-15 2.3644437e-14 2.0127300e-14]
  ...
  [4.3483248e-09 1.0000000e+00 2.5688728e-13 1.1218513e-12 9.0271643e-13]
  [5.8012501e-12 1.0000000e+00 6.2942819e-15 3.9200658e-14 4.6311577e-14]
  [5.6842366e-09 1.0000000e+00 2.3631737e-13 1.2330671e-12 1.3243421e-12]]

 [[6.5628113e-17 1.0000000e+00 1.7219214e-17 2.8571353e-16 2.9358114e-16]
  [1.0000000e+00 1.5024283e-13 1.7797642e-15 1.9914086e-16 3.4492039e-16]
  [2.2713645e-12 1.0000000e+00 4.7700415e-15 4.0162284e-14 3.4304889e-14]
  ...
  [3.3143592e-09 1.0000000e+00 2.1230393e-13 9.4352846e-13 7.9905798e-13]
  [1.0000000e+00 2.2791141e-13 2.9693883e-15 3.1753502e-16 4.0721784e-16]
  [4.7712502e-12 1.0000000e+00 8.4236114e-15 7.2935920e-14 4.6910961e-14]]

 [[1.0000000e+00 2.0490326e-10 1.0071120e-13 2.4336017e-14 2.1099023e-14]
  [9.9844307e-01 1.5569616e-03 2.3218673e-10 1.5702512e-10 1.0270595e-10]
  [1.1197942e-13 1.0000000e+00 8.3766312e-16 7.5359420e-15 8.5653429e-15]
  ...
  [1.8735302e-12 1.0000000e+00 3.2757608e-15 2.1291616e-14 2.6945482e-14]
  [2.7697470e-07 9.9999976e-01 1.6080506e-12 6.5964343e-12 8.0942770e-12]
  [6.4916728e-10 1.0000000e+00 8.1842803e-14 3.6237693e-13 3.7480536e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[7.8129101e-17 1.0000000e+00 1.8930372e-17 3.1049422e-16 3.1749018e-16]
 [1.0000000e+00 1.8281671e-14 6.8934257e-16 6.5658414e-17 1.0422972e-16]
 [1.2212612e-12 1.0000000e+00 3.3696775e-15 2.9667407e-14 2.5047826e-14]
 ...
 [1.8735302e-12 1.0000000e+00 3.2757608e-15 2.1291616e-14 2.6945482e-14]
 [2.7697470e-07 9.9999976e-01 1.6080506e-12 6.5964343e-12 8.0942770e-12]
 [6.4916728e-10 1.0000000e+00 8.1842803e-14 3.6237693e-13 3.7480536e-13]] (100000, 5)
pred 3 (argmax) [1 0 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  12.787730728149414
tp :  18425.0
fp :  81575.0
tn :  318425.0
fn :  81575.0
accuracy :  0.673703134059906
precision :  0.18424999713897705
recall :  0.18424999713897705
auc :  0.4904399812221527

y_eval {0: 100000}
pred {0: 18425, 1: 81575}
[INFO] confusion matrix for file 
[[18425 81575     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 467468 2621620       0       0       0]
 [  41392  239666       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0386956e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0386956e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.0386956e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [-3.4749308e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4749308e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-3.4749308e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.77770332e-01 8.22229624e-01 1.55346880e-09 1.33011890e-09
   1.36060518e-09]
  [6.01929988e-16 1.00000000e+00 5.73509266e-17 8.30298223e-16
   8.65741576e-16]
  [5.34685796e-06 9.99994636e-01 5.28943989e-12 1.47380910e-11
   2.53227890e-11]
  ...
  [1.47539413e-12 1.00000000e+00 2.93596972e-15 1.92385645e-14
   2.51262989e-14]
  [1.00000000e+00 3.01197589e-15 4.15666305e-16 3.78565031e-17
   3.86063952e-17]
  [1.11860850e-11 1.00000000e+00 1.07659107e-14 8.00804599e-14
   6.46313312e-14]]

 [[6.82773340e-17 1.00000000e+00 1.75924227e-17 2.91128744e-16
   2.98847782e-16]
  [7.35417727e-10 1.00000000e+00 4.88884717e-14 2.72862191e-13
   5.67794021e-13]
  [1.29090516e-09 1.00000000e+00 1.21409556e-13 5.79108701e-13
   5.76495720e-13]
  ...
  [1.00000000e+00 8.82120355e-15 6.67598758e-16 6.33609629e-17
   6.89999921e-17]
  [2.48535099e-11 1.00000000e+00 1.69081058e-14 1.19363002e-13
   9.43450640e-14]
  [6.89579105e-09 1.00000000e+00 1.99361591e-13 8.12266975e-13
   1.35593945e-12]]

 [[2.33403265e-01 7.66596794e-01 1.72549641e-09 1.43943657e-09
   1.47432522e-09]
  [6.48850902e-16 1.00000000e+00 5.96835495e-17 8.59033763e-16
   8.96267690e-16]
  [2.23813277e-05 9.99977589e-01 1.09762191e-11 2.74989042e-11
   4.77158243e-11]
  ...
  [5.02122432e-12 1.00000000e+00 5.92939665e-15 3.68046861e-14
   4.71226892e-14]
  [2.18927498e-09 1.00000000e+00 1.73455651e-13 9.43260335e-13
   7.21588642e-13]
  [1.00000000e+00 4.29739184e-14 1.16419183e-15 1.10716881e-16
   1.64300701e-16]]

 ...

 [[1.00000000e+00 5.18389422e-13 6.01081303e-15 9.77546960e-16
   7.88994673e-16]
  [9.96936202e-01 3.06379260e-03 2.97327968e-10 2.37196596e-10
   1.77888704e-10]
  [9.95701969e-01 4.29798570e-03 2.74341383e-10 1.56458790e-10
   1.57031915e-10]
  ...
  [3.13411536e-12 1.00000000e+00 6.23996509e-15 5.04827096e-14
   3.47085337e-14]
  [5.01373165e-08 1.00000000e+00 4.52080864e-13 1.61530576e-12
   3.45567715e-12]
  [5.70580134e-08 1.00000000e+00 1.09975831e-12 4.15118113e-12
   2.98339825e-12]]

 [[7.34461872e-17 1.00000000e+00 1.83061389e-17 3.01503230e-16
   3.08801531e-16]
  [1.61437724e-10 1.00000000e+00 2.28261488e-14 1.40164627e-13
   2.82988097e-13]
  [4.38567127e-10 1.00000000e+00 7.09558755e-14 3.79045563e-13
   3.50801961e-13]
  ...
  [1.54375766e-11 1.00000000e+00 1.15711722e-14 6.55965557e-14
   6.27553632e-14]
  [2.54080024e-09 1.00000000e+00 1.28810360e-13 7.10312018e-13
   1.04202898e-12]
  [5.55309088e-09 1.00000000e+00 2.83330515e-13 1.18586076e-12
   9.71259314e-13]]

 [[6.66206765e-17 1.00000000e+00 1.73596954e-17 2.87751254e-16
   2.95568997e-16]
  [1.00000000e+00 3.26898751e-12 7.24135836e-15 1.02883893e-15
   1.98360801e-15]
  [6.90705793e-13 1.00000000e+00 2.62216604e-15 2.42736197e-14
   2.08730687e-14]
  ...
  [1.34575195e-08 1.00000000e+00 4.74952000e-13 2.00534034e-12
   1.50182156e-12]
  [2.50947158e-12 1.00000000e+00 3.89674543e-15 2.52833575e-14
   3.22753638e-14]
  [1.00000000e+00 8.30593308e-15 6.58139200e-16 6.50116581e-17
   6.93967410e-17]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.77770332e-01 8.22229624e-01 1.55346880e-09 1.33011890e-09
  1.36060518e-09]
 [6.01929988e-16 1.00000000e+00 5.73509266e-17 8.30298223e-16
  8.65741576e-16]
 [5.34685796e-06 9.99994636e-01 5.28943989e-12 1.47380910e-11
  2.53227890e-11]
 ...
 [1.34575195e-08 1.00000000e+00 4.74952000e-13 2.00534034e-12
  1.50182156e-12]
 [2.50947158e-12 1.00000000e+00 3.89674543e-15 2.52833575e-14
  3.22753638e-14]
 [1.00000000e+00 8.30593308e-15 6.58139200e-16 6.50116581e-17
  6.93967410e-17]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  13.148538096618653
tp :  16168.0
fp :  83832.0
tn :  316168.0
fn :  83832.0
accuracy :  0.6646752953529358
precision :  0.16167999804019928
recall :  0.16167999804019928
auc :  0.4773789048194885

y_eval {0: 100000}
pred {0: 16168, 1: 83832}
[INFO] confusion matrix for file 
[[16168 83832     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 483636 2705452       0       0       0]
 [  41392  239666       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4749308e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4749308e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-3.4749308e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 3.4625062e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4625062e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4625062e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.66321181e-17 1.00000000e+00 1.73612836e-17 2.87774309e-16
   2.95591549e-16]
  [1.00000000e+00 3.01724162e-12 8.96384390e-15 1.41809134e-15
   1.72823393e-15]
  [2.40051509e-14 1.00000000e+00 3.98679429e-16 4.51261970e-15
   4.24704819e-15]
  ...
  [4.88503815e-09 1.00000000e+00 2.64080966e-13 1.23181652e-12
   9.49966017e-13]
  [3.40794060e-12 1.00000000e+00 4.25215452e-15 2.85704010e-14
   4.14333756e-14]
  [4.41468053e-08 1.00000000e+00 7.67032000e-13 3.10416688e-12
   2.77142372e-12]]

 [[6.64777908e-05 9.99933481e-01 3.01085684e-11 4.91134286e-11
   4.86189804e-11]
  [1.83357900e-15 1.00000000e+00 9.92702034e-17 1.33436044e-15
   1.45092869e-15]
  [3.05335432e-01 6.94664538e-01 1.29797906e-09 1.58886482e-09
   2.54062171e-09]
  ...
  [2.49645747e-12 1.00000000e+00 3.63042090e-15 2.24415941e-14
   3.30093822e-14]
  [4.20639168e-08 1.00000000e+00 7.94721602e-13 3.86854394e-12
   3.09432449e-12]
  [1.25088620e-11 1.00000000e+00 8.57348284e-15 4.76600638e-14
   6.70048733e-14]]

 [[7.16198629e-05 9.99928355e-01 3.12800411e-11 5.07101930e-11
   5.02158558e-11]
  [9.99533534e-01 4.66485973e-04 1.18041743e-10 8.51704748e-11
   6.76679962e-11]
  [3.09213735e-02 9.69078600e-01 7.64078301e-10 1.03367359e-09
   8.50685522e-10]
  ...
  [3.79966501e-12 1.00000000e+00 6.53456442e-15 5.09602296e-14
   3.72166558e-14]
  [1.11902246e-07 9.99999881e-01 6.80666949e-13 2.34673934e-12
   5.17373210e-12]
  [3.79292828e-07 9.99999642e-01 3.07917494e-12 9.91861974e-12
   6.58677843e-12]]

 ...

 [[6.53520594e-17 1.00000000e+00 1.71795851e-17 2.85133181e-16
   2.93026178e-16]
  [1.00000000e+00 9.37241929e-09 5.36270843e-13 2.02635922e-13
   1.69522572e-13]
  [9.99943972e-01 5.59826403e-05 3.28044814e-11 1.63496022e-11
   1.79510122e-11]
  ...
  [5.30061064e-11 1.00000000e+00 2.11671433e-14 1.37866091e-13
   1.43132373e-13]
  [1.70976622e-10 1.00000000e+00 3.62437572e-14 1.95947601e-13
   2.39077448e-13]
  [1.00000000e+00 3.00821271e-13 3.75441763e-15 4.55820616e-16
   5.01115862e-16]]

 [[1.00000000e+00 9.53560928e-12 2.38445230e-14 4.71412714e-15
   3.95469942e-15]
  [6.69951558e-01 3.30048472e-01 2.94127833e-09 3.19180171e-09
   1.66853176e-09]
  [1.02075845e-15 1.00000000e+00 7.08508253e-17 9.33568586e-16
   1.07467845e-15]
  ...
  [2.81724795e-12 1.00000000e+00 4.38398758e-15 2.85255320e-14
   3.11708599e-14]
  [5.91763367e-08 1.00000000e+00 6.56567953e-13 2.88999315e-12
   4.19719077e-12]
  [5.07374853e-09 1.00000000e+00 2.69437467e-13 1.09808993e-12
   9.29582800e-13]]

 [[6.53682655e-17 1.00000000e+00 1.71819442e-17 2.85166903e-16
   2.93059741e-16]
  [1.57590968e-10 1.00000000e+00 2.25218675e-14 1.38737126e-13
   2.80467381e-13]
  [1.78973014e-09 1.00000000e+00 1.40254494e-13 6.52692310e-13
   6.66332657e-13]
  ...
  [1.24630896e-11 1.00000000e+00 1.03927690e-14 5.91722106e-14
   5.58334540e-14]
  [3.73985642e-09 1.00000000e+00 1.53551596e-13 8.43254177e-13
   1.28487260e-12]
  [1.00000000e+00 1.36383147e-13 2.73154552e-15 2.93295693e-16
   2.85702625e-16]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.6632118e-17 1.0000000e+00 1.7361284e-17 2.8777431e-16 2.9559155e-16]
 [1.0000000e+00 3.0172416e-12 8.9638439e-15 1.4180913e-15 1.7282339e-15]
 [2.4005151e-14 1.0000000e+00 3.9867943e-16 4.5126197e-15 4.2470482e-15]
 ...
 [1.2463090e-11 1.0000000e+00 1.0392769e-14 5.9172211e-14 5.5833454e-14]
 [3.7398564e-09 1.0000000e+00 1.5355160e-13 8.4325418e-13 1.2848726e-12]
 [1.0000000e+00 1.3638315e-13 2.7315455e-15 2.9329569e-16 2.8570262e-16]] (100000, 5)
pred 3 (argmax) [1 0 1 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  13.46614281463623
tp :  15074.0
fp :  84926.0
tn :  315074.0
fn :  84926.0
accuracy :  0.6602993011474609
precision :  0.15073999762535095
recall :  0.15073999762535095
auc :  0.4690527021884918

y_eval {0: 100000}
pred {0: 15074, 1: 84926}
[INFO] confusion matrix for file 
[[15074 84926     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 498710 2790378       0       0       0]
 [  41392  239666       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4625062e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4625062e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 3.4625062e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [ 1.0399942e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.0399942e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0399942e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.32006751e-17 1.00000000e+00 1.68707754e-17 2.80637659e-16
   2.88653873e-16]
  [6.57201707e-01 3.42798263e-01 2.62901279e-09 5.47465362e-09
   3.05174486e-09]
  [1.24181700e-15 1.00000000e+00 6.81799914e-17 8.27885079e-16
   1.23033547e-15]
  ...
  [1.51580484e-12 1.00000000e+00 5.17674520e-15 5.26681156e-14
   3.06802245e-14]
  [5.45995082e-10 1.00000000e+00 5.16918966e-14 2.20922483e-13
   3.50878235e-13]
  [6.78094914e-09 1.00000000e+00 2.99357707e-13 1.46384554e-12
   1.45664026e-12]]

 [[6.18778611e-17 1.00000000e+00 1.66780423e-17 2.77822413e-16
   2.85922853e-16]
  [4.35724734e-10 1.00000000e+00 3.75527178e-14 2.17146315e-13
   4.47557735e-13]
  [1.68672409e-09 1.00000000e+00 1.38250549e-13 6.45619951e-13
   6.48891477e-13]
  ...
  [1.18096057e-08 1.00000000e+00 4.26461844e-13 1.74191759e-12
   1.54848411e-12]
  [2.52969390e-12 1.00000000e+00 4.80277930e-15 3.44277253e-14
   3.07791614e-14]
  [1.00000000e+00 2.77228923e-13 2.98960829e-15 3.59013591e-16
   4.98954657e-16]]

 [[6.18389307e-17 1.00000000e+00 1.66723166e-17 2.77737656e-16
   2.85842174e-16]
  [1.56772512e-10 1.00000000e+00 2.24471591e-14 1.38431299e-13
   2.80108673e-13]
  [1.88022020e-09 1.00000000e+00 1.43986412e-13 6.67800938e-13
   6.81146220e-13]
  ...
  [9.71868072e-11 1.00000000e+00 3.00326340e-14 1.83523241e-13
   1.80295516e-13]
  [1.00000000e+00 1.74386466e-13 2.46822584e-15 2.74274774e-16
   3.70130263e-16]
  [1.74251575e-12 1.00000000e+00 4.79873218e-15 4.49827113e-14
   3.06761283e-14]]

 ...

 [[6.32834263e-17 1.00000000e+00 1.68824933e-17 2.80804710e-16
   2.88822380e-16]
  [3.42147587e-07 9.99999642e-01 2.31940292e-12 1.32228785e-11
   8.67508322e-12]
  [3.22314226e-15 1.00000000e+00 1.04296140e-16 1.11597650e-15
   1.86035201e-15]
  ...
  [1.75346727e-07 9.99999881e-01 9.65934797e-13 3.17441147e-12
   5.71179909e-12]
  [1.19629462e-09 1.00000000e+00 1.44720444e-13 7.41318899e-13
   5.70544913e-13]
  [1.71277380e-12 1.00000000e+00 3.64933219e-15 2.58396769e-14
   2.51569903e-14]]

 [[6.32865630e-17 1.00000000e+00 1.68829432e-17 2.80812201e-16
   2.88830109e-16]
  [2.95746955e-10 1.00000000e+00 3.09378445e-14 1.83399370e-13
   3.74392384e-13]
  [7.39857221e-12 1.00000000e+00 8.58434773e-15 6.31884817e-14
   5.73619521e-14]
  ...
  [1.85602561e-10 1.00000000e+00 4.93114901e-14 2.45364466e-13
   1.82806705e-13]
  [4.52203795e-11 1.00000000e+00 1.51650610e-14 1.00136377e-13
   1.59947901e-13]
  [5.49116272e-08 1.00000000e+00 9.46473694e-13 3.56077125e-12
   2.78172927e-12]]

 [[6.18250142e-17 1.00000000e+00 1.66702817e-17 2.77707984e-16
   2.85812713e-16]
  [1.68455944e-10 1.00000000e+00 2.32927420e-14 1.43082703e-13
   2.89398524e-13]
  [1.00000000e+00 7.09183753e-11 5.19712786e-14 9.15557574e-15
   1.01119013e-14]
  ...
  [2.46202809e-08 1.00000000e+00 4.03576559e-13 1.95111570e-12
   2.92617948e-12]
  [1.00000000e+00 1.11324533e-10 7.12792591e-14 1.09361584e-14
   1.08351692e-14]
  [1.69619595e-13 1.00000000e+00 1.30575423e-15 1.24829592e-14
   9.55234206e-15]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.32006751e-17 1.00000000e+00 1.68707754e-17 2.80637659e-16
  2.88653873e-16]
 [6.57201707e-01 3.42798263e-01 2.62901279e-09 5.47465362e-09
  3.05174486e-09]
 [1.24181700e-15 1.00000000e+00 6.81799914e-17 8.27885079e-16
  1.23033547e-15]
 ...
 [2.46202809e-08 1.00000000e+00 4.03576559e-13 1.95111570e-12
  2.92617948e-12]
 [1.00000000e+00 1.11324533e-10 7.12792591e-14 1.09361584e-14
  1.08351692e-14]
 [1.69619595e-13 1.00000000e+00 1.30575423e-15 1.24829592e-14
  9.55234206e-15]] (100000, 5)
pred 3 (argmax) [1 0 1 ... 1 0 1] (100000,)
[33m[INFO] metrics:[0m
loss :  12.150392013549805
tp :  23578.0
fp :  76422.0
tn :  323578.0
fn :  76422.0
accuracy :  0.6943150162696838
precision :  0.2357800006866455
recall :  0.2357800006866455
auc :  0.523079514503479

y_eval {0: 82641, 1: 17359}
pred {0: 14617, 1: 85383}
[INFO] confusion matrix for file 
[[10418 72223     0     0     0]
 [ 4199 13160     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 509128 2862601       0       0       0]
 [  45591  252826       0       0       0]
 [   7937   19115       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0399942  0.         0.        ...  4.         0.00482   -0.23351  ]
 [ 1.0399942  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.0399942  0.         0.        ...  1.         0.00482   -0.32151  ]
 ...
 [ 1.733738   0.         0.        ...  2.         0.00482   -0.33484  ]
 [ 1.733738   0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.733738   0.         0.        ...  3.         0.00482    1.45442  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 1. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 2 2] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99999642e-01 3.36941696e-07 3.21062925e-12 1.19715978e-12
   1.17456002e-12]
  [9.02771103e-14 1.00000000e+00 1.12886855e-15 1.36470255e-14
   7.59988708e-15]
  [2.90079206e-14 1.00000000e+00 3.11485990e-16 3.06414952e-15
   5.12841265e-15]
  ...
  [2.56403162e-13 1.00000000e+00 1.82981288e-15 1.95124390e-14
   1.30582716e-14]
  [6.98950364e-09 1.00000000e+00 1.86867191e-13 7.42159264e-13
   1.26648789e-12]
  [2.94404234e-09 1.00000000e+00 2.16726742e-13 1.06083154e-12
   9.03110811e-13]]

 [[6.18247760e-17 1.00000000e+00 1.66702817e-17 2.77707984e-16
   2.85812713e-16]
  [1.68716721e-10 1.00000000e+00 2.33107431e-14 1.43178519e-13
   2.89605037e-13]
  [3.37304451e-09 1.00000000e+00 1.94858574e-13 8.62341340e-13
   8.81657052e-13]
  ...
  [1.10565012e-11 1.00000000e+00 1.05238228e-14 6.13029254e-14
   5.14404058e-14]
  [2.82125834e-09 1.00000000e+00 1.24260492e-13 6.94693218e-13
   1.15747602e-12]
  [2.38441871e-08 1.00000000e+00 6.40339127e-13 2.48508896e-12
   1.85949281e-12]]

 [[6.33003272e-17 1.00000000e+00 1.68849401e-17 2.80841132e-16
   2.88857664e-16]
  [1.78918311e-10 1.00000000e+00 2.39944393e-14 1.46684653e-13
   2.97488461e-13]
  [1.00000000e+00 5.32857786e-11 4.53248821e-14 7.82246108e-15
   8.61870169e-15]
  ...
  [8.52294309e-14 1.00000000e+00 1.08214494e-15 1.27317378e-14
   8.27844432e-15]
  [2.87075945e-08 1.00000000e+00 3.79099069e-13 1.26921325e-12
   2.12347371e-12]
  [2.07541051e-09 1.00000000e+00 1.65965847e-13 8.39631858e-13
   8.43799640e-13]]

 ...

 [[6.18743208e-17 1.00000000e+00 1.66775328e-17 2.77815001e-16
   2.85915230e-16]
  [7.55726037e-11 1.00000000e+00 1.56475852e-14 1.01483858e-13
   1.99809272e-13]
  [1.23099175e-09 1.00000000e+00 1.12567033e-13 5.36974003e-13
   5.66619126e-13]
  ...
  [9.99999881e-01 6.34642987e-08 1.27086276e-12 3.95520097e-13
   4.96313873e-13]
  [2.42392586e-13 1.00000000e+00 1.68495690e-15 1.73251882e-14
   1.31012560e-14]
  [1.38061962e-08 1.00000000e+00 2.88376961e-13 1.08362137e-12
   1.57316326e-12]]

 [[9.99999762e-01 1.79621892e-07 2.36897763e-12 8.33590358e-13
   8.17386144e-13]
  [2.21553759e-13 1.00000000e+00 1.83679942e-15 2.09466132e-14
   1.10642679e-14]
  [1.27977107e-15 1.00000000e+00 6.52601365e-17 8.06818258e-16
   1.23724461e-15]
  ...
  [9.77469651e-14 1.00000000e+00 1.14790604e-15 1.32502804e-14
   8.55916968e-15]
  [2.25202479e-09 1.00000000e+00 1.06286236e-13 4.69918483e-13
   7.69024276e-13]
  [2.85203283e-09 1.00000000e+00 2.06520659e-13 1.01405744e-12
   9.09690726e-13]]

 [[6.72608614e-17 1.00000000e+00 1.74523876e-17 2.89131044e-16
   2.96841293e-16]
  [1.51234386e-10 1.00000000e+00 2.20664636e-14 1.36230545e-13
   2.75085158e-13]
  [1.02563956e-11 1.00000000e+00 1.00193257e-14 7.15718852e-14
   6.64494569e-14]
  ...
  [2.39081005e-10 1.00000000e+00 5.83422267e-14 2.91123625e-13
   2.04896308e-13]
  [2.74853092e-11 1.00000000e+00 1.15514576e-14 7.69945563e-14
   1.25805589e-13]
  [1.77494385e-07 9.99999881e-01 1.75592429e-12 6.15481928e-12
   4.73326196e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.99999642e-01 3.36941696e-07 3.21062925e-12 1.19715978e-12
  1.17456002e-12]
 [9.02771103e-14 1.00000000e+00 1.12886855e-15 1.36470255e-14
  7.59988708e-15]
 [2.90079206e-14 1.00000000e+00 3.11485990e-16 3.06414952e-15
  5.12841265e-15]
 ...
 [2.39081005e-10 1.00000000e+00 5.83422267e-14 2.91123625e-13
  2.04896308e-13]
 [2.74853092e-11 1.00000000e+00 1.15514576e-14 7.69945563e-14
  1.25805589e-13]
 [1.77494385e-07 9.99999881e-01 1.75592429e-12 6.15481928e-12
  4.73326196e-12]] (100000, 5)
pred 3 (argmax) [0 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  14.787044374084473
tp :  7685.0
fp :  92315.0
tn :  307685.0
fn :  92315.0
accuracy :  0.6307435035705566
precision :  0.07684999704360962
recall :  0.07684999704360962
auc :  0.422465443611145

y_eval {0: 71311, 2: 28689}
pred {0: 14276, 1: 85724}
[INFO] confusion matrix for file 
[[ 7685 63626     0     0     0]
 [    0     0     0     0     0]
 [ 6591 22098     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 516813 2926227       0       0       0]
 [  45591  252826       0       0       0]
 [  14528   41213       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-01_203011_118.log.part07_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:99.9996%,2:0.0004%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9994%,3:0.0006%]
[INFO] ** i/f_dir:[1:99.9994%,0:0.0006%]
[INFO] ** src:[22:38.0718%,9:26.1174%,7:18.2344%,1:17.5754%,21:0.0008%,14:0.0002%]
[INFO] ** dst:[21:43.3758%,10:20.813%,8:18.2342%,9:17.5754%,15:0.0006%,22:0.0004%,24:0.0002%,18:0.0002%,6:0.0002%]
[INFO] ** proto:[0:99.999%,1:0.0006%,2:0.0004%]
[INFO] ** appi_name:[21:99.999%,30:0.0006%,31:0.0002%,22:0.0002%]
[INFO] ** proxy_src_ip:[18:38.0718%,20:26.1174%,13:18.2344%,6:17.5754%,17:0.0006%,7:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.999%,-33.760870000000004:0.001%]
[INFO] ** modbus_function_description:[7:49.9996%,11:49.9994%,0:0.001%]
[INFO] ** modbus_transaction_id:65301 (13.0602%)
[INFO] ** scada_tag:[3:26.1164%,1:20.813%,5:18.2338%,4:17.575%,2:17.2586%,0:0.0032%]
[INFO] ** service:[0.0048200000000000005:99.999%,-211.73542999999998:0.0006%,-186.43601999999998:0.0002%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.1168%,-0.32151:20.813%,-1.27613:18.234%,-0.23351:17.5752%,-0.33484:17.2588%,-71.33197:0.0006%,-1.27347:0.0002%,1.45709:0.0002%,1.46509:0.0002%,1.47576:0.0002%,4.42897:0.0002%,-0.24151:0.0002%,-71.14931:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:89.2092%,Single Stage Multi Point:10.7908%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7311594e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.7311594e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.7311594e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [-1.0380956e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.0380956e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0380956e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [2 0 0 ... 2 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[2.6115173e-01 7.3884821e-01 1.7948872e-09 1.4804721e-09 1.5172175e-09]
  [9.9999952e-01 4.6605203e-07 3.6466294e-12 1.3712315e-12 1.4375043e-12]
  [2.1875585e-10 1.0000000e+00 6.0546098e-14 3.6857391e-13 2.4670045e-13]
  ...
  [1.0656266e-10 1.0000000e+00 3.4606734e-14 2.1784115e-13 1.7120413e-13]
  [6.9645814e-08 9.9999988e-01 5.6351722e-13 1.8470605e-12 3.9231062e-12]
  [4.9384681e-08 1.0000000e+00 1.1050676e-12 4.1637574e-12 2.5627274e-12]]

 [[1.0000000e+00 1.1412107e-11 2.5773620e-14 5.1440082e-15 4.3209455e-15]
  [9.9984825e-01 1.5170634e-04 7.0354458e-11 4.3611982e-11 3.2139430e-11]
  [4.4649773e-10 1.0000000e+00 5.9984014e-14 2.5822741e-13 3.1597915e-13]
  ...
  [2.0594264e-11 1.0000000e+00 1.8216131e-14 1.4176223e-13 9.0684567e-14]
  [1.2031182e-09 1.0000000e+00 7.6575255e-14 3.1749188e-13 5.3657778e-13]
  [2.0310541e-08 1.0000000e+00 5.6199630e-13 2.4045685e-12 2.1199730e-12]]

 [[1.0000000e+00 2.7290537e-13 4.4464901e-15 6.9271413e-16 5.5245892e-16]
  [9.9404484e-01 5.9551834e-03 3.8793094e-10 3.2314385e-10 2.6335123e-10]
  [5.1338889e-09 1.0000000e+00 2.3296976e-13 8.6232491e-13 8.8723408e-13]
  ...
  [8.0216359e-06 9.9999201e-01 9.7509795e-12 2.6153175e-11 3.3838397e-11]
  [1.3856438e-10 1.0000000e+00 4.3562745e-14 2.1619785e-13 1.6154096e-13]
  [7.4104681e-11 1.0000000e+00 1.9963013e-14 1.3164537e-13 1.9313246e-13]]

 ...

 [[6.8260407e-17 1.0000000e+00 1.7590006e-17 2.9109320e-16 2.9881475e-16]
  [1.0000000e+00 3.7746932e-12 7.7287614e-15 1.1094906e-15 2.1510681e-15]
  [2.0604439e-07 9.9999976e-01 2.0618971e-12 7.0522021e-12 5.6422510e-12]
  ...
  [2.9865501e-07 9.9999964e-01 1.7747222e-12 7.7515052e-12 8.6278892e-12]
  [2.2098941e-10 1.0000000e+00 4.4084911e-14 2.0680960e-13 2.3289424e-13]
  [1.1140546e-10 1.0000000e+00 3.3627066e-14 2.0033590e-13 1.9156845e-13]]

 [[6.1837045e-17 1.0000000e+00 1.6672063e-17 2.7773339e-16 2.8583778e-16]
  [1.0000000e+00 4.0902386e-12 8.0520756e-15 1.1688553e-15 2.2593966e-15]
  [8.4836982e-13 1.0000000e+00 2.9214348e-15 2.6588822e-14 2.2961865e-14]
  ...
  [4.1945817e-12 1.0000000e+00 8.3856516e-15 7.6918818e-14 4.6238851e-14]
  [1.4651607e-09 1.0000000e+00 8.3161776e-14 3.3821985e-13 5.8240858e-13]
  [9.8931316e-09 1.0000000e+00 3.9699548e-13 1.8308176e-12 1.5868147e-12]]

 [[6.1943989e-17 1.0000000e+00 1.6687780e-17 2.7796445e-16 2.8606034e-16]
  [1.9365876e-10 1.0000000e+00 2.4968407e-14 1.5195325e-13 3.0859888e-13]
  [6.1836349e-09 1.0000000e+00 2.6777446e-13 1.1300249e-12 1.1513900e-12]
  ...
  [1.3616463e-12 1.0000000e+00 4.2291190e-15 3.9905870e-14 2.6386535e-14]
  [1.8414504e-08 1.0000000e+00 2.8763206e-13 1.0541854e-12 2.0896076e-12]
  [8.6531209e-09 1.0000000e+00 4.3690914e-13 2.0174134e-12 1.3573031e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[2.6115173e-01 7.3884821e-01 1.7948872e-09 1.4804721e-09 1.5172175e-09]
 [9.9999952e-01 4.6605203e-07 3.6466294e-12 1.3712315e-12 1.4375043e-12]
 [2.1875585e-10 1.0000000e+00 6.0546098e-14 3.6857391e-13 2.4670045e-13]
 ...
 [1.3616463e-12 1.0000000e+00 4.2291190e-15 3.9905870e-14 2.6386535e-14]
 [1.8414504e-08 1.0000000e+00 2.8763206e-13 1.0541854e-12 2.0896076e-12]
 [8.6531209e-09 1.0000000e+00 4.3690914e-13 2.0174134e-12 1.3573031e-12]] (100000, 5)
pred 3 (argmax) [1 0 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  15.04342105102539
tp :  5407.0
fp :  94593.0
tn :  305407.0
fn :  94593.0
accuracy :  0.6216315627098083
precision :  0.05406999960541725
recall :  0.05406999960541725
auc :  0.4075983762741089

y_eval {0: 53027, 2: 46973}
pred {0: 18345, 1: 81655}
[INFO] confusion matrix for file 
[[ 5407 47620     0     0     0]
 [    0     0     0     0     0]
 [12938 34035     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 522220 2973847       0       0       0]
 [  45591  252826       0       0       0]
 [  27466   75248       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0380956e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0380956e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.0380956e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-3.4757039e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-3.4757039e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-3.4757039e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 2 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.83015605e-17 1.00000000e+00 1.75957777e-17 2.91177608e-16
   2.98895692e-16]
  [9.98132050e-01 1.86797848e-03 1.70323908e-10 1.70462380e-10
   1.65799915e-10]
  [1.64556157e-14 1.00000000e+00 2.48307973e-16 2.38061574e-15
   4.17084910e-15]
  ...
  [2.37282221e-12 1.00000000e+00 3.90549613e-15 2.57352547e-14
   2.94017977e-14]
  [9.07652975e-08 9.99999881e-01 8.46507651e-13 3.65595575e-12
   5.06729944e-12]
  [6.28425756e-10 1.00000000e+00 8.96933827e-14 4.28886988e-13
   3.71352038e-13]]

 [[6.04266570e-05 9.99939561e-01 2.86716709e-11 4.71411278e-11
   4.66476684e-11]
  [2.05826380e-15 1.00000000e+00 1.05408472e-16 1.40598787e-15
   1.53045301e-15]
  [2.41898360e-05 9.99975801e-01 1.24798193e-11 3.11866817e-11
   4.68726898e-11]
  ...
  [1.36499818e-12 1.00000000e+00 2.80468702e-15 1.87416797e-14
   2.48849200e-14]
  [7.41757731e-08 9.99999881e-01 9.60088346e-13 4.37237789e-12
   4.10320129e-12]
  [1.22355195e-10 1.00000000e+00 2.99435769e-14 1.43090889e-13
   1.84976736e-13]]

 [[1.00000000e+00 3.31019899e-11 4.23322097e-14 9.04218174e-15
   7.78290379e-15]
  [9.52213526e-01 4.77865115e-02 1.29137978e-09 1.15971355e-09
   6.70252964e-10]
  [9.99910951e-01 8.90476367e-05 3.20237725e-11 1.17297673e-11
   2.56518522e-11]
  ...
  [1.94534215e-11 1.00000000e+00 9.59075247e-15 6.31171683e-14
   1.02258737e-13]
  [2.03034404e-07 9.99999762e-01 1.74804789e-12 6.02378997e-12
   5.12448807e-12]
  [1.25252395e-11 1.00000000e+00 9.10910328e-15 5.00109936e-14
   6.45703380e-14]]

 ...

 [[7.10410834e-17 1.00000000e+00 1.79782445e-17 2.96760905e-16
   3.04220512e-16]
  [2.67313560e-10 1.00000000e+00 2.93935544e-14 1.74850748e-13
   3.56898999e-13]
  [4.39119205e-04 9.99560893e-01 9.22384391e-11 1.65841341e-10
   1.50568003e-10]
  ...
  [1.38903550e-11 1.00000000e+00 1.15634058e-14 6.41127098e-14
   5.60124355e-14]
  [1.96780214e-09 1.00000000e+00 1.05780829e-13 6.21298911e-13
   9.88992308e-13]
  [5.29138617e-08 1.00000000e+00 9.17586428e-13 3.23695975e-12
   2.60646279e-12]]

 [[6.41939801e-17 1.00000000e+00 1.70137999e-17 2.82718978e-16
   2.90682623e-16]
  [4.19996593e-10 1.00000000e+00 3.68763586e-14 2.13590240e-13
   4.39759259e-13]
  [1.31787581e-09 1.00000000e+00 1.21533507e-13 5.78669274e-13
   5.81872278e-13]
  ...
  [2.71835221e-09 1.00000000e+00 1.92085077e-13 8.77596878e-13
   8.18316118e-13]
  [5.24582331e-12 1.00000000e+00 6.97351638e-15 4.75173760e-14
   4.27356514e-14]
  [1.65666370e-09 1.00000000e+00 1.01463732e-13 5.22133389e-13
   7.76464396e-13]]

 [[7.10855460e-17 1.00000000e+00 1.79844186e-17 2.96850346e-16
   3.04306407e-16]
  [1.94842892e-10 1.00000000e+00 2.50840185e-14 1.52289246e-13
   3.08654198e-13]
  [1.91081306e-09 1.00000000e+00 1.45467649e-13 6.72807567e-13
   6.85433969e-13]
  ...
  [3.01926106e-09 1.00000000e+00 2.06518694e-13 9.40509931e-13
   8.54298240e-13]
  [5.23322097e-12 1.00000000e+00 6.90964713e-15 4.67971067e-14
   4.26007970e-14]
  [1.91883331e-09 1.00000000e+00 1.10161785e-13 5.65614938e-13
   8.34115383e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.83015605e-17 1.00000000e+00 1.75957777e-17 2.91177608e-16
  2.98895692e-16]
 [9.98132050e-01 1.86797848e-03 1.70323908e-10 1.70462380e-10
  1.65799915e-10]
 [1.64556157e-14 1.00000000e+00 2.48307973e-16 2.38061574e-15
  4.17084910e-15]
 ...
 [3.01926106e-09 1.00000000e+00 2.06518694e-13 9.40509931e-13
  8.54298240e-13]
 [5.23322097e-12 1.00000000e+00 6.90964713e-15 4.67971067e-14
  4.26007970e-14]
 [1.91883331e-09 1.00000000e+00 1.10161785e-13 5.65614938e-13
  8.34115383e-13]] (100000, 5)
pred 3 (argmax) [1 0 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.458170774841308
tp :  14353.0
fp :  85647.0
tn :  314353.0
fn :  85647.0
accuracy :  0.6574153304100037
precision :  0.1435299962759018
recall :  0.1435299962759018
auc :  0.4658183455467224

y_eval {0: 93019, 2: 6981}
pred {0: 16212, 1: 83788}
[INFO] confusion matrix for file 
[[14353 78666     0     0     0]
 [    0     0     0     0     0]
 [ 1859  5122     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 536573 3052513       0       0       0]
 [  45591  252826       0       0       0]
 [  29325   80370       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-0.3475704  0.         0.        ...  2.         0.00482   -0.33484  ]
 [-0.3475704  0.         0.        ...  3.         0.00482    1.45442  ]
 [-0.3475704  0.         0.        ...  2.         0.00482   -0.33484  ]
 ...
 [ 0.3454935  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 0.3454935  0.         0.        ...  3.         0.00482    1.45442  ]
 [ 0.3454935  0.         0.        ...  2.         0.00482   -0.33484  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.19026501e-17 1.00000000e+00 1.66817332e-17 2.77875405e-16
   2.85974125e-16]
  [4.24349611e-10 1.00000000e+00 3.70517690e-14 2.14588235e-13
   4.42184944e-13]
  [2.44731635e-09 1.00000000e+00 1.67669372e-13 7.60282354e-13
   7.64627673e-13]
  ...
  [1.00000000e+00 2.51775045e-09 3.03879968e-13 5.50128316e-14
   5.71267683e-14]
  [8.26670953e-14 1.00000000e+00 9.35772036e-16 1.00465375e-14
   7.65747769e-15]
  [2.40875352e-07 9.99999762e-01 1.15794819e-12 3.74099840e-12
   6.32912993e-12]]

 [[7.11465853e-17 1.00000000e+00 1.79927897e-17 2.96971551e-16
   3.04423694e-16]
  [1.28928285e-10 1.00000000e+00 2.04024216e-14 1.27242184e-13
   2.55260358e-13]
  [1.43606838e-09 1.00000000e+00 1.24264748e-13 5.87518586e-13
   6.04723791e-13]
  ...
  [3.11391624e-08 1.00000000e+00 4.05244225e-13 1.48206729e-12
   2.64072054e-12]
  [1.00911617e-08 1.00000000e+00 4.44556176e-13 1.94414667e-12
   1.42893770e-12]
  [1.03366946e-12 1.00000000e+00 2.76164674e-15 2.00155512e-14
   2.02921650e-14]]

 [[1.12104512e-08 1.00000000e+00 3.48445963e-13 1.19441642e-12
   1.13813429e-12]
  [9.33362545e-15 1.00000000e+00 2.13910375e-16 2.54220803e-15
   3.05117912e-15]
  [3.02840448e-07 9.99999642e-01 1.35540624e-12 4.43313225e-12
   6.75171724e-12]
  ...
  [2.61512253e-12 1.00000000e+00 4.07401418e-15 2.70272188e-14
   3.33920513e-14]
  [5.64119844e-08 1.00000000e+00 7.88583662e-13 3.46742947e-12
   3.60080043e-12]
  [5.51672701e-11 1.00000000e+00 2.14692935e-14 1.15272538e-13
   1.30451585e-13]]

 ...

 [[4.13926809e-11 1.00000000e+00 1.93813929e-14 1.08598372e-13
   1.01579911e-13]
  [8.44381937e-14 1.00000000e+00 6.17225391e-16 6.21653870e-15
   8.33475253e-15]
  [5.47451400e-08 1.00000000e+00 6.15730665e-13 2.22671447e-12
   3.07806038e-12]
  ...
  [1.00000000e+00 1.09571907e-09 1.60928969e-13 3.04532604e-14
   4.67414430e-14]
  [4.48143719e-13 1.00000000e+00 2.82358073e-15 3.15610371e-14
   1.76261034e-14]
  [1.81102722e-09 1.00000000e+00 9.06155779e-14 3.54418236e-13
   6.05360814e-13]]

 [[6.18299641e-17 1.00000000e+00 1.66709815e-17 2.77718572e-16
   2.85822533e-16]
  [2.34719411e-10 1.00000000e+00 2.74914013e-14 1.65239377e-13
   3.37135241e-13]
  [1.74390491e-09 1.00000000e+00 1.39492015e-13 6.50602944e-13
   6.58530739e-13]
  ...
  [2.03349870e-07 9.99999762e-01 1.04180618e-12 3.34169281e-12
   6.01503005e-12]
  [1.56165569e-09 1.00000000e+00 1.66266225e-13 8.44936642e-13
   6.49986467e-13]
  [3.65145457e-12 1.00000000e+00 5.34851416e-15 3.47209817e-14
   3.43617956e-14]]

 [[6.38398872e-17 1.00000000e+00 1.69630573e-17 2.81983330e-16
   2.89960554e-16]
  [1.00000000e+00 2.12896509e-08 7.17285389e-13 2.71180105e-13
   2.60856522e-13]
  [2.51927439e-08 1.00000000e+00 4.27913808e-13 1.33747115e-12
   2.41809957e-12]
  ...
  [1.10763690e-10 1.00000000e+00 3.44451979e-14 2.22800063e-13
   1.92741642e-13]
  [7.76024411e-10 1.00000000e+00 6.75551330e-14 2.97660442e-13
   4.63685243e-13]
  [1.84711291e-09 1.00000000e+00 1.71653395e-13 8.55976585e-13
   6.52055233e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.1902650e-17 1.0000000e+00 1.6681733e-17 2.7787541e-16 2.8597413e-16]
 [4.2434961e-10 1.0000000e+00 3.7051769e-14 2.1458823e-13 4.4218494e-13]
 [2.4473163e-09 1.0000000e+00 1.6766937e-13 7.6028235e-13 7.6462767e-13]
 ...
 [1.1076369e-10 1.0000000e+00 3.4445198e-14 2.2280006e-13 1.9274164e-13]
 [7.7602441e-10 1.0000000e+00 6.7555133e-14 2.9766044e-13 4.6368524e-13]
 [1.8471129e-09 1.0000000e+00 1.7165340e-13 8.5597659e-13 6.5205523e-13]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.467670777893066
tp :  15030.0
fp :  84970.0
tn :  315030.0
fn :  84970.0
accuracy :  0.6601232886314392
precision :  0.15029999613761902
recall :  0.15029999613761902
auc :  0.4689037799835205

y_eval {0: 100000}
pred {0: 15030, 1: 84970}
[INFO] confusion matrix for file 
[[15030 84970     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 551603 3137483       0       0       0]
 [  45591  252826       0       0       0]
 [  29325   80370       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4549350e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4549350e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4549350e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 1.0385574e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0385574e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0385574e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.3829174e-17 1.0000000e+00 1.6961504e-17 2.8196075e-16 2.8993954e-16]
  [1.0000000e+00 5.0939008e-08 6.6077157e-13 2.0997825e-13 4.9200466e-13]
  [4.7227205e-12 1.0000000e+00 7.4420391e-15 5.8347458e-14 5.3267303e-14]
  ...
  [1.7677689e-06 9.9999821e-01 5.1435562e-12 1.8846060e-11 1.6747811e-11]
  [8.9546469e-12 1.0000000e+00 7.7731121e-15 4.5005452e-14 5.7129818e-14]
  [1.0000000e+00 1.4759290e-12 8.0430810e-15 1.1603965e-15 1.2634917e-15]]

 [[6.3818460e-17 1.0000000e+00 1.6959952e-17 2.8193817e-16 2.8991741e-16]
  [1.9382948e-10 1.0000000e+00 2.4980601e-14 1.5191674e-13 3.0858004e-13]
  [1.3574863e-09 1.0000000e+00 1.2206712e-13 5.8071809e-13 5.8956274e-13]
  ...
  [3.2697953e-10 1.0000000e+00 5.5775124e-14 3.1847685e-13 3.2095878e-13]
  [2.8427824e-10 1.0000000e+00 4.6821034e-14 2.2820938e-13 2.8371554e-13]
  [1.0000000e+00 5.7347243e-12 1.5677011e-14 2.4027494e-15 2.6572076e-15]]

 [[6.9667825e-17 1.0000000e+00 1.7788800e-17 2.9401599e-16 3.0156533e-16]
  [1.1329741e-10 1.0000000e+00 1.9135216e-14 1.2044935e-13 2.4053288e-13]
  [1.3565985e-09 1.0000000e+00 1.2009446e-13 5.6985758e-13 5.9007687e-13]
  ...
  [3.6128053e-08 1.0000000e+00 4.3569250e-13 1.5812223e-12 2.7638907e-12]
  [2.6771425e-09 1.0000000e+00 2.1324343e-13 1.0299008e-12 8.2068412e-13]
  [7.4361619e-12 1.0000000e+00 7.8187612e-15 4.8162575e-14 4.7489288e-14]]

 ...

 [[6.8071624e-17 1.0000000e+00 1.7566269e-17 2.9078689e-16 2.9844221e-16]
  [9.9997962e-01 2.0423708e-05 1.1443283e-11 6.0203951e-12 1.5068244e-11]
  [3.3517904e-13 1.0000000e+00 1.9717712e-15 1.9644708e-14 1.5997437e-14]
  ...
  [4.7929962e-06 9.9999523e-01 5.0242566e-12 1.5696498e-11 3.0581739e-11]
  [3.8423340e-09 1.0000000e+00 2.7058491e-13 1.2635418e-12 9.4021037e-13]
  [3.1987598e-12 1.0000000e+00 4.8859550e-15 3.0497492e-14 3.1441409e-14]]

 [[6.5813137e-17 1.0000000e+00 1.7245245e-17 2.8608760e-16 2.9395320e-16]
  [1.5404465e-10 1.0000000e+00 2.2270478e-14 1.3738624e-13 2.7749978e-13]
  [9.2342297e-12 1.0000000e+00 9.5145195e-15 6.8634809e-14 6.3377255e-14]
  ...
  [1.0494753e-07 9.9999988e-01 7.1152687e-13 2.4769637e-12 4.5543213e-12]
  [3.6936920e-09 1.0000000e+00 2.4701121e-13 1.1601084e-12 9.8551061e-13]
  [6.2836637e-12 1.0000000e+00 7.4968328e-15 4.6061919e-14 4.1959698e-14]]

 [[6.1887781e-17 1.0000000e+00 1.6679505e-17 2.7784362e-16 2.8594358e-16]
  [1.5173453e-10 1.0000000e+00 2.2110828e-14 1.3676790e-13 2.7577598e-13]
  [2.9498994e-09 1.0000000e+00 1.8124680e-13 8.1038214e-13 8.3127244e-13]
  ...
  [1.2956141e-09 1.0000000e+00 1.1329011e-13 5.3005950e-13 6.2208149e-13]
  [1.0000000e+00 1.4165771e-08 7.5462482e-13 1.7716105e-13 1.6735658e-13]
  [3.1386826e-14 1.0000000e+00 5.4517137e-16 6.2529751e-15 4.9709120e-15]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.3829174e-17 1.0000000e+00 1.6961504e-17 2.8196075e-16 2.8993954e-16]
 [1.0000000e+00 5.0939008e-08 6.6077157e-13 2.0997825e-13 4.9200466e-13]
 [4.7227205e-12 1.0000000e+00 7.4420391e-15 5.8347458e-14 5.3267303e-14]
 ...
 [1.2956141e-09 1.0000000e+00 1.1329011e-13 5.3005950e-13 6.2208149e-13]
 [1.0000000e+00 1.4165771e-08 7.5462482e-13 1.7716105e-13 1.6735658e-13]
 [3.1386826e-14 1.0000000e+00 5.4517137e-16 6.2529751e-15 4.9709120e-15]] (100000, 5)
pred 3 (argmax) [1 0 1 ... 1 0 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.618573587036133
tp :  14548.0
fp :  85452.0
tn :  314548.0
fn :  85452.0
accuracy :  0.6581953167915344
precision :  0.14548000693321228
recall :  0.14548000693321228
auc :  0.4663139581680298

y_eval {0: 100000}
pred {0: 14548, 1: 85452}
[INFO] confusion matrix for file 
[[14548 85452     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 566151 3222935       0       0       0]
 [  45591  252826       0       0       0]
 [  29325   80370       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0385574  0.         0.        ...  4.         0.00482   -0.23351  ]
 [ 1.0385574  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.0385574  0.         0.        ...  2.         0.00482   -0.33484  ]
 ...
 [ 1.7316213  0.         0.        ...  3.         0.00482    1.45442  ]
 [ 1.7316213  0.         0.        ...  2.         0.00482   -0.33484  ]
 [ 1.7316213  0.         0.        ...  1.         0.00482   -0.32151  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.9999988e-01 9.3230526e-08 1.7468349e-12 5.9074799e-13 5.7226690e-13]
  [3.6942956e-14 1.0000000e+00 6.7100722e-16 8.4544197e-15 5.0622297e-15]
  [2.8314345e-14 1.0000000e+00 3.0949734e-16 3.0862975e-15 5.2008534e-15]
  ...
  [4.9798048e-11 1.0000000e+00 2.1394853e-14 1.3330899e-13 1.3504077e-13]
  [1.0000000e+00 1.1679073e-09 1.8401291e-13 4.2076063e-14 5.4596589e-14]
  [2.0164583e-13 1.0000000e+00 1.6291091e-15 1.7942509e-14 1.2042401e-14]]

 [[6.1815578e-17 1.0000000e+00 1.6668884e-17 2.7768784e-16 2.8579310e-16]
  [8.9217579e-01 1.0782422e-01 1.8447499e-09 3.5540249e-09 1.8750483e-09]
  [8.4300684e-16 1.0000000e+00 5.7411337e-17 7.3408693e-16 1.0238861e-15]
  ...
  [1.0000000e+00 1.3179674e-11 2.1993687e-14 3.7157768e-15 4.3790401e-15]
  [1.9551603e-13 1.0000000e+00 1.4526178e-15 1.5411810e-14 1.1580843e-14]
  [4.6785381e-08 1.0000000e+00 4.9748628e-13 1.7570268e-12 3.0474904e-12]]

 [[6.1815346e-17 1.0000000e+00 1.6668884e-17 2.7768784e-16 2.8579310e-16]
  [1.5219365e-10 1.0000000e+00 2.2143874e-14 1.3694750e-13 2.7616603e-13]
  [2.9747034e-09 1.0000000e+00 1.8205129e-13 8.1345152e-13 8.3434773e-13]
  ...
  [3.1631764e-08 1.0000000e+00 4.0943811e-13 1.5328100e-12 2.5787170e-12]
  [2.4522413e-09 1.0000000e+00 1.9038498e-13 9.0587629e-13 8.1062641e-13]
  [9.5429775e-12 1.0000000e+00 9.3983650e-15 5.7622499e-14 5.2247286e-14]]

 ...

 [[6.7510207e-17 1.0000000e+00 1.7487508e-17 2.8964218e-16 2.9733429e-16]
  [9.9973840e-01 2.6164047e-04 3.8892899e-11 2.5332916e-11 6.4500627e-11]
  [3.2624611e-11 1.0000000e+00 2.0758487e-14 1.3769396e-13 1.2841150e-13]
  ...
  [3.1696726e-07 9.9999964e-01 2.1037918e-12 9.3512776e-12 8.3296451e-12]
  [3.0805521e-11 1.0000000e+00 1.4275959e-14 7.3815940e-14 9.8045724e-14]
  [3.0320610e-09 1.0000000e+00 2.0223591e-13 1.0539240e-12 8.9105492e-13]]

 [[1.4690808e-13 1.0000000e+00 1.0326175e-15 9.4171700e-15 8.8162586e-15]
  [2.0847435e-15 1.0000000e+00 1.2984222e-16 2.0089282e-15 1.4846963e-15]
  [2.5224160e-14 1.0000000e+00 2.8932411e-16 2.9219475e-15 4.7198675e-15]
  ...
  [1.0000000e+00 6.5210255e-09 4.4073079e-13 1.0749542e-13 1.3445760e-13]
  [1.0559618e-13 1.0000000e+00 1.1794392e-15 1.3678871e-14 8.9247084e-15]
  [1.6964300e-08 1.0000000e+00 2.8360409e-13 1.0317214e-12 1.8284829e-12]]

 [[6.3041036e-17 1.0000000e+00 1.6847431e-17 2.8029527e-16 2.8832483e-16]
  [2.2434279e-10 1.0000000e+00 2.6951496e-14 1.6272629e-13 3.2969694e-13]
  [3.1637132e-12 1.0000000e+00 5.5016056e-15 4.3280084e-14 3.9234769e-14]
  ...
  [4.7084781e-10 1.0000000e+00 8.4549717e-14 4.0557363e-13 2.7762368e-13]
  [1.6849603e-11 1.0000000e+00 9.0204774e-15 6.0773326e-14 9.8683994e-14]
  [7.4620779e-08 9.9999988e-01 1.1177718e-12 4.2610590e-12 3.2777403e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999988e-01 9.3230526e-08 1.7468349e-12 5.9074799e-13 5.7226690e-13]
 [3.6942956e-14 1.0000000e+00 6.7100722e-16 8.4544197e-15 5.0622297e-15]
 [2.8314345e-14 1.0000000e+00 3.0949734e-16 3.0862975e-15 5.2008534e-15]
 ...
 [4.7084781e-10 1.0000000e+00 8.4549717e-14 4.0557363e-13 2.7762368e-13]
 [1.6849603e-11 1.0000000e+00 9.0204774e-15 6.0773326e-14 9.8683994e-14]
 [7.4620779e-08 9.9999988e-01 1.1177718e-12 4.2610590e-12 3.2777403e-12]] (100000, 5)
pred 3 (argmax) [0 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.680192170715332
tp :  14408.0
fp :  85592.0
tn :  314408.0
fn :  85592.0
accuracy :  0.6576353311538696
precision :  0.1440799981355667
recall :  0.1440799981355667
auc :  0.4644909203052521

y_eval {0: 100000}
pred {0: 14408, 1: 85592}
[INFO] confusion matrix for file 
[[14408 85592     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 580559 3308527       0       0       0]
 [  45591  252826       0       0       0]
 [  29325   80370       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-02_014558_119.log.part06_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:99.997%,2:0.003%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9964%,3:0.0036%]
[INFO] ** i/f_dir:[1:99.9964%,0:0.0036%]
[INFO] ** src:[22:38.0288%,9:26.1242%,7:18.2114%,1:17.6294%,21:0.003%,2:0.0008%,14:0.0006%,3:0.0006%,15:0.0004%,4:0.0004%,11:0.0002%,8:0.0002%]
[INFO] ** dst:[21:43.357%,10:20.7952%,8:18.2116%,9:17.629%,15:0.0036%,22:0.0012%,16:0.0008%,19:0.0004%,17:0.0004%,6:0.0004%,26:0.0002%,24:0.0002%]
[INFO] ** proto:[0:99.9958%,1:0.0036%,2:0.0006%]
[INFO] ** appi_name:[21:99.9942%,30:0.0036%,17:0.0008%,22:0.0004%,28:0.0002%,26:0.0002%,23:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** proxy_src_ip:[18:38.0288%,20:26.1242%,13:18.2114%,6:17.6294%,17:0.0036%,14:0.0008%,1:0.0006%,21:0.0004%,16:0.0004%,10:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9942%,-33.760870000000004:0.0058%]
[INFO] ** modbus_function_description:[7:49.9974%,11:49.9968%,0:0.0058%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.123%,1:20.7952%,5:18.211%,4:17.6288%,2:17.2336%,0:0.0084%]
[INFO] ** service:[0.0048200000000000005:99.9942%,-211.73542999999998:0.0036%,-205.44247:0.0008%,-211.07873999999998:0.0004%,-211.08818:0.0004%,-211.09762999999998:0.0002%,-211.08346:0.0002%,-185.9872:0.0002%]
[INFO] ** s_port:[1.45442:26.1234%,-0.32151:20.7952%,-1.27613:18.2112%,-0.23351:17.629%,-0.33484:17.2336%,-71.33197:0.0036%,1.45709:0.0006%,9.89942:0.0004%,-1.02014:0.0004%,-71.14931:0.0004%,-58.035180000000004:0.0002%,-5.1466400000000005:0.0002%,-0.24151:0.0002%,-5.08665:0.0002%,1.46509:0.0002%,-71.14798:0.0002%,-0.24950999999999998:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-1.27347:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** classification:[normal:81.41%,Single Stage Single Point:18.59%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7326837e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.7326837e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.7326837e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [-1.0391493e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0391493e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0391493e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 1 0 1] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[7.3658025e-17 1.0000000e+00 1.8334653e-17 3.0191293e-16 3.0920115e-16]
  [2.1012520e-10 1.0000000e+00 2.6057444e-14 1.5732824e-13 3.1936191e-13]
  [9.9921525e-01 7.8469439e-04 1.4741705e-10 8.3103135e-11 8.1453358e-11]
  ...
  [3.4017792e-11 1.0000000e+00 1.7336493e-14 8.3374917e-14 8.0438979e-14]
  [2.7749347e-09 1.0000000e+00 1.3579886e-13 8.3523141e-13 1.1909314e-12]
  [2.2318895e-08 1.0000000e+00 5.4042637e-13 1.9348171e-12 1.7336313e-12]]

 [[1.1857080e-04 9.9988139e-01 4.0495707e-11 6.2969102e-11 6.2492657e-11]
  [1.1967109e-15 1.0000000e+00 7.9711399e-17 1.1030927e-15 1.1913362e-15]
  [3.2825260e-06 9.9999666e-01 4.2156621e-12 1.1981619e-11 2.0149658e-11]
  ...
  [1.0000000e+00 1.3518812e-10 6.1254306e-14 9.3164442e-15 1.4190607e-14]
  [1.0565869e-12 1.0000000e+00 4.8158236e-15 5.2665805e-14 2.5316703e-14]
  [7.1132589e-10 1.0000000e+00 5.3760297e-14 2.2250661e-13 4.0978110e-13]]

 [[9.5604615e-17 1.0000000e+00 2.1110142e-17 3.4145507e-16 3.4757523e-16]
  [2.8219835e-10 1.0000000e+00 3.0336441e-14 1.7916460e-13 3.6374528e-13]
  [9.9971074e-01 2.8920910e-04 9.0706900e-11 4.6960567e-11 4.6268239e-11]
  ...
  [1.0000000e+00 9.3461231e-13 4.8766630e-15 5.8658165e-16 9.7260368e-16]
  [9.3513877e-12 1.0000000e+00 1.3154892e-14 1.1586195e-13 6.7267630e-14]
  [4.1673132e-10 1.0000000e+00 4.4658369e-14 1.9388871e-13 3.1681076e-13]]

 ...

 [[4.8177149e-08 1.0000000e+00 7.3749839e-13 2.2262984e-12 2.1344944e-12]
  [5.6362419e-15 1.0000000e+00 1.6756681e-16 2.0682516e-15 2.4225644e-15]
  [4.5305399e-07 9.9999952e-01 1.6311256e-12 5.2197109e-12 8.1506676e-12]
  ...
  [1.9557097e-12 1.0000000e+00 4.3563802e-15 3.7026480e-14 3.0061348e-14]
  [1.3094332e-07 9.9999988e-01 8.2193101e-13 2.7790615e-12 5.4062969e-12]
  [3.9224917e-09 1.0000000e+00 3.0069735e-13 1.4419068e-12 8.9505275e-13]]

 [[6.4418682e-17 1.0000000e+00 1.7046088e-17 2.8318958e-16 2.9113984e-16]
  [4.5724657e-10 1.0000000e+00 3.8479860e-14 2.2162899e-13 4.5723191e-13]
  [1.3306032e-09 1.0000000e+00 1.2236598e-13 5.8229528e-13 5.8431347e-13]
  ...
  [1.0000000e+00 3.0114561e-13 3.5590618e-15 4.3741628e-16 5.0004839e-16]
  [1.3938995e-12 1.0000000e+00 3.8996601e-15 3.4919028e-14 2.7166557e-14]
  [7.5692157e-08 9.9999988e-01 6.5360917e-13 2.2176018e-12 3.8133281e-12]]

 [[6.7204176e-17 1.0000000e+00 1.7443868e-17 2.8899541e-16 2.9671903e-16]
  [4.7823523e-10 1.0000000e+00 3.9377660e-14 2.2600024e-13 4.6636387e-13]
  [1.3879272e-09 1.0000000e+00 1.2513861e-13 5.9336113e-13 5.9517018e-13]
  ...
  [1.0000000e+00 3.0253076e-13 3.5724191e-15 4.3807755e-16 4.9947458e-16]
  [1.7063697e-12 1.0000000e+00 4.3333587e-15 3.8145397e-14 2.9732666e-14]
  [4.1457220e-08 1.0000000e+00 4.8503606e-13 1.7170457e-12 2.8951130e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[7.3658025e-17 1.0000000e+00 1.8334653e-17 3.0191293e-16 3.0920115e-16]
 [2.1012520e-10 1.0000000e+00 2.6057444e-14 1.5732824e-13 3.1936191e-13]
 [9.9921525e-01 7.8469439e-04 1.4741705e-10 8.3103135e-11 8.1453358e-11]
 ...
 [1.0000000e+00 3.0253076e-13 3.5724191e-15 4.3807755e-16 4.9947458e-16]
 [1.7063697e-12 1.0000000e+00 4.3333587e-15 3.8145397e-14 2.9732666e-14]
 [4.1457220e-08 1.0000000e+00 4.8503606e-13 1.7170457e-12 2.8951130e-12]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 0 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  10.394228518676758
tp :  33153.0
fp :  66847.0
tn :  333153.0
fn :  66847.0
accuracy :  0.7326146960258484
precision :  0.33153000473976135
recall :  0.33153000473976135
auc :  0.5851556658744812

y_eval {0: 67398, 1: 32602}
pred {0: 18473, 1: 81527}
[INFO] confusion matrix for file 
[[ 9512 57886     0     0     0]
 [ 8961 23641     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 590071 3366413       0       0       0]
 [  54552  276467       0       0       0]
 [  29325   80370       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0391493e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0391493e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0391493e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-3.4561479e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4561479e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-3.4561479e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [1 0 1 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[7.1662203e-17 1.0000000e+00 1.8063350e-17 2.9799286e-16 3.0541120e-16]
  [1.9657229e-10 1.0000000e+00 2.5190985e-14 1.5280161e-13 3.0988883e-13]
  [1.0000000e+00 7.1591414e-14 1.8455296e-15 2.0707373e-16 2.2440460e-16]
  ...
  [2.9089124e-08 1.0000000e+00 4.4771313e-13 2.0410032e-12 3.0064130e-12]
  [1.0000000e+00 3.2400650e-13 4.1261118e-15 4.6224515e-16 4.6394107e-16]
  [1.2410256e-12 1.0000000e+00 3.6167913e-15 3.0821635e-14 2.3651970e-14]]

 [[6.4436873e-17 1.0000000e+00 1.7048689e-17 2.8322741e-16 2.9117650e-16]
  [1.0000000e+00 1.8042555e-13 2.3048472e-15 2.8174465e-16 3.5556537e-16]
  [2.4323826e-13 1.0000000e+00 1.3867693e-15 1.3552347e-14 1.1509540e-14]
  ...
  [7.3530554e-10 1.0000000e+00 8.7898350e-14 3.9286459e-13 4.0139788e-13]
  [1.3261509e-10 1.0000000e+00 3.4955813e-14 1.8833784e-13 1.9429891e-13]
  [3.2086134e-10 1.0000000e+00 5.2377495e-14 2.9702751e-13 3.3066236e-13]]

 [[8.1429796e-08 9.9999988e-01 9.6583538e-13 2.7857005e-12 2.6769136e-12]
  [4.9154927e-15 1.0000000e+00 1.5693660e-16 1.9571658e-15 2.2758668e-15]
  [5.3204161e-07 9.9999952e-01 1.7608975e-12 5.5802819e-12 8.7712164e-12]
  ...
  [2.1062696e-12 1.0000000e+00 3.6280119e-15 2.3791417e-14 2.9281140e-14]
  [1.0000000e+00 4.2447504e-14 1.4031696e-15 1.5872775e-16 1.7714658e-16]
  [3.2304589e-12 1.0000000e+00 5.8529223e-15 4.8979379e-14 3.8972531e-14]]

 ...

 [[6.1832796e-17 1.0000000e+00 1.6671427e-17 2.7772492e-16 2.8582907e-16]
  [1.5864773e-10 1.0000000e+00 2.2580882e-14 1.3914762e-13 2.8164729e-13]
  [1.8185974e-09 1.0000000e+00 1.4156037e-13 6.5828332e-13 6.7117850e-13]
  ...
  [6.7572727e-12 1.0000000e+00 7.9573248e-15 4.8255907e-14 4.2007423e-14]
  [1.3494764e-08 1.0000000e+00 2.7906879e-13 1.4113583e-12 2.3642839e-12]
  [1.6154322e-08 1.0000000e+00 5.3694332e-13 2.1531978e-12 1.5638173e-12]]

 [[1.8268986e-10 1.0000000e+00 4.1750539e-14 2.0536268e-13 1.9281408e-13]
  [4.0094623e-14 1.0000000e+00 4.3035558e-16 4.5798733e-15 5.9317722e-15]
  [9.3579359e-08 9.9999988e-01 7.8779881e-13 2.7615664e-12 3.9410606e-12]
  ...
  [6.4526206e-12 1.0000000e+00 6.5272647e-15 4.1550107e-14 5.0835678e-14]
  [1.0000000e+00 3.0007111e-13 3.5140968e-15 4.5164406e-16 5.2858366e-16]
  [1.1719489e-12 1.0000000e+00 3.5903296e-15 3.3116779e-14 2.5400670e-14]]

 [[1.0000000e+00 1.2911761e-09 2.3866103e-13 6.4849025e-14 5.7761040e-14]
  [9.9154729e-01 8.4526855e-03 5.8639266e-10 4.0944695e-10 2.3310590e-10]
  [5.5537519e-15 1.0000000e+00 1.7215151e-16 1.9674585e-15 2.2743307e-15]
  ...
  [8.2114302e-06 9.9999177e-01 7.2371124e-12 1.9091050e-11 3.2141716e-11]
  [3.7642506e-10 1.0000000e+00 7.3025285e-14 3.8822683e-13 3.4181203e-13]
  [1.9339474e-11 1.0000000e+00 1.3109130e-14 7.6476436e-14 7.1493707e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[7.1662203e-17 1.0000000e+00 1.8063350e-17 2.9799286e-16 3.0541120e-16]
 [1.9657229e-10 1.0000000e+00 2.5190985e-14 1.5280161e-13 3.0988883e-13]
 [1.0000000e+00 7.1591414e-14 1.8455296e-15 2.0707373e-16 2.2440460e-16]
 ...
 [8.2114302e-06 9.9999177e-01 7.2371124e-12 1.9091050e-11 3.2141716e-11]
 [3.7642506e-10 1.0000000e+00 7.3025285e-14 3.8822683e-13 3.4181203e-13]
 [1.9339474e-11 1.0000000e+00 1.3109130e-14 7.6476436e-14 7.1493707e-14]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  9.528793913269043
tp :  38880.0
fp :  61120.0
tn :  338880.0
fn :  61120.0
accuracy :  0.7555224895477295
precision :  0.3887999951839447
recall :  0.3887999951839447
auc :  0.6214051246643066

y_eval {0: 53052, 1: 46948}
pred {0: 16220, 1: 83780}
[INFO] confusion matrix for file 
[[ 4076 48976     0     0     0]
 [12144 34804     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 594147 3415389       0       0       0]
 [  66696  311271       0       0       0]
 [  29325   80370       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4561479e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4561479e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4561479e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 3.4537926e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 3.4537926e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 3.4537926e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 1 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.79883171e-17 1.00000000e+00 1.75520017e-17 2.90541830e-16
   2.98278338e-16]
  [3.66101205e-10 1.00000000e+00 3.44450014e-14 2.01102345e-13
   4.12411750e-13]
  [1.34402756e-09 1.00000000e+00 1.22384416e-13 5.81501752e-13
   5.86827570e-13]
  ...
  [7.12703567e-08 9.99999881e-01 6.11460047e-13 2.11641360e-12
   3.79546351e-12]
  [2.36062858e-09 1.00000000e+00 2.05868593e-13 1.01088842e-12
   7.68786673e-13]
  [5.80224584e-12 1.00000000e+00 6.72960900e-15 4.19488154e-14
   4.25889386e-14]]

 [[2.37701026e-10 1.00000000e+00 4.78287149e-14 2.29883007e-13
   2.16003715e-13]
  [3.48014735e-14 1.00000000e+00 4.01614743e-16 4.31845730e-15
   5.56030204e-15]
  [1.02363828e-07 9.99999881e-01 8.20629263e-13 2.86321791e-12
   4.11004694e-12]
  ...
  [5.53103223e-12 1.00000000e+00 5.99110300e-15 3.81487444e-14
   4.66344933e-14]
  [1.22263408e-08 1.00000000e+00 3.53239221e-13 1.67549254e-12
   1.80026545e-12]
  [8.60584104e-11 1.00000000e+00 2.77357838e-14 1.46592347e-13
   1.57473549e-13]]

 [[2.54051780e-10 1.00000000e+00 4.94998634e-14 2.36528841e-13
   2.22293240e-13]
  [1.00000000e+00 4.35527836e-10 1.08911591e-13 2.40461642e-14
   2.55770001e-14]
  [7.26795739e-14 1.00000000e+00 7.32844647e-16 7.65458677e-15
   7.23365544e-15]
  ...
  [9.48838306e-08 9.99999881e-01 1.14006135e-12 3.80745609e-12
   3.39266028e-12]
  [8.09086825e-12 1.00000000e+00 7.33930501e-15 4.29807218e-14
   5.44181840e-14]
  [1.00000000e+00 5.43141053e-13 4.86815034e-15 6.74698165e-16
   7.35861673e-16]]

 ...

 [[6.83891622e-17 1.00000000e+00 1.76107530e-17 2.91432088e-16
   2.99066740e-16]
  [1.00000000e+00 3.70786779e-08 9.80151073e-13 4.00497018e-13
   3.60455047e-13]
  [1.02205208e-15 1.00000000e+00 6.83709047e-17 9.06061509e-16
   1.09890116e-15]
  ...
  [1.17538468e-09 1.00000000e+00 1.35415794e-13 6.38284456e-13
   4.41888171e-13]
  [1.41098765e-11 1.00000000e+00 8.36797994e-15 5.35911681e-14
   8.52632513e-14]
  [7.26038607e-08 9.99999881e-01 1.08823801e-12 4.23560752e-12
   3.31975680e-12]]

 [[6.18884888e-17 1.00000000e+00 1.66796322e-17 2.77845733e-16
   2.85944665e-16]
  [9.99994516e-01 5.48174103e-06 6.11615663e-12 2.89318157e-12
   7.13960922e-12]
  [2.14484923e-11 1.00000000e+00 1.65606241e-14 1.13860053e-13
   1.06327599e-13]
  ...
  [2.28349222e-06 9.99997735e-01 3.51645427e-12 1.15257439e-11
   2.21151552e-11]
  [5.23064436e-09 1.00000000e+00 3.22160267e-13 1.46349935e-12
   1.04184608e-12]
  [1.87765840e-12 1.00000000e+00 3.61327484e-15 2.37250303e-14
   2.56190367e-14]]

 [[6.84356167e-17 1.00000000e+00 1.76172034e-17 2.91525474e-16
   2.99158034e-16]
  [1.80149701e-10 1.00000000e+00 2.40973572e-14 1.47079668e-13
   2.97995596e-13]
  [1.00000000e+00 3.83963611e-10 1.18242493e-13 2.32652591e-14
   2.56687321e-14]
  ...
  [4.05810452e-09 1.00000000e+00 1.65639800e-13 8.97911682e-13
   1.26861542e-12]
  [3.49639695e-09 1.00000000e+00 2.10792836e-13 8.87487946e-13
   8.04902802e-13]
  [1.03664542e-11 1.00000000e+00 8.88815134e-15 5.48875859e-14
   6.15637573e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.7988317e-17 1.0000000e+00 1.7552002e-17 2.9054183e-16 2.9827834e-16]
 [3.6610120e-10 1.0000000e+00 3.4445001e-14 2.0110235e-13 4.1241175e-13]
 [1.3440276e-09 1.0000000e+00 1.2238442e-13 5.8150175e-13 5.8682757e-13]
 ...
 [4.0581045e-09 1.0000000e+00 1.6563980e-13 8.9791168e-13 1.2686154e-12]
 [3.4963969e-09 1.0000000e+00 2.1079284e-13 8.8748795e-13 8.0490280e-13]
 [1.0366454e-11 1.0000000e+00 8.8881513e-15 5.4887586e-14 6.1563757e-14]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  12.383023431396484
tp :  21879.0
fp :  78121.0
tn :  321879.0
fn :  78121.0
accuracy :  0.6875190734863281
precision :  0.2187899947166443
recall :  0.2187899947166443
auc :  0.5120930671691895

y_eval {0: 86600, 1: 13400}
pred {0: 15091, 1: 84909}
[INFO] confusion matrix for file 
[[11785 74815     0     0     0]
 [ 3306 10094     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 605932 3490204       0       0       0]
 [  70002  321365       0       0       0]
 [  29325   80370       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4537926e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4537926e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4537926e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [ 1.0389137e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.0389137e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0389137e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.4140868e-17 1.0000000e+00 1.7006403e-17 2.8261440e-16 2.9057399e-16]
  [9.9999595e-01 4.0632449e-06 5.2963623e-12 2.4386127e-12 6.0084594e-12]
  [1.2845572e-11 1.0000000e+00 1.2649439e-14 9.0788576e-14 8.4420806e-14]
  ...
  [1.0000000e+00 8.9199188e-13 6.2392510e-15 9.5696247e-16 1.0196027e-15]
  [8.1547410e-13 1.0000000e+00 2.7560375e-15 2.4970645e-14 2.1553404e-14]
  [9.0098126e-08 9.9999988e-01 7.4086505e-13 2.5711484e-12 4.1571152e-12]]

 [[6.1888959e-17 1.0000000e+00 1.6679697e-17 2.7784573e-16 2.8594578e-16]
  [6.5431749e-03 9.9345678e-01 3.8971881e-10 1.1939244e-09 7.1171563e-10]
  [1.9392034e-15 1.0000000e+00 8.2784679e-17 9.4304307e-16 1.5066624e-15]
  ...
  [3.8972203e-08 1.0000000e+00 7.0571516e-13 3.0646627e-12 3.3184152e-12]
  [2.7657430e-11 1.0000000e+00 1.8184368e-14 1.0687067e-13 8.2489428e-14]
  [2.9357533e-10 1.0000000e+00 4.0059766e-14 2.3492777e-13 3.7023390e-13]]

 [[1.0000000e+00 3.9573618e-12 1.5727955e-14 2.9343574e-15 2.4351282e-15]
  [8.5469228e-01 1.4530776e-01 2.0894695e-09 2.1231876e-09 1.2358911e-09]
  [9.9999964e-01 4.1178524e-07 2.6339590e-12 8.6458412e-13 1.2502459e-12]
  ...
  [1.5032798e-07 9.9999988e-01 9.7389328e-13 4.4781154e-12 7.5267587e-12]
  [3.3418708e-09 1.0000000e+00 2.3639489e-13 1.0562766e-12 7.5315237e-13]
  [2.3480963e-12 1.0000000e+00 3.6028284e-15 2.3458645e-14 3.1931607e-14]]

 ...

 [[6.1824538e-17 1.0000000e+00 1.6670219e-17 2.7770693e-16 2.8581163e-16]
  [1.5571250e-10 1.0000000e+00 2.2371506e-14 1.3802817e-13 2.7923437e-13]
  [1.7083588e-09 1.0000000e+00 1.3698538e-13 6.4014375e-13 6.5290893e-13]
  ...
  [1.0000000e+00 1.5367826e-08 6.4147602e-13 1.8349314e-13 2.2960258e-13]
  [2.8549060e-13 1.0000000e+00 1.8235414e-15 1.8502710e-14 1.4021189e-14]
  [1.3955571e-08 1.0000000e+00 2.8882284e-13 1.0915581e-12 1.6036281e-12]]

 [[6.7392357e-17 1.0000000e+00 1.7470839e-17 2.8939918e-16 2.9710184e-16]
  [1.5126728e-10 1.0000000e+00 2.2070504e-14 1.3625548e-13 2.7509459e-13]
  [1.3366113e-09 1.0000000e+00 1.2049897e-13 5.7389781e-13 5.8553173e-13]
  ...
  [1.8231784e-09 1.0000000e+00 1.3139251e-13 6.0228921e-13 7.3810066e-13]
  [1.0168048e-10 1.0000000e+00 3.7535032e-14 2.1506190e-13 1.5683329e-13]
  [9.9999928e-01 7.0914274e-07 3.1381748e-12 1.0998394e-12 2.1341997e-12]]

 [[6.1861106e-17 1.0000000e+00 1.6675625e-17 2.7778639e-16 2.8588797e-16]
  [2.3364607e-10 1.0000000e+00 2.7489409e-14 1.6554190e-13 3.3609514e-13]
  [1.8604002e-09 1.0000000e+00 1.4346665e-13 6.6405150e-13 6.7805082e-13]
  ...
  [2.4418585e-11 1.0000000e+00 1.6117617e-14 8.8647073e-14 7.2312450e-14]
  [1.7549395e-09 1.0000000e+00 9.7026635e-14 5.5243451e-13 9.3047683e-13]
  [3.9915964e-08 1.0000000e+00 8.4798477e-13 3.1850618e-12 2.3156199e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.4140868e-17 1.0000000e+00 1.7006403e-17 2.8261440e-16 2.9057399e-16]
 [9.9999595e-01 4.0632449e-06 5.2963623e-12 2.4386127e-12 6.0084594e-12]
 [1.2845572e-11 1.0000000e+00 1.2649439e-14 9.0788576e-14 8.4420806e-14]
 ...
 [2.4418585e-11 1.0000000e+00 1.6117617e-14 8.8647073e-14 7.2312450e-14]
 [1.7549395e-09 1.0000000e+00 9.7026635e-14 5.5243451e-13 9.3047683e-13]
 [3.9915964e-08 1.0000000e+00 8.4798477e-13 3.1850618e-12 2.3156199e-12]] (100000, 5)
pred 3 (argmax) [1 0 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.624038613891601
tp :  14554.0
fp :  85446.0
tn :  314554.0
fn :  85446.0
accuracy :  0.6582192778587341
precision :  0.1455399990081787
recall :  0.1455399990081787
auc :  0.46622416377067566

y_eval {0: 100000}
pred {0: 14554, 1: 85446}
[INFO] confusion matrix for file 
[[14554 85446     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 620486 3575650       0       0       0]
 [  70002  321365       0       0       0]
 [  29325   80370       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0389137e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0389137e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.0389137e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 1.7324482e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.7324482e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.7324482e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99999881e-01 8.01817208e-08 1.63378523e-12 5.46912450e-13
   5.26016784e-13]
  [2.00648049e-12 1.00000000e+00 6.17169169e-15 6.14737550e-14
   2.91754400e-14]
  [4.06621766e-16 1.00000000e+00 3.71167852e-17 4.99215490e-16
   7.24447692e-16]
  ...
  [1.57485431e-11 1.00000000e+00 1.30184568e-14 8.89246291e-14
   7.58034721e-14]
  [4.72635403e-11 1.00000000e+00 1.76677063e-14 1.09972422e-13
   1.43248179e-13]
  [9.64816893e-10 1.00000000e+00 1.09429244e-13 5.61837686e-13
   5.04894737e-13]]

 [[6.74445617e-17 1.00000000e+00 1.74782387e-17 2.89506279e-16
   2.97205015e-16]
  [9.99656320e-01 3.43656749e-04 4.43314274e-11 2.95342500e-11
   7.53368340e-11]
  [3.89495519e-11 1.00000000e+00 2.27691435e-14 1.48738199e-13
   1.39044944e-13]
  ...
  [3.32463742e-07 9.99999642e-01 2.12228238e-12 9.45515714e-12
   8.62022433e-12]
  [3.92594568e-11 1.00000000e+00 1.62983403e-14 8.29531349e-14
   1.09168032e-13]
  [1.00000000e+00 1.29191258e-09 2.20431285e-13 5.35847273e-14
   5.80968176e-14]]

 [[6.32841476e-17 1.00000000e+00 1.68825578e-17 2.80806854e-16
   2.88824577e-16]
  [9.99095917e-01 9.04044311e-04 1.93155505e-10 2.52284832e-10
   1.33591166e-10]
  [7.45348548e-16 1.00000000e+00 5.57786548e-17 7.40784893e-16
   9.63195893e-16]
  ...
  [1.57674336e-07 9.99999881e-01 8.92526179e-13 2.97034424e-12
   5.33277372e-12]
  [1.19783805e-09 1.00000000e+00 1.38728926e-13 7.13674454e-13
   6.03351624e-13]
  [5.74368938e-12 1.00000000e+00 7.22336992e-15 4.59588896e-14
   4.10357309e-14]]

 ...

 [[9.99999762e-01 1.80553783e-07 2.37477746e-12 8.35938794e-13
   8.19732737e-13]
  [1.88308380e-13 1.00000000e+00 1.67839420e-15 1.93241792e-14
   1.02989576e-14]
  [8.58847045e-16 1.00000000e+00 5.38071989e-17 6.89174329e-16
   1.02569221e-15]
  ...
  [3.95440258e-09 1.00000000e+00 2.61346581e-13 1.26862019e-12
   1.02429014e-12]
  [3.41407566e-12 1.00000000e+00 5.40040424e-15 3.49336852e-14
   3.29855907e-14]
  [2.48651988e-09 1.00000000e+00 1.31670472e-13 7.54309701e-13
   1.04802256e-12]]

 [[1.00000000e+00 4.44520598e-09 4.26169137e-13 1.21393808e-13
   1.11159922e-13]
  [5.79193049e-08 1.00000000e+00 1.43516535e-12 6.54260587e-12
   2.52770678e-12]
  [1.00000000e+00 2.52026311e-09 2.26237445e-13 4.80541171e-14
   7.25978251e-14]
  ...
  [7.49671505e-12 1.00000000e+00 7.46945671e-15 5.38049186e-14
   5.90586675e-14]
  [9.99999166e-01 7.91998787e-07 4.49238997e-12 1.82924184e-12
   2.30282742e-12]
  [1.23245286e-13 1.00000000e+00 1.26466349e-15 1.41694839e-14
   9.52170912e-15]]

 [[6.53523109e-17 1.00000000e+00 1.71796513e-17 2.85134266e-16
   2.93027316e-16]
  [2.94118072e-04 9.99705851e-01 8.51456822e-11 3.37838535e-10
   1.86836394e-10]
  [8.44751623e-16 1.00000000e+00 5.54688624e-17 6.86592254e-16
   1.01177609e-15]
  ...
  [1.00000000e+00 2.97420977e-09 2.96545774e-13 7.54945490e-14
   9.26237304e-14]
  [1.51287240e-13 1.00000000e+00 1.31952423e-15 1.43010874e-14
   1.05159572e-14]
  [1.65509793e-08 1.00000000e+00 3.01462251e-13 1.13369492e-12
   1.80640854e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999988e-01 8.0181721e-08 1.6337852e-12 5.4691245e-13 5.2601678e-13]
 [2.0064805e-12 1.0000000e+00 6.1716917e-15 6.1473755e-14 2.9175440e-14]
 [4.0662177e-16 1.0000000e+00 3.7116785e-17 4.9921549e-16 7.2444769e-16]
 ...
 [1.0000000e+00 2.9742098e-09 2.9654577e-13 7.5494549e-14 9.2623730e-14]
 [1.5128724e-13 1.0000000e+00 1.3195242e-15 1.4301087e-14 1.0515957e-14]
 [1.6550979e-08 1.0000000e+00 3.0146225e-13 1.1336949e-12 1.8064085e-12]] (100000, 5)
pred 3 (argmax) [0 1 1 ... 0 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.681489140319824
tp :  14351.0
fp :  85649.0
tn :  314351.0
fn :  85649.0
accuracy :  0.6574073433876038
precision :  0.14350999891757965
recall :  0.14350999891757965
auc :  0.46404552459716797

y_eval {0: 100000}
pred {0: 14351, 1: 85649}
[INFO] confusion matrix for file 
[[14351 85649     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 634837 3661299       0       0       0]
 [  70002  321365       0       0       0]
 [  29325   80370       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-02_121729_121.log.part12_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1368 (0.2736%)
[INFO] ** orig:[0:99.9986%,1:0.0008%,2:0.0006%]
[INFO] ** type:[0:99.9984%,1:0.0014%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9978%,3:0.0022%]
[INFO] ** i/f_dir:[1:99.998%,0:0.002%]
[INFO] ** src:[22:38.1136%,9:26.1176%,7:18.2158%,1:17.5472%,14:0.0016%,11:0.0014%,10:0.001%,21:0.0006%,15:0.0004%,2:0.0004%,4:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.4022%,10:20.8284%,8:18.2156%,9:17.547%,15:0.0022%,22:0.002%,6:0.0008%,26:0.0004%,25:0.0004%,19:0.0004%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.996%,1:0.0022%,2:0.0018%]
[INFO] ** appi_name:[21:99.9946%,30:0.0022%,22:0.0006%,26:0.0004%,0:0.0004%,31:0.0002%,27:0.0002%,24:0.0002%,23:0.0002%,18:0.0002%,16:0.0002%,15:0.0002%,14:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.1136%,20:26.1176%,13:18.2158%,6:17.5472%,17:0.0022%,10:0.0014%,11:0.001%,16:0.0004%,14:0.0004%,21:0.0002%,1:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9946%,-33.760870000000004:0.0052%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9984%,11:49.9962%,0:0.0052%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1164%,1:20.8284%,5:18.2154%,4:17.5466%,2:17.285%,0:0.0082%]
[INFO] ** service:[0.0048200000000000005:99.9954%,-211.73542999999998:0.0022%,-211.08818:0.0006%,-186.44547:0.0004%,-211.08346:0.0004%,-211.07873999999998:0.0004%,-186.42657:0.0002%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.1168%,-0.32151:20.8284%,-1.27613:18.2154%,-0.23351:17.5468%,-0.33484:17.2852%,-71.33197:0.0022%,-10.59042:0.0008%,-71.14931:0.0006%,-64.19493:0.0004%,-1.02014:0.0004%,-0.24151:0.0004%,-71.14798:0.0004%,1.45709:0.0004%,10.54739:0.0004%,1.47576:0.0002%,1.46509:0.0002%,-1.27347:0.0002%,-68.79874000000001:0.0002%,13.34061:0.0002%,-1.2708:0.0002%,15.264529999999999:0.0002%]
[INFO] ** classification:[normal:99.9996%,Single Stage Multi Point:0.0004%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7332737e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.7332737e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.7332737e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-1.0409675e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0409675e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0409675e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.0000000e+00 2.4429368e-13 4.2195954e-15 6.5252951e-16 5.2004345e-16]
  [9.9069428e-01 9.3056504e-03 5.2731575e-10 4.5160092e-10 3.2276185e-10]
  [4.1998773e-14 1.0000000e+00 5.8371327e-16 6.2264354e-15 5.4100130e-15]
  ...
  [1.9700583e-05 9.9998033e-01 1.2839121e-11 3.7175329e-11 5.8084908e-11]
  [1.3279916e-09 1.0000000e+00 1.4626614e-13 6.6429219e-13 4.9398213e-13]
  [6.1799233e-12 1.0000000e+00 6.2210462e-15 4.1720289e-14 5.1373632e-14]]

 [[3.3977348e-02 9.6602261e-01 7.2091483e-10 7.0994927e-10 7.2120088e-10]
  [9.9999821e-01 1.8422323e-06 7.2949502e-12 3.1220100e-12 3.0844962e-12]
  [6.0162591e-12 1.0000000e+00 8.9568364e-15 7.2345145e-14 5.1344833e-14]
  ...
  [1.1776141e-11 1.0000000e+00 1.3623852e-14 1.0867338e-13 7.0413768e-14]
  [1.3426158e-09 1.0000000e+00 8.1390427e-14 3.3602334e-13 5.5610079e-13]
  [2.2870015e-08 1.0000000e+00 5.7548064e-13 2.4309461e-12 2.2821081e-12]]

 [[7.5386369e-17 1.0000000e+00 1.8566846e-17 3.0526329e-16 3.1243803e-16]
  [3.1315611e-10 1.0000000e+00 3.1849855e-14 1.8739795e-13 3.8332494e-13]
  [1.0000000e+00 1.4870373e-15 2.8942348e-16 2.5446504e-17 2.6522934e-17]
  ...
  [3.7275777e-06 9.9999630e-01 5.4042981e-12 1.8235557e-11 2.7014687e-11]
  [4.2096782e-10 1.0000000e+00 7.5253456e-14 3.7888941e-13 3.2904422e-13]
  [4.3814133e-11 1.0000000e+00 1.9345643e-14 1.1049427e-13 1.1378536e-13]]

 ...

 [[7.7886281e-17 1.0000000e+00 1.8893652e-17 3.0990138e-16 3.1704602e-16]
  [2.5613958e-10 1.0000000e+00 2.8807611e-14 1.7161706e-13 3.4931238e-13]
  [5.9492171e-09 1.0000000e+00 2.6330644e-13 1.1124673e-12 1.1301802e-12]
  ...
  [1.5617069e-12 1.0000000e+00 4.6870331e-15 4.4797343e-14 2.8438884e-14]
  [2.0002254e-08 1.0000000e+00 2.9690063e-13 1.0584910e-12 2.1130094e-12]
  [1.0284895e-08 1.0000000e+00 4.7353094e-13 2.1587985e-12 1.4870678e-12]]

 [[1.0000000e+00 7.7775772e-11 6.3584791e-14 1.4396108e-14 1.2404162e-14]
  [9.9981672e-01 1.8325924e-04 8.0208208e-11 4.7752302e-11 3.2867379e-11]
  [8.2320034e-13 1.0000000e+00 2.3397324e-15 1.7619146e-14 2.0396858e-14]
  ...
  [1.6306108e-11 1.0000000e+00 2.0047378e-14 1.7953096e-13 9.0095805e-14]
  [1.0155779e-10 1.0000000e+00 2.1933446e-14 9.8958615e-14 1.4910917e-13]
  [6.9538157e-07 9.9999928e-01 2.7913368e-12 1.0522506e-11 1.3269791e-11]]

 [[7.7682133e-17 1.0000000e+00 1.8866860e-17 3.0951622e-16 3.1667253e-16]
  [1.0000000e+00 1.5730800e-11 1.9120878e-14 3.4566081e-15 4.4624457e-15]
  [3.5065328e-14 1.0000000e+00 4.7319797e-16 5.1008633e-15 5.2657743e-15]
  ...
  [1.1814178e-06 9.9999881e-01 2.5394417e-12 7.2019938e-12 1.3251169e-11]
  [5.6530221e-09 1.0000000e+00 3.2557629e-13 1.4678465e-12 1.1388965e-12]
  [2.5640475e-12 1.0000000e+00 4.5623833e-15 3.0378711e-14 2.8854848e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.0000000e+00 2.4429368e-13 4.2195954e-15 6.5252951e-16 5.2004345e-16]
 [9.9069428e-01 9.3056504e-03 5.2731575e-10 4.5160092e-10 3.2276185e-10]
 [4.1998773e-14 1.0000000e+00 5.8371327e-16 6.2264354e-15 5.4100130e-15]
 ...
 [1.1814178e-06 9.9999881e-01 2.5394417e-12 7.2019938e-12 1.3251169e-11]
 [5.6530221e-09 1.0000000e+00 3.2557629e-13 1.4678465e-12 1.1388965e-12]
 [2.5640475e-12 1.0000000e+00 4.5623833e-15 3.0378711e-14 2.8854848e-14]] (100000, 5)
pred 3 (argmax) [0 0 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  12.786370036315917
tp :  18413.0
fp :  81587.0
tn :  318413.0
fn :  81587.0
accuracy :  0.6736552119255066
precision :  0.184129998087883
recall :  0.184129998087883
auc :  0.49029284715652466

y_eval {0: 100000}
pred {0: 18413, 1: 81587}
[INFO] confusion matrix for file 
[[18413 81587     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 653250 3742886       0       0       0]
 [  70002  321365       0       0       0]
 [  29325   80370       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0409675e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.0409675e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0409675e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-3.4612519e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4612519e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4612519e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.4302559e-17 1.0000000e+00 1.7029449e-17 2.8294664e-16 2.9090338e-16]
  [1.8849733e-10 1.0000000e+00 2.4635801e-14 1.5007212e-13 3.0460535e-13]
  [1.0000000e+00 3.6198922e-14 1.3300358e-15 1.4310022e-16 1.5424735e-16]
  ...
  [3.7487965e-07 9.9999964e-01 1.7831097e-12 6.8886528e-12 9.3102730e-12]
  [3.2596639e-10 1.0000000e+00 6.3733652e-14 3.2056112e-13 2.8356622e-13]
  [1.2109815e-11 1.0000000e+00 9.6720973e-15 6.3046424e-14 6.8142398e-14]]

 [[4.1158145e-07 9.9999964e-01 2.2197678e-12 5.5661235e-12 5.3871707e-12]
  [4.1283789e-15 1.0000000e+00 1.4553793e-16 1.8419917e-15 2.1035163e-15]
  [6.7059852e-07 9.9999928e-01 1.9660946e-12 6.1209124e-12 9.6774195e-12]
  ...
  [3.5189985e-12 1.0000000e+00 5.8667365e-15 4.7464836e-14 3.8621331e-14]
  [7.5022655e-08 9.9999988e-01 6.2012087e-13 2.1886579e-12 4.2679974e-12]
  [5.1384541e-09 1.0000000e+00 3.4897207e-13 1.6373386e-12 9.9154029e-13]]

 [[6.4314087e-17 1.0000000e+00 1.7031009e-17 2.8297039e-16 2.9092670e-16]
  [1.0000000e+00 2.0648434e-10 6.6407776e-14 1.5259417e-14 1.9210074e-14]
  [2.1200801e-14 1.0000000e+00 3.5201056e-16 3.8440668e-15 4.3140942e-15]
  ...
  [1.0000000e+00 3.7867086e-15 4.5739869e-16 4.2045835e-17 4.3216336e-17]
  [6.2161452e-12 1.0000000e+00 7.8268191e-15 6.0876583e-14 5.0244859e-14]
  [5.7950245e-08 1.0000000e+00 5.5206794e-13 1.9472566e-12 3.7000819e-12]]

 ...

 [[2.0900530e-09 1.0000000e+00 1.4675125e-13 5.8275531e-13 5.5163220e-13]
  [1.6024891e-14 1.0000000e+00 2.7716927e-16 3.1615971e-15 3.9042002e-15]
  [1.8763561e-07 9.9999976e-01 1.0845454e-12 3.6495737e-12 5.4219719e-12]
  ...
  [1.9435905e-12 1.0000000e+00 3.5605962e-15 2.4390432e-14 2.9094250e-14]
  [1.6318952e-08 1.0000000e+00 4.0096859e-13 1.9021629e-12 2.0739868e-12]
  [2.9984787e-10 1.0000000e+00 5.2019675e-14 2.4659601e-13 2.7778786e-13]]

 [[2.2538253e-09 1.0000000e+00 1.5256690e-13 6.0185282e-13 5.6987282e-13]
  [9.9999988e-01 1.5533304e-07 2.0506843e-12 7.6739483e-13 7.0039677e-13]
  [8.0527202e-15 1.0000000e+00 2.2306038e-16 2.6786921e-15 2.7836889e-15]
  ...
  [5.3056965e-08 1.0000000e+00 9.3901677e-13 3.4280003e-12 2.6153472e-12]
  [1.0000000e+00 1.3774784e-09 1.7273031e-13 3.0894500e-14 5.3230844e-14]
  [9.7170774e-13 1.0000000e+00 4.9309489e-15 5.6949332e-14 2.5366828e-14]]

 [[6.7530807e-17 1.0000000e+00 1.7487842e-17 2.8961123e-16 2.9737511e-16]
  [4.0126683e-10 1.0000000e+00 3.6063915e-14 2.0933403e-13 4.3019622e-13]
  [1.0000000e+00 5.1909090e-13 4.8493195e-15 6.1052568e-16 6.6074033e-16]
  ...
  [1.8759320e-07 9.9999976e-01 9.2299963e-13 3.2417658e-12 6.8638658e-12]
  [2.0101925e-08 1.0000000e+00 7.1146452e-13 3.0426176e-12 1.8616822e-12]
  [3.9159875e-13 1.0000000e+00 1.5567796e-15 1.1539259e-14 1.2994096e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.4302559e-17 1.0000000e+00 1.7029449e-17 2.8294664e-16 2.9090338e-16]
 [1.8849733e-10 1.0000000e+00 2.4635801e-14 1.5007212e-13 3.0460535e-13]
 [1.0000000e+00 3.6198922e-14 1.3300358e-15 1.4310022e-16 1.5424735e-16]
 ...
 [1.8759320e-07 9.9999976e-01 9.2299963e-13 3.2417658e-12 6.8638658e-12]
 [2.0101925e-08 1.0000000e+00 7.1146452e-13 3.0426176e-12 1.8616822e-12]
 [3.9159875e-13 1.0000000e+00 1.5567796e-15 1.1539259e-14 1.2994096e-14]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.128683294677735
tp :  16297.0
fp :  83703.0
tn :  316297.0
fn :  83703.0
accuracy :  0.6651912331581116
precision :  0.16297000646591187
recall :  0.16297000646591187
auc :  0.4779526889324188

y_eval {0: 100000}
pred {0: 16297, 1: 83703}
[INFO] confusion matrix for file 
[[16297 83703     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 669547 3826589       0       0       0]
 [  70002  321365       0       0       0]
 [  29325   80370       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.461252e-01  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 [-3.461252e-01  0.000000e+00  0.000000e+00 ...  2.000000e+00
   4.820000e-03 -3.348400e-01]
 [-3.461252e-01  0.000000e+00  0.000000e+00 ...  3.000000e+00
   4.820000e-03  1.454420e+00]
 ...
 [ 3.461811e-01  0.000000e+00  0.000000e+00 ...  1.000000e+00
   4.820000e-03 -3.215100e-01]
 [ 3.461811e-01  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 [ 3.461811e-01  0.000000e+00  0.000000e+00 ...  3.000000e+00
   4.820000e-03  1.454420e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.4371030e-17 1.0000000e+00 1.7039522e-17 2.8309887e-16 2.9104214e-16]
  [3.3301231e-10 1.0000000e+00 3.2788628e-14 1.9261484e-13 3.9550053e-13]
  [4.4739905e-09 1.0000000e+00 2.2872139e-13 9.8955837e-13 9.9722639e-13]
  ...
  [8.1754742e-08 9.9999988e-01 6.5064881e-13 2.2674297e-12 4.1871155e-12]
  [3.2339531e-09 1.0000000e+00 2.5192535e-13 1.2155999e-12 8.6395474e-13]
  [1.1403942e-12 1.0000000e+00 2.8266629e-15 2.0076460e-14 2.1096487e-14]]

 [[7.0828127e-17 1.0000000e+00 1.7948985e-17 2.9633670e-16 3.0380997e-16]
  [3.0735345e-10 1.0000000e+00 3.1527827e-14 1.8589137e-13 3.8051458e-13]
  [1.3659351e-09 1.0000000e+00 1.2333865e-13 5.8594514e-13 5.9070294e-13]
  ...
  [2.9498430e-09 1.0000000e+00 2.0182513e-13 9.1970312e-13 8.5037706e-13]
  [1.4853594e-11 1.0000000e+00 1.1985115e-14 7.4666402e-14 6.7239285e-14]
  [1.0235847e-09 1.0000000e+00 8.1423339e-14 4.3430277e-13 6.2183949e-13]]

 [[6.1829726e-17 1.0000000e+00 1.6670982e-17 2.7771857e-16 2.8582253e-16]
  [1.5843213e-10 1.0000000e+00 2.2565468e-14 1.3906484e-13 2.8147114e-13]
  [1.7843106e-09 1.0000000e+00 1.4016677e-13 6.5278192e-13 6.6556038e-13]
  ...
  [6.0501595e-12 1.0000000e+00 7.3359465e-15 4.5250506e-14 4.0972227e-14]
  [1.7618426e-08 1.0000000e+00 3.2749021e-13 1.6029982e-12 2.6076962e-12]
  [9.4398587e-09 1.0000000e+00 4.0442728e-13 1.6814921e-12 1.2354213e-12]]

 ...

 [[6.1890137e-17 1.0000000e+00 1.6679824e-17 2.7784785e-16 2.8594795e-16]
  [1.8879598e-10 1.0000000e+00 2.4655733e-14 1.5031505e-13 3.0499718e-13]
  [3.6433205e-09 1.0000000e+00 2.0339448e-13 8.9485640e-13 9.1187951e-13]
  ...
  [6.6655268e-09 1.0000000e+00 2.7811019e-13 1.1578403e-12 1.2607805e-12]
  [1.7104601e-11 1.0000000e+00 1.4231915e-14 9.1813750e-14 7.1740404e-14]
  [1.6418092e-10 1.0000000e+00 3.0252425e-14 1.7555385e-13 2.6441262e-13]]

 [[6.3781468e-17 1.0000000e+00 1.6954453e-17 2.8185429e-16 2.8984223e-16]
  [9.9999988e-01 1.1931601e-07 9.8894319e-13 3.3780978e-13 8.0040629e-13]
  [5.1041411e-12 1.0000000e+00 7.7586558e-15 6.0350786e-14 5.5307945e-14]
  ...
  [2.6964364e-07 9.9999976e-01 2.0120062e-12 8.5070015e-12 7.1966729e-12]
  [1.0000000e+00 1.7952285e-08 6.3032142e-13 1.1921444e-13 1.8586017e-13]
  [3.7577314e-13 1.0000000e+00 2.7056193e-15 2.9968832e-14 1.5514743e-14]]

 [[6.1837045e-17 1.0000000e+00 1.6672063e-17 2.7773339e-16 2.8583778e-16]
  [1.5721989e-10 1.0000000e+00 2.2479123e-14 1.3860249e-13 2.8047755e-13]
  [1.8603008e-09 1.0000000e+00 1.4320419e-13 6.6473574e-13 6.7794479e-13]
  ...
  [6.5586988e-08 9.9999988e-01 5.8549709e-13 2.0421674e-12 3.6136109e-12]
  [2.0653645e-09 1.0000000e+00 1.8697272e-13 9.2354932e-13 7.3763760e-13]
  [8.9223906e-12 1.0000000e+00 8.6053635e-15 5.1927185e-14 5.0872341e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.4371030e-17 1.0000000e+00 1.7039522e-17 2.8309887e-16 2.9104214e-16]
 [3.3301231e-10 1.0000000e+00 3.2788628e-14 1.9261484e-13 3.9550053e-13]
 [4.4739905e-09 1.0000000e+00 2.2872139e-13 9.8955837e-13 9.9722639e-13]
 ...
 [6.5586988e-08 9.9999988e-01 5.8549709e-13 2.0421674e-12 3.6136109e-12]
 [2.0653645e-09 1.0000000e+00 1.8697272e-13 9.2354932e-13 7.3763760e-13]
 [8.9223906e-12 1.0000000e+00 8.6053635e-15 5.1927185e-14 5.0872341e-14]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.487238282775879
tp :  14944.0
fp :  85056.0
tn :  314944.0
fn :  85056.0
accuracy :  0.6597793102264404
precision :  0.1494400054216385
recall :  0.1494400054216385
auc :  0.4684847891330719

y_eval {0: 100000}
pred {0: 14944, 1: 85056}
[INFO] confusion matrix for file 
[[14944 85056     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 684491 3911645       0       0       0]
 [  70002  321365       0       0       0]
 [  29325   80370       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4618109e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4618109e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4618109e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 ...
 [ 1.0384874e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0384874e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0384874e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.1890845e-17 1.0000000e+00 1.6679951e-17 2.7784997e-16 2.8595012e-16]
  [1.8898044e-10 1.0000000e+00 2.4655781e-14 1.5025227e-13 3.0519795e-13]
  [1.3541710e-09 1.0000000e+00 1.2188705e-13 5.8008156e-13 5.8903560e-13]
  ...
  [1.8675923e-13 1.0000000e+00 1.7087968e-15 2.0042216e-14 1.1480862e-14]
  [5.3918193e-08 1.0000000e+00 4.7347678e-13 1.5088963e-12 3.0641308e-12]
  [1.0000000e+00 1.3808696e-12 8.9275011e-15 1.3073641e-15 1.2941011e-15]]

 [[6.1837276e-17 1.0000000e+00 1.6672063e-17 2.7773445e-16 2.8583778e-16]
  [1.5723249e-10 1.0000000e+00 2.2479980e-14 1.3860725e-13 2.8048717e-13]
  [2.5381750e-09 1.0000000e+00 1.6822900e-13 7.6201285e-13 7.7765312e-13]
  ...
  [2.9556538e-10 1.0000000e+00 5.2281875e-14 3.0389854e-13 3.1119668e-13]
  [3.8927439e-10 1.0000000e+00 5.5134157e-14 2.6198092e-13 3.2576451e-13]
  [1.0000000e+00 1.1200260e-11 2.1791876e-14 3.4858589e-15 3.8518616e-15]]

 [[6.1837276e-17 1.0000000e+00 1.6672063e-17 2.7773445e-16 2.8583778e-16]
  [1.5723849e-10 1.0000000e+00 2.2480409e-14 1.3860937e-13 2.8049253e-13]
  [1.8653212e-09 1.0000000e+00 1.4340482e-13 6.6552487e-13 6.7875214e-13]
  ...
  [6.2593243e-11 1.0000000e+00 2.4327757e-14 1.5691199e-13 1.5184490e-13]
  [5.5777261e-10 1.0000000e+00 6.3359975e-14 2.9435536e-13 3.8790783e-13]
  [1.0000000e+00 6.7237687e-12 1.7259323e-14 2.6997631e-15 2.9328130e-15]]

 ...

 [[6.8182334e-17 1.0000000e+00 1.7581823e-17 2.9101215e-16 2.9866091e-16]
  [1.9468638e-07 9.9999976e-01 1.7271059e-12 1.0143498e-11 6.6999045e-12]
  [3.5515344e-15 1.0000000e+00 1.0931434e-16 1.1589057e-15 1.9425276e-15]
  ...
  [1.9686485e-11 1.0000000e+00 1.3984732e-14 8.6138412e-14 7.4988098e-14]
  [4.5503323e-10 1.0000000e+00 5.1802048e-14 2.8950122e-13 4.4086279e-13]
  [1.2527911e-08 1.0000000e+00 4.4854135e-13 1.8399861e-12 1.4431064e-12]]

 [[8.0315913e-13 1.0000000e+00 2.5055171e-15 1.9773913e-14 1.8445626e-14]
  [1.8431376e-15 1.0000000e+00 1.2211375e-16 1.8952574e-15 1.3971821e-15]
  [3.4932218e-14 1.0000000e+00 3.3771394e-16 3.3317029e-15 5.4817668e-15]
  ...
  [2.5697548e-13 1.0000000e+00 1.8412050e-15 1.9820888e-14 1.3378780e-14]
  [5.8302554e-09 1.0000000e+00 1.7172741e-13 6.6765322e-13 1.0969679e-12]
  [2.6178764e-09 1.0000000e+00 1.8958126e-13 9.2622362e-13 8.8568530e-13]]

 [[6.1859928e-17 1.0000000e+00 1.6675433e-17 2.7778321e-16 2.8588468e-16]
  [1.6452385e-10 1.0000000e+00 2.3020101e-14 1.4162762e-13 2.8626380e-13]
  [1.5237642e-09 1.0000000e+00 1.2892244e-13 6.0719138e-13 6.2088897e-13]
  ...
  [3.9056438e-08 1.0000000e+00 4.5158620e-13 1.6477366e-12 2.8140472e-12]
  [2.5704758e-09 1.0000000e+00 1.9729167e-13 9.4177183e-13 8.3260222e-13]
  [8.5077822e-12 1.0000000e+00 8.8455329e-15 5.4545690e-14 4.9373134e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.1890845e-17 1.0000000e+00 1.6679951e-17 2.7784997e-16 2.8595012e-16]
 [1.8898044e-10 1.0000000e+00 2.4655781e-14 1.5025227e-13 3.0519795e-13]
 [1.3541710e-09 1.0000000e+00 1.2188705e-13 5.8008156e-13 5.8903560e-13]
 ...
 [3.9056438e-08 1.0000000e+00 4.5158620e-13 1.6477366e-12 2.8140472e-12]
 [2.5704758e-09 1.0000000e+00 1.9729167e-13 9.4177183e-13 8.3260222e-13]
 [8.5077822e-12 1.0000000e+00 8.8455329e-15 5.4545690e-14 4.9373134e-14]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.616356321716308
tp :  14599.0
fp :  85401.0
tn :  314599.0
fn :  85401.0
accuracy :  0.6583994030952454
precision :  0.14598999917507172
recall :  0.14598999917507172
auc :  0.4664195775985718

y_eval {0: 100000}
pred {0: 14599, 1: 85401}
[INFO] confusion matrix for file 
[[14599 85401     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 699090 3997046       0       0       0]
 [  70002  321365       0       0       0]
 [  29325   80370       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0384874  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.0384874  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.0384874  0.         0.        ...  3.         0.00482    1.45442  ]
 ...
 [ 1.7307937  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.7307937  0.         0.        ...  4.         0.00482   -0.23351  ]
 [ 1.7307937  0.         0.        ...  3.         0.00482    1.45442  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.18226518e-17 1.00000000e+00 1.66699641e-17 2.77702690e-16
   2.85808345e-16]
  [1.64709732e-10 1.00000000e+00 2.30329265e-14 1.41697336e-13
   2.86414528e-13]
  [3.04510706e-09 1.00000000e+00 1.84684136e-13 8.23894663e-13
   8.42795939e-13]
  ...
  [1.91156934e-11 1.00000000e+00 1.39553684e-14 7.78742169e-14
   6.52370817e-14]
  [1.70910841e-09 1.00000000e+00 9.65982326e-14 5.53210581e-13
   9.17639012e-13]
  [2.87023934e-08 1.00000000e+00 7.07086787e-13 2.71117157e-12
   2.00475509e-12]]

 [[6.82578059e-17 1.00000000e+00 1.75923548e-17 2.91165405e-16
   2.98809030e-16]
  [9.60985319e-11 1.00000000e+00 1.76356529e-14 1.12316535e-13
   2.22962030e-13]
  [1.49540680e-09 1.00000000e+00 1.25588613e-13 5.90832559e-13
   6.16516820e-13]
  ...
  [1.65741743e-11 1.00000000e+00 1.29304323e-14 7.32511382e-14
   6.15925293e-14]
  [3.32393135e-09 1.00000000e+00 1.35685706e-13 7.43072812e-13
   1.24382427e-12]
  [2.70076175e-08 1.00000000e+00 6.96541457e-13 2.69257793e-12
   1.94975416e-12]]

 [[9.99999642e-01 3.63430019e-07 3.32988997e-12 1.24894452e-12
   1.22523411e-12]
  [2.64433471e-08 1.00000000e+00 9.87115337e-13 4.71573518e-12
   1.85493374e-12]
  [2.47641067e-16 1.00000000e+00 3.13829479e-17 4.48625389e-16
   5.57114851e-16]
  ...
  [1.63720437e-12 1.00000000e+00 4.97068453e-15 4.72967477e-14
   3.14766320e-14]
  [5.38595502e-10 1.00000000e+00 5.49223515e-14 2.49323945e-13
   3.53736138e-13]
  [4.35946923e-09 1.00000000e+00 2.16147548e-13 1.01459520e-12
   1.16356317e-12]]

 ...

 [[6.18127521e-17 1.00000000e+00 1.66685016e-17 2.77681488e-16
   2.85787646e-16]
  [1.39403919e-10 1.00000000e+00 2.12007197e-14 1.31901732e-13
   2.65187395e-13]
  [9.99999762e-01 2.04775390e-07 2.49845283e-12 7.63723828e-13
   8.41364630e-13]
  ...
  [8.23478008e-10 1.00000000e+00 7.16199561e-14 4.21408215e-13
   6.01311264e-13]
  [8.85349305e-09 1.00000000e+00 3.34129046e-13 1.31843950e-12
   1.23758165e-12]
  [9.07796668e-12 1.00000000e+00 8.51286577e-15 5.26421016e-14
   5.69777989e-14]]

 [[6.29132266e-17 1.00000000e+00 1.68289962e-17 2.80025969e-16
   2.88062062e-16]
  [9.98543501e-01 1.45654776e-03 8.89045504e-11 6.69380176e-11
   1.71740386e-10]
  [5.40125999e-11 1.00000000e+00 2.70439782e-14 1.71735266e-13
   1.60575139e-13]
  ...
  [3.95223242e-06 9.99996066e-01 4.76862950e-12 1.55744792e-11
   2.84020082e-11]
  [3.20443161e-09 1.00000000e+00 2.35733010e-13 1.08232824e-12
   8.48881295e-13]
  [3.59444636e-12 1.00000000e+00 5.24572502e-15 3.32035560e-14
   3.39684640e-14]]

 [[6.71834174e-17 1.00000000e+00 1.74414060e-17 2.88972278e-16
   2.96687319e-16]
  [1.48247317e-10 1.00000000e+00 2.18500196e-14 1.35085329e-13
   2.72560484e-13]
  [9.84494691e-12 1.00000000e+00 9.80535335e-15 7.02652522e-14
   6.52333547e-14]
  ...
  [2.79606405e-09 1.00000000e+00 1.76128047e-13 8.04577379e-13
   8.95187624e-13]
  [3.01244168e-11 1.00000000e+00 1.91182892e-14 1.16107509e-13
   8.94603402e-14]
  [2.17357563e-10 1.00000000e+00 3.45578567e-14 1.99117619e-13
   3.08971110e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.1822652e-17 1.0000000e+00 1.6669964e-17 2.7770269e-16 2.8580835e-16]
 [1.6470973e-10 1.0000000e+00 2.3032926e-14 1.4169734e-13 2.8641453e-13]
 [3.0451071e-09 1.0000000e+00 1.8468414e-13 8.2389466e-13 8.4279594e-13]
 ...
 [2.7960640e-09 1.0000000e+00 1.7612805e-13 8.0457738e-13 8.9518762e-13]
 [3.0124417e-11 1.0000000e+00 1.9118289e-14 1.1610751e-13 8.9460340e-14]
 [2.1735756e-10 1.0000000e+00 3.4557857e-14 1.9911762e-13 3.0897111e-13]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.693702604675293
tp :  14321.0
fp :  85679.0
tn :  314321.0
fn :  85679.0
accuracy :  0.6572873592376709
precision :  0.14320999383926392
recall :  0.14320999383926392
auc :  0.4639323651790619

y_eval {0: 99998, 2: 2}
pred {0: 14322, 1: 85678}
[INFO] confusion matrix for file 
[[14321 85677     0     0     0]
 [    0     0     0     0     0]
 [    1     1     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 713411 4082723       0       0       0]
 [  70002  321365       0       0       0]
 [  29326   80371       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-02_121729_121.log.part13_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1368 (0.2736%)
[INFO] ** orig:[0:99.9996%,2:0.0004%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9994%,3:0.0006%]
[INFO] ** i/f_dir:[1:99.9994%,0:0.0006%]
[INFO] ** src:[22:38.162%,9:26.1664%,7:18.0742%,1:17.5958%,21:0.0008%,17:0.0002%,15:0.0002%,14:0.0002%,8:0.0002%]
[INFO] ** dst:[21:43.4352%,10:20.8932%,8:18.0744%,9:17.5952%,22:0.0006%,18:0.0006%,15:0.0006%,6:0.0002%]
[INFO] ** proto:[0:99.9986%,2:0.0008%,1:0.0006%]
[INFO] ** appi_name:[21:99.9986%,31:0.0006%,30:0.0006%,22:0.0002%]
[INFO] ** proxy_src_ip:[18:38.162%,20:26.1664%,13:18.0742%,6:17.5958%,17:0.0006%,7:0.0004%,16:0.0002%,2:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9986%,-33.760870000000004:0.0014%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.9988%,0:0.0014%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.166%,1:20.893%,5:18.0738%,4:17.5948%,2:17.2688%,0:0.0036%]
[INFO] ** service:[0.0048200000000000005:99.9986%,-211.73542999999998:0.0006%,-186.43601999999998:0.0006%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.1662%,-0.32151:20.8932%,-1.27613:18.074%,-0.23351:17.5952%,-0.33484:17.2688%,-71.33197:0.0006%,15.43653:0.0004%,-0.24151:0.0004%,-0.24950999999999998:0.0002%,1.46509:0.0002%,4.42897:0.0002%,-71.14931:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:92.8338%,Multi Stage Single Point:7.1662%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7333814e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.7333814e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.7333814e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [-1.0384512e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0384512e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.0384512e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.47219032e-01 8.52780998e-01 1.43599677e-09 1.25083222e-09
   1.27843025e-09]
  [6.35216900e-16 1.00000000e+00 5.89167001e-17 8.49495484e-16
   8.87801490e-16]
  [9.99700665e-01 2.99356790e-04 5.12009601e-11 3.12249983e-11
   5.70950509e-11]
  ...
  [1.00000000e+00 7.38584471e-11 3.92185335e-14 5.43614099e-15
   1.03144489e-14]
  [5.26728921e-12 1.00000000e+00 1.28593289e-14 1.36868639e-13
   5.45369515e-14]
  [8.82339271e-11 1.00000000e+00 1.89989490e-14 8.55137358e-14
   1.46111110e-13]]

 [[6.18490753e-17 1.00000000e+00 1.66737807e-17 2.77758832e-16
   2.85862873e-16]
  [1.58388622e-10 1.00000000e+00 2.25622828e-14 1.39046272e-13
   2.81435167e-13]
  [2.01090478e-09 1.00000000e+00 1.49127089e-13 6.87998595e-13
   7.01653796e-13]
  ...
  [1.63618202e-10 1.00000000e+00 3.87107169e-14 2.29535141e-13
   2.32986211e-13]
  [1.00000000e+00 6.23339847e-15 5.33097338e-16 4.75570155e-17
   5.66842786e-17]
  [6.64115160e-12 1.00000000e+00 8.89161063e-15 7.23710913e-14
   5.31572839e-14]]

 [[6.19198952e-17 1.00000000e+00 1.66842148e-17 2.77912516e-16
   2.86010124e-16]
  [2.33748132e-10 1.00000000e+00 2.74347246e-14 1.64937711e-13
   3.36481277e-13]
  [2.00066719e-09 1.00000000e+00 1.49770157e-13 6.90975922e-13
   6.99714592e-13]
  ...
  [4.40256295e-12 1.00000000e+00 7.53005090e-15 6.39989635e-14
   4.35033784e-14]
  [1.27121220e-08 1.00000000e+00 2.40534697e-13 9.18122132e-13
   1.83475023e-12]
  [1.52352087e-08 1.00000000e+00 6.05391984e-13 2.66489608e-12
   1.67055920e-12]]

 ...

 [[7.57234124e-03 9.92427647e-01 3.38871792e-10 3.76260550e-10
   3.79923981e-10]
  [9.99991894e-01 8.06883509e-06 1.53820186e-11 7.54583028e-12
   7.03505787e-12]
  [1.65198408e-13 1.00000000e+00 1.31061980e-15 1.38013626e-14
   1.04504926e-14]
  ...
  [1.00000000e+00 6.61234523e-16 1.95171466e-16 1.58296545e-17
   1.64012561e-17]
  [2.95058283e-11 1.00000000e+00 1.72437578e-14 1.18927600e-13
   9.83750367e-14]
  [3.06668611e-08 1.00000000e+00 3.93497518e-13 1.43171499e-12
   2.82701228e-12]]

 [[6.19647879e-17 1.00000000e+00 1.66908355e-17 2.78008998e-16
   2.86102874e-16]
  [1.85804455e-10 1.00000000e+00 2.44561163e-14 1.49234642e-13
   3.02777253e-13]
  [3.79467346e-09 1.00000000e+00 2.07680024e-13 9.10789673e-13
   9.28466397e-13]
  ...
  [3.42392958e-08 1.00000000e+00 8.09365758e-13 3.08718546e-12
   2.34370249e-12]
  [6.09281885e-13 1.00000000e+00 2.13735932e-15 1.66834760e-14
   1.66887598e-14]
  [4.10050305e-08 1.00000000e+00 5.35372528e-13 2.33752362e-12
   3.39727747e-12]]

 [[6.19652644e-17 1.00000000e+00 1.66908984e-17 2.78010057e-16
   2.86103960e-16]
  [1.85929605e-10 1.00000000e+00 2.44643749e-14 1.49277915e-13
   3.02871416e-13]
  [1.00000000e+00 1.95404741e-15 3.28538272e-16 2.94736794e-17
   3.09290640e-17]
  ...
  [7.27706322e-07 9.99999285e-01 2.44114776e-12 9.06712812e-12
   1.26302111e-11]
  [2.74677669e-10 1.00000000e+00 5.87560870e-14 3.01385219e-13
   2.67503928e-13]
  [6.06946507e-11 1.00000000e+00 2.26414312e-14 1.29605379e-13
   1.36954806e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.4721903e-01 8.5278100e-01 1.4359968e-09 1.2508322e-09 1.2784303e-09]
 [6.3521690e-16 1.0000000e+00 5.8916700e-17 8.4949548e-16 8.8780149e-16]
 [9.9970067e-01 2.9935679e-04 5.1200960e-11 3.1224998e-11 5.7095051e-11]
 ...
 [7.2770632e-07 9.9999928e-01 2.4411478e-12 9.0671281e-12 1.2630211e-11]
 [2.7467767e-10 1.0000000e+00 5.8756087e-14 3.0138522e-13 2.6750393e-13]
 [6.0694651e-11 1.0000000e+00 2.2641431e-14 1.2960538e-13 1.3695481e-13]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  12.80873565826416
tp :  18364.0
fp :  81636.0
tn :  318364.0
fn :  81636.0
accuracy :  0.6734592318534851
precision :  0.1836400032043457
recall :  0.1836400032043457
auc :  0.4899255037307739

y_eval {0: 100000}
pred {0: 18364, 1: 81636}
[INFO] confusion matrix for file 
[[18364 81636     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 731775 4164359       0       0       0]
 [  70002  321365       0       0       0]
 [  29326   80371       0       0       0]
 [      0       0       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0384512e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0384512e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0384512e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-3.4605739e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4605739e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4605739e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.55860721e-17 1.00000000e+00 1.72132381e-17 2.85626339e-16
   2.93497181e-16]
  [3.99074745e-10 1.00000000e+00 3.59186557e-14 2.08518315e-13
   4.29555859e-13]
  [1.00000000e+00 2.08802261e-15 3.41445943e-16 3.06251049e-17
   3.19195002e-17]
  ...
  [2.99906276e-07 9.99999642e-01 1.64089901e-12 6.50934471e-12
   8.30388362e-12]
  [1.50966933e-10 1.00000000e+00 4.08078180e-14 2.13058859e-13
   2.02426942e-13]
  [3.64388658e-11 1.00000000e+00 1.75584238e-14 1.08561509e-13
   1.13192699e-13]]

 [[1.31869335e-02 9.86813068e-01 4.48854676e-10 4.76812811e-10
   4.82529905e-10]
  [9.99987006e-01 1.29910250e-05 1.95162740e-11 9.92138923e-12
   9.20607687e-12]
  [1.53139776e-13 1.00000000e+00 1.26510745e-15 1.34193388e-14
   1.00824348e-14]
  ...
  [2.06907185e-08 1.00000000e+00 5.44675362e-13 2.04209349e-12
   1.77126000e-12]
  [1.00000000e+00 1.45353185e-12 7.31314609e-15 8.51279653e-16
   1.10111255e-15]
  [2.18625487e-12 1.00000000e+00 5.73684912e-15 5.25666513e-14
   3.28081475e-14]]

 [[1.00000000e+00 3.20918368e-13 4.79567608e-15 7.55156395e-16
   6.04726308e-16]
  [9.91397858e-01 8.60207714e-03 4.69859651e-10 4.00139116e-10
   3.19040655e-10]
  [9.18618306e-12 1.00000000e+00 9.35322834e-15 6.21894910e-14
   5.69668214e-14]
  ...
  [1.00000000e+00 3.49483295e-15 4.84582202e-16 4.37417707e-17
   3.85542961e-17]
  [7.22599931e-12 1.00000000e+00 8.04660971e-15 5.89174637e-14
   5.13142859e-14]
  [1.75460642e-07 9.99999881e-01 9.47786879e-13 3.18174003e-12
   6.36446625e-12]]

 ...

 [[6.18417564e-17 1.00000000e+00 1.66727616e-17 2.77744009e-16
   2.85847626e-16]
  [1.57811750e-10 1.00000000e+00 2.25212644e-14 1.38827385e-13
   2.80962645e-13]
  [1.92222549e-09 1.00000000e+00 1.45668674e-13 6.74431539e-13
   6.87817533e-13]
  ...
  [1.34027002e-12 1.00000000e+00 4.19984304e-15 3.98070452e-14
   2.63327381e-14]
  [2.23525092e-08 1.00000000e+00 3.18017341e-13 1.14398660e-12
   2.26234114e-12]
  [4.62513370e-08 1.00000000e+00 1.04258963e-12 4.19064740e-12
   2.85170759e-12]]

 [[2.41913367e-05 9.99975801e-01 1.79367302e-11 3.18283663e-11
   3.13689977e-11]
  [1.48072011e-15 1.00000000e+00 8.82371890e-17 1.20286672e-15
   1.31378844e-15]
  [1.59400338e-06 9.99998450e-01 2.94158621e-12 8.77296326e-12
   1.45579711e-11]
  ...
  [1.00000000e+00 1.72318167e-11 2.24860685e-14 3.09938186e-15
   4.63527345e-15]
  [1.10208077e-12 1.00000000e+00 4.62352977e-15 4.92428770e-14
   2.56801907e-14]
  [1.22679145e-09 1.00000000e+00 7.16921165e-14 2.89708904e-13
   5.35619671e-13]]

 [[1.00000000e+00 4.39314141e-09 4.21020965e-13 1.21105654e-13
   1.11083411e-13]
  [3.50988572e-10 1.00000000e+00 9.20313291e-14 6.05974255e-13
   2.69148798e-13]
  [1.45134945e-15 1.00000000e+00 6.95401080e-17 8.36245506e-16
   1.28725736e-15]
  ...
  [3.66927148e-12 1.00000000e+00 7.49257224e-15 6.83373714e-14
   4.36939744e-14]
  [2.22574981e-09 1.00000000e+00 1.04685330e-13 4.13909033e-13
   7.01851880e-13]
  [4.62017624e-09 1.00000000e+00 2.69642083e-13 1.31367009e-12
   1.12075204e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.5586072e-17 1.0000000e+00 1.7213238e-17 2.8562634e-16 2.9349718e-16]
 [3.9907475e-10 1.0000000e+00 3.5918656e-14 2.0851832e-13 4.2955586e-13]
 [1.0000000e+00 2.0880226e-15 3.4144594e-16 3.0625105e-17 3.1919500e-17]
 ...
 [3.6692715e-12 1.0000000e+00 7.4925722e-15 6.8337371e-14 4.3693974e-14]
 [2.2257498e-09 1.0000000e+00 1.0468533e-13 4.1390903e-13 7.0185188e-13]
 [4.6201762e-09 1.0000000e+00 2.6964208e-13 1.3136701e-12 1.1207520e-12]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.173591860961913
tp :  16080.0
fp :  83920.0
tn :  316080.0
fn :  83920.0
accuracy :  0.6643232107162476
precision :  0.1607999950647354
recall :  0.1607999950647354
auc :  0.4769066274166107

y_eval {0: 88734, 3: 11266}
pred {0: 16248, 1: 83752}
[INFO] confusion matrix for file 
[[16080 72654     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [  168 11098     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 747855 4237013       0       0       0]
 [  70002  321365       0       0       0]
 [  29326   80371       0       0       0]
 [    168   11098       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-0.3460574   0.          0.         ...  3.          0.00482
   1.45442   ]
 [-0.3460574   0.          0.         ...  3.          0.00482
   1.45442   ]
 [-0.3460574   0.          0.         ...  4.          0.00482
  -0.23351   ]
 ...
 [ 0.34633645  0.          0.         ...  3.          0.00482
   1.45442   ]
 [ 0.34633645  0.          0.         ...  2.          0.00482
  -0.33484   ]
 [ 0.34633645  0.          0.         ...  1.          0.00482
  -0.32151   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[7.3340083e-17 1.0000000e+00 1.8291829e-17 3.0129626e-16 3.0860137e-16]
  [1.0000000e+00 3.8035512e-12 7.7360468e-15 1.1077862e-15 2.1555612e-15]
  [1.4816708e-13 1.0000000e+00 1.2294768e-15 1.3222862e-14 1.0201945e-14]
  ...
  [4.0190127e-09 1.0000000e+00 2.3945852e-13 1.0451680e-12 8.7205715e-13]
  [7.8677967e-12 1.0000000e+00 7.3944985e-15 4.5290919e-14 5.3584832e-14]
  [6.5686740e-09 1.0000000e+00 2.5881321e-13 1.3236855e-12 1.3879887e-12]]

 [[3.6611811e-05 9.9996340e-01 2.2180084e-11 3.8019855e-11 3.7539371e-11]
  [6.6710603e-03 9.9332893e-01 4.4637827e-10 9.3761809e-10 5.5756805e-10]
  [8.6340652e-16 1.0000000e+00 6.7608913e-17 9.3302744e-16 9.6564975e-16]
  ...
  [3.8432447e-08 1.0000000e+00 7.3470998e-13 2.5588394e-12 2.2417573e-12]
  [7.9305633e-12 1.0000000e+00 7.3888590e-15 4.3456687e-14 5.2792728e-14]
  [6.0801542e-09 1.0000000e+00 2.5717850e-13 1.3874434e-12 1.3487635e-12]]

 [[4.0629275e-05 9.9995935e-01 2.3395530e-11 3.9756927e-11 3.9272391e-11]
  [5.1929238e-03 9.9480706e-01 3.9422707e-10 8.4423929e-10 4.9971743e-10]
  [8.5474190e-16 1.0000000e+00 6.7199054e-17 9.2748795e-16 9.6016203e-16]
  ...
  [6.6509635e-08 9.9999988e-01 9.7473147e-13 3.2352064e-12 2.8432725e-12]
  [1.0000000e+00 1.3727768e-11 2.1772640e-14 2.9939565e-15 4.0471391e-15]
  [1.0722783e-12 1.0000000e+00 4.3576271e-15 4.4884581e-14 2.4598379e-14]]

 ...

 [[6.5116895e-17 1.0000000e+00 1.7146064e-17 2.8464415e-16 2.9255263e-16]
  [1.5755761e-10 1.0000000e+00 2.2518344e-14 1.3872443e-13 2.8046204e-13]
  [4.8962598e-09 1.0000000e+00 2.3638857e-13 1.0164489e-12 1.0389053e-12]
  ...
  [3.9179024e-08 1.0000000e+00 4.4941226e-13 1.6253901e-12 2.9702822e-12]
  [2.7093767e-09 1.0000000e+00 2.2867122e-13 1.1211326e-12 7.9702445e-13]
  [1.1213230e-12 1.0000000e+00 2.7828289e-15 1.9896187e-14 2.1168759e-14]]

 [[6.3510511e-17 1.0000000e+00 1.6915304e-17 2.8128395e-16 2.8928772e-16]
  [2.3769739e-10 1.0000000e+00 2.7674801e-14 1.6614005e-13 3.3890694e-13]
  [6.2050671e-09 1.0000000e+00 2.8996984e-13 1.2763846e-12 1.1229389e-12]
  ...
  [1.1720586e-08 1.0000000e+00 4.4091491e-13 1.8054613e-12 1.5119327e-12]
  [1.0000000e+00 3.1072206e-10 1.0291756e-13 1.7501183e-14 2.0677675e-14]
  [1.9065934e-13 1.0000000e+00 1.5540383e-15 1.6706148e-14 1.1390648e-14]]

 [[6.1871727e-17 1.0000000e+00 1.6677152e-17 2.7780865e-16 2.8590978e-16]
  [1.5899246e-10 1.0000000e+00 2.2607342e-14 1.3929740e-13 2.8191601e-13]
  [1.7709789e-09 1.0000000e+00 1.3959501e-13 6.5041310e-13 6.6338558e-13]
  ...
  [3.0494066e-10 1.0000000e+00 5.4726182e-14 3.1078026e-13 3.0557715e-13]
  [1.8220546e-10 1.0000000e+00 3.6879171e-14 1.8656840e-13 2.3403195e-13]
  [2.7811381e-10 1.0000000e+00 5.7115005e-14 3.2707946e-13 2.9064205e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[7.3340083e-17 1.0000000e+00 1.8291829e-17 3.0129626e-16 3.0860137e-16]
 [1.0000000e+00 3.8035512e-12 7.7360468e-15 1.1077862e-15 2.1555612e-15]
 [1.4816708e-13 1.0000000e+00 1.2294768e-15 1.3222862e-14 1.0201945e-14]
 ...
 [3.0494066e-10 1.0000000e+00 5.4726182e-14 3.1078026e-13 3.0557715e-13]
 [1.8220546e-10 1.0000000e+00 3.6879171e-14 1.8656840e-13 2.3403195e-13]
 [2.7811381e-10 1.0000000e+00 5.7115005e-14 3.2707946e-13 2.9064205e-13]] (100000, 5)
pred 3 (argmax) [1 0 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.482405619812011
tp :  15007.0
fp :  84993.0
tn :  315007.0
fn :  84993.0
accuracy :  0.660031259059906
precision :  0.15006999671459198
recall :  0.15006999671459198
auc :  0.4687981903553009

y_eval {0: 92435, 3: 7565}
pred {0: 15073, 1: 84927}
[INFO] confusion matrix for file 
[[15007 77428     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [   66  7499     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 762862 4314441       0       0       0]
 [  70002  321365       0       0       0]
 [  29326   80371       0       0       0]
 [    234   18597       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4633645e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 3.4633645e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4633645e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 1.0387303e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0387303e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0387303e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.3518266e-17 1.0000000e+00 1.6916403e-17 2.8130004e-16 2.8930315e-16]
  [1.5827990e-10 1.0000000e+00 2.2563401e-14 1.3901234e-13 2.8118835e-13]
  [1.0000000e+00 1.4406442e-13 2.5813162e-15 3.0385867e-16 3.3090541e-16]
  ...
  [5.1331477e-07 9.9999952e-01 2.0150897e-12 7.8015198e-12 1.1220269e-11]
  [1.0000000e+00 7.7043406e-12 2.0028116e-14 2.5630264e-15 2.4760908e-15]
  [3.9825746e-13 1.0000000e+00 2.0482773e-15 1.8547196e-14 1.3826815e-14]]

 [[6.3521899e-17 1.0000000e+00 1.6916983e-17 2.8130753e-16 2.8931199e-16]
  [4.2371393e-10 1.0000000e+00 3.7041313e-14 2.1448430e-13 4.4160674e-13]
  [1.8395011e-09 1.0000000e+00 1.5734145e-13 7.6616491e-13 6.5449366e-13]
  ...
  [2.1588984e-11 1.0000000e+00 1.5093207e-14 8.5704129e-14 7.0679790e-14]
  [8.3909046e-10 1.0000000e+00 6.7374979e-14 3.8893243e-13 6.3584457e-13]
  [1.0347391e-07 9.9999988e-01 1.3511013e-12 4.6611859e-12 3.5577635e-12]]

 [[6.1830672e-17 1.0000000e+00 1.6671109e-17 2.7771963e-16 2.8582470e-16]
  [1.5902098e-10 1.0000000e+00 2.2609153e-14 1.3930855e-13 2.8194181e-13]
  [1.7898871e-09 1.0000000e+00 1.4038162e-13 6.5357431e-13 6.6648396e-13]
  ...
  [1.2394556e-11 1.0000000e+00 1.0461063e-14 5.9755173e-14 5.5750235e-14]
  [5.6317671e-09 1.0000000e+00 1.8911465e-13 1.0119398e-12 1.5482715e-12]
  [6.5625132e-09 1.0000000e+00 3.1835661e-13 1.3307534e-12 1.0424305e-12]]

 ...

 [[6.9709290e-17 1.0000000e+00 1.7794569e-17 2.9410125e-16 3.0164585e-16]
  [9.5005760e-11 1.0000000e+00 1.7539579e-14 1.1175623e-13 2.2170594e-13]
  [1.8188576e-09 1.0000000e+00 1.3890844e-13 6.4339002e-13 6.7227392e-13]
  ...
  [6.9837495e-12 1.0000000e+00 8.1719223e-15 4.9599854e-14 4.2678711e-14]
  [3.5074514e-09 1.0000000e+00 1.4001339e-13 7.6829417e-13 1.2645641e-12]
  [1.0000000e+00 2.0987144e-12 1.0510263e-14 1.3239865e-15 1.2571215e-15]]

 [[6.1822652e-17 1.0000000e+00 1.6669964e-17 2.7770269e-16 2.8580835e-16]
  [1.5522619e-10 1.0000000e+00 2.2336757e-14 1.3784296e-13 2.7883148e-13]
  [2.0273105e-09 1.0000000e+00 1.4966564e-13 6.8997900e-13 7.0422531e-13]
  ...
  [1.0000000e+00 1.2521753e-11 2.1250517e-14 3.4777170e-15 4.1218800e-15]
  [5.2994225e-13 1.0000000e+00 2.4458623e-15 2.3829019e-14 1.8059864e-14]
  [2.4536462e-08 1.0000000e+00 3.6976954e-13 1.3500247e-12 2.2031496e-12]]

 [[6.1853085e-17 1.0000000e+00 1.6674416e-17 2.7776942e-16 2.8587161e-16]
  [1.6462619e-10 1.0000000e+00 2.3027172e-14 1.4166572e-13 2.8634571e-13]
  [3.7391787e-09 1.0000000e+00 2.0540930e-13 9.0161515e-13 9.2274810e-13]
  ...
  [4.1686530e-08 1.0000000e+00 4.6650352e-13 1.6858789e-12 2.9805884e-12]
  [2.7184717e-09 1.0000000e+00 2.1732820e-13 1.0503119e-12 8.2179315e-13]
  [6.5415329e-12 1.0000000e+00 7.2514203e-15 4.4931432e-14 4.4900505e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.3518266e-17 1.0000000e+00 1.6916403e-17 2.8130004e-16 2.8930315e-16]
 [1.5827990e-10 1.0000000e+00 2.2563401e-14 1.3901234e-13 2.8118835e-13]
 [1.0000000e+00 1.4406442e-13 2.5813162e-15 3.0385867e-16 3.3090541e-16]
 ...
 [4.1686530e-08 1.0000000e+00 4.6650352e-13 1.6858789e-12 2.9805884e-12]
 [2.7184717e-09 1.0000000e+00 2.1732820e-13 1.0503119e-12 8.2179315e-13]
 [6.5415329e-12 1.0000000e+00 7.2514203e-15 4.4931432e-14 4.4900505e-14]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.605078282165527
tp :  14636.0
fp :  85364.0
tn :  314636.0
fn :  85364.0
accuracy :  0.6585473418235779
precision :  0.14635999500751495
recall :  0.14635999500751495
auc :  0.46686428785324097

y_eval {0: 100000}
pred {0: 14636, 1: 85364}
[INFO] confusion matrix for file 
[[14636 85364     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 777498 4399805       0       0       0]
 [  70002  321365       0       0       0]
 [  29326   80371       0       0       0]
 [    234   18597       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0387303  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.0387303  0.         0.        ...  2.         0.00482   -0.33484  ]
 [ 1.0387303  0.         0.        ...  1.         0.00482   -0.32151  ]
 ...
 [ 1.7311242  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.7311242  0.         0.        ...  3.         0.00482    1.45442  ]
 [ 1.7311242  0.         0.        ...  3.         0.00482    1.45442  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.18226518e-17 1.00000000e+00 1.66699641e-17 2.77702690e-16
   2.85807260e-16]
  [1.55246024e-10 1.00000000e+00 2.23381629e-14 1.37850574e-13
   2.78848505e-13]
  [1.68709413e-09 1.00000000e+00 1.36087444e-13 6.36569031e-13
   6.49311171e-13]
  ...
  [9.61074623e-12 1.00000000e+00 9.53515831e-15 5.62758661e-14
   4.91459494e-14]
  [2.46356757e-09 1.00000000e+00 1.18127079e-13 6.60818188e-13
   1.07239695e-12]
  [1.89604155e-08 1.00000000e+00 5.63534462e-13 2.21243076e-12
   1.67951438e-12]]

 [[9.99999881e-01 9.60891242e-08 1.77096250e-12 6.00190579e-13
   5.82025422e-13]
  [1.44681806e-13 1.00000000e+00 1.44252358e-15 1.68190098e-14
   9.16945183e-15]
  [3.58980906e-15 1.00000000e+00 1.08884424e-16 1.24612099e-15
   1.99733630e-15]
  ...
  [5.67055897e-13 1.00000000e+00 2.05104497e-15 1.64582534e-14
   1.64103553e-14]
  [8.96163233e-09 1.00000000e+00 2.52006098e-13 1.21885488e-12
   1.73464997e-12]
  [5.29420729e-10 1.00000000e+00 8.75974233e-14 4.53954149e-13
   3.62762825e-13]]

 [[1.03255321e-10 1.00000000e+00 3.10923603e-14 1.60795815e-13
   1.50730773e-13]
  [5.09876497e-14 1.00000000e+00 4.83516741e-16 5.05642078e-15
   6.61749615e-15]
  [5.11917765e-11 1.00000000e+00 1.80646869e-14 1.12328536e-13
   1.33690937e-13]
  ...
  [7.55166220e-13 1.00000000e+00 2.82918724e-15 2.68334684e-14
   2.06394926e-14]
  [5.07737177e-08 1.00000000e+00 5.10819956e-13 1.78138006e-12
   3.24884802e-12]
  [3.98454292e-09 1.00000000e+00 2.75658701e-13 1.29353548e-12
   9.53600480e-13]]

 ...

 [[1.00000000e+00 1.73082548e-09 2.73887304e-13 7.40765820e-14
   6.68335829e-14]
  [9.99251664e-01 7.48289924e-04 1.43249079e-10 1.02053047e-10
   8.95027247e-11]
  [9.99999762e-01 2.05961086e-07 2.13811239e-12 7.29285718e-13
   8.72992217e-13]
  ...
  [1.30108511e-08 1.00000000e+00 3.64320201e-13 1.91079552e-12
   2.14423054e-12]
  [9.02086912e-12 1.00000000e+00 9.95999276e-15 6.87234896e-14
   5.86201958e-14]
  [1.01306619e-11 1.00000000e+00 8.52771934e-15 6.03060218e-14
   6.99752959e-14]]

 [[6.24152969e-17 1.00000000e+00 1.67566080e-17 2.78970434e-16
   2.87036464e-16]
  [1.00000000e+00 2.56947783e-15 3.64100130e-16 3.48851578e-17
   3.47237120e-17]
  [3.01489722e-14 1.00000000e+00 4.64362467e-16 5.23215555e-15
   4.20083661e-15]
  ...
  [5.91455565e-11 1.00000000e+00 2.71541246e-14 1.59049857e-13
   1.30458808e-13]
  [1.21471054e-11 1.00000000e+00 8.91300498e-15 5.86935895e-14
   7.18248838e-14]
  [5.62418867e-09 1.00000000e+00 2.37756429e-13 1.10358055e-12
   1.20167374e-12]]

 [[5.48193413e-15 1.00000000e+00 1.83431271e-16 2.19203021e-15
   2.09351774e-15]
  [1.26244154e-11 1.00000000e+00 6.79469078e-15 4.80833635e-14
   8.37524969e-14]
  [2.27210980e-12 1.00000000e+00 4.40395045e-15 3.52994577e-14
   3.30930351e-14]
  ...
  [2.88590873e-10 1.00000000e+00 5.32266797e-14 2.77948454e-13
   2.85584273e-13]
  [1.02604897e-10 1.00000000e+00 2.99552897e-14 1.64676812e-13
   1.76312564e-13]
  [9.99956369e-01 4.35710135e-05 3.02891427e-11 1.56670545e-11
   2.04285477e-11]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.1822652e-17 1.0000000e+00 1.6669964e-17 2.7770269e-16 2.8580726e-16]
 [1.5524602e-10 1.0000000e+00 2.2338163e-14 1.3785057e-13 2.7884850e-13]
 [1.6870941e-09 1.0000000e+00 1.3608744e-13 6.3656903e-13 6.4931117e-13]
 ...
 [2.8859087e-10 1.0000000e+00 5.3226680e-14 2.7794845e-13 2.8558427e-13]
 [1.0260490e-10 1.0000000e+00 2.9955290e-14 1.6467681e-13 1.7631256e-13]
 [9.9995637e-01 4.3571014e-05 3.0289143e-11 1.5667054e-11 2.0428548e-11]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  13.691322590637206
tp :  14390.0
fp :  85610.0
tn :  314390.0
fn :  85610.0
accuracy :  0.6575632691383362
precision :  0.14390000700950623
recall :  0.14390000700950623
auc :  0.464236319065094

y_eval {0: 83000, 3: 17000}
pred {0: 14446, 1: 85554}
[INFO] confusion matrix for file 
[[14390 68610     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [   56 16944     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 791888 4468415       0       0       0]
 [  70002  321365       0       0       0]
 [  29326   80371       0       0       0]
 [    290   35541       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-02_121729_121.log.part14_sorted-labeled.csv
[INFO] process dataset, shape: (439824, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (439824, 17)

[INFO] analyzing data
[INFO] 439824 rows
[INFO] ** unixtime:1201 (0.27306%)
[INFO] ** orig:[0:99.99955%,2:0.00045%]
[INFO] ** type:[0:99.99977%,1:0.00023%]
[INFO] ** i/f_name:[2:99.99864%,3:0.00136%]
[INFO] ** i/f_dir:[1:99.99886%,0:0.00114%]
[INFO] ** src:[22:38.09456%,9:26.09703%,7:18.22161%,1:17.58408%,14:0.00091%,21:0.00068%,15:0.00068%,4:0.00023%,3:0.00023%]
[INFO] ** dst:[21:43.35416%,10:20.83674%,8:18.22115%,9:17.58385%,22:0.00159%,15:0.00136%,24:0.00045%,25:0.00023%,6:0.00023%,2:0.00023%]
[INFO] ** proto:[0:99.99818%,1:0.00136%,2:0.00045%]
[INFO] ** appi_name:[21:99.99795%,30:0.00136%,26:0.00023%,8:0.00023%,0:0.00023%]
[INFO] ** proxy_src_ip:[18:38.09456%,20:26.09703%,13:18.22161%,6:17.58408%,17:0.00136%,16:0.00068%,21:0.00023%,7:0.00023%,1:0.00023%]
[INFO] ** modbus_function_code:[0.02961:99.99795%,-33.760870000000004:0.00205%]
[INFO] ** modbus_function_description:[7:49.99955%,11:49.99841%,0:0.00205%]
[INFO] ** modbus_transaction_id:65536 (14.90051%)
[INFO] ** scada_tag:[3:26.09612%,1:20.83652%,5:18.22092%,4:17.5834%,2:17.25758%,0:0.00546%]
[INFO] ** service:[0.0048200000000000005:99.99795%,-211.73542999999998:0.00136%,-186.44547:0.00023%,-211.08346:0.00023%,-211.35747999999998:0.00023%]
[INFO] ** s_port:[1.45442:26.09635%,-0.32151:20.83674%,-1.27613:18.22115%,-0.23351:17.58362%,-0.33484:17.25781%,-71.33197:0.00136%,-1.02014:0.00068%,-1.27347:0.00045%,1.45709:0.00045%,-0.24151:0.00045%,-71.14798:0.00023%,1.47576:0.00023%,-64.19493:0.00023%,-1.2708:0.00023%]
[INFO] ** classification:[normal:93.34597%,Single Stage Single Point:4.48861%,Multi Stage Single Point:2.16541%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/439824 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.732219e+00  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 [-1.732219e+00  0.000000e+00  0.000000e+00 ...  1.000000e+00
   4.820000e-03 -3.215100e-01]
 [-1.732219e+00  0.000000e+00  0.000000e+00 ...  2.000000e+00
   4.820000e-03 -3.348400e-01]
 ...
 [-9.465184e-01  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 [-9.465184e-01  0.000000e+00  0.000000e+00 ...  2.000000e+00
   4.820000e-03 -3.348400e-01]
 [-9.465184e-01  0.000000e+00  0.000000e+00 ...  3.000000e+00
   4.820000e-03  1.454420e+00]] shape (100000, 16)
y_test [[0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [3 0 0 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.74597207e-16 1.00000000e+00 2.92147652e-17 4.53128216e-16
   4.55073533e-16]
  [2.61005745e-10 1.00000000e+00 2.94512441e-14 1.73757628e-13
   3.47304054e-13]
  [2.02547068e-09 1.00000000e+00 1.49068502e-13 6.81515283e-13
   7.00733633e-13]
  ...
  [5.82309201e-11 1.00000000e+00 2.28876197e-14 1.49298420e-13
   1.47686876e-13]
  [1.00000000e+00 4.85256028e-14 1.33686215e-15 1.35811595e-16
   1.79470082e-16]
  [2.77978812e-12 1.00000000e+00 5.92144047e-15 5.27273165e-14
   3.73265600e-14]]

 [[1.73321113e-16 1.00000000e+00 2.90996448e-17 4.51576875e-16
   4.53584767e-16]
  [1.00672026e-09 1.00000000e+00 5.80407779e-14 3.13733143e-13
   6.43834378e-13]
  [2.38599163e-09 1.00000000e+00 1.66052298e-13 7.48695160e-13
   7.53265885e-13]
  ...
  [8.18986408e-08 9.99999881e-01 6.51304369e-13 2.25524504e-12
   4.26889296e-12]
  [1.08889857e-08 1.00000000e+00 4.95737728e-13 2.18039128e-12
   1.42913394e-12]
  [4.69241399e-13 1.00000000e+00 1.75902930e-15 1.34347557e-14
   1.44778073e-14]]

 [[1.72066154e-16 1.00000000e+00 2.89859770e-17 4.50044646e-16
   4.52114688e-16]
  [1.00715059e-09 1.00000000e+00 5.80464225e-14 3.13778029e-13
   6.44041949e-13]
  [1.00000000e+00 2.76718989e-14 1.17907484e-15 1.22187838e-16
   1.30704436e-16]
  ...
  [3.37610089e-07 9.99999642e-01 1.59771090e-12 6.42896977e-12
   9.31872982e-12]
  [2.68243783e-09 1.00000000e+00 1.93519625e-13 8.28524532e-13
   7.23246224e-13]
  [1.25973555e-11 1.00000000e+00 1.01935426e-14 6.34474095e-14
   6.59632871e-14]]

 ...

 [[6.19180026e-17 1.00000000e+00 1.66839600e-17 2.77908281e-16
   2.86005757e-16]
  [1.00000000e+00 2.41066589e-09 1.56866490e-13 3.85639905e-14
   8.61093423e-14]
  [3.36261379e-12 1.00000000e+00 6.19133439e-15 5.01587771e-14
   4.50868184e-14]
  ...
  [4.03116815e-07 9.99999642e-01 2.38814068e-12 9.27429401e-12
   8.28354052e-12]
  [2.52959390e-11 1.00000000e+00 1.32344942e-14 7.02734244e-14
   9.07247029e-14]
  [1.24358901e-09 1.00000000e+00 1.27496294e-13 7.23095900e-13
   5.99460694e-13]]

 [[6.18304339e-17 1.00000000e+00 1.66711089e-17 2.77719631e-16
   2.85824704e-16]
  [1.58269037e-10 1.00000000e+00 2.25537633e-14 1.39001468e-13
   2.81338565e-13]
  [1.00000000e+00 5.47616043e-13 4.92061429e-15 6.31223987e-16
   6.90885282e-16]
  ...
  [1.01895928e-07 9.99999881e-01 8.41510780e-13 3.65864153e-12
   5.50067934e-12]
  [5.11217735e-09 1.00000000e+00 2.75396459e-13 1.14131686e-12
   9.59696623e-13]
  [4.17052157e-12 1.00000000e+00 5.61604613e-15 3.71410632e-14
   3.99928876e-14]]

 [[1.63674163e-09 1.00000000e+00 1.29381857e-13 5.24919355e-13
   4.96438882e-13]
  [1.88707031e-14 1.00000000e+00 3.00585656e-16 3.38896252e-15
   4.20750826e-15]
  [1.73362238e-07 9.99999881e-01 1.04730905e-12 3.53420656e-12
   5.21578223e-12]
  ...
  [2.20922586e-12 1.00000000e+00 3.70021727e-15 2.50655565e-14
   3.08549878e-14]
  [5.28995301e-08 1.00000000e+00 7.37287401e-13 3.22761349e-12
   3.56084606e-12]
  [1.00000000e+00 1.68697972e-11 2.53291159e-14 3.50330879e-15
   4.16518880e-15]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.7459721e-16 1.0000000e+00 2.9214765e-17 4.5312822e-16 4.5507353e-16]
 [2.6100574e-10 1.0000000e+00 2.9451244e-14 1.7375763e-13 3.4730405e-13]
 [2.0254707e-09 1.0000000e+00 1.4906850e-13 6.8151528e-13 7.0073363e-13]
 ...
 [2.2092259e-12 1.0000000e+00 3.7002173e-15 2.5065557e-14 3.0854988e-14]
 [5.2899530e-08 1.0000000e+00 7.3728740e-13 3.2276135e-12 3.5608461e-12]
 [1.0000000e+00 1.6869797e-11 2.5329116e-14 3.5033088e-15 4.1651888e-15]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  12.303982446289062
tp :  21516.0
fp :  78484.0
tn :  321516.0
fn :  78484.0
accuracy :  0.6860671043395996
precision :  0.21515999734401703
recall :  0.21515999734401703
auc :  0.5104383230209351

y_eval {0: 86777, 1: 3699, 3: 9524}
pred {0: 18251, 1: 81749}
[INFO] confusion matrix for file 
[[17905 68872     0     0     0]
 [   88  3611     0     0     0]
 [    0     0     0     0     0]
 [  258  9266     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 809793 4537287       0       0       0]
 [  70090  324976       0       0       0]
 [  29326   80371       0       0       0]
 [    548   44807       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 100000-200000/439824 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-0.9465184  0.         0.        ...  4.         0.00482   -0.23351  ]
 [-0.9436298  0.         0.        ...  1.         0.00482   -0.32151  ]
 [-0.9436298  0.         0.        ...  2.         0.00482   -0.33484  ]
 ...
 [-0.1579293  0.         0.        ...  2.         0.00482   -0.33484  ]
 [-0.1579293  0.         0.        ...  3.         0.00482    1.45442  ]
 [-0.1579293  0.         0.        ...  2.         0.00482   -0.33484  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.00000000e+00 4.67974479e-11 4.98221967e-14 1.08846326e-14
   9.41031073e-15]
  [9.97534871e-01 2.46511213e-03 3.20891314e-10 2.24137486e-10
   1.28134961e-10]
  [1.21412500e-14 1.00000000e+00 2.56598943e-16 2.74193311e-15
   3.23764643e-15]
  ...
  [1.00000000e+00 5.45964573e-15 5.24122177e-16 4.94292164e-17
   5.29315852e-17]
  [2.92998828e-12 1.00000000e+00 5.23656817e-15 4.30100833e-14
   3.63257703e-14]
  [1.55302828e-07 9.99999881e-01 9.08147635e-13 2.97039520e-12
   5.66533973e-12]]

 [[1.00000000e+00 4.77351908e-11 5.02892507e-14 1.10005931e-14
   9.51350391e-15]
  [9.73866105e-01 2.61338986e-02 1.00730635e-09 8.49799675e-10
   4.71376216e-10]
  [3.07851351e-15 1.00000000e+00 1.26983050e-16 1.53253872e-15
   1.75357568e-15]
  ...
  [3.26119078e-08 1.00000000e+00 8.10824335e-13 3.24513832e-12
   2.45825517e-12]
  [1.31963201e-12 1.00000000e+00 3.16317720e-15 2.16600182e-14
   2.14024457e-14]
  [6.57404158e-08 9.99999881e-01 6.49582439e-13 2.95575196e-12
   4.65784442e-12]]

 [[7.07055657e-17 1.00000000e+00 1.79320812e-17 2.96091484e-16
   3.03574808e-16]
  [1.23897642e-10 1.00000000e+00 2.00033776e-14 1.25108542e-13
   2.50630842e-13]
  [1.80547777e-09 1.00000000e+00 1.39729808e-13 6.48714481e-13
   6.69209913e-13]
  ...
  [2.29919439e-09 1.00000000e+00 1.76823454e-13 8.21945214e-13
   7.64164068e-13]
  [1.11744416e-11 1.00000000e+00 1.03373341e-14 6.60370603e-14
   5.93225013e-14]
  [3.82264131e-09 1.00000000e+00 1.58177345e-13 7.71067292e-13
   1.13811044e-12]]

 ...

 [[2.09556747e-11 1.00000000e+00 1.36260615e-14 8.10375530e-14
   7.57011776e-14]
  [7.62240449e-03 9.92377639e-01 4.16570306e-10 9.46526302e-10
   5.81542980e-10]
  [9.80362709e-16 1.00000000e+00 6.19657342e-17 7.75480474e-16
   1.08404558e-15]
  ...
  [1.90140568e-07 9.99999762e-01 1.57072228e-12 5.46829205e-12
   5.15622527e-12]
  [1.11898832e-11 1.00000000e+00 9.03297619e-15 5.32975899e-14
   6.42494480e-14]
  [1.00000000e+00 3.10284090e-12 1.11564073e-14 1.70249197e-15
   1.91233125e-15]]

 [[1.00000000e+00 2.80990660e-12 1.34087721e-14 2.44771981e-15
   2.01779892e-15]
  [8.09616566e-01 1.90383464e-01 2.34338060e-09 2.44017673e-09
   1.39976375e-09]
  [6.84910206e-16 1.00000000e+00 6.21494411e-17 8.79378330e-16
   8.78690910e-16]
  ...
  [2.05927899e-13 1.00000000e+00 1.83270486e-15 2.10893281e-14
   1.20547188e-14]
  [2.12879336e-09 1.00000000e+00 9.58955070e-14 3.88189074e-13
   6.89387024e-13]
  [9.87049553e-09 1.00000000e+00 3.79709827e-13 1.73846571e-12
   1.65779272e-12]]

 [[6.38454856e-17 1.00000000e+00 1.69639639e-17 2.81997332e-16
   2.89972730e-16]
  [2.00986838e-10 1.00000000e+00 2.54493573e-14 1.54451891e-13
   3.13708017e-13]
  [3.73674736e-09 1.00000000e+00 2.06296650e-13 9.05620576e-13
   9.21872062e-13]
  ...
  [2.03084793e-09 1.00000000e+00 1.53285018e-13 7.07432106e-13
   7.44556814e-13]
  [4.66433697e-11 1.00000000e+00 2.30829743e-14 1.34756450e-13
   1.10717052e-13]
  [1.98194905e-10 1.00000000e+00 3.44224059e-14 1.99197402e-13
   2.90090434e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.00000000e+00 4.67974479e-11 4.98221967e-14 1.08846326e-14
  9.41031073e-15]
 [9.97534871e-01 2.46511213e-03 3.20891314e-10 2.24137486e-10
  1.28134961e-10]
 [1.21412500e-14 1.00000000e+00 2.56598943e-16 2.74193311e-15
  3.23764643e-15]
 ...
 [2.03084793e-09 1.00000000e+00 1.53285018e-13 7.07432106e-13
  7.44556814e-13]
 [4.66433697e-11 1.00000000e+00 2.30829743e-14 1.34756450e-13
  1.10717052e-13]
 [1.98194905e-10 1.00000000e+00 3.44224059e-14 1.99197402e-13
  2.90090434e-13]] (100000, 5)
pred 3 (argmax) [0 0 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  10.702333822631836
tp :  31468.0
fp :  68532.0
tn :  331468.0
fn :  68532.0
accuracy :  0.7258748412132263
precision :  0.3146800100803375
recall :  0.3146800100803375
auc :  0.5742432475090027

y_eval {0: 83957, 1: 16043}
pred {0: 15887, 1: 84113}
[INFO] confusion matrix for file 
[[15656 68301     0     0     0]
 [  231 15812     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 825449 4605588       0       0       0]
 [  70321  340788       0       0       0]
 [  29326   80371       0       0       0]
 [    548   44807       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 200000-300000/439824 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.579293e-01  0.000000e+00  0.000000e+00 ...  3.000000e+00
   4.820000e-03  1.454420e+00]
 [-1.579293e-01  0.000000e+00  0.000000e+00 ...  4.000000e+00
   4.820000e-03 -2.335100e-01]
 [-1.579293e-01  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 ...
 [ 6.306598e-01  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 [ 6.306598e-01  0.000000e+00  0.000000e+00 ...  4.000000e+00
   4.820000e-03 -2.335100e-01]
 [ 6.306598e-01  0.000000e+00  0.000000e+00 ...  3.000000e+00
   4.820000e-03  1.454420e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[2.62179133e-11 1.00000000e+00 1.53019704e-14 8.92382820e-14
   8.33952726e-14]
  [3.65154259e-03 9.96348441e-01 2.89450325e-10 6.97823133e-10
   4.22650914e-10]
  [9.69262766e-16 1.00000000e+00 6.16030122e-17 7.71497143e-16
   1.07529350e-15]
  ...
  [1.37237237e-07 9.99999881e-01 1.36651140e-12 4.83327744e-12
   4.44768397e-12]
  [1.00000000e+00 1.25810704e-08 5.72293135e-13 1.21249866e-13
   1.76106200e-13]
  [2.21749079e-13 1.00000000e+00 2.07075415e-15 2.47724475e-14
   1.25103226e-14]]

 [[6.18752671e-17 1.00000000e+00 1.66776602e-17 2.77817119e-16
   2.85917401e-16]
  [2.43032733e-10 1.00000000e+00 2.79764124e-14 1.67780381e-13
   3.42559965e-13]
  [8.42408254e-10 1.00000000e+00 1.02601806e-13 5.27730203e-13
   4.65951279e-13]
  ...
  [4.34644421e-12 1.00000000e+00 5.72908522e-15 3.65577116e-14
   3.77351619e-14]
  [1.00000000e+00 2.88383293e-11 2.96727263e-14 5.85998188e-15
   7.79556185e-15]
  [2.63380897e-12 1.00000000e+00 5.86481208e-15 5.17618480e-14
   3.77119194e-14]]

 [[1.00000000e+00 2.99440659e-12 1.38191689e-14 2.53342726e-15
   2.09003876e-15]
  [9.91913319e-01 8.08665436e-03 5.55777202e-10 4.63807992e-10
   2.71734024e-10]
  [1.10542695e-14 1.00000000e+00 2.47305007e-16 2.69400205e-15
   3.11049196e-15]
  ...
  [4.61416363e-08 1.00000000e+00 8.82646387e-13 3.44412259e-12
   3.03337542e-12]
  [5.54091538e-12 1.00000000e+00 7.06837941e-15 4.38358829e-14
   3.97907991e-14]
  [1.73558679e-08 1.00000000e+00 3.26844346e-13 1.59319237e-12
   2.51394608e-12]]

 ...

 [[6.18224202e-17 1.00000000e+00 1.66699012e-17 2.77702690e-16
   2.85807260e-16]
  [1.00000000e+00 1.30802480e-08 6.01257325e-13 2.26654673e-13
   2.01370252e-13]
  [8.22709337e-16 1.00000000e+00 6.19872475e-17 8.43949641e-16
   9.86598037e-16]
  ...
  [1.00000000e+00 8.20679136e-10 1.76062547e-13 3.45580566e-14
   3.68472512e-14]
  [6.64864756e-14 1.00000000e+00 8.20862911e-16 8.98253368e-15
   6.83422901e-15]
  [2.54736534e-07 9.99999762e-01 1.13349152e-12 3.72557497e-12
   6.84409951e-12]]

 [[6.59229398e-17 1.00000000e+00 1.72608440e-17 2.86314686e-16
   2.94174172e-16]
  [2.57332960e-10 1.00000000e+00 2.88659680e-14 1.72546249e-13
   3.50933123e-13]
  [1.54816160e-09 1.00000000e+00 1.30687182e-13 6.13695238e-13
   6.24940475e-13]
  ...
  [3.26707261e-09 1.00000000e+00 1.77793381e-13 7.88658852e-13
   9.60793728e-13]
  [1.40419315e-10 1.00000000e+00 4.42417540e-14 2.44655994e-13
   1.80361558e-13]
  [1.67279836e-11 1.00000000e+00 9.60026973e-15 6.36741094e-14
   9.13506738e-14]]

 [[3.57907226e-13 1.00000000e+00 1.64406745e-15 1.39035596e-14
   1.29860188e-14]
  [1.38614207e-12 1.00000000e+00 2.38395094e-15 1.96086958e-14
   3.00153409e-14]
  [1.19039330e-08 1.00000000e+00 3.11266122e-13 1.23455445e-12
   1.53207926e-12]
  ...
  [6.84780965e-12 1.00000000e+00 7.11398663e-15 4.83765385e-14
   5.31486679e-14]
  [4.96111419e-09 1.00000000e+00 2.03684874e-13 9.23811808e-13
   1.13718605e-12]
  [1.00000000e+00 6.17600859e-09 4.62319039e-13 1.03686184e-13
   1.18495356e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[2.62179133e-11 1.00000000e+00 1.53019704e-14 8.92382820e-14
  8.33952726e-14]
 [3.65154259e-03 9.96348441e-01 2.89450325e-10 6.97823133e-10
  4.22650914e-10]
 [9.69262766e-16 1.00000000e+00 6.16030122e-17 7.71497143e-16
  1.07529350e-15]
 ...
 [6.84780965e-12 1.00000000e+00 7.11398663e-15 4.83765385e-14
  5.31486679e-14]
 [4.96111419e-09 1.00000000e+00 2.03684874e-13 9.23811808e-13
  1.13718605e-12]
 [1.00000000e+00 6.17600859e-09 4.62319039e-13 1.03686184e-13
  1.18495356e-13]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  13.519720504760743
tp :  15008.0
fp :  84992.0
tn :  315008.0
fn :  84992.0
accuracy :  0.6600353121757507
precision :  0.15007999539375305
recall :  0.15007999539375305
auc :  0.4685584008693695

y_eval {0: 100000}
pred {0: 15008, 1: 84992}
[INFO] confusion matrix for file 
[[15008 84992     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 840457 4690580       0       0       0]
 [  70321  340788       0       0       0]
 [  29326   80371       0       0       0]
 [    548   44807       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 300000-400000/439824 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 6.3065982e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 6.3065982e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 6.3065982e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 1.4192489e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.4192489e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.4192489e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.29242645e-17 1.00000000e+00 1.68306654e-17 2.80052677e-16
   2.88085143e-16]
  [1.59511571e-10 1.00000000e+00 2.26476942e-14 1.39477649e-13
   2.82251219e-13]
  [3.12759307e-09 1.00000000e+00 1.87539546e-13 8.35674412e-13
   8.52551645e-13]
  ...
  [4.49816469e-08 1.00000000e+00 4.82421286e-13 1.78584003e-12
   3.07050782e-12]
  [3.62564334e-09 1.00000000e+00 2.35002176e-13 1.08418786e-12
   9.65912788e-13]
  [1.71930109e-11 1.00000000e+00 1.28326948e-14 7.39399454e-14
   6.65444533e-14]]

 [[9.99999881e-01 1.07052557e-07 1.87186529e-12 6.51423631e-13
   6.31167156e-13]
  [9.00397197e-08 9.99999881e-01 1.85446645e-12 7.99128385e-12
   3.10119552e-12]
  [1.93417856e-16 1.00000000e+00 2.77033838e-17 4.04127466e-16
   4.98684454e-16]
  ...
  [3.40431416e-09 1.00000000e+00 2.21408449e-13 9.78929177e-13
   8.03431865e-13]
  [3.27316754e-12 1.00000000e+00 4.68692595e-15 3.13015130e-14
   3.70261276e-14]
  [5.78675952e-09 1.00000000e+00 2.38641463e-13 1.21410998e-12
   1.29886076e-12]]

 [[9.99999881e-01 1.06169438e-07 1.86429019e-12 6.48312458e-13
   6.28220945e-13]
  [1.95496375e-12 1.00000000e+00 6.12768240e-15 6.10754597e-14
   2.88071162e-14]
  [1.15864049e-15 1.00000000e+00 6.17905903e-17 7.61831491e-16
   1.16209310e-15]
  ...
  [2.06457376e-08 1.00000000e+00 3.32337944e-13 1.21451991e-12
   1.97828733e-12]
  [1.00719277e-09 1.00000000e+00 1.17638036e-13 6.09484143e-13
   5.70786582e-13]
  [1.13240320e-11 1.00000000e+00 1.06889781e-14 6.69009187e-14
   5.66203985e-14]]

 ...

 [[6.18115676e-17 1.00000000e+00 1.66683114e-17 2.77679370e-16
   2.85784364e-16]
  [1.55485472e-10 1.00000000e+00 2.23553814e-14 1.37943164e-13
   2.79047483e-13]
  [1.55150492e-09 1.00000000e+00 1.30324503e-13 6.13696377e-13
   6.25684725e-13]
  ...
  [4.39103406e-11 1.00000000e+00 2.22054549e-14 1.17974640e-13
   9.38550724e-14]
  [3.44000300e-10 1.00000000e+00 4.21946888e-14 2.60908780e-13
   4.32589782e-13]
  [4.60597747e-08 1.00000000e+00 8.92718625e-13 3.33087572e-12
   2.48861804e-12]]

 [[6.62648234e-17 1.00000000e+00 1.73114211e-17 2.87079159e-16
   2.94858389e-16]
  [1.51463592e-10 1.00000000e+00 2.20797671e-14 1.36330359e-13
   2.75351817e-13]
  [9.67663276e-12 1.00000000e+00 9.73368758e-15 6.99027289e-14
   6.47365665e-14]
  ...
  [2.43610992e-10 1.00000000e+00 5.91155814e-14 2.97131785e-13
   2.07339639e-13]
  [2.49395071e-11 1.00000000e+00 1.09145277e-14 7.22327742e-14
   1.19537531e-13]
  [6.46397780e-08 9.99999881e-01 1.05622412e-12 4.06050584e-12
   3.04967054e-12]]

 [[6.62749349e-17 1.00000000e+00 1.73128737e-17 2.87099965e-16
   2.94878639e-16]
  [8.98776293e-01 1.01223774e-01 6.53845089e-10 6.98360203e-10
   1.81520610e-09]
  [1.26872915e-12 1.00000000e+00 4.01428099e-15 3.59437415e-14
   2.90134568e-14]
  ...
  [7.57184333e-12 1.00000000e+00 1.89223874e-14 2.18913280e-13
   6.90177353e-14]
  [1.25671175e-11 1.00000000e+00 7.27189135e-15 3.49881629e-14
   5.34625275e-14]
  [1.38224482e-06 9.99998569e-01 3.79409741e-12 1.61080316e-11
   2.14789193e-11]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.29242645e-17 1.00000000e+00 1.68306654e-17 2.80052677e-16
  2.88085143e-16]
 [1.59511571e-10 1.00000000e+00 2.26476942e-14 1.39477649e-13
  2.82251219e-13]
 [3.12759307e-09 1.00000000e+00 1.87539546e-13 8.35674412e-13
  8.52551645e-13]
 ...
 [7.57184333e-12 1.00000000e+00 1.89223874e-14 2.18913280e-13
  6.90177353e-14]
 [1.25671175e-11 1.00000000e+00 7.27189135e-15 3.49881629e-14
  5.34625275e-14]
 [1.38224482e-06 9.99998569e-01 3.79409741e-12 1.61080316e-11
  2.14789193e-11]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.667549375915527
tp :  14319.0
fp :  85681.0
tn :  314319.0
fn :  85681.0
accuracy :  0.6572793126106262
precision :  0.14318999648094177
recall :  0.14318999648094177
auc :  0.46474432945251465

y_eval {0: 100000}
pred {0: 14319, 1: 85681}
[INFO] confusion matrix for file 
[[14319 85681     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 854776 4776261       0       0       0]
 [  70321  340788       0       0       0]
 [  29326   80371       0       0       0]
 [    548   44807       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 400000-500000/439824 for LSTM
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-02_172943_122.log.part03_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1376 (0.2752%)
[INFO] ** orig:[0:99.9976%,2:0.002%,1:0.0004%]
[INFO] ** type:[0:99.9988%,1:0.001%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9944%,3:0.0056%]
[INFO] ** i/f_dir:[1:99.9946%,0:0.0054%]
[INFO] ** src:[22:38.2234%,9:26.124%,7:18.075%,1:17.571%,14:0.0036%,21:0.0022%,2:0.0004%,11:0.0002%,10:0.0002%]
[INFO] ** dst:[21:43.4342%,10:20.913%,8:18.0748%,9:17.5708%,15:0.0056%,22:0.0006%,25:0.0004%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.9936%,1:0.0056%,2:0.0008%]
[INFO] ** appi_name:[21:99.9934%,30:0.0056%,0:0.0004%,31:0.0002%,27:0.0002%,15:0.0002%]
[INFO] ** proxy_src_ip:[18:38.2234%,20:26.124%,13:18.075%,6:17.571%,17:0.0056%,14:0.0004%,11:0.0002%,10:0.0002%,7:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9934%,-33.760870000000004:0.0064%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.997%,11:49.9964%,0:0.0064%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1234%,1:20.9128%,5:18.0748%,4:17.5704%,2:17.3102%,0:0.0084%]
[INFO] ** service:[0.0048200000000000005:99.9936%,-211.73542999999998:0.0056%,-186.44547:0.0004%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.1238%,-0.32151:20.913%,-1.27613:18.0748%,-0.23351:17.5706%,-0.33484:17.3104%,-71.33197:0.0056%,-0.24151:0.0004%,-64.19493:0.0004%,-1.27347:0.0002%,-10.59042:0.0002%,11.862:0.0002%,1.47576:0.0002%,13.431270000000001:0.0002%]
[INFO] ** classification:[normal:94.9296%,Single Stage Single Point:5.0704%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7301897e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.7301897e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.7301897e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [-1.0376850e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.0376850e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0376850e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.19645497e-17 1.00000000e+00 1.66907710e-17 2.78007939e-16
   2.86102874e-16]
  [5.06010955e-10 1.00000000e+00 4.04656235e-14 2.31682485e-13
   4.79401620e-13]
  [3.53486618e-09 1.00000000e+00 2.03678667e-13 8.97196109e-13
   8.98994692e-13]
  ...
  [3.25569021e-12 1.00000000e+00 5.23886574e-15 3.37515965e-14
   3.14368520e-14]
  [1.34713618e-08 1.00000000e+00 2.87813176e-13 1.44593604e-12
   2.29439384e-12]
  [3.12314157e-08 1.00000000e+00 7.27443713e-13 2.68697065e-12
   2.09141775e-12]]

 [[8.58458804e-07 9.99999166e-01 3.23725356e-12 7.62111468e-12
   7.40042923e-12]
  [2.99364822e-15 1.00000000e+00 1.23921370e-16 1.60399898e-15
   1.81498451e-15]
  [8.45022328e-07 9.99999166e-01 2.18885240e-12 6.75184301e-12
   1.08264595e-11]
  ...
  [1.68752924e-12 1.00000000e+00 3.28066279e-15 2.19550432e-14
   2.68727030e-14]
  [8.69727117e-08 9.99999881e-01 9.81733900e-13 4.38294019e-12
   4.52139671e-12]
  [5.87741106e-11 1.00000000e+00 2.16299214e-14 1.13757162e-13
   1.34531993e-13]]

 [[6.19652644e-17 1.00000000e+00 1.66908984e-17 2.78010057e-16
   2.86103960e-16]
  [1.96369934e-10 1.00000000e+00 2.51416404e-14 1.52863995e-13
   3.10582343e-13]
  [1.00000000e+00 2.66764472e-14 1.14929062e-15 1.21271653e-16
   1.30334005e-16]
  ...
  [1.00000000e+00 2.14194744e-14 9.60916845e-16 1.01044102e-16
   1.20850492e-16]
  [6.79336622e-12 1.00000000e+00 8.78091613e-15 7.02231784e-14
   5.43193589e-14]
  [1.27567166e-08 1.00000000e+00 2.64173178e-13 1.01373445e-12
   1.75490666e-12]]

 ...

 [[6.88477644e-17 1.00000000e+00 1.76722621e-17 2.92290477e-16
   2.99965945e-16]
  [2.43042919e-10 1.00000000e+00 2.80129364e-14 1.67730792e-13
   3.41832872e-13]
  [4.53576865e-09 1.00000000e+00 2.28887655e-13 9.89077201e-13
   1.00339279e-12]
  ...
  [9.75467207e-11 1.00000000e+00 2.98222886e-14 1.87645093e-13
   1.87761089e-13]
  [1.00000000e+00 7.28711633e-13 4.85479814e-15 5.90109749e-16
   8.13959328e-16]
  [1.48754728e-12 1.00000000e+00 4.50309312e-15 4.27996871e-14
   2.88745570e-14]]

 [[6.88075899e-17 1.00000000e+00 1.76666688e-17 2.92209109e-16
   2.99888150e-16]
  [2.43046638e-10 1.00000000e+00 2.80128822e-14 1.67732066e-13
   3.41838753e-13]
  [4.54617055e-09 1.00000000e+00 2.29161118e-13 9.90083232e-13
   1.00440955e-12]
  ...
  [3.93433774e-09 1.00000000e+00 2.24381820e-13 9.82595732e-13
   9.72772102e-13]
  [7.44016307e-12 1.00000000e+00 8.68073415e-15 5.83460079e-14
   4.97624606e-14]
  [9.78324088e-10 1.00000000e+00 7.64233647e-14 4.02511845e-13
   6.06470278e-13]]

 [[6.72000802e-17 1.00000000e+00 1.74413398e-17 2.88936994e-16
   2.96720168e-16]
  [3.93233279e-10 1.00000000e+00 3.56924708e-14 2.07442489e-13
   4.26293495e-13]
  [1.31301836e-09 1.00000000e+00 1.21150011e-13 5.76928045e-13
   5.80774578e-13]
  ...
  [6.36302296e-12 1.00000000e+00 7.72543006e-15 4.72918755e-14
   4.11253707e-14]
  [3.84289089e-09 1.00000000e+00 1.46794361e-13 7.97990309e-13
   1.31519947e-12]
  [1.53166173e-08 1.00000000e+00 5.08394867e-13 2.03772806e-12
   1.53760056e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.1964550e-17 1.0000000e+00 1.6690771e-17 2.7800794e-16 2.8610287e-16]
 [5.0601096e-10 1.0000000e+00 4.0465623e-14 2.3168248e-13 4.7940162e-13]
 [3.5348662e-09 1.0000000e+00 2.0367867e-13 8.9719611e-13 8.9899469e-13]
 ...
 [6.3630230e-12 1.0000000e+00 7.7254301e-15 4.7291876e-14 4.1125371e-14]
 [3.8428909e-09 1.0000000e+00 1.4679436e-13 7.9799031e-13 1.3151995e-12]
 [1.5316617e-08 1.0000000e+00 5.0839487e-13 2.0377281e-12 1.5376006e-12]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  12.815778549194336
tp :  18247.0
fp :  81753.0
tn :  318247.0
fn :  81753.0
accuracy :  0.6729912757873535
precision :  0.18246999382972717
recall :  0.18246999382972717
auc :  0.4894882142543793

y_eval {0: 100000}
pred {0: 18247, 1: 81753}
[INFO] confusion matrix for file 
[[18247 81753     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 873023 4858014       0       0       0]
 [  70321  340788       0       0       0]
 [  29326   80371       0       0       0]
 [    548   44807       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.037685    0.          0.         ...  4.          0.00482
  -0.23351   ]
 [-1.037685    0.          0.         ...  3.          0.00482
   1.45442   ]
 [-1.037685    0.          0.         ...  2.          0.00482
  -0.33484   ]
 ...
 [-0.34771708  0.          0.         ...  4.          0.00482
  -0.23351   ]
 [-0.34771708  0.          0.         ...  1.          0.00482
  -0.32151   ]
 [-0.34771708  0.          0.         ...  1.          0.00482
  -0.32151   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.00000000e+00 3.23607877e-11 4.18837362e-14 8.93356502e-15
   7.68595325e-15]
  [9.97363985e-01 2.63604824e-03 2.93646524e-10 2.18160476e-10
   1.46354859e-10]
  [1.85135483e-14 1.00000000e+00 3.29660617e-16 3.46973981e-15
   3.83820571e-15]
  ...
  [8.37528887e-07 9.99999166e-01 3.25505400e-12 9.36560638e-12
   9.26182655e-12]
  [1.32641068e-11 1.00000000e+00 9.80763525e-15 5.43604028e-14
   6.65961359e-14]
  [1.00000000e+00 7.50851746e-13 5.76556692e-15 8.10068747e-16
   8.67367932e-16]]

 [[6.19203650e-17 1.00000000e+00 1.66842776e-17 2.77913575e-16
   2.86011210e-16]
  [4.01214006e-10 1.00000000e+00 3.60188902e-14 2.09337620e-13
   4.30979715e-13]
  [1.32588585e-09 1.00000000e+00 1.21898910e-13 5.80357106e-13
   5.83498256e-13]
  ...
  [3.42052016e-13 1.00000000e+00 2.24592247e-15 2.47761338e-14
   1.48156278e-14]
  [2.35607764e-08 1.00000000e+00 3.14012732e-13 1.08511876e-12
   2.19564059e-12]
  [4.13037853e-08 1.00000000e+00 9.52400702e-13 3.92962182e-12
   2.89375490e-12]]

 [[1.07919662e-09 1.00000000e+00 1.04387446e-13 4.39284758e-13
   4.14827406e-13]
  [6.60515143e-05 9.99933958e-01 3.76831726e-11 1.17975588e-10
   7.27678126e-11]
  [3.82316918e-15 1.00000000e+00 1.23259440e-16 1.36920197e-15
   1.96076756e-15]
  ...
  [4.87377890e-12 1.00000000e+00 1.02861191e-14 9.94355965e-14
   5.26827829e-14]
  [3.05275860e-10 1.00000000e+00 3.81435775e-14 1.60635191e-13
   2.48464687e-13]
  [3.68469415e-08 1.00000000e+00 6.45706145e-13 2.89334095e-12
   3.38762352e-12]]

 ...

 [[1.01103599e-03 9.98988926e-01 1.21301330e-10 1.58315722e-10
   1.58545399e-10]
  [1.07577769e-15 1.00000000e+00 7.62432951e-17 1.06283090e-15
   1.13445897e-15]
  [1.66397040e-05 9.99983311e-01 1.00411563e-11 2.61221877e-11
   4.04922623e-11]
  ...
  [1.02693930e-11 1.00000000e+00 9.95213060e-15 7.44235538e-14
   6.18685197e-14]
  [4.98243438e-08 1.00000000e+00 5.05779555e-13 1.81732906e-12
   3.59141731e-12]
  [8.94315644e-09 1.00000000e+00 4.80440611e-13 2.15942867e-12
   1.22644321e-12]]

 [[1.00000000e+00 4.80592725e-13 5.79706003e-15 9.37615815e-16
   7.55727031e-16]
  [9.92975235e-01 7.02472171e-03 4.31200714e-10 3.61605579e-10
   2.82914053e-10]
  [3.81079846e-12 1.00000000e+00 5.83101589e-15 4.14787630e-14
   3.90305531e-14]
  ...
  [6.52113996e-12 1.00000000e+00 9.73520970e-15 8.13201367e-14
   5.44116449e-14]
  [2.02150421e-08 1.00000000e+00 3.19065412e-13 1.08132546e-12
   1.90015408e-12]
  [3.73723941e-09 1.00000000e+00 2.45838045e-13 1.18781883e-12
   9.93804756e-13]]

 [[6.37133749e-17 1.00000000e+00 1.69445616e-17 2.81710241e-16
   2.89702950e-16]
  [2.08906129e-01 7.91093826e-01 1.41082501e-09 2.59469646e-09
   2.54273491e-09]
  [9.97392654e-01 2.60733860e-03 1.63797823e-10 6.35833400e-11
   1.47361318e-10]
  ...
  [8.14942731e-12 1.00000000e+00 6.79279851e-15 4.82023682e-14
   6.37314637e-14]
  [6.53059971e-08 9.99999881e-01 8.08970512e-13 2.94514955e-12
   3.41328094e-12]
  [5.26962293e-11 1.00000000e+00 2.30651950e-14 1.26807053e-13
   1.23850664e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.0000000e+00 3.2360788e-11 4.1883736e-14 8.9335650e-15 7.6859532e-15]
 [9.9736398e-01 2.6360482e-03 2.9364652e-10 2.1816048e-10 1.4635486e-10]
 [1.8513548e-14 1.0000000e+00 3.2966062e-16 3.4697398e-15 3.8382057e-15]
 ...
 [8.1494273e-12 1.0000000e+00 6.7927985e-15 4.8202368e-14 6.3731464e-14]
 [6.5305997e-08 9.9999988e-01 8.0897051e-13 2.9451495e-12 3.4132809e-12]
 [5.2696229e-11 1.0000000e+00 2.3065195e-14 1.2680705e-13 1.2385066e-13]] (100000, 5)
pred 3 (argmax) [0 0 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.13293985900879
tp :  16224.0
fp :  83776.0
tn :  316224.0
fn :  83776.0
accuracy :  0.6648992300033569
precision :  0.16223999857902527
recall :  0.16223999857902527
auc :  0.4778846800327301

y_eval {0: 100000}
pred {0: 16224, 1: 83776}
[INFO] confusion matrix for file 
[[16224 83776     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 889247 4941790       0       0       0]
 [  70321  340788       0       0       0]
 [  29326   80371       0       0       0]
 [    548   44807       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-0.34771708  0.          0.         ...  3.          0.00482
   1.45442   ]
 [-0.34771708  0.          0.         ...  3.          0.00482
   1.45442   ]
 [-0.34771708  0.          0.         ...  2.          0.00482
  -0.33484   ]
 ...
 [ 0.34478754  0.          0.         ...  4.          0.00482
  -0.23351   ]
 [ 0.34478754  0.          0.         ...  1.          0.00482
  -0.32151   ]
 [ 0.34478754  0.          0.         ...  3.          0.00482
   1.45442   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[7.4416344e-17 1.0000000e+00 1.8437052e-17 3.0339190e-16 3.1062691e-16]
  [1.0000000e+00 7.2246592e-13 3.6137297e-15 4.5372146e-16 8.3787080e-16]
  [6.8639295e-13 1.0000000e+00 2.5876852e-15 2.3974859e-14 2.0444455e-14]
  ...
  [1.0000000e+00 1.8390148e-15 3.3100642e-16 2.8928094e-17 2.8946196e-17]
  [8.5134799e-12 1.0000000e+00 9.2616971e-15 7.0676145e-14 5.7175280e-14]
  [4.1205425e-08 1.0000000e+00 4.6000486e-13 1.6744064e-12 3.2667935e-12]]

 [[6.4491957e-17 1.0000000e+00 1.7057275e-17 2.8336143e-16 2.9128537e-16]
  [1.9118584e-10 1.0000000e+00 2.4822014e-14 1.5110499e-13 3.0653217e-13]
  [1.4113363e-09 1.0000000e+00 1.2435272e-13 5.8935588e-13 5.9990565e-13]
  ...
  [1.0000000e+00 2.2104123e-14 1.0058651e-15 1.0090967e-16 1.1489876e-16]
  [4.6044488e-12 1.0000000e+00 7.1225679e-15 5.7856301e-14 4.5156702e-14]
  [1.6648560e-08 1.0000000e+00 3.0177523e-13 1.1485078e-12 2.0074220e-12]]

 [[6.3726014e-17 1.0000000e+00 1.6946436e-17 2.8173711e-16 2.8972947e-16]
  [1.0000000e+00 4.0821933e-13 3.4072140e-15 4.4825587e-16 5.6185935e-16]
  [6.7333812e-01 3.2666191e-01 1.9596036e-09 2.0212567e-09 1.9633111e-09]
  ...
  [6.9143908e-08 9.9999988e-01 5.4221872e-13 1.7273861e-12 3.8024193e-12]
  [5.2100262e-08 1.0000000e+00 1.1269384e-12 4.3307710e-12 2.6918797e-12]
  [1.4109654e-12 1.0000000e+00 2.8990207e-15 1.9408398e-14 2.3499218e-14]]

 ...

 [[1.0000000e+00 2.6849625e-12 1.3086621e-14 2.3788546e-15 1.9647509e-15]
  [9.9004996e-01 9.9501172e-03 5.3738686e-10 4.5822279e-10 3.2653466e-10]
  [1.2432917e-14 1.0000000e+00 2.8190051e-16 3.1610423e-15 3.1827250e-15]
  ...
  [2.9833060e-09 1.0000000e+00 1.7354235e-13 9.3497063e-13 9.2863998e-13]
  [8.5996384e-11 1.0000000e+00 2.4140876e-14 1.2163624e-13 1.6140976e-13]
  [1.0000000e+00 8.3601034e-14 2.0519998e-15 2.2940741e-16 2.4415730e-16]]

 [[6.6555654e-17 1.0000000e+00 1.7350492e-17 2.8761737e-16 2.9543937e-16]
  [1.0000000e+00 3.6619589e-08 9.4815041e-13 3.8018379e-13 3.5557134e-13]
  [1.1081370e-15 1.0000000e+00 7.1233757e-17 9.3702946e-16 1.1417614e-15]
  ...
  [1.4392967e-08 1.0000000e+00 5.6256795e-13 2.4306772e-12 1.6557829e-12]
  [6.0852929e-13 1.0000000e+00 2.0318645e-15 1.4961248e-14 1.5770432e-14]
  [8.3592573e-07 9.9999917e-01 2.4674746e-12 9.4027104e-12 1.4486408e-11]]

 [[6.2966530e-17 1.0000000e+00 1.6836830e-17 2.8014349e-16 2.8817199e-16]
  [1.9903135e-10 1.0000000e+00 2.5310764e-14 1.5369547e-13 3.1244208e-13]
  [1.4375455e-09 1.0000000e+00 1.2578279e-13 5.9561530e-13 6.0476873e-13]
  ...
  [4.0885459e-12 1.0000000e+00 5.8158210e-15 3.6953598e-14 3.5082854e-14]
  [9.5951735e-09 1.0000000e+00 2.4542014e-13 1.2465935e-12 1.9433162e-12]
  [2.2499952e-08 1.0000000e+00 6.1341438e-13 2.3257741e-12 1.8045972e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[7.4416344e-17 1.0000000e+00 1.8437052e-17 3.0339190e-16 3.1062691e-16]
 [1.0000000e+00 7.2246592e-13 3.6137297e-15 4.5372146e-16 8.3787080e-16]
 [6.8639295e-13 1.0000000e+00 2.5876852e-15 2.3974859e-14 2.0444455e-14]
 ...
 [4.0885459e-12 1.0000000e+00 5.8158210e-15 3.6953598e-14 3.5082854e-14]
 [9.5951735e-09 1.0000000e+00 2.4542014e-13 1.2465935e-12 1.9433162e-12]
 [2.2499952e-08 1.0000000e+00 6.1341438e-13 2.3257741e-12 1.8045972e-12]] (100000, 5)
pred 3 (argmax) [1 0 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.446266186523438
tp :  15193.0
fp :  84807.0
tn :  315193.0
fn :  84807.0
accuracy :  0.6607752442359924
precision :  0.15193000435829163
recall :  0.15193000435829163
auc :  0.4697333872318268

y_eval {0: 100000}
pred {0: 15193, 1: 84807}
[INFO] confusion matrix for file 
[[15193 84807     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 904440 5026597       0       0       0]
 [  70321  340788       0       0       0]
 [  29326   80371       0       0       0]
 [    548   44807       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4478754e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4478754e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4478754e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 1.0398288e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0398288e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0398288e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.1905489e-17 1.0000000e+00 1.6682115e-17 2.7788176e-16 2.8597958e-16]
  [1.0000000e+00 5.3100010e-11 2.6354847e-14 4.7122755e-15 9.7412651e-15]
  [9.5502382e-13 1.0000000e+00 3.1522399e-15 2.8372946e-14 2.4835606e-14]
  ...
  [4.4630877e-07 9.9999952e-01 2.6584475e-12 9.0757115e-12 7.6152184e-12]
  [2.6214998e-12 1.0000000e+00 4.1661739e-15 2.6984364e-14 3.3080164e-14]
  [5.8284320e-09 1.0000000e+00 2.5383442e-13 1.3278832e-12 1.2753528e-12]]

 [[3.4643631e-07 9.9999964e-01 2.0318632e-12 5.1711066e-12 5.0009216e-12]
  [3.8175436e-15 1.0000000e+00 1.3959667e-16 1.7759595e-15 2.0284415e-15]
  [6.5379220e-07 9.9999940e-01 1.9354214e-12 6.0535036e-12 9.6148653e-12]
  ...
  [2.8905058e-12 1.0000000e+00 5.3063455e-15 4.3484215e-14 3.5314071e-14]
  [1.1547786e-07 9.9999988e-01 7.6952594e-13 2.6462363e-12 5.2036001e-12]
  [4.9079567e-09 1.0000000e+00 3.4282470e-13 1.6195259e-12 9.7543826e-13]]

 [[6.2948756e-17 1.0000000e+00 1.6834260e-17 2.8010609e-16 2.8813570e-16]
  [1.9922847e-10 1.0000000e+00 2.5323222e-14 1.5376203e-13 3.1258573e-13]
  [1.4374140e-09 1.0000000e+00 1.2577943e-13 5.9560511e-13 6.0474336e-13]
  ...
  [1.0000000e+00 1.3449376e-13 2.4041796e-15 2.8051884e-16 3.2298362e-16]
  [1.6628026e-12 1.0000000e+00 4.2775181e-15 3.8018505e-14 2.9255237e-14]
  [2.9924713e-08 1.0000000e+00 4.0254792e-13 1.4597497e-12 2.5513977e-12]]

 ...

 [[6.2912505e-17 1.0000000e+00 1.6828738e-17 2.8002168e-16 2.8806098e-16]
  [2.3636791e-01 7.6363206e-01 2.3800630e-09 5.8397895e-09 3.1204468e-09]
  [1.1577083e-15 1.0000000e+00 6.5877690e-17 8.0445493e-16 1.1856282e-15]
  ...
  [2.5717480e-07 9.9999976e-01 1.1858763e-12 3.8985573e-12 6.6568756e-12]
  [7.3470552e-10 1.0000000e+00 1.0368302e-13 5.3919293e-13 4.8036640e-13]
  [7.0814392e-12 1.0000000e+00 8.1826220e-15 5.2306114e-14 4.5653975e-14]]

 [[6.1882348e-17 1.0000000e+00 1.6678742e-17 2.7783194e-16 2.8593267e-16]
  [2.0168384e-10 1.0000000e+00 2.5541997e-14 1.5530769e-13 3.1408879e-13]
  [1.2238700e-09 1.0000000e+00 1.1503972e-13 5.5014641e-13 5.6372366e-13]
  ...
  [2.8038519e-08 1.0000000e+00 3.8504771e-13 1.5003615e-12 2.4535055e-12]
  [3.2010474e-09 1.0000000e+00 2.0555470e-13 9.3477092e-13 9.3098630e-13]
  [2.4908560e-11 1.0000000e+00 1.6407665e-14 9.4033186e-14 7.8283456e-14]]

 [[6.6649912e-17 1.0000000e+00 1.7365987e-17 2.8787312e-16 2.9562652e-16]
  [3.2279438e-01 6.7720562e-01 2.6489313e-09 6.3013621e-09 3.3446246e-09]
  [9.9195679e-16 1.0000000e+00 6.1163032e-17 7.5926392e-16 1.1039347e-15]
  ...
  [2.5893901e-10 1.0000000e+00 6.1910539e-14 3.5333222e-13 2.5040292e-13]
  [8.7692301e-12 1.0000000e+00 6.7895086e-15 4.4294782e-14 6.5605189e-14]
  [1.6615093e-08 1.0000000e+00 4.8636355e-13 2.1349058e-12 1.8246854e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.1905489e-17 1.0000000e+00 1.6682115e-17 2.7788176e-16 2.8597958e-16]
 [1.0000000e+00 5.3100010e-11 2.6354847e-14 4.7122755e-15 9.7412651e-15]
 [9.5502382e-13 1.0000000e+00 3.1522399e-15 2.8372946e-14 2.4835606e-14]
 ...
 [2.5893901e-10 1.0000000e+00 6.1910539e-14 3.5333222e-13 2.5040292e-13]
 [8.7692301e-12 1.0000000e+00 6.7895086e-15 4.4294782e-14 6.5605189e-14]
 [1.6615093e-08 1.0000000e+00 4.8636355e-13 2.1349058e-12 1.8246854e-12]] (100000, 5)
pred 3 (argmax) [1 0 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.609633740234376
tp :  14602.0
fp :  85398.0
tn :  314602.0
fn :  85398.0
accuracy :  0.6584113240242004
precision :  0.14601999521255493
recall :  0.14601999521255493
auc :  0.4666534662246704

y_eval {0: 100000}
pred {0: 14602, 1: 85398}
[INFO] confusion matrix for file 
[[14602 85398     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 919042 5111995       0       0       0]
 [  70321  340788       0       0       0]
 [  29326   80371       0       0       0]
 [    548   44807       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0398288e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0398288e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.0398288e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [ 1.7323334e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.7323334e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.7323334e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.31127425e-17 1.00000000e+00 1.68586159e-17 2.80467485e-16
   2.88467843e-16]
  [1.51756246e-10 1.00000000e+00 2.21171111e-14 1.36763986e-13
   2.75700253e-13]
  [1.35309697e-09 1.00000000e+00 1.20933225e-13 5.74679898e-13
   5.89223223e-13]
  ...
  [3.19805397e-11 1.00000000e+00 1.86063323e-14 1.00032531e-13
   8.07393296e-14]
  [1.33482536e-09 1.00000000e+00 8.37502607e-14 4.84021297e-13
   8.24923029e-13]
  [3.73841047e-08 1.00000000e+00 8.26734406e-13 3.14482208e-12
   2.24521486e-12]]

 [[2.29175877e-14 1.00000000e+00 3.89878069e-16 4.15010569e-15
   3.91949546e-15]
  [4.83190484e-12 1.00000000e+00 4.28712343e-15 3.23113355e-14
   5.35538715e-14]
  [7.29391703e-09 1.00000000e+00 2.54582081e-13 1.04751104e-12
   1.23434249e-12]
  ...
  [4.11567583e-14 1.00000000e+00 7.39627158e-16 9.21704153e-15
   5.77214710e-15]
  [5.64218858e-08 1.00000000e+00 4.93893609e-13 1.65039759e-12
   3.18789396e-12]
  [6.16643936e-09 1.00000000e+00 3.26035531e-13 1.52486097e-12
   1.30237856e-12]]

 [[6.29240262e-17 1.00000000e+00 1.68304090e-17 2.80045186e-16
   2.88085143e-16]
  [1.55432694e-10 1.00000000e+00 2.23597318e-14 1.37951580e-13
   2.78885747e-13]
  [2.42686360e-09 1.00000000e+00 1.64214481e-13 7.46197429e-13
   7.62414112e-13]
  ...
  [7.32222239e-14 1.00000000e+00 1.12839929e-15 1.45934459e-14
   7.67455642e-15]
  [9.28377997e-09 1.00000000e+00 1.90768110e-13 6.76046621e-13
   1.33855579e-12]
  [1.61710929e-08 1.00000000e+00 5.36949445e-13 2.44612729e-12
   2.09130196e-12]]

 ...

 [[9.99999881e-01 1.03220017e-07 1.83247341e-12 6.21379413e-13
   6.02289160e-13]
  [4.36781416e-14 1.00000000e+00 7.38237494e-16 9.21809609e-15
   5.41279973e-15]
  [8.36102411e-15 1.00000000e+00 1.67251976e-16 1.81658455e-15
   2.97369593e-15]
  ...
  [1.00224759e-11 1.00000000e+00 1.00554330e-14 6.81196568e-14
   5.99256904e-14]
  [9.99970317e-01 2.96227281e-05 2.23426052e-11 1.22375539e-11
   1.89645608e-11]
  [1.38630069e-12 1.00000000e+00 4.98909267e-15 4.90873042e-14
   2.92956069e-14]]

 [[6.62428337e-17 1.00000000e+00 1.73083176e-17 2.87034267e-16
   2.94814529e-16]
  [1.31672187e-10 1.00000000e+00 2.06208816e-14 1.28646348e-13
   2.57976827e-13]
  [3.09401593e-13 1.00000000e+00 1.67708225e-15 1.60523314e-14
   1.37674719e-14]
  ...
  [9.99763072e-01 2.36877007e-04 7.09654280e-11 3.34293079e-11
   4.19630268e-11]
  [7.97550163e-14 1.00000000e+00 1.03308246e-15 1.19034650e-14
   7.82246108e-15]
  [8.33306135e-09 1.00000000e+00 2.03560598e-13 7.87958186e-13
   1.29071114e-12]]

 [[6.24495951e-17 1.00000000e+00 1.67615958e-17 2.79042802e-16
   2.87106529e-16]
  [8.84701252e-01 1.15298785e-01 1.93164507e-09 3.78919784e-09
   1.95896033e-09]
  [7.76596546e-16 1.00000000e+00 5.55321682e-17 7.19336642e-16
   9.83475450e-16]
  ...
  [3.51561602e-09 1.00000000e+00 1.96263673e-13 9.32244408e-13
   9.29864692e-13]
  [9.98924196e-01 1.07578712e-03 1.48279181e-10 7.51470969e-11
   9.95360738e-11]
  [1.18002992e-13 1.00000000e+00 1.41565368e-15 1.67664802e-14
   9.30298404e-15]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.3112743e-17 1.0000000e+00 1.6858616e-17 2.8046748e-16 2.8846784e-16]
 [1.5175625e-10 1.0000000e+00 2.2117111e-14 1.3676399e-13 2.7570025e-13]
 [1.3530970e-09 1.0000000e+00 1.2093322e-13 5.7467990e-13 5.8922322e-13]
 ...
 [3.5156160e-09 1.0000000e+00 1.9626367e-13 9.3224441e-13 9.2986469e-13]
 [9.9892420e-01 1.0757871e-03 1.4827918e-10 7.5147097e-11 9.9536074e-11]
 [1.1800299e-13 1.0000000e+00 1.4156537e-15 1.6766480e-14 9.3029840e-15]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 0 1] (100000,)
[33m[INFO] metrics:[0m
loss :  10.39590012664795
tp :  34738.0
fp :  65262.0
tn :  334738.0
fn :  65262.0
accuracy :  0.7389546036720276
precision :  0.34738001227378845
recall :  0.34738001227378845
auc :  0.5925273299217224

y_eval {0: 74648, 1: 25352}
pred {0: 14288, 1: 85712}
[INFO] confusion matrix for file 
[[11837 62811     0     0     0]
 [ 2451 22901     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 930879 5174806       0       0       0]
 [  72772  363689       0       0       0]
 [  29326   80371       0       0       0]
 [    548   44807       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-02_172943_122.log.part04_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1377 (0.2754%)
[INFO] ** orig:[0:99.995%,2:0.005%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9944%,3:0.0056%]
[INFO] ** i/f_dir:[1:99.9944%,0:0.0056%]
[INFO] ** src:[22:38.203%,9:26.1368%,7:18.1014%,1:17.5508%,21:0.005%,3:0.0008%,15:0.0006%,14:0.0006%,4:0.0004%,2:0.0004%,8:0.0002%]
[INFO] ** dst:[21:43.4462%,10:20.893%,8:18.1012%,9:17.5504%,15:0.0056%,22:0.0016%,16:0.0008%,6:0.0006%,17:0.0004%,24:0.0002%]
[INFO] ** proto:[0:99.9938%,1:0.0056%,2:0.0006%]
[INFO] ** appi_name:[21:99.9926%,30:0.0056%,17:0.0008%,26:0.0004%,28:0.0002%,22:0.0002%,7:0.0002%]
[INFO] ** proxy_src_ip:[18:38.203%,20:26.1368%,13:18.1014%,6:17.5508%,17:0.0056%,1:0.0008%,16:0.0006%,21:0.0004%,14:0.0004%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9926%,-33.760870000000004:0.0074%]
[INFO] ** modbus_function_description:[7:49.9972%,11:49.9954%,0:0.0074%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1358%,1:20.8928%,5:18.1008%,4:17.55%,2:17.31%,0:0.0106%]
[INFO] ** service:[0.0048200000000000005:99.9926%,-211.73542999999998:0.0056%,-205.44247:0.0008%,-211.08346:0.0004%,-211.09762999999998:0.0002%,-185.9872:0.0002%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.136%,-0.32151:20.893%,-1.27613:18.101%,-0.23351:17.5502%,-0.33484:17.31%,-71.33197:0.0056%,1.45709:0.0006%,-1.02014:0.0006%,-71.14798:0.0004%,-0.24151:0.0004%,-5.1466400000000005:0.0002%,-58.035180000000004:0.0002%,-1.2708:0.0002%,-71.14931:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,-5.08665:0.0002%,-0.24950999999999998:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** classification:[normal:64.3482%,Single Stage Single Point:35.6518%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7331795e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.7331795e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.7331795e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [-1.0379097e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0379097e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0379097e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 1 1 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.41066166e-17 1.00000000e+00 1.70012780e-17 2.82536786e-16
   2.90505275e-16]
  [1.00000000e+00 3.84017023e-14 1.10187731e-15 1.17195770e-16
   1.49418412e-16]
  [5.81494852e-10 1.00000000e+00 8.25832526e-14 4.50201589e-13
   3.59786040e-13]
  ...
  [2.04860484e-08 1.00000000e+00 3.21743337e-13 9.65676974e-13
   1.67695046e-12]
  [2.41707010e-09 1.00000000e+00 1.87403668e-13 1.00063881e-12
   8.79067760e-13]
  [4.91149135e-11 1.00000000e+00 1.99502246e-14 1.01442055e-13
   1.03664825e-13]]

 [[2.35367224e-05 9.99976516e-01 1.76860974e-11 3.14554147e-11
   3.09983567e-11]
  [2.57455029e-15 1.00000000e+00 1.17716867e-16 1.54592026e-15
   1.69646279e-15]
  [1.11453278e-06 9.99998927e-01 2.49975691e-12 7.51266757e-12
   1.20624517e-11]
  ...
  [2.66615701e-12 1.00000000e+00 4.06314971e-15 2.61644208e-14
   3.35875804e-14]
  [1.00000000e+00 1.08816849e-14 7.56332659e-16 7.59669109e-17
   7.98888786e-17]
  [4.09333678e-12 1.00000000e+00 6.48482538e-15 5.27130389e-14
   4.23291400e-14]]

 [[6.19695194e-17 1.00000000e+00 1.66914724e-17 2.78018554e-16
   2.86112695e-16]
  [1.00000000e+00 3.87952000e-14 1.10748616e-15 1.17973558e-16
   1.50346945e-16]
  [7.06334990e-12 1.00000000e+00 8.28327749e-15 6.39162524e-14
   5.03709453e-14]
  ...
  [1.11456311e-09 1.00000000e+00 6.97418468e-14 2.67956366e-13
   4.60210212e-13]
  [4.62100722e-08 1.00000000e+00 7.89905359e-13 3.44070822e-12
   3.60162464e-12]
  [1.83979137e-10 1.00000000e+00 4.71493911e-14 2.28522117e-13
   1.82577776e-13]]

 ...

 [[1.00000000e+00 3.88157984e-13 5.24900812e-15 8.37250987e-16
   6.71063547e-16]
  [9.99601066e-01 3.98962031e-04 1.09157530e-10 7.63389491e-11
   5.93007379e-11]
  [7.81038107e-05 9.99921918e-01 2.87846986e-11 4.17851032e-11
   5.73645645e-11]
  ...
  [5.16621634e-09 1.00000000e+00 1.57837095e-13 8.72203514e-13
   1.71184627e-12]
  [6.21209153e-07 9.99999404e-01 3.80637232e-12 1.15589847e-11
   6.81928732e-12]
  [1.00000000e+00 5.00064736e-08 8.26529492e-13 1.71501214e-13
   4.15544877e-13]]

 [[8.11193924e-17 1.00000000e+00 1.93144208e-17 3.15929260e-16
   3.22886313e-16]
  [5.70623104e-10 1.00000000e+00 4.31393982e-14 2.44134384e-13
   5.03670293e-13]
  [8.20445597e-01 1.79554448e-01 1.93460381e-09 1.64133196e-09
   1.52841395e-09]
  ...
  [2.99793292e-08 1.00000000e+00 7.15585468e-13 2.96590617e-12
   2.60956686e-12]
  [3.30492474e-11 1.00000000e+00 1.74241420e-14 8.75005770e-14
   8.12598144e-14]
  [2.92092572e-09 1.00000000e+00 1.33557892e-13 7.74393787e-13
   1.17959169e-12]]

 [[7.13651265e-17 1.00000000e+00 1.80226724e-17 2.97403485e-16
   3.04842023e-16]
  [1.86673690e-10 1.00000000e+00 2.45445771e-14 1.49384723e-13
   3.02660620e-13]
  [8.69656563e-01 1.30343407e-01 1.66460612e-09 1.40760092e-09
   1.34454170e-09]
  ...
  [1.07059499e-07 9.99999881e-01 1.41512106e-12 5.27719361e-12
   4.53601219e-12]
  [1.04286657e-11 1.00000000e+00 9.68886260e-15 5.36163182e-14
   4.90200328e-14]
  [7.50859019e-09 1.00000000e+00 2.10584683e-13 1.16051331e-12
   1.83841440e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.4106617e-17 1.0000000e+00 1.7001278e-17 2.8253679e-16 2.9050528e-16]
 [1.0000000e+00 3.8401702e-14 1.1018773e-15 1.1719577e-16 1.4941841e-16]
 [5.8149485e-10 1.0000000e+00 8.2583253e-14 4.5020159e-13 3.5978604e-13]
 ...
 [1.0705950e-07 9.9999988e-01 1.4151211e-12 5.2771936e-12 4.5360122e-12]
 [1.0428666e-11 1.0000000e+00 9.6888626e-15 5.3616318e-14 4.9020033e-14]
 [7.5085902e-09 1.0000000e+00 2.1058468e-13 1.1605133e-12 1.8384144e-12]] (100000, 5)
pred 3 (argmax) [1 0 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.722567533874512
tp :  43542.0
fp :  56458.0
tn :  343542.0
fn :  56458.0
accuracy :  0.7741703391075134
precision :  0.4354200065135956
recall :  0.4354200065135956
auc :  0.6511538624763489

y_eval {0: 64457, 1: 35543}
pred {0: 18563, 1: 81437}
[INFO] confusion matrix for file 
[[13281 51176     0     0     0]
 [ 5282 30261     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 944160 5225982       0       0       0]
 [  78054  393950       0       0       0]
 [  29326   80371       0       0       0]
 [    548   44807       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0379097  0.         0.        ...  4.         0.00482   -0.23351  ]
 [-1.0379097  0.         0.        ...  3.         0.00482    1.45442  ]
 [-1.0379097  0.         0.        ...  2.         0.00482   -0.33484  ]
 ...
 [-0.3451776  0.         0.        ...  2.         0.00482   -0.33484  ]
 [-0.3451776  0.         0.        ...  3.         0.00482    1.45442  ]
 [-0.3451776  0.         0.        ...  1.         0.00482   -0.32151  ]] shape (100000, 16)
y_test [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [1 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.00000000e+00 3.84262663e-13 5.22383896e-15 8.32658110e-16
   6.67336496e-16]
  [9.94213283e-01 5.78666991e-03 3.82088444e-10 3.16824095e-10
   2.58358002e-10]
  [1.57854885e-09 1.00000000e+00 1.26789150e-13 5.21465575e-13
   5.32748487e-13]
  ...
  [2.94709174e-10 1.00000000e+00 5.98957529e-14 2.76960421e-13
   2.17352666e-13]
  [1.28578828e-10 1.00000000e+00 2.50603456e-14 1.57088657e-13
   2.61842035e-13]
  [2.43034890e-07 9.99999762e-01 1.94548913e-12 6.13004005e-12
   5.06977316e-12]]

 [[2.72615246e-08 1.00000000e+00 5.50339559e-13 1.74572260e-12
   1.66966094e-12]
  [1.12089200e-14 1.00000000e+00 2.37442923e-16 2.79477589e-15
   3.32283084e-15]
  [1.81187841e-06 9.99998212e-01 3.37653495e-12 9.61969653e-12
   1.48000327e-11]
  ...
  [1.87225842e-12 1.00000000e+00 4.26165442e-15 3.62577264e-14
   2.94507969e-14]
  [1.04330823e-07 9.99999881e-01 7.33438592e-13 2.52872875e-12
   4.88475059e-12]
  [5.41453016e-09 1.00000000e+00 3.52578210e-13 1.63984202e-12
   1.03101707e-12]]

 [[7.14580155e-17 1.00000000e+00 1.80354639e-17 2.97588456e-16
   3.05021170e-16]
  [1.85968962e-10 1.00000000e+00 2.44984138e-14 1.49136752e-13
   3.02128846e-13]
  [1.93276928e-09 1.00000000e+00 1.46296278e-13 6.76234893e-13
   6.88857283e-13]
  ...
  [1.22159722e-11 1.00000000e+00 1.03660824e-14 5.92777170e-14
   5.54492738e-14]
  [3.28593330e-09 1.00000000e+00 1.43673674e-13 7.94644298e-13
   1.20617231e-12]
  [1.89684108e-08 1.00000000e+00 5.45014175e-13 2.07725677e-12
   1.65865303e-12]]

 ...

 [[6.32947752e-17 1.00000000e+00 1.68841675e-17 2.80829353e-16
   2.88846626e-16]
  [1.57212396e-10 1.00000000e+00 2.24844388e-14 1.38585839e-13
   2.80343836e-13]
  [2.80565859e-09 1.00000000e+00 1.77161725e-13 7.96052081e-13
   8.12731935e-13]
  ...
  [3.92867072e-08 1.00000000e+00 4.50890762e-13 1.63197906e-12
   2.94311710e-12]
  [2.59557242e-09 1.00000000e+00 2.18529486e-13 1.06946786e-12
   7.91390770e-13]
  [1.98533702e-12 1.00000000e+00 3.79469066e-15 2.58692146e-14
   2.69616754e-14]]

 [[6.47253543e-17 1.00000000e+00 1.70913398e-17 2.83863399e-16
   2.91754675e-16]
  [4.14055734e-10 1.00000000e+00 3.66176612e-14 2.12260195e-13
   4.36844137e-13]
  [1.32754086e-09 1.00000000e+00 1.21964965e-13 5.80370387e-13
   5.83723066e-13]
  ...
  [3.89437180e-13 1.00000000e+00 2.40125582e-15 2.61291114e-14
   1.56563622e-14]
  [1.42025103e-08 1.00000000e+00 2.44384103e-13 8.78125968e-13
   1.74938915e-12]
  [1.32491582e-08 1.00000000e+00 5.20052155e-13 2.34570588e-12
   1.74661522e-12]]

 [[6.33015316e-17 1.00000000e+00 1.68850691e-17 2.80843276e-16
   2.88859834e-16]
  [4.09626999e-10 1.00000000e+00 3.64106057e-14 2.11279480e-13
   4.34871404e-13]
  [7.55651672e-06 9.99992490e-01 1.15829603e-11 2.88858416e-11
   2.53056395e-11]
  ...
  [1.03735345e-11 1.00000000e+00 9.95851130e-15 5.80363462e-14
   5.11462177e-14]
  [5.35388889e-09 1.00000000e+00 1.79610423e-13 9.62745508e-13
   1.50497583e-12]
  [1.39405660e-08 1.00000000e+00 4.62143615e-13 1.81282842e-12
   1.46945151e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.00000000e+00 3.84262663e-13 5.22383896e-15 8.32658110e-16
  6.67336496e-16]
 [9.94213283e-01 5.78666991e-03 3.82088444e-10 3.16824095e-10
  2.58358002e-10]
 [1.57854885e-09 1.00000000e+00 1.26789150e-13 5.21465575e-13
  5.32748487e-13]
 ...
 [1.03735345e-11 1.00000000e+00 9.95851130e-15 5.80363462e-14
  5.11462177e-14]
 [5.35388889e-09 1.00000000e+00 1.79610423e-13 9.62745508e-13
  1.50497583e-12]
 [1.39405660e-08 1.00000000e+00 4.62143615e-13 1.81282842e-12
  1.46945151e-12]] (100000, 5)
pred 3 (argmax) [0 0 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.670533335876465
tp :  44105.0
fp :  55895.0
tn :  344105.0
fn :  55895.0
accuracy :  0.7764223217964172
precision :  0.4410499930381775
recall :  0.4410499930381775
auc :  0.654451310634613

y_eval {0: 64588, 1: 35412}
pred {0: 16445, 1: 83555}
[INFO] confusion matrix for file 
[[12569 52019     0     0     0]
 [ 3876 31536     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 956729 5278001       0       0       0]
 [  81930  425486       0       0       0]
 [  29326   80371       0       0       0]
 [    548   44807       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4517759e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4517759e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-3.4517759e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 3.4755462e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4755462e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4755462e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 1 0 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.66539821e-17 1.00000000e+00 1.73643971e-17 2.87818222e-16
   2.95635516e-16]
  [1.90154101e-10 1.00000000e+00 2.47549716e-14 1.50631325e-13
   3.05608620e-13]
  [1.00000000e+00 3.18977158e-13 3.79577656e-15 4.68760315e-16
   5.11356331e-16]
  ...
  [4.86750595e-09 1.00000000e+00 1.87123646e-13 9.54683273e-13
   1.28840645e-12]
  [1.05045173e-09 1.00000000e+00 1.10678624e-13 5.08239718e-13
   4.81362454e-13]
  [1.68031318e-11 1.00000000e+00 1.17061851e-14 7.25842590e-14
   7.75629154e-14]]

 [[4.08581613e-09 1.00000000e+00 2.07262538e-13 7.76069096e-13
   7.36510137e-13]
  [1.87056452e-14 1.00000000e+00 3.02528590e-16 3.42285972e-15
   4.19534360e-15]
  [1.41774669e-01 8.58225286e-01 1.07403897e-09 1.37957734e-09
   1.99126493e-09]
  ...
  [9.22200901e-13 1.00000000e+00 2.88904071e-15 2.56331143e-14
   2.14476823e-14]
  [1.77112085e-07 9.99999881e-01 9.53138501e-13 3.19259116e-12
   6.22046165e-12]
  [3.41776851e-09 1.00000000e+00 2.75423266e-13 1.32709327e-12
   8.46640195e-13]]

 [[6.33116762e-17 1.00000000e+00 1.68865514e-17 2.80864690e-16
   2.88880798e-16]
  [1.31257321e-03 9.98687446e-01 1.25587457e-10 3.58509972e-10
   3.14636345e-10]
  [2.93271402e-14 1.00000000e+00 3.08358956e-16 2.67459759e-15
   5.39599756e-15]
  ...
  [2.71292890e-07 9.99999762e-01 1.18910383e-12 3.80847220e-12
   7.42090070e-12]
  [3.01839154e-09 1.00000000e+00 2.57613456e-13 1.24362022e-12
   7.96899764e-13]
  [4.94839358e-13 1.00000000e+00 1.76015691e-15 1.35173922e-14
   1.50806034e-14]]

 ...

 [[6.18778611e-17 1.00000000e+00 1.66780423e-17 2.77822413e-16
   2.85922853e-16]
  [1.20985541e-10 1.00000000e+00 1.97467012e-14 1.23974507e-13
   2.48457098e-13]
  [2.15218687e-09 1.00000000e+00 1.52971914e-13 7.00665437e-13
   7.23824483e-13]
  ...
  [6.51041790e-11 1.00000000e+00 2.49829844e-14 1.61842274e-13
   1.55834980e-13]
  [3.48322260e-10 1.00000000e+00 4.99220755e-14 2.39285019e-13
   3.10977128e-13]
  [2.75067746e-10 1.00000000e+00 5.73982864e-14 3.29339312e-13
   2.92743965e-13]]

 [[6.36414764e-17 1.00000000e+00 1.69342218e-17 2.81559840e-16
   2.89555990e-16]
  [1.89424670e-10 1.00000000e+00 2.46930060e-14 1.50393343e-13
   3.05356922e-13]
  [1.00000000e+00 9.44270703e-12 1.95846994e-14 3.01211375e-15
   3.31116445e-15]
  ...
  [1.00000000e+00 5.72983718e-12 1.29454612e-14 2.13382359e-15
   2.96444252e-15]
  [3.11030672e-12 1.00000000e+00 6.29995069e-15 5.45674379e-14
   4.05806336e-14]
  [2.69559330e-09 1.00000000e+00 1.26648000e-13 5.29785580e-13
   7.73992144e-13]]

 [[6.34901619e-17 1.00000000e+00 1.69125944e-17 2.81248529e-16
   2.89246875e-16]
  [3.47164186e-10 1.00000000e+00 3.35193570e-14 1.96610984e-13
   4.03010416e-13]
  [1.30319056e-09 1.00000000e+00 1.20338662e-13 5.73291685e-13
   5.79101003e-13]
  ...
  [2.16752816e-09 1.00000000e+00 1.56831796e-13 7.19034587e-13
   7.65684282e-13]
  [5.17964942e-11 1.00000000e+00 2.44903314e-14 1.43049404e-13
   1.17119300e-13]
  [1.32456573e-10 1.00000000e+00 2.81579993e-14 1.65727024e-13
   2.38195341e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.6653982e-17 1.0000000e+00 1.7364397e-17 2.8781822e-16 2.9563552e-16]
 [1.9015410e-10 1.0000000e+00 2.4754972e-14 1.5063132e-13 3.0560862e-13]
 [1.0000000e+00 3.1897716e-13 3.7957766e-15 4.6876031e-16 5.1135633e-16]
 ...
 [2.1675282e-09 1.0000000e+00 1.5683180e-13 7.1903459e-13 7.6568428e-13]
 [5.1796494e-11 1.0000000e+00 2.4490331e-14 1.4304940e-13 1.1711930e-13]
 [1.3245657e-10 1.0000000e+00 2.8157999e-14 1.6572702e-13 2.3819534e-13]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.772830207824708
tp :  44321.0
fp :  55679.0
tn :  344321.0
fn :  55679.0
accuracy :  0.7772863507270813
precision :  0.44321000576019287
recall :  0.44321000576019287
auc :  0.6539276838302612

y_eval {0: 64276, 1: 35724}
pred {0: 15043, 1: 84957}
[INFO] confusion matrix for file 
[[11820 52456     0     0     0]
 [ 3223 32501     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 968549 5330457       0       0       0]
 [  85153  457987       0       0       0]
 [  29326   80371       0       0       0]
 [    548   44807       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4755462e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4755462e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 3.4755462e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 1.0377493e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.0377493e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0377493e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]] shape (100000, 16)
y_test [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [1 1 1 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.36082237e-17 1.00000000e+00 1.69297005e-17 2.81496471e-16
   2.89487512e-16]
  [1.00000000e+00 2.24734027e-08 7.97581022e-13 3.20200572e-13
   2.75556189e-13]
  [9.99969721e-01 3.03035667e-05 2.41127101e-11 1.13019819e-11
   1.25354484e-11]
  ...
  [4.27144257e-12 1.00000000e+00 5.92611778e-15 3.87438088e-14
   3.75675477e-14]
  [1.29632105e-09 1.00000000e+00 9.09426478e-14 5.09718244e-13
   7.29256662e-13]
  [4.11435996e-09 1.00000000e+00 2.29369285e-13 9.63048543e-13
   8.73532095e-13]]

 [[1.00000000e+00 6.26971652e-12 1.95558461e-14 3.76154245e-15
   3.13932751e-15]
  [9.77891982e-01 2.21079383e-02 8.27979185e-10 7.38705985e-10
   4.83900198e-10]
  [2.57795070e-15 1.00000000e+00 1.21624217e-16 1.53180816e-15
   1.59081851e-15]
  ...
  [2.69238399e-07 9.99999762e-01 1.15676500e-12 3.76686009e-12
   7.14963548e-12]
  [2.48961407e-09 1.00000000e+00 2.08648799e-13 9.86482922e-13
   7.69458553e-13]
  [2.61516741e-12 1.00000000e+00 4.48959438e-15 3.01433378e-14
   2.99506615e-14]]

 [[1.00000000e+00 6.39051052e-12 1.97332215e-14 3.80044202e-15
   3.17253056e-15]
  [9.31515872e-01 6.84840903e-02 1.58356972e-09 1.51546020e-09
   8.26880675e-10]
  [1.98565974e-15 1.00000000e+00 1.01362606e-16 1.27222633e-15
   1.44376215e-15]
  ...
  [5.92721497e-11 1.00000000e+00 2.27927367e-14 1.18934403e-13
   1.16775567e-13]
  [1.08466525e-09 1.00000000e+00 8.44214496e-14 4.62713418e-13
   6.65702628e-13]
  [4.33308278e-09 1.00000000e+00 2.44048705e-13 1.03623165e-12
   8.66031910e-13]]

 ...

 [[6.79473551e-17 1.00000000e+00 1.75489212e-17 2.90534074e-16
   2.98198690e-16]
  [9.73448683e-11 1.00000000e+00 1.77476171e-14 1.12937363e-13
   2.24313352e-13]
  [3.36867849e-13 1.00000000e+00 1.75502114e-15 1.67271287e-14
   1.42670045e-14]
  ...
  [2.85651325e-09 1.00000000e+00 2.05065592e-13 9.55935092e-13
   8.61976289e-13]
  [4.46160990e-12 1.00000000e+00 6.41392194e-15 4.28507361e-14
   3.79900172e-14]
  [6.03122752e-09 1.00000000e+00 1.90975626e-13 9.43829108e-13
   1.48921370e-12]]

 [[6.18233599e-17 1.00000000e+00 1.66700286e-17 2.77704807e-16
   2.85809457e-16]
  [2.15797324e-10 1.00000000e+00 2.63549473e-14 1.59259609e-13
   3.24376268e-13]
  [1.00000000e+00 3.56403151e-09 3.51532036e-13 8.00839701e-14
   8.76560922e-14]
  ...
  [8.25629876e-09 1.00000000e+00 2.38415353e-13 1.20541326e-12
   1.72481181e-12]
  [2.18649165e-09 1.00000000e+00 1.70372153e-13 7.52124545e-13
   6.54180377e-13]
  [9.99999762e-01 2.68639525e-07 2.45254576e-12 6.91278957e-13
   1.03178414e-12]]

 [[6.31064824e-17 1.00000000e+00 1.68575240e-17 2.80450385e-16
   2.88455747e-16]
  [1.00940777e-10 1.00000000e+00 1.80587611e-14 1.14769698e-13
   2.28394885e-13]
  [1.76849790e-09 1.00000000e+00 1.37231196e-13 6.37449891e-13
   6.64161651e-13]
  ...
  [1.47043988e-10 1.00000000e+00 3.53754162e-14 2.19277680e-13
   2.32940891e-13]
  [1.00000000e+00 2.59961885e-10 8.26830195e-14 1.49834081e-14
   2.14615143e-14]
  [3.49834419e-13 1.00000000e+00 2.24734527e-15 2.40486867e-14
   1.53197835e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.3608224e-17 1.0000000e+00 1.6929700e-17 2.8149647e-16 2.8948751e-16]
 [1.0000000e+00 2.2473403e-08 7.9758102e-13 3.2020057e-13 2.7555619e-13]
 [9.9996972e-01 3.0303567e-05 2.4112710e-11 1.1301982e-11 1.2535448e-11]
 ...
 [1.4704399e-10 1.0000000e+00 3.5375416e-14 2.1927768e-13 2.3294089e-13]
 [1.0000000e+00 2.5996189e-10 8.2683020e-14 1.4983408e-14 2.1461514e-14]
 [3.4983442e-13 1.0000000e+00 2.2473453e-15 2.4048687e-14 1.5319783e-14]] (100000, 5)
pred 3 (argmax) [1 0 0 ... 1 0 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.91715347442627
tp :  43761.0
fp :  56239.0
tn :  343761.0
fn :  56239.0
accuracy :  0.7750464081764221
precision :  0.437610000371933
recall :  0.437610000371933
auc :  0.650295615196228

y_eval {0: 64281, 1: 35719}
pred {0: 14558, 1: 85442}
[INFO] confusion matrix for file 
[[11300 52981     0     0     0]
 [ 3258 32461     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 979849 5383438       0       0       0]
 [  88411  490448       0       0       0]
 [  29326   80371       0       0       0]
 [    548   44807       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0377493e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0377493e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.0377493e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 1.7330190e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.7330190e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.7330190e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [1 0 0 ... 1 1 1] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99999881e-01 8.19211365e-08 1.64903182e-12 5.52782267e-13
   5.32359421e-13]
  [1.74830744e-13 1.00000000e+00 1.59439076e-15 1.83241924e-14
   9.92422849e-15]
  [2.44313016e-15 1.00000000e+00 9.00956653e-17 1.06275382e-15
   1.67499156e-15]
  ...
  [5.53776686e-12 1.00000000e+00 7.05496452e-15 4.95455795e-14
   4.62104584e-14]
  [3.58491237e-10 1.00000000e+00 5.00089912e-14 2.84259378e-13
   3.78180424e-13]
  [5.39060019e-10 1.00000000e+00 8.38840716e-14 4.36726691e-13
   3.71835402e-13]]

 [[6.80194522e-17 1.00000000e+00 1.75589665e-17 2.90680426e-16
   2.98339774e-16]
  [9.77995185e-11 1.00000000e+00 1.77887592e-14 1.13160749e-13
   2.24793911e-13]
  [1.51266200e-09 1.00000000e+00 1.26419694e-13 5.94283086e-13
   6.19613681e-13]
  ...
  [1.81971972e-11 1.00000000e+00 1.35934058e-14 7.56154579e-14
   6.30500291e-14]
  [1.44596579e-09 1.00000000e+00 8.75773792e-14 5.10143251e-13
   8.60914855e-13]
  [3.20603490e-08 1.00000000e+00 7.53442610e-13 2.87948398e-12
   2.10141821e-12]]

 [[9.99999881e-01 8.15267711e-08 1.64556931e-12 5.51449077e-13
   5.30926594e-13]
  [1.76445447e-13 1.00000000e+00 1.60228045e-15 1.84029665e-14
   9.96367905e-15]
  [1.73933898e-07 9.99999881e-01 8.41459443e-13 2.98080397e-12
   7.05161103e-12]
  ...
  [9.05094402e-12 1.00000000e+00 7.96625424e-15 5.40994353e-14
   6.29196809e-14]
  [3.10611425e-09 1.00000000e+00 1.76089747e-13 8.62104550e-13
   9.30664942e-13]
  [3.78801643e-11 1.00000000e+00 1.90655597e-14 1.11413577e-13
   1.10388945e-13]]

 ...

 [[6.20662797e-17 1.00000000e+00 1.67057413e-17 2.78228618e-16
   2.86313600e-16]
  [9.94840801e-01 5.15916757e-03 1.63323591e-10 1.36492165e-10
   3.51982166e-10]
  [8.15210538e-11 1.00000000e+00 3.36109077e-14 2.06272255e-13
   1.92597945e-13]
  ...
  [3.08960750e-07 9.99999642e-01 2.07871068e-12 9.23130235e-12
   8.32729372e-12]
  [9.99590576e-01 4.09424800e-04 8.40833583e-11 2.91847935e-11
   4.44278850e-11]
  [1.85670977e-13 1.00000000e+00 1.89910758e-15 2.15684556e-14
   1.10822631e-14]]

 [[6.18658240e-17 1.00000000e+00 1.66763251e-17 2.77796975e-16
   2.85897760e-16]
  [1.80161719e-10 1.00000000e+00 2.40714939e-14 1.47141956e-13
   2.98574750e-13]
  [2.61243427e-09 1.00000000e+00 1.71272393e-13 7.74142740e-13
   7.87277687e-13]
  ...
  [6.17607014e-08 9.99999881e-01 5.63502207e-13 2.17107061e-12
   3.74684008e-12]
  [4.96704144e-09 1.00000000e+00 2.71728928e-13 1.19792988e-12
   1.09708293e-12]
  [9.31038233e-12 1.00000000e+00 9.42827715e-15 5.69644294e-14
   5.06700462e-14]]

 [[6.27547917e-17 1.00000000e+00 1.68057723e-17 2.79686468e-16
   2.87735875e-16]
  [1.55183269e-10 1.00000000e+00 2.23375226e-14 1.37818766e-13
   2.78713982e-13]
  [2.64300204e-09 1.00000000e+00 1.71800128e-13 7.75857460e-13
   7.91497944e-13]
  ...
  [6.87161509e-14 1.00000000e+00 1.08995861e-15 1.41584344e-14
   7.46105583e-15]
  [8.64899619e-09 1.00000000e+00 1.83958507e-13 6.56340108e-13
   1.29909126e-12]
  [1.79433854e-08 1.00000000e+00 5.66198889e-13 2.55778558e-12
   2.18976443e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999988e-01 8.1921137e-08 1.6490318e-12 5.5278227e-13 5.3235942e-13]
 [1.7483074e-13 1.0000000e+00 1.5943908e-15 1.8324192e-14 9.9242285e-15]
 [2.4431302e-15 1.0000000e+00 9.0095665e-17 1.0627538e-15 1.6749916e-15]
 ...
 [6.8716151e-14 1.0000000e+00 1.0899586e-15 1.4158434e-14 7.4610558e-15]
 [8.6489962e-09 1.0000000e+00 1.8395851e-13 6.5634011e-13 1.2990913e-12]
 [1.7943385e-08 1.0000000e+00 5.6619889e-13 2.5577856e-12 2.1897644e-12]] (100000, 5)
pred 3 (argmax) [0 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.993719644165038
tp :  43472.0
fp :  56528.0
tn :  343472.0
fn :  56528.0
accuracy :  0.7738903164863586
precision :  0.4347200095653534
recall :  0.4347200095653534
auc :  0.647462785243988

y_eval {0: 64139, 1: 35861}
pred {0: 14377, 1: 85623}
[INFO] confusion matrix for file 
[[10994 53145     0     0     0]
 [ 3383 32478     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 990843 5436583       0       0       0]
 [  91794  522926       0       0       0]
 [  29326   80371       0       0       0]
 [    548   44807       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-02_172943_122.log.part05_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1367 (0.2734%)
[INFO] ** orig:[0:99.9992%,2:0.0008%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9984%,3:0.0016%]
[INFO] ** i/f_dir:[1:99.9984%,0:0.0016%]
[INFO] ** src:[22:38.0648%,9:26.1164%,7:18.2044%,1:17.6118%,21:0.001%,14:0.0008%,3:0.0004%,2:0.0004%]
[INFO] ** dst:[21:43.368%,10:20.8128%,8:18.2044%,9:17.6114%,15:0.0016%,22:0.0006%,16:0.0004%,24:0.0002%,18:0.0002%,6:0.0002%,2:0.0002%]
[INFO] ** proto:[0:99.998%,1:0.0016%,2:0.0004%]
[INFO] ** appi_name:[21:99.9974%,30:0.0016%,7:0.0006%,31:0.0002%,22:0.0002%]
[INFO] ** proxy_src_ip:[18:38.0648%,20:26.1164%,13:18.2044%,6:17.6118%,17:0.0016%,14:0.0004%,1:0.0004%,7:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9974%,-33.760870000000004:0.0026%]
[INFO] ** modbus_function_description:[7:49.9992%,11:49.9982%,0:0.0026%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1154%,1:20.8126%,5:18.204%,4:17.6112%,2:17.2518%,0:0.005%]
[INFO] ** service:[0.0048200000000000005:99.9974%,-211.73542999999998:0.0016%,-211.09762999999998:0.0006%,-186.43601999999998:0.0002%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.1158%,-0.32151:20.8128%,-1.27613:18.204%,-0.23351:17.6114%,-0.33484:17.252%,-71.33197:0.0016%,1.45709:0.0004%,-1.2708:0.0002%,-71.14931:0.0002%,-0.24151:0.0002%,-2.02544:0.0002%,1.46509:0.0002%,10.73138:0.0002%,-0.24950999999999998:0.0002%,14.88321:0.0002%,-1.27347:0.0002%,-2.81074:0.0002%]
[INFO] ** classification:[normal:97.0224%,Single Stage Single Point:2.9776%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7314488e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.7314488e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.7314488e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-1.0388432e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0388432e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0388432e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [1 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.84361395e-17 1.00000000e+00 1.76149865e-17 2.91460993e-16
   2.99158034e-16]
  [7.25737470e-10 1.00000000e+00 4.85624521e-14 2.71251500e-13
   5.64356287e-13]
  [1.00000000e+00 2.12506675e-15 3.46000995e-16 3.09603446e-17
   3.21079353e-17]
  ...
  [1.59293950e-06 9.99998450e-01 3.81584001e-12 1.30485865e-11
   1.70353228e-11]
  [1.16460785e-10 1.00000000e+00 3.64614751e-14 1.95986483e-13
   1.83246213e-13]
  [2.34887682e-11 1.00000000e+00 1.41367927e-14 9.07317976e-14
   9.16267320e-14]]

 [[7.51388899e-17 1.00000000e+00 1.85337989e-17 3.04785060e-16
   3.11977110e-16]
  [2.24211039e-10 1.00000000e+00 2.69268826e-14 1.61857398e-13
   3.28887362e-13]
  [1.47821599e-09 1.00000000e+00 1.27692209e-13 6.02633937e-13
   6.11682905e-13]
  ...
  [1.52591149e-08 1.00000000e+00 2.86595969e-13 1.10071110e-12
   1.99261332e-12]
  [2.65381352e-08 1.00000000e+00 7.82190176e-13 3.16686456e-12
   2.04287260e-12]
  [1.00000000e+00 1.60130919e-11 2.17355871e-14 2.87533042e-15
   4.05666059e-15]]

 [[1.00000000e+00 3.76142797e-11 4.54209424e-14 9.82759643e-15
   8.32493373e-15]
  [9.99328017e-01 6.72044058e-04 1.42078210e-10 9.62589591e-11
   7.18598722e-11]
  [8.37285102e-11 1.00000000e+00 2.58030834e-14 1.30973655e-13
   1.53298462e-13]
  ...
  [1.00000000e+00 1.01655791e-15 2.30194624e-16 1.88156127e-17
   2.07754881e-17]
  [2.19797548e-11 1.00000000e+00 1.51361349e-14 1.07582597e-13
   8.70205736e-14]
  [1.05552189e-07 9.99999881e-01 7.38301889e-13 2.44134032e-12
   4.84662614e-12]]

 ...

 [[6.73982726e-17 1.00000000e+00 1.74692389e-17 2.89341796e-16
   2.97114329e-16]
  [1.00000000e+00 7.87625716e-14 1.54934439e-15 1.75540193e-16
   2.23279155e-16]
  [7.98492014e-01 2.01508000e-01 1.68054337e-09 1.66978864e-09
   1.62492253e-09]
  ...
  [7.59222740e-10 1.00000000e+00 5.53197624e-14 2.32771674e-13
   4.73624883e-13]
  [1.13501748e-07 9.99999881e-01 1.49870231e-12 5.53151665e-12
   3.88779070e-12]
  [1.22322866e-12 1.00000000e+00 2.63569463e-15 1.77907277e-14
   2.28068263e-14]]

 [[6.66458427e-17 1.00000000e+00 1.73644633e-17 2.87834686e-16
   2.95612963e-16]
  [3.25792976e-10 1.00000000e+00 3.24433677e-14 1.90751372e-13
   3.91285176e-13]
  [2.13085305e-09 1.00000000e+00 1.55554348e-13 7.13584628e-13
   7.19007156e-13]
  ...
  [3.06642889e-08 1.00000000e+00 3.99672862e-13 1.45454970e-12
   2.68862645e-12]
  [2.95216784e-09 1.00000000e+00 2.48321600e-13 1.21858296e-12
   8.04844472e-13]
  [7.45910007e-13 1.00000000e+00 2.17936516e-15 1.61229672e-14
   1.81138538e-14]]

 [[7.32584370e-17 1.00000000e+00 1.82806684e-17 3.01134242e-16
   3.08447180e-16]
  [2.11322126e-10 1.00000000e+00 2.61344935e-14 1.57766974e-13
   3.20204231e-13]
  [1.26500214e-02 9.87349927e-01 5.12419551e-10 7.06515457e-10
   6.53529619e-10]
  ...
  [1.48837058e-08 1.00000000e+00 4.68517911e-13 1.82466455e-12
   1.62709310e-12]
  [1.00000000e+00 4.59922638e-12 1.35040184e-14 1.78724799e-15
   2.09674663e-15]
  [6.97331082e-13 1.00000000e+00 3.00114891e-15 2.92315305e-14
   1.98670629e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.84361395e-17 1.00000000e+00 1.76149865e-17 2.91460993e-16
  2.99158034e-16]
 [7.25737470e-10 1.00000000e+00 4.85624521e-14 2.71251500e-13
  5.64356287e-13]
 [1.00000000e+00 2.12506675e-15 3.46000995e-16 3.09603446e-17
  3.21079353e-17]
 ...
 [1.48837058e-08 1.00000000e+00 4.68517911e-13 1.82466455e-12
  1.62709310e-12]
 [1.00000000e+00 4.59922638e-12 1.35040184e-14 1.78724799e-15
  2.09674663e-15]
 [6.97331082e-13 1.00000000e+00 3.00114891e-15 2.92315305e-14
  1.98670629e-14]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 1 0 1] (100000,)
[33m[INFO] metrics:[0m
loss :  11.148547367858887
tp :  28559.0
fp :  71441.0
tn :  328559.0
fn :  71441.0
accuracy :  0.7142388820648193
precision :  0.2855899930000305
recall :  0.2855899930000305
auc :  0.5552287101745605

y_eval {0: 85112, 1: 14888}
pred {0: 18449, 1: 81551}
[INFO] confusion matrix for file 
[[16060 69052     0     0     0]
 [ 2389 12499     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1006903 5505635       0       0       0]
 [  94183  535425       0       0       0]
 [  29326   80371       0       0       0]
 [    548   44807       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0388432e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0388432e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.0388432e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 ...
 [-3.4623763e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4623763e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4623763e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.66189031e-17 1.00000000e+00 1.73605557e-17 2.87777591e-16
   2.95558859e-16]
  [9.99999523e-01 4.31564871e-07 2.77531557e-12 1.29651368e-12
   1.45222875e-12]
  [7.36139987e-15 1.00000000e+00 1.82512730e-16 2.00607937e-15
   2.80231279e-15]
  ...
  [1.27773126e-06 9.99998689e-01 4.07137388e-12 1.33342521e-11
   1.29064355e-11]
  [1.13988367e-11 1.00000000e+00 9.07698294e-15 5.33301295e-14
   6.60077190e-14]
  [1.19441135e-09 1.00000000e+00 1.20482427e-13 6.59198065e-13
   5.62668835e-13]]

 [[6.47970014e-17 1.00000000e+00 1.71003395e-17 2.83979310e-16
   2.91906056e-16]
  [1.00000000e+00 4.39126643e-12 8.30327171e-15 1.20944171e-15
   2.34874655e-15]
  [1.37803556e-06 9.99998569e-01 5.51147886e-12 1.59143254e-11
   1.30685133e-11]
  ...
  [1.00000000e+00 6.87286057e-14 2.05960677e-15 2.21055337e-16
   1.94020864e-16]
  [1.58007364e-12 1.00000000e+00 3.75714000e-15 3.07661340e-14
   2.67022563e-14]
  [1.07979633e-06 9.99998927e-01 2.45660263e-12 7.35413379e-12
   1.39289951e-11]]

 [[7.89232081e-17 1.00000000e+00 1.90294918e-17 3.11849791e-16
   3.18933501e-16]
  [1.00000000e+00 4.04727995e-14 1.12772791e-15 1.20044580e-16
   1.53438642e-16]
  [8.18196118e-01 1.81803927e-01 1.62088798e-09 1.60197344e-09
   1.55129454e-09]
  ...
  [4.46424941e-08 1.00000000e+00 4.41399575e-13 1.39551695e-12
   2.91199313e-12]
  [2.35370603e-08 1.00000000e+00 7.04549104e-13 2.92627988e-12
   1.99988962e-12]
  [1.41654180e-12 1.00000000e+00 2.95255865e-15 1.97228742e-14
   2.30433399e-14]]

 ...

 [[6.38588859e-17 1.00000000e+00 1.69655819e-17 2.82016682e-16
   2.90000364e-16]
  [7.00498462e-01 2.99501508e-01 2.34719466e-09 4.55674298e-09
   2.78746870e-09]
  [1.87075633e-15 1.00000000e+00 8.25771428e-17 9.57152313e-16
   1.49639805e-15]
  ...
  [1.00000000e+00 1.34920211e-14 8.15202296e-16 8.34607040e-17
   9.14886374e-17]
  [4.07565214e-12 1.00000000e+00 6.56427071e-15 5.42868363e-14
   4.31041142e-14]
  [3.46684814e-08 1.00000000e+00 4.34340877e-13 1.56541089e-12
   2.81367160e-12]]

 [[1.00000000e+00 1.18088384e-12 8.89381545e-15 1.53141672e-15
   1.24840480e-15]
  [9.77882802e-01 2.21171770e-02 8.23845658e-10 7.42266637e-10
   4.96965469e-10]
  [9.76603746e-01 2.33962722e-02 5.81543480e-10 3.04860887e-10
   4.74886463e-10]
  ...
  [1.89942203e-12 1.00000000e+00 3.09655743e-15 2.50701949e-14
   3.52958866e-14]
  [1.52846815e-06 9.99998450e-01 4.15048551e-12 1.18065063e-11
   1.29833436e-11]
  [1.00000000e+00 7.30837890e-11 5.27897055e-14 8.29390098e-15
   1.03974870e-14]]

 [[6.49524187e-17 1.00000000e+00 1.71228604e-17 2.84310976e-16
   2.92220252e-16]
  [6.95620358e-01 3.04379702e-01 2.35587860e-09 4.57738958e-09
   2.80125256e-09]
  [1.87928214e-15 1.00000000e+00 8.27420561e-17 9.58471355e-16
   1.49964960e-15]
  ...
  [8.59633431e-09 1.00000000e+00 3.74419517e-13 1.75186666e-12
   1.50076208e-12]
  [4.46608852e-12 1.00000000e+00 6.25741355e-15 4.04953509e-14
   3.72527360e-14]
  [5.61529223e-09 1.00000000e+00 1.87802993e-13 9.59116575e-13
   1.47309964e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.6618903e-17 1.0000000e+00 1.7360556e-17 2.8777759e-16 2.9555886e-16]
 [9.9999952e-01 4.3156487e-07 2.7753156e-12 1.2965137e-12 1.4522287e-12]
 [7.3613999e-15 1.0000000e+00 1.8251273e-16 2.0060794e-15 2.8023128e-15]
 ...
 [8.5963343e-09 1.0000000e+00 3.7441952e-13 1.7518667e-12 1.5007621e-12]
 [4.4660885e-12 1.0000000e+00 6.2574135e-15 4.0495351e-14 3.7252736e-14]
 [5.6152922e-09 1.0000000e+00 1.8780299e-13 9.5911658e-13 1.4730996e-12]] (100000, 5)
pred 3 (argmax) [1 0 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.124486666870117
tp :  16251.0
fp :  83749.0
tn :  316251.0
fn :  83749.0
accuracy :  0.6650072932243347
precision :  0.1625099927186966
recall :  0.1625099927186966
auc :  0.4779183268547058

y_eval {0: 100000}
pred {0: 16251, 1: 83749}
[INFO] confusion matrix for file 
[[16251 83749     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1023154 5589384       0       0       0]
 [  94183  535425       0       0       0]
 [  29326   80371       0       0       0]
 [    548   44807       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4623763e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-3.4623763e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4623763e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 3.4890494e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4890494e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4890494e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.00000000e+00 5.68282754e-09 4.74236861e-13 1.38064500e-13
   1.27584114e-13]
  [7.14645079e-11 1.00000000e+00 4.00710755e-14 2.99801687e-13
   1.35564899e-13]
  [4.73395467e-01 5.26604533e-01 9.89713311e-10 8.99389285e-10
   2.94791547e-09]
  ...
  [4.21930019e-10 1.00000000e+00 6.51420920e-14 3.44444904e-13
   3.43755786e-13]
  [4.19018379e-12 1.00000000e+00 5.54382471e-15 3.90051015e-14
   4.28104614e-14]
  [4.15506873e-09 1.00000000e+00 1.86597577e-13 8.59323517e-13
   1.03519255e-12]]

 [[6.56080884e-17 1.00000000e+00 1.72160605e-17 2.85663397e-16
   2.93541968e-16]
  [1.92375019e-10 1.00000000e+00 2.49036750e-14 1.51499771e-13
   3.07296696e-13]
  [1.00000000e+00 9.17454724e-14 2.08048529e-15 2.37301654e-16
   2.57372417e-16]
  ...
  [2.21035421e-07 9.99999762e-01 1.29589601e-12 5.33635462e-12
   7.67128808e-12]
  [1.04557829e-09 1.00000000e+00 1.18937127e-13 5.53151492e-13
   4.76639019e-13]
  [7.53624073e-12 1.00000000e+00 7.59820572e-15 4.95692117e-14
   5.34833340e-14]]

 [[7.15725966e-17 1.00000000e+00 1.80512267e-17 2.97816731e-16
   3.05239996e-16]
  [1.00000000e+00 1.45053941e-10 4.18363125e-14 8.07067985e-15
   1.71954786e-14]
  [1.40344474e-12 1.00000000e+00 3.88985439e-15 3.40146273e-14
   2.98441386e-14]
  ...
  [1.97421159e-07 9.99999762e-01 1.63608320e-12 6.21819523e-12
   5.63113445e-12]
  [7.58472278e-12 1.00000000e+00 7.18163491e-15 4.29939220e-14
   5.40346712e-14]
  [1.00000000e+00 7.88249403e-14 1.96688801e-15 2.25042387e-16
   2.39465002e-16]]

 ...

 [[6.97287051e-17 1.00000000e+00 1.77972160e-17 2.94138279e-16
   3.01683834e-16]
  [1.62583530e-10 1.00000000e+00 2.29094138e-14 1.40786241e-13
   2.84093495e-13]
  [1.42199585e-09 1.00000000e+00 1.24282298e-13 5.88227221e-13
   6.01866593e-13]
  ...
  [3.05930592e-09 1.00000000e+00 1.96280519e-13 8.89206027e-13
   8.88739765e-13]
  [1.71141955e-11 1.00000000e+00 1.34283513e-14 8.37497796e-14
   7.08794528e-14]
  [3.42729123e-10 1.00000000e+00 4.51997855e-14 2.56748643e-13
   3.78438763e-13]]

 [[6.97473266e-17 1.00000000e+00 1.77997952e-17 2.94176448e-16
   3.01719515e-16]
  [1.62687128e-10 1.00000000e+00 2.29168000e-14 1.40824920e-13
   2.84174810e-13]
  [1.00000000e+00 4.52692875e-12 1.36449689e-14 2.00495473e-15
   2.21442852e-15]
  ...
  [2.95759115e-08 1.00000000e+00 4.60709921e-13 2.16740905e-12
   3.10769769e-12]
  [1.13587195e-09 1.00000000e+00 1.22769484e-13 5.69946759e-13
   4.89645542e-13]
  [2.01616814e-11 1.00000000e+00 1.22839920e-14 7.30138674e-14
   8.37671946e-14]]

 [[6.62276797e-17 1.00000000e+00 1.73040923e-17 2.86943396e-16
   2.94785306e-16]
  [1.07944313e-10 1.00000000e+00 1.86769816e-14 1.18061973e-13
   2.35385279e-13]
  [1.00000000e+00 4.25459494e-12 1.31245663e-14 1.93651997e-15
   2.15948721e-15]
  ...
  [1.00580467e-13 1.00000000e+00 1.19101356e-15 1.38950766e-14
   8.80308467e-15]
  [2.60881574e-08 1.00000000e+00 3.54187789e-13 1.20467785e-12
   2.09136593e-12]
  [3.45991680e-09 1.00000000e+00 2.23959807e-13 1.09623996e-12
   1.04428521e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.00000000e+00 5.68282754e-09 4.74236861e-13 1.38064500e-13
  1.27584114e-13]
 [7.14645079e-11 1.00000000e+00 4.00710755e-14 2.99801687e-13
  1.35564899e-13]
 [4.73395467e-01 5.26604533e-01 9.89713311e-10 8.99389285e-10
  2.94791547e-09]
 ...
 [1.00580467e-13 1.00000000e+00 1.19101356e-15 1.38950766e-14
  8.80308467e-15]
 [2.60881574e-08 1.00000000e+00 3.54187789e-13 1.20467785e-12
  2.09136593e-12]
 [3.45991680e-09 1.00000000e+00 2.23959807e-13 1.09623996e-12
  1.04428521e-12]] (100000, 5)
pred 3 (argmax) [0 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.446557557678222
tp :  15228.0
fp :  84772.0
tn :  315228.0
fn :  84772.0
accuracy :  0.6609153151512146
precision :  0.15228000283241272
recall :  0.15228000283241272
auc :  0.4698864221572876

y_eval {0: 100000}
pred {0: 15228, 1: 84772}
[INFO] confusion matrix for file 
[[15228 84772     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1038382 5674156       0       0       0]
 [  94183  535425       0       0       0]
 [  29326   80371       0       0       0]
 [    548   44807       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4890494e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4890494e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4890494e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 1.0389735e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.0389735e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.0389735e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.39612776e-17 1.00000000e+00 1.69805390e-17 2.82237307e-16
   2.90208417e-16]
  [2.82715545e-10 1.00000000e+00 3.01969685e-14 1.79269875e-13
   3.66929767e-13]
  [3.93743083e-09 1.00000000e+00 2.13466438e-13 9.33206854e-13
   9.42807139e-13]
  ...
  [7.50882165e-08 9.99999881e-01 6.23147855e-13 2.19575768e-12
   3.97727771e-12]
  [2.60384336e-09 1.00000000e+00 2.16870237e-13 1.05476663e-12
   8.00772914e-13]
  [3.63059257e-12 1.00000000e+00 5.27979353e-15 3.40980296e-14
   3.45874655e-14]]

 [[6.18233599e-17 1.00000000e+00 1.66700286e-17 2.77704807e-16
   2.85809457e-16]
  [3.50682761e-10 1.00000000e+00 3.36777725e-14 1.97489337e-13
   4.05108970e-13]
  [1.00000000e+00 5.53657380e-12 1.52508621e-14 2.23788349e-15
   2.43675434e-15]
  ...
  [1.21065355e-07 9.99999881e-01 9.33876240e-13 4.04341057e-12
   5.98366582e-12]
  [2.70717604e-09 1.00000000e+00 1.97647224e-13 8.60232025e-13
   7.19068902e-13]
  [1.00000000e+00 1.35996903e-09 1.93173345e-13 3.70952590e-14
   5.23114030e-14]]

 [[1.00000000e+00 2.28805299e-12 1.21301395e-14 2.18126146e-15
   1.79805274e-15]
  [9.29301858e-01 7.06981942e-02 1.51141133e-09 1.46178392e-09
   8.77625528e-10]
  [1.79186284e-15 1.00000000e+00 1.03206174e-16 1.35614422e-15
   1.35304387e-15]
  ...
  [3.24807226e-09 1.00000000e+00 2.08637659e-13 9.19517175e-13
   7.75895949e-13]
  [1.00000000e+00 6.29922225e-10 1.22700190e-13 2.24103691e-14
   3.53828396e-14]
  [6.46348101e-13 1.00000000e+00 3.58037269e-15 4.02443310e-14
   2.08874462e-14]]

 ...

 [[6.34323056e-17 1.00000000e+00 1.69040165e-17 2.81118747e-16
   2.89127735e-16]
  [9.99944448e-01 5.54995640e-05 1.85000886e-11 1.06172848e-11
   2.67242513e-11]
  [3.53794528e-11 1.00000000e+00 2.15948814e-14 1.42202547e-13
   1.33251036e-13]
  ...
  [7.88125249e-07 9.99999166e-01 3.35558252e-12 1.40774181e-11
   1.26144407e-11]
  [1.91019162e-11 1.00000000e+00 1.12556669e-14 6.07940822e-14
   7.95229158e-14]
  [1.00000000e+00 1.72924078e-10 8.17170835e-14 1.70977565e-14
   1.87630673e-14]]

 [[6.31103338e-17 1.00000000e+00 1.68582304e-17 2.80461079e-16
   2.88463423e-16]
  [1.07958927e-10 1.00000000e+00 1.86690043e-14 1.18098240e-13
   2.35615699e-13]
  [1.27337607e-09 1.00000000e+00 1.16032238e-13 5.53273898e-13
   5.74224099e-13]
  ...
  [1.00000000e+00 1.39664813e-09 1.97615944e-13 4.65064930e-14
   5.91587800e-14]
  [3.18270394e-13 1.00000000e+00 1.92564703e-15 1.95404097e-14
   1.47534759e-14]
  [1.60354272e-08 1.00000000e+00 3.07363510e-13 1.14075524e-12
   1.71099755e-12]]

 [[6.18285479e-17 1.00000000e+00 1.66707913e-17 2.77715395e-16
   2.85820363e-16]
  [1.74109560e-10 1.00000000e+00 2.36796395e-14 1.45143392e-13
   2.93831447e-13]
  [2.92538038e-09 1.00000000e+00 1.81150030e-13 8.10796525e-13
   8.27870541e-13]
  ...
  [3.22144356e-09 1.00000000e+00 1.74986206e-13 7.65535367e-13
   9.45254075e-13]
  [6.61029426e-11 1.00000000e+00 3.02332757e-14 1.80529853e-13
   1.31081113e-13]
  [3.24122430e-11 1.00000000e+00 1.32121224e-14 8.27652291e-14
   1.22768305e-13]]]Using TensorFlow backend.
 (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.3961278e-17 1.0000000e+00 1.6980539e-17 2.8223731e-16 2.9020842e-16]
 [2.8271555e-10 1.0000000e+00 3.0196969e-14 1.7926987e-13 3.6692977e-13]
 [3.9374308e-09 1.0000000e+00 2.1346644e-13 9.3320685e-13 9.4280714e-13]
 ...
 [3.2214436e-09 1.0000000e+00 1.7498621e-13 7.6553537e-13 9.4525407e-13]
 [6.6102943e-11 1.0000000e+00 3.0233276e-14 1.8052985e-13 1.3108111e-13]
 [3.2412243e-11 1.0000000e+00 1.3212122e-14 8.2765229e-14 1.2276830e-13]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.621866282653809
tp :  14503.0
fp :  85497.0
tn :  314503.0
fn :  85497.0
accuracy :  0.6580153107643127
precision :  0.14503000676631927
recall :  0.14503000676631927
auc :  0.46621567010879517

y_eval {0: 100000}
pred {0: 14503, 1: 85497}
[INFO] confusion matrix for file 
[[14503 85497     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1052885 5759653       0       0       0]
 [  94183  535425       0       0       0]
 [  29326   80371       0       0       0]
 [    548   44807       0       0       0]
 [  50638  152164       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0389735e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0389735e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0389735e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 1.7315791e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.7315791e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.7315791e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.79162598e-17 1.00000000e+00 1.75445041e-17 2.90469806e-16
   2.98136142e-16]
  [9.98112917e-01 1.88704010e-03 2.76793283e-10 3.83983900e-10
   2.01941602e-10]
  [7.33068317e-16 1.00000000e+00 5.48445959e-17 7.24674326e-16
   9.57470056e-16]
  ...
  [7.59223173e-09 1.00000000e+00 3.40389175e-13 1.54844865e-12
   1.40845940e-12]
  [6.56182704e-12 1.00000000e+00 7.94410094e-15 5.00230147e-14
   4.36816416e-14]
  [2.32923592e-09 1.00000000e+00 1.19757977e-13 6.57882928e-13
   9.97504163e-13]]

 [[1.00000000e+00 1.86178106e-09 2.84818908e-13 7.72627405e-14
   6.94866528e-14]
  [3.34843003e-06 9.99996662e-01 1.13637832e-11 3.62528861e-11
   1.43901245e-11]
  [1.47941517e-16 1.00000000e+00 2.41123099e-17 3.58530491e-16
   4.47225932e-16]
  ...
  [9.35083122e-09 1.00000000e+00 3.62228368e-13 1.49411592e-12
   1.27907754e-12]
  [7.52057531e-12 1.00000000e+00 7.30784790e-15 4.48951111e-14
   5.27628309e-14]
  [2.96013480e-09 1.00000000e+00 1.74476305e-13 9.43123617e-13
   9.55444708e-13]]

 [[4.16387465e-13 1.00000000e+00 1.77912600e-15 1.48529192e-14
   1.38685458e-14]
  [5.71141604e-13 1.00000000e+00 1.53006782e-15 1.33816383e-14
   1.99844989e-14]
  [1.84101481e-08 1.00000000e+00 3.78558594e-13 1.46650595e-12
   1.88651807e-12]
  ...
  [1.00000000e+00 2.67224127e-08 7.32538325e-13 1.91511100e-13
   2.97319407e-13]
  [5.10084921e-13 1.00000000e+00 2.89183041e-15 3.10800275e-14
   1.90142108e-14]
  [1.30858557e-09 1.00000000e+00 8.19590299e-14 3.30250150e-13
   5.01351781e-13]]

 ...

 [[6.18153461e-17 1.00000000e+00 1.66688838e-17 2.77687840e-16
   2.85793099e-16]
  [1.54203095e-10 1.00000000e+00 2.22637257e-14 1.37454650e-13
   2.77980791e-13]
  [1.58401092e-09 1.00000000e+00 1.31695341e-13 6.19103347e-13
   6.31464607e-13]
  ...
  [4.30759517e-09 1.00000000e+00 1.92087638e-13 8.28620918e-13
   1.11196241e-12]
  [9.99998808e-01 1.15418231e-06 7.00059889e-12 2.19310572e-12
   1.83543762e-12]
  [1.47036398e-14 1.00000000e+00 3.59992788e-16 4.22952223e-15
   3.44561526e-15]]

 [[1.00000000e+00 2.21607466e-09 3.07479628e-13 8.43018960e-14
   7.63971270e-14]
  [2.80860057e-11 1.00000000e+00 2.40946924e-14 1.92446658e-13
   9.09376198e-14]
  [1.00000000e+00 2.28814884e-12 8.06169537e-15 1.06606307e-15
   1.44819701e-15]
  ...
  [1.16524834e-09 1.00000000e+00 1.08661567e-13 6.35288155e-13
   6.44177094e-13]
  [9.99989629e-01 1.03528428e-05 1.56805801e-11 5.50971638e-12
   7.05697436e-12]
  [6.89054120e-14 1.00000000e+00 9.89802256e-16 1.15846426e-14
   7.13034283e-15]]

 [[6.29021887e-17 1.00000000e+00 1.68272624e-17 2.79999261e-16
   2.88040092e-16]
  [2.08299600e-10 1.00000000e+00 2.58965162e-14 1.56801885e-13
   3.19039852e-13]
  [1.59468510e-12 1.00000000e+00 3.95144216e-15 3.32850982e-14
   2.87360501e-14]
  ...
  [7.47671702e-10 1.00000000e+00 6.42957841e-14 2.77938371e-13
   3.86587924e-13]
  [3.74101905e-09 1.00000000e+00 1.85816233e-13 8.95541128e-13
   1.15910200e-12]
  [4.81285123e-10 1.00000000e+00 8.69978324e-14 4.31164707e-13
   2.93761380e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.7916260e-17 1.0000000e+00 1.7544504e-17 2.9046981e-16 2.9813614e-16]
 [9.9811292e-01 1.8870401e-03 2.7679328e-10 3.8398390e-10 2.0194160e-10]
 [7.3306832e-16 1.0000000e+00 5.4844596e-17 7.2467433e-16 9.5747006e-16]
 ...
 [7.4767170e-10 1.0000000e+00 6.4295784e-14 2.7793837e-13 3.8658792e-13]
 [3.7410191e-09 1.0000000e+00 1.8581623e-13 8.9554113e-13 1.1591020e-12]
 [4.8128512e-10 1.0000000e+00 8.6997832e-14 4.3116471e-13 2.9376138e-13]] (100000, 5)
pred 3 (argmax) [1 0 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.675912902832032
tp :  14446.0
fp :  85554.0
tn :  314446.0
fn :  85554.0
accuracy :  0.6577872633934021
precision :  0.14445999264717102
recall :  0.14445999264717102
auc :  0.4646850526332855

y_eval {0: 100000}
pred {0: 14446, 1: 85554}
[INFO] confusion matrix for file 
[[14446 85554     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1067331 5845207       0       0       0]
 [  94183  535425       0       0       0]
 [  29326   80371       0       0       0]
 [    548   44807       0       0       0]
 [  50638  152164       0       0       0]]
